'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1070:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1071:function(t,F,a){a.d(F,"a",function(){return h});t=a(0);var c=a(15),b=a(85);F=a(150);var e=a(4),f=a(46),d=a(30);class h extends F.a{constructor(m,l,v,r,A,x,n=null){super();this.CI=null;this.Ma=l;this.hX=r;this.rga=x;this.mb=m;this.Es=A;this.Ze=v;this.Uib=this.mb.pa("SaveToHostWithExtraCharsInFileName");this.zh=n;this.tc(1,CommonUIStrings.l_SaveButtonLabel)}get ra(){return this.Ze}nMe(m,l){this.SK(1,!!m&&m!==l);this.CI=document.getElementById(h.iXe);f.a.addHandler(this.CI,"change",Object(b.a)(this,
this.Zoc,"onFileNameChange"));f.a.addHandler(this.CI,"input",Object(b.a)(this,this.Zoc,"onFileNameChange"));this.CI.focus()}G$b(m){return this.Uib?(new RegExp("["+this.m9b('\\/:*?"<>|')+"]")).test(m):(new RegExp("["+this.m9b('\\/:*?"<>|#{}%~&')+"]")).test(m)}m9b(m){return m.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}tkd(){const m=d.a.Kp(e.AFrameworkApplication.om.en);this.SK(1,!!this.CI&&""!==this.CI.value&&this.CI.value!==m)}Zoc(){this.CI&&window.setTimeout(()=>{this.tkd()},0)}F$b(m,l){if(1!==
m)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{m=l[h.iXe];l=h.gLf in l?l[h.gLf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.ytc(m),l);const v=d.a.T3(e.AFrameworkApplication.fileName);(m=m?m.trim():null)&&""!==m&&""!==v||1===this.ra.state?this.G$b(m)?this.Es.create().displayError(1,m,l):this.rga.aoa(m+v,l,this.zh):this.Es.create().displayError(2,m,l)}}dispose(){this.CI&&
(f.a.removeHandler(this.CI,"change",Object(b.a)(this,this.Zoc,"onFileNameChange")),f.a.removeHandler(this.CI,"input",Object(b.a)(this,this.Zoc,"onFileNameChange")),this.CI=null);super.dispose()}}h.iXe="txtFileName";h.gLf="chkOverwrite";Object(t.a)(h,"FileNameDialogBase",F.a,[])},1072:function(t,F,a){a.d(F,"a",function(){return r});t=a(0);var c=a(15),b=a(160),e=a(85),f=a(4),d=a(650),h=a(852),m=a(378),l=a(108),v=a(25);class r{constructor(A,x,n,u){this.bXb=null;this.cDg=A;this.mb=n;this.Qfe=x;this.ude=
new b.a;this.rh=u}X7a(){return this.mb.pa("SaveToCloudStorageUIIsEnabled")}P_e(){return v.a.saveToCloudStorage}D2b(){m.a.AKd(Object(e.a)(this,this.X0f,"saveToCloudActionDispatcher"));m.a.g$c([new h.a(v.a.saveToCloudStorage,l.a.frame,0)],this.Qfe.F4a())}Ag(){const A=this.Qfe.F4a();A?(A.t9(()=>{this.ude.setResult(!0)}),this.D2b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}RSf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}X0f(A,
x,n,u,z){return x.contextId!==l.a.frame||A!==this.P_e()?2:this.X7a()?1===n?d.SessionStatusManager.instance.p5a||f.AFrameworkApplication.O4?8:32:2===n?(this.RSf(),z&&z.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.rh&&(this.bXb=this.rh.Gc("DialogShown","SaveToOneDriveReponseTime")),this.ude.task.continueWith(()=>{this.bXb&&(this.bXb.stop(),this.bXb=null);this.cDg.start(z)}),32):8:8}}Object(t.a)(r,"SaveToCloudStorageActor",null,[329])},
1073:function(t,F,a){a.d(F,"a",function(){return A});t=a(0);var c=a(15),b=a(85),e=a(1074),f=a(4),d=a(39),h=a(40),m=a(242),l=a(376),v=a(167),r=a(777);class A{constructor(x,n,u,z,w){this.r8=this.Gm=this.VCa=null;this.EDa=!1;this.zh=this.qga=null;this.HUc=x;this.Flb=n;this.Es=u;this.Ze=z;this.rh=w}vNb(){this.Ze&&1===this.Ze.state||(this.Gm=this.Flb(),this.Gm.message=CommonUIStrings.l_CommentProgressTooltip,this.Gm.Ob=5,this.Gm.pt=!1,this.Gm.WAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}OIa(){this.Gm&&
(this.Gm.close(),this.Gm=null)}PR(){1!==f.AFrameworkApplication.ra.state&&this.Es().displayError(e.a.default)}mQa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.gf(this.r8,h.a.ZW(3),void 0,"UploadToCloudManager.RedirectToFolder")}lQa(x){let n=!1,u=!1;f.AFrameworkApplication.fa&&(n=f.AFrameworkApplication.fa.pa("SaveACopyIsEnabledForUiHost"),u=f.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
x,n);if(n&&u){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const z={};z[l.a.fQa]="1";z[l.a.documentUrl]=x;f.AFrameworkApplication.nQ().execute(w=>{w.jj(v.a.PY,z)})}else h.a.gf(x,h.a.ZW(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}aoa(x,n,u=null,z=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.rh&&(this.qga=this.rh.Gc("DialogShown","SaveToOneDriveUploadTime"));this.vNb();this.r8=n;this.VCa=this.HUc.create(x,
u,z);this.zh=z;this.UP()}UP(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.VCa.execute(Object(b.a)(this,this.PYi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.OYi,"onSaveToCloudUploadFailed"))}PYi(x){this.OIa();this.EDa=!1;if(x&&x.data&&x.data.de){var n;if(({ht:n}=d.d(x.data.de)).returnValue)if(x=n,x.StatusCode!==m.a.EO&&x.StatusCode!==m.a.Hsb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.PR();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{x.NewDocumentUrl&&""!==x.NewDocumentUrl?this.lQa(x.NewDocumentUrl):this.mQa()}catch(u){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",u.toString())}this.HHb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:r.a.Qfb(x.data.de)}),this.PR()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.PR()}OYi(x){5!==x.data.status&&12!==x.data.status||
this.EDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",x.data.status),this.OIa(),this.PR(),this.HHb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.EDa=!0,this.UP())}HHb(){this.qga&&(this.qga.stop(),this.qga=null)}}Object(t.a)(A,"UploadToCloudManager",null,[234])},1074:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.default=0;Object(t.a)(c,"SaveToCloudErrorCodes",null,[])},1075:function(t,F,a){a.d(F,"a",
function(){return d});t=a(0);var c=a(15),b=a(85),e=a(1074),f=a(83);class d{constructor(h,m,l,v,r,A){this.zh=null;this.WDg=h;this.I1=m;this.Zmb=l;this.mb=v;this.DRb=r;this.Es=A}start(h){this.zh=h;if("SharePointOnlineConsumer"===this.mb.Wa("FileSource")){const m=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(m){m.start(null,h);return}}this.I1.gMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.A0g()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.WDg.create().MP()}kj(){this.Es().displayError(e.a.default)}A0g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.DRb||2===this.DRb)h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.X5,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.kj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.Zmb.aoa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.zh)}X5(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.kj()}}Object(t.a)(d,"SaveToCloudManager",null,[330])},1076:function(t,F,a){a.d(F,"a",function(){return f});t=a(0);var c=a(15),b=a(40),e=a(79);a=a(722);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.Oxa;this.Tva=!0}get linkText(){return f.Ttf}fma(d){super.fma(d);b.a.openWindow(4,e.a.dH(f.Stf))}fD(d){super.fD(d);f.Jxd&&f.Jxd(null)}static initialize(d,h,m,l){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.Oxa=d;f.Ttf=h;f.Stf=m;f.Jxd=l}}f.Oxa=null;f.Ttf=null;f.Stf=null;f.Jxd=null;Object(t.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1077:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.Xth="ewa-bb";c.Yth="ewa-bb-entry";c.Zth="ewa-bb-react";c.WQe="ewa-bb-entry-body";c.bRe="ewa-bb-icon";c.YQe="ewa-bb-entry-icon";c.aRe="ewa-bb-entry-title";c.$Qe="ewa-bb-entry-message";c.t9b="ewa-bb-entry-button";c.ZQe="ewa-bb-entry-link";c.XQe="ewa-bb-entry-close";c.u9b="ewa-bb-entry-button-holder";c.VQe="ewa-bb-content";Object(t.a)(c,"CssClassNames",null,[])},1078:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);
a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.epa;this.message=c.cpa}get actionButton(){return c.bpa}Rm(b){super.Rm(b);(b=c.dpa)&&b(null)}static initialize(b,e,f,d){c.epa=b;c.cpa=e;c.bpa=f;c.dpa=d}}c.epa=null;c.cpa=null;c.bpa=null;c.dpa=null;Object(t.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1079:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.epa;this.message=
c.cpa}get actionButton(){return c.bpa}Rm(b){super.Rm(b);(b=c.dpa)&&b(null)}static initialize(b,e,f,d){c.epa=b;c.cpa=e;c.bpa=f;c.dpa=d}}c.epa=null;c.cpa=null;c.bpa=null;c.dpa=null;Object(t.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1080:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.epa;this.message=c.cpa}get actionButton(){return c.bpa}Rm(b){super.Rm(b);(b=c.dpa)&&b(null)}static initialize(b,
e,f,d){c.epa=b;c.cpa=e;c.bpa=f;c.dpa=d}}c.epa=null;c.cpa=null;c.bpa=null;c.dpa=null;Object(t.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1081:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.aEb;this.message=c.Oxa}get actionButton(){return c.d9a}Rm(b){super.Rm(b);c.Qxa&&c.Qxa(null)}static initialize(b,e,f,d){c.aEb=b;c.Oxa=e;c.d9a=f;c.Qxa=d}}c.aEb=null;c.Oxa=null;c.d9a=null;c.Qxa=null;Object(t.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1082:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);c.d9a&&c.Qxa&&(this.Yr=!0);this.title=c.aEb;this.message=c.Oxa}get actionButton(){return c.d9a}Rm(b){super.Rm(b);c.Qxa&&c.Qxa(null)}static initialize(b,e,f,d){c.aEb=b;c.Oxa=e;c.d9a=f;c.Qxa=d}}c.aEb=null;c.Oxa=null;c.d9a=null;c.Qxa=null;Object(t.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1084:function(t,
F,a){a.d(F,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.Ygb=function(){function b(){return l()&&(w()||3<=(n()?C("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){Ga||(Ga=!0,Ma=h("Windows Phone"))}function h(vb){vb=(new RegExp(vb+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var gb=-1;return null!=vb&&2<=vb.length&&(gb=parseFloat(vb[1]),
isNaN(gb)&&(gb=-1)),gb}function m(){return"function"==typeof navigator.msLaunchUri&&!f()&&!z()&&!v()}function l(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function r(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function A(){return r()?8==window.document.documentMode:!1}function x(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function n(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function u(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function z(){var vb=window.navigator.userAgent.toLowerCase();return 0<=vb.indexOf("android")&&0<=vb.indexOf("chrome")}function w(){return 3<=(x()?C("firefox/"):0)}function C(vb){var gb=window.navigator.userAgent.toLowerCase(),cb=gb.indexOf(vb),La,ja;return 0<=cb?(La=cb+vb.length,ja=gb.length,parseInt(gb.substring(La,ja))):0}function y(vb,gb,cb,La,ja){if(La&&null!=gb)gb();
else if(m())navigator.msLaunchUri(vb,gb,cb);else if(!(u()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&l())||v())H(vb,gb,cb);else if(u()&&ja)a:{try{window.open(vb,"_self")}catch(Ua){null!=cb&&cb();break a}null!=gb&&gb()}else B(vb,gb,cb)}function B(vb,gb,cb){var La=document.getElementById("OICLinkTag"),ja;null==La&&(La=document.createElement("a"),La.id="OICLinkTag",La.style.visibility="hidden",La.href="",La.target=0==(Fa.Options&
wb.SupportsTopTargetNavigation)||Fa.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(La),null!=La.addEventListener&&La.addEventListener("click",function(Ua){null!=Ua.stopPropagation&&Ua.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(ja=function(Ua){var lb=document.createEvent("MouseEvent");return lb.initMouseEvent(Ua,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),lb},ja.prototype=Event.prototype,window.MouseEvent=ja),La.href=vb,La.dispatchEvent(new MouseEvent("click"))}catch(Ua){null!=
cb&&cb();return}null!=gb&&gb()}function H(vb,gb,cb){var La=document.getElementById("OICFrame");null==La&&(La=document.createElement("iframe"),La.className="ObjectInDialog",La.style.visibility="hidden",La.src="about:blank",document.body.appendChild(La),La.id="OICFrame");try{La.contentWindow.location.href=vb}catch(ja){null!=cb&&cb();return}null!=gb&&gb()}function I(vb){return 0!=(vb.Options&wb.SkipProtocolHandler)||A()}function R(vb){return vb===Qa.ReadOnly||vb===Qa.ReadWrite}function S(vb,gb,cb,La){var ja,
Ua;try{if(ja=new ActiveXObject(Sa),ja)return Ua=ja.ViewDocument3(window.self,vb,gb,La),Ua?(O(ya.O14ActiveX),Na.None):Na.Failed}catch(lb){}if(wb.O14Only===(cb&wb.O14Only))return Fa.DescriptiveUnattemptedEnums?Na.O14AttemptFailure:Na.Unattempted;try{if(ja=new ActiveXObject(Da),ja)return Ua=ja.ViewDocument3(window.self,vb,gb,La),Ua?(O(ya.O12ActiveX),Na.None):Na.Failed}catch(lb){}if(wb.O12UpOnly===(cb&wb.O12UpOnly))return Fa.DescriptiveUnattemptedEnums?Na.O12UpOnlyFail:Na.Unattempted;try{if(ja=new ActiveXObject(ea),
ja)return Ua=R(gb)?ja.ViewDocument2(window.self,vb,La):ja.EditDocument2(window.self,vb,La),Ua?(O(ya.O11ActiveX),Na.None):Na.Failed}catch(lb){}return Fa.DescriptiveUnattemptedEnums?Na.ActiveXUnattempted:Na.Unattempted}function G(vb,gb,cb,La,ja){var Ua,lb,sb;vb==nb.Visio&&cb==Qa.ReadWrite&&(cb=Qa.WriteOnly);vb=ja;(La=La||f()&&!(d(),8<=Ma))||(Ua="",Ua+=R(cb)?mb+W:Q,Ua+=va,vb+=E(Ua));vb+=E(gb);Fa.NewTelemetryDataIsEnabled&&(lb=Fa.SessionOrigin?"|or|"+Fa.SessionOrigin:"",lb+=Fa.ClickTime?"|ct|"+Fa.ClickTime:
"",lb+=Fa.CorrelationId?"|cid|"+Fa.CorrelationId:"",vb+=E(lb),Fa.CorrelationIdForWinClient&&(vb+=E(Fa.CorrelationIdForWinClient)));gb=window.location.href;cb=Ba;La=gb.toLowerCase().indexOf("&"+cb+"=");var V;cb=-1==La?void 0:(sb=La+(cb.length+2),V=gb.indexOf("&",sb),-1==V)?gb.substr(sb):gb.substring(sb,V);if(null!=cb&&"undefined"!=typeof cb){sb="";try{sb=decodeURIComponent(cb)}catch(za){}0<sb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(sb)&&(vb+=na,vb+=sb)}return vb}function D(vb,
gb,cb,La,ja,Ua){var lb=Z(vb),sb;return null==lb?(ca(Fa.DescriptiveUnattemptedEnums?Na.ProtocolHandlerIsNull:Na.Unattempted,Fa.Application),!1):(sb=G(vb,gb,cb,La,lb),y(sb,M,L,ja,Ua),!0)}function E(vb){if(l()&&u()){var gb="";try{gb=decodeURI(vb)}catch(cb){}if(gb==vb)return encodeURI(vb)}return vb}function M(){O(ya.ProtocolHandler)}function L(){Fa.Options|=wb.SkipProtocolHandler;qa(Fa,Wb,nc)}function N(){null!=Yb&&Yb(ya.RoamingProtocolHandler)}function Y(){null!=pb&&pb(Na.ControlNeeded)}function U(){var vb=
document.getElementById(db),gb;if(null==vb){if(gb=sa,l()&&3<=(n()?C("version/"):0)&&P(Ea,!0)&&(gb=Ea),!P(gb,!0))if(l()&&P(Ca,!0))gb=Ca;else return null;vb=document.createElement("object");vb.id=db;vb.type=gb;vb.style.width="0px";vb.style.height="0px";vb.style.setProperty("visibility","hidden","");document.body.appendChild(vb);vb=document.getElementById(db)}return vb}function P(vb,gb){var cb=window.navigator.mimeTypes,La;return null==cb?!1:(La=cb[vb],La)?gb&&!La.enabledPlugin?!1:!0:!1}function aa(vb){try{if(null!=
new ActiveXObject(vb))return!0}catch(gb){}return!1}function X(vb){switch(vb){case nb.OneNote:return kb;default:return""}}function Z(vb){if(vb!=nb.OneNote&&f()&&!(d(),8<=Ma))return"office:";switch(vb){case nb.Excel:return"ms-excel:";case nb.OneNote:return"onenote:";case nb.PowerPoint:return"ms-powerpoint:";case nb.Visio:return"ms-visio:";case nb.Word:return"ms-word:";case nb.Project:return"ms-project:";case nb.Publisher:return"ms-publisher:";case nb.Infopath:return"ms-infopath:";case nb.Access:return"ms-access:";
default:return""}}function da(vb){switch(vb){case nb.Excel:return"root\\office15\\excel.exe";case nb.PowerPoint:return"root\\office15\\powerpnt.exe";case nb.Visio:return"root\\office15\\visio.exe";case nb.Word:return"root\\office15\\winword.exe";case nb.Project:return"root\\office15\\winproj.exe";case nb.Publisher:return"root\\office15\\mspub.exe";case nb.Infopath:return"root\\office15\\infopath.exe";case nb.Access:return"root\\office15\\msaccess.exe";default:return null}}function qa(vb,gb,cb){if(Fa=
vb,Wb=gb,nc=cb,vb.DocumentUrl){var La=cb=gb=vb.DocumentUrl;try{La=decodeURIComponent(vb.DocumentUrl)}catch(za){}try{cb=encodeURI(vb.DocumentUrl)}catch(za){}Fa.NewTelemetryDataIsEnabled||(gb=gb+""+vb.CorrelationIdForWinClient,La+=vb.CorrelationIdForWinClient,cb+=vb.CorrelationIdForWinClient);vb.Mode===Qa.ReadWrite&&wb.CheckoutRequired===(vb.Options&wb.CheckoutRequired)&&(vb.Mode=Qa.ForceCheckout);wb.HostIsEditOnly===(vb.Options&wb.HostIsEditOnly)&&(vb.Mode=Qa.WriteOnly);if(I(vb)?0:l()&&(vb.Application==
nb.OneNote||P(ba,!1)||P(ka,!1))||m()||z()||!(b()||w()||"ActiveXObject"in window&&!f()||u())||15<=wa())D(vb.Application,vb.EncodeUrl?cb:gb,vb.Mode,vb.Application==nb.OneNote,vb.SilentExternalHandler,vb.NavigateUsingWindowOpen);else{var ja;if(ja=A())a:{var Ua=vb.EncodeUrl?gb:La,lb=vb.Mode,sb=X(vb.Application);try{ja=(new ActiveXObject(Ha)).ViewDocument3(window.self,Ua,lb,sb);break a}catch(za){}ja=!1}if(ja)O(ya.O15ActiveX);else{if(b()||w()){var V=vb.EncodeUrl?gb:La;La=vb.Mode;ja=X(vb.Application);Ua=
U();if(null==Ua)V=Fa.DescriptiveUnattemptedEnums?Na.PluginIsNull:Na.Unattempted;else{lb=!1;try{lb=Ua.ViewDocument3(window.self,V,La,ja)}catch(za){}if(!lb)try{lb=R(La)?Ua.ViewDocument2(window.self,V,ja):Ua.EditDocument2(window.self,V,ja)}catch(za){}V=lb?(O(ya.NpapiPlugin),Na.None):Na.Failed}}else{try{V=new ActiveXObject(yb),null!=V&&V.SaveSSOCreds()}catch(za){}V=S(vb.EncodeUrl?gb:La,vb.Mode,vb.Options,X(vb.Application))}if(V!=Na.None){if(La=vb.CouldUseRoamingApps)ab||(ab=!0,Gb=h("Windows NT")),La=
6.1<=Gb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(r()||w()||u());if(La&&vb.Application!=nb.OneNote){if(!c.Ygb.v7j()){ca(Na.ControlNeeded,Fa.Application);return}if(vb.RoamingAppsLauncher){"undefined"==typeof vb.RoamingAppsLauncher||null==vb.RoamingAppsLauncher?ca(Fa.DescriptiveUnattemptedEnums?Na.RoamingLauncherIsNull:Na.Unattempted,Fa.Application):"undefined"==typeof vb.RoamingBitsUrl||null==vb.RoamingBitsUrl?c.Ygb.G7j(vb.DocumentUrl,vb.RoamingAppsLauncher,vb.Application,vb.ApplicationParameters,
Wb,nc):c.Ygb.Wpg(vb.DocumentUrl,vb.RoamingAppsLauncher,vb.RoamingApplicationExe,vb.ApplicationParameters,vb.RoamingPlatform,vb.RoamingBitsUrl,Wb,nc);return}if(!vb.ContinueIfLauncherIsNull){ca(Na.LauncherNeeded,Fa.Application);return}}wb.NoProtocolHandlerFallback==(vb.Options&wb.NoProtocolHandlerFallback)||I(vb)||r()||l()&&!(Fa.DescriptiveUnattemptedEnums?V>=Na.O14Unattempted&&V<=Na.DocumentUrlIsNull:V==Na.Unattempted)?ca(V,Fa.Application):D(vb.Application,vb.EncodeUrl?cb:gb,vb.Mode,vb.Application==
nb.OneNote,vb.SilentExternalHandler,vb.NavigateUsingWindowOpen)}}}}else ca(Fa.DescriptiveUnattemptedEnums?Na.DocumentUrlIsNull:Na.Unattempted,Fa.Application)}function O(vb){null!=Wb&&Wb(vb)}function ca(vb,gb){"undefined"==typeof gb&&(gb=null);null!=nc&&nc(vb,gb)}function wa(){var vb=0;if(b()||w()||u()){var gb=U();try{null!=gb&&(vb=gb.GetOfficeVersion())}catch(cb){}}else aa(Ha)?vb=15:aa(Sa)?vb=14:aa(Da)?vb=12:aa(ea)&&(vb=11);return vb}function ia(){return l()&&(P(sa,!0)||P(Ea,!0))}var Ha="SharePoint.OpenDocuments.5",
Sa="SharePoint.OpenDocuments.4",Da="SharePoint.OpenDocuments.3",ea="SharePoint.OpenDocuments.2",sa="application/x-sharepoint",Ea="application/x-sharepoint-webkit",ba="application/x-sharepoint-protocolhandler",ka="application/x-sharepoint-webkit-protocolhandler",Ca="application/officelive",db="npSharePointPlugin",yb="IDBHO.IDBHOCtrl",kb="OneNote.Notebook",mb="ofv|",W="ofc|",Q="ofe|",va="u|",na="|f|",Ba="wdlor",Oa="",oa="",Ja="",Wb,nc,Yb,pb,Fa,ab,Gb,Ga,Ma,Qa={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,
WriteLocalCopy:4,OpenInBrowser:5},wb={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Na={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},ya={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,
O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},nb={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Qa,OpenDocumentOptions:wb,OpenDocumentFailureType:Na,OpenDocumentControl:ya,OfficeApplication:nb,EditDocumentInClient:qa,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=nb.Unknown;this.CouldUseRoamingApps=
!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:wa,IsO14MacPluginInstalled:ia,OfferOfficeInDialog:function(){return e()&&
11>=wa()},OfferOfficeNoIntrusive:function(){return e()&&15>wa()},OfferMacOffice:function(){return l()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ia()},InstallRoamingControl:function(){x()?window.InstallTrigger.install({Office:{URL:oa}}):H(Ja,null,null)},CanUseRoamingControl:function(){var vb,gb,cb;if(m())return!0;if(u())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(x())return vb=document.createElement("RoamingExtensionElement"),
document.documentElement.appendChild(vb),gb=document.createEvent("Events"),gb.initEvent("RoamingOfficeInstalled",!0,!1),vb.dispatchEvent(gb),!!vb.getAttribute("installed");if(r())try{return cb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),cb.HrExists()}catch(La){}return!1},InitUrls:function(vb,gb,cb){Oa=vb;oa=cb;Ja=gb},LaunchRoamingApps:function(vb,gb,cb,La,ja,Ua){c.Ygb.Wpg(vb,gb,da(cb),La,"x86",Oa,ja,Ua)},LaunchRoamingApps2:function(vb,gb,cb,La,ja,Ua,lb,sb){var V="",za;if(null!=La&&(V+=
" "+La),null!=vb&&(V+=' "'+vb+'"'),m()||u())Yb=lb,pb=sb,lb='office: "'+(Ua+'" "')+(cb+'" "ROAMING"'),lb+=' "'+gb+'"',lb+=' "'+ja+'"',lb+=" "+V,y(lb,N,Y,!1,!1);else if(x())vb=document.createElement("RoamingExtensionElement"),vb.setAttribute("cabUrl",Ua),vb.setAttribute("app",cb),vb.setAttribute("licensingEntitlements",gb),vb.setAttribute("platform",ja),vb.setAttribute("args",V),document.documentElement.appendChild(vb),gb=document.createEvent("Events"),gb.initEvent("RoamingOfficeLaunch",!0,!1),vb.dispatchEvent(gb),
null!=lb&&lb(ya.RoamingFFExtension);else if(r()){if(za=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=za)try{za.HrConfigureSingle(Ua,cb,gb,ja,V),null!=lb&&lb(ya.RoamingActiveX)}catch(Ra){}}else null!=sb&&sb(Na.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:B,OpenDocumentWithProtocolHandler:D,OpenDocumentWithProtocolHandlerNoCallBack:function(vb,gb,cb,La){var ja=Z(vb),Ua;return null==ja?(ca(Fa.DescriptiveUnattemptedEnums?Na.ProtocolHandlerNoCallbackIsNull:
Na.Unattempted,Fa.Application),!1):(Ua=G(vb,gb,cb,La,ja),y(Ua,null,null,!1,!1),!0)}}}();c.ClientUtils=c.Ygb},1085:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);var c=a(40);class b{constructor(e,f){this._url=e;this.bBg=f}Vve(){}P8c(){this.bBg?c.a.downloadFile(this._url):c.a.gf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(t.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,[309,2])},1086:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);
const b=()=>{c.a.Ai('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1087:function(t,F,a){a.d(F,"a",function(){return d});t=a(0);var c=a(1217),b=a(4),e=a(54),f=a(83);class d{constructor(h,m,l,v,r,A){this.GX=h;this.HX=m;this.aMc=l;this.MD=v;this.WSb=r;this.bVa=A}get M9f(){return!this.HX&&!this.aMc}get Byf(){return 2===this.bVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get vQe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get hdf(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Zva(){return CommonUIStrings.l_OICErrorHelpLink}get Jbf(){return"OICFailure"}get icon(){return 3}get gZb(){return 2===
this.bVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get el(){return CommonUIStrings.l_DefaultDialogTitle}pcj(h){this.Yyf(h)}ozi(h){this.Yyf(h)}Yyf(h){let m=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").glc(this.bVa),m=3):2===h&&((!this.aMc||this.aMc(this.MD))&&this.HX&&c.a.instance.Peh(this.HX,this.GX,this.MD),m=5);(0===h||1===h)&&this.GX&&this.GX(this.MD);b.AFrameworkApplication.mvc(e.a.EKf,this.WSb,m);this.dispose()}dispose(){this.MD=
this.HX=this.GX=null}}Object(t.a)(d,"AOICErrorDialogWithTrial",null,[2])},1088:function(t,F,a){a.d(F,"a",function(){return d});t=a(0);var c=a(1384),b=a(4),e=a(39),f=a(79);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}AQd(){return e.c([this.Iaa(),this])}execute(h,m,l){let v="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=f.a.wl(v,"wdEnableRoaming","1"));b.AFrameworkApplication.Bd.Im(v,2,this.AQd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.yxb(),h,m,l,void 0,void 0,void 0,void 0,"6")}}Object(t.a)(d,"ARoamingAppsRequest",null,[])},1089:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1090:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1091:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1097:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.dqi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.mTa=(e.DirectPrintSupportedMimeTypes||
"").split(b.u8c);this.nTa=(e.DirectPrintSupportedPlugins||"").split(b.u8c);this.hei=(e.DirectPrintImmersivePreviewPlugins||"").split(b.u8c);this.Zhf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.Dmi=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.f4g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.ozd=14;this.Vvf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.ozd=parseInt(f[0]),this.Vvf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.u8c=",";Object(t.a)(b,"DirectPrintBrsSettings",null,[])},1098:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(t.a)(c,"PrintPreviewPaneProps",null,[])},1167:function(t,F,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1367),h=a(709),m=a(50),l=a(37),v=a(1),r=a(920),A=a(65),x=a(41),n=a(188),u=a(21),z=a(375),w=a(574);class C{constructor(ib,Vb){this.THd=0;this.Z$d=!1;this.Sz=ib;this.ignorePrintArea=Vb}get Sz(){return this.THd}set Sz(ib){0<=ib&&2>=ib?this.THd=ib:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.THd=1)}get ignorePrintArea(){return this.Z$d}set ignorePrintArea(ib){ib||!ib?this.Z$d=ib:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(C,"PdfPrintDialogBrowserSessionState",null,[]);var y=a(7),B=a(136),H=a(174),I=a(99),R=a(1422);class S{constructor(ib,Vb){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=ib;this.addToPrintArea=Vb}}Object(b.a)(S,"MacroRecorderPrintAreaSetPayload",null,[122]);var G=a(374),D=a(192),E=a(11),M=a(13),L=a(282),N=
a(66);class Y{constructor(ib){this.sharedSheetCell=null;this.sharedSheetCell=ib}}Object(b.a)(Y,"MacroRecorderPageBreakInsertedPayload",null,[122]);class U{constructor(ib){this.sharedSheetCell=null;this.sharedSheetCell=ib}}Object(b.a)(U,"MacroRecorderPageBreakRemovedPayload",null,[122]);class P{constructor(ib){this.sheetName=null;this.sheetName=ib}getSheetName(){return this.sheetName}}Object(b.a)(P,"MacroRecorderPageBreaksAllResetPayload",null,[122]);class aa{constructor(ib){this.sheetName=null;this.sheetName=
ib}getSheetName(){return this.sheetName}}Object(b.a)(aa,"MacroRecorderPrintAreaClearedPayload",null,[122]);var X=a(60);const Z=(ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=ib.Na(9,Fb);Fb.sheetName=Vb;Fb.printSettings=wc;return X.g(ib,"SetSheetPrintSettings",Fb,Lc,Fc,fd,Ta,0)},da=(ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=ib.Na(1,Ta);Ta.ConvertInParameters=Vb;return X.g(ib,"ConvertWorkbookToPrintPdf",Ta,wc,Lc,Fc,fd,4)},qa=(ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=ib.Na(1,Fb);Fb.sheetName=Vb;Fb.printOptions=wc;return X.g(ib,
"SetPrintOptions",Fb,Lc,Fc,fd,Ta,0)},O=(ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=ib.Na(1,Fb);Fb.sheetName=Vb;Fb.locale=wc;return X.g(ib,"GetPrintSettings",Fb,Lc,Fc,fd,Ta,4)},ca=(ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=ib.Na(1,Fb);Fb.selectedRanges=Vb;Fb.addToPrintArea=wc;return X.g(ib,"SetPrintArea",Fb,Lc,Fc,fd,Ta,0)},wa=(ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=ib.Na(1,Ta);Ta.sheetName=Vb;return X.g(ib,"ClearPrintArea",Ta,wc,Lc,Fc,fd,0)},ia=(ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=ib.Na(9,Ta);Ta.sheetCell=Vb;return X.g(ib,
"InsertPageBreak",Ta,wc,Lc,Fc,fd,0)},Ha=(ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=ib.Na(9,Ta);Ta.sheetCell=Vb;return X.g(ib,"RemovePageBreak",Ta,wc,Lc,Fc,fd,0)},Sa=(ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=ib.Na(9,Ta);Ta.sheetName=Vb;return X.g(ib,"ResetAllPageBreaks",Ta,wc,Lc,Fc,fd,0)};var Da=a(129),ea=a(115),sa=a(52),Ea=a(193);class ba{constructor(){this.Col=this.Row=null}}Object(b.a)(ba,"PageBreaksInformation",null,[]);class ka{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(ka,"RowColBreak",null,[]);
class Ca{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(Ca,"SharedRange",null,[]);var db=a(179),yb=a(55);class kb{constructor(ib){this.ribbonCommandInfo=this.ZGb=null;this.JUj=(Vb,wc,Lc)=>{wc=!!Vb&&!!Vb.RequestTelemetryData;u.h(this.$).vh&&u.h(this.$).vh.zla(this.dLa.ma(this.ribbonCommandInfo.command),Vb.StateId,wc?Vb.RequestTelemetryData.EcsOperationDuration:0,wc?Vb.RequestTelemetryData.EcsRequestDuration:0,wc?Vb.RequestTelemetryData.WfeRequestDuration:0);
E.HelperMethods.OZ&&this.g3g(Lc)};this.$=ib;this.dLa=new db.a;this.Kva=new db.a;this.Kva.add(78661008,12);this.Kva.add(275604654,13);this.Kva.add(-13332329,14);this.Kva.add(-837651977,9);this.Kva.add(-1778266776,10);this.Kva.add(845325699,11)}executeCommand(ib,Vb,wc,Lc,Fc=null,fd=null,Ta=null){this.ribbonCommandInfo=Vb;this.GMj(Vb.command);ib=L.b(Fc,this.JUj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Vb.command} command execution started`);switch(Vb.command){case 78661008:return this.aaf(Vb,
ib,fd,Ta,!1);case 275604654:return this.aaf(Vb,ib,fd,Ta,!0);case -13332329:return this.Z9e(Vb,ib,fd,Ta);case -837651977:return this.z9h(Vb,ib,fd,Ta);case -1778266776:return this.B$h(Vb,ib,fd,Ta);case 845325699:return this.W$e(Vb,ib,fd,Ta)}return n.a(Vb.command)}wc(ib,Vb){switch(Vb.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===ib;case 845325699:case -13332329:return!0}return!1}T5f(ib,Vb,wc){const Lc=u.h(this.$);var Fc=Lc.Ca;const fd=x.r(Lc.ha.qa.selectedRanges,this.$);
if((Fc=Fc.JA())&&Fc.length){for(const Ta of Fc){Fc=Ta;const Fb=Fc.lf;if(!Fb)continue;const ic=x.j(Fc.Je),zb=[];for(const Bb of fd.Ranges){if(Bb.FirstRow>ic.LastRow+1||Bb.LastRow<ic.FirstRow||Bb.FirstColumn>ic.LastColumn+1||Bb.LastColumn<ic.FirstColumn)continue;const ec=this.k0h(ic,Bb,Fb),Qd=this.j0h(ic,Bb,Fb);zb.push(Object(y.a)(new Ca,{FirstRow:ec.FirstRow,FirstColumn:Qd.FirstColumn,LastRow:ec.LastRow,LastColumn:Qd.LastColumn}))}0<zb.length&&!wc?Fb.setPrintArea(zb):0<zb.length&&wc?Fb.addToPrintArea(zb):
!wc&&Fb.hasPrintArea()&&Fb.clearPrintArea();!Fb.isDirty()&&Fb.hasPageLayout()&&Fb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Fc.Xc,4)}this.oPb(Lc,ib,Vb)}}W4g(ib,Vb){const wc=u.h(this.$);var Lc=u.h(this.$).Ca.JA();if(Lc&&Lc.length){for(const Fc of Lc){Lc=Fc;const fd=Lc.lf;fd&&(fd.clearPrintArea(),!fd.isDirty()&&fd.hasPageLayout()&&fd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Lc.Xc,4))}this.oPb(wc,ib,Vb)}}Tii(ib,Vb){const wc=u.h(this.$);var Lc=wc.Ca;
const Fc=x.o(wc.ha.qa.activeCell,this.$);if(Fc){var fd=Lc.JA();if(fd&&fd.length){Lc=null;for(var Ta of fd){let Fb=Ta,ic=Fb.lf;if(!ic)continue;let zb=x.j(Fb.Je);if(!(Fc.FirstRow>zb.LastRow||Fc.FirstRow<zb.FirstRow||Fc.FirstColumn>zb.LastColumn||Fc.FirstColumn<zb.FirstColumn)&&(Lc=this.bfh(ic,zb,Fc),ic.insertPageBreak(Lc),!ic.isDirty()&&ic.hasPageLayout()&&ic.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Fb.Xc,4),Lc))break}if(!Lc)for(const Fb of fd)if(Lc=Fb,Ta=Lc.lf)Lc=x.j(Lc.Je),
Lc=this.yIe(Ta,Lc,Fc),Ta.insertPageBreak(Lc);this.oPb(wc,ib,Vb)}}}Zhj(ib,Vb){const wc=u.h(this.$);var Lc=wc.Ca;const Fc=x.o(wc.ha.qa.activeCell,this.$);if(Fc&&(Lc=Lc.JA())&&Lc.length){for(const Ta of Lc){Lc=Ta;const Fb=Lc.lf;if(Fb){var fd=x.j(Lc.Je);(fd=this.yIe(Fb,fd,Fc))&&Fb.removePageBreak(fd);!Fb.isDirty()&&Fb.hasPageLayout()&&Fb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+Lc.Xc,4)}}this.oPb(wc,ib,Vb)}}Onj(ib,Vb){const wc=u.h(this.$);var Lc=wc.Ca.JA();if(Lc&&Lc.length){for(const Fc of Lc){Lc=
Fc;const fd=Lc.lf;fd&&(fd.resetAllPageBreak(),!fd.isDirty()&&fd.hasPageLayout()&&fd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Lc.Xc,4))}this.oPb(wc,ib,Vb)}}aaf(ib,Vb,wc,Lc,Fc){if(!Fc){var fd=this.$.yb.getItemByName("PRINT_AREA");if(fd&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${fd.type}`),2===fd.type))return this.xki(),yb.Task.Ra(!0)}fd=u.h(this.$).ha.qa;const Ta=x.r(fd.selectedRanges,
this.$);if(1===Ta.Ranges.length&&!Fc){if(fd.Dba())return this.S$h(ib,Ta,Vb,wc,Lc,Fc),yb.Task.Ra(!0);if(x.R(Ta.Ranges[0]))return this.$.va.na.hasPrintArea?this.Z9e(ib,Vb,wc,Lc):yb.Task.Ra(!0)}this.T5f(ib.command,Lc,Fc);return this.fgf(ib,Vb,wc,Ta,Fc)}Z9e(ib,Vb,wc,Lc){this.W4g(ib.command,Lc);return this.jki(ib,Vb,wc)}z9h(ib,Vb,wc,Lc){this.Tii(ib.command,Lc);return this.uki(ib,Vb,wc)}B$h(ib,Vb,wc,Lc){const Fc=x.r(u.h(this.$).ha.qa.selectedRanges,this.$);if(x.R(Fc.Ranges[0]))return this.W$e(ib,Vb,wc,
Lc);this.Zhj(ib.command,Lc);return this.zki(ib,Vb,wc)}W$e(ib,Vb,wc,Lc){this.Onj(ib.command,Lc);return this.Cki(ib,Vb,wc)}fgf(ib,Vb,wc,Lc,Fc){const fd=this.$.oa.xa,Ta=()=>new S(Lc,Fc);return G.a(this.$.userOperationManager,(Fb,ic,zb)=>ca(fd,Lc,Fc,L.b(Fb,Vb),L.a(ic,wc),zb,null),Fb=>new D.a(241,0,Fb,64,Ta),ib)}jki(ib,Vb,wc){const Lc=this.$.va.na.name,Fc=this.$.oa.xa,fd=()=>new aa(Lc);return G.a(this.$.userOperationManager,(Ta,Fb,ic)=>wa(Fc,Lc,L.b(Ta,Vb),L.a(Fb,wc),ic,null),Ta=>new D.a(243,0,Ta,64,fd),
ib)}uki(ib,Vb,wc){const Lc=u.h(this.$),Fc=x.o(Lc.ha.qa.activeCell,this.$),fd=()=>new Y(Fc);return G.a(this.$.userOperationManager,(Ta,Fb,ic)=>ia(this.$.oa.xa,Fc,L.b(Ta,Vb),L.a(Fb,wc),ic,null),Ta=>new D.a(244,0,Ta,64,fd),ib)}zki(ib,Vb,wc){const Lc=u.h(this.$),Fc=x.o(Lc.ha.qa.activeCell,this.$),fd=()=>new U(Fc);return G.a(this.$.userOperationManager,(Ta,Fb,ic)=>Ha(this.$.oa.xa,Fc,L.b(Ta,Vb),L.a(Fb,wc),ic,null),Ta=>new D.a(245,0,Ta,64,fd),ib)}Cki(ib,Vb,wc){const Lc=this.$.va.na.name,Fc=()=>new P(Lc);
return G.a(this.$.userOperationManager,(fd,Ta,Fb)=>Sa(this.$.oa.xa,Lc,L.b(fd,Vb),L.a(Ta,wc),Fb,null),fd=>new D.a(246,0,fd,64,Fc),ib)}k0h(ib,Vb,wc){if(!ib||!Vb||!wc)return null;const Lc=new Ca;Lc.FirstRow=Vb.FirstRow===ib.LastRow+1?wc.getRowIndex(ib.LastRow+1)+1:Vb.FirstRow<ib.FirstRow?0:wc.getRowIndex(Vb.FirstRow+1);Lc.LastRow=Vb.FirstRow===ib.LastRow+1||Vb.LastRow>ib.LastRow?wc.getRowIndex(ib.LastRow+1)+1:wc.getRowIndex(Vb.LastRow+1);return Lc}j0h(ib,Vb,wc){if(!ib||!Vb||!wc)return null;const Lc=
new Ca;Lc.FirstColumn=Vb.FirstColumn===ib.LastColumn+1?wc.getColumnIndex(ib.LastColumn+1)+1:Vb.FirstColumn<ib.FirstColumn?0:wc.getColumnIndex(Vb.FirstColumn+1);Lc.LastColumn=Vb.FirstColumn===ib.LastColumn+1||Vb.LastColumn>ib.LastColumn?wc.getColumnIndex(ib.LastColumn+1)+1:wc.getColumnIndex(Vb.LastColumn+1);return Lc}bfh(ib,Vb,wc){if(!Vb||!wc||!ib)return null;const Lc=ib.getPrintArea();if(!Lc||!Lc.length)return null;const Fc=ib.getRowIndex(wc.FirstRow+1),fd=ib.getColumnIndex(wc.FirstColumn+1);let Ta=
null,Fb=null;for(const ic of Lc)if(Fc>=ic.FirstRow&&Fc<=ic.LastRow&&fd>=ic.FirstColumn&&fd<=ic.LastColumn){if(wc.FirstRow===ic.FirstRow&&wc.FirstColumn===ic.FirstColumn)return new ba;Fc>ic.FirstRow&&(Ta=Object(y.a)(new ka,{Index:Fc-1,Min:ic.FirstColumn-1,Max:Math.min(ic.LastColumn,ib.getColumnIndex(Vb.LastColumn+1))}));fd>ic.FirstColumn&&(Fb=Object(y.a)(new ka,{Index:fd-1,Min:ic.FirstRow-1,Max:Math.min(ic.LastRow,ib.getRowIndex(Vb.LastRow+1))}));break}return Ta||Fb?Object(y.a)(new ba,{Row:Ta?[Ta]:
null,Col:Fb?[Fb]:null}):null}rgh(ib,Vb,wc){if(!Vb||!wc||!ib)return null;let Lc=null;wc.FirstRow>Vb.FirstRow&&wc.FirstRow<=Vb.LastRow?Lc=Object(y.a)(new ka,{Index:ib.getRowIndex(wc.FirstRow+1)-1,Min:-1,Max:-1}):wc.FirstRow===Vb.LastRow+1&&(Lc=Object(y.a)(new ka,{Index:ib.getRowIndex(Vb.LastRow+1),Min:-1,Max:-1}));return Lc}Lbh(ib,Vb,wc){if(!Vb||!wc||!ib)return null;let Lc=null;wc.FirstColumn>Vb.FirstColumn&&wc.FirstColumn<=Vb.LastColumn?Lc=Object(y.a)(new ka,{Index:ib.getColumnIndex(wc.FirstColumn+
1)-1,Min:-1,Max:-1}):wc.FirstColumn===Vb.LastColumn+1&&(Lc=Object(y.a)(new ka,{Index:ib.getColumnIndex(Vb.LastColumn+1),Min:-1,Max:-1}));return Lc}yIe(ib,Vb,wc){if(!wc||!ib||!Vb)return null;const Lc=this.rgh(ib,Vb,wc);ib=this.Lbh(ib,Vb,wc);return Lc||ib?Object(y.a)(new ba,{Row:Lc?[Lc]:null,Col:ib?[ib]:null}):null}xki(){const ib=new B.StandardDialog;ib.Ob=0;ib.tc(1,M.a.instance.ga(4));ib.Wl(M.a.instance.ga(568),M.a.instance.ga(569),1,null)}GMj(ib){if(this.Kva.hb(ib)&&(E.HelperMethods.OZ&&(this.ZGb=
this.$.Jb.Gc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.dLa.hb(ib)&&this.dLa.remove(ib),this.dLa.add(ib,H.a.create().toString()),u.h(this.$).vh)){const Vb=sa.b()?sa.b().Cj(ib):"";u.h(this.$).vh.u0(this.Kva.ma(ib),this.dLa.ma(ib),Vb)}}g3g(ib){if(this.ZGb&&ib){const Vb=this.ZGb.Bc;this.ZGb.stop();this.ZGb=null;switch(ib){case "SetPrintArea":this.Xqb(Vb,1700,ib);break;case "ClearPrintArea":this.Xqb(Vb,1500,ib);break;case "InsertPageBreak":this.Xqb(Vb,1500,ib);break;case "RemovePageBreak":this.Xqb(Vb,
1600,ib);break;case "ResetAllPageBreaks":this.Xqb(Vb,1700,ib)}}}Xqb(ib,Vb,wc){ib>Vb&&(Vb=Object(y.a)(new Ea.a,{extendedProperties:new Map}),Vb.extendedProperties.set("OperationName",wc),Vb.extendedProperties.set("OperationExecutionTime",ib.toString()),I.Health.instance.recordQosError(Da.a.sLj,[ea.a.nLj],!1,!0,!0,!1,Vb))}S$h(ib,Vb,wc,Lc,Fc,fd){const Ta=new B.StandardDialog,Fb=new R.a(M.a.instance.ga(566),M.a.instance.ga(567),M.a.instance.ga(6),M.a.instance.ga(5));Ta.Ob=1;Ta.tc(1,Fb.confirmButton);
Ta.tc(0,Fb.cancelButton);Ta.Wl(Fb.title,Fb.body,3,ic=>{1===ic&&(this.T5f(ib.command,Fc,fd),this.fgf(ib,wc,Lc,Vb,fd))})}oPb(ib,Vb,wc){wc();this.dLa.hb(Vb)&&ib.vh.UR(this.dLa.ma(Vb),N.BasicTelemetryCalculator.zQ)}}Object(b.a)(kb,"PrintAreaBreakManager",null,[358]);var mb=a(387),W=a(89),Q=a(27);class va{constructor(){this.margin=this.Z_=this.Lca=this.orientation=this.Sz=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.b2a=!1;this.NoColor=null}equals(ib){return ib?this.orientation===ib.orientation&&
this.Lca===ib.Lca&&this.Z_===ib.Z_&&this.margin===ib.margin&&this.sheetPrintOptions===ib.sheetPrintOptions&&this.b2a===ib.b2a&&this.NoColor===ib.NoColor:!1}static yGe(ib,Vb){ib&&Vb&&(Vb.Sz=ib.Sz,Vb.orientation=ib.orientation,Vb.Lca=ib.Lca,Vb.Z_=ib.Z_,Vb.margin=ib.margin,Vb.ignorePrintArea=ib.ignorePrintArea,Vb.sheetPrintOptions=ib.sheetPrintOptions,Vb.b2a=ib.b2a,Vb.NoColor=ib.NoColor)}}Object(b.a)(va,"PrintSettingsContainer",null,[]);var na=a(8),Ba=a(59),Oa=a(300),oa=a(987),Ja=a(213),Wb=a(113),nc=
a(157),Yb=a(347),pb=a(38),Fa=a(29),ab=a(22),Gb=a(854),Ga=a(793),Ma=a(191),Qa=a(648),wb=a(552);class Na{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(Na,"PrintSettingMarginOption",null,[]);class ya{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(ya,"PrintSettingMarginValue",null,[]);class nb{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(nb,"PrintSettingOption",null,[]);class vb{constructor(ib){this.$Ki=
[.75,.75,.7,.7,.3,.3];this.SJi=[.75,.75,.25,.25,.3,.3];this.$5j=[1,1,1,1,.5,.5];this.Wde=this.Vie=this.pge=this.Zfe=this.Eme=this.r6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.cm=ib;this.Dhi();this.Jhi()}get whatToPrintOptions(){return this.Eme}get orientationOptions(){return this.Zfe}get paperSizeOptions(){return this.pge}get scalingOptions(){return this.Vie}get marginDetailedOptions(){return this.Wde}dispose(){}xxb(ib){if(!ib)return null;const Vb=new ya;Vb.left=ib.Left;
Vb.right=ib.Right;Vb.top=ib.Top;Vb.bottom=ib.Bottom;Vb.header=ib.Header;Vb.footer=ib.Footer;return Vb}g6c(ib){e.ULS.shipAssertTag(537154186,0,6===ib.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Vb={};Vb.Top=ib[0];Vb.Bottom=ib[1];Vb.Left=ib[2];Vb.Right=ib[3];Vb.Header=ib[4];Vb.Footer=ib[5];return Vb}Jhi(){this.Eme=[Object(y.a)(new nb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1228)}),Object(y.a)(new nb,{printSettingOptionKey:2,
printSettingOptionText:this.cm.ga(1221)}),Object(y.a)(new nb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1220)})];this.Zfe=[Object(y.a)(new nb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1231)}),Object(y.a)(new nb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1230)})];this.pge=[Object(y.a)(new nb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1233)}),Object(y.a)(new nb,{printSettingOptionKey:5,printSettingOptionText:this.cm.ga(1234)}),Object(y.a)(new nb,
{printSettingOptionKey:6,printSettingOptionText:this.cm.ga(1241)}),Object(y.a)(new nb,{printSettingOptionKey:7,printSettingOptionText:this.cm.ga(1235)}),Object(y.a)(new nb,{printSettingOptionKey:8,printSettingOptionText:this.cm.ga(1236)}),Object(y.a)(new nb,{printSettingOptionKey:9,printSettingOptionText:this.cm.ga(1237)}),Object(y.a)(new nb,{printSettingOptionKey:11,printSettingOptionText:this.cm.ga(1238)}),Object(y.a)(new nb,{printSettingOptionKey:12,printSettingOptionText:this.cm.ga(1239)}),Object(y.a)(new nb,
{printSettingOptionKey:13,printSettingOptionText:this.cm.ga(1240)}),Object(y.a)(new nb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1232)})];this.Vie=[Object(y.a)(new nb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1249)}),Object(y.a)(new nb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1250)}),Object(y.a)(new nb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1251)}),Object(y.a)(new nb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1252)})];
this.Wde=[Object(y.a)(new Na,{printSettingOption:Object(y.a)(new nb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1255)}),marginValue:this.xxb(this.normal)}),Object(y.a)(new Na,{printSettingOption:Object(y.a)(new nb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1256)}),marginValue:this.xxb(this.wide)}),Object(y.a)(new Na,{printSettingOption:Object(y.a)(new nb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1257)}),marginValue:this.xxb(this.narrow)}),Object(y.a)(new Na,
{printSettingOption:Object(y.a)(new nb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1258)}),marginValue:this.xxb(this.r6)})]}Dhi(){this.normal=this.g6c(this.$Ki);this.narrow=this.g6c(this.SJi);this.wide=this.g6c(this.$5j)}}vb.pkh=1;vb.akh=1;vb.W7c=9;vb.fkh=2;vb.Zjh=0;vb.Sjh=!1;vb.Njh=!1;vb.zIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(vb,"PrintSettingsManagerBase",null,[2]);var gb=a(123),cb=a(250);class La{constructor(ib,Vb){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=ib;this.sheetPrintOptions=Vb}getSheetName(){return this.sheetName}}Object(b.a)(La,"MacroRecorderSheetPrintOptionsSavedPayload",null,[122]);class ja{constructor(ib,Vb){this.printSettings=this.sheetName=null;this.sheetName=ib;this.printSettings=Vb}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(ja,"MacroRecorderSheetPrintSettingsSavedPayload",null,[122]);class Ua extends vb{constructor(ib,Vb,wc,Lc,Fc,fd){super(Fc);this.mag=
this.Ed=!1;this.aEd=Ta=>{this.rD.aEd(Ta)};this.jEd=Ta=>{this.rD.jEd(Ta)};this.NYi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.MYi=Ta=>{Ta=Wb.a.Pe(Ta.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${Fa.a.nc(Ta)}.`)};this.wz=(Ta,Fb)=>{2===Fb.sr?this.wv.clear():1===Fb.sr&&this.wv&&this.wv.contains(Fb.Lf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${gb.a(Fb.Lf.operation.operationName)} returned, it took ${Fb.Lf.dequeueUtcTime.getTime()-Fb.Lf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.wv.remove(Fb.Lf))};this.rD=ib;this.qab=wc;this.$=Vb;this.sheetName=Lc;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.e3i=this.u$g();this.$.userOperationManager.Lr(this.wz);this.wv=new Ma.a;this.eF=fd}oki(ib){this.pki(Vb=>{ib&&(Vb=this.p0h(Vb),
ib(Vb))})}nPd(ib,Vb){if(ib){var wc=new C(ib.Sz,ib.ignorePrintArea);this.Urj(wc);!Vb||this.mag?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Vb?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Vb=this.r0h(ib.Z_),Vb.IsLandscape=2===ib.orientation,Vb.PaperSize=ib.Lca,this.eF&&(Vb.NoColor=ib.NoColor),Vb.PageMargin=this.aid(ib.margin),Vb.SheetPrintOptions=vb.zIa,Vb.SheetPrintOptions.PrintGrid=ib.sheetPrintOptions.PrintGrid,
Vb.SheetPrintOptions.HorizontalCenter=ib.sheetPrintOptions.HorizontalCenter,Vb.SheetPrintOptions.VerticalCenter=ib.sheetPrintOptions.VerticalCenter,Vb.SheetPrintOptions.PrintHeaders=ib.sheetPrintOptions.PrintHeaders,this.Trj(Vb))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}aid(ib){let Vb={};0===ib?Vb=this.normal:1===ib?Vb=this.wide:2===ib?Vb=this.narrow:3===ib&&(Vb=this.r6);return Vb}Gki(ib){if(ib){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Vb=this.$.oa.xa,wc=this.$.oa.xa.Wb(),Lc=new D.a(598,0,(Fc,fd,Ta)=>qa(Vb,this.$.va.na.name,ib,L.b(this.aEd,Fc),L.a(this.jEd,fd),Ta,wc),64,()=>new La(this.$.va.na.name,ib));this.$.userOperationManager.Jc(Lc,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Ed||(this.Ed=!0,this.$.userOperationManager.zo(this.wz),
this.TX())}Urj(ib){this.qab.Sz=ib.Sz;this.qab.ignorePrintArea=ib.ignorePrintArea}pki(ib){const Vb=fd=>{cb.a(fd)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Fa.a.nc(fd.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),ib(fd.Result))},wc=fd=>{fd=Wb.a.Pe(fd.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Fa.a.nc(fd)}.`);
ib(null)},Lc=this.$.oa.xa.Wb();var Fc=new D.a(247,0,(fd,Ta,Fb)=>O(this.$.oa.xa,this.sheetName,this.locale,L.b(fd,Vb),L.a(Ta,wc),Fb,Lc),80);Fc=this.$.userOperationManager.Jc(Fc,null);this.wv.add(Fc)}Trj(ib){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Vb=this.$.oa.xa.Wb();this.$.userOperationManager.Jc(new D.a(226,0,(wc,Lc,Fc)=>Z(this.$.oa.xa,this.sheetName,ib,L.b(wc,this.NYi),L.a(Lc,this.MYi),Fc,Vb),
void 0,()=>new ja(this.sheetName,ib)),null)}dsi(ib){return this.Chf(ib)||!this.Qkf(ib.PaperSize)}dIh(ib){this.Chf(ib)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),ib.ScalingWidth=Ua.hkh,ib.ScalingHeight=Ua.gkh,ib.ScalingPercent=Ua.KKe,ib.FitToPage=Ua.Ojh);this.Qkf(ib.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${ib.PaperSize.toString()} present in file which is unsupported by XLO.`),
ib.PaperSize=Ua.W7c);return ib}n0h(ib){if(ib.FitToPage){if(1===ib.ScalingWidth&&1===ib.ScalingHeight)return 1;if(!ib.ScalingWidth&&1===ib.ScalingHeight)return 3}else return 0;return 2}m0h(ib){return this.Hrd(ib,this.normal)?0:this.Hrd(ib,this.wide)?1:this.Hrd(ib,this.narrow)?2:3}Hrd(ib,Vb){return ib.Left===Vb.Left&&ib.Right===Vb.Right&&ib.Top===Vb.Top&&ib.Bottom===Vb.Bottom&&ib.Header===Vb.Header&&ib.Footer===Vb.Footer}r0h(ib){const Vb={};Vb.ScalingPercent=Ua.KKe;Vb.FitToPage=0!==ib;2===ib?(Vb.ScalingWidth=
1,Vb.ScalingHeight=0):3===ib?(Vb.ScalingWidth=0,Vb.ScalingHeight=1):1===ib&&(Vb.ScalingWidth=1,Vb.ScalingHeight=1);return Vb}Qkf(ib){return this.e3i.contains(ib.toString())}Chf(ib){return 100!==ib.ScalingPercent||ib.FitToPage&&(1<ib.ScalingWidth||1<ib.ScalingHeight)}u$g(){const ib=new Qa.a(wb.a.Ni());for(let Vb=0;Vb<this.paperSizeOptions.length;Vb++)ib.add(this.paperSizeOptions[Vb].printSettingOptionKey.toString());return ib}p0h(ib){let Vb=null;if(ib){const wc=this.qab.Sz,Lc=this.qab.ignorePrintArea;
this.dsi(ib)&&(this.mag=!0,ib=this.dIh(ib));Vb=new va;Vb.Sz=wc;Vb.ignorePrintArea=Lc;Vb.orientation=ib.IsLandscape?2:1;Vb.Lca=ib.PaperSize;Vb.Z_=this.n0h(ib);Vb.sheetPrintOptions=vb.zIa;Vb.sheetPrintOptions.PrintGrid=ib.SheetPrintOptions.PrintGrid;Vb.b2a=ib.Draft;this.eF&&(Vb.NoColor=ib.NoColor);Vb.sheetPrintOptions.HorizontalCenter=ib.SheetPrintOptions.HorizontalCenter;Vb.sheetPrintOptions.VerticalCenter=ib.SheetPrintOptions.VerticalCenter;Vb.sheetPrintOptions.PrintHeaders=ib.SheetPrintOptions.PrintHeaders;
Vb.margin=this.m0h(ib.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Vb.margin}`);3===Vb.margin&&(this.r6={},this.r6.Left=ib.PageMargin.Left,this.r6.Right=ib.PageMargin.Right,this.r6.Top=ib.PageMargin.Top,this.r6.Bottom=ib.PageMargin.Bottom,this.r6.Header=ib.PageMargin.Header,this.r6.Footer=ib.PageMargin.Footer)}return Vb}TX(){if(this.wv){for(let ib of this.wv)this.$&&this.$.userOperationManager&&(ib.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${gb.a(ib.operation.operationName)}.`),
this.$.userOperationManager.Dta(ib)),this.wv.remove(ib);this.wv=null}}}Ua.hkh=1;Ua.gkh=0;Ua.KKe=100;Ua.W7c=9;Ua.Ojh=!0;Object(b.a)(Ua,"PrintSettingsManager",vb,[]);var lb=a(73);class sb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(sb,"PrintSettingsTaskPaneCallbacks",null,[]);class V{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(V,"SelectedPrintSettings",null,[]);class za{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(za,"PrintOperationCallbacks",null,[]);class Ra{constructor(){this.onBackToSheet=null}}Object(b.a)(Ra,"PrintPreviewPaneCallbacks",
null,[]);var Xa=a(1098);class $a{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)($a,"UniversalPrintAppSettings",null,[]);var ma=a(424),fa=a(33);class eb{constructor(ib,Vb,wc,Lc){this.activeCell=this.selectedRange=this.jg=this.graphServiceEndpoint=null;this.oIb=0;this.$ca=this.xv=null;this.jH=new va;this.Fk=new va;this.Rba=0;this.t8a=null;this.kOb=!1;this.D3a=this.pHb=null;this.bsd=!1;
this.p7a=this.oBb=!0;this.sma=this.Yya=this.A8a=null;this.mAb=!1;this.q8a=null;this.E6a=this.zNc=!1;this.ERi=Fc=>{if(!(Fc&&Fc.data&&Fc.data.de&&Fc.data.responseHeaders&&Fc.data.de.length)){var fd=Fc?Fc.data?Fc.data.de?Fc.data.responseHeaders?Fc.data.de.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.jg&&(Fc=this.oRa(M.a.instance.ga(1209)),
this.VAa(Fc,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${fd}`);this.eNd&&(Fc=Object(y.a)(new Ea.a,{extendedProperties:new Map}),Fc.extendedProperties.set("InvalidParameterName",fd),I.Health.instance.recordQosError(Da.a.HOf,[ea.a.IOf],!1,!0,!0,!1,Fc))}else if(0<this.Rba&&Fc.data.id===this.Rba){if(Fc.data.responseHeaders["Content-Type"]&&(ab.a.contains(Fc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||ab.a.contains(Fc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var Ta=null;ab.a.contains(Fc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(Ta=this.ybh(Fc));fd={};this.uBf(Ta);Fc.data.responseHeaders["Total-Pdf-PageCount"]?(Ta=parseInt(Fc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.mAb||(this.WHd>=Ta?this.sma=Ta:this.mAb=!0),this.p7a&&this.jg&&this.jg.setPageRangeSettings(Ta,this.WHd,this.mAb,
this.Yya,this.sma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else fd=Ba.a.Wh(Fc.data.de),Fa.a.O9(fd.Errors)||lb.a(this.$).gd.KL(fd.Errors[0].MessageId),this.Rdj(fd.Errors),this.jg&&(Ta=this.oRa(fd.Errors[0].Description),-1831476778===fd.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.VAa(Ta,0,M.a.instance.ga(1212))):
this.VAa(Ta,0)),297284985===fd.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${fd.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${fd.Errors[0].MessageId}`);Fc=Fc.data.state;Fc.KSe(fd,Fc.userContext,Fc.methodName)}};this.DRi=Fc=>{if(0<this.Rba&&Fc.data.id===this.Rba){var fd=Wb.a.Pe(Fc.data);this.jg&&this.VAa(this.oRa(fd[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${Fa.a.nc(fd)}]`);fd=Fc.data.state;fd.Hia(Fc,fd.userContext,fd.methodName);this.$.userOperationManager.fla.operation.EAa(()=>this.kOb)}};this.dQi=Fc=>{Fc.Errors&&0<Fc.Errors.length&&this.jg?(Fa.a.O9(Fc.Errors)||lb.a(this.$).gd.KL(Fc.Errors[0].MessageId),this.VAa(this.oRa(Fc.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Fc.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.uBf(null))};this.cQi=Fc=>{Fc=Wb.a.Pe(Fc.data);this.jg&&this.VAa(this.oRa(Fc[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${Fa.a.nc(Fc)}]`);this.$.userOperationManager.fla.operation.EAa(()=>this.kOb)};this.TFf=(Fc,fd)=>{if(fd)switch(fd.D8i){case 1:if(this.Fk&&this.D3a)switch(Fc=this.D3a.Bc,this.D3a.stop(),
this.D3a=null,this.Fk.Sz){case 1:this.Q1c(Fc,4800,"ActiveSheet");break;case 0:this.Q1c(Fc,6100,"CurrentSelection");break;case 2:this.Q1c(Fc,7500,"EntireWorkbook")}break;case 0:this.pHb&&(Fc=this.pHb.Bc,this.pHb.stop(),2400<Fc&&(fd=Object(y.a)(new Ea.a,{extendedProperties:new Map}),fd.extendedProperties.set("PaneLoadTime",Fc.toString()),I.Health.instance.recordQosError(Da.a.rLj,[ea.a.vag],!1,!0,!0,!1,fd)),this.xv.oki(Ta=>{this.tJj(Ta)}))}};this.wz=(Fc,fd)=>{(1===fd.sr&&this.A8a===fd.Lf||2===fd.sr)&&
this.UNd()};this.$=ib;this.G7b=Vb;this.J2=wc;this.oFb=Lc;this.eNd=E.HelperMethods.OZ;this.Pa=new pb.a;this.WHd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.eHj();this.lhi();this.Nli=this.k3g();this.eF=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG");this.yvi=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&this.eF&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);if(this.isUniversalPrintEnabled=!!Lc&&Lc.o6a()&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.Xd.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get csi(){return this.zNc}iOg(ib){this.Pa.addHandler("ppocek",ib)}Fkj(ib){this.Pa.removeHandler("ppocek",ib)}sJj(ib,Vb,wc){this.joj();this.$.userOperationManager.Lr(this.wz);this.$ca=ib;this.Pa.raiseEvent("ppocek");this.isExportPdfMode=wc;this.$ca.SelectedRanges&&
this.$ca.SelectedRanges.Ranges&&0<this.$ca.SelectedRanges.Ranges.length&&this.$ca.SelectedRanges.Ranges[0]&&(this.selectedRange=x.B(this.$ca.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.xv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.xv=new Ua(this,this.$,Vb,this.$.va.na.name,M.a.instance,this.eF);e.ULS.shipAssertTag(537154267,0,!this.jg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.jg=new Ga.PrintPreviewPane(this.$,
this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.jg.Pnh();this.jg.uJj(this.isExportPdfMode);this.jg.DNg(this.TFf)}rYh(){this.xv.r6&&4<=this.xv.marginDetailedOptions.length&&(this.xv.marginDetailedOptions[3].marginValue=this.xv.xxb(this.xv.r6));return this.xv.marginDetailedOptions}S7f(){return!!this.$ca&&!!this.$ca.ObjectId||!u.h(this.$).ha.qa.Tg}s0h(){const ib=Object(y.a)(new V,{selectedWhatToPrint:vb.pkh,selectedOrientation:vb.akh,selectedPaperSize:vb.W7c,selectedScaling:vb.fkh,selectedMargin:vb.Zjh,
selectedIgnorePrintArea:vb.Sjh,selectedPrintGridlines:vb.zIa.PrintGrid,selectedDraft:vb.Njh,selectedHorizontalCenter:vb.zIa.HorizontalCenter,selectedVerticalCenter:vb.zIa.VerticalCenter,selectedRowAndColumnHeadings:vb.zIa.PrintHeaders});this.jH?(ib.selectedWhatToPrint=this.jH.Sz,ib.selectedOrientation=this.jH.orientation,ib.selectedPaperSize=this.jH.Lca,ib.selectedScaling=this.jH.Z_,ib.selectedMargin=this.jH.margin,ib.selectedIgnorePrintArea=this.jH.ignorePrintArea,ib.selectedPrintGridlines=this.jH.sheetPrintOptions.PrintGrid,
ib.selectedDraft=this.jH.b2a,this.eF&&(ib.selectedColor=this.jH.NoColor?0:1),ib.selectedHorizontalCenter=this.jH.sheetPrintOptions.HorizontalCenter,ib.selectedVerticalCenter=this.jH.sheetPrintOptions.VerticalCenter,ib.selectedRowAndColumnHeadings=this.jH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return ib}b6e(){return Object(y.a)(new Ra,{onBackToSheet:()=>{this.Yla()}})}o0h(){return Object(y.a)(new Xa.a,
{backActionButtonText:M.a.instance.ga(1208),printPreviewPaneCallbacks:this.b6e(),logger:new mb.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(y.a)(new za,{onClosePreviewer:()=>{this.Yla()},getGraphServiceAuthorizationToken:this.mbc(),onLocalPrint:()=>{this.EGf()},onNotifyPrintJobStatus:(ib,Vb)=>{this.onNotifyPrintJobStatus(ib,Vb)}}),universalPrintAppSettings:Object(y.a)(new $a,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.Uli()?
"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}q0h(){return Object(y.a)(new sb,{onSettingChange:ib=>{this.AXi(ib)},onPrint:()=>{this.EGf()}})}AXi(ib){this.oIb++;ib?(this.jg&&this.jg.iKj(),this.Fk.Sz=ib.selectedWhatToPrint,this.Fk.Z_=ib.selectedScaling,this.Fk.orientation=ib.selectedOrientation,this.Fk.Lca=ib.selectedPaperSize,this.Fk.margin=ib.selectedMargin,this.eF&&(this.Fk.NoColor=!ib.selectedColor),this.Fk.ignorePrintArea=ib.selectedIgnorePrintArea,
this.Xzj(ib.selectedPageStart,ib.selectedPageEnd),this.xv&&this.ebi(this.Fk,ib)?(this.Fk.sheetPrintOptions=vb.zIa,this.Fk.sheetPrintOptions.PrintGrid=ib.selectedPrintGridlines,this.Fk.sheetPrintOptions.HorizontalCenter=ib.selectedHorizontalCenter,this.Fk.sheetPrintOptions.VerticalCenter=ib.selectedVerticalCenter,this.Fk.sheetPrintOptions.PrintHeaders=ib.selectedRowAndColumnHeadings,this.xv.Gki(this.Fk.sheetPrintOptions)):this.Hod()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}Yla(){this.E6a&&
(this.kOb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.oIb} times before clicking on backToWorkbook icon`);this.DGf();this.pCe()}EGf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.oIb} times before clicking on print button.`);e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Fk.margin}, Initial margin value : ${this.jH.margin}`);
if(this.useMSPdfViewer)this.JOf();else if(this.p7a)try{this.jg.printPdf(),this.X2c()}catch(ib){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.JOf()}else this.G7b.rJj(this.J5b(!0)),this.X2c()}JOf(){const ib=this.J5b(!0);this.X2c();E.HelperMethods.gf(ib,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){W.a.Ja(this.Pa)}Hod(){if(this.$.z6a)this.lki();else{this.TX();this.a_f();var ib=null;this.bhi();e.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.A8a=this.$.userOperationManager.Jc(new D.a(223,0,(Vb,wc,Lc)=>{Vb=new Oa.a(Vb,null,wc,Lc,null,!0,!1,"GetFileCopyFileHandler","");Vb.correlationID=H.a.create().toString();ib=Vb;this.Rba=this.J2.Gga(this.J5b(this.p7a?!1:!0,this.Nli?"Base64":"Pdf"),1,null,null,eb.DFh,!1,2,this.ERi,this.DRi,ib,void 0,void 0,void 0,12E4);Vb.requestId=this.Rba;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.Rba}.`);
return yb.Task.Ra(!0)},80),null)}}X2c(){this.DGf();this.pCe()}aEd(ib){Fa.a.oq(ib.Errors)?this.jg.showErrorMessageForPrintOptions(M.a.instance.ga(1259)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Hod(),this.jg&&this.jg.hideErrorMessageForPrintOptions())}jEd(ib){this.jg&&this.jg.showErrorMessageForPrintOptions(M.a.instance.ga(1259));ib=Wb.a.Pe(ib.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${Fa.a.nc(ib)}.`)}lki(){e.ULS.sendTraceTag(553649883,
0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.TX();const ib=this.$.oa.xa.Wb();this.A8a=this.$.userOperationManager.Jc(new D.a(133,0,(Vb,wc,Lc)=>{const Fc={};Fc.WhatToPrint=this.Fk.Sz;Fc.UseNamedAction=this.G7b.Z8f();Fc.SelectedSheetName=this.$.va.na.name;Fc.ActiveCell=this.activeCell;Fc.SelectedRanges=[this.selectedRange];Fc.IsPdfDocumentRequired=!1;Fc.Orientation=this.Fk.orientation;Fc.PaperSize=this.Fk.Lca;Fc.Scaling=this.Fk.Z_;Fc.RichValuesEnabled=
!0;Fc.IgnorePrintArea=this.Fk.ignorePrintArea;Fc.Preview=!0;this.eF&&(Fc.NoColor=this.Fk.NoColor);this.L7f()&&(Fc.PaginationStartPage=this.Yya,Fc.PaginationEndPage=this.sma,Fc.OutputTotalPdfPageCount=!0);const fd=this.xv.aid(this.Fk.margin);fd&&(Fc.PageMargin={},Fc.PageMargin.Top=fd.Top,Fc.PageMargin.Bottom=fd.Bottom,Fc.PageMargin.Left=fd.Left,Fc.PageMargin.Right=fd.Right,Fc.PageMargin.Header=fd.Header,Fc.PageMargin.Footer=fd.Footer);return this.t8a=da(this.$.oa.xa,Fc,L.b(this.dQi,Vb),L.a(this.cQi,
wc),Lc,ib)},80),null)}pCe(){this.$.userOperationManager.zo(this.wz);this.TX();this.a_f();e.ULS.shipAssertTag(537154261,0,!!this.jg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.jg&&(this.jg.ikj(this.TFf),this.jg.Ynh(),this.jg=null);this.$ca=null;this.xv&&(this.xv.dispose(),this.xv=null);this.D3a=this.pHb=null;this.zNc=!1;this.Pa&&this.Pa.raiseEvent("ppocek")}XEj(){return this.$.isEditMode&&!!this.jH&&!!this.Fk&&2!==this.Fk.Sz&&this.fbi()}nPd(){e.ULS.shipAssertTag(537154260,
0,!!this.xv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.xv&&this.xv.nPd(this.Fk,this.XEj())}J5b(ib,Vb="Pdf"){const wc=new Sys.StringBuilder;wc.append(oa.a(this.$,Vb,!0));Ja.a.Mk(wc,na.a.ZPf,""+this.Fk.Sz);ib&&this.G7b.Z8f()&&Ja.a.Mk(wc,na.a.v2j,"1");Ja.a.Mk(wc,na.a.K$i,this.$.va.na.name);0===this.Fk.Sz&&(Ja.a.Mk(wc,na.a.J$i,this.selectedRange),Ja.a.Mk(wc,na.a.B$i,this.activeCell));Ja.a.Mk(wc,na.a.E$i,""+this.Fk.orientation);Ja.a.Mk(wc,na.a.F$i,""+this.Fk.Lca);
Ja.a.Mk(wc,na.a.I$i,""+this.Fk.Z_);Ja.a.Mk(wc,na.a.H$i,"1");Ja.a.Mk(wc,na.a.A$i,this.Fk.ignorePrintArea?"1":"0");Ja.a.Mk(wc,na.a.G$i,"1");this.SRg(wc);this.eF&&Ja.a.Mk(wc,na.a.D$i,this.Fk.NoColor?"1":"0");this.RRg(wc);ab.a.equals(Vb,"Pdf",!0)&&(wc.append("&#toolbar=0"),wc.append("&zoom=100"));ib=wc.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${ib}`);return ib}Xzj(ib,Vb){ib||Vb?(this.mAb=!0,
this.Yya=ib,this.sma=Vb):this.mZf()}SRg(ib){this.L7f()&&(Ja.a.Mk(ib,na.a.M$i,""+this.Yya),Ja.a.Mk(ib,na.a.L$i,""+this.sma),Ja.a.Mk(ib,na.a.N$i,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Yya} to ${this.sma}`))}L7f(){return null!=this.Yya&&0<this.Yya&&null!=this.sma&&0<this.sma}RRg(ib){if(this.xv&&this.Fk){const Vb=this.xv.aid(this.Fk.margin);Vb&&Ja.a.Mk(ib,na.a.C$i,""+Vb.Top+" "+Vb.Bottom+" "+Vb.Left+" "+Vb.Right+" "+
Vb.Header+" "+Vb.Footer)}}uBf(ib){this.jg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.va.na,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.na&&(this.p7a?(ib||(ib=this.J5b(!1)),this.jg.sAi(ib)):this.mJj()))}fbi(){return!this.jH.equals(this.Fk)}DGf(){!this.kOb&&0<this.oIb&&(this.bsd?this.nPd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,
0,!!this.jg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.jg&&this.jg.qci()}kj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.jg){var ib=this.oRa(M.a.instance.ga(1));this.VAa(ib,1)}else ib=Fa.a.ed(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),v.EwaSettings.kz()?new Yb.a(this.$,ib):(new nc.ErrorDialog(this.$,ib)).kg()}tJj(ib){ib?(0===ib.Sz&&this.S7f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.$ca.ObjectId?
"floatingObject":"discontinuousRange"}.`),ib.Sz=1),va.yGe(ib,this.jH),va.yGe(ib,this.Fk),e.ULS.shipAssertTag(537154248,0,!!this.jg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.jg&&(this.bsd=!0,this.jg.vJj(),this.Hod())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.kj())}Q1c(ib,Vb,wc){ib>Vb&&(Vb=Object(y.a)(new Ea.a,{extendedProperties:new Map}),Vb.extendedProperties.set("WtpSelectedValue",
wc),Vb.extendedProperties.set("FullyRenderedPdfLoadTime",ib.toString()),I.Health.instance.recordQosError(Da.a.qLj,[ea.a.vag],!1,!0,!0,!1,Vb))}TX(){this.A8a&&(0<this.Rba||this.t8a)&&(e.ULS.sendTraceTag(537154246,0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.Rba}.`),this.$.userOperationManager.Dta(this.A8a),this.t8a?Wb.a.Nt(this.t8a.Rs):this.J2.Nt(this.Rba),this.UNd())}UNd(){this.t8a=this.A8a=null}bhi(){this.eNd&&this.Fk&&(this.D3a=this.$.Jb.Gc("UserAction",
(1===this.Fk.Sz?"ActiveSheet":0===this.Fk.Sz?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}mZf(){this.mAb=!1;this.Yya=1;this.sma=this.WHd}oRa(ib){if(ib)return ib.replace("&#39;","'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return ib}mJj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.oBb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");
else{let ib=this.oRa(M.a.instance.ga(1214));this.VAa(ib,3)}}VAa(ib,Vb,wc=null){this.jg.Kz(ib,Vb,wc)}lhi(){this.p7a=this.oBb=!0;e.ULS.sendTraceTag(557061534,0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.oBb}, isPdfPreviewSupportedInPreviewer: ${this.p7a}`)}joj(){this.q8a=null;this.UNd();this.mZf();this.pHb=this.$.Jb.Gc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.na.activeCell.toString();this.oIb=0;this.bsd=this.E6a=this.kOb=
!1;this.zNc=!0}eHj(){const ib=this.Yui()||this.mvi();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${ib}`);return ib}k3g(){let ib=15;Q.a.rH&&Q.a.Ytb&&(ib=parseFloat(Q.a.Ytb));return 14<ib&&this.oBb}Yui(){var ib;const Vb="teams"===(null===(ib=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.C7])||void 0===ib?void 0:ib.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${Q.a.WA} isTeamsUIHost: ${Vb} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);
return Q.a.WA||Vb}mvi(){return!this.$.Xd.get(111)}a_f(){this.q8a&&(URL.revokeObjectURL(this.q8a),this.q8a=null)}ybh(ib){var Vb=ib.data.de;ib=this.$.Jb.Gc("UserAction","PrintPreviewBlobFileCreation");var wc=window.self.atob(Vb);Vb=new Uint8Array(Vb.length);for(let Lc=0;Lc<wc.length;Lc++)Vb[Lc]=wc.charCodeAt(Lc)&255;wc=new Blob([Vb],{type:"application/pdf"});this.q8a=URL.createObjectURL(wc);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${ib.Bc} ms. Blob size: ${wc.size}`);
ib.stop();return this.q8a+"#toolbar=0&zoom=100"}Rdj(ib){if(this.eNd&&Fa.a.dh(ib,eb.q4i)){const Vb=Object(y.a)(new Ea.a,{extendedProperties:new Map});Vb.extendedProperties.set("ErrorMessageIdName",ib[0].MessageIdName);I.Health.instance.recordQosError(Da.a.HOf,[ea.a.IOf],!1,!0,!0,!1,Vb)}}ebi(ib,Vb){return ib.sheetPrintOptions.PrintGrid!==Vb.selectedPrintGridlines||ib.sheetPrintOptions.HorizontalCenter!==Vb.selectedHorizontalCenter||ib.sheetPrintOptions.VerticalCenter!==Vb.selectedVerticalCenter||ib.sheetPrintOptions.PrintHeaders!==
Vb.selectedRowAndColumnHeadings}jVj(){this.yvi&&this.$.Zc(1936706533,-1,0,null)}Uli(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.oFb.wO("Print",this.graphServiceEndpoint).then(ib=>ib?(ib.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${ib.ErrorCode}, Error message : ${ib.ErrorMessage}`),ib):Object(y.a)(new Gb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(ib=>{let Vb=new Gb.a;Object.getType(ib)===Object.getType(Vb)?Vb=ib:(Vb.ErrorMessage=ib.toString(),Vb.ErrorCode="exception");return Promise.resolve(Vb)})}mbc(){return()=>{const ib=Promise.resolve("");try{if(this.oFb&&this.oFb.o6a())return this.getToken().then(Vb=>
Vb.IsSuccess?Promise.resolve(Vb.Token):ib,()=>ib)}catch(Vb){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return ib}}onNotifyPrintJobStatus(ib,Vb){ib=ma.a.SI.notificationBar.I$(ib,!1);"pending"==Vb&&(ib.displayTimeoutSeconds=3,this.jVj());if(fa.a.xBb())switch(Vb){case "failure":ib.image=1;break;case "success":ib.image=3;break;default:ib.image=0}else ib.image=0;ma.a.SI.notificationBar.dE(ib)}}eb.q4i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];eb.DFh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(eb,"PrintPreviewManager",null,[351,2,352]);class ua{constructor(ib,Vb,wc){this.ignorePrintArea=!1;this.DUj=()=>{const Lc=u.h(this.$).Ca;this.aTc=!0;Lc.nBd()};this.eXi=()=>{this.Dkd()};this.dXi=(Lc,Fc,fd)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${fd} failed to execute`);
this.Dkd()};this.$=ib;this.ea=ib.ea;this.G7b=Vb;this.qab=new C(1,this.ignorePrintArea);this.rD=Vb=new eb(ib,Vb,f.AFrameworkApplication.Bd,wc);this.$.da.Ha(418,Vb);this.FOf=new kb(ib);this.$.da.Ha(384,this);this.aTc=!1;this.Y7a=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG")}get V7f(){return this.aTc}Hc(){return!1}executeCommand(ib,Vb,wc,Lc){const Fc=Vb.command;return 1588554917===Fc||1531172830===Fc||-2050819419===Fc?(Vb.yAb=!0,z.a(this.$)&&this.$.da.Aa(423).Ozc(!1),this.zoh(Vb)?
yb.Task.Ra(!0):n.a(Fc)):this.FOf.executeCommand(ib,Vb,wc,Lc,this.eXi,this.dXi,this.DUj)}wc(ib,Vb){switch(Vb.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.Bka,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&this.Y7a;case -2050819419:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&this.Y7a;default:return this.FOf.wc(ib,
Vb)}}Mc(){return!1}zoh(ib){return this.$.ea.Xb?this.Aoh(ib):!1}Aoh(ib){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Vb=this.$.Jb.Gc("UserAction","DoPrintHtml");var wc=this.$;wc=this.l0h(wc,this.ea.isNamedObjectViewMode?wc.yb.na.sheetName:wc.va.na.name);if(w.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const Lc=1531172830===ib.command||-2050819419===ib.command;this.rD.sJj(wc,this.qab,Lc);e.ULS.sendTraceTag(591196515,
0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${Lc} Command: ${r.a[ib.command]}`)}Vb.stop();this.Dkd();return!0}l0h(ib,Vb){const wc={};wc.SessionId=this.ea.sessionId;wc.UsedRangeTooBig=!1;var Lc=u.h(ib),Fc=Lc.ha;const fd=Fc.Oe;if(A.e(ib.na))wc.Type=0,wc.ObjectId=ib.na.name,wc.UseSelection=!1;else if(A.g(ib.na))wc.Type=1,wc.ObjectId=ib.na.imageId,wc.UseSelection=!0;else if(2===fd||4===fd||64===fd)Lc=Fc.Sa.dc.floatingObject,wc.Type=1,wc.SheetName=Vb,wc.ObjectId=Lc.id,
wc.UseSelection=!0;else if(fd&470)wc.ObjectId=Fc.Sa.dc.floatingObject.id,wc.SheetName=Vb;else if(A.i(ib.na)){wc.Type=2;wc.SheetName=Vb;if(Fc.qa.Tg)if(Fc=Fc.qa.ld,wc.SelectedRanges=x.q(Fc,ib),20<Fc.Ny)wc.UseSelection=!0;else{Vb=0;Lc=Lc.Wj("PrintCommandHandler.DoPrintHtml",Fc);try{for(Lc.$$rst();Lc.$$mn()&&2>Vb;)Lc.$$cu().text&&Vb++;wc.UseSelection=2<=Vb}finally{Lc&&Lc.dispose()}}else wc.UseSelection=!1,wc.SelectedRanges=x.q(Fc.qa.activeRange,ib);this.ea.isNamedObjectViewMode&&(wc.UsedRange=x.v(ib.na.usedRange,
ib))}wc.Title=ib.workbookContext.WorkbookFileName;return wc}Dkd(){u.h(this.$);if(!this.V7f){this.aTc=!0;const ib=this.$.Jb.Gc("UserAction","HandlePageLayoutRendering");this.TUj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${ib.Bc} ms.`);ib.stop()}}TUj(){const ib=u.h(this.$).Ca,Vb=ib.JA();let wc=!1,Lc=0;for(let Fc=0;Fc<Vb.length;Fc++){const fd=Vb[Fc],Ta=fd.lf;Ta&&Ta.hasPageLayout()&&(wc=!0,Ta.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
fd.Xc,4),Lc++)}wc&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Vb.length}, number of blocks that require re-rendering is ${Lc}`),ib.nBd())}}Object(b.a)(ua,"PrintCommandHandler",null,[221,337]);var xa=a(1097),tb=a(1311),Qb=a(1312);class pc extends h.a{constructor(ib){super(ib)}hd(){var ib=f.AFrameworkApplication.fa.appSettings,Vb=this.$.ya.DirectPrintSetting;ib.DirectPrintIsEnabled=Vb.DirectPrintIsEnabled.toString();ib.DirectPrintProbeIsEnabled=
Vb.DirectPrintProbeIsEnabled.toString();ib.DirectPrintEnabledForInternetExplorer=Vb.DirectPrintEnabledForInternetExplorer.toString();ib.DirectPrintSupportedMimeTypes=Vb.DirectPrintSupportedMimeTypes;ib.DirectPrintSupportedPlugins=Vb.DirectPrintSupportedPlugins;ib.DirectPrintImmersivePreviewPlugins=Vb.DirectPrintImmersivePreviewPlugins;ib.DirectPrintMinimalSupportedEdgeVersion=Vb.DirectPrintMinimalSupportedEdgeVersion;ib.DirectPrintEnabledForEdge=Vb.DirectPrintEnabledForEdge.toString();ib=new xa.a(ib);
let wc=null;Vb=null;try{Vb=window.navigator.mimeTypes}catch(Fc){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let Lc=null;try{Lc=window.navigator.plugins}catch(Fc){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}wc=new Qb.a(ib,Vb,Lc,Qb.a.$hf,Qb.a.Emf,new tb.a(f.AFrameworkApplication.ra.OW),f.AFrameworkApplication.ra.ED,Qb.a.Fmf,(Fc,fd)=>new d.a(Fc,!1,fd),!1);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG")&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1)&&this.$.Xd.get(116)){const Fc=m.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Xa);l.TaskExtensions.za(Fc,()=>{const fd=new ua(this.$,wc,Fc.result);this.$c([fd])},this.$.la)}else this.$c([new ua(this.$,wc,null)])}static ka(ib){h.a.Ld(73,new pc(ib))}}Object(b.a)(pc,"PrintCommandHandlerFactory",h.a,[]);a.d(F,"a",function(){return hb});const hb=()=>{c.a.Fa(pc.ka)}},1170:function(t,F,a){var c=a(9),b=a(0),e=a(226),f=a(50),d=a(37),h=a(15),m=a(89),l=a(84),v=a(245),r=a(627),A=a(213),x=a(113),n=a(35),
u=a(40),z=a(239),w=a(45),C=a(6),y=a(36),B=a(73),H=a(594);class I extends z.a{constructor(hb,ib){super(hb);this.q2j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.ZFb=()=>{const Vb=this.oUh();if(Vb){this.$.VH(!0);if(-2028960985!==this.command&&1461300262!==this.command){const wc=B.a(this.$).gd.activityState;wc[y.a.CYa]=C.a.download;wc[H.a.XVc]=this.command}w.a(this.$).Jt(Vb.Errors)}};this.iframe=hb;this.$=ib;this.Cc.ka("load",this.ZFb)}get Mdi(){return"loading"!=
this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(hb,ib){const Vb={};(hb=this.FEh(hb,Vb))&&u.a.bsc("dlfr",hb,Vb);this.command=ib}FEh(hb,ib){var Vb=hb.split("?");if(2!==Vb.length)return hb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),hb;Vb=Vb[1].split("&");for(const Lc of Vb){var wc=Lc.split("=",2);if(2!==wc.length){hb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");
break}Vb=wc[0];this.q2j.includes(Vb)&&(wc=decodeURIComponent(wc[1]),ib[Vb]=wc,hb=A.a.BJb(hb,Vb))}return hb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}oUh(){try{return this.iframe.contentWindow.ewaResult}catch(hb){if(!this.$.ea.$b.isDivSyndicated){const ib=window.document.referrer.match(RegExp("://(.[^/]+)/"));h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<ib.length?ib[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.z6a}`);
throw hb;}return null}}static Yve(hb){let ib=document.createElement("iframe");ib.id="ewaFileLoader";ib.style.cssText="height:0;width:0;display:none";ib.src="about:blank";ib.setAttribute("name","dlfr");ib=hb.domElement.appendChild(ib);return new I(ib,hb)}}Object(b.a)(I,"FileLoader",z.a,[]);var R=a(147),S=a(55);class G{constructor(hb,ib){this.Rc=()=>{n.a.lg(B.a(this.$).gd.activityState,R.a.OBd)||this.yua.reset()};this.$=ib;this.imc=hb;this.ea=ib.ea;this.ea.Jj(this.Rc);this.yua=I.Yve(this.$)}fph(){const hb=
this.MZg(this.$),ib=this.$.userOperationManager.operationCount;0<ib&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${ib}`);this.$.userOperationManager.L3("DownloadACopyOperation.DownloadForkedFile");this.imc&&h.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.yua.downloadFile(hb,-21742208);d.TaskExtensions.za(S.Task.delay(1),()=>{this.xdf()},this.yua.la,3)}dispose(){this.ea&&this.ea.ik(this.Rc);this.$=this.ea=null}xdf(hb=null){hb||(hb=
this.$.Jb.Gc("LoadResource","DownloadACopyOperation"));!this.yua.Mdi&&hb.Bc<G.Quf?window.setTimeout(()=>{this.xdf(hb)},G.gph):(hb.Bc>=G.Quf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),B.a(this.$).gd.gM())}MZg(hb){const ib=new Sys.StringBuilder,Vb=hb.workbookContext,wc=hb.ya;ib.append(hb.sna);ib.append(wc.FileHandlerRelativeUri);ib.append("?id=");ib.append(encodeURIComponent(A.a.BJb(Vb.WorkbookUri,"sc")));hb.ea.Xb&&(ib.append("&sessionId="),ib.append(encodeURIComponent(hb.ea.sessionId)));
ib.append("&workbookType=FullForkedWorkbook");ib.append("&dataloss=");ib.append(this.imc?"true":"false");x.a.Rob(ib,wc);return ib.toString()}}G.Quf=1E5;G.gph=100;Object(b.a)(G,"DownloadACopyOperation",null,[2]);class D extends v.a{constructor(hb,ib,Vb=!1){super(hb,ib);this.RDb=null;this.bEd=wc=>{this.unsubscribe(Lc=>{wc.remove_disposing(Lc)});this.gh(C.a.Kj);this.hp()};this.imc=Vb}execute(hb){const ib=Object(l.a)(6,hb.Ce);if(!ib.Bka)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),
this.Kod(hb),this.gh(C.a.idle),1;this.RDb||(this.RDb=new G(this.imc,ib));this.RDb.fph();h.ULS.shipAssertTag(537154817,0,3!==B.a(ib).Rh.nu,"The current activity should not be closed.");return 1}Kod(hb){const ib=Object(l.a)(6,hb.Ce),Vb=new r.a(ib);this.subscribe(hb,this.bEd,wc=>{Vb.add_disposing(wc)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Vb.initialize();Vb.kg()}dispose(){m.a.Ja(this.RDb);this.RDb=null;super.dispose()}}
Object(b.a)(D,"DownloadAForkedCopyActivity",v.a,[]);class E extends e.a{constructor(hb){super();this.$=hb;this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(new D(C.a.a2a,C.a.Kj,!0))},this.la)}}Object(b.a)(E,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class M extends e.a{constructor(hb){super();this.$=hb;this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(new D(C.a.unmergeableDownloadCopy,
C.a.Doa))},this.la)}}Object(b.a)(M,"DownloadAForkedCopyActivityFactory",e.a,[]);var L=a(85),N=a(4),Y=a(79),U=a(27),P=a(108),aa=a(25);class X{constructor(hb,ib,Vb){this.Ma=hb;this.Ryg=ib;this.u1=Vb}Ag(){this.Ma.Nb(aa.a.tryMacOffice,P.a.frame,Object(L.a)(this,this.j0i,"onTryMacOffice"));this.Ma.Nb(aa.a.Ugg,P.a.frame,Object(L.a)(this,this.EJf,"onTryMacOfficeFromViewer"));this.Ma.Nb(aa.a.Tgg,P.a.frame,Object(L.a)(this,this.EJf,"onTryMacOfficeFromViewer"))}j0i(hb,ib,Vb,wc,Lc){if(1===Vb)return 32;Lc?(hb=
Lc.SourceControlId,"btnjTryMacOfficeForWordEditor"===hb?u.a.gf(Y.a.lZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===hb&&u.a.gf(Y.a.lZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Ppf();return 32}EJf(hb,ib,Vb){if(1===Vb)return 32;switch(hb){case aa.a.Ugg:u.a.gf(Y.a.lZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case aa.a.Tgg:u.a.gf(Y.a.lZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Ppf(){u.a.gf(X.jFi,
"_blank",void 0,"LaunchMacTrialWindow")}get izc(){return this.Ryg&&U.a.isMac&&!U.a.Wri&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get xFj(){return this.izc}static get jFi(){return Y.a.dH("522401")}}Object(b.a)(X,"MacOfficeOffer",null,[187]);var Z=a(83);class da{constructor(hb,ib,Vb){this.Ma=hb;this.Vyg=ib;this.kHc=null;(this.LYb=N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Z.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wc=>
{this.kHc=wc});this.u1=Vb}Ag(){this.Ma.Nb(aa.a.tryOffice,P.a.frame,Object(L.a)(this,this.k0i,"onTryOffice"));this.Ma.Nb(aa.a.tryOfficeThroughTellMe,P.a.frame,Object(L.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.Ma.Nb(aa.a.Xgg,P.a.frame,Object(L.a)(this,this.Ygg,"tryOfficeThroughViewer"));this.Ma.Nb(aa.a.Wgg,P.a.frame,Object(L.a)(this,this.Ygg,"tryOfficeThroughViewer"))}k0i(hb,ib,Vb,wc,Lc){if(this.LYb&&1===Vb)return this.isFreemiumUpsellEnabled&&this.TMb?32:8;2===Vb&&(Lc?(hb=
Lc.SourceControlId,"btnjTryOfficeForWordEditor"===hb?u.a.gf(Y.a.lZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===hb?u.a.gf(Y.a.lZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.glc()):this.glc());return 32}tryOfficeThroughTellMe(hb,ib,Vb,wc,Lc){if(this.LYb&&1===Vb)return this.isFreemiumUpsellEnabled&&this.TMb?32:8;2===Vb&&(Lc?(hb=Lc.SourceControlId,u.a.gf(Y.a.dH("862405")+this.q_h(hb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
u.a.gf(Y.a.dH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Ygg(hb,ib,Vb){if(this.LYb&&1===Vb)return this.isFreemiumUpsellEnabled&&this.TMb?32:8;if(2===Vb)switch(hb){case aa.a.Xgg:u.a.gf(Y.a.lZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case aa.a.Wgg:u.a.gf(Y.a.lZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Ayf(){return this.TMb}get AMi(){return this.TMb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get TMb(){return this.Vyg&&!U.a.isMac}get isFreemiumUpsellEnabled(){let hb=
!1;this.kHc&&(hb=this.kHc.isFreemiumUpsellEnabled());return hb}glc(hb=null){let ib=0;hb&&(ib=hb);u.a.gf(da.YXh(ib),"_blank",void 0,"LaunchOfficeOffer")}q_h(hb){let ib=0;switch(hb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":ib=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":ib=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":ib=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":ib=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":ib=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":ib=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":ib=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":ib=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":ib=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":ib=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":ib=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":ib=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":ib=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":ib=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":ib=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":ib=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":ib=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":ib=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":ib=29}return 0===ib?"":String.format("&pc={0:D}",ib)}static YXh(hb){if(U.a.Hg)switch(hb){case 1:return Y.a.dH("393806");case 2:return Y.a.dH("393810");case 3:return Y.a.dH("393809");case 5:return Y.a.dH("393805")}else if(U.a.Zo)switch(hb){case 1:return Y.a.dH("521979");
case 3:return Y.a.dH("521980");case 5:return Y.a.dH("521978");case 2:return Y.a.dH("522490")}else{if(2===hb)return Y.a.dH("517778");if(1===hb)return Y.a.lZ(30)}return Y.a.dH("522402")}}Object(b.a)(da,"OfficeTrialExperience",null,[186]);class qa{Ah(hb){hb.register(da,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").qc().yc(()=>new da(N.AFrameworkApplication.rb,N.AFrameworkApplication.jBb,N.AFrameworkApplication.lcid));hb.register(X,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").qc().yc(()=>
new X(N.AFrameworkApplication.rb,N.AFrameworkApplication.oic,N.AFrameworkApplication.lcid))}}Object(b.a)(qa,"OpenInClientConfiguration",null,[5]);var O=a(551),ca=a(1384),wa=a(38),ia=a(1217),Ha=a(150),Sa=a(156),Da=a(227),ea=a(14),sa=a(86),Ea=a(110),ba=a(88);const ka=hb=>{for(let ib=0;ib<hb.children.length;ib++){const Vb=hb.children[ib];Vb.style.position="relative";Vb.style.top=(Vb.parentNode.offsetHeight-Vb.offsetHeight)/2+"px"}},Ca=hb=>hb.Ea.keyCode===sa.a.Jh||hb.Ea.keyCode===sa.a.Hea?(hb.Mb.click(),
!0):!1,db=(hb,ib,Vb,wc,Lc,Fc,fd)=>{const Ta=document.createElement("a");Ta.className="ProtocolLaunchingDialogButtonAnchor";Ta.className+=" OICDialog";Ta.id=hb;Ta.setAttribute(ba.a.Cd,ba.a.Qs);Ta.style.padding="0";Ta.style.margin="0";wc&&yb(Lc,ib,Vb,wc,Ta);hb=document.createElement("span");hb.className="ProtocolLaunchingDialogButtonLabel";hb.innerText=Lc;Ta.appendChild(hb);Ta.tabIndex=0;Fc&&Da.a.instance.ta(ea.a.click,Ta,Fc);fd&&Ea.KeyInputManager.instance.ta(ea.a.Kd,Ta,fd);return Ta},yb=(hb,ib,Vb,
wc,Lc)=>{var Fc=document.createElement("img");Fc.alt=hb;Fc.className=Sa.getImageClassWithCluster(Vb,wc);Fc.src=ib;Fc.setAttribute(ba.a.Cd,ba.a.qq);hb=document.createElement("span");hb.className="ProtocolLaunchingDialogImg32Container";hb.appendChild(Fc);Fc=document.createElement("span");Fc.className="ProtocolLaunchingDialogIconContainer";Fc.appendChild(hb);Lc.appendChild(Fc)};class kb{static get og(){return Ha.a.xq(kb.Ll,CommonUIStrings.l_OICLaunchDialogTitle)}}kb.Ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(kb,"OICLaunchDialogHtml",null,[]);class mb extends Ha.a{constructor(hb){super();this.gVa=this.RCa=null;this.Rpa=!1;this.gq=hb;this.og=kb.og;this.Ob=5;this.pe="OICLaunchDialog";this.showDialog("",Object(L.a)(this,this.UMi,"oicLaunchDialogResultHandler"));this.m5f();this.AW("ProtocolLaunchingDialogTitle");4!==N.AFrameworkApplication.ra.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.iI(this.RCa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}r$a(){this.RCa=db("BtnRichClient",this.gq.Gtb,this.gq.mzb,this.gq.Zmd,CommonUIStrings.l_OICLaunchRichClient,Object(L.a)(this,this.vHf,"onRichClientButtonClick"),Ca);document.getElementById("OICLaunchRichClient").appendChild(this.RCa);ka(this.RCa);this.gVa=db("BtnReturn",this.gq.Gtb,this.gq.mzb,this.gq.Idf,CommonUIStrings.l_OICReturnToOnlineClient,Object(L.a)(this,this.sHf,"onReturnButtonClick"),
Ca);document.getElementById("OICReturnToApp").appendChild(this.gVa);ka(this.gVa)}sHf(){this.hide();this.gq.Ncb();return!0}vHf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();N.AFrameworkApplication.rb.processAction(aa.a.$Qa,2);return!0}UMi(){this.gq.Ncb()}dispose(){this.Rpa||(this.RCa&&(Da.a.instance.Ba(ea.a.click,this.RCa,Object(L.a)(this,this.vHf,"onRichClientButtonClick")),Ea.KeyInputManager.instance.Ba(ea.a.Kd,this.RCa,Ca)),this.gVa&&(Da.a.instance.Ba(ea.a.click,
this.gVa,Object(L.a)(this,this.sHf,"onReturnButtonClick")),Ea.KeyInputManager.instance.Ba(ea.a.Kd,this.gVa,Ca)),super.dispose(),this.Rpa=!0)}}Object(b.a)(mb,"OICLaunchDialog",Ha.a,[]);class W{static get og(){return Ha.a.xq(W.Ll,CommonUIStrings.l_OICDialogTitle)}}W.Ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(W,"ProtocolLaunchingDialogV2Html",null,[]);a(422);var Q=a(109);class va extends Ha.a{constructor(hb){super();this.fVa=this.Uea=null;this.Rpa=!1;this.vpa=null;this.gq=hb;this.og=W.og;this.Ob=5;this.pe="ProtocolLaunchingDialog";this.qJc="OICRetryDialog";N.AFrameworkApplication.hi.u5a&&N.AFrameworkApplication.hi.Lvc();N.AFrameworkApplication.hi.fg(new Q.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(L.a)(this,this.AId,"protocolLaunchingDialogResultHandler"));this.m5f();
this.AW("Issues");this.$Ye();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}r$a(){const hb=document.getElementById("Issues");if(hb){yb("",this.gq.Gtb,this.gq.mzb,this.gq.Zmd,hb);const ib=document.createElement("span");ib.className="WACDialogSectionTitle";ib.innerText=5===this.gq.yKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;hb.appendChild(ib);ka(hb);hb.style.display="none"}N.AFrameworkApplication.ra.Qa.Vjd?
(this.fVa=db("GiveFeedback",this.gq.Gtb,this.gq.mzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(L.a)(this,this.fpc,"onGiveFeedbackClick"),Object(L.a)(this,this.HDf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.fVa),ka(this.fVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===N.AFrameworkApplication.ra.Qa.editMode||N.AFrameworkApplication.Rmh?document.getElementById("ButtonEdit").style.display="none":
(this.Uea=db("Edit",this.gq.Gtb,this.gq.mzb,"",2===N.AFrameworkApplication.ra.Qa.Oj?4===N.AFrameworkApplication.ra.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===N.AFrameworkApplication.ra.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(L.a)(this,this.iCf,"onEditClick"),Object(L.a)(this,this.mCf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Uea),ka(this.Uea));0===
N.AFrameworkApplication.ra.Qa.editMode&&!N.AFrameworkApplication.jBb&&hb&&(hb.style.display="none")}bZe(){return this.vpa?(this.iI(this.vpa),!0):!1}$Ye(){return this.Uea?(this.iI(this.Uea),!0):!1}mCf(hb){return this.lCd(hb,0)}HDf(hb){return this.lCd(hb,2)}rHf(hb){return this.lCd(hb,1)}lCd(hb,ib){let Vb=!1;if(hb.Ea.keyCode===sa.a.Jh||hb.Ea.keyCode===sa.a.Hea)hb.Mb.click(),Vb=!0;else if(hb.Ea.keyCode===Sys.UI.Key.down||hb.Ea.keyCode===Sys.UI.Key.up)switch(ib){case 1:Vb=this.$Ye();break;case 0:Vb=this.bZe()}return Vb}iCf(){this.hide();
4===N.AFrameworkApplication.ra.Qa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.gq.Ncb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.gq.qkd());return!0}fpc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.gq.A$e();return!0}eqc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";N.AFrameworkApplication.rb.processAction(aa.a.$Qa,2);return!0}AId(){this.gq.Ncb()}switchToBackupMode(){var hb=
document.getElementById("ProtocolLaunchingDialogTitle");if(hb){hb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(hb=document.getElementById("Issues"))hb.style.display="block";(hb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!hb.children.length&&(this.vpa=db("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(L.a)(this,this.eqc,"onRetryOICClick"),Object(L.a)(this,this.rHf,"onRetryOICKeyUp")),hb.appendChild(this.vpa),ka(this.vpa),this.Uea||this.bZe())}}dispose(){this.Rpa||(this.Uea&&
(Da.a.instance.Ba(ea.a.click,this.Uea,Object(L.a)(this,this.iCf,"onEditClick")),Ea.KeyInputManager.instance.Ba(ea.a.Kd,this.Uea,Object(L.a)(this,this.mCf,"onEditKeyUp"))),this.fVa&&(Da.a.instance.Ba(ea.a.click,this.fVa,Object(L.a)(this,this.fpc,"onGiveFeedbackClick")),Ea.KeyInputManager.instance.Ba(ea.a.Kd,this.fVa,Object(L.a)(this,this.HDf,"onGiveFeedbackKeyUp"))),this.vpa&&(Da.a.instance.Ba(ea.a.click,this.vpa,Object(L.a)(this,this.eqc,"onRetryOICClick")),Ea.KeyInputManager.instance.Ba(ea.a.Kd,
this.vpa,Object(L.a)(this,this.rHf,"onRetryOICKeyUp"))),super.dispose(),this.Rpa=!0)}}Object(b.a)(va,"ProtocolLaunchingDialog",Ha.a,[]);var na=a(136),Ba=a(428);class Oa extends na.StandardDialog{constructor(hb){super();this.gq=hb;this.pe="ProtocolLaunchingDialog";N.AFrameworkApplication.hi.u5a&&N.AFrameworkApplication.hi.Lvc();N.AFrameworkApplication.ra.Qa.Vjd&&this.Hoe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(L.a)(this,this.fpc,"onGiveFeedbackClick"));Oa.zaf?(this.Ob=12,this.tc(1,
CommonUIStrings.l_CloseFile),this.tc(2,CommonUIStrings.l_OICDialogContinueHere),this.tc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ob=4,this.tc(1,CommonUIStrings.l_OICDialogContinueHere),this.tc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.rEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.gq.yKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(L.a)(this,this.AId,"protocolLaunchingDialogResultHandler"),null)}fpc(hb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.ECf(hb)}eqc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");N.AFrameworkApplication.rb.processAction(aa.a.$Qa,2)}AId(hb){Oa.zaf?3===hb?this.TZf():2===hb||0===hb?this.continueEditing():1===hb&&this.M5g():2===hb?this.TZf():(1===hb||0===hb)&&this.continueEditing()}M5g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");N.AFrameworkApplication.rb.Wd(aa.a.close,2,Ba.a)}TZf(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(L.a)(this,
this.eqc,"onRetryOICClick"),0)}continueEditing(){4===N.AFrameworkApplication.ra.Qa.editMode||N.AFrameworkApplication.fa.pa("WordConsumptionViewToEditRedirectIsEnabled")&&1===N.AFrameworkApplication.ra.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.gq.Ncb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.gq.qkd())}static get zaf(){return N.AFrameworkApplication.fa.pa("OICDialogThreeActions")&&32===N.AFrameworkApplication.rb.processAction(aa.a.close,
1)}}Object(b.a)(Oa,"StandardProtocolLaunchingDialog",na.StandardDialog,[]);var oa=a(1263);class Ja{}Object(b.a)(Ja,"EditDocumentInClientParams",null,[]);class Wb{static z9c(hb,ib,Vb,wc,Lc,Fc,fd=!1,Ta=!1,Fb="",ic=!1,zb=!1,Bb=!1,ec="",Qd="",fc="",cd=!1){const jd=new Ja;jd.DocumentUrl=hb;jd.Mode=ib;jd.Options=Vb;jd.Application=wc;jd.SilentExternalHandler=fd;jd.EncodeUrl=Ta;jd.CorrelationIdForWinClient=Fb;jd.NavigateUsingWindowOpen=ic;jd.DescriptiveUnattemptedEnums=zb;jd.NoBrowserModalDialogs=Bb;jd.SessionOrigin=
ec;jd.CorrelationId=Qd;jd.ClickTime=fc;jd.NewTelemetryDataIsEnabled=cd;MSOJS.ClientUtils.EditDocumentInClient(jd,Lc,Fc)}}Object(b.a)(Wb,"ClientUtils",null,[]);var nc=a(99),Yb=a(145),pb=a(472),Fa=a(174),ab=a(838),Gb=a(376),Ga=a(167),Ma=a(70),Qa=a(193);class wb{constructor(hb){this.Lfa=this.s8d=this.mVa=null;this.kjb=!1;this.fPc=this.Afe=null;this.hSb=this.OD=this.AXb="";this.application=this.RB=0;this.xPj=this.wXd=!1;this.u2j=hb&&N.AFrameworkApplication.fa.pa("OICLaunchDialogIsEnabled");N.AFrameworkApplication.rb.S3(aa.a.$Qa)||
N.AFrameworkApplication.rb.Nb(aa.a.$Qa,P.a.frame,Object(L.a)(this,this.Mpj,"retryOpenInClientAction"));this.X$f=!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.pa("SilentExternalHandler")}get yKf(){return this.RB}vyc(hb,ib="",Vb=""){this.OD=Vb||Fa.a.create().toString();this.AXb=ib||pb.a.e5e();this.hSb=hb}Mpj(hb,ib,Vb){return ib.contextId!==P.a.frame?2:1===Vb?32:this.$Qa()}get options(){let hb=0;N.AFrameworkApplication.Lnj&&(hb|=1);N.AFrameworkApplication.openInClientEditOnly&&(hb|=4);this.tPj()&&
(hb|=64);return hb}tPj(){return!(2===this.application&&N.AFrameworkApplication.fa.pa("IsEmbeddedScenario"))}get Gtb(){return N.AFrameworkApplication.RA}get mzb(){return N.AFrameworkApplication.R5a}get Idf(){return""}get Zmd(){return""}get Zcg(){return N.AFrameworkApplication.fa.pa("OneNoteMobileViewerIsEnabled")}get YBc(){return this.Afe||(this.Afe=Z.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.wXd||this.ADh()}Ncb(){this.xPj||this.SDh()}tSf(hb){this.u2j&&U.a.Hg?new mb(this):
this.v4b(hb)}v4b(hb){const ib=({GBa:hb}=this.oyi(hb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===ib,hb);return ib}JGa(hb,ib,Vb,wc,Lc,Fc){this.mVa=hb;this.s8d=ib;this.Lfa=Fc;this.application=Vb;this.RB=wc;N.AFrameworkApplication.downloadCopyOnOpenInClient?this.Lpf():N.AFrameworkApplication.limitedEdit&&!N.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?N.AFrameworkApplication.r$f():this.uVg(Lc)}get TMi(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}$Qa(){this.TMi&&this.kBi();return this.v4b(this.kjb)}M2f(){const hb=new ab.a(Ga.a.openInClient);hb.Values["ui-language"]=N.AFrameworkApplication.lcid.toString();hb.Values[oa.a.U6c]=N.AFrameworkApplication.userSessionId;return this.Lfa.value.send(hb)?32:8}kBi(){nc.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Qa.a,{inStaging:!0}))}svj(hb){const ib=new ab.a(Ga.a.r5j);ib.Values["ui-language"]=N.AFrameworkApplication.lcid.toString();
ib.Values[oa.a.U6c]=N.AFrameworkApplication.userSessionId;ib.Values[Gb.a.q5j]=hb;this.Lfa.value.send(ib)}oyi(hb){this.kjb=hb;this.svj(5===this.RB?wb.H1i:wb.J1i);return 5===this.RB?this.nyi():this.syi()}nyi(){this.Tpf();return{returnValue:32,GBa:"HostEditUrl,"}}syi(){let hb;var ib=hb="";N.AFrameworkApplication.Ape&&(ib="|f|"+N.AFrameworkApplication.userSessionId);const Vb=N.AFrameworkApplication.fa.pa("IsAssignmentMode")&&N.AFrameworkApplication.fa.pa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
N.AFrameworkApplication.isUnifiedHostMode||U.a.hxa,wc=N.AFrameworkApplication.fa.pa("UnattemptedEnumIsEnabled"),Lc=N.AFrameworkApplication.fa.pa("NoBrowserModalDialogs");if(N.AFrameworkApplication.rb.Hnc){var Fc=N.AFrameworkApplication.rb.sZ(3588168074);Fc&&this.vyc(Fc.epochClickTime,Fc.sessionOrigin,Fc.correlationId);this.Zrf()}if(N.AFrameworkApplication.GNf){hb+="NewOrder,";Fc=8;this.Lfa&&this.Lfa.value&&this.Lfa.value.isEnabled()&&N.AFrameworkApplication.a1d&&(hb+="Post,",Fc=this.M2f());if(32===
Fc)return{returnValue:Fc,GBa:hb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return N.AFrameworkApplication.om.T$a?(h.ULS.shipAssertTag(5566816,211,!!N.AFrameworkApplication.om.T$a),hb+="HostUrl,",{returnValue:N.AFrameworkApplication.ra.G9a(N.AFrameworkApplication.om.T$a),GBa:hb}):this.mVa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",N.AFrameworkApplication.userSessionId),hb+="DocUrl,",Wb.z9c(this.mVa,this.RB,
this.options,this.application,Object(L.a)(this,this.lCf,"onEditInClientSuccess"),Object(L.a)(this,this.kCf,"onEditInClientFailure"),this.X$f,N.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled"),ib,Vb,wc,Lc,this.AXb,this.OD,this.hSb,N.AFrameworkApplication.rb.Hnc),{returnValue:32,GBa:hb}):{returnValue:8,GBa:hb}}hb+="OldOrder,";if(!this.mVa&&N.AFrameworkApplication.om.T$a)return this.Lfa&&this.Lfa.value&&this.Lfa.value.isEnabled()&&N.AFrameworkApplication.a1d?(hb+="Post,",ib=this.M2f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),ib=8),32!==ib?(h.ULS.shipAssertTag(22595484,211,!!N.AFrameworkApplication.om.T$a),hb+="HostUrl,",{returnValue:N.AFrameworkApplication.ra.G9a(N.AFrameworkApplication.om.T$a),GBa:hb}):{returnValue:ib,GBa:hb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",N.AFrameworkApplication.userSessionId);hb+="DocUrl,";Wb.z9c(this.mVa,this.RB,this.options,this.application,Object(L.a)(this,this.lCf,"onEditInClientSuccess"),
Object(L.a)(this,this.kCf,"onEditInClientFailure"),this.X$f,N.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled"),ib,Vb,wc,Lc,this.AXb,this.OD,this.hSb,N.AFrameworkApplication.rb.Hnc);return{returnValue:32,GBa:hb}}PXf(hb){N.AFrameworkApplication.Fn.setDw(8981,hb)}lCf(hb){this.PXf(hb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===hb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Zcg||this.Tpf(),this.Zrf()):this.wXd||this.closeApplication()}kCf(hb,ib=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",hb,ib);if(5===hb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Vb=!!this.s8d&&!this.kjb;let wc=0;1===hb&&(wc=2);6<=hb&&13>=hb&&(wc=1,1===ib&&(this.wXd=!0));this.YBc.AMi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",wc),ia.a.instance.Qeh(this.kjb?Object(L.a)(this,this.Wyf,"oicErrorDialogHandlerCloseForced"):Object(L.a)(this,this.Xyf,"oicErrorDialogHandlerNoCloseForced"),
Vb?Object(L.a)(this,this.NEf,"onLaunchDownload"):null,this.bMe(!1)?Object(L.a)(this,this.udi,"iHaveOfficeButtonHandler"):null,wc,ib)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",wc),ia.a.instance.Oeh(this.kjb?Object(L.a)(this,this.Wyf,"oicErrorDialogHandlerCloseForced"):Object(L.a)(this,this.Xyf,"oicErrorDialogHandlerNoCloseForced"),Vb?Object(L.a)(this,this.NEf,"onLaunchDownload"):null,wc))}}Zrf(){try{const hb=[Object.assign(new Ma.a,{name:"CorrelationId",string:this.OD}),
Object.assign(new Ma.a,{name:"SessionOrigin",string:this.AXb}),Object.assign(new Ma.a,{name:"ClickTime",string:this.hSb}),Object.assign(new Ma.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Yb.a("OpenInClientCompleted",!0,0,hb)}catch(hb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+hb.toString())}}Tpf(){N.AFrameworkApplication.ra&&N.AFrameworkApplication.ra.Qa.sv&&N.AFrameworkApplication.fa.pa("StandardProtocolDialogIsEnabled")?new Oa(this):new va(this)}Wyf(){this.closeApplication()}Xyf(){this.Ncb()}NEf(){this.Lpf()}udi(){return this.bMe(!0)}bMe(hb){const ib=
(U.a.Ajf||U.a.rH)&&!!N.AFrameworkApplication.F7b;ib&&hb&&(u.a.gf(N.AFrameworkApplication.F7b,"_blank",void 0,"OpenInClient"),this.closeApplication());return ib}}wb.J1i="OpenInDesktop";wb.H1i="OpenInBrowser";Object(b.a)(wb,"AOpenInClientOperation",null,[]);var Na=a(5),ya=a(208),nb=a(68),vb=a(56),gb=a(327),cb=a(48),La=a(44),ja=a(196),Ua=a(94),lb=a(29),sb=a(11),V=a(21),za=a(476),Ra=a(254),Xa=a(257),$a=a(154),ma=a(593);class fa extends wb{constructor(hb,ib,Vb){super(!0);this.Pa=new wa.a;this.$8c=this.mZe=
!1;this.w4b=this.Km=this.GDe=null;this.Rc=()=>{n.a.lg(B.a(this.$).gd.activityState,R.a.OBd)||this.yua.reset()};this.cRi=wc=>{this.PXf(wc)};this.bRi=()=>{this.bIj()};this.$=hb;this.ea=hb.ea;this.KJ=ib;this.businessBar=Vb;this.ea.Jj(this.Rc);this.yua=I.Yve(this.$);this.B8g();hb.da.Ha(55,this);this.ega=Z.a.instance.Tb("Common.ISystemInitiatedFeedback")}get Idf(){return"EditInExcelWebApp_32x32x32"}get la(){this.Km=this.Km||new ja.a;return this.Km.token}get Zmd(){return"excel32"}get Zcg(){return this.ea.$b.inWebPart}U7g(){this.tSf(this.mZe)}V9g(){const hb=
this.$;d.TaskExtensions.za(this.KJ.value,ib=>{this.JGa(hb.workbookContext.ClientUrl,N.AFrameworkApplication.RY,1,hb.isEditMode?2:0,!0,new O.a(()=>ib.result))},this.la,3)}qkd(){0!==vb.a.pg.editMode&&(this.$.qb.tv=!1)}A$e(){const hb={};hb[Na.a.z$b]=!1;hb[Na.a.sM]="OpenInExcel";this.$.Zc(802602464,nb.a.zb,8,hb)}v4c(){if(this.ea.Xb){var hb=this.$;hb.isEditMode&&d.TaskExtensions.za(this.KJ.value,ib=>{this.JGa(hb.workbookContext.ClientUrl,N.AFrameworkApplication.RY,1,2,!1,new O.a(()=>ib.result))},this.la,
3)}}WFe(){this.ea.Xb&&d.TaskExtensions.za(this.KJ.value,hb=>{this.JGa(this.$.workbookContext.ClientUrl,N.AFrameworkApplication.RY,1,this.$.isEditMode?2:0,!1,new O.a(()=>hb.result))},this.la,3)}vyc(hb){super.vyc(hb)}openInExcelClient(){this.ea.Xb&&(this.$.isEditMode||d.TaskExtensions.za(this.KJ.value,hb=>{this.JGa(this.$.workbookContext.ClientUrl,N.AFrameworkApplication.RY,1,0,!1,new O.a(()=>hb.result))},this.la,3))}openInBrowser(){this.ea.Xb&&d.TaskExtensions.za(this.KJ.value,hb=>{this.JGa(this.$.workbookContext.ClientUrl,
N.AFrameworkApplication.RY,1,5,!1,new O.a(()=>hb.result))},this.la,3)}downloadFile(hb){const ib=this.Cye(hb);this.yua.downloadFile(ib,hb);this.NBi()}NBi(){N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.ega&&this.ega.execute(hb=>hb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}uKf(hb,ib=0){if(this.ea.Xb){var Vb=this.$;B.a(Vb).hMa?this.vKf(hb,Vb):0<ib?this.kNj(hb,
Vb,ib):this.f9f(Vb)}}JGa(hb,ib,Vb,wc,Lc,Fc){this.$.qb.tv=!this.$.$b.inWebPart;this.mZe=Lc;this.w4b=null;this.$8c=!1;this.zVg(hb,ib,wc,Lc,Fc)}v4b(hb){const ib=this.$.$b;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${ib.inEmbedView}, InWebPart:${ib.inWebPart}, DivSyndicated:${ib.isDivSyndicated}, Mode:${this.$.isEditMode?ya.a.edit:ya.a.view}`);return fa.mkf()?(this.Y3b(),Wb.z9c(this.mVa,this.RB,this.options,1,this.cRi,this.bRi,!1,N.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled")),
32):super.v4b(hb)}ADh(){this.VYf();const hb=this.$;if(!this.ea.$b.inWebPart&&this.ea.Xb&&!hb.isEditMode){const ib=new Ua.a(2145659238,nb.a.zb,this.$.xc,0,null);this.GDe=cb.a.instance.create(()=>{hb.Ia.Hb(ib)},0,La.a.K1i)}}dispose(){this.ea&&this.ea.ik(this.Rc);m.a.pc([this.Pa,this.GDe,this.Km]);this.$=this.ea=null}SDh(){this.VYf()}Lpf(){cb.a.instance.create(()=>{this.$.Ia.Hb(new Ua.a(-2028960985,nb.a.zb,0,30,null))},0,La.a.L1i,!0,!0)}uVg(hb){const ib=this.$,Vb=B.a(this.$).gd.activityState;Vb[za.a.Lne]=
!0;ib.isEditMode&&this.ea.Xb?(this.Y3b(),w.a(ib).tr(new Ra.a(C.a.ew,5,()=>{ib.VH(!1);Vb[Xa.a.Bp]=C.a.$3b;Vb[za.a.AHg]=hb;Vb[R.a.Ocd]=!0;ib.isEditMode&&(Vb[R.a.dT]=1,Vb[R.a.YX]=!0,Vb[$a.a.PZb]=!0,Vb[$a.a.cWc]=!0);Vb[za.a.One]=1455037301}))):this.tSf(hb)}Wag(){const hb=N.AFrameworkApplication.RY;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.G9a(hb,!0)){const ib=this.$.ea.$b;h.ULS.sendTraceTag(537154773,0,50,`Url:[${hb}] IsEmbedded:[${ib.inEmbedView}] InWebPart:[${ib.inWebPart}] DivSyndicated:[${ib.isDivSyndicated}], Mode:[${this.$.isEditMode?
ya.a.edit:ya.a.view}]`)}}else this.yua.downloadFile(hb,-2028960985);this.$8c=!0;this.Y3b()}Nyi(){this.YBc.Ayf&&this.YBc.glc(1)}Oyi(){this.YBc.Ayf&&sb.HelperMethods.gf(Y.a.lZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}Vyi(){sb.HelperMethods.gf(Y.a.lZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Wyi(){sb.HelperMethods.gf(Y.a.lZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}Cye(hb){const ib=new Sys.StringBuilder,Vb=this.$.workbookContext,
wc=this.$.ya;ib.append(this.$.sna);ib.append(wc.FileHandlerRelativeUri);ib.append("?id=");ib.append(encodeURIComponent(A.a.BJb(Vb.WorkbookUri,"sc")));this.$.ea.Xb&&(ib.append("&sessionId="),ib.append(encodeURIComponent(this.$.ea.sessionId)));switch(hb){case -974518828:ib.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:ib.append("&workbookType=FullWorkbook");break;case -1059172980:ib.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:ib.clear()}hb=!(this.$.isChangeGateEnabled("OfficeVSO:7396073_ShortenUrlToPreventOdsFailure")&&
-1059172980===hb);x.a.Rob(ib,wc,hb);return ib.toString()}B8g(){ca.a.instance.T3g();const hb=this.$.ya;MSOJS.ClientUtils.InitUrls(hb.RoamingAppsX86RootUrl,hb.RoamingAppsControlInstallerUrl,hb.RoamingAppsFirefoxExtensionUrl)}VYf(){const hb=this.$;this.ea.Xb||gb.a.FId(hb,B.a(hb).gd);this.Y3b();this.w4b&&this.w4b(this,this.$8c);hb.frame.Lt.nm(this.$.frame.Laa());hb.frame.OW.nm(this.$.frame.Laa());hb.qb.tv=!1;V.h(hb).focus()}zVg(hb,ib,Vb,wc,Lc){const Fc=this.$;N.AFrameworkApplication.ra&&!fa.mkf()&&(Fc.frame.Lt.qn(Fc.frame.Laa()),
Fc.frame.OW.qn(Fc.frame.Laa()));super.JGa(hb,ib,1,Vb,wc,Lc)}Y3b(){const hb=this.$;B.a(hb).Rh.activityName===C.a.openInExcelClient&&B.a(hb).gd.gM()}bIj(){const hb=lb.a.ed(1,0,680,681,0,1341525452,"OpenInExcelActiveXError");w.a(this.$).Jt([hb])}kNj(hb,ib,Vb){let wc=null;const Lc=window.setTimeout(()=>{B.a(ib).vuc(wc);this.f9f(ib)},Vb);wc=()=>{B.a(ib).hMa&&(B.a(ib).vuc(wc),window.clearTimeout(Lc),this.vKf(hb,ib))};B.a(ib).bXc(wc)}f9f(hb){const ib=lb.a.ed(1,1,0,695,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");
w.a(hb).Jt([ib])}vKf(hb,ib){w.a(ib).tr(new Ra.a(C.a.ew,5,()=>{ib.VH(!1);const Vb=B.a(ib).gd,wc=Vb.activityState;wc[Xa.a.Bp]=C.a.BNe;wc[ma.a.RZb]=ib.ea.$b.hasUnsupportedFeaturesForEdit;wc[H.a.XVc]=hb;Vb.Wq(lb.a.D3(this.businessBar.L9c,[1437034227]))}))}static mkf(){return 1<vb.a.getRegisteredEwaInstances().length}}Object(b.a)(fa,"OpenInExcelOperation",wb,[270,2]);class eb extends e.a{constructor(hb){super();this.$=hb;this.Db();eb.A8g()}create(){if(this.$.da.Aa(55))this.nb(this.$.da.Aa(55));else{var hb=
f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),ib=f.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Xa);d.TaskExtensions.za(S.Task.ZF(hb,ib),()=>{this.nb(new fa(this.$,new O.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Xa)),ib.result))},this.la,3)}}static A8g(){eb.Zyf||(eb.Zyf=!0,(new qa).Ah(Z.a.instance),Z.a.instance.resolve("Common.IOfficeTrialExperience").Ag(),Z.a.instance.resolve("Common.IMacOfficeOffer").Ag())}}eb.Zyf=!1;Object(b.a)(eb,"OpenInClientFactory",e.a,
[]);var ua=a(118),xa=a(391);class tb extends ua.a{constructor(hb,ib){super(hb,ib)}execute(hb){const ib=Object(l.a)(6,hb.Ce);d.TaskExtensions.za(f.GetServiceTaskFactory.create(ib.da,56,ib.la,0),Vb=>{ib.downloadCopyOnOpenInClient?(hb.activityState[xa.a.Mne]=!0,Vb.result.Wag()):Vb.result.V9g()},ib.la,3);return 1}}Object(b.a)(tb,"OpenInExcelClientActivity",ua.a,[]);class Qb extends e.a{constructor(hb){super();this.$=hb;hb.da.Ha(56,new eb(hb));this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Xa),()=>{this.nb(new tb(C.a.openInExcelClient,C.a.idle))},this.la)}}Object(b.a)(Qb,"OpenInExcelClientActivityFactory",e.a,[]);a.d(F,"a",function(){return pc});const pc=()=>{c.a.Fa(hb=>{hb.da.Ha(57,new Qb(hb));hb.da.Ha(60,new M(hb));hb.da.Ha(63,new E(hb))})}},1171:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(86),e=a(4),f=a(110),d=a(14),h=a(89),m=a(54),l=a(30),v=a(27),r=a(12),A=a(239),x=a(1077),n=a(5),u=a(264),z=a(1078),w=a(722),C=a(1286),y=a(94);class B extends w.a{constructor(Fa,
ab,Gb){super(Fa,ab);this.Yr=!0;this.command=Gb}Rm(Fa){super.Rm(Fa);this.businessBar.$.Ia.Hb(new y.a(this.command,Fa,this.businessBar.$.xc,10,null))}}Object(t.a)(B,"CommandActionBusinessBarEntry",w.a,[]);class H extends B{constructor(Fa,ab,Gb){super(Fa,ab,Gb)}fD(Fa){super.fD(Fa)}}Object(t.a)(H,"EditAttemptReadOnlyBusinessBarEntry",B,[]);var I=a(45);class R extends w.a{constructor(Fa,ab,Gb,Ga){super(Fa,ab);this.error=Gb;this.options=Ga;this.error&&this.options&2&&(this.message=this.error.Description);
this.error&&this.options&1&&(this.title=this.error.Caption);this.Yr=!(Ga&4)}Rm(Fa){super.Rm(Fa);this.error.Appearance&=-33;I.a(this.businessBar.$).Jt([this.error])}}Object(t.a)(R,"ErrorBusinessBarEntry",w.a,[]);class S extends R{constructor(Fa,ab,Gb,Ga,Ma){super(Fa,ab,Gb,Ga);this.command=Ma;this.QU=!0}wV(Fa){super.wV(Fa);this.businessBar.$.Ia.Hb(new y.a(this.command,Fa,this.businessBar.$.xc,10,null))}}Object(t.a)(S,"ErrorAndCommandBusinessBarEntry",R,[]);var G=a(13);class D{constructor(Fa,ab,Gb,Ga,
Ma,Qa,wb,Na,ya,nb){this.GI=this.S7=this.GO=0;this.Dtg=Fa;this.FSj=ab;this.HI=Gb;this.Qxg=wb;this.xjb=l.a.Yu(ya);this.Uvg=ya;this.D5d=Na;this.Rxg=nb;0!==Ga&&(this.GO=Ga);0!==Ma&&(this.S7=Ma);0!==Qa&&(this.GI=Qa)}get title(){return D.ga(this.FSj)}get message(){return D.ga(this.HI)}get messageId(){return this.HI}get iconName(){return this.Rxg}get B_a(){return this.Dtg}get actionButton(){return D.ga(this.GO)}get Yra(){return D.ga(this.S7)}get link(){return D.ga(this.GI)}get ek(){return this.Qxg}get businessBarType(){return this.D5d}get hash(){return this.xjb}get alt(){const {BusinessBarControl:Fa}=
a(1171);switch(this.ek){case Fa.xia:return D.ga(26);case Fa.Qz:return D.ga(25);case Fa.oi:return D.ga(24);default:return D.ga(0)}}get gJa(){return this.Uvg}set businessBarType(Fa){this.D5d=Fa}static ga(Fa){return G.a.instance.ga(Fa)}}Object(t.a)(D,"EwaBusinessBarEntry",null,[]);class E extends D{constructor(Fa,ab,Gb,Ga,Ma,Qa,wb,Na){super(Fa,0,ab,Gb,Ga,Ma,Qa,wb,Na)}get title(){return""}}Object(t.a)(E,"EwaNoTitleBusinessBarEntry",D,[]);var M=a(74);class L extends w.a{constructor(Fa,ab){super(Fa,ab);
this.QU=this.Yr=!0}Rm(Fa){super.Rm(Fa);this.set_visible(!1);this.businessBar.$.ZH();this.businessBar.$.Ia.Hb(new y.a(1038998010,Fa,this.businessBar.$.xc,10,null))}wV(Fa){super.wV(Fa);this.businessBar.$.Ia.Hb(new y.a(-722953877,Fa,this.businessBar.$.xc,10,null))}fD(Fa){this.businessBar.removeEntry(55);M.g(Fa)}}Object(t.a)(L,"ExternalLinksEnableContentBusinessBarEntry",w.a,[]);class N extends w.a{constructor(Fa,ab){super(Fa,ab);this.Yr=!0;this.QU=!1}Rm(Fa){super.Rm(Fa);this.businessBar.$.Ia.Hb(new y.a(-722953877,
Fa,this.businessBar.$.xc,10,null))}fD(Fa){this.businessBar.removeEntry(5);M.g(Fa)}}Object(t.a)(N,"ExternalLinksShowErrorBusinessBarEntry",w.a,[]);var Y=a(11);class U extends w.a{constructor(Fa,ab,Gb){super(Fa,ab);this.Oyb=Gb;this.Yr=!0}Rm(Fa){super.Rm(Fa);Y.HelperMethods.GV(this.businessBar.$.UF,this.Oyb,this.businessBar.$.gS)}}Object(t.a)(U,"HelpButtonBusinessBarEntry",w.a,[]);class P extends w.a{constructor(Fa,ab,Gb){super(Fa,ab);this.Oyb=Gb;this.Tva=!0}fma(Fa){super.fma(Fa);Y.HelperMethods.GV(this.businessBar.$.UF,
this.Oyb,this.businessBar.$.gS)}}Object(t.a)(P,"HelpTextBusinessBarEntry",w.a,[]);var aa=a(68);class X extends w.a{constructor(Fa,ab,Gb,Ga){super(Fa,ab);this.Oyb=Gb;this.command=Ga;this.Tva=!0;this.Yr=1461300262!==Ga}Rm(Fa){super.Rm(Fa);this.businessBar.$.Ia.Hb(new y.a(this.command,Fa,this.businessBar.$.xc,10,null))}fma(Fa){super.fma(Fa);const ab=new y.a(-859308420,Fa,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Hb(ab,{[aa.a.Pf]:"HelpID="+this.Oyb,["InputMethod"]:Fa,[aa.a.Kc]:n.a.RU,[n.a.loa]:!0})}}
Object(t.a)(X,"HelpTextTaskPaneAndCommandBusinessBarEntry",w.a,[]);class Z extends w.a{constructor(Fa,ab){super(Fa,ab);this.QU=this.Yr=!0}Rm(Fa){super.Rm(Fa);this.set_visible(!1);this.businessBar.$.ZH();this.businessBar.$.Ia.Hb(new y.a(-1081442996,Fa,this.businessBar.$.xc,10,null))}wV(Fa){super.wV(Fa);this.businessBar.$.Ia.Hb(new y.a(1702917262,Fa,this.businessBar.$.xc,10,null))}fD(Fa){this.businessBar.removeEntry(59);M.g(Fa)}}Object(t.a)(Z,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",w.a,
[]);var da=a(1080);class qa extends w.a{constructor(Fa,ab){super(Fa,ab);(this.policyManager=Fa.$.da.Aa(274))?(this.message=this.policyManager.Rrc,this.title=this.policyManager.title,this.Tva=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}fma(Fa){super.fma(Fa);(Fa=this.policyManager.MVi)&&Fa(null)}}Object(t.a)(qa,"PolicyBusinessBarEntry",w.a,[]);var O=a(1079),ca=a(1082),
wa=a(1081);a(422);var ia=a(145),Ha=a(25);class Sa extends w.a{constructor(Fa,ab){super(Fa,ab);this.Yr=!0;this.title=""}Rm(Fa){super.Rm(Fa);ia.c(Ha.a.uKi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(t.a)(Sa,"UnsupportedBrowserBusinessBarEntry",w.a,[]);var Da=a(1076),ea=a(1310);class sa extends w.a{constructor(Fa,ab){super(Fa,ab);this.pCa=ea.a.$5b();this.Yr=!0;this.QU=this.pCa.B2j;this.title=this.pCa.title;this.message=this.pCa.message}get actionButton(){return this.pCa.Sye}get Yra(){return this.pCa.Uye}Rm(Fa){super.Rm(Fa);
this.pCa.gAf(null)}wV(Fa){super.wV(Fa);this.pCa.jAf(null)}fD(Fa){super.fD(Fa);this.pCa.uMe(null)}}Object(t.a)(sa,"WildFireMobileAppBusinessBarEntry",w.a,[]);var Ea=a(251),ba=a(22),ka=a(199),Ca=a(164),db=a(42),yb=a(7),kb=a(174),mb=a(1083),W=a(70),Q=a(127);class va extends w.a{constructor(Fa,ab,Gb,Ga){super(Fa,ab);this.officeScriptsCommandManager=Gb.da.Aa(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=kb.a.create();this.$=Gb;this.title=G.a.instance.ga(2279);this.message=
"";this.MWd=G.a.instance.ga(2275);this.Dmg=G.a.instance.ga(2276);this.Bmg=G.a.instance.ga(2277);this.GFe=G.a.instance.ga(2278);this.update(Ga)}update(Fa){this.scriptLink=Fa.scriptLink;this.runStatus=Fa.runStatus;this.buttonText=Fa.buttonText||"";this.mBi(Fa.clickId);this.Tnj();"preparing"===this.runStatus?(this.yna(0),this.message=String.format(G.a.instance.ob(208),this.buttonText),this.Yr=!0,this.Dra=this.MWd,this.trb=this.vga=this.L$a):"running"===this.runStatus?(this.yna(0),this.message=String.format(G.a.instance.ob(207),
this.buttonText),this.Yr=!0,this.Dra=this.MWd,this.trb=this.vga=this.L$a):"succeeded"===this.runStatus?(this.yna(0),this.message=String.format(G.a.instance.ob(210),this.buttonText),"true"===Fa.hasLogs?(this.Yr=!0,this.Dra=this.Bmg,this.vga=this.SJf,this.QU=!0,this.qYc=this.Dmg,this.rYc=this.TJf):(this.Yr=!0,this.Dra=this.Dmg,this.vga=this.TJf)):"runFailed"===this.runStatus?(this.yna(1),this.message=String.format(G.a.instance.ob(209),this.buttonText),this.J5a=pb.xia,"true"===Fa.hasLogs?(this.Yr=!0,
this.Dra=this.Bmg,this.vga=this.SJf,"false"===Fa.isOwner&&(this.QU=!0,this.qYc=this.GFe,this.rYc=this.mBf)):"false"===Fa.isOwner&&(this.Yr=!0,this.Dra=this.GFe,this.vga=this.mBf)):"fetchFailed"===this.runStatus?(this.yna(1),this.J5a=pb.xia,this.message=G.a.instance.ga(2281)):"canceled"===this.runStatus?(this.yna(0),this.J5a=pb.Qz,this.message=String.format(G.a.instance.ob(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.yna(5),this.J5a=pb.Qz,this.message=String.format(G.a.instance.ob(211),
this.buttonText),this.Yr=!0,this.Dra=this.MWd,this.trb=this.vga=this.L$a):"initializing"===this.runStatus&&(this.yna(0),this.J5a=pb.oi,this.message=G.a.instance.ga(2280))}get ek(){return this.J5a}get actionButton(){return this.Dra}get Yra(){return this.qYc}Rm(Fa){super.Rm(Fa);this.vga&&this.vga()}wV(Fa){super.wV(Fa);this.Yra&&this.rYc()}fD(Fa){super.fD(Fa);this.trb&&this.trb()}Tnj(){this.message="";this.J5a=pb.oi;this.Yr=!1;this.Dra="";this.vga=void 0;this.QU=!1;this.qYc="";this.rYc=void 0;this.hideCloseButton=
!1;this.trb=void 0}L$a(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.r8h(Fa);this.Hlc(-2186799,Fa)}SJf(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.q8h(Fa);this.Hlc(1036446140,Fa)}TJf(){const Fa=kb.a.create();if(this.scriptLink){const ab=new mb.b(this.scriptLink);this.officeScriptsCommandManager.caf(this.id.toString(),JSON.stringify(ab),Fa)}this.Hlc(-585097204,Fa.toString())}mBf(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.p8h(Fa);
this.Hlc(-639858579,Fa)}mBi(Fa){const ab=[];ab.push(Object(yb.a)(new W.a,{name:"id",string:this.id.toString()}));ab.push(Object(yb.a)(new W.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ab.push(Object(yb.a)(new W.a,{name:"runStatus",string:this.runStatus}));ab.push(Object(yb.a)(new W.a,{name:"clickId",string:Fa}));ab.push(Object(yb.a)(new W.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ia.a(Q.a.FMi,void 0,void 0,ab)}Hlc(Fa,ab){const Gb=[];Gb.push(Object(yb.a)(new W.a,
{name:"id",string:this.id.toString()}));Gb.push(Object(yb.a)(new W.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Gb.push(Object(yb.a)(new W.a,{name:"runStatus",string:this.runStatus}));Gb.push(Object(yb.a)(new W.a,{name:"clickId",string:ab}));ia.d(Fa,void 0,void 0,void 0,void 0,void 0,Gb)}}Object(t.a)(va,"OfficeScriptsRunStatusBusinessBarEntry",w.a,[]);var na=a(48),Ba=a(1);class Oa extends B{constructor(Fa,ab,Gb,Ga,Ma,Qa){super(Fa,ab,Gb);na.a.instance.create(()=>{this.showCallout(ab,Ga)},Ma,Qa,
!0,!0)}showCallout(Fa,ab){if(this.businessBar&&this.businessBar.Eka(Fa.B_a)&&this.Jse()){Fa=new y.a(-847286761,0,this.businessBar.$.xc,0,null);var Gb={};Gb.CalloutName=ab;Ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Gb.Target=this.FJ():Gb.Target=Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.GO.domElement;this.businessBar.$.Ia.Hb(Fa,Gb)}}Jse(){return!0}}Object(t.a)(Oa,
"CalloutBusinessBarEntry",B,[]);class oa extends Oa{constructor(Fa,ab,Gb,Ga,Ma,Qa){super(Fa,ab,Gb,Ga,Ma,Qa)}Jse(){if(!Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Fa=this.businessBar.$.da.Aa(465);return Fa&&Fa.Dwc?!1:!0}}Object(t.a)(oa,"OptimizeWorkbookCalloutBusinessBarEntry",Oa,[]);var Ja=a(19);class Wb extends w.a{constructor(Fa,ab,Gb){super(Fa,ab);this.update(Gb)}update(Fa){this.title=
Fa.title?Fa.title:"";this.message=Fa.message?Fa.message:"";this.yna(this.J$g(Fa.businessBarType));this.hideCloseButton=!!Fa.hideCloseButton}J$g(Fa){switch(Fa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(t.a)(Wb,"MsFormsDataSyncStatusBusinessBarEntry",w.a,[]);class nc extends w.a{constructor(Fa,ab,Gb,Ga){super(Fa,ab);this.QU=this.Yr=!0;this.z8i=Gb;this.OQg=Ga}Rm(Fa){super.Rm(Fa);this.businessBar.$.Ia.Hb(new y.a(this.z8i,
Fa,this.businessBar.$.xc,10,null))}wV(Fa){super.Rm(Fa);this.businessBar.$.Ia.Hb(new y.a(this.OQg,Fa,this.businessBar.$.xc,10,null))}}Object(t.a)(nc,"DualCommandActionsBusinessBarEntry",w.a,[]);class Yb extends w.a{constructor(Fa,ab,Gb,Ga){super(Fa,ab);this.host=Gb.ya.HostName;this.Xci="OneDriveWOPI"===this.host||"Open From URL"===this.host;(this.wti=Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",!1)||Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",
!1)||Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.Xci&&appChrome.renderSaveACopyToOneDriveCallout(Ga)}}Object(t.a)(Yb,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",w.a,[]);a.d(F,"BusinessBarControl",function(){return pb});class pb extends A.a{constructor(Fa,ab){super(ab);this.jJh=r.DOMElementExtensions.kr+",div";this.WT=Array(70);this.Fm=!1;this.AV=Gb=>{if(Gb.Ea.keyCode===b.a.Ay){var Ga=this.jc.querySelectorAll(this.jJh);const Ma=r.DOMElementExtensions.rm(Ga);
Ga=r.DOMElementExtensions.LA(Ga);return r.DOMElementExtensions.CAa(Gb.Ea,Ma,Ga)}return!1};this.jb=Fa;this.set_visible(!1);this.addCssClass(x.a.Xth);Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&e.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")&&this.addCssClass(x.a.Zth);f.KeyInputManager.instance.ta(d.a.Sb,this.jc,this.AV);u.a(Fa).Xh(this)}get Yd(){return Ea.a.c0c}get jc(){return this.domElement}get Ff(){return this.get_visible()}get $(){return this.jb}ag(Fa,
ab){ab||r.DOMElementExtensions.setFocus(this.domElement.firstChild);return!ab}sh(Fa){return r.DOMElementExtensions.Af(this.jc,Fa)}rj(){}dk(){}dispose(){this.Fm||(f.KeyInputManager.instance.Ba(d.a.Sb,this.jc,this.AV),h.a.pc(this.WT),this.WT=Array(70),this.jb=null,super.dispose(),this.Fm=!0)}Eka(Fa){if(!this.get_visible())return!1;Fa=this.WT[Fa];return!!Fa&&Fa.isVisible}cfd(Fa){return this.Eka(Fa)?this.WT[Fa].FJ():null}GG(Fa){return!!this.WT[Fa]}JPb(Fa,ab){if(Fa=this.WT[Fa])Fa.update(ab),Fa.oZj()}dE(Fa,
ab,Gb=null,Ga=null){let Ma=!1;if(this.GG(Fa))Gb=this.WT[Fa].get_visible();else{this.set_visible(!0);const Qa=pb.g9e()[Fa];this.WT[Fa]=this.I$(Fa,ab,Gb,Ga);Gb=!1;Ma=!0;Ga="";let wb=0;ab&&(Ga=ab.MessageIdName,wb=ab.MessageId);const Na=Qa.gJa,ya=db.PageLoadTrackingInfo.instance.zva(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Fa}, time from app interactive: ${ya}`);Ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===
Qa.businessBarType||Ca.a(this.$).WMd(Qa.hash,Ga,wb,m.a.bDc,!0,1,ab,Na)}Gb||!C.a.Fdc().includes(Fa)&&!Ma||(this.WT[Fa].set_visible(!0),this.$.ZH())}removeEntry(Fa){return this.yhj(Fa)}aLd(){h.a.pc(this.WT);this.WT=Array(70);this.set_visible(!1)}yhj(Fa){if(!this.GG(Fa))return!1;h.a.Ja(this.WT[Fa]);this.WT[Fa]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.ZH();return!0}I$(Fa,ab,Gb=null,Ga=null){const Ma=pb.g9e()[Fa],Qa=!!(this.$.qd&64);switch(Fa){case 23:Fa=new Yb(this,Ma,this.jb,
this.jc);break;case 2:case 4:case 25:case 26:case 36:case 35:Fa=new w.a(this,Ma);break;case 12:case 29:case 30:case 31:case 32:case 57:Fa=Qa?new B(this,Ma,-8805455):new w.a(this,Ma);break;case 34:Fa=Qa?new nc(this,Ma,-8805455,-104572626):new w.a(this,Ma);break;case 22:Fa=new H(this,Ma,-8805455);break;case 46:case 45:Fa=Qa?new S(this,Ma,ab,0,-8805455):new R(this,Ma,ab,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Fa=new R(this,Ma,ab,0);break;case 19:Fa=new w.a(this,Ma);break;case 47:Fa=
new R(this,Ma,ab,0);break;case 6:case 14:Fa=new U(this,Ma,ab.HelpTopicId);break;case 67:case 65:Fa=new P(this,Ma,ab.HelpTopicId);break;case 37:Fa=new P(this,Ma,n.a.Uih);break;case 38:Fa=new w.a(this,Ma);break;case 68:Fa=new H(this,Ma,924877417);break;case 16:Fa=new w.a(this,Ma);Fa.title=l.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Fa.message=l.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Fa=new B(this,Ma,-1762562205);Fa.hideCloseButton=!0;break;
case 20:Fa=new sa(this,Ma);break;case 21:case 56:Fa=new w.a(this,Ma);break;case 28:Fa=new w.a(this,Ma);break;case 24:Fa=new Sa(this,Ma);break;case 27:Fa=new qa(this,Ma);break;case 39:Fa=new Da.a(this,Ma);break;case 40:Fa=new z.a(this,Ma);break;case 41:Fa=new O.a(this,Ma);break;case 42:Fa=new da.a(this,Ma);break;case 48:Fa=new w.a(this,Ma);break;case 49:Fa=new w.a(this,Ma);break;case 50:Fa=new w.a(this,Ma);break;case 51:Fa=new w.a(this,Ma);break;case 52:Fa=new w.a(this,Ma);break;case 53:Fa=new wa.a(this,
Ma);break;case 54:Fa=new ca.a(this,Ma);break;case 55:Fa=new L(this,Ma);break;case 5:Fa=new N(this,Ma);break;case 58:Fa=new B(this,Ma,-1753056834);ab?(ab=ab.Directive,ba.a.Bq(ab)||"&nbsp;"===ab||(Fa.message=ab)):Gb&&(Fa.message=Gb);break;case 59:Fa=new Z(this,Ma);break;case 60:Fa=new w.a(this,Ma);break;case 63:Fa=new P(this,Ma,n.a.PLi);break;case 61:Fa=new X(this,Ma,n.a.kVg,-8805455);break;case 66:Fa=new X(this,Ma,n.a.Scj,1461300262);break;case 62:Fa=new oa(this,Ma,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");
Fa.message=Gb;break;case 64:Fa=new va(this,Ma,this.$,Ga);break;case 69:Fa=new Wb(this,Ma,Ga);break;default:Fa=new R(this,Ma,ab,7)}Fa.n5c();return Fa}static g9e(){let Fa;Fa=ka.a.FMa()?260:259;return pb.Hye||(pb.Hye=[new D(0,275,276,277,0,0,pb.xia,1,"BB_UnableToRefreshLock"),new D(1,275,276,277,0,0,pb.xia,1,"BB_UnableToRefreshLockExpected"),new D(2,267,268,0,0,0,pb.Qz,5,"BB_WorkbookAlmostTooLarge"),new D(3,269,270,271,0,0,pb.xia,1,"BB_WorkbookTooLarge"),new D(4,258,Fa,0,0,0,pb.Qz,5,"BB_ExternalWorkbookLinksDisabled"),
new D(5,262,261,263,0,0,pb.xia,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new D(6,264,265,266,0,0,pb.oi,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new D(7,250,251,252,0,0,pb.oi,5,"BB_UnsupportedFeatures"),new D(8,0,0,0,0,0,pb.oi,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new D(9,0,0,0,0,0,pb.oi,0,"BB_CollabDataStringsLocaleMismatch"),new D(10,0,0,0,0,0,pb.oi,0,"BB_CollabDataLocaleMismatch"),new D(11,278,279,280,0,0,pb.xia,1,"BB_LastGenericStatusError"),new D(12,281,282,
283,0,0,pb.Qz,5,"BB_ScratchPadWarning"),new D(13,284,285,286,0,0,pb.xia,1,"BB_AuthenticationLost"),new D(14,287,288,289,0,0,pb.Qz,5,"BB_OdfCompatibilityIssues"),new D(15,0,574,0,0,0,pb.Qz,5,"BB_PivotChartInteractivityMissingWarning"),new D(16,0,0,0,0,0,pb.oi,2,"BB_WorkbookIsIrmProtected"),new D(17,0,0,0,0,0,pb.oi,0,"BB_BIFeatureNotAvailable"),new D(18,290,291,286,0,0,pb.Qz,5,"BB_AnonymousCreateMode"),new D(19,253,254,0,0,0,pb.Qz,5,"BB_UnsupportedInteractiveReportEditing"),new D(20,0,0,0,0,0,pb.oi,
0,"BB_MobileAppCampaignBizBar"),new D(21,296,297,0,0,0,pb.oi,0,"BB_TransientServerCommunicationFailures"),new D(22,1640,1651,1652,0,0,pb.oi,5,"BB_EditAttemptInReadOnly"),new D(23,1640,1651,0,0,0,pb.oi,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new D(24,0,Y.HelperMethods.IYj(),1629,0,0,pb.oi,3,"BB_UnsupportedBrowser"),new D(25,299,300,0,0,0,pb.oi,2,"BB_ReadOnlyPermissions"),new D(26,301,302,0,0,0,pb.oi,2,"BB_DocumentIsIrmProtectedWarning"),new D(27,0,0,0,0,0,pb.Qz,5,"BB_PolicyWarningMessage"),
new D(28,1283,298,0,0,0,pb.oi,0,"BB_WorkingOnIt"),new D(29,1640,1638,1639,0,0,pb.oi,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new D(30,1653,1654,1655,0,0,pb.oi,5,"BB_WorkbookIsReadOnlyRecommended"),new D(31,1640,1656,1657,0,0,pb.oi,5,"BB_WorkbookHasPasswordToModify"),new D(32,1640,1658,1661,0,0,pb.oi,3,"BB_LegacySharedWorkbookEditWarning"),new D(33,1648,1659,252,0,0,pb.oi,5,"BB_LegacyConnectionsWarning"),new D(34,1640,1957,1958,1959,0,pb.oi,0,"BB_TooManyLoadBlockingFloatingObjects"),new D(35,
1649,1650,0,0,0,pb.oi,2,"BB_GroupedSlicers"),new D(36,312,313,0,0,0,pb.Qz,5,"BB_ThirdPartyAddinDisabled"),new D(37,1786,1787,0,0,1788,pb.oi,5,"BB_FinanceLinkedEntityDisclaimerBar"),new D(38,1815,1816,0,0,0,pb.Qz,5,"BB_WolframDeprecationAlertBar"),new D(39,0,0,0,0,0,pb.oi,0,"BB_WacGdprNotice"),new D(40,0,0,0,0,0,pb.oi,0,"BB_AutomaticSensitivityLabel"),new D(41,0,0,0,0,0,pb.oi,0,"BB_RecommendedSensitivityLabel"),new D(42,0,0,0,0,0,pb.oi,0,"BB_MandatorySensitivityLabel"),new D(43,314,315,316,0,0,pb.oi,
0,"BB_LocalStorageDisabled"),new D(44,631,632,0,0,0,pb.oi,0,"BB_AutoRefreshDisabled"),new D(45,1012,1010,1014,1312,0,pb.oi,4,"BB_CorruptedFileRepaired"),new D(46,1013,1011,1014,1312,0,pb.oi,5,"CorruptedOdsFileRepaired"),new D(47,272,273,274,0,0,pb.Qz,5,"BB_MinorVersionLimitReached"),new D(48,303,304,0,0,0,pb.Qz,5,"BB_SensitivityApplicationGenericError"),new D(49,305,307,0,0,0,pb.Qz,5,"BB_SensitivityApplicationTooLargeFileError"),new D(50,306,307,0,0,0,pb.Qz,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new D(51,308,309,0,0,0,pb.Qz,5,"BB_SensitivityApplicationLabelDisabledError"),new D(52,310,311,0,0,0,pb.Qz,5,"BB_SensitivityApplicationMandatoryConflictError"),new D(53,0,0,0,0,0,pb.Qz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new D(54,0,0,0,0,0,pb.Qz,5,"BB_SensitivityApplicationSetLabelError"),new D(55,2116,2117,2118,2121,0,pb.oi,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new D(56,296,297,0,0,0,pb.oi,0,"BB_NetworkDown"),new D(57,317,318,319,0,0,pb.oi,
2,"BB_DefaultToViewDueToCogs"),new D(58,1812,1813,1814,0,0,pb.oi,1,"BB_RefreshLinkedEntityErrorBar"),new D(59,1789,1790,1791,1792,0,pb.oi,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new E(60,249,0,0,0,pb.oi,5,"BB_CanvasHealth"),new D(61,1015,1016,1312,0,1017,pb.oi,5,"BB_MismatchedFileFormatConverted"),new D(62,2235,0,2237,0,0,pb.oi,5,"BB_OptimizeWorkbook"),new D(63,320,321,0,0,322,pb.oi,0,"BB_NovModePostDepreciation"),new D(64,0,0,0,0,0,pb.oi,0,"BB_OfficeScriptsRunning"),new D(65,2211,2212,0,0,
2214,pb.oi,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new D(66,323,324,0,0,325,pb.oi,5,"BB_ReadOnlyPivotTable"),new D(67,2211,2213,0,0,2214,pb.oi,0,"BB_PowerQueryRefreshHostNotSupported"),new D(68,1055,v.a.Hic?1057:1056,1054,0,0,pb.oi,4,"BB_RefreshPageAfterEnablingTheExtension"),new D(69,0,0,0,0,0,pb.oi,0,"BB_MsFormsDataSyncStatus")])}}pb.xia=Ja.a.Nwh;pb.Qz=Ja.a.Pwh;pb.oi=Ja.a.Owh;pb.Hye=null;Object(t.a)(pb,"BusinessBarControl",A.a,[28])},1176:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=
a(50),f=a(37),d=a(15),h=a(1092),m=a(152),l=a(24),v=a(68),r=a(59);class A{constructor(nb){this.options=null;this.options=nb}}Object(t.a)(A,"MacroRecorderRangeCustomSortedPayload",null,[122]);var x=a(975),n=a(976),u=a(41),z=a(374),w=a(192),C=a(284),y=a(140),B=a(29),H=a(250),I=a(1),R=a(188),S=a(22),G=a(282),D=a(21),E=a(814),M=a(763),L=a(266),N=a(214),Y=a(13),U=a(136);class P{constructor(nb){this.iu=vb=>{switch(vb){case 0:this.YNa("Cancel");break;case 1:this.YNa("Expand and sort");this.gWe(!0);break;
case 2:this.YNa("Just sort"),this.gWe(!1)}};this.gWe=nb}show(){const nb=new U.StandardDialog;nb.Ob=11;nb.tc(1,Y.a.instance.ga(2123));nb.tc(2,Y.a.instance.ga(2124));nb.n$f(Y.a.instance.ga(2122),Y.a.instance.Ta(658),this.iu)}YNa(nb){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${nb}`)}}Object(t.a)(P,"ExpandSortSelectionDialog",null,[]);const aa=(nb,vb)=>{nb=nb.ColumnInfo;switch(vb){case 1:return nb.CellColors&&nb.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,
10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return nb.TextColors&&nb.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return nb.Icons&&nb.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),
!1);default:return d.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},X=(nb,vb,gb,cb)=>{nb=nb.HeaderColumnInfo;return cb||nb?2===vb&&gb?nb.CellColors&&1!==nb.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):nb.TextColors&&1!==nb.TextColors.length?(d.ULS.sendTraceTag(537151625,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):nb.Icons&&1!==nb.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:nb?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${gb} == 0.`),
!1):!0:!0};var Z=a(191);class da{static isValid(nb){return da.kEh.includes(nb.Position)?!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${nb.Position}]`),!1)}}da.kEh=[0,.5,1];Object(t.a)(da,"FillGradientStopExtension",null,[]);class qa{constructor(nb,vb,gb,cb){new Sys.UI.Point(nb,vb);new Sys.UI.Point(gb,cb)}}Object(t.a)(qa,"GradientLine",null,[]);class O{static isValid(nb){if(!(nb.Degree.toString()in O.gEh))return d.ULS.shipAssertTag(537159829,
0,!1,`FillGradientExtension.IsValid: unexpected degree value [${nb.Degree}]`),!1;if(!nb.GradientStops)return d.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(nb.GradientStops.length<O.fIi||nb.GradientStops.length>O.NGi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${nb.GradientStops.length}]`),!1;for(const vb of nb.GradientStops)if(!da.isValid(vb))return!1;return!0}}O.fIi=2;O.NGi=3;O.gEh={["0"]:new qa(0,
0,1,0),["180"]:new qa(1,0,0,0),["90"]:new qa(0,0,0,1),["270"]:new qa(0,1,0,0),["45"]:new qa(0,0,1,1),["225"]:new qa(1,1,0,0),["135"]:new qa(1,0,0,1),["315"]:new qa(0,1,1,0)};Object(t.a)(O,"FillGradientExtension",null,[]);const ca=nb=>nb.SortRange?4===nb.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${nb.SortRangeType}`),!1):2===nb.SortRangeType&&nb.SortTopToBottom&&(null==nb.HeaderRowSize||0>nb.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,
0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),wa=nb=>{if(!nb.SortConditions)return!0;for(const vb of nb.SortConditions){if(!Ha(nb,vb.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${vb.RowColOffset}] is out of bounds. sort range: ${nb.SortRange}`),
!1;if(1===vb.SortConditionType&&vb.FillGradient&&!O.isValid(vb.FillGradient))return d.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ia=nb=>{if(!nb.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var vb=new Z.a;for(var gb of nb.SortColumnInfoItems){if(!Ha(nb,gb.ColumnOffset))return d.ULS.sendTraceTag(537151617,
0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${gb.ColumnOffset}] is out of bounds. sort range: ${nb.SortRange}`),!1;if(!gb.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${gb.ColumnOffset}]`),!1;if(gb.CellColors&&!gb.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${gb.CellColors.length}]`),!1;if(gb.TextColors&&
!gb.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${gb.TextColors.length}]`),!1;if(gb.Icons&&!gb.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${gb.Icons.length}]`),!1;vb.add(gb.ColumnOffset)}if(nb.SortConditions)for(const cb of nb.SortConditions)if(!vb.contains(cb.RowColOffset))return d.ULS.shipAssertTag(537151584,
0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${cb.RowColOffset}]`),!1;if(nb.HeaderColumnInfoItems){if(nb.HeaderColumnInfoItems.length!==nb.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(vb=0;vb<nb.HeaderColumnInfoItems.length;++vb){gb=nb.HeaderColumnInfoItems[vb];if(gb.ColumnOffset!==nb.SortColumnInfoItems[vb].ColumnOffset)return d.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(gb.CellColors&&1<gb.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(gb.TextColors&&1<gb.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(gb.Icons&&1<gb.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},Ha=(nb,vb)=>{const gb=nb.SortRange;nb=nb.SortTopToBottom?gb.LastColumn-gb.FirstColumn:gb.LastRow-gb.FirstRow;return 0<=vb&&vb<=nb};var Sa=a(384),Da=a(127),ea=a(90),sa=a(128);class Ea extends Sa.a{constructor(nb,vb){super(nb,vb);this.qEb=this.wed();this.zr()}get kc(){return"SortMergedCellsErrorDialog"}gO(nb,
vb){if(1===nb){var gb=u.v(this.qEb,this.$);D.h(this.$).qg(gb,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}gb={["DialogButton"]:nb,["Location"]:"dialog"};sa.b(this.$).rd(Da.a.NLj,gb,null,!0);super.gO(nb,vb)}zr(){super.zr();const nb=this.KLj();this.Ob=1;this.tc(1,Y.a.instance.ga(2242));this.Wl(Y.a.instance.ga(2243),ea.a.kf(nb),1,this.m7)}KLj(){return String.format(Y.a.instance.ob(174),this.qEb.toString())}wed(){const nb=this.error.Description.split("_");return new l.Range(Number.parseInvariant(nb[1])+
1,Number.parseInvariant(nb[2])+1,Number.parseInvariant(nb[3])+1,Number.parseInvariant(nb[4])+1,!0,!1)}}Object(t.a)(Ea,"SortMergedCellsErrorDialog",Sa.a,[]);var ba=a(73),ka=a(577),Ca=a(614);class db extends E.a{constructor(nb,vb,gb,cb){super(nb);this.vhc=this.YTd=!1;this.n6=[];this.rki=(La,ja)=>{const Ua=this.odh(La);this.XLa(214,(lb,sb,V)=>C.p(this.$.oa.xa,Ua,this.c0a(lb,this.PLh(ja)),this.ET(sb),V,null),16,!0)};this.qki=(La,ja,Ua)=>{La=C.o(this.$.oa.xa,ja,this.AMh(ja,Ua),this.TTi,null,La);this.n6.push(La)};
this.TTi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.Q7b(db.qsb())};this.p8c=(La,ja)=>{if(1===La){La=ja.sortRangeType;const Ua={};Ua.SortOptions=ja.sortOptions;Ua.ShouldRestoreSelection=this.YTd;Ua.SelectedRange=this.selectedRange;Ua.OriginalActiveCell=this.Nqc;Ua.TopCellAddress=this.MTa;Ua.ShouldPromptNamedSheetViewTeachingDialog=0===La||3===La;db.Yaj(this.$,Ua)}else this.YTd&&this.Joa(this.selectedRange,
this.Nqc)};this.Nci=(La,ja)=>{this.YTd=!0;this.Joa(La,ja)};this.getColorName=La=>M.a.GKa(N.a.YG(La));d.ULS.shipAssertTag(529105669,0,!!vb.ActiveCell);d.ULS.shipAssertTag(529105668,0,!!vb.SelectedRange);d.ULS.shipAssertTag(529105667,0,u.D(vb.SelectedRange).contains(u.C(vb.ActiveCell)));d.ULS.shipAssertTag(529105666,0,S.a.equals(vb.SelectedRange.SheetName,vb.ActiveCell.SheetName,!0));this.Ycb=new Ca.a(nb,ka.a.Bih,()=>this.vhc,1);this.selectedRange=vb.SelectedRange;this.Nqc=vb.ActiveCell;this.J0g=vb.ExpandSelection;
this.namedSheetViewPublic=gb;this.MTa=cb;this.initializeAndShow(Y.a.instance.ga(180),this.p8c,this.gta(vb))}dispose(){this.vhc||(this.vhc=!0,this.P2b(),this.n6=null,this.Ycb.dispose(),this.Ycb=null);super.dispose()}get kc(){return"CustomSortDialog"}get ha(){return D.h(this.$).ha}PLh(nb){return vb=>{H.b(vb,-901005882)?(ba.a(this.$).gd.KL(-901005882),this.xId()):H.b(vb,-569193796)?(ba.a(this.$).gd.KL(-569193796),this.hide(),new Ea(this.$,vb.Errors[0])):H.a(vb)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
this.hide()):(vb=vb.Result,this.$.ak(vb.SortRange),vb&&ca(vb)&&wa(vb)&&ia(vb)?nb(vb):this.Q7b(db.qsb()))}}AMh(nb,vb){return(gb,cb)=>{if(this.vhc)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!gb||H.a(gb))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${B.a.nc(gb.Errors)}`),this.$.ea.Sn(gb.Errors),this.hide();
else{gb=gb.Result;var La=nb.RangeType,ja=nb.HeaderRowSize,Ua=nb.SortTopToBottom;gb&&aa(gb,nb.ConditionType)&&X(gb,La,ja,Ua)?(gb.ColumnInfo.ColumnOffset=cb,void 0!==gb.HeaderColumnInfo&&null!==gb.HeaderColumnInfo&&(gb.HeaderColumnInfo.ColumnOffset=cb),vb(gb,nb.ConditionType,nb.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.Q7b(db.qsb()))}}}odh(nb){const vb={};vb.SelectedRange=
this.selectedRange;vb.ActiveCell=this.Nqc;vb.SortInfoMode=nb;vb.ExpandSortSelection=this.J0g;vb.ExpandSortSelectionSupported=!0;return vb}gta(nb){const vb={};vb[L.a.it]=this.kc;vb.fromAutoFilter=nb.FromAutoFilter;vb.gridRTL=D.h(this.$).rtl;vb.activeCell=nb.ActiveCell;vb.selectedRange=nb.SelectedRange;vb.invokeGetSortInfo=this.rki;vb.invokeGetSortConditionColorsOrIcons=this.qki;vb.highlightSortRange=this.Nci;vb.getColorName=this.getColorName;return vb}Joa(nb,vb){nb=u.D(nb);this.ha.qa.ld.equals(nb)||
this.ha.updateSelection(nb,u.C(vb),0,void 0,void 0,void 0,!0)}xId(){(new P(nb=>{const vb={};vb.ActiveCell=this.Nqc;vb.SelectedRange=this.selectedRange;vb.ExpandSelection=nb;vb.FromAutoFilter=!1;this.$.Zc(-207540907,v.a.zb,8,{["SortCommandData"]:vb})})).show()}P2b(){if(void 0!==this.n6&&null!==this.n6)for(const nb of this.n6)this.$.oa.xa.Rfb(nb.Rs)}static Yaj(nb,vb){nb.Zc(1659552324,v.a.zb,8,{["CustomSortCommandData"]:vb})}static qsb(){return B.a.ed(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}
Object(t.a)(db,"CustomSortDialog",E.a,[]);var yb=a(1093);class kb{constructor(nb){this.selection=null;this.selection=nb}getSelection(){return this.selection}}Object(t.a)(kb,"MacroRecorderRangeAutoFilterClearedPayload",null,[122]);class mb{constructor(nb){this.filterRange=null;this.filterRange=nb}}Object(t.a)(mb,"MacroRecorderRangeFilterReappliedPayload",null,[122]);var W=a(60);const Q=(nb,vb,gb,cb,La,ja,Ua=null)=>{Ua=nb.Na(41,Ua);Ua.options=vb;return W.g(nb,"Sort",Ua,gb,cb,La,ja,0)},va=(nb,vb,gb,
cb,La,ja,Ua=null)=>{Ua=nb.Na(41,Ua);Ua.selectedRange=vb;return W.g(nb,"ClearAutoFilter",Ua,gb,cb,La,ja,0)},na=(nb,vb,gb,cb,La,ja,Ua=null)=>{Ua=nb.Na(41,Ua);Ua.filterRange=vb;return W.g(nb,"ReapplyAutoFilter",Ua,gb,cb,La,ja,0)};var Ba=a(782),Oa=a(783),oa=a(115),Ja=a(55),Wb=a(1094),nc=a(205),Yb=a(33),pb=a(345),Fa=a(65),ab=a(4);class Gb{constructor(nb,vb){this.sortOptions=this.SSa=this.selectedRange=null;this.shf=!1;this.activeCell=this.ye=this.tb=this.fc=null;this.onContentReady=()=>{this.LTf(!1);const gb=
this.ha();gb.qa.Tg&&gb.qa.ld.equals(this.SSa)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?gb.updateSelection(this.selectedRange,u.C(this.activeCell),0,void 0,void 0,void 0,!0):gb.updateSelection(this.selectedRange,gb.qa.activeCell,0,void 0,void 0,void 0,!0))};this.DTi=(gb,cb)=>{gb&&!B.a.Wf(gb.Errors)&&this.fc&&(this.fc.Oo=gb.Result,this.XLb(),this.applyPivotSort(cb))};this.CTi=()=>{};this.b0i=(gb,cb)=>{var La,ja;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")?
((null===cb||void 0===cb?0:cb.efg)||(null===(La=this.$.na)||void 0===La?0:La.hasAutoFilter))&&cb.selection&&(ab.AFrameworkApplication.Sp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),Yb.a.erd()&&(gb=Fa.d(this.$.va.na),this.ffg(new pb.a(u.D(cb.selection),gb)))):((null===cb||void 0===cb?0:cb.efg)||(null===(ja=this.$.na)||void 0===ja?0:ja.hasAutoFilter))&&cb.selection&&Yb.a.erd()&&(gb=Fa.d(this.$.va.na),this.ffg(new pb.a(u.D(cb.selection),
gb)))};this.$=nb;this.ypf="";this.namedSheetViewPublic=vb;this.gridView=D.h(this.$);this.$.Jb.zg("LoadResource","LoadDialogControlsStopwatch")}F0(nb){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var vb=this.$.da.Aa(465);vb&&vb.F0(5,nb)}}Hc(nb,vb){return!this.ysd(nb,vb)}executeCommand(nb,vb,gb){let cb=null;nb=vb.command;switch(nb){case -864298118:cb=this.poh(vb,gb);break;case -1010737776:cb=this.U8c(!0,vb,gb);break;case 2123420468:cb=
this.U8c(!1,vb,gb);break;case -1089513346:gb=this.W1e(gb);if(!this.RBb([u.D(gb.SortOptions.SelectedRange)]))return f.TaskExtensions.Tj();cb=this.$Me(vb,gb);break;case -1032691499:case -764711886:case -2016161444:cb=this.d$i(vb,gb);break;case -207540907:case -1677817820:cb=this.gridView.wb.U4(this.ha().qa.activeCell)?this.R9i():this.O9i(vb,gb);break;case 1659552324:cb=this.$Me(vb,this.W1e(gb));break;case 368460465:cb=this.Goh(vb,gb);break;case 529856798:cb=this.koh(vb);break;case 644342024:cb=this.Boh(vb)}return cb||
R.a(nb)}wc(nb,vb){if(nb=1===nb)switch(vb.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:nb=!1}return nb}Mc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}LTf(nb){nb?this.gridView.Uu(this.onContentReady):this.gridView.jy(this.onContentReady);this.shf=nb}get qa(){return this.ha().qa}QGj(nb){return!!this.sortOptions&&
S.a.equals(this.ypf,nb.cia,!0)}ysd(nb,vb){const gb=D.h(this.$).ha.qa.selectedRanges;return(new y.a(this.$.va)).um(nb,vb,gb,this.gridView)}U8c(nb,vb,gb){const cb=new h.a;this.Eef(cb,gb,nb);return this.RBb([u.D(cb.SelectedRange)])?this.gridView.wb.U4(u.D(cb.SelectedRange))?this.yoh(nb):this.Lod(cb,vb):f.TaskExtensions.Tj()}poh(nb,vb){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let gb=null;const cb=this.ha();cb&&(this.QGj(cb)?this.RBb(cb.qa.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,gb=this.Lod(this.sortOptions,nb)):gb=this.U8c(!0,nb,vb));return gb}RBb(nb){return this.$.isEditMode?this.$.Us(nb,!0,1):this.$.$Yc(nb,!0,1)}yoh(nb){this.G_h(nb);return Ja.Task.Ra(!0)}uYg(nb){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const vb=this.gridView.wb.zi(this.qa.ld,!1);if(vb)return new n.a(vb.name,this.qa.activeCell.left-vb.usedRange.left,nb.IsAscending)}return new x.a(nb)}Lod(nb,vb){this.gridView.Gg.dM(!1);
const gb=()=>this.uYg(nb);return this.h$c((cb,La,ja)=>Q(this.$.oa.xa,nb,G.b(cb,this.BMh(vb)),La,ja,nb),cb=>new w.a(141,0,cb,void 0,gb),vb,this.GFj(nb))}GFj(nb){if(!this.namedSheetViewPublic)return!1;const vb=this.qa.ld,gb=u.v(this.qa.ld,this.$),cb=this.gridView.wb.XM(vb,!0),La=this.qa.Dba()&&this.gridView.wb.klf(gb),ja=this.gridView.wb.psi(gb);nb=(vb.c5||vb.TZ)&&!vb.isSingle&&(null==nb.ExpandSortSelection?!1:nb.ExpandSortSelection)&&this.gridView.wb.klf(gb);return cb||La||ja||nb}R9i(){return this.$.Zc(-1556797033,
v.a.zb,8,null)}O9i(nb,vb){nb=8===nb.We&&vb&&void 0!==vb[Gb.Jeb]&&null!==vb[Gb.Jeb]?vb[Gb.Jeb]:19===nb.We&&vb&&void 0!==vb[v.a.Pf]&&null!==vb[v.a.Pf]?r.a.Wh(vb[v.a.Pf]):this.sch();if(!this.RBb([u.D(nb.SelectedRange)]))return f.TaskExtensions.Tj();D.h(this.$).Gg.dM(!1);let gb=null;(vb=vb.TopCellAddress)&&(gb=u.o(vb,this.$));new db(this.$,nb,this.namedSheetViewPublic,gb);return Ja.Task.Ra(!0)}W1e(nb){return nb[Gb.Aih]}$Me(nb,vb){const gb=ja=>{this.Zaf(ja)?this.K$e(ja.Errors[0]):(vb.ShouldRestoreSelection&&
this.Joa(vb.SelectedRange,vb.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${nb.We}`),this.WUj(vb),this.F0(ja))},cb=()=>{vb.ShouldRestoreSelection&&this.Joa(vb.SelectedRange,vb.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${nb.We}`)},La=()=>new A(vb.SortOptions);return this.h$c((ja,Ua,lb)=>Q(this.$.oa.xa,
vb.SortOptions,G.b(ja,gb),G.a(Ua,cb),lb,this.sortOptions),ja=>new w.a(187,0,ja,void 0,La),null,vb.ShouldPromptNamedSheetViewTeachingDialog)}Joa(nb,vb){nb=u.D(nb);D.h(this.$).ha.qa.ld.equals(nb)||D.h(this.$).ha.updateSelection(nb,u.C(vb),0,void 0,void 0,void 0,!0)}sch(){const nb={};nb.ActiveCell=u.o(this.qa.activeCell,this.$);nb.SelectedRange=u.v(this.qa.ld,this.$);nb.FromAutoFilter=!1;nb.ExpandSelection=null;return nb}Goh(nb,vb){const gb=this.Kaa();if(!gb)return Ja.Task.Ra(!1);const cb=this.$.oa.xa.Wb(),
La=()=>new yb.a(gb);return z.a(this.$.userOperationManager,(ja,Ua,lb)=>C.B(this.$.oa.xa,gb,G.b(Ba.a.S4a(oa.a.Ipb,Oa.a.toggleAutoFilter,ja),this.b0i),Ua,lb,{selection:gb,efg:vb.On},cb),ja=>new w.a(516,0,ja,64,La),nb)}koh(nb){const vb=this.Kaa();if(!vb)return Ja.Task.Ra(!1);const gb=this.gridView.wb.zi(this.qa.ld,!0);gb&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${gb.type.toString()}`);const cb=this.$.oa.xa.Wb(),La=()=>new kb(vb);return this.h$c((ja,Ua,lb)=>va(this.$.oa.xa,
vb,Ba.a.S4a(oa.a.HGa,Oa.a.clearAutoFilter,ja),Ua,lb,null,cb),ja=>new w.a(517,0,ja,64,La),nb)}h$c(nb,vb,gb,cb=!0){return this.namedSheetViewPublic&&cb?this.namedSheetViewPublic.ASa().continueWith(La=>{La.result&&z.a(this.$.userOperationManager,nb,vb,gb)}):z.a(this.$.userOperationManager,nb,vb,gb)}Boh(nb){const vb=this.Kaa();if(!vb)return Ja.Task.Ra(!1);const gb=this.$.oa.xa.Wb(),cb=()=>new mb(vb);return z.a(this.$.userOperationManager,(La,ja,Ua)=>na(this.$.oa.xa,vb,Ba.a.S4a(oa.a.HGa,Oa.a.Sbj,La),ja,
Ua,null,gb),La=>new w.a(518,0,La,64,cb),nb)}BMh(nb){return(vb,gb)=>{var cb;H.b(vb,-901005882)?(ba.a(this.$).gd.KL(-901005882),this.xId(gb,nb.command)):this.Zaf(vb)?this.K$e(vb.Errors[0]):!H.a(vb)&&vb.Result&&(this.sortOptions=gb,this.SSa=u.D(vb.Result.ActualSortRange),this.ypf=this.ha().cia,this.shf||(this.selectedRange=this.qa.ld,this.selectedRange.equals(this.SSa)||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=u.o(this.qa.activeCell,
this.$)),this.SJj())),(null===(cb=this.sortOptions)||void 0===cb?0:cb.ActiveCell)&&this.W8f(this.sortOptions)&&(gb=this.sortOptions.ActiveCell,gb=new l.Range(gb.FirstRow+1,gb.FirstColumn+1,gb.FirstRow+1,gb.FirstColumn+1,!0,!1),this.aS(gb),this.IZd(gb)),this.F0(vb))}}Zaf(nb){return H.b(nb,-569193796)}K$e(nb){ba.a(this.$).gd.KL(-569193796);new Ea(this.$,nb)}xId(nb,vb){(new P(gb=>{const cb={};cb.ActiveCell=nb.ActiveCell;cb.SelectedRange=nb.SelectedRange;cb.ExpandSelection=gb;this.$.Zc(vb,v.a.zb,8,{[Gb.Jeb]:cb})})).show()}SJj(){const nb=
this.ha();if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let vb=u.C(this.activeCell);this.SSa.De(vb)||(vb=this.SSa.topLeft);nb.updateSelection(this.SSa,vb,0,void 0,void 0,void 0,!0)}else nb.updateSelection(this.SSa,nb.qa.activeCell,0,void 0,void 0,void 0,!0);this.LTf(!0)}Kaa(){const nb=this.ha();if(!nb)return d.ULS.shipAssertTag(537151573,0,!!nb,"SelectionManger is null"),null;this.gridView.Gg.dM(!1);return u.v(nb.qa.ld,this.$)}XLb(){this.fc&&
this.fc.Oo&&(this.ye=this.fc.Oo,this.tb=this.fc.Qbc())}G_h(nb){if(this.$.isEditMode&&(this.fc=this.gridView.wb.Wo(this.qa.activeCell))){this.activeCell=u.o(this.qa.activeCell,this.$);if(this.fc&&this.fc.Oo){var vb=this.fc.Oo.CurrentCol;if(this.fc.Oo.CurrentRow===this.activeCell.FirstRow&&vb===this.activeCell.FirstColumn){this.XLb();this.applyPivotSort(nb);return}}this.$.oa.xa.Wb();vb=new w.a(228,0,(gb,cb,La)=>C.l(this.$.oa.xa,this.activeCell,G.b(gb,this.DTi),G.a(cb,this.CTi),La,nb),16);this.$.userOperationManager.Jc(vb,
null)}}applyPivotSort(nb){if(this.fc&&this.tb&&this.activeCell&&this.ye){var vb=8===this.ye.CellArea,gb=1===this.ye.CellArea||2===this.ye.CellArea;(vb||gb)&&8!==this.ye.CellType&&4!==this.ye.CellType&&(vb?z.a(this.$.userOperationManager,(cb,La,ja)=>C.b(this.$.oa.xa,this.activeCell,nb?1:2,this.tb.Caption,cb,La,ja,null),cb=>new w.a(1015,0,cb,void 0,null),null):(vb=1===this.ye.CellArea?1:2,this.$.sa(600)?m.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,
this.tb.Index.toString(),this.tb.Caption,this.fc.isOlap?"":this.tb.Caption,vb,nb):m.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.tb.Index.toString(),nb)))}}WUj(nb){this.W8f(nb.SortOptions)&&(nb.TopCellAddress?nb=u.C(nb.TopCellAddress):(nb=nb.OriginalActiveCell,nb=new l.Range(nb.FirstRow+1,nb.FirstColumn+1,nb.FirstRow+1,nb.FirstColumn+1,!0,!1)),this.aS(nb))}aS(nb){Yb.a.Tka(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,
430,431,1),vb=>{vb.result.sea(nb);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}IZd(nb){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,476,475,0),vb=>{vb.result.IZd(nb,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,
3)}d$i(nb,vb){if(!this.RBb(this.qa.selectedRanges))return f.TaskExtensions.Tj();const gb=new h.a;this.Eef(gb,vb);gb.SortConditions=[this.Ifh(nb)];gb.OperationType=2;return this.Lod(gb,nb)}Ifh(nb){const vb=this.gridView.Qb(this.qa.activeCell);let gb=new Wb.a;gb.IsAscending=!0;switch(nb.command){case -1032691499:vb.oyb?(nb=nc.a.Uo(vb.backgroundColor),gb.SortColor=nb.YR(!0)):gb.SortColor=Gb.NoColor;gb.SortConditionType=1;break;case -764711886:gb.SortColor=vb.h3c===Gb.NoColor?Gb.NoColor:nc.a.bxe(vb.h3c);
gb.SortConditionType=2;break;case -2016161444:vb.uyb?(gb.SortIcon=vb.cell.ukc,gb.SortIconSet=vb.vkc):(gb.SortIcon=Gb.A3d,gb.SortIconSet=Gb.A3d);gb.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return gb}ffg(nb){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),vb=>{void vb.result.JCc(nb,"Filter")},this.$.la,3)}Eef(nb,vb,gb=!0){nb.OperationType=
0;nb.IsAscending=gb;nb.HasHeader=!0;nb.GuessHeader=!0;nb.SortTopToBottom=!0;nb.ExpandSortSelectionSupported=!0;vb&&vb[Gb.Jeb]?(vb=vb[Gb.Jeb],nb.ActiveCell=vb.ActiveCell,nb.SelectedRange=vb.SelectedRange,nb.ExpandSortSelection=vb.ExpandSelection):(nb.ActiveCell=u.o(this.qa.activeCell,this.$),nb.SelectedRange=u.v(this.qa.ld,this.$),nb.ExpandSortSelection=null)}W8f(nb){return!nb.SortConditions||nb.SortConditions.some(vb=>0===vb.SortConditionType)}}Gb.Aih="CustomSortCommandData";Gb.Jeb="SortCommandData";
Gb.A3d=-1;Gb.NoColor=0;Object(t.a)(Gb,"SortCommandHandler",null,[221]);class Ga extends b.a{constructor(nb){super(nb)}hd(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Xa),nb=>{this.$c([new Gb(this.$,nb.result)])},this.$.la,3)}static ka(nb){b.a.Ld(160,new Ga(nb))}}Object(t.a)(Ga,"SortCommandHandlerFactory",b.a,[]);E=a(226);Sa=a(173);var Ma=a(186),Qa=a(105);let wb=class{constructor(nb){I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||nb.da.Ha(446,
this)}ZIe(nb,vb){new Ea(nb,vb)}};wb=Object(Sa.b)([Object(Ma.d)(Qa.n),Object(Sa.c)(0,Object(Qa.f)())],wb);Object(t.a)(wb,"SortUtil",null,[251]);class Na extends E.a{constructor(nb){super();this.$=nb;this.Db()}create(){let nb=this.$.da.Aa(446);nb||(nb=new wb(this.$),this.$.da.Ha(446,nb));this.nb(nb)}static ka(nb){nb.da.Ha(447,new Na(nb))}}Object(t.a)(Na,"SortUtilFactory",E.a,[]);a.d(F,"a",function(){return ya});const ya=()=>{c.a.Fa(nb=>{Ga.ka(nb);I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||
Na.ka(nb)})}},1180:function(t,F,a){t=a(0);var c=a(551),b=a(15),e=a(136),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(Q,va){this.FMe(Q,va,f.a.Krj)}FMe(Q,va,na){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",na);this.Kz(na,Q,va,null)}J8c(Q,va){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Kz(f.a.Mrj,Q,va,null,!0)}}Object(t.a)(d,"ErrorDialog",
e.StandardDialog,[326]);var h=a(85);e=a(1071);var m=a(150);class l{static get og(){return m.a.xq(l.Ll,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}l.Ll="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(t.a)(l,"FileNameDialogHtml",null,[]);var v=a(4),r=a(14),A=a(46),x=a(86),n=a(88),u=a(30);class z extends e.a{constructor(Q,va,na,Ba,Oa,oa,Ja,Wb){super(Q,va,na,Ba,Oa,oa,Wb);this.iqa=this.wSc=this.Jy=null;this.d_g=CommonUIStrings.l_SaveToAnotherFolder;this.og=l.og;this.pe="FileNameDialog-SaveToSharePoint";this.emb=Ja;this.dBg=Wb}MP(Q){const va=u.a.Kp(v.AFrameworkApplication.om.en),na=v.AFrameworkApplication.breadcrumbFolderName,Ba=v.AFrameworkApplication.breadcrumbBrandName,Oa={["txtFileName"]:Q||
va};let oa=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.ra.Qa.Oj&&(oa=CommonUIStrings.L_SaveACopy);this.initializeAndShow(oa,Object(h.a)(this,this.F$b,"fileNameDialogHandler"),Oa);this.nMe(Q,va);this.HIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.pa("HideSaveToAnotherFolderButtonforUIHost")||(this.Jy=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.wSc=
n.a.Ute(Q,this.Jy,"anotherFolderDescribedBy"),this.Jy.className="WACButton WACDialogButtonNormal",Q=!1,na&&na.length?(this.loe(this.Jy,this.wSc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ba,na)),Q=this.cIg(Ba,na)):this.loe(this.Jy,this.wSc,CommonUIStrings.l_CurrentOnlineFolder),this.bJg(this.Jy),this.eIg(this.Jy),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Jy,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,50,
"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Jy,"SaveToAnotherLocationOne"),A.a.addHandler(this.Jy,r.a.click,Object(h.a)(this,this.kEd,"onSaveToAnotherLocationClick")),A.a.addHandler(this.Jy,r.a.Sb,Object(h.a)(this,this.DHf,"onSaveToAnotherLocationKeyDown")))}cIg(Q,va){let na;na=!1;const Ba=document.getElementById("currentLocation");Ba.innerText="";const Oa=this.N4e(Ba,Q),oa=this.N4e(Ba,va);let Ja=255,Wb=255;255<Oa+oa&&(Ja=Math.max(238,408-Oa),Wb=Math.max(170,
408-oa),na=!0);this.xKg(Ba,Q,Wb,va,Ja);return na}N4e(Q,va){const na=document.createElement("div");na.innerText=va;na.style.visibility="hidden";Q.appendChild(na);va=na.clientWidth;Q.removeChild(na);return va}xKg(Q,va,na,Ba,Oa){va&&(this.joe(Q,va,na),this.oKg(Q));Ba&&this.joe(Q,Ba,Oa)}joe(Q,va,na){const Ba=document.createElement("div");Ba.innerText=va;Ba.title=va;Ba.className="SaveToAnotherFolderBreadcrumb";Ba.style.maxWidth=na.toString()+"px";Q.appendChild(Ba)}oKg(Q){const va=document.createElement("span");
va.id="FolderSeparator";const na=document.createElementNS("http://www.w3.org/2000/svg","svg");na.setAttribute("class","SeparatorCaret");const Ba=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ba.setAttribute("points","1 4 1 11 5 7.5");na.appendChild(Ba);va.appendChild(na);Q.appendChild(va)}loe(Q,va,na){na=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,na);va&&(va.innerText=na);Q.tabIndex=0;Q.setAttribute(n.a.Cd,n.a.Qs)}eIg(Q){const va=document.createElement("span");
va.id="anotherFolderText";va.innerText=this.d_g;va.className="AnotherFolderTextSpan";Q.appendChild(va)}bJg(Q){const va=document.createElement("span");va.className="cui-img-cont-float cui-img-16by16 ";this.iqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.iqa.setAttribute("class","FolderIconSVG");const na=document.createElementNS("http://www.w3.org/2000/svg","path");na.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.iqa.appendChild(na);va.appendChild(this.iqa);Q.appendChild(va)}DHf(Q){!Q||Q.keyCode!==x.a.Jh&&Q.keyCode!==x.a.XW||this.kEd(Q)}kEd(){if(this.CI){const Q=u.a.T3(v.AFrameworkApplication.fileName);let va=this.CI.value;this.hide();va&&""!==va&&""!==Q||1===this.ra.state?(""!==Q&&(va+=Q),this.G$b(va)?this.Es.create().displayError(1,va,!1):this.emb.start(va,this.dBg)):this.Es.create().displayError(2,va,!1)}}P2g(Q){this.Jy&&this.iqa&&(Q?(this.Jy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Jy,"DisabledSaveAsButton"),
Sys.UI.DomElement.removeCssClass(this.iqa,"DisabledFolderIconSVG")):(this.Jy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Jy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.iqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Jy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.iqa,"DisabledFolderIconSVG"))))}tkd(){super.tkd();this.P2g(!!this.CI&&""!==this.CI.value)}dispose(){this.Jy&&(A.a.removeHandler(this.Jy,r.a.click,Object(h.a)(this,this.kEd,"onSaveToAnotherLocationClick")),
A.a.removeHandler(this.Jy,r.a.Sb,Object(h.a)(this,this.DHf,"onSaveToAnotherLocationKeyDown")),this.Jy=null);super.dispose()}}Object(t.a)(z,"FileNameDialog",e.a,[342]);var w=a(697),C=a(552),y=a(191),B=a(826),H=a(925),I=a(99),R=a(138);class S{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(t.a)(S,"SaveAsDialogInput",null,[]);class G{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(t.a)(G,"SaveLocation",
null,[]);var D=a(376),E=a(193);class M{constructor(Q,va,na,Ba,Oa,oa,Ja,Wb,nc){this.GOc=null;this.bA="";this.emb=Q;this.Es=va;this.zh=nc;this.rga=na;this.Ze=Oa;this.Lv=Ba;this.vFa=Ja;this.PXa=Wb;oa&&(this.GOc=new c.a(()=>new B.a(oa.value,null)))}tSh(){const Q=new w.a(C.a.Ni());Q.ia("type","currentHost");return Object.assign(new G,{folderName:this.Lv.breadcrumbFolderName,friendlyPath:this.Lv.breadcrumbBrandName,properties:Q})}Xti(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&
-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}a3h(){if(!this.GOc||!this.vFa)return null;var Q=this.GOc.value.rZ("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.twf)return null;Q=Q.twf;const va=new y.a;let na=0,Ba=0;for(var Oa=0;Oa<Q.length;Oa++){var oa=Q[Oa];if(!this.Xti(oa))continue;na++;if(!oa.sharepoint_info)continue;const Ja=oa.url,Wb=oa.sharepoint_info.site_url,nc=oa.title;oa=H.b(oa,v.AFrameworkApplication.isRtl);if(!(Ja&&Wb&&nc&&oa))continue;Ba++;const Yb=new w.a(C.a.Ni());Yb.ia("type",
"SharePoint");Yb.ia("siteUrl",Wb);Yb.ia("folderUrl",Ja);Ba++;va.add(Object.assign(new G,{folderName:nc,friendlyPath:oa,properties:Yb}))}Oa=new Map;Oa.set("NumPlaces",Q.length.toString());Oa.set("NumSharepointPlaces",na.toString());Oa.set("placesWithMetadata",Ba.toString());I.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Oa);0<na&&(Ba?.5>1*Ba/na&&I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"AllPlacesMetadataMissing",!1,!1,null));return va}jTh(){const Q=new y.a;Q.add(this.tSh());const va=this.a3h();va&&Q.addRange(va);return Object.assign(new S,{enableMoreLocations:!v.AFrameworkApplication.fa.pa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.bA,extension:u.a.T3(this.Lv.en),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}Tbc(){const Q=Object(h.a)(this,this.jTh,"getDialogInput"),va={};va.inputPropsCallback=Q;return va}MP(Q){this.bA=Q;this.bA||(this.bA=String.format(CommonUIStrings.l_SaveACopy_Filename,
u.a.Kp(this.Lv.en)));Q={["id"]:"SaveAsDialog",["bodyControls"]:this.Tbc()};let va=CommonUIStrings.L_SaveAs;2===this.Ze.Qa.Oj&&(va=CommonUIStrings.L_SaveACopy);const na=new m.a(!1,!1,!0);na.Ob=1;na.pe="SaveAsDialog";na.tc(1,CommonUIStrings.l_SaveButtonLabel);na.initializeAndShow(va,Object(h.a)(this,this.Grj,"saveAsDialogHandler"),Q)}VIj(Q,va){Q&&""!==Q&&""!==va||1===this.Ze.state?this.Wti()?this.BAi(Q,va):(""!==va&&(Q+=va),this.emb.start(Q,this.zh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.Es.create().displayError(2,Q,!1))}BAi(Q,va){I.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const na=this.PXa.MHe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.PXa.pgd(na).then(Ba=>{if(Ba&&0<Ba.length){const Oa=Ba[0][D.a.U4i];Ba=Ba[0][D.a.yMf];if(""!==Oa&&""!==Ba)this.vFa.aoa(Ba,Q+va,Oa,this.zh),I.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Es.create().displayError(0,Q,!1);const oa=R.a.Pr();
oa&&(oa.set("SiteUrlAvailable",""===Oa?"false":"true"),oa.set("FolderUrlAvailable",""===Ba?"false":"true"));I.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new E.a,{extendedProperties:oa}))}}else this.Es.create().displayError(0,Q,!1),I.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ba=>{"Canceled"===Ba?((Ba=R.a.Pr())&&Ba.set("IsCanceled","true"),I.Health.instance.recordKpiSuccess("SaveACopySFP",
Object.assign(new E.a,{extendedProperties:Ba}))):I.Health.instance.recordKpiFailure("SaveACopySFP",Ba,!1,!1,null)})}Wti(){return this.PXa?this.PXa.Vsd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Grj(Q,va){if(va&&1===Q){Q=va.fileName;var na=u.a.T3(this.Lv.en);va.moreLocationsSelected&&this.VIj(Q,na);if(va.locationCallback){var Ba=va.locationCallback();Ba?Ba.properties&&"currentHost"===Ba.properties.ma("type")?this.rga.aoa(Q+na,!1,this.zh):Ba.properties&&"SharePoint"===
Ba.properties.ma("type")?(va=Ba.properties.ma("siteUrl"),Ba=Ba.properties.ma("folderUrl"),this.vFa.aoa(Ba,Q+na,va,this.zh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(t.a)(M,"ReactSaveAsDialog",null,[342]);class L{constructor(Q,va,na,Ba,Oa,oa,Ja,Wb=null,nc=null,Yb=null){this.Ma=va;this.mb=Q;this.hX=Ba;this.rga=oa;this.Es=Oa;this.Ze=
na;this.Sie=Ja;this.Kzg=Wb;this.vFa=nc;this.PXa=Yb}create(Q){return this.Ze&&this.Ze.Qa.sv?new M(this.Sie,this.Es,this.rga,v.AFrameworkApplication.om,this.Ze,this.Kzg,this.vFa,this.PXa,Q):new z(this.mb,this.Ma,this.Ze,this.hX,this.Es,this.rga,this.Sie,Q)}}Object(t.a)(L,"FileNameDialogFactory",null,[325]);class N{constructor(Q,va,na,Ba){this.Go=this.elb=null;this.ajb=Q;this.Ze=na;this.zBg=Ba;this.ODa=new c.a(()=>new B.a(va.value,Object(h.a)(this,this.gxb,"getMoreInfoEventReceived")))}get lKf(){this.elb||
(this.ODa.value.rZ("Save As",!0),this.Go&&this.Go.hR&&this.Go.hR.length&&(this.elb=this.SZh(this.Go.hR)));return this.elb}start(Q){if(!this.lKf)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.elb=v.AFrameworkApplication.breadcrumbFolderUrl;else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Go),!1;const va=
this.zBg();va.oJj();const na=va.A_h();if(!na)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ajb.start((Ba,Oa)=>{va.hide();Q(Ba,Oa)},()=>{this.rca(va)},na,this.elb);return!0}rca(Q){Q.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}SZh(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const va=Q.indexOf("/documents/");return-1!==va?Q.substring(0,va+1)+"_layouts/15/onedrive.aspx":""}gxb(Q){this.Go||3!==Q.state||(this.Go=
Q)}}Object(t.a)(N,"OneDriveFilePickerHelper",null,[324]);class Y extends m.a{constructor(){super()}oJj(){this.qJc="FilePickerDialog";this.og="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.pe="PickerDialog-MsoSp";this.showDialog("",null)}A_h(){return document.getElementById("FilePickerDiv")}zD(){}Jma(){}}Object(t.a)(Y,"PickerDialog",m.a,[323]);var U=a(650),P=a(852),aa=a(378),X=a(27),Z=a(108),da=a(25);class qa{constructor(Q,va,na,Ba,Oa,oa,Ja){this.mb=Q;this.zKc=na;this.Ma=va;this.emb=Ba;
this.ajb=Oa;this.pQc=oa;this.Stg=Ja}Ag(){const Q=this.ajb.F4a();Q?X.a.Kka||this.mb.pa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ma.Ne(da.a.saveToSharePoint,Z.a.frame,Object(h.a)(this,this.Y0f,"saveToSharePointActionDispatcher"),64):(Q.Q8a.continueWith(va=>{va.Hf&&this.ajb.ADd(va)}),this.D2b()):b.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}D2b(){aa.a.AKd(Object(h.a)(this,this.Y0f,"saveToSharePointActionDispatcher"));aa.a.g$c([new P.a(da.a.saveToSharePoint,
Z.a.frame,0)],this.ajb.F4a())}get X7a(){return this.mb.pa("SaveToAnotherFolderBrsIsEnabled")}get fAe(){return this.mb.pa("UserCanWriteRelative")}Y0f(Q,va,na,Ba,Oa){return va.contextId!==Z.a.frame||Q!==da.a.saveToSharePoint?2:this.X7a&&(this.pQc.lKf||this.fAe)?1===na?U.SessionStatusManager.instance.p5a||v.AFrameworkApplication.O4?8:this.Stg()?32:8:2===na?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Oa&&Oa.SaveEntryPoint&&"VersionHistory"===Oa.SaveEntryPoint.toString()?
"version history.":"the backstage.")),this.fAe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.zKc.create(Oa).MP(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.emb.start(null,Oa)),32):8:8}}Object(t.a)(qa,"SaveToSharePointActor",null,[]);class O{constructor(Q,va,na,Ba){this.zh=this.Xee=null;this.vFa=Q;this.Es=va;this.pQc=na;this.Ze=Ba}start(Q,va){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");
this.Xee=Q;this.zh=va;this.pQc.start((na,Ba)=>{this.v9i(na,Ba)})||this.UUd()}v9i(Q,va){if(Q)this.onSuccess(va);else this.X5(va)}UUd(){1!==this.Ze.state&&this.Es().J8c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const va=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;
let na=null;if(va&&(na=Q?this.t3h(Q):this.s3h(va))){this.vFa.aoa(va,this.Xee,na,this.zh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!va,!na)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.UUd()}s3h(Q){Q.endsWith("/")||(Q+="/");let va=0;for(let na=0;na<Q.length;na++)if("/"===Q.charAt(na)&&5===++va)return Q.substr(0,na);return null}t3h(Q){Q.endsWith("/")&&(Q=Q.substring(0,
Q.length-1));const va=Q.lastIndexOf("/");return-1!==va?Q.substring(0,va):null}X5(Q){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):b.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.UUd()}}Object(t.a)(O,"SaveToSharePointManager",null,[322]);var ca=a(79);class wa{constructor(Q,va,na,Ba,Oa,oa,Ja,Wb){this.BFa=
Q;this.bA=va;this.UVa=Ba;this.nRc=oa;this.r8=na;this.cEg=Oa;this.qfa=Ja;this.zh=Wb}execute(Q,va){if(!v.AFrameworkApplication.rg&&v.AFrameworkApplication.Bd){var na=this.BFa+this.qfa;na=ca.a.wl(na,"fu",u.a.hf(this.r8));na=ca.a.wl(na,"su",u.a.hf(this.cEg));na=ca.a.wl(na,"fn",u.a.hf(this.bA));na=ca.a.wl(na,"n",u.a.hf((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(na=ca.a.wl(na,"furl",u.a.hf(this.zh.FileDownloadUrl)));na=na+"&"+this.nRc;this.UVa&&this.UVa.length?na=ca.a.wl(na,"fnn",
u.a.hf(this.UVa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Bd.Im(na,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,va,null,void 0,void 0,void 0,void 0,"9")}}}Object(t.a)(wa,"SharePointSaveAsCaller",null,[341]);class ia{constructor(Q){this.CFa=Q.appSettings.SaveAsToHostWebServiceBase;this.bA=Q.appSettings.FileName;this.qfa=Q.Wa("SharePointSaveAsHandler")||
"sharepointsaveashandler.ashx"}create(Q,va,na,Ba){return new wa(this.CFa,this.bA,Q,va,na,v.AFrameworkApplication.ti,this.qfa,Ba)}}Object(t.a)(ia,"SharePointUploadCallerFactory",null,[321]);var Ha=a(39),Sa=a(40),Da=a(242),ea=a(699),sa=a(167),Ea=a(652),ba=a(777);class ka{constructor(Q,va,na,Ba,Oa){this.Gm=this.VCa=null;this.VGc=!1;this.tSc=this.r8=null;this.HUc=va;this.Flb=na;this.Es=Ba;this.Ze=Oa;this.Ma=Q}aoa(Q,va,na,Ba){this.VGc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.vNb();this.r8=Q;Ba&&Ba.SaveEntryPoint&&(this.tSc=Ba.SaveEntryPoint);this.VCa=this.HUc.create(Q,va,na,Ba);Ba&&"true"===Ba.SkipSaveToHost?this.UP():this.sJh()}sJh(){const Q=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.UP()};32!==this.Ma.Wd(da.a.rRa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.UP()},Q])&&Q()}UP(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");
this.VCa.execute(Object(h.a)(this,this.RYi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.QYi,"onSaveToSharePointUploadFailed"))}RYi(Q){if(Q&&Q.data&&Q.data.de){var va;if(({ht:va}=Ha.d(Q.data.de)).returnValue)if(va.StatusCode!==Da.a.EO&&va.StatusCode!==Da.a.Hsb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,va.StatusCode),va.StatusCode!==Da.a.HYf&&this.dNe(Q.data.status)||(this.xda(va.StatusCode.toString()),
this.$Hj(va.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.mNd();try{va.NewDocumentUrl?this.lQa(va.NewDocumentUrl):this.mQa()}catch(na){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",na.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ba.a.Qfb(Q.data.de)}),this.g8b()||(this.xda("Failed to deserialize response"),this.tNb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),
this.g8b()||(this.xda("Unknown"),this.tNb())}QYi(Q){Q&&Q.data?this.dNe(Q.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.xda(ea.a[Q.data.status]),this.tNb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.g8b()||(this.xda("Unknown"),this.tNb()))}g8b(){if(!this.VGc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.VGc=!0,this.UP(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");
return!1}dNe(Q){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.g8b()}mQa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Sa.a.gf(this.r8,Sa.a.ZW(3),void 0,"UploadToSharePointManager.RedirectToFolder")}lQa(Q){let va=!1,na=!1;v.AFrameworkApplication.fa&&(va=v.AFrameworkApplication.fa.pa("SaveACopyIsEnabledForUiHost"),na=v.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
Q,va);if(va&&na){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ba={};Ba[D.a.fQa]="1";Ba[D.a.documentUrl]=Q;Ba[D.a.reason]=Ea.a.saveAs;v.AFrameworkApplication.nQ().execute(Oa=>{Oa.jj(sa.a.PY,Ba)})}else Sa.a.gf(Q,Sa.a.ZW(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}vNb(){this.Ze&&1===this.Ze.state||(this.Gm=this.Flb(),this.Gm.message=CommonUIStrings.l_CommentProgressTooltip,this.Gm.Ob=5,this.Gm.pt=!1,this.Gm.WAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}OIa(){this.Gm&&(this.Gm.close(),this.Gm=null)}tNb(){this.kj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}$Ij(){this.kj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}hIj(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.kj(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,f.a.Hrj)}kj(Q,va,na=f.a.Lrj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,va);
this.OIa();1!==this.Ze.state&&this.Es().FMe(Q,va,na)}$Hj(Q){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case Da.a.zhg:this.$Ij();break;case Da.a.HYf:this.hIj();break;default:this.tNb()}}mNd(){"VersionHistory"===this.tSc&&this.Ma.processAction(da.a.vvc,2)}xda(Q){"VersionHistory"===this.tSc&&this.Ma.Wd(da.a.oNd,2,{["FailureReason"]:Q})}}Object(t.a)(ka,"UploadToSharePointManager",null,[236]);var Ca=a(252),db=a(794),yb=a(518),kb=a(55);class mb{constructor(){this.nra=
this.JPc=this.EPc=this.$a=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Ah(Q){this.$a=Q;this.EPc=yb.a.Pq(Q.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.JPc=yb.a.Pq(Q.Tb("Common.IEventEmitter<Common.IMruResult>"));this.nra=yb.a.Pq(Q.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));kb.Task.WAA.call(null,this.EPc,this.JPc,this.nra).continueWith(()=>{this.Dej()})}Dej(){this.$a.register(ia,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").yc(()=>
new ia(v.AFrameworkApplication.fa)).qc();this.$a.register(ka,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").yc(()=>new ka(v.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new db.a).create(),()=>new d,v.AFrameworkApplication.ra)).qc();this.$a.register(O,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").yc(()=>
new O(this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.ra)).qc();this.$a.register(N,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").yc(()=>new N(this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.EPc.result),v.AFrameworkApplication.ra,()=>new Y)).qc();
this.$a.register(L,"Common.App.SaveToSharePoint.FileNameDialogFactory").yc(()=>new L(v.AFrameworkApplication.fa,v.AFrameworkApplication.rb,v.AFrameworkApplication.ra,v.AFrameworkApplication.ra.Qa,this.$a.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.$a.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new c.a(()=>this.JPc.result),this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
this.nra?this.nra.result:null)).qc();this.$a.register(qa,"Common.App.SaveToSharePoint.SaveToSharePointActor").yc(()=>new qa(v.AFrameworkApplication.fa,v.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.ra.g1g)).qc();
v.AFrameworkApplication.fa.pa("SaveToAnotherFolderBrsIsEnabled")&&this.$a.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ag()}static main(){Ca.a.instance.gi(new mb)}}Object(t.a)(mb,"PackageManager",null,[4,5]);a.d(F,"a",function(){return W});const W=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");mb.main()}},1190:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=a(50),f=a(37),d=a(1),h=a(188);class m{constructor(na,Ba){this.$=na;this.presentModeManager=Ba}Hc(){return!1}wc(na,
Ba){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(Ba.command){case 642419866:return!0;case 588342182:return this.presentModeManager.jz;default:return!1}}executeCommand(na,Ba){na=f.TaskExtensions.Tj();Ba=Ba.command;switch(Ba){case 642419866:this.presentModeManager.Ozc(!this.presentModeManager.jz);this.presentModeManager.Zg("TogglePresentMode");break;case 588342182:this.presentModeManager.M7a=!this.presentModeManager.M7a;this.presentModeManager.f$f(this.presentModeManager.M7a,
"TogglePresentModeOverlay");this.presentModeManager.Zg("TogglePresentModeOverlay");break;default:na=h.a(Ba)}return na}Mc(){return!1}}Object(t.a)(m,"PresentModeCommandHandler",null,[221]);class l extends b.a{constructor(na){super(na)}hd(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,423,424,this.Xa),na=>{this.$c([new m(this.$,na.result)])},this.la,3)}static ka(na){b.a.Ld(420,new l(na))}}Object(t.a)(l,"PresentModeCommandHandlerFactory",b.a,[]);var v=a(173),r=a(226),A=a(15),x=a(134),n=a(4),
u=a(111),z=a(84);class w{}w.vxh="ewa-presentMode-overlay";w.wxh="ewa-presentMode-panel-container";w.xxh="ewa-presentMode-rowHdrParent-container";Object(t.a)(w,"CssClassNames",null,[]);var C=a(19),y=a(5),B=a(153),H=a(294),I=a(127),R=a(374),S=a(192);a(56);var G=a(117),D=a(439),E=a(12),M=a(11),L=a(101),N=a(349),Y=a(21),U=a(128),P=a(425),aa=a(110),X=a(14),Z=a(264),da=a(251),qa=a(162),O=a(44);class ca{constructor(na){this.Ove=this.OPa=this.nHd=this.oHd=this.Vca=this.ewaAccessibilityManager=null;this.isInitialized=
!1;this.Wrc={};this.Vrc={};this.JPa=null;this.UMf=0;this.onKeyDown=Ba=>{Ba=Ba.Ea;if(9===Ba.keyCode){var Oa=this.Vca.querySelectorAll(E.DOMElementExtensions.kr);const oa=E.DOMElementExtensions.rm(Oa);Oa=E.DOMElementExtensions.LA(Oa);E.DOMElementExtensions.CAa(Ba,oa,Oa);return!0}return!1};this.Yl=()=>{this.$.da.gb(337,Ba=>{this.OPa.getPresentModeFloatieControlsMap().then(Oa=>{const oa={};for(let Ja=0;Ja<Oa.length;Ja++)oa[Oa[Ja].controlId]=Oa[Ja].modelType;Oa=Ba.z6.U4a(oa);0<Oa.length&&appChrome.api.dispatch(Oa);
this.csj()})})};this.$=na}dispose(){this.$=this.nHd=this.oHd=this.Vca=this.OPa=null}Sgi(){window.requestAnimationFrame(()=>{this.Vca=document.createElement("div");this.$.eu.insertBefore(this.Vca,this.$.eu.lastChild);this.Vca.id=this.$.Bb+y.a.iac;this.Vca.classList.add(w.wxh);this.oHd=document.getElementById(this.$.Bb+y.a.D7c);this.nHd=[this.$.tE];this.isInitialized=!0});this.OPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.OPa.initializePresentModeFloatie()}z4h(){const na=
{};na.PollingCountPerCaller=u.a.toJSON(this.Vrc);na.PollingDurationPerCaller=u.a.toJSON(this.Wrc);return na}TUd(na){this.isInitialized?na?(this.OPa.showPresentModeFloatie(this.Vca,this.oHd,this.nHd),this.Zg("ShowOrHideFloatiePanel"),this.Ffj()):(this.OPa.hidePresentModeFloatie(),this.aYj()):A.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Zg(na){this.UMf=M.HelperMethods.Kb();this.JPa=na;this.Ove=qa.AsyncMethodContext.tq(this.Yl,
100,O.a.e8i+na,this.Ove)}get jc(){return this.Vca}get Ff(){this.OPa.updatePresentModeFloatieShyState(2);return!!this.Vca}get Yd(){return da.a.hOf}ag(na,Ba){if(Ba)return!1;na=E.DOMElementExtensions.rm(this.Vca.querySelectorAll(E.DOMElementExtensions.kr));if(!na)return A.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;na.focus();return!0}sh(na){return E.DOMElementExtensions.Af(this.jc,na)}rj(){}dk(){}Ffj(){Z.a(this.$).Xh(this);
this.$.da.gb(15,na=>{this.ewaAccessibilityManager=na;this.ewaAccessibilityManager.mode=5});aa.KeyInputManager.instance.ta(X.a.Sb,this.jc,this.onKeyDown)}aYj(){Z.a(this.$).Cz(this);Y.h(this.$).l0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);aa.KeyInputManager.instance.Ba(X.a.Sb,this.jc,this.onKeyDown)}csj(){const na=M.HelperMethods.Kb()-this.UMf,Ba=this.Wrc[this.JPa]?this.Wrc[this.JPa]:0;this.Wrc[this.JPa]=Ba>na?Ba:na;this.Vrc[this.JPa]=this.Vrc[this.JPa]?this.Vrc[this.JPa]+
1:1}}Object(t.a)(ca,"PresentModeFloatieManager",null,[349,28,2]);var wa=a(7),ia=a(63);class Ha{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(t.a)(Ha,"OverlayCavityInfo",null,[]);class Sa{constructor(){this.height=this.width=0}}Object(t.a)(Sa,"OverlayContainerInfo",null,[]);class Da{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(t.a)(Da,"PresentModeOverlayProps",null,[]);class ea{constructor(na){this.J_a=
this.pHd=null;this.$=na;this.gridView=Y.h(this.$)}Chi(){this.pHd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.J_a=Array(5);let na,Ba;for(let Oa=1;4>=Oa;Oa++)na=document.createElement("div"),E.DOMElementExtensions.setVisible(na,!1),na.id=`${"PresentModeOverlay"}-${Oa}`,E.DOMElementExtensions.toggleCssClass(na,w.vxh,!0),Ba=this.gridView.Rf(Oa).domElement,Ba.insertBefore(na,Ba.firstChild),this.J_a[Oa]=na})}e$f(na){na&&this.G0j();
for(let Ba=1;4>=Ba;Ba++)this.Pkf(Ba)&&E.DOMElementExtensions.setVisible(this.J_a[Ba],na);E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-overlay",na)}G0j(){const na=this.l0g();let Ba;for(let Oa=1;4>=Oa;Oa++)Ba=Oa,na[Ba]&&this.pHd.showOverlayWithCavity(this.J_a[Ba],na[Ba])}dispose(){this.pHd=this.J_a=this.gridView=this.$=null}l0g(){let na;const Ba=Y.h(this.$).rtl;let Oa;const oa=Array(5);for(let Wb=1;4>=Wb;Wb++)if(na=Wb,this.Pkf(Wb)){var Ja=this.gridView.Rf(Wb);Oa=this.gridView.ha.Sa.G4?
this.iVh(Wb,Ja,Ba):this.bWh(Wb,Ja,Ba);Ja=this.afh(Ja);oa[na]=this.vfh(this.J_a[na].id,Ja,Oa)}return oa}Pkf(na){return this.gridView.ib.qQ(na)}afh(na){return Object(wa.a)(new Sa,{width:na.yn.width,height:na.yn.height})}vfh(na,Ba,Oa){return Object(wa.a)(new Da,{containerId:na,overlayContainerInfo:Ba,overlayCavityInfos:Oa?[Oa]:null})}iVh(na,Ba,Oa){var oa=Y.h(this.$).ha.Sa.dc;if(!oa)return A.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Ja,Wb;if(({hCa:na,rotation:oa,translateX:Ja,translateY:Wb}=oa.extension.lVh(na)).returnValue){const nc=na.x-Ba.yn.x;return Object(wa.a)(new Ha,{left:(Oa?Ba.yn.width-(nc+na.width):nc)-3+1,top:na.y-Ba.yn.y-3+1,width:na.width+5,height:na.height+5,angle:oa,translateX:Ja,translateY:Wb})}return null}bWh(na,Ba,Oa){na=this.gridView.Cb.mwb(this.gridView.ha.qa.activeRange,na)||ia.a.t3;if(!na.De(Ba.yn))return null;const oa=na.x-Ba.yn.x;return Object(wa.a)(new Ha,{left:Oa?Ba.yn.width-(oa+na.width)-2:
oa-3,top:na.y-Ba.yn.y-3,width:na.width+5,height:na.height+5})}}Object(t.a)(ea,"PresentModeOverlayRenderer",null,[348,2]);var sa=a(60);const Ea=(na,Ba,Oa,oa,Ja,Wb,nc=null)=>{nc=na.Na(41,nc);nc.shouldEnablePresentMode=Ba;return sa.g(na,"SetPresentMode",nc,Oa,oa,Ja,Wb,0)};var ba=a(285);class ka extends ba.a{constructor(na,Ba){super(na);this.f8i=()=>{this.Wca.TUd(!0)};this.Wca=Ba;this.domElement.classList.add("ewr-presentMode-on");na={[ka.it]:this.kc};this.Ob=0;this.initializeAndShow("",this.f8i,na)}get kc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
x.a.Av(y.a.l$f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(t.a)(ka,"PresentModeWelcomeDialog",ba.a,[]);class Ca{static get FKh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get GKh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(na){na.webkitRequestFullscreen?na.webkitRequestFullscreen():na.msRequestFullscreen?na.msRequestFullscreen():na.mozRequestFullScreen?na.mozRequestFullScreen():na.requestFullscreen?na.requestFullscreen():A.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():A.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get gpi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(t.a)(Ca,"FullscreenUtils",null,[]);class db{constructor(na){this.xoa=
this.PZe=this.eIb=this.M2a=this.tsc=this.Wca=this.QPa=null;this.Psd=this.LPb=this.DOd=!1;this.ZMb=!0;this.Bhc=!1;this.XUd=!0;this.KPb=this.p1a=this.MFe=0;this.fxc={};this.Xqc={};this.Wqc={};this.gOf=0;this.M7a=this.Ibe=!1;this.jij=()=>{E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-transition",!1);$removeHandler(this.M2a,"transitionend",this.xoa)};this.wj=()=>{parseInt(this.$.eu.style.right,10)!==this.MFe&&window.requestAnimationFrame(()=>{this.IDc(0);this.$.yza(H.a.mZ("PresentModeManager.OnContentAreaResized"))})};
this.d6=()=>{var Ba=Object(z.a)(L.a,this.$.na);if(Ba&&this.jz){this.gridView.aic=!1;Ba=Ba.headersVisible;var Oa=Y.h(this.$).rtl;E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-headers-off",!Ba);E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-rtl",Oa);(12!==this.p1a&&!Ba||32!==this.p1a&&Ba&&!Oa||0!==this.p1a&&Ba&&Oa)&&window.requestAnimationFrame(()=>{this.IDc(2)})}};this.dd=()=>{this.dgf();this.Zg("OnWorkbookOpened");A.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.qr=()=>{this.Psd=!0;this.Aea("OnSelectionStarted")};this.Xg=()=>{this.Psd=!1;this.Aea("OnSelectionEnded");this.T0f()};this.Ri=()=>{this.Aea("OnEditStarted")};this.$f=()=>{this.Aea("OnEditEnded")};this.Dw=()=>{if(!this.Bhc){const Ba=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Aea("OnVisibleAreaChanged",!0,Ba)}};this.BFb=()=>{this.Bhc=!0};this.wn=()=>{this.Aea("OnCurrentSelectionModeChanged");this.T0f();this.Zg("OnCurrentSelectionModeChanged")};this.Sm=
()=>{this.Aea("OnBlockCacheItemEvicted")};this.nf=()=>{this.Aea("OnBlockCacheItemChanged")};this.lF=()=>{this.Bhc||this.Aea("OnActiveItemPanesChanged")};this.ij=()=>{this.Bhc=!1;this.Wca.Zg("ActiveSheetChanged");this.d6()};this.CGb=(Ba,Oa)=>{if(Ba=Object(z.a)(L.a,Oa.item))Ba.Tqb(16,!0),Ba.ZYa(this.d6)};this.jSi=()=>{Ca.gpi||(this.tsc&&this.tsc.Nn&&this.tsc.hide(),Y.h(this.$).fb&&Y.h(this.$).Do(!0),this.Ozc(!1),A.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.kSi=()=>{A.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=na;this.gridView=Y.h(this.$);this.Osj=na.ya.PresentModeRenderUpdateTimeout;this.initialize(na)}get jz(){return this.Ibe}Ozc(na){this.jz!==na&&(this.Ibe=na,this.M7a=this.jz,this.dgf(),this.ZMb=this.P8f(),window.requestAnimationFrame(()=>{E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-transition",!0);$addHandler(this.M2a,"transitionend",this.xoa);
this.fJj(!na);this.J2i();E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on",na);this.eJj(na);B.b(this.$).c$f(this.jz);B.c(this.$).c$f(this.jz);this.$.bAa();this.QPa.e$f(this.ZMb);if(this.jz){this.SZa();x.a.get(y.a.l$f)?this.Wca.TUd(this.jz):this.tsc=new ka(this.$,this.Wca);var Ba=P.b(this.$);Ba&&(this.DOd=Ba.S9c(!1));this.gOf=M.HelperMethods.Kb()}else this.Wca.TUd(na),this.DOd&&(Ba=P.b(this.$))&&(Ba.S9c(!0),this.DOd=!1),this.r7b(),this.jDi()}))}f$f(na,Ba){this.XUd=na;this.Aea(Ba)}Zg(na){this.Wca.Zg(na)}dispose(){this.r7b();
this.QPa&&(this.QPa.dispose(),this.QPa=null);this.gridView=this.$=null}fJj(na){const Ba=this.$.da.Aa(25);void 0===Ba||null===Ba?A.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):na?Ba.Jzc():Ba.Uec()}J2i(){E.DOMElementExtensions.toggleCssClass(document.getElementById(n.AFrameworkApplication.Y2a),C.a.eo,this.jz);E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on",this.jz);this.hJj(this.jz);this.gridView.aic=!this.jz;this.W0j();this.$.da.gb(32,
na=>{na.r1j(this.jz)});G.b(this.$,na=>{na.yjg(this.jz)})}hJj(na){if(this.eIb)if(na){if(na=Object(z.a)(L.a,this.$.na))E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-headers-off",!na.headersVisible),E.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-rtl",Y.h(this.$).rtl);this.IDc(0)}else this.$.Yq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Yq.classList.remove("ewr-presentMode-on-rtl"),this.IDc(1)}IDc(na){var Ba=Object(z.a)(L.a,this.$.na);if(Ba){var Oa=
parseInt(this.$.eu.style.right,10);if(1===na||2===na){if(isNaN(Oa)||Oa<this.p1a)return;Oa-=this.p1a}if(0===na||2===na)na=Ba.headersVisible,Ba=Y.h(this.$).rtl,na=na?Ba?0:32:12,Oa=isNaN(Oa)?na:Oa+na,this.p1a=na;this.$.eu.style.right=M.HelperMethods.sc(Oa);this.MFe=Oa}}W0j(){const na=document.getElementById(this.$.Bb+y.a.S6b).parentNode;E.DOMElementExtensions.toggleCssClass(na,w.xxh,this.jz)}initialize(na){this.QPa=new ea(na);this.QPa.Chi();this.Wca=new ca(na);this.Wca.Sgi();this.M2a=document.getElementById("MainApp");
this.PZe=this.jSi;$addHandler(this.M2a,Ca.FKh,this.PZe);$addHandler(this.M2a,Ca.GKh,this.kSi);this.eIb||(this.eIb=document.createElement("div"),this.eIb.className="ewa-presentMode-right-frame",this.$.tE.appendChild(this.eIb));this.xoa=this.jij}SZa(){this.gridView.ha.v9(this.qr);this.gridView.ha.j2(this.Xg);this.gridView.mc.xl(this.Ri);this.gridView.mc.Jm(this.$f);this.gridView.gE(this.wn);this.gridView.view.Ps(this.Dw);this.gridView.XWc(this.BFb);this.gridView.Ca.xG(this.Sm);this.gridView.Ca.Ns(this.nf);
this.$.va.Vf(this.ij);this.$.va.Pra(this.lF);this.$.va.Kga(this.CGb);this.$.bC(this.wj);this.$.Lk(this.dd);const na=Object(z.a)(N.a,this.$.va);for(const Ba of na.items)Ba.ZYa(this.d6)}r7b(){this.gridView&&(this.gridView.ha.uda(this.qr),this.gridView.ha.S_(this.Xg),this.gridView.mc.nl(this.Ri),this.gridView.mc.$l(this.$f),this.gridView.yF(this.wn),this.gridView.view.Jq(this.Dw),this.gridView.KLd(this.BFb),this.gridView.Ca.YH(this.Sm),this.gridView.Ca.Hq(this.nf));if(this.$){this.$.va.sg(this.ij);this.$.va.Rza(this.lF);
this.$.va.Wma(this.CGb);this.$.xF(this.wj);this.$.pl(this.dd);const na=Object(z.a)(N.a,this.$.va);for(const Ba of na.items)Ba.Tuc(this.d6)}}P8f(){if(!this.jz||!this.M7a)return!1;if(1===this.gridView.ha.Oe){const na=this.$.na.activeRange.isSingle,Ba=1===this.$.na.selectedRanges.length&&!na,Oa=this.gridView.fb,oa=this.Psd;Ba||A.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${na}`);return this.XUd&&Ba&&!Oa&&
!oa}return this.XUd}eJj(na){na?Ca.requestFullscreen(this.M2a):Ca.exitFullscreen()}Aea(na,Ba=!1,Oa=!1){Ba||(this.ZMb=this.P8f());A.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${na}, visibility: ${this.ZMb}, immediateUpdate: ${Oa}`);if(this.LPb&&Oa)A.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.KPb}`),window.cancelAnimationFrame(this.KPb),this.KPb=0;else if(this.LPb){A.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${na}`);return}Oa?this.p0d(M.HelperMethods.Kb(),na):(this.KPb=window.requestAnimationFrame(oa=>{this.p0d(oa,na)}),this.LPb=!0)}p0d(na,Ba){var Oa=M.HelperMethods.Kb();if(Oa-na>this.Osj)this.KPb=window.requestAnimationFrame(Ja=>{this.p0d(Ja,Ba)}),this.LPb=!1,A.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${Oa-na}ms.`);else{this.QPa.e$f(this.ZMb);this.LPb=!1;var oa=
M.HelperMethods.Kb();na=M.HelperMethods.Kb()-na;Oa=oa-Oa;this.Rrj(na,Ba);A.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${Oa}ms. rafTotalDuration = ${na}ms`)}}dgf(){R.a(this.$.userOperationManager,(na,Ba,Oa)=>Ea(this.$.oa.xa,this.jz,na,Ba,Oa,null),na=>new S.a(252,0,na),null)}T0f(){let na=D.a(this.gridView.Oe);1!==this.gridView.Oe||this.$.na.activeRange.isSingle||(na="Range");this.fxc[na]=this.fxc[na]?this.fxc[na]+1:1}Rrj(na,Ba){const Oa=this.Xqc[Ba]?
this.Xqc[Ba]:0;this.Xqc[Ba]=Oa>na?Oa:na;this.Wqc[Ba]=this.Wqc[Ba]?this.Wqc[Ba]+1:1}jDi(){const na={};var Ba=M.HelperMethods.Kb()-this.gOf;na.PresentModeDuration=Ba;na.SelectionCountPerObject=u.a.toJSON(this.fxc);na.OverlayCountPerCaller=u.a.toJSON(this.Wqc);na.OverlayDurationPerCaller=u.a.toJSON(this.Xqc);Ba=this.Wca.z4h();for(let Oa in Ba)na[Oa]=Ba[Oa];U.b(this.$).rd(I.a.d8i,na,void 0,!0)}}Object(t.a)(db,"PresentModeManager",null,[335,2]);var yb=a(204),kb=a(186),mb=a(105),W=a(712);class Q extends r.a{constructor(na){super();
this.$=na;this.Db()}create(){if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void(()=>Object(v.a)(this,void 0,void 0,function*(){yield(yield kb.a.resolve(mb.d,{Tl:this.Xa}))("presentMode");this.nb(Object(W.a)(this.$.da,423,()=>new db(this.$)))}))();else{var na=e.GetServiceTaskFactory.Oa(this.$.da,283,284,1);f.TaskExtensions.za(na,()=>{f.TaskExtensions.za(yb.c(na.result.Hl.loadScript("presentMode")),()=>{let Ba=this.$.da.Aa(423);Ba||(Ba=new db(this.$),this.$.da.Ha(423,
Ba));this.nb(Ba)},this.$.la,3)},this.$.la,3)}}static ka(na){na.da.Ha(424,new Q(na))}}Object(t.a)(Q,"PresentModeManagerFactory",r.a,[]);a.d(F,"a",function(){return va});const va=()=>{c.a.Fa(na=>{Q.ka(na);l.ka(na)})}},1194:function(t,F,a){var c=a(9);t=a(0);var b=a(551),e=a(709),f=a(50),d=a(37),h=a(15),m=a(1263),l=a(4),v=a(167),r=a(767),A=a(99),x=a(268),n=a(652),u=a(27),z=a(160),w=a(181),C=a(288),y=a(5),B=a(152),H=a(103),I=a(68),R=a(77),S=a(374),G=a(192),D=a(56),E=a(60),M=a(327),L=a(592),N=a(1362),Y=
a(422),U=a(320),P=a(13);class aa extends N.a{constructor(Ua,lb){super(Ua,void 0,void 0,lb)}get pOa(){return P.a.instance.Ta(421)}get rlc(){return P.a.instance.Ta(422)}get qlc(){return"DownloadOdsLink"}get eDb(){return"#"}get M8a(){return P.a.instance.Ta(423)}get Lvf(){return!0}yrf(){h.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}Arf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}klc(){Y.Redirect.showHelp(U.a.yMi);
return!0}}Object(t.a)(aa,"DownloadACopyAsOdsDialog",N.a,[]);class X{constructor(Ua,lb){this.dialog=null;this.RBf=()=>{this.dialog&&this.dialog.hide()};this.VMi=Ua;this.qb=lb;this.qb.eob(this.RBf)}Vve(Ua){this.dialog=Ua}P8c(){this.VMi.uKf(-1059172980)}dispose(){this.qb.GJb(this.RBf)}}Object(t.a)(X,"DownloadACopyAsOdsDialogDownloadBehavior",null,[309,2]);const Z=(Ua,lb,sb,V,za,Ra,Xa=null)=>{Xa=Ua.Na(9,Xa);Xa.isReadOnlyRecommended=lb;return E.g(Ua,"SetReadOnlyRecommended",Xa,sb,V,za,Ra,0)},da=(Ua,lb,
sb,V,za,Ra,Xa=null)=>{Xa=Ua.Na(9,Xa);Xa.calc_type=lb;return E.g(Ua,"SetCalculationOptions",Xa,sb,V,za,Ra,0)};class qa{constructor(Ua){this.calculationMode=0;this.calculationMode=Ua}}Object(t.a)(qa,"MacroRecorderWorkbookCalculationModeSetPayload",null,[122]);class O{constructor(Ua){this.calculateType=0;this.calculateType=Ua}}Object(t.a)(O,"MacroRecorderWorkbookRecalculatedPayload",null,[122]);var ca=a(86),wa=a(150),ia=a(180),Ha=a(14),Sa=a(110),Da=a(1);N=a(266);class ea{static get D1i(){return ea.C1i}}
ea.C1i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(t.a)(ea,"OpenInAppDialogCopyHtml",null,[]);var sa=a(156);class Ea extends N.a{constructor(Ua){super(Ua);this.FH=null;this.JFb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.aGc(),!0;u.a.Zo?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.yx&&this.yx.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.yx+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Bm+";end","_top")):9<=u.a.Imd?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.Ula,"_top"),window.setTimeout(()=>{this.openUrl(this.Bm,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.Ula,
"_top"),window.setTimeout(()=>{this.openUrl(this.Bm,"_blank")},500));return!0};this.WOa=lb=>lb.Ea.keyCode===ca.a.Jh||lb.Ea.keyCode===ca.a.Hea?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),lb.Mb.click(),!0):!1;1===l.AFrameworkApplication.ra.Qa.Oj&&(this.yx=this.$.workbookContext.ClientUrl,this.Ula="ms-excel:ofe|u|"+this.yx,this.Bm=l.AFrameworkApplication.fa.Wa("AppUrl"),u.a.I4?this.Bm="itms-apps://"+l.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
u.a.Zo&&(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.ya.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Bm=l.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):u.a.aBb?this.Bm=l.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<u.a.wYc.lOa&&(this.Bm=l.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get kc(){return"OpenInAppDialogCopy"}openUrl(Ua,
lb){let sb=document.getElementById("link");sb||(sb=document.createElement("a"),sb.id="link",sb.style.visibility="hidden",sb.href="",document.body.appendChild(sb));sb.target=lb;sb.href=Ua;sb.click()}aGc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ua=>{let lb={};lb.OpenInAppUrl=this.Ula;lb.StoreUrl=this.Bm;Ua.result.jj("UI_OpenInMobileApp",lb)},this.$.la)}E1i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}ig(){this.og=
wa.a.xq(ea.D1i,P.a.instance.ga(661),P.a.instance.ga(662),l.AFrameworkApplication.RA,sa.getImageClass(l.AFrameworkApplication.fa.Wa("AppIcon")),P.a.instance.ga(663));this.pe="OpenInAppDialog";this.Ob=5;this.initializeAndShow("",this.E1i.bind(this),null);this.iI(this.FH)}qy(Ua){super.qy(Ua);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.FH=document.getElementById("LinkToInstall");ia.a.instance.ta(Ha.a.click,this.FH,this.JFb);Sa.KeyInputManager.instance.ta(Ha.a.Kd,this.FH,
this.WOa)}dispose(){this.FH&&(ia.a.instance.Ba(Ha.a.click,this.FH,this.JFb),Sa.KeyInputManager.instance.Ba(Ha.a.Kd,this.FH,this.WOa),this.FH=null);super.dispose()}}Object(t.a)(Ea,"OpenInAppDialogCopy",N.a,[]);var ba=a(136),ka=a(376);class Ca{constructor(Ua){this.vdi="itms-apps://";this.wdi="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.jqg=lb=>{1==lb&&this.aGc()};this.$=Ua;this.yx=l.AFrameworkApplication.ra.Qa.yx;this.Ula="ms-excel:ofe|u|"+this.yx;this.Bm=l.AFrameworkApplication.fa.Wa("AppUrl");
u.a.I4||u.a.Hg?this.Bm=this.vdi+this.wdi:u.a.Zo&&(l.AFrameworkApplication.fa.pa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Bm=l.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):u.a.aBb?this.Bm=l.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<u.a.wYc.lOa&&(this.Bm=l.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}aGc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ua=>{let lb={};lb[ka.a.AKf]=this.Ula;lb[ka.a.Bm]=this.Bm;Ua.result.jj("UI_OpenInMobileApp",lb)},this.$.la)}ig(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ua=new ba.StandardDialog;Ua.Ob=0;Ua.tc(1,P.a.instance.ga(667));Ua.Wl(P.a.instance.ga(665),P.a.instance.ga(666),0,this.jqg)}}Object(t.a)(Ca,"OpenInAppDialogReact",null,[]);N=a(285);class db extends N.a{constructor(Ua){super(Ua);
this.sessionId=Ua.ya.UserSessionId;this.FYg=Ua.ya.BuildVersion}get kc(){return"WACSessionIdDialog"}EM(){return{[db.kwj]:P.a.instance.ga(668),[db.lwj]:this.sessionId,[db.id]:"WACSessionIdDialog",[db.X_c]:P.a.instance.ga(669),[db.buildVersion]:this.FYg}}ig(){const Ua=this.EM();this.Ob=5;this.initializeAndShow(P.a.instance.ga(1024),this.A5j.bind(this),Ua)}A5j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}db.id="id";db.kwj="sessionIdLabel";db.lwj="sessionIdValue";db.X_c=
"buildLabel";db.buildVersion="buildVersion";Object(t.a)(db,"WACSessionIdDialog",N.a,[]);var yb=a(28),kb=a(29),mb=a(358),W=a(11),Q=a(188),va=a(282),na=a(21),Ba=a(45),Oa=a(254),oa=a(381),Ja=a(290),Wb=a(52),nc=a(6),Yb=a(147),pb=a(989),Fa=a(82),ab=a(36),Gb=a(303),Ga=a(257);class Ma{iQ(Ua,lb){Ua=kb.a.ed(12,1,670,0,0,0,"Blank");Ua.Description=String.format(P.a.instance.ga(671),lb);return Ua}dbc(Ua){switch(Ua){case 1:case 2:return 0;default:return 2}}}Object(t.a)(Ma,"ReloadCloseConfirmation",null,[102]);
var Qa=a(154),wb=a(593),Na=a(73),ya=a(55),nb=a(379),vb=a(33);class gb extends w.a{constructor(Ua,lb,sb,V){super();this.$=Ua;this.businessBar=V;this.openInExcelOperation=lb;this.KJ=sb}get Xb(){return this.$.ea.Xb}get workbookContext(){return this.$.workbookContext}get i8b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return Na.a(this.$)}get $b(){return this.$.$b}rbi(){var Ua,lb;return null!==(lb=null===(Ua=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===Ua?
void 0:Ua.LoadBlockType)&&void 0!==lb?lb:!1}Hc(){return!1}executeCommand(Ua,lb,sb,V){const za=this.i8b,Ra=this.$,Xa=lb.command,$a=this.openInExcelOperation,ma=this.$.Bb,fa=sb.SourceControlId;Ra.Uk.ope(Xa);$a.vyc(lb.startTime.getTime().toString());Ua=null;switch(Xa){case 1455037301:this.$.X4?$a.WFe():$a.v4c();break;case -2044628748:case 2004484710:this.$.X4?$a.WFe():$a.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===fa?(this.FDb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.FDb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const eb=Na.a(this.$).gd.activityState;Ba.a(Ra).tr(new Oa.a(nc.a.ew,5,()=>{eb[Ga.a.Bp]=nc.a.Ei}));break;case 480922297:Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new db(this.$)).ig();break;case -2028960985:$a.Wag();break;case -1059172980:new aa($a.Cye(Xa),new X($a,Ra.qb));break;case -1285148982:this.clientWorkflow.gd.activityState[ab.a.ZVc]=!0;this.KCc(!1);break;case -75280711:this.KCc(!1);break;case -455164169:this.KCc(!0);break;case -1388494670:this.$.da.gb(400,hb=>{hb.jGi();this.KCc(!1)});break;case 810888577:l.AFrameworkApplication.qk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${l.AFrameworkApplication.qk}`);
break;case -1804063550:case -974518828:lb=0;y.a.REd in sb&&(lb=sb[y.a.REd]);$a.uKf(Xa,lb);break;case -1339961039:lb=!1;sb&&y.a.IKb in sb&&(lb=sb[y.a.IKb]);this.reloadWorkbook(!1,lb);break;case -8805455:const ua=this.workbookContext;if(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.rbi()&&vb.a.Ad(this.$)){const hb=f.GetServiceTaskFactory.Oa(this.$.da,522,523,0);d.TaskExtensions.za(hb,()=>{hb.result.XK()},this.$.la,3)}else Ra.isEditMode||(gb.rDe(Ra),
Ua=d.TaskExtensions.za(this.KJ.value,hb=>{hb=hb.result;var ib=hb.isEnabled();ib&&L.a(hb,v.a.copyAndEdit,D.a.pg.H1e(),this.$.ea.wg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):ib&&l.AFrameworkApplication.clg?(ib={},ib[m.a.PHd]=l.AFrameworkApplication.userSessionId,ib[l.AFrameworkApplication.AIi]=yb.a.Ya.Ub.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
hb.jj(v.a.editMode,ib)):za.CopyAndEditUrl?this.Z$g():(this.$b.supportsEditing||ua.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Ra.isEditMode&&(gb.rDe(Ra),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const xa=Ra.oa.xa.Wb(),tb=-1355155015===Xa?1:0,Qb=()=>new O(tb);Ua=S.a(this.$.userOperationManager,(hb,ib,Vb)=>E.y(Ra.oa.xa,tb,null,hb,ib,Vb,null,xa),hb=>new G.a(128,0,hb,void 0,Qb),lb);na.h(Ra).Gg.dM(!1);break;case -1158102843:Ua=na.h(Ra).Gg.recalcSheet(lb);
na.h(Ra).Gg.dM(!1);break;case -988468372:if(Da.EwaSettings.sa(269))if(V=parseInt(sb[I.a.Kc],10),0<=V&&3>V)this.setCalculationMode(lb,V);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${sb[I.a.Kc]}`),Q.a(Xa);break;case 257398710:B.a.ntw(za.ReportAbuseUrl,Ra);break;case 1800405051:this.Nrj();break;case -48469327:this.saveACopy();break;case 214430355:lb=!1;sb&&y.a.u9c in sb&&(lb=sb[y.a.u9c]);if(!this.FFj(lb,sb))break;l.AFrameworkApplication.O4?this.businessBar.ih(42,
null):this.businessBar.ih(lb?22:23,null);break;case 1389557314:Ua=d.TaskExtensions.za(this.KJ.value,hb=>{L.a(hb.result,v.a.VFh,null,this.$.ea.wg.get(6))||B.a.ntw(za.FileVersionUrl,Ra)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:fa===ma+y.a.nof?$a.Oyi():$a.Nyi();break;case 512141517:fa===ma+y.a.mof?$a.Wyi():$a.Vyi();break;case -1224038235:const pc=r.a.On in sb?!sb[r.a.On]:H.j(Ra.ea.workbookContext.Options);sb[r.a.Description]=pc?P.a.instance.ga(570):P.a.instance.ga(571);
Ua=S.a(this.$.userOperationManager,(hb,ib,Vb)=>Z(this.$.oa.xa,!pc,hb,ib,Vb,null),hb=>new G.a(129,0,hb),lb);break;case 1118926154:if(this.$.isEditMode){const hb=new z.a;this.$.da.gb(53,ib=>{ib?(ib.lp.Gyi(this.$.Bb+y.a.qud),hb.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ua=hb.task}break;case -1698025133:$a.openInBrowser();break;case 520859864:Ua=d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,393,394,V.Y3()),
hb=>{hb.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Ua=Q.a(Xa)}return Ua||ya.Task.Ra(!0)}FDb(Ua){if(W.HelperMethods.OZ){const lb=new Map;lb.set("EntryPoint",Ua);A.Health.instance.recordKpiUsage(Ja.a.B1i,0,oa.a.nIi,lb)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){l.AFrameworkApplication.isMobileMode&&
(this.$.ya.IsMeetingLiveSession&&Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7492428_OpenInAppExcelReactDialogChangegate")?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new Ca(this.$)).ig()):Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Ea(this.$)).ig()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),l.AFrameworkApplication.showOpenInAppDialog()))}FFj(Ua,lb){return l.AFrameworkApplication.isMobileMode&&!R.a(this.$.ya,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.FDb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):l.AFrameworkApplication.zic&&(Ua&&mb.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${mb.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):x.a.any([25,26,30,31,57,32,34],sb=>this.businessBar.Eka(sb))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):lb&&y.a.P9i in lb&&!Ua?!1:!0}wc(Ua,lb){Ua=!1;switch(lb.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ua=
!0;break;case 480922297:case 520859864:Ua=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ua=nb.a.Yqd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ua=Da.EwaSettings.sa(106);break;case -1388494670:Ua=Da.EwaSettings.sa(106);break;case 810888577:Ua=Da.EwaSettings.sa(243);break;case -1224038235:Ua=this.$.ea.amIAlone;break;case -988468372:Ua=Da.EwaSettings.sa(269);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ua=
!0,h.ULS.shipAssertTag(537162642,0,this.$.Bka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ua}Mc(){return!1}Nrj(){if(this.Xb){var Ua=this.$;Ba.a(Ua).tr(new Oa.a(nc.a.ew,5,()=>{Ua.VH(!1,!0);const lb=this.clientWorkflow.gd.activityState;lb[Ga.a.Bp]=nc.a.Hda;lb[Yb.a.dT]=2;lb[ab.a.Jr]=Ua.isEditMode;lb[Yb.a.Aga]=!1}))}}saveACopy(){if(this.Xb){var Ua=this.$;Ba.a(Ua).tr(new Oa.a(nc.a.ew,5,()=>{Ua.VH(!1,!1);const lb=this.clientWorkflow.gd,sb=lb.activityState;
sb[Ga.a.Bp]=nc.a.v0f;sb[wb.a.RZb]=this.$b.hasUnsupportedFeaturesForEdit;sb[Yb.a.Aga]=!1;lb.Wq(kb.a.D3(this.businessBar.L9c,[-502303485]))}))}}KCc(Ua){Ba.a(this.$).tr(new Oa.a(nc.a.xna,2,()=>{this.$.VH(!0,!0);var lb=Na.a(this.$).gd,sb=this.$.isEditMode;sb=kb.a.ed(1,1,0,0,0,sb?-315732528:-2087635043,sb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");sb.ForceVersionUpgrade=Ua;lb.Wq([sb]);lb=Na.a(this.$).gd.activityState;lb[Ga.a.Bp]=nc.a.xna;lb[ab.a.Jr]=this.$.isEditMode;lb[Yb.a.Aga]=!1}))}closeWorkbook(){if(this.Xb){var Ua=
this.$;D.a.pg.$yc("2145659238")?d.TaskExtensions.za(this.KJ.value,lb=>{lb.result.jj(v.a.dXe,{})},this.la,3):Ba.a(Ua).tr(new Oa.a(nc.a.ew,5,()=>{Ua.VH(!0,!1);const lb=this.clientWorkflow.gd.activityState;lb[Yb.a.YX]=!1;lb[Yb.a.Aga]=!1;this.$b.inViewerFromWebPart?(M.a.FId(Ua,this.clientWorkflow.gd),Ua.Uk.Ky("InViewerFromWebPart"),lb[Ga.a.Bp]=nc.a.m_):(lb[Ga.a.Bp]=nc.a.Kj,Ua.qd&32?lb[Yb.a.dT]=0:(lb[Yb.a.dT]=1,lb[Yb.a.GZb]=new pb.a),lb[Qa.a.Kne]=!0)}))}}Z$g(){const Ua=this.$b.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ua}`);const lb=this.$;Ua?Ba.a(lb).tr(new Oa.a(nc.a.ew,5,()=>{const sb=kb.a.ed(3,0,0,1263,0,1069271157,"XLSMacroFailure");this.clientWorkflow.gd.Wq([sb]);this.clientWorkflow.gd.activityState[Ga.a.Bp]=nc.a.Hfb})):l.AFrameworkApplication.hideHeader?W.HelperMethods.gf(this.i8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):B.a.ntw(this.i8b.CopyAndEditUrl,lb)}reloadWorkbookInEditMode(){if(this.Xb)if(D.a.pg.gV&&
D.a.pg.oKd(),l.AFrameworkApplication.zic&&!l.AFrameworkApplication.Hba)W.HelperMethods.gf(this.$.hqb(!0),C.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ua=this.$,lb=!1,sb=this.$b.hasUnsupportedFeaturesForEdit,V=this.workbookContext.FileWasRepaired;mb.d(this.workbookContext.WorkbookFileName)?(lb=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${sb}`)):mb.a(this.workbookContext.WorkbookFileName)&&
(lb=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var za=Ua.Xd.get(59);za=!(Ua.ea.$b.supportsEditing&&za);if(lb&&!sb||za&&(lb||sb)){let Ra;Ra=za?sb?-2066104278:816071846:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&R.a(this.$.ya,25)&&!this.$.KBb?765011943:-213064907;lb=()=>{const Xa=kb.a.x_a([Ra]);this.clientWorkflow.gd.Wq(Xa);this.clientWorkflow.gd.activityState[Ga.a.Bp]=nc.a.Hfb}}else lb=()=>
{Ua.VH(!0,!1);var Ra=this.clientWorkflow.gd;const Xa=Ra.activityState;Xa[Yb.a.dT]=1;Xa[Gb.a.LZb]=n.a.enc;Xa[ab.a.Jr]=!0;Xa[wb.a.RZb]=this.$b.hasUnsupportedFeaturesForEdit;Xa[Yb.a.Aga]=!!this.workbookContext.EditUrl;Xa[Fa.a.X1]=this.workbookContext.EditUrl;if(!this.i8b.CopyAndEditUrl){const $a=[Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&R.a(this.$.ya,25)&&!this.$.KBb?-943219229:1821390342];Ra.Wq(kb.a.D3(this.businessBar.L9c,$a))}V&&!sb?(mb.b(this.workbookContext.WorkbookFileName)&&
Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Ra=kb.a.x_a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Ra=kb.a.x_a([108482388]),this.clientWorkflow.gd.Wq(Ra),Xa[Ga.a.Bp]=nc.a.J0f):this.$.ea.abf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Wb.b().xWd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),Xa[Ga.a.Bp]=nc.a.xHb):Xa[Ga.a.Bp]=this.$.ea.kic?nc.a.iDb:nc.a.Hfb};Ba.a(Ua).tr(new Oa.a(nc.a.ew,5,lb))}}reloadWorkbookInViewMode(){if(this.Xb){D.a.pg.gV&&D.a.pg.oKd();var Ua=this.$;u.a.Hg&&na.h(Ua).Vb.textBox.blur();Ba.a(Ua).tr(new Oa.a(nc.a.ew,5,()=>{Ua.VH(!Ua.ea.isNamedObjectViewMode,!1);const lb=this.clientWorkflow.gd.activityState;lb[Ga.a.Bp]=nc.a.Dha;lb[Yb.a.dT]=1;lb[Yb.a.YX]=!0;lb[ab.a.Jr]=!1;lb[ab.a.Cnb]=!0;lb[Gb.a.LZb]=n.a.enc}))}}reloadWorkbook(Ua,lb){if(this.Xb){var sb=
this.$;sb.xU&65536&&Ba.a(sb).tr(new Oa.a(nc.a.ew,5,()=>{sb.VH(Ua,!0);const V=this.clientWorkflow.gd.activityState;V[Ga.a.Bp]=nc.a.Ry;V[ab.a.bWc]=this.workbookContext.NovMode;lb||(V[Yb.a.dT]=1,V[Yb.a.GZb]=new Ma)}))}}setCalculationMode(Ua,lb){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${lb} `);const sb=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=lb;const V=()=>new qa(lb);return S.a(this.$.userOperationManager,(za,Ra,Xa)=>da(this.$.oa.xa,
lb,va.b(za,gb.sZi(this.$,sb)),va.a(Ra,gb.rZi(this.$,sb)),Xa,null),za=>new G.a(197,0,za,void 0,V),Ua)}static rDe(Ua){Ua.qb&&0<Ua.qb.gR&&Ua.qb.nbd(lb=>{lb.dv()})}static sZi(Ua,lb){return sb=>{kb.a.Wf(sb.Errors)&&(Ua.ea.workbookContext.CalcMode=lb,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${lb}.  Error id names: ${kb.a.nc(sb.Errors)}`))}}static rZi(Ua,lb){return()=>{Ua.ea.workbookContext.CalcMode=lb;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${lb})`)}}}Object(t.a)(gb,"FileOperationsCommandHandler",w.a,[221]);var cb=a(158);class La extends e.a{constructor(Ua){super(Ua)}hd(){const Ua=this.$,lb=[],sb=f.GetServiceTaskFactory.create(Ua.da,56,this.la,this.Xa);lb.push(sb);const V=f.GetServiceTaskFactory.Oa(Ua.da,5,4,this.Xa);lb.push(V);d.TaskExtensions.za(ya.Task.ZF(...lb),()=>{cb.b(sb)&&this.$c([new gb(Ua,sb.result,new b.a(()=>f.GetServiceTaskFactory.create(Ua.da,
137,this.la,this.Xa)),V.result)])},this.la,0)}static ka(Ua){e.a.Ld(94,new La(Ua))}}Object(t.a)(La,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(F,"a",function(){return ja});const ja=()=>{c.a.Fa(La.ka)}},1195:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(8),f=a(19),d=a(67),h=a(63),m=a(5),l=a(31);class v{}v.Wxh="ewa-resizehdr-row-hidden";v.Vxh="ewa-resizehdr-col-hidden";Object(t.a)(v,"CssClassNames",null,[]);var r=a(241),A=a(14),x=a(159),n=a(637),u=a(27),z=a(227),w=a(4),C=a(268),y=a(15),B=
a(68),H=a(127),I=a(41),R=a(140),S=a(24),G=a(51),D=a(12),E=a(74),M=a(1),L=a(96),N=a(11),Y=a(13),U=a(255),P=a(128),aa=a(375),X=a(45),Z=a(34);class da{constructor(Ga,Ma,Qa,wb,Na,ya,nb){this.Wva=Ga;this.yEb=Ma;this.GOa=Qa;this.Cld=wb;this.Kcb=Na;this.gnf=ya;this.Hai=nb}}Object(t.a)(da,"HeaderEventCachedInfo",null,[]);class qa{constructor(Ga){this.m9c=Ga}mGe(Ga){Ga=N.HelperMethods.pGd(Ga);return Math.max(0,Math.min(qa.ivf,Ga))}cGe(Ga){return this.t5i(Ga)}x6g(Ga){return Math.round(this.m9c*Ga+2*this.p2e()+
1)}t5i(Ga){return Math.max(0,Math.min(qa.Ouf,(Math.max(0,Math.min(e.a.Fmc,Ga))-2*this.p2e()-1)/this.m9c))}p2e(){return Math.floor(Math.max((this.m9c+3)/4,2))}Fcc(Ga,Ma){return Ma?Ga?qa.ivf:e.a.Lyd:Ga?qa.Ouf:e.a.Fmc}}qa.ivf=409;qa.Ouf=255;Object(t.a)(qa,"ResizeHeadersConverter",null,[]);var O=a(182);class ca extends L.a{constructor(Ga,Ma){super(Ma.domElement);this.BX=this.vZf=!1;this.Zh=this.s8a=this.bBa=null;this.ENd=!0;this.njc=!1;this.iLb=this.gl=this.offset=0;this.LM=this.xR=this.y0=null;this.Kbi=
"headerResizeTooltip";this.TF=this.Wwd=null;this.SZc=this.CX=this.dAa=!1;this.UKf=this.Z$a=e.a.swa;this.Fgf=M.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.JQb=!1;this.sN=Qa=>{if(this.grid.sj)return!1;Qa=Z.a(this.grid.$).me(Qa);if(3===Qa.ub&&!this.hnf(Qa.Ea)||!this.SNf(Qa,!1))return!1;y.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const wb=this.Szc();this.yed(Qa.clientPoint,wb,!0);this.dAa||(r.a.instance.ta(A.a.yj,this.domElement.ownerDocument.body,
this.l$a),x.a.instance.ta(A.a.Tf,this.domElement.ownerDocument.body,this.l$a),this.dAa=!0);this.Zif()&&this.BX&&this.Ddf(Qa);return!1};this.PFb=Qa=>{Qa=Z.a(this.grid.$).me(Qa);this.Zif()&&this.SZc&&this.Ddf(Qa);if(!Qa.Ea.type.includes("touch")&&Qa.Ea.button!==Sys.UI.MouseButton.leftButton||!this.EBb)return!1;E.g(Qa.Ea);this.EPe();Qa=this.grid.sj?this.Z$a:e.a.swa;var wb=!1;if(this.grid.sj&&this.Zh){var Na=Qa!==this.gl||!this.Fgf&&this.CX;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!Na&&this.JQb&&(this.fe.removeRowColFromModel(this.Zh.gnb,this.Zh.sUf),wb=!0,M.EwaSettings.tm()&&(this.fe.G7(this.grid.ha.qa.selectedRanges),this.fe.Um("HeaderResizeBehavior::onDocumentMouseUp")))}else this.Zh&&(Qa=this.CX?this.$fd():this.Zh.V3()),Na=Qa!==this.gl;this.bBa&&Na&&Qa!==e.a.swa?(Qa=this.grid,wb=this.pid(Qa),Na={},Na.SheetMultiRange=I.r(wb,Qa.$),ca.aSd(Na,this.isRow,this.gl),M.EwaSettings.Qod()&&this.grid.sj&&(wb=Na.SheetMultiRange.Ranges[0],y.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.Zh?
this.Zh.gnb:-1}, isResizingHiddenHeader=${this.CX}, headerViewBlockHashCode=${this.fe.hashCode},
          rangeFirstRow=${wb.FirstRow}, rangeFirstColumn=${wb.FirstColumn}, rangeLastRow=${wb.LastRow}, rangeLastColumn=${wb.LastColumn},`)),this.jsh(Na),Qa.PPj=!0):(!M.EwaSettings.tm()&&wb&&(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.fe.G7(this.grid.ha.qa.selectedRanges),this.fe.Um("HeaderResizeBehavior::onDocumentMouseUp")),this.Xg(null,null),this.vJb());return this.JQb=this.CX=!1};this.vca=Qa=>{if(this.grid.sj)return!1;Qa=n.a.create(Qa.eventName,
Qa.Mb,Qa.Ea,Qa.ub);Qa=Z.a(this.grid.$).me(Qa);if(!this.SNf(Qa,!0))return!1;Qa=this.grid;var wb=this.pid(Qa);wb=I.r(wb,Qa.$);Qa.Cb.Nj([this.isRow?13:14]);Qa.Cb.DSa();this.vJb();Qa.$.Zc(this.isRow?146338636:1391094586,B.a.zb,30,{["autoFitRanges"]:wb});return!1};this.VDf=Qa=>{this.BX?(this.CX&&!this.JQb&&(this.YIg(),M.EwaSettings.tm()&&this.fe.Um("HeaderResizeBehavior::onHeaderResizeChanged")),this.njc||this.Pef(),Qa=new Sys.UI.DomEvent(Qa),Qa=n.a.create(A.a.fha,this.domElement,Qa,2),Qa=Z.a(this.grid.$).me(Qa),
this.kDd(Qa.clientPoint)):y.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Zh?this.Zh.gnb:-1}, isRow = ${this.isRow}`)};this.WDf=Qa=>{Qa=new Sys.UI.DomEvent(Qa);Qa=n.a.create(A.a.fha,this.domElement,Qa,2);this.PFb(Qa)};this.qUi=Qa=>{this.Dya(Qa,this.Zh,!1)};this.l$a=Qa=>{Qa=Z.a(this.grid.$).me(Qa);E.g(Qa.Ea);return this.kDd(Qa.clientPoint)};this.QH=Qa=>{if(this.grid.sj)return!1;Qa=Z.a(this.grid.$).me(Qa);let wb;
if((M.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?!this.grid.isResizeAllowed(this.isRow):!this.isResizeAllowed)||-1!==this.grid.ha.selectionType)return X.a(this.grid.$).ap()&&(wb=this.Pgd(Qa))&&(wb.Wva.style.cursor=""),!1;if(this.BX)return this.Pef(),!1;wb=this.Pgd(Qa);if(!wb)return!1;wb.Wva.style.cursor=!this.grid.fb&&this.dud(wb)?this.isRow?"row-resize":"col-resize":"";E.g(Qa.Ea);return!0};this.qr=()=>{this.vJb()};this.Xg=()=>{if((3===B.a.zb||u.a.cp)&&this.grid.ha.qa.Tg){var Qa=
this.grid.ha.qa.ld;if(!(!Qa.isRow&&!Qa.Rg||!this.domElement||Qa.isRow&&this.isRow&&!this.fe.qt.includes(Qa.top)||Qa.Rg&&!this.isRow&&!this.fe.qt.includes(Qa.left))){var wb=this.grid.xg(Qa,this.fe.aj.paneType);if(wb){if(this.grid.sj){const Na=this.isRow?Qa.bottom:Qa.right;this.Zh=this.fe.Vr(S.Range.Pc(Qa.bottom,Qa.right));if(!this.Zh){y.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Na}, is row ${this.isRow}`);
return}}this.TF||this.vhh();Qa.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.TF,!0),this.TF.style.top=wb.bottomRight.y-this.TF.offsetHeight/2+"px"):Qa.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.TF,!0),U.c(this.TF.style,this.grid.rtl,wb.bottomRight.x-this.TF.offsetWidth/2+"px"))}}}};this.nF=(Qa,wb)=>{M.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&y.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${wb.HL}`);
wb.HL&&this.Lqb()};this.fe=Ma;this.isRow=Ma.isRow;this.rtl=Ma.aj.rtl;this.grid=Ga;this.Ruf=this.isRow?e.a.Lyd:e.a.Fmc;this.Fbi=Y.a.instance.ga(435);this.Obi=Y.a.instance.ga(434);this.Ibi=Y.a.instance.ga(436);P.a(this.grid.$,Qa=>{this.Wwd=Qa.HP(H.a.Poj,!1)});this.cfj();this.grid.ha.lT(this.Xg);this.grid.ha.v9(this.qr);this.grid.Uu(this.Xg);X.a(this.grid.$).Sf.u9(this.nF)}get EBb(){return this.BX}get isResizeAllowed(){const Ga=(new R.a(this.grid.$.va)).Pd(this.isRow?16:8),Ma=this.grid.$.qb.tv,Qa=this.grid.Uh,
wb=X.a(this.grid.$).ap();return Ga&&!Ma&&!Qa&&!wb}get Roj(){this.Tsh();return ca.Lcb}Dya(Ga,Ma,Qa){var wb=new Sys.UI.DomEvent(Ga);wb=n.a.create(A.a.fha,this.domElement,wb,2);wb=Z.a(this.grid.$).me(wb);this.RNf(Ma,wb.clientPoint.x,wb.clientPoint.y,!1,Qa,Ga);Ga=this.Szc();this.yed(this.bBa,Ga,!0);this.dAa||(Ga=this.domElement.ownerDocument.body,Ga.addEventListener(A.a.fha,this.VDf),Ga.addEventListener(A.a.SGa,this.WDf),this.dAa=!0)}oUi(Ga,Ma,Qa){this.RNf(Ma,Ga.clientX,Ga.clientY,!0,this.Fgf?Qa:!1,Ga);
Ga=this.grid;Ma=this.pid(Ga);Ma=I.r(Ma,Ga.$);Ga.Cb.Nj([this.isRow?13:14]);Ga.Cb.DSa();this.vJb();Ga.$.Zc(this.isRow?146338636:1391094586,B.a.zb,30,{["autoFitRanges"]:Ma})}dispose(){this.t2c();this.grid.ha&&(this.grid.ha.tR(this.Xg),this.grid.ha.uda(this.qr));this.grid.jy(this.Xg);X.a(this.grid.$)&&X.a(this.grid.$).Sf.sda(this.nF);z.a.instance.Ba(A.a.tk,this.domElement,this.vca);r.a.instance.Ba(A.a.Kf,this.domElement.ownerDocument.body,this.PFb);x.a.instance.Ba(A.a.ve,this.domElement.ownerDocument.body,
this.PFb);u.a.cp||(r.a.instance.Ba(A.a.pointerDown,this.domElement,this.sN),r.a.instance.Ba(A.a.yj,this.domElement,this.QH));this.dAa&&(r.a.instance.Ba(A.a.yj,this.domElement.ownerDocument.body,this.l$a),x.a.instance.Ba(A.a.Tf,this.domElement.ownerDocument.body,this.l$a),this.dAa=!1);this.TF&&(r.a.instance.Ba(A.a.pointerDown,this.TF,this.sN),z.a.instance.Ba(A.a.tk,this.TF,this.vca),this.t2c(),this.TF=null);this.vZf&&(D.DOMElementExtensions.vf(ca.Lcb),ca.Lcb=null);this.fe=null;super.dispose()}cfj(){z.a.instance.ta(A.a.tk,
this.domElement,this.vca);r.a.instance.ta(A.a.Kf,this.domElement.ownerDocument.body,this.PFb);x.a.instance.ta(A.a.ve,this.domElement.ownerDocument.body,this.PFb);u.a.cp||(r.a.instance.ta(A.a.pointerDown,this.domElement,this.sN),r.a.instance.ta(A.a.yj,this.domElement,this.QH))}Tsh(){if(!ca.Lcb){document.getElementById(ca.uZf);this.vZf=!0;var Ga=ca.Lcb=document.createElement("div");this.grid.$.frame.Laa().appendChild(Ga);Ga.id=ca.uZf;Ga.className=l.a.Xxh;D.DOMElementExtensions.setVisible(Ga,!1)}}EPe(){if(this.dAa){const Ga=
this.domElement.ownerDocument.body;this.grid.sj?(Ga.removeEventListener(A.a.fha,this.VDf),Ga.removeEventListener(A.a.SGa,this.WDf)):(r.a.instance.Ba(A.a.yj,Ga,this.l$a),x.a.instance.Ba(A.a.Tf,Ga,this.l$a));this.dAa=!1}this.BX=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.qVf():(this.YZf(),this.DLd());aa.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}YZf(){this.grid.Cb.Nj([this.isRow?13:14]);this.grid.Cb.DSa()}YIg(){this.fe.addRowColToModel(this.Zh.gnb-
1,this.Zh.sUf);this.JQb=!0}kDd(Ga){if(!this.BX)return!1;const Ma=this.isRow;if(!this.grid.sj&&!this.y0){this.y0=document.createElement("div");this.y0.style.cssText="position: relative; width: inherit; height: inherit;"+(Ma?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Qa=this.Zh.JJ();Qa.nextSibling;)this.y0.appendChild(Qa.nextSibling);Qa.parentNode.appendChild(this.y0)}Qa=Ma?Ga.y-this.s8a.y:(this.rtl?-1:1)*(Ga.x-this.s8a.x);const wb=Ma?Ga.y-this.bBa.y:(this.rtl?-1:1)*(Ga.x-this.bBa.x),
Na=this.grid.sj?this.Z$a:this.Zh.V3();if(Na===e.a.swa)return!1;Qa&&(0<this.gl||0<Na+wb)&&Na+wb<=this.Ruf&&(this.gl=this.Szc(wb),this.yed(Ga,this.gl,!1),this.grid.sj?this.gl>=ca.wbf?(this.ENd=!0,this.Zh.setCellExtent(this.gl)):this.ENd&&(this.ENd=!1,this.Zh.setCellExtent(ca.wbf)):(D.DOMElementExtensions.Hoa(this.Zh.JJ(),!Ma,Math.max(this.iLb+wb,0)),this.y0.style[Ma?"top":this.rtl?"right":"left"]=Math.max(wb,-this.iLb)+"px"),Qa=(this.grid.sj?this.UKf:Ma?this.Zh.fe.eC:this.Zh.fe.gC)+Math.max(wb,this.grid.sj?
-this.Z$a+ca.Udc:-this.iLb),D.DOMElementExtensions.Hoa(this.Zh.fe.domElement,!Ma,Qa),this.grid.sj&&this.Zh.fe.Rwj(Qa),this.s8a=new Sys.UI.Point(Ga.x,Ga.y),D.DOMElementExtensions.setVisible(this.TF,!1));return!0}V3(){return this.Zh?this.CX?ca.Vbi:this.Zh.V3():e.a.swa}yed(Ga,Ma,Qa){this.LM&&Qa&&(y.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.DLd());this.LM||Qa||y.ULS.sendTraceTag(537154050,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Wwd&&this.Wwd(()=>({["Location"]:"canvas"}));this.LM?this.I_e(Ma):(this.LM=document.createElement("div"),this.LM.id=this.Kbi,this.I_e(Ma),this.LM.className=l.a.Awh,Ma=document.getElementById(this.grid.$.Bb+m.a.Cwf),Ma.insertBefore(this.LM,Ma.firstChild),Ga=Z.a(this.grid.$).Ija(Ga),this.LM.style.left=(this.rtl?Math.max(Ga.x-this.LM.offsetWidth,0):Ga.x-Math.max(Ga.x+this.LM.offsetWidth-
Ma.offsetWidth,0)).toString()+"px",Ma=document.getElementById(m.a.bsa),this.LM.style.top=(Ga.y-(w.AFrameworkApplication.ra&&w.AFrameworkApplication.ra.Qa.Qe?0:Ma.offsetHeight)-this.LM.offsetHeight).toString()+"px")}DLd(){D.DOMElementExtensions.vf(this.LM);this.LM=null}I_e(Ga){var Ma=new qa(this.grid.$.workbookContext.DxDigitNormal);Ma=this.isRow?Ma.mGe(Ga).toFixed(2):Ma.cGe(Ga).toFixed(2);this.LM.innerText=`${this.isRow?this.Fbi:this.Obi} ${Ma} (${Ga.toString()} ${this.Ibi})`}SNf(Ga,Ma){let Qa;const wb=
M.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?this.grid.isResizeAllowed(this.isRow):this.isResizeAllowed;if(-1!==this.grid.ha.selectionType||2===Ga.ub&&Ga.Ea.button!==Sys.UI.MouseButton.leftButton||!this.dud(Qa=this.Pgd(Ga))||!wb)return!1;E.g(Ga.Ea);this.bBa=this.s8a=new Sys.UI.Point(Ga.clientPoint.x,Ga.clientPoint.y);this.G_g(Qa,Ma);if(!this.Zh)return!1;this.BX=!0;this.Tsi(this.Zh,Qa)&&this.Kfi();this.iLb=this.$fd();return this.TNf(Ga.Ea.rawEvent,Ma)}RNf(Ga,Ma,Qa,wb,Na,ya){this.BX=
!0;this.CX=Na;this.Zh=Ga;this.njc=!1;this.bBa=this.s8a=new Sys.UI.Point(Ma,Qa);Ga=this.Zh.getRange();this.xR=Na?this.ose(Ga):Ga;this.Z$a=this.V3();this.UKf=this.isRow?this.Zh.fe.eC:this.Zh.fe.gC;this.TNf(ya,wb)}TNf(Ga,Ma){const Qa=M.EwaSettings.Qod()&&this.grid.sj?{["IsResizingHiddenHeader"]:this.CX,["IsAutoFitting"]:Ma,["NumberOfSelectedRanges"]:this.grid.ha.qa.dD,["Location"]:"canvas",["ResizeRange"]:this.xR,["ResizedCellAbsoluteIndex"]:this.Zh.gnb,["HeaderViewBlockHashCode"]:this.fe.hashCode}:
{["IsResizingHiddenHeader"]:this.CX,["IsAutoFitting"]:Ma,["NumberOfSelectedRanges"]:this.grid.ha.qa.dD,["Location"]:"canvas"};P.b(this.grid.$).rd(H.a.Goj,Qa);this.grid.SGj&&(Ma=Ma?"header_resize_autofit":"header_resize_start",O.b(this.grid.$).FBa(Ga,Ma,void 0));this.offset=this.Zh.Taa();this.gl=this.grid.sj?this.Z$a:this.Zh.V3();if(this.gl===e.a.swa)return!1;aa.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Tsi(Ga,Ma){var Qa=this.Zh.JJ();if(!Qa)return y.ULS.shipAssertTag(537154049,
2,!1,"cell being resized element received is null"),!1;Qa=Qa.nextSibling;if(!Qa)return!1;Ga=Ga.getRange();Qa=this.fe.Zua(Qa).getRange();if(!Ga||!Qa)return y.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ga=this.isRow?Ga.bottom:Ga.right;Qa=this.isRow?Qa.bottom:Qa.right;return Ga+1!==Qa&&Ga!==Qa&&this.dud(Ma,!0)}Kfi(){var Ga=this.Zh.JJ();const Ma=this.fe.Zua(Ga.nextSibling);ca.Usi(Ma,this.isRow)?(this.Zh=Ma,this.xR=this.Zh.getRange()):(this.ZIg(Ga),this.Zh=Ma,Ga=this.Zh.getRange(),
this.xR=this.ose(Ga),this.CX=!0)}ose(Ga){return this.isRow?new S.Range(Ga.top-1,Ga.left,Ga.top-1,Ga.right,!1,!0):new S.Range(Ga.top,Ga.left-1,Ga.bottom,Ga.left-1,!1,!0)}ZIg(Ga){const Ma=this.fe.Zua(Ga.nextSibling),Qa=ca.ydh(Ma,this.isRow,this.rtl);Qa&&Ga.parentNode.insertBefore(Qa,Ma.JJ())}pid(Ga){const Ma=this.xR,Qa=Ga.ha.qa.selectedRanges;if(Ga.ha.qa.Ltb(Ma))if(this.isRow){if(C.a.all(Qa,wb=>wb.isRow))return Qa}else if(C.a.all(Qa,wb=>wb.Rg))return Qa;return[Ma]}getCellExtent(){return this.Zh.getCellExtent()}$fd(){const Ga=
this.Zh.JJ().style;return Math.max(0,Math.min(this.Ruf,0|parseInt(this.isRow?Ga.height:Ga.width,10)))}Szc(Ga=0){const Ma=this.grid;var Qa=this.fe.aj.paneType;let wb;wb=this.isRow?3===Qa?[3,2]:[1,4]:4===Qa?[2,4]:[1,3];var Na=Math.max(this.grid.sj?this.Z$a:this.Zh.V3(),0);Ga=this.CX&&!this.grid.sj?Math.max(this.$fd(),0):Math.max(Na+Ga,0);Qa=Ma.sYh(Qa,this.isRow);Qa=this.isRow?new h.a(0,this.offset,Qa,Ga):new h.a(this.offset,0,Ga,Qa);Na=[this.isRow?13:14];Ma.Cb.wk(new S.Range(1,1,e.a.Vg,e.a.Ug,!1,!0),
Na,!1);Ma.Cb.Nq(Na,Qa,wb);return Ga}t2c(){this.xR=this.bBa=this.s8a=null;if(this.y0){const Ga=this.y0.parentNode;if(Ga)for(Ga.removeChild(this.y0);this.y0.firstChild;)Ga.appendChild(this.y0.firstChild);this.y0=null}this.Zh=null;this.BX=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.qVf()}qVf(){this.njc=!1;this.DLd();D.DOMElementExtensions.setVisible(ca.Lcb,!1);D.DOMElementExtensions.setVisible(this.TF,!1);M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&
this.YZf()}Pgd(Ga){if(D.DOMElementExtensions.ez(Ga.Mb,"a"))return null;const Ma=this.hnf(Ga.Ea);if(Ma&&this.grid.ha.qa.Tg){var Qa=this.grid.ha.qa.ld;Qa=this.fe.Vr(S.Range.Pc(Qa.bottom,Qa.right))}else Qa=this.fe.Zua(Ga.Mb);if(!Qa)return null;const wb=Qa.JJ(),Na=new Sys.UI.Bounds(wb.offsetLeft,wb.offsetTop,wb.offsetWidth,wb.offsetHeight);var ya=D.DOMElementExtensions.getBoundingClientRect(Ga.Mb);ya=new Sys.UI.Point(Ga.clientPoint.x-ya.x,Ga.clientPoint.y-ya.y);this.isRow&&!Ma&&(ya.y+=N.HelperMethods.LC(Ga.Mb,
wb,this.rtl).y);return new da(wb,ya,Na,Qa.getRange(),Math.max(ca.jIi,Math.min(ca.gHi,(this.isRow?Na.height:Na.width)*ca.Qoj)),Ma,!this.isRow&&0<wb.getElementsByTagName("input").length)}dud(Ga,Ma=!1){if(!Ga||this.grid.fb)return!1;if(Ga.gnf)return!0;var Qa=Ga.GOa;const wb=Ga.Kcb;var Na=this.fe.aj.paneType,ya=this.grid.Rf(Na).fi,nb=!!ya&&ya.top===Ga.Cld.top,vb=!!ya&&ya.left===Ga.Cld.left;Na=!!ya&&ya.bottom===Ga.Cld.bottom&&(3===Na||2===Na);this.isRow?(vb=Ga.yEb.y,Ga=vb<=wb&&!nb,Qa=vb>=Qa.height-wb-(Na?
ca.wKh:0),Ma=Ma?Ga:Qa||Ga):(Na=Ga.Hai,nb=this.rtl,ya=Ga.yEb.x,Ga=ya<=wb&&(!vb||nb)&&(!Na||!nb),Qa=ya>=Qa.width-wb&&(!nb||!vb)&&(!Na||nb),Ma=Ma?nb?Qa:Ga:Ga||Qa);return Ma}G_g(Ga,Ma){const Qa=this.isRow;if(Ga.gnf)this.Zh=this.fe.Zua(Ga.Wva);else if(Qa&&Ga.yEb.y<=Ga.Kcb&&Ga.GOa.height>Ga.Kcb||!Qa&&Ga.GOa.width>Ga.Kcb&&(!this.rtl&&Ga.yEb.x<=Ga.Kcb||this.rtl&&Ga.yEb.x>=Ga.GOa.width-Ga.Kcb)){if(this.Zh=Ga.Wva.previousSibling?this.fe.Zua(Ga.Wva.previousSibling):this.GXh(),Ma&&Ga.Wva.classList.contains(Qa?
l.a.BVe:l.a.AVe)&&(Ga=this.fe.Zua(Ga.Wva)))Ga=Ga.getRange(),this.xR=Qa?new S.Range(Ga.top-1,Ga.left,Ga.top-1,Ga.right,!1,!0):new S.Range(Ga.top,Ga.left-1,Ga.bottom,Ga.left-1,!1,!0)}else this.Zh=this.fe.Zua(Ga.Wva);!this.xR&&this.Zh&&(this.xR=this.Zh.getRange())}GXh(){var Ga=this.isRow?1:0;return(Ga=this.fe.aj.HB(this.fe.aj.Ca.Fg(this.grid.$.na,d.a.lJ(this.fe.position.X+Ga-1,this.fe.position.Y-Ga,this.fe.position.PaneType))))?Ga.FXh():null}Pef(){this.njc=!0;const Ga=this.Roj;D.DOMElementExtensions.setVisible(Ga,
!0);Ga.style.cursor=this.isRow?l.a.NSe:l.a.pRe;this.Szc()}jsh(Ga){this.grid.$.Zc(this.isRow?745189930:-445963340,B.a.zb,30,{["resizeRowColumnParameters"]:Ga})}vhh(){const Ga=document.createElement("div");Ga.className=l.a.Wyh;const Ma=document.createElement("div");Ma.className=f.a.Or;Ga.appendChild(Ma);const Qa=document.createElement("img");Qa.src=G.a.qe(0);Qa.className=this.isRow?f.a.Uxh:f.a.Pxh;Ma.appendChild(Qa);this.fe.pA.domElement.parentNode.insertBefore(Ga,this.fe.pA.domElement);this.grid.sj?
Ga.addEventListener(A.a.a$,this.qUi):(r.a.instance.ta(A.a.pointerDown,Ga,this.sN),z.a.instance.ta(A.a.tk,Ga,this.vca));D.DOMElementExtensions.setVisible(Ga,!1);this.TF=Ga}vJb(){this.t2c();this.TF&&(this.fe.pA.domElement.parentNode.removeChild(this.TF),this.TF=null)}hnf(Ga){return D.DOMElementExtensions.Af(this.TF,Ga.target)}Lqb(){this.BX&&(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.sj&&this.kDd(this.bBa),this.EPe(),this.grid.sj||D.DOMElementExtensions.Hoa(this.Zh.JJ(),
!this.isRow,this.iLb),this.vJb(),this.JQb=this.CX=!1)}Zif(){return M.EwaSettings.sa(587)}Ddf(Ga){(Ga=Ga.Ea.rawEvent)&&Ga.detail===ca.Dtj&&(Ga.type===A.a.jp?(this.BX=!1,this.SZc=!0):Ga.type===A.a.LH&&(this.BX=!0,this.SZc=!1))}static udh(Ga,Ma){return new ca(Ga,Ma)}static aSd(Ga,Ma,Qa){if(Ma){Ga.ColumnWidth=-1;Ga.RowHeight=Qa;for(const wb of Ga.SheetMultiRange.Ranges)wb.FirstColumn=0,wb.LastColumn=0}else{Ga.RowHeight=-1;Ga.ColumnWidth=Qa;for(const wb of Ga.SheetMultiRange.Ranges)wb.FirstRow=0,wb.LastRow=
0}}static Usi(Ga,Ma){if(!Ga||!Ga.JJ())return y.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Qa=Ga.getRange();Ga=Ga.JJ().style;if(!Qa||!Ga)return y.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ga=Ma?Ga.height:Ga.width;return(Ma?Qa.top:Qa.left)===(Ma?e.a.Vg:e.a.Ug)&&Ga===ca.Qng}static ydh(Ga,Ma,Qa){if(!Ga)return y.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var wb=Ga.JJ();if(!wb||!wb.style)return y.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;Ga=document.createElement("div");const Na=wb.style;Ga.style.top=Ma?Na.top:ca.Qng;Ma||(Qa?Ga.style.right=Na.right:Ga.style.left=Na.left);Ga.classList.add(Ma?v.Wxh:v.Vxh);Ga.classList.add(Ma?l.a.Rub:l.a.Qub);Qa=document.createElement("div");Qa.classList.add(Ma?l.a.rVe:l.a.Zad);wb=Ma?Number.parseInvariant(wb.innerText):S.Range.z0a(wb.innerText);Qa.innerText=Ma?(wb-1).toString():S.Range.vP(wb-1);Ga.appendChild(Qa);return Ga}}ca.jIi=0;ca.gHi=5;
ca.Udc=1;ca.wbf=1;ca.Vbi=0;ca.wKh=3;ca.Qoj=.1;ca.uZf="ewa-rszrbg";ca.Qng="0px";ca.Dtj=2;ca.Lcb=null;Object(t.a)(ca,"HeaderResizeBehavior",L.a,[424]);class wa extends b.a{constructor(){super();this.Db()}create(){this.nb(ca.udh)}static ka(Ga){Ga.da.Ha(136,new wa)}}Object(t.a)(wa,"HeaderResizeBehaviorFactory",b.a,[]);var ia=a(55),Ha=a(709),Sa=a(50),Da=a(37),ea=a(174),sa=a(426),Ea=a(374),ba=a(192),ka=a(250),Ca=a(282),db=a(66),yb=a(21);class kb{constructor(Ga,Ma){this.isRow=!1;this.autoFitRange=null;this.isRow=
Ga;this.autoFitRange=Ma}}Object(t.a)(kb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[122]);class mb{constructor(Ga){this.resizeParameters=null;this.resizeParameters=Ga}}Object(t.a)(mb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[122]);var W=a(84);b=a(285);var Q=a(22),va=a(61);class na extends b.a{constructor(Ga,Ma){super(Ga);this.axb=Qa=>{Qa=this.dhd(Qa);return this.ped(Qa)};this.Hoj=(Qa,wb)=>{var Na=this.P7a=wb[na.Bni];1===Qa?(Qa=wb[na.wKj],Na=this.I8e(Qa,Na),y.ULS.shipAssertTag(537153996,
0,Na!==na.pba,`ResizeHeadersDialogHandler - invalid size input, size = ${Qa}`),Qa=Na!==this.Knd,y.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.P7a,Na,Qa),Qa&&this.Yah(Na)):y.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Ma.command;this.gridView=yb.h(this.$);this.Gvc=new qa(this.$.workbookContext.DxDigitNormal);
this.Knd=this.g0g();Ga=this.F$g(this.Knd);Ma=this.H$g(this.Knd);this.el=Y.a.instance.ga(this.isRow?477:478);Ga=this.EM(Ga,Ma);this.initializeAndShow(this.el,this.Hoj,Ga);y.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get kc(){return"ResizeHeadersDialog"}get P7a(){return na.Ybe}set P7a(Ga){na.Ybe=Ga}EM(Ga,Ma){return{[na.TU]:this.kc,[na.hti]:this.isRow,[na.jgi]:Ga,[na.igi]:Ma,[na.Vpi]:this.P7a,[na.chd]:this.axb}}g0g(){const Ga=this.KNh();try{return this.vSh(Ga)}finally{Ga&&
Ga.dispose()}}Yah(Ga){const Ma={};Ma.SheetMultiRange=I.r(this.gridView.ha.qa.selectedRanges,this.$);na.aSd(Ma,this.isRow,Ga);this.$.Zc(this.isRow?745189930:-445963340,B.a.zb,8,{["resizeRowColumnParameters"]:Ma})}I8e(Ga,Ma){return Q.a.R4(Ga)?Ma?this.E$g(Ga):this.G$g(Ga):na.pba}G$g(Ga){return Math.floor(parseFloat(Ga))}E$g(Ga){Ga=parseFloat(Ga);return 0>Ga?na.pba:Ga?this.isRow?N.HelperMethods.B5i(Ga):this.Gvc.x6g(Ga):0}H$g(Ga){return Ga===na.pba?"":this.isRow?this.Gvc.mGe(Ga).toString():this.Gvc.cGe(Ga).toFixed(2)}F$g(Ga){return Ga===
na.pba?"":Ga.toString()}vSh(Ga){if(!Ga||!Ga.$$mn()||!Ga.Mm)return na.pba;var Ma=Object(W.a)(454,Ga.Mm);if(!Ma)return na.pba;for(Ma=this.isRow?Ma.Czb:Ma.Ind;Ga.$$mn();){const Qa=Object(W.a)(454,Ga.Mm);if(Qa&&(this.isRow?Qa.Czb:Qa.Ind)!==Ma)return na.pba}return Ma}KNh(){const Ga=[];for(const Qa of this.gridView.ha.qa.selectedRanges){const wb=Qa.clone();var Ma=this.gridView.Rf(this.gridView.ib.yi(wb));Ma=wb.De(Ma.fi);if(!Ma)return null;this.isRow?wb.right=wb.left=Ma.left:wb.top=wb.bottom=Ma.top;Ga.push(wb)}return Ga.length?
this.gridView.K$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ga):null}dhd(Ga){if(!Q.a.R4(Ga))return 1;Ga=this.I8e(Ga,this.P7a);if(0===Ga)if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const Ma=this.gridView.ha.qa.selectedRanges,Qa=this.gridView.Mj("ResizeHeaderDialog");if(Object(va.c)(Qa)){if(!Qa.value.Rze(Ma,this.isRow))return 3}else if(this.Flf())return 3}else if(this.Flf())return 3;return this.cwi(Ga)?0:2}Flf(){const Ga=this.gridView.ha.qa.selectedRanges;
return this.isRow&&I.P(Ga)||!this.isRow&&I.O(Ga)}ped(Ga){let Ma="";switch(Ga){case 0:Ma="";break;case 1:Ma=Y.a.instance.ga(766);break;case 2:Ga=this.P7a;Ma=String.format(Y.a.instance.ob(99),0,this.Fcc(Ga));break;case 3:Ma=Y.a.instance.ga(767)}return Ma}cwi(Ga){return 0<=Ga&&Ga<=this.Fcc(!1)}Fcc(Ga){return this.Gvc.Fcc(Ga,this.isRow)}static aSd(Ga,Ma,Qa){if(Ma){Ga.ColumnWidth=na.pba;Ga.RowHeight=Qa;for(const wb of Ga.SheetMultiRange.Ranges)wb.FirstColumn=0,wb.LastColumn=0}else{Ga.RowHeight=na.pba;
Ga.ColumnWidth=Qa;for(const wb of Ga.SheetMultiRange.Ranges)wb.FirstRow=0,wb.LastRow=0}}}na.TU="id";na.hti="isRow";na.jgi="initialSizeInPx";na.igi="initialSizeInDefaultUnits";na.Vpi="isInitialUnitsDefaultUnits";na.chd="getInputErrorIfInvalid";na.wKj="size";na.Bni="isDefaultUnits";na.pba=-1;na.Ybe=!0;Object(t.a)(na,"ResizeHeadersDialog",b.a,[]);var Ba=a(60);const Oa=(Ga,Ma,Qa,wb,Na,ya,nb=null)=>{nb=Ga.Na(41,nb);nb.resizeRowColumnParameters=Ma;return Ba.g(Ga,"ResizeRowsColumns",nb,Qa,wb,Na,ya,0)};var oa=
a(345),Ja=a(292),Wb=a(65),nc=a(195),Yb=a(29),pb=a(347);class Fa{constructor(Ga,Ma,Qa){this.mYi=(wb,Na)=>{if(!ka.a(wb)&&Na){const ya=!!wb&&!!wb.RequestTelemetryData;yb.h(this.$).vh.zla(Na,wb.StateId,ya?wb.RequestTelemetryData.EcsOperationDuration:0,ya?wb.RequestTelemetryData.EcsRequestDuration:0,ya?wb.RequestTelemetryData.WfeRequestDuration:0)}};this.xPi=(wb,Na)=>{Na&&Na.w1b&&Na.w1b.SheetName&&Na.w1b.Ranges.length&&Na.Pmi&&(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")&&w.AFrameworkApplication.Sp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),
M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.nXd=Na.w1b.Ranges[0],this.Nwa()?this.mEe(this.nXd):this.grid.y_b(this.aGb)))};this.aGb=()=>{this.Nwa()&&(this.grid.Cuc(this.aGb),this.mEe(this.nXd))};this.$=Ga;this.Lh=Ma;this.gridInstantaneousAction=Qa;this.grid=yb.h(this.$);this.nXd=null}Hc(Ga,Ma){Ga=!0;switch(Ma){case -445963340:case 1391094586:Ga=this.Pd(8);break;case 745189930:case 146338636:Ga=this.Pd(16)}return!Ga}executeCommand(Ga,
Ma,Qa){var wb=yb.h(this.$);const Na=Ma.command;var ya=ea.a.create().toString();let nb=Da.TaskExtensions.Tj();switch(Na){case 1391094586:case 146338636:Ga=1391094586===Na;(ya=Qa.autoFitRanges)&&ya.Ranges&&ya.Ranges.length||(ya=I.r(wb.ha.qa.selectedRanges,this.$));nb=this.joh(Ga?1:0,ya,Ma);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ga=-445963340===Na||-706918724===Na||369708605===Na;M.EwaSettings.DMa()&&-706918724===Na&&wb.vh.u0(18,ya);if(-445963340===
Na||745189930===Na){var vb=sa.a(Ma.command);wb.vh.u0(16,ya,vb);wb=Qa.resizeRowColumnParameters}else{Qa=wb.ha.qa.selectedRanges;let cb=0;for(var gb of Qa)if(-706918724===Na||369708605===Na){const La=gb.right-gb.left+1;cb+=0<La?La:-1*La}else if(1542466017===Na||1051390410===Na)cb+=gb.bottom-gb.top+1;369708605===Na||1542466017===Na?y.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${cb}`):(-706918724===Na||1051390410===Na)&&y.ULS.sendTraceTag(520938757,
0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${cb}`);if(!M.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Object(va.c)(wb.Mj("ResizeCmdHandler"))){if(-706918724===Na&&6===Ma.We&&I.O(Qa)){y.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Na&&6===Ma.We&&I.P(Qa)){y.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}}gb=369708605===Na||1542466017===Na?-2:0;wb={};wb.SheetMultiRange=I.r(Qa,this.$);if(Ga)for(vb of wb.SheetMultiRange.Ranges)vb.FirstRow=0,vb.LastRow=0;else for(const La of wb.SheetMultiRange.Ranges)La.FirstColumn=0,La.LastColumn=0;wb.RowHeight=Ga?-1:gb;wb.ColumnWidth=Ga?gb:-1}nb=this.Eoh(wb,Ma,ya,Ga);break;case 957527587:case 2040891415:new na(this.$,Ma)}return nb}mEe(Ga){if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const Ma=
Wb.d(this.$.va.na),Qa=new oa.a(I.B(Ga),Ma);Da.TaskExtensions.za(Sa.GetServiceTaskFactory.Oa(this.$.da,426,427,1),wb=>{void wb.result.JCc(Qa,"ColumnAutoFit")},this.$.la,3)}}wc(Ga,Ma,Qa,wb){if(Ga=!!Qa&&!!wb&&1===wb.wx)switch(Ma.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ga=!1}return Ga}Mc(){return!1}vCi(Ga){y.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Ja.c)(Ga)}. Reason: ${Object(Ja.c)(Ga)?
void 0:Ga.reason}.`)}Pd(Ga){return(new R.a(this.$.va)).Pd(Ga)}Nwa(){return this.grid.Ca.HQ(4,this.$.na)}joh(Ga,Ma,Qa){const wb=this.$.oa.xa.Wb(),Na=0===Ga,ya=()=>new kb(Na,Ma);return Ea.a(this.$.userOperationManager,(nb,vb,gb)=>{var cb=this.$.oa.xa;nb=Ca.b(nb,this.xPi);var La={Pmi:!Na,w1b:Ma};const ja=cb.Na(41,wb);ja.isRow=Na;ja.autoFitRanges=Ma;return Ba.g(cb,"AutoFit",ja,nb,vb,gb,La,0)},nb=>new ba.a(135,0,nb,void 0,ya),Qa,M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",
!1))}Eoh(Ga,Ma,Qa,wb){const Na=Ma.command,ya=yb.h(this.$),nb=I.g(Ga.SheetMultiRange.Ranges);if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var vb=1051390410===Na||745189930===Na&&0===Ga.RowHeight;const ja=-706918724===Na||-445963340===Na&&0===Ga.ColumnWidth,Ua=ya.Mj("ResizeCmdHandler");if((vb||ja)&&Object(va.c)(Ua)&&!Ua.value.Rze(nb,!wb))return this.tnh(wb),Da.TaskExtensions.Tj()}let gb;vb=M.EwaSettings.DMa()&&-706918724===Na;if(745189930===Na||-445963340===Na||vb)y.ULS.shipAssertTag(537154002,
0,this.$.activeItemName===Ga.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),vb?Object(nc.c)(()=>{this.gridInstantaneousAction.oUg(Na);ya.vh.kGi()},this.$.la,0):(gb=this.Lh.MIj(ya,nb,wb?Ga.ColumnWidth:Ga.RowHeight,!wb),this.vCi(gb),Object(Ja.c)(gb)&&ya.vh.UR(Qa,db.BasicTelemetryCalculator.zQ));const cb=this.$.oa.xa.Wb({xla:!0,qka:3});wb=(ja,Ua,lb)=>{this.$.my();I.i(nb,",",this.$,!1);return Oa(this.$.oa.xa,Ga,Ca.b(ja,this.mYi),Ua,lb,Qa,cb)};const La=
()=>new mb(Ga);return gb&&Object(Ja.c)(gb)?Ea.a(this.$.userOperationManager,wb,ja=>new ba.a(136,0,ja,64,La),Ma):Ea.a(this.$.userOperationManager,wb,ja=>new ba.a(136,0,ja,void 0,La),Ma)}tnh(Ga){Ga=Yb.a.ed(1,0,Ga?768:770,Ga?769:771,0,Ga?-2037763134:503471870,Ga?"HideAllColumnsError":"HideAllRowsError");new pb.a(this.$,Ga)}}Object(t.a)(Fa,"ResizeCommandHandler",null,[221]);class ab extends Ha.a{constructor(Ga){super(Ga)}hd(){const Ga=Sa.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa);let Ma;
Ma=M.EwaSettings.DMa()?Sa.GetServiceTaskFactory.Oa(this.$.da,528,529,this.Xa):ia.Task.Ra(null);Da.TaskExtensions.za(Ga,()=>{this.$c([new Fa(this.$,Ga.result,Ma.result)])},this.la,3)}static ka(Ga){Ha.a.Ld(113,new ab(Ga))}}Object(t.a)(ab,"ResizeCommandHandlerFactory",Ha.a,[]);a.d(F,"a",function(){return Gb});const Gb=()=>{c.a.Fa(Ga=>{wa.ka(Ga);ab.ka(Ga)})}},1200:function(t,F,a){t=a(0);var c=a(136);class b extends c.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Kz(S,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}J8c(S){this.Kz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[228]);var e=a(15),f=a(160);class d{g0e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const S=new f.a;S.setResult("api.onedrive.com");return S.task}}Object(t.a)(d,"OneDriveConsumerEndpointHelper",null,[216]);var h=a(85),m=a(54),l=a(378),v=a(231);class r{constructor(S,
G,D,E){this.FEa=this.Y5=null;this.QSc=this.SSc=!1;this.dXa=null;this.mb=S;this.DRb=G;this.lEa=D;this.Es=E}get Ate(){return this.DRb}get fa(){return this.mb}F4a(){this.dXa||(this.dXa=this.S$a?v.a.create(this.S$a,null,null,null,!1):null);return this.dXa}setup(S){this.FEa=S;this.SSc||this.QSc?this.SSc&&this.FEa&&this.FEa(!0):(S=this.F4a())?(this.QSc=!0,S.Q8a.continueWith(G=>{this.YWi(G)}),l.a.uia(S)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),
this.FEa(!1))}ADd(S){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.")}YWi(S){this.QSc=!1;if(S.Hf)this.ADd(S),this.FEa(!1);else try{this.SSc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Nnd(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.FEa(!0)}catch(G){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",G.toString()),this.FEa(!1)}}startPicker(S){this.Y5=
S;this.lEa?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.$Bd,"onApiReady")))}$Bd(S){S?this.flc():this.kj()}kj(){this.Es().displayError(m.a.o1i)}onSuccess(S){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Y5&&this.Y5(!0,S)}dispose(){this.dXa&&this.dXa.dispose()}}Object(t.a)(r,"AOneDriveFilePickerApiManager",
null,[269,2]);class A extends r{constructor(S,G,D,E,M,L){super(G,D,E,L);this.zh=null;this.I1=S;this.QDg=M}get S$a(){return this.fa.Wa("OneDriveApiUrl")}start(S,G){this.zh=S;this.startPicker(G)}Nnd(){WL.init(1===this.Ate||2===this.Ate?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(S){this.Y5=S;!this.lEa&&this.I1.gMa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),
this.setup(Object(h.a)(this,this.$Bd,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.QDg())}flc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.zh).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.X5,"onFailure"))}catch(S){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",S,S.stack),this.kj()}}X5(S){if(S&&S.error){if("user_canceled"===S.error.code){e.ULS.sendTraceTag(17909058,
352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",S.error.code,S.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.Y5&&this.Y5(!1,S);this.kj()}}Object(t.a)(A,"OneDriveFilePickerApiManagerV5",r,[]);class x extends r{constructor(S,G,D,E,M){super(S,G,D,E);this.aUb=this.Pfe=null;this.Rvg=M;this.options={};this.options.clientId=this.fa.Wa("OneDriveApiV7ClientId");this.options.cancel=
Object(h.a)(this,this.pCc,"toggleHostDivVisibility")}get S$a(){return this.fa.Wa("OneDriveApiV72Url")}start(S,G){this.aUb=G;const D=this.Rvg.g0e();D.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Pfe=D.result;this.startPicker((E,M)=>{this.pCc();S(E,M)})},3);D.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,D.exception.message);this.pCc()},5)}Nnd(){this.options.success=S=>{const G={};G.data=S;this.onSuccess(G)};this.options.error=
S=>{const G={};G.error=S;this.X5(G)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Pfe;this.options.advanced.iframeParentDiv=this.aUb}flc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.pCc(),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",S.message),this.kj()}}X5(S){this.Y5&&this.Y5(!1,S);this.kj()}pCc(){this.aUb.style.visibility=
"hidden"===this.aUb.style.visibility?"":"hidden"}}Object(t.a)(x,"OneDriveFilePickerApiManagerV7",r,[]);class n extends r{constructor(S,G,D,E){super(S,G,D,E);this.Isg=S;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Wa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get S$a(){return this.fa.Wa("OneDriveApiV72Url")}start(S,G,D,E){this.options.advanced.iframeParentDiv=D;this.options.advanced.endpointHint=E;this.options.cancel=G;this.Isg.pa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(S)}startPicker(S){this.Y5=S;this.lEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.$Bd,"onApiReady")))}Nnd(){this.options.success=
S=>{const G={};G.data=S;this.onSuccess(G)};this.options.error=S=>{const G={};G.error=S;this.X5(G)}}flc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(S){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.kj()}}ADd(S){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.");l.a.dij(this.S$a);
this.dXa=null}kj(){this.Es().J8c(m.a.Jrj)}X5(S){this.Y5&&this.Y5(!1,S)}}Object(t.a)(n,"OneDriveFilePickerApiManagerV72",r,[]);class u{constructor(S){this.olsSessionId=this.value=this.key=null;this.olsSessionId=S}}Object(t.a)(u,"IExtraData",null,[]);var z=a(4);class w extends n{constructor(S,G,D,E){super(S,G,D,E);this.options.advanced.filter=S.Wa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=z.AFrameworkApplication.Ite;S.pa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=S.Wa("OneDriveApiV72CommandMode")||"none");S.pa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new u(z.AFrameworkApplication.userSessionId))}get S$a(){return this.fa.Wa("OneDriveApiV72Url")}flc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",z.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.kj()}}}Object(t.a)(w,"OneDriveFilePickerApiOpenManagerV72",n,[]);var C=a(242);class y{constructor(S){this.Ck=null;this.ph=S;this.SRc=3}g0e(){this.Ck=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.qQd();return this.Ck.task}qQd(S=null){const G=
String.format("GetMoreInfoHandler.ashx?{0}",z.AFrameworkApplication.iIa);this.ph.Gga(G,1,null,S,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.PYh,"getMoreInfoSucceeded"),Object(h.a)(this,this.NYh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}NYh(S){if(S.data.httpStatus===C.a.aIb&&"X-NewKey"in S.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const G={};G["X-Key"]=S.data.responseHeaders["X-NewKey"];
this.qQd(G)}else 0<this.SRc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.SRc),this.SRc--,this.qQd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Ck.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}PYh(S){"PersonalFileStorageUrl"in S.data.responseHeaders&&""!==S.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.Ck.setResult(S.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Ck.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(t.a)(y,"OneDriveForBusinessEndpointHelper",null,[216]);var B=a(252),H=a(560);class I{constructor(){this.$a=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Ah(S){this.$a=
S;this.$a.register(A,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").qc().yc(()=>new A(H.a.instance,z.AFrameworkApplication.fa,z.AFrameworkApplication.C2a,z.AFrameworkApplication.limitedEdit,z.AFrameworkApplication.r$f,()=>new b));z.AFrameworkApplication.umf?this.$a.register(216,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").qc().yc(()=>new d):this.$a.register(216,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").qc().yc(()=>
new y(z.AFrameworkApplication.Bd));this.$a.register(x,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").qc().yc(()=>new x(z.AFrameworkApplication.fa,z.AFrameworkApplication.C2a,z.AFrameworkApplication.limitedEdit,()=>new b,this.$a.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.$a.register(n,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").qc().yc(()=>new n(z.AFrameworkApplication.fa,z.AFrameworkApplication.C2a,z.AFrameworkApplication.limitedEdit,
()=>new b));this.$a.register(w,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").qc().yc(()=>new w(z.AFrameworkApplication.fa,z.AFrameworkApplication.C2a,z.AFrameworkApplication.limitedEdit,()=>new b))}static main(){B.a.instance.gi(new I)}}Object(t.a)(I,"PackageManager",null,[4,5]);a.d(F,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");I.main()}},1207:function(t,F,a){t=a(0);var c=a(85),b=a(15),e=a(136),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(Y,
U){super();this.eXa=!1;this.bA=null;this.Ma=Y;this.Uib=U;this.ESa=!1}displayError(Y,U,P){this.bA=U;this.eXa=P;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Y,P);Y=this.T1c(Y);0===Y?(this.Ob=6,this.tc(0,CommonUIStrings.l_DialogClose)):(this.Ob=0,this.tc(1,CommonUIStrings.l_DialogClose));0===Y&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Kz(f.a.Irj,this.Qfd(Y),this.kTh(Y,U),Object(c.a)(this,this.BOd,"retryDialogHandler"),!0)}BOd(Y){1===
Y?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.bA?this.Ma.Wd(d.a.dLb,2,[this.bA,this.eXa]):this.Ma.processAction(d.a.dLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}T1c(Y){return 0>Y||6<Y?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Y),0):Y}kTh(Y,U){Y=this.T1c(Y);return this.Uib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,U),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Y]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,U),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Y]}Qfd(Y){Y=this.T1c(Y);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Y]}}Object(t.a)(h,"ErrorRetryDialog",e.StandardDialog,[340]);class m{constructor(Y,U){this.mb=Y;this.Ma=U;this.Uib=this.mb.pa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.Ma,this.Uib)}}Object(t.a)(m,"ErrorRetryDialogFactory",null,[320]);e=a(1071);var l=a(150);class v{static get og(){return l.a.xq(v.Ll,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}v.Ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(t.a)(v,"FileNameDialogHtml",null,[]);var r=a(4),A=a(30);class x extends e.a{constructor(Y,U,P,aa,X,Z){super(Y,U,P,aa,X,Z);this.og=v.og;this.pe="FileNameDialog-SaveAsToHost"}MP(Y,U){const P=A.a.Kp(r.AFrameworkApplication.om.en);U={["txtFileName"]:Y||P,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:U};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.F$b,"fileNameDialogHandler"),U);this.nMe(Y,P)}}Object(t.a)(x,"FileNameDialog",e.a,[339]);class n{constructor(Y,
U,P,aa,X,Z){this.Ma=U;this.mb=Y;this.hX=aa;this.rga=Z;this.Es=X;this.Ze=P}create(){return new x(this.mb,this.Ma,this.Ze,this.hX,this.Es,this.rga)}}Object(t.a)(n,"FileNameDialogFactory",null,[319]);var u=a(650),z=a(108);class w{constructor(Y,U,P){this.rga=P;this.zKc=U;this.mb=Y}Ag(){2===r.AFrameworkApplication.ra.Qa.Oj?r.AFrameworkApplication.rb.Ne(d.a.dLb,z.a.frame,Object(c.a)(this,this.E0f,"saveAsToHostActionDispatcher"),4):r.AFrameworkApplication.rb.Nb(d.a.dLb,z.a.frame,Object(c.a)(this,this.E0f,
"saveAsToHostActionDispatcher"))}E0f(Y,U,P,aa,X){return U.contextId!==z.a.frame||Y!==d.a.dLb?2:this.mb.pa("SaveAsToHostBrsIsEnabled")?1===P?u.SessionStatusManager.instance.p5a||r.AFrameworkApplication.O4?8:32:2===P?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Y=this.zKc.create(),X&&Object.getType(X)===Array&&2===X.length?Y.MP(X[0],!!X[1]):Y.MP(null,!1),32):8:8}}Object(t.a)(w,"SaveAsToHostActor",null,[]);var C=a(39),y=a(79),B=a(40),H=a(242),I=a(376),
R=a(167),S=a(652),G=a(777);class D{constructor(Y,U,P,aa,X,Z,da,qa){this.Gm=null;this.eXa=this.EDa=!1;this.qga=this.zh=this.bA=null;this.mb=U;this.BFa=this.mb.appSettings.SaveAsToHostWebServiceBase;this.Jae=aa;this.Flb=X;this.ph=P;this.Es=Z;this.rh=qa;this.Ze=da;this.Ma=Y;this.qfa=U.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}vNb(){1!==this.Ze.state&&(this.Gm=this.Flb(),this.Gm.message=CommonUIStrings.l_CommentProgressTooltip,this.Gm.Ob=5,this.Gm.pt=!1,this.Gm.WAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}PR(Y=0){1!==this.Ze.state&&this.Es.create().displayError(Y,A.a.Kp(this.bA),this.eXa)}mQa(){const Y=this.mb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");B.a.gf(Y,B.a.ZW(3),void 0,"UploadToHostManager.RedirectToFolder")}lQa(Y){let U=!1,P=!1;this.mb&&(U=this.mb.pa("SaveACopyIsEnabledForUiHost"),P=this.mb.pa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
Y,U,P);if(U&&P){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const aa={};aa[I.a.fQa]="1";aa[I.a.documentUrl]=Y;aa[I.a.reason]=S.a.saveAs;r.AFrameworkApplication.nQ().execute(X=>{X.jj(R.a.PY,aa)})}else U&&!P&&r.AFrameworkApplication.eV?B.a.gf(Y,B.a.ZW(4),void 0,"UploadToHostManager.RedirectToEditUrl"):B.a.gf(Y,B.a.ZW(3),void 0,"UploadToHostManager.RedirectToEditUrl")}aoa(Y,U,P=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.Jae&&!this.Jae()&&this.ph&&(this.rh&&(this.qga=this.rh.Gc("DialogShown","SaveAsToHostUploadTime")),this.vNb(),this.eXa=U,this.bA=Y,(this.zh=P)&&"true"===this.zh.SkipSaveToHost?this.a$b():this.UP())}UP(){32!==this.Ma.processAction(d.a.rRa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.a$b()):this.Ma.Wd(d.a.rRa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.a$b()},(Y,
U)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.PR(U)}])}B0i(Y){this.OIa();this.EDa=!1;if(Y&&Y.data&&Y.data.de)if(({ht:U}=C.d(Y.data.de)).returnValue)if(Y=U,Y.StatusCode!==H.a.EO&&Y.StatusCode!==H.a.Hsb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var U={};U.FailureReason=Y.StatusCode.toString();U.ExtraInfo=Y.ExtraInfo;this.xda(U);this.PR(parseInt(Y.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.mNd();try{Y.NewDocumentUrl&&""!==Y.NewDocumentUrl?this.lQa(Y.NewDocumentUrl):this.mQa()}catch(P){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",P.toString())}this.HHb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:G.a.Qfb(Y.data.de)}),this.xda({["FailureReason"]:"Failed to deserialize response"}),this.PR();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.xda({["FailureReason"]:"null response"}),this.PR()}A0i(Y){5!==Y.data.status&&12!==Y.data.status||this.EDa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Y.data.status,["HttpStatus"]:Y.data.httpStatus}),this.xda({["FailureReason"]:Y.data.httpStatus.toString()}),this.OIa(),this.PR(),this.HHb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.EDa=!0,this.zh&&"true"===this.zh.SkipSaveToHost?this.a$b():
this.UP())}OIa(){this.Gm&&(this.Gm.close(),this.Gm=null)}HHb(){this.qga&&(this.qga.stop(),this.qga=null)}mNd(){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.Ma.processAction(d.a.vvc,2)}xda(Y){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.Ma.Wd(d.a.oNd,2,Y)}a$b(){let Y=this.BFa+this.qfa;Y=y.a.wl(Y,"qs",A.a.hf(r.AFrameworkApplication.ti));Y=y.a.wl(Y,"n",A.a.hf((new Date).getTime().toString()));Y=y.a.wl(Y,"ov",A.a.hf(this.eXa.toString()));Y=y.a.wl(Y,"fn",A.a.hf(this.bA));this.zh&&
this.zh.FileDownloadUrl&&(Y=y.a.wl(Y,"furl",A.a.hf(this.zh.FileDownloadUrl)));this.ph.Im(Y,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.B0i,"onUploadFinished"),Object(c.a)(this,this.A0i,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(t.a)(D,"UploadToHostManager",null,[237]);var E=a(252),M=a(794);class L{constructor(){this.$a=null}get name(){return"Common.App.SaveAsToHost"}init(){r.AFrameworkApplication.fa.ru(Object(c.a)(this,this.jB,"onFullAppSettingsReady"))}jB(){r.AFrameworkApplication.fa.pa("SaveAsToHostBrsIsEnabled")&&
this.$a.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ag()}Ah(Y){this.$a=Y;this.$a.register(m,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").yc(()=>new m(r.AFrameworkApplication.fa,r.AFrameworkApplication.rb)).qc();this.$a.register(D,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").yc(()=>new D(r.AFrameworkApplication.rb,r.AFrameworkApplication.fa,r.AFrameworkApplication.Bd,()=>r.AFrameworkApplication.rg,
()=>(new M.a).create(),Y.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),r.AFrameworkApplication.ra,r.AFrameworkApplication.ra.ED)).qc();this.$a.register(n,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").yc(()=>new n(r.AFrameworkApplication.fa,r.AFrameworkApplication.rb,r.AFrameworkApplication.ra,r.AFrameworkApplication.ra.Qa,Y.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Y.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).qc();
this.$a.register(w,"Common.App.SaveAsToHost.SaveAsToHostActor").yc(()=>new w(r.AFrameworkApplication.fa,Y.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Y.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).qc()}dispose(){}static main(){E.a.instance.gi(new L)}}Object(t.a)(L,"SaveAsToHostPackage",null,[4,5]);a.d(F,"a",function(){return N});const N=()=>{Type.registerNamespace("Common.App.SaveAsToHost");L.main()}},1208:function(t,F,a){t=a(0);var c=a(85),b=a(15),e=a(150);class f{static get og(){return e.a.xq(f.Ll,
CommonUIStrings.l_SaveACopyFileName)}}f.Ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(t.a)(f,"FileNameDialogHtml",null,[]);var d=a(4),h=a(30);class m extends e.a{constructor(G,D,E,M){super();this.LTb=
this.r8=null;this.Ma=G;this.hX=D;this.Zmb=E;this.tc(1,CommonUIStrings.l_SaveButtonLabel);this.og=f.og;this.pe="FileNameDialog-SaveACopy";this.zh=M}MP(G,D,E){this.LTb=G;this.r8=E;G={["txtFileName"]:h.a.Kp(d.AFrameworkApplication.om.en),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,D)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.F$b,"fileNameDialogHandler"),G);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}F$b(G,D){1!==G?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=D.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),D=h.a.T3(d.AFrameworkApplication.fileName),G&&""!==G&&""!==D&&(G+=D),this.Zmb.aoa(this.LTb,this.r8,G,this.zh))}}Object(t.a)(m,"FileNameDialog",e.a,[347]);class l{constructor(G,D,E){this.Ma=G;this.hX=D;this.Zmb=E}create(G){return new m(this.Ma,
this.hX,this.Zmb,G)}}Object(t.a)(l,"FileNameDialogFactory",null,[332]);var v=a(136),r=a(25);class A extends v.StandardDialog{constructor(G){super();this.Ob=1;this.tc(1,CommonUIStrings.l_RetryButtonLabel);this.tc(0,CommonUIStrings.l_DialogClose);this.Ma=G}displayError(G){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.Kz(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.BOd,"retryDialogHandler"))}BOd(G){1===G?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.Ma.processAction(r.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(t.a)(A,"RetryDialog",v.StandardDialog,[331]);v=a(1072);var x=a(852),n=a(378),u=a(108);class z extends v.a{constructor(G,D,E,M){super(G,D,E,M);this.XAg=D}X7a(){return this.mb.pa("SaveACopyBrsIsEnabled")}P_e(){return r.a.saveACopy}D2b(){n.a.AKd(Object(c.a)(this,this.X0f,"saveToCloudActionDispatcher"));n.a.g$c([new x.a(r.a.saveACopy,u.a.frame,0)],
this.XAg.F4a())}RSf(){d.AFrameworkApplication.ola("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(t.a)(z,"SaveACopyActor",v.a,[]);v=a(1075);class w extends v.a{constructor(G,D,E,M,L,N,Y){super(D,E,M,L,N,Y);this.rwg=G}onSuccess(G){G&&G.data&&G.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.rwg.create(this.zh).MP(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):
(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.kj())}X5(G){G&&G.error&&"user_canceled"===G.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.X5(G)}kj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.kj()}}Object(t.a)(w,"SaveACopyManager",v.a,[]);var C=a(1073);class y extends C.a{constructor(G,D,E,M,L,N){super(D,E,M,L,N);this.Ma=G}Esd(){return!!this.zh&&!!this.zh.SaveEntryPoint&&
"VersionHistory"===this.zh.SaveEntryPoint.toString()}PR(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Esd()&&this.Ma.Wd(r.a.oNd,2,{["FailureReason"]:"Unknown"});super.PR()}mQa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Esd()&&this.Ma.processAction(r.a.vvc,2);super.mQa()}lQa(G){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",G);this.Esd()&&this.Ma.processAction(r.a.vvc,2);super.lQa(G)}UP(){this.zh&&
"true"===this.zh.SkipSaveToHost?super.UP():32!==this.Ma.processAction(r.a.rRa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.UP()):this.Ma.Wd(r.a.rRa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");C.a.prototype.UP.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.PR()}])}}Object(t.a)(y,"SaveACopyUploadToCloudManager",
C.a,[]);var B=a(252),H=a(560),I=a(794);class R{constructor(){this.$a=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.ru(Object(c.a)(this,this.jB,"onFullAppSettingsReady"))}jB(){d.AFrameworkApplication.fa.pa("SaveACopyBrsIsEnabled")&&this.$a.resolve("Common.App.SaveACopy.SaveACopyActor").Ag()}dispose(){}Ah(G){this.$a=G;this.$a.register(y,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").yc(()=>new y(d.AFrameworkApplication.rb,G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new I.a).create(),()=>new A(d.AFrameworkApplication.rb),d.AFrameworkApplication.ra,d.AFrameworkApplication.ra.ED)).qc();this.$a.register(l,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").yc(()=>new l(d.AFrameworkApplication.rb,d.AFrameworkApplication.ra.Qa,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).qc();this.$a.register(z,"Common.App.SaveACopy.SaveACopyActor").yc(()=>new z(G.resolve("Common.App.SaveACopy.SaveACopyManager"),
G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.ra.ED)).qc();this.$a.register(w,"Common.App.SaveACopy.SaveACopyManager").yc(()=>new w(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),H.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.C2a,()=>new A(d.AFrameworkApplication.rb))).qc()}static main(){B.a.instance.gi(new R)}}
Object(t.a)(R,"PackageManager",null,[4,5]);a.d(F,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveACopy");R.main()}},1209:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(15),f=a(30),d=a(84),h=a(245),m=a(36);class l extends h.a{constructor(E,M,L){super(E,M);this.MFd=this.executionContext=null;this.a4i=(N,Y)=>{this.yHb(N,Y)};this.AJ=L}initialize(E){super.initialize(E)}execute(E){this.executionContext=E;E=Object(d.a)(6,this.executionContext.Ce);this.zsb(E);return 1}uI(E){super.uI(E)}zsb(){this.subscribe(this.executionContext,
this.a4i,E=>{this.MFd.add_disposing(E)})}yHb(E){this.unsubscribe(M=>{E.remove_disposing(M)});this.executionContext.activityState[m.a.Y1]=0}}Object(t.a)(l,"PasswordProtectedFileActivity",h.a,[]);var v=a(285),r=a(266),A=a(13);class x extends v.a{constructor(E){super(E);this.Ppa=0;this.Acj=(M,L)=>{this.xbb(M,L)};this.K1d=(M,L)=>{this.tUa(M,L)}}get kc(){return"PasswordDialog"}get utb(){return this.Ppa}get el(){return A.a.instance.ga(1979)}xbb(E){this.Ppa=E}Y2(){const E={};E[v.a.description]=A.a.instance.ga(1980);
E[v.a.placeholderText]=A.a.instance.ga(1976);E[v.a.ULf]=A.a.instance.ga(1998);E[v.a.SLf]=A.a.instance.ga(1999);E[v.a.TLf]=A.a.instance.ga(1977);E[v.a.mnd]=A.a.instance.ga(1983);E[v.a.lwe]=A.a.instance.ga(1663);E[v.a.E4j]=A.a.instance.Ta(25);E[v.a.nmg]=this.K1d;return E}gta(){const E={};E[r.a.it]=this.kc;E[v.a.n_a]=this.Y2();return E}ig(){this.Ob=1;this.initializeAndShow(this.el,this.Acj,this.gta())}}Object(t.a)(x,"PasswordProtectedFilePasswordInputDialog",v.a,[]);var n=a(60),u=a(29),z=a(250),w=a(52);
class C extends x{constructor(E){super(E);this.wOd=5;this.Fbe=!1;this.passwordToModify=null;this.VLf=()=>{this.$.isEditMode&&this.Lic&&(w.b().e$c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.pl(this.VLf))};this.ig();this.$.Lk(this.VLf)}get Lic(){return this.Fbe}get el(){return A.a.instance.ga(1981)}xbb(E,M){super.xbb(E,M);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${E}`)}tUa(E,M){this.passwordToModify=
E;const L={};L.FileModifyPassword=f.a.hf(E);n.M(this.$.oa.xa,L,this.G0i(M),this.F0i(M),null,null)}Y2(){const E=super.Y2();E[v.a.mnd]=A.a.instance.ga(1984);E[v.a.description]=A.a.instance.Ta(24);return E}ig(){w.b().e$c("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.ig()}G0i(E){return M=>{u.a.dh(M.Errors,[-2019873242])&&this.Q7b(this.qsb());if(!M||z.a(M))if(0<this.wOd)this.oRf(E);
else{e.ULS.sendTraceTag(537154754,0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${u.a.nc(M.Errors)}`);this.$.ea.Sn(M.Errors);this.hide();return}this.Fbe=M.Result;this.Lic&&(w.b().xWd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
E(this.Lic?0:1)}}F0i(E){return()=>{0<this.wOd?this.oRf(E):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),E(3))}}oRf(E){--this.wOd;this.tUa(this.passwordToModify,E)}qsb(){return u.a.ed(1,0,1662,1663,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(t.a)(C,"PasswordProtectedFileModifyPasswordInputDialog",x,[]);var y=a(6);class B extends l{constructor(E,M,L){super(E,M,L)}zsb(E){this.MFd=
new C(E);super.zsb(E)}yHb(E,M){const L=E.utb,N=E.Lic,Y=E.passwordToModify;super.yHb(E,M);this.executionContext.Zxa([2001366804]);switch(L){case 1:N?(M=Object(d.a)(6,this.executionContext.Ce),this.executionContext.activityState[m.a.boe]=f.a.hf(Y),this.executionContext.activityState[m.a.BYa]=!0,E.passwordToModify="",this.gh(M.isEditMode?y.a.xj:this.sJ)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.hp();break;case 0:this.executionContext.activityState[m.a.Jr]=!1;this.gh(this.AJ);this.hp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${L}'`)}}}Object(t.a)(B,"PasswordProtectedFileModifyActivity",l,[]);class H extends b.a{constructor(E,M,L,N){super();this.activityName=E;this.sJ=M;this.AJ=L;this.$=N;this.Db()}create(){this.nb(new B(this.activityName,this.sJ,this.AJ))}static ka(E){E.da.Ha(434,new H(y.a.xHb,
y.a.Hfb,y.a.srb,E))}}Object(t.a)(H,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var I=a(45);class R extends x{constructor(E,M){super(E);this.password=null;this.Gnf=M;this.ig()}tUa(E,M){this.password=E;M(0)}Y2(){const E=super.Y2();this.Gnf&&(E[v.a.lth]=1);return E}ig(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.Gnf}`);super.ig();I.a(this.$).rse()}}Object(t.a)(R,"PasswordProtectedFileOpenPasswordInputDialog",
x,[]);class S extends l{constructor(E,M,L){super(E,M,L)}zsb(E){const M=u.a.dh(this.executionContext.errors,[1217361942]);this.MFd=new R(E,M);E.Kgc||E.ULe();super.zsb(E)}yHb(E,M){let L,N;L=E.password;E.password="";N=E.utb;super.yHb(E,M);this.executionContext.activityState[m.a.gWc]=f.a.hf(L);this.executionContext.activityState[m.a.BYa]=!0;this.executionContext.Zxa([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${N}`);
switch(N){case 1:this.gh(this.sJ);this.hp();break;case 0:this.gh(this.AJ),this.hp()}}}Object(t.a)(S,"PasswordProtectedFileOpenActivity",l,[]);class G extends b.a{constructor(E,M,L,N){super();this.activityName=E;this.sJ=M;this.AJ=L;this.$=N;this.Db()}create(){this.nb(new S(this.activityName,this.sJ,this.AJ))}static ka(E){E.da.Ha(386,new G(y.a.orc,y.a.xj,y.a.Kj,E))}}Object(t.a)(G,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(F,"a",function(){return D});const D=()=>{c.a.Fa(G.ka);c.a.Fa(H.ka)}},
1216:function(t,F,a){t=a(0);var c=a(136);class b extends c.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Kz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[331]);var e=a(1075),f=a(1072),d=a(15),h=a(85),m=a(4),l=a(256),v=a(40),r=a(25);class A extends c.StandardDialog{constructor(S,G,D){super();this.Ma=S;this.I1=G;this.hX=D;this.Yw=!1;this.Ob=1;this.k0(1);
this.tc(1,CommonUIStrings.l_SignIn);this.tc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}MP(){this.I1.NYa(Object(h.a)(this,this.IIf,"onSignIn"));this.Wl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.Cii,"inputHandler"))}Cii(S){0===S?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.p6()}j3g(){let S="2";if(this.hX)switch(this.hX.Oj){case 3:S="0";break;case 2:S="3";break;case 1:S="1"}return S}hide(){this.I1.DJb(Object(h.a)(this,
this.IIf,"onSignIn"));super.hide()}p6(){var S=m.AFrameworkApplication.fa.pa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";S=new l.QueryStringBuilder(S);S.$i("prompt","1");S.$i("cbcxt",this.j3g());m.AFrameworkApplication.EYa(S);v.a.gf(S.toString(),"LoginWindow",void 0,"SignInDialog")}IIf(){this.Nn&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ma.processAction(r.a.saveToCloudStorage,2)}}Object(t.a)(A,
"SignInDialog",c.StandardDialog,[344]);class x{constructor(S,G,D){this.Ma=S;this.I1=G;this.hX=D}create(){return new A(this.Ma,this.I1,this.hX)}}Object(t.a)(x,"SignInDialogFactory",null,[328]);var n=a(79),u=a(30);class z{constructor(S,G,D,E,M,L,N){this.BFa=S;this.bA=G;this.UVa=D;this.LTb=E;this.nRc=M;this.qfa=L;this.zh=N}execute(S,G){if(!m.AFrameworkApplication.rg&&m.AFrameworkApplication.Bd){var D=this.BFa+this.qfa;D=n.a.wl(D,"fo",u.a.hf(this.LTb));D=n.a.wl(D,"fn",u.a.hf(this.bA));D=n.a.wl(D,"qs",
u.a.hf(this.nRc));D=n.a.wl(D,"n",u.a.hf((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(D=n.a.wl(D,"furl",u.a.hf(this.zh.FileDownloadUrl)));this.UVa&&(D=n.a.wl(D,"fnn",u.a.hf(this.UVa)));m.AFrameworkApplication.Bd.Im(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,G,null)}}}Object(t.a)(z,"SkyDriveUploadCaller",null,[343]);class w{constructor(S){this.mb=S;this.CFa=S.appSettings.SkyDriveUploadWebServiceBase;this.bA=S.appSettings.FileName;this.qfa=S.Wa("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(S,G,D){return new z(this.CFa,this.bA,G,S,m.AFrameworkApplication.ti,this.qfa,D)}}Object(t.a)(w,"SkydriveUploadCallerFactory",null,[327]);var C=a(1073),y=a(252),B=a(560),H=a(794);class I{constructor(){this.$a=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.fa.pa("SaveToCloudStorageUIIsEnabled")&&this.$a.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ag()}dispose(){}Ah(S){this.$a=S;this.$a.register(x,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").yc(()=>
new x(m.AFrameworkApplication.rb,B.a.instance,m.AFrameworkApplication.ra.Qa)).qc();this.$a.register(w,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").yc(()=>new w(m.AFrameworkApplication.fa)).qc();this.$a.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").yc(()=>new f.a(S.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.ra.ED)).qc();this.$a.register(C.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").yc(()=>new C.a(S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new H.a).create(),()=>new b,m.AFrameworkApplication.ra,m.AFrameworkApplication.ra.ED)).qc();this.$a.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").yc(()=>new e.a(S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),B.a.instance,S.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.C2a,()=>new b)).qc()}static main(){y.a.instance.gi(new I)}}Object(t.a)(I,"PackageManager",null,[4,5]);a.d(F,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");I.main()}},1217:function(t,F,a){t=a(0);var c=a(85),b=a(15),e=a(4),f=a(54),d=a(422),h=a(83);class m{constructor(C,y,B,H){this.fPc=null;this.WSb=H;this.GX=C;this.HX=y;this.MD=B;this.Uje=this.quf.xFj;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.dAg=C[0];this.cAg=C[1]}get quf(){return this.fPc||(this.fPc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Zva(){return CommonUIStrings.l_OICErrorHelpLink}get izc(){return this.Uje}get suf(){return this.dAg}get ruf(){return this.cAg}get puf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Uje?3:2}get vub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get O4b(){return!!this.HX}get wub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get el(){return CommonUIStrings.l_DefaultDialogTitle}uJd(C){this.wFb(C)}Ivd(C){this.wFb(C)}wFb(C){let y=
10;this.HX&&1===C&&(this.HX(this.MD),y=1);this.GX&&this.GX(this.MD);this.AF(y)}HOa(){d.Redirect.showHelp("OICFailure");this.AF(2)}PBd(){this.quf.Ppf();this.AF(4)}AF(C){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.WSb,C);e.AFrameworkApplication.mvc(f.a.CKf,this.WSb,C)}dispose(){this.MD=this.GX=this.HX=null}}Object(t.a)(m,"AOICErrorDialog",null,[2]);var l=a(46),v=a(136);class r extends m{constructor(C,y,B,H){super(C,y,B,H);this.Fqa=this.hm=null;C=
document.createElement("span");C.id="errorMessageText";C.innerText=this.errorMessage;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.hm=document.createElement("a");this.hm.href="#";this.hm.innerText=this.Zva;C.appendChild(this.hm);l.a.addHandler(this.hm,"click",Object(c.a)(this,this.HOa,"oicErrorHelpLinkHandler"));y=new v.StandardDialog;y.pe=this.id;this.izc?(B=document.createElement("span"),H=document.createElement("span"),B.innerText=this.suf,H.innerText=
this.ruf,this.Fqa=document.createElement("a"),this.Fqa.href="#",this.Fqa.innerText=this.puf,C.appendChild(document.createElement("br")),C.appendChild(B),C.appendChild(this.Fqa),C.appendChild(H),l.a.addHandler(this.Fqa,"click",Object(c.a)(this,this.PBd,"oicErrorMacOfferLinkHandler"))):this.O4b&&(C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),B=document.createElement("span"),B.innerText=this.vub,C.appendChild(B));this.O4b?(y.Ob=1,y.tc(1,this.wub)):y.Ob=0;y.Wl(this.el,
null,this.icon,Object(c.a)(this,this.Ivd,"legacyOICErrorDialogHandler"),C);y.AW("errorMessageText")}dispose(){this.hm&&(l.a.removeHandler(this.hm,"click",Object(c.a)(this,this.HOa,"oicErrorHelpLinkHandler")),this.hm=null);this.Fqa&&(l.a.removeHandler(this.Fqa,"click",Object(c.a)(this,this.PBd,"oicErrorMacOfferLinkHandler")),this.Fqa=null);super.dispose()}}Object(t.a)(r,"OICErrorDialog",m,[]);class A{constructor(C,y,B){this.GX=y;this.HX=C;this.MD=B}get id(){return"OICErrorDialogWithDownload"}get wQe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Zva(){return CommonUIStrings.l_OICErrorHelpLink}get vub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get wub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get el(){return CommonUIStrings.l_DefaultDialogTitle}uJd(C){this.wFb(C)}Ivd(C){this.wFb(C)}wFb(C){let y=
10;1===C&&(this.HX(this.MD),y=1);this.GX&&this.GX(this.MD);this.AF(y)}HOa(){d.Redirect.showHelp("OICFailure");this.AF(2)}AF(C){e.AFrameworkApplication.mvc(f.a.DKf,3,C)}dispose(){this.MD=this.HX=this.GX=null}}Object(t.a)(A,"AOICErrorDialogWithDownload",null,[2]);class x extends A{constructor(C,y,B){super(C,y,B);this.hm=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.wQe;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.hm=document.createElement("a");
this.hm.href="#";this.hm.innerText=this.Zva;C.appendChild(this.hm);l.a.addHandler(this.hm,"click",Object(c.a)(this,this.HOa,"oicErrorHelpLinkHandler"));C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));y=document.createElement("span");y.innerText=this.vub;C.appendChild(y);y=new v.StandardDialog;y.pe=this.id;y.Ob=1;y.tc(1,this.wub);y.Wl(this.el,null,this.icon,Object(c.a)(this,this.Ivd,"legacyOICErrorDialogHandler"),C);y.AW("errorMessageText")}dispose(){this.hm&&
(l.a.removeHandler(this.hm,"click",Object(c.a)(this,this.HOa,"oicErrorHelpLinkHandler")),this.hm=null);super.dispose()}}Object(t.a)(x,"OICErrorDialogWithDownload",A,[]);var n=a(150);class u extends m{constructor(C,y,B,H){super(C,y,B,H);y={["errorMessage"]:this.errorMessage};y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Zva,["onExecute"]:I=>{this.HOa(I)}};this.izc?(y.macOfficePreLinkText=this.suf,y.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.puf,
["onExecute"]:I=>{this.PBd(I)}},y.macOfficePostText=this.ruf):this.O4b&&(y.errorFileDownloadOffer=this.vub);C=new n.a(!1,!1,!0);this.O4b?(C.Ob=1,C.tc(1,this.wub)):C.Ob=0;C.pe=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};C.initializeAndShow(this.el,Object(c.a)(this,this.uJd,"reactOICErrorDialogHandler"),y)}}Object(t.a)(u,"ReactOICErrorDialog",m,[]);class z extends A{constructor(C,y,B){super(C,y,B);y={["errorMessage"]:this.wQe,["errorFileDownloadOffer"]:this.vub};y.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Zva,["onExecute"]:H=>{this.HOa(H)}};C=new n.a(!1,!1,!0);C.Ob=1;C.tc(1,this.wub);C.pe=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};C.initializeAndShow(this.el,Object(c.a)(this,this.uJd,"reactOICErrorDialogHandler"),y)}}Object(t.a)(z,"ReactOICErrorDialogWithDownload",A,[]);a.d(F,"a",function(){return w});class w{constructor(){this.Xjb=!!e.AFrameworkApplication.ra&&e.AFrameworkApplication.ra.Qa.sv}Oeh(C,y,B){this.Xjb?
new u(C,y,null,B):new r(C,y,null,B)}Peh(C,y,B){this.Xjb?new z(C,y,B):new x(C,y,B)}Qeh(C,y,B,H,I){const {ReactOICErrorDialogWithTrial:R}=a(1363),{OICErrorDialogWithTrial:S}=a(1364);this.Xjb?new R(C,y,B,null,H,I):new S(C,y,B,null,H,I)}static get instance(){return w.La||(w.La=new w)}}w.La=null;Object(t.a)(w,"OICErrorDialogFactory",null,[297])},1236:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=a(21),f=a(41),d=a(1),h=a(15),m=a(30),l;(function(H){H[H.url=0]="url";H[H.ref=1]="ref";H[H.mailto=2]="mailto"})(l||
(l={}));Object(t.b)("HyperlinkSelectionState",l);var v=a(781),r=a(8),A=a(589),x=a(60),n=a(90),u=a(13);class z extends v.a{constructor(H,I,R){super(H);this.ynb=0;this.zAb=!1;this.U1a=null;this.gMe=!1;this.dsb=!0;this.el=this.PVc=null;this.AAd=0;this.yAd=this.BAd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.rdi=(S,G)=>{1===S||2===S?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===S?"OK":"Remove"} pressed`),this.BAd=G[z.Kzi],this.AAd=G[z.guj],this.yAd=G[z.Fnh],2===S&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.l4j=(S,G)=>0!==G&&S.length?1===G?this.A2e(f.y(S,this.ea.va)||this.FJi(S),759):this.A2e(m.a.jqd(S),761):null;this.selectedRange=I;this.IL=R;this.ea=H.ea;this.sheetName=I.SheetName;this.RLa();this.Yp();this.Ob=this.zAb?9:1;this.tc(1,u.a.instance.ga(4));this.zAb&&(h.ULS.sendTraceTag(509690183,0,50,"Edit HyperLink was called."),this.tc(2,u.a.instance.ga(762)));this.initializeAndShow(this.el,this.rdi,{[z.it]:this.kc,
[z.m4j]:this.l4j,[z.qWg]:{[z.Qmh]:this.gMe,[z.Gnh]:this.U1a,[z.sHg]:this.ynb,[z.tHg]:this.PVc,[z.fah]:this.dsb}})}get kc(){return"HyperLinkDialog"}p4e(H,I){switch(I){case 2:return H.startsWith("mailto:")?H:"mailto:"+H;case 1:return`${r.a.BNf}${this.XXh(H)}`;default:return H}}get GB(){return 526}DG(){const H=this.$;this.location=this.p4e(this.BAd,this.AAd);try{this.location=n.a.kf(this.location)}catch(S){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,
50,`Committing ${l[this.AAd]} link`);this.cellValue=this.yAd.length?this.yAd:this.BAd;H.my();const I=H.oa.xa.Wb(),R=f.s(this.selectedRange);return(S,G,D)=>x.b(H.oa.xa,R,this.cellValue,this.location,this.removeHyperLink,!1,123,S,G,D,this.IL.range,I)}Vj(){const H=f.s(this.selectedRange);return()=>new A.a(H,this.cellValue,this.location)}EEh(){let H=this.IL.cell.H5a;this.IL.cell.Rva?H&&H.startsWith("mailto:")?(this.ynb=2,H=H.substr(7)):this.ynb=0:this.ynb=1;return H}RLa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.zAb=this.IL.Yaa:this.zAb=!!this.IL.EKa(64)||!!this.IL.EKa(128)}Yp(){if(this.zAb){this.U1a=this.IL.text;const H=this.EEh();H&&(this.PVc=H);this.el=u.a.instance.ga(826);this.dsb=this.PVc===this.U1a}else this.IL.text?(this.U1a=this.IL.text,this.dsb=!1):(this.U1a="",this.dsb=!0),this.ynb=0,this.el=u.a.instance.ga(825);this.IL.OA&&(this.dsb=!1,this.gMe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.U1a=this.IL.formulaBarText))}FJi(H){return this.ea.yb.Gk(H)}A2e(H,
I){return H?null:u.a.instance.ga(I)}XXh(H){let I,R;({sheetName:I,range:R}=f.Y(H,this.ea.va)).returnValue&&R&&(H=f.x(R,I||this.sheetName,!1));return H}}z.m4j="validateLinkValues";z.qWg="bodyProps";z.Qmh="disableDisplayText";z.Gnh="displayTextValue";z.sHg="activeLinkOption";z.tHg="activeLinkValue";z.fah="copyLinkValueToDisplay";z.Kzi="linkValue";z.guj="selectedLink";z.Fnh="displayText";Object(t.a)(z,"HyperlinkDialog",v.a,[]);var w=a(55);class C{constructor(H,I){this.$=H;this.gridView=I}Hc(){return!1}wc(H,
I){return 1===H&&-1583422759===I.command}Mc(){return!1}executeCommand(){this.FIj();return w.Task.Ra(!0)}FIj(){const H=f.v(this.gridView.ha.qa.ld,this.$),I=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Us([this.gridView.ha.qa.ld],!0))&&I&&new z(this.$,H,I)}}Object(t.a)(C,"ShowHyperlinkCommandHandler",null,[221]);class y extends b.a{constructor(H){super(H)}hd(){this.$c([new C(this.$,e.h(this.$))])}static ka(H){b.a.Ld(105,
new y(H))}}Object(t.a)(y,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return B});const B=()=>{c.a.Fa(y.ka)}},1237:function(t,F,a){var c=a(9);t=a(0);var b=a(4),e=a(108),f=a(709),d=a(60),h=a(50),m=a(37),l=a(15),v=a(188),r=a(25),A=a(55);class x{constructor(y,B){this.$=y;this.hh=B}Hc(){return!1}executeCommand(y,B,H){y=2;switch(B.command){case -309686558:y=this.hh.Wd(r.a.saveACopy,2,H);break;case 617689800:y=this.hh.Wd(r.a.saveToCloudStorage,2,H);break;case -1244760097:y=this.hh.Wd(r.a.saveToSharePoint,
2,H)}return 2===y&&B?v.a(B.command):A.Task.Ra(!0)}wc(y,B){y=!1;switch(B.command){case -1244760097:case -309686558:case 617689800:y=!0,l.ULS.shipAssertTag(537153984,0,this.$.Bka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return y}Mc(){return!1}}Object(t.a)(x,"SaveToHostCommandHandler",null,[221]);class n extends f.a{constructor(y){super(y);this.rJh=(B,H,I,R,S)=>1===I?32:B===r.a.rRa&&2===I?(B=this.$.oa.xa.Wb(),d.C(this.$.oa.xa,S[0],S[1],null,null,B),32):8}hd(){m.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Xa),()=>{this.$c([new x(this.$,b.AFrameworkApplication.rb)])},this.la,3);b.AFrameworkApplication.rb.Nb(r.a.rRa,e.a.frame,this.rJh)}static ka(y){f.a.Ld(267,new n(y))}}Object(t.a)(n,"SaveToHostCommandHandlerFactory",f.a,[]);var u=a(226);class z{constructor(y,B){this.$=y;this.hh=B;this.$.da.Ha(393,this)}Hc(y){switch(y){case -309686558:return 8===this.hh.processAction(r.a.saveACopy,1,null);case 617689800:return 8===this.hh.Wd(r.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.hh.Wd(r.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(t.a)(z,"SaveToHostManager",null,[231,2]);class w extends u.a{constructor(y){super();this.$=y;this.Db()}create(){this.nb(this.$.da.Aa(393)||new z(this.$,b.AFrameworkApplication.rb))}static ka(y){y.da.Ha(394,new w(y))}}Object(t.a)(w,"SaveToHostManagerFactory",u.a,[]);a.d(F,"a",function(){return C});const C=()=>{c.a.Fa(n.ka);c.a.Fa(w.ka)}},1238:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(15),f=a(84),d=a(118),h=a(29),
m=a(36);class l extends d.a{constructor(G,D){super(G,D)}execute(G){const D=Object(f.a)(6,G.Ce);e.ULS.shipAssertTag(537153921,0,h.a.bpb(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.VH(!0,!0);G.activityState[m.a.KZb]=D.ea.sessionId;G.activityState[m.a.Bnb]=!0;G.activityState[m.a.QZb]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(t.a)(l,"SessionReloadActivity",d.a,
[]);var v=a(6);class r extends b.a{constructor(){super();this.Db()}create(){this.nb(new l(v.a.odb,v.a.Ry))}static ka(G){G.da.Ha(142,new r)}}Object(t.a)(r,"SessionReloadActivityFactory",b.a,[]);var A=a(59),x=a(270),n=a(114),u=a(48),z=a(44),w=a(35),C=a(1),y=a(42),B=a(249),H=a(119);class I extends d.a{constructor(G,D,E,M,L){super(G,D);I.dyd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];I.cyd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
I.kuf=[-1468309555,611268539,-1750576502,61029505];I.juf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.Yzc=E;this.qKj=M;this.ITj=L}execute(G){var D=Object(f.a)(6,G.Ce);G.activityState[m.a.Hra]=!0;var E=I.q3h(G);if(I.lEj(G,E))return I.mGi(G),E=50,0<G.errors.length&&(E=15),e.ULS.sendTraceTag(537153891,0,E,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.nc(G.errors)}`),G.activityState[m.a.Hra]=!1,this.gh(v.a.idle),
3;switch(E){case 1:case 3:this.wii(G,E);break;case 2:this.vii(G);break;case 0:G.activityState[m.a.CYa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${E}. activityName:${this.activityName}. NextActivityName:${this.p_}. TimeFromLastStatefulResponse:${D.ea.QW}.`);var M=w.a.lg(G.activityState,H.a.Lfb);e.ULS.shipAssertTag(40502925,0,!M||M&&(1===E||3===E),`triggerSilentReloadAfterTokenRefresh: ${M}, silentReloadType: ${E}`);D=D.Uk.reloadCount;return 0!==E&&
0<D?(M=x.a.NKa(D,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${E}] retryNum [${D}] delayInMs [${M}] activityName [${this.activityName}]`),u.a.instance.create(()=>{I.gM(G)},M,z.a.nwj),1):3}wii(G,D){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const E=Object(f.a)(6,G.Ce);G.activityState[m.a.Bnb]=!0;E.Kgc||y.PageLoadTrackingInfo.instance.Ij("ReopenOnLoad");!I.isEditMode(G)&&h.a.bpb(G.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[m.a.KZb]=E.ea.sessionId,G.activityState[m.a.QZb]=!0);G.wyd();3===D?(E.ea.Bf()||E.ea.KLi(),E.VH(!0,!0),this.gh(this.ITj),G.activityState[m.a.Sne]=E.workbookContext.CalcMode):(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===D&&E.VH(!0,!0),G.activityState[m.a.ZVc]=!1,this.gh(this.Yzc))}vii(G){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[m.a.CYa]=null;G.wyd();this.gh(this.qKj);G=Object(f.a)(6,G.Ce);G.Kgc||(y.PageLoadTrackingInfo.instance.Ij("RefreshOnLoad"),G.eKb())}static gM(G){G.gM()}static q3h(G){const D=Object(f.a)(6,G.Ce),E=D.ea,M=I.isEditMode(G);var L=h.a.dh(G.errors,M?I.cyd:I.dyd);const N=h.a.dh(G.errors,M?I.juf:I.kuf),Y=D.PM,U=D.Uk.reloadCount,P=D.ya.MaxConsecutiveSilentReloadAllowed,aa=D.Uk.Yaf(),X=h.a.nc(G.errors),Z=h.a.nc(G.sza),
da=0<h.a.uM(wa=>!wa.triggerSilentReopenOnly,G.errors).length;let qa=L;const O=w.a.lg(G.activityState,H.a.Lfb);O&&(qa=!0);const ca={name:"SessionReloadSilentActivity.GetSilentReloadType"};ca.editMode=M;ca.isSilentReopenError=L;ca.isSilentRefreshError=N;ca.reloadSequenceCount=D.Uk.tQa;ca.reloadCount=U;ca.maxReloads=P;ca.stopSilentReloads=aa;ca.errorNames=X;ca.processedErrorNames=Z;ca.isClientDirty=Y;ca.errorsForSilentReopenOnly=da;ca.triggerSilentReloadAfterTokenRefresh=O;ca.IsReopenDisabled=D.TMa;
L=A.a.Dc(ca);e.ULS.sendTraceTag(21837004,0,50,L);if(!aa){if(qa&&(M?I.bEj(G):I.eEj(G)))return B.a.N7f(G,D)?3:D.TMa?2:1;if(N&&(M||!E.Ebb))return 2}return 0}static lEj(G,D){for(const E of G.errors)if(-1337545025===E.MessageId||-238814601===E.MessageId)return!1;return h.a.uM(E=>!E.triggerSilentReopenOnly,G.errors).length?3!==D:!1}static mGi(G){const D=h.a.uM(E=>!E.triggerSilentReopenOnly,G.errors);for(const E of D)G.eca(E)}static isEditMode(G){const D=Object(f.a)(6,G.Ce);return D.ea.Xb?D.ut&&!!(D.qd&
64):w.a.lg(G.activityState,m.a.Jr)}static eEj(G){const D=Object(f.a)(6,G.Ce),E=h.a.D3(G.errors,I.dyd);if(n.b(E,M=>M.ForceVersionUpgrade))return!1;G=h.a.bpb(G.errors);return!D.ea.Ebb||G?!0:!1}static bEj(G){G=h.a.D3(G.errors,I.cyd);return!n.b(G,D=>D.ForceVersionUpgrade)}}I.dyd=null;I.cyd=null;I.kuf=null;I.juf=null;Object(t.a)(I,"SessionReloadSilentActivity",d.a,[]);class R extends b.a{constructor(G,D){super();this.activityName=G;this.sJ=D;this.Db()}create(){this.nb(new I(this.activityName,this.sJ,v.a.Ry,
v.a.Ei,v.a.gPb))}static ka(G){G.da.Ha(143,new R(v.a.xna,v.a.A1b));G.da.Ha(144,new R(v.a.Exc,v.a.qPa));G.da.Ha(145,new R(v.a.Fxc,v.a.TEd));G.da.Ha(154,new R(v.a.pdb,v.a.yO))}}Object(t.a)(R,"SessionReloadSilentActivityFactory",b.a,[]);a.d(F,"a",function(){return S});const S=()=>{c.a.Fa(G=>{r.ka(G);R.ka(G)})}},1249:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(15),f=a(84),d=a(245),h=a(320),m=a(29),l=a(13),v=a(384),r=a(90);class A extends v.a{constructor(C,y){super(C,y);this.Ppa=0;this.zr()}get kc(){return"SharedWorkbookDialog"}get utb(){return this.Ppa}gO(C,
y){this.Ppa=C;super.gO(C,y)}zr(){super.zr();this.Ob=9;const C=this.PXh();this.tc(1,l.a.instance.ga(1661));this.tc(2,l.a.instance.ga(992));this.Wl(l.a.instance.ga(701),r.a.kf(C),this.icon,this.m7)}PXh(){return String.format(l.a.instance.ga(702))}}Object(t.a)(A,"LegacySharedWorkbookDialog",v.a,[]);var x=a(6),n=a(36);class u extends d.a{constructor(C,y,B){super(C,y);this.executionContext=null;this.szi=H=>{const I=this.Ds.gd,R=Object(f.a)(6,I.Ce);let S;S=H.utb;this.unsubscribe(G=>{H.remove_disposing(G)});
for(let G=0,D=I.errors.length;G<D;G++)-573864504===I.errors[G].MessageId&&I.eca(I.errors[G]);switch(S){case 1:R.ea.VCc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.gh(R.isEditMode?x.a.gPb:this.$jh);this.hp();break;case 2:this.gh(x.a.openInExcelClient);this.hp();break;case 0:I.activityState[n.a.Jr]=!1,this.gh(this.AJ),this.hp()}};this.$jh=y;this.AJ=B}initialize(C){super.initialize(C)}execute(C){this.executionContext=
C;this.w5c();return 1}uI(C){super.uI(C)}w5c(){const C=Object(f.a)(6,this.executionContext.Ce),y=m.a.x_a([-573864504]);y[0].HelpDescription=l.a.instance.ga(704);y[0].HelpTopicId=h.a.tzi;const B=new A(C,y[0]);this.subscribe(this.executionContext,this.szi,H=>{B.add_disposing(H)})}}Object(t.a)(u,"LegacySharedWorkbookActivity",d.a,[]);class z extends b.a{constructor(C,y,B,H){super();this.activityName=C;this.sJ=y;this.AJ=B;this.$=H;this.Db()}create(){this.nb(new u(this.activityName,this.sJ,this.AJ))}static ka(C){C.da.Ha(460,
new z(x.a.iDb,x.a.Hfb,C.hCb?x.a.Kj:x.a.srb,C))}}Object(t.a)(z,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(F,"a",function(){return w});const w=()=>{c.a.Fa(z.ka)}},1272:function(t,F,a){function c(y){const B=f(y);let H=[];if(0===B&&1===y.length)return H.push({destination:y[0],source:null,Yic:!1}),H;for(let I=0;I<=B;I++){const R=y.filter(S=>S.mja().topLeft.Y===I);for(let S=0;S+1<R.length;S+=1)H.push({destination:R[S],source:R[S+1],Yic:!1})}A.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${H.length}`);
return H}function b(y,B){let H;const I=v.HelperMethods.ZQ(()=>{H=gridRenderer.CanvasRendererGlobals.hideRowCols(y,B,!1)});d("HideRowCols",I);return H}function e(y,B,H,I){y=gridRenderer.CanvasRendererGlobals.performModelCascade(y,B,H,I);y.metric&&d("ModelCascade",y.metric.o9j);return y}function f(y){let B=-1;for(let H=0;H<y.length;H++){const I=y[H].mja().topLeft.Y;I>B&&(B=I)}return B}function d(y,B){A.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${y} is time=${B}`)}
var h=a(9);t=a(0);var m=a(226),l=a(21),v=a(11),r=a(174),A=a(15),x=a(1),n=a(61);class u{constructor(y){this.$=y;this.gridView=l.h(this.$);this.Ca=this.gridView.Ca;this.tBb=!1;this.JJe=this.$.ea.se;this.zKb={};this.t4={}}dispose(){this.gridView=this.$=null;this.t4={};this.tBb=!1;this.zKb={}}oUg(y){if(this.tBb)A.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${y}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);
else{var B=this.Ca.wPh(),H=c(B);this.t4={};this.aqi(y,B,H)&&(this.tBb=!0,this.mPf(y,!1,H,B))}}aqi(y,B,H){var I=this.gridView;if(-706918724!==y||I.rtl)return!1;var R=I.Mj("GridInstantaneousAction");if(!Object(n.c)(R))return A.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;I=I.ha.qa.selectedRanges;const S=I.length;if(1<S)return A.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = SelectedRanges, value=${S}, reason = Discontinuous selection, isRow=false`),
!1;if(R.value.nBb(I[0]))return A.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;R=I[0].right-I[0].left+1;if(R>x.EwaSettings.xGi())return A.ULS.sendTraceTag(509658005,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = ColumnCount, value=${R}, reason = Multiple columns selected, isRow=false`),!1;B=B.length;if(B>x.EwaSettings.wGi())return A.ULS.sendTraceTag(509658004,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = BlocksInViewport, value=${B}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(G of H){if(!G||!G.source||!G.destination){A.ULS.sendTraceTag(509649925,0,50,"GridInstantaneousAction.canRowColCascade: blockPair or sourceBlock or destinationBlock is null");var G=!1;break a}B=G.source.Td.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColCascade(B,B.ColumnNumbers[0],!1)){G=!1;break a}}G=
!0}if(!G)return A.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;I=I[0];G=0;for(let D of H)if(D.destination.Je.zd(I)||D.destination.Je.left>I.right)G+=1;H=G;if(H>x.EwaSettings.AGi())return A.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = TransitionCount, value=${H}, reason = Transition count limit exceeded, isRow=false`),
!1;A.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${y}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}mPf(y,B,H,I){try{const R=v.HelperMethods.Kb(),S=x.EwaSettings.zGi();let G=H.filter(D=>!D.Yic);for(let D of G){if(this.Vme("WebServiceResponseReceivedInProcessGridAction",I,y))return;const E=this.gridView.ha.qa.selectedRanges[0],M=D.destination.Je.right;if(M<
E.left){D.Yic=!0;A.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${y}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${E.left}, blockRangeRightMostValue=${M}, hashCode=${D.destination.Xc}, isRow=false`);continue}const L=B?E.topLeft.top:E.topLeft.left,N=this.J0e("SourceModel",D.source),Y=this.J0e("DestinationModel",D.destination),U=D.destination.Xc;if(D.destination.Je.zd(E)){if(!b(Y,L)){this.Bra();A.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${y}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${U}, isRow=${B}, rowColNumber=${L}`);
return}A.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${y}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${U}, isRow=${B}, rowColNumber=${L}`)}const P=N.ColumnNumbers[0],aa=D.source.Xc;if(e(N,Y,P,B).isSuccess)D.Yic=!0,A.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${y}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${aa}, isRow=${B}, rowColNumber=${P}`);
else{this.Bra();A.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${y}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${aa}, isRow=${B}, rowColNumber=${P}`);return}this.sOj(Y,N,D);if(v.HelperMethods.Kb()-R>S){this.Msj(y,B,G,I);return}}this.u7g(B,y,I);d("ProcessGridAction",v.HelperMethods.Kb()-R)}catch(R){this.n9h(R)}}u7g(y,B,H){if(!this.Vme("CommitGridInstantaneousActionResults",H,B)){var I=v.HelperMethods.Kb();
if(this.t4&&0!==Object.keys(this.t4).length)if(this.R5i(H),this.Wqg(B,H)){var R=r.a.create().toString(),S=this.gridView.Mj("GridInstantaneousAction");Object(n.c)(S)?(S.value.E0d(this.gridView.ha.qa.selectedRanges,0,y),B=Object.keys(this.t4),this.Ca.nQf(B,R,y?"row":"column",!0),this.tBb=!1,d("CommitGridInstantaneousActionResults",v.HelperMethods.Kb()-I)):(this.IZf(H),this.Bra(),A.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${B}, parameter = ActiveSheetProcessedData, value=null, isRow=${y}`))}else this.IZf(H),
this.Bra();else this.Bra(),A.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${B}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${y}`)}}J0e(y,B){let H=this.t4[B.Xc];if(!H){const I=v.HelperMethods.ZQ(()=>{H=B.cRh()});d(y,I)}return H}R5i(y){for(let B of y)y=B.Xc,this.zKb[y]||(this.zKb[y]=B.F6e())}IZf(y){for(let B of y){y=B.Xc;const H=this.zKb[y];if(H&&!B.GXf(H)){A.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${y}`);
this.Bra();break}}}Wqg(y,B){for(let H of B)if(B=H.Xc,this.t4[B]&&!H.GXf(this.t4[B]))return A.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${y}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${B}, isRow=false`),!1;return!0}Msj(y,B,H,I){window.setTimeout(()=>{this.mPf(y,B,H,I)},0)}Gvi(y){for(let B of y)if(B.Td.Information.Revision>this.JJe)return!0;return!1}Vme(y,B,H){return this.Gvi(B)?(this.JJe=this.$.ea.se,
this.Bra(),A.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${H}, parameter = ${y}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Bra(){this.t4={};this.tBb=!1;this.zKb={}}n9h(y){this.Bra();A.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${y}.`)}sOj(y,B,H){this.t4[H.destination.Xc]=y;this.t4[H.source.Xc]=B}}Object(t.a)(u,"GridInstantaneousAction",
null,[334]);var z=a(712);class w extends m.a{constructor(y){super();this.$=y;this.Db()}create(){this.nb(Object(z.a)(this.$.da,528,()=>new u(this.$)))}static ka(y){y.da.Ha(529,new w(y))}}Object(t.a)(w,"GridInstantaneousActionFactory",m.a,[]);a.d(F,"a",function(){return C});const C=()=>{h.a.Fa(y=>{w.ka(y)})}},1273:function(t,F,a){t=a(0);var c=a(1311),b=a(1312),e=a(4);class f{constructor(){this.d8d=this.$a=null}get name(){return"Common.App.DirectPrint"}Ah(m){this.$a=m;m.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").qc().yc(()=>
new c.a(e.AFrameworkApplication.ra.OW));m.register(223,"Common.App.DirectPrint.IDirectPrintManager").qc().yc(()=>b.a.create(this.$a))}init(){this.d8d=this.$a.resolve("Common.App.DirectPrint.IDirectPrintManager");this.d8d.start()}dispose(){}}Object(t.a)(f,"PackageManager",null,[4,5]);var d=a(252);a.d(F,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.gi(new f)}},1286:function(t,F,a){t=a(0);var c=a(15),b=a(4),e=a(89),f=a(134),d=a(265),h=a(27),m=a(38),
l=a(81),v;(function(P){P[P.unableToRefreshLock=0]="unableToRefreshLock";P[P.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";P[P.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";P[P.workbookTooLarge=3]="workbookTooLarge";P[P.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";P[P.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";P[P.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";P[P.unsupportedFeatures=7]="unsupportedFeatures";
P[P.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";P[P.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";P[P.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";P[P.lastGenericStatusError=11]="lastGenericStatusError";P[P.scratchPadWarning=12]="scratchPadWarning";P[P.authenticationLost=13]="authenticationLost";P[P.odfCompatibilityIssues=14]="odfCompatibilityIssues";P[P.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";
P[P.workbookIsIrmProtected=16]="workbookIsIrmProtected";P[P.biFeatureNotAvailable=17]="biFeatureNotAvailable";P[P.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";P[P.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";P[P.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";P[P.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";P[P.editAttemptInReadOnly=22]="editAttemptInReadOnly";P[P.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";
P[P.unsupportedBrowser=24]="unsupportedBrowser";P[P.readOnlyPermissions=25]="readOnlyPermissions";P[P.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";P[P.policyWarningMessage=27]="policyWarningMessage";P[P.workingOnIt=28]="workingOnIt";P[P.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";P[P.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";P[P.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";P[P.legacySharedWorkbookEditWarningBB=
32]="legacySharedWorkbookEditWarningBB";P[P.legacyConnectionsBB=33]="legacyConnectionsBB";P[P.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";P[P.groupedSlicersBB=35]="groupedSlicersBB";P[P.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";P[P.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";P[P.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";P[P.wacGdprNotice=39]="wacGdprNotice";P[P.automaticSensitivityLabel=40]="automaticSensitivityLabel";
P[P.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";P[P.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";P[P.localStorageDisabled=43]="localStorageDisabled";P[P.autoRefreshDisabled=44]="autoRefreshDisabled";P[P.corruptedFileRepaired=45]="corruptedFileRepaired";P[P.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";P[P.minorVersionLimitReached=47]="minorVersionLimitReached";P[P.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";P[P.sensitivityApplicationTooLargeFileError=
49]="sensitivityApplicationTooLargeFileError";P[P.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";P[P.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";P[P.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";P[P.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";P[P.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";
P[P.promptEnableExternalLinks=55]="promptEnableExternalLinks";P[P.networkDown=56]="networkDown";P[P.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";P[P.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";P[P.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";P[P.canvasHealth=60]="canvasHealth";P[P.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";P[P.optimizeWorkbook=62]="optimizeWorkbook";P[P.novModePostDepreciation=63]="novModePostDepreciation";
P[P.officeScriptsRunning=64]="officeScriptsRunning";P[P.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";P[P.readOnlyPivotTable=66]="readOnlyPivotTable";P[P.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";P[P.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";P[P.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";P[P.count=70]="count"})(v||(v={}));Object(t.b)("EwaBusinessBarEntryType",v);var r=a(5),A=a(1078);
class x extends Sys.EventArgs{constructor(P,aa,X=null){super();this.B_a=P;this.K8c=aa;this.data=X}}Object(t.a)(x,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var n=a(1080),u=a(1079),z=a(1082);a(1081);var w=a(1076),C=a(475),y=a(50),B=a(37),H=a(654),I=a(29),R=a(1),S=a(22),G=a(21),D=a(58),E=a(73),M=a(853),L=a(33),N=a(39);a.d(F,"a",function(){return U});const Y=[55,39,5,30,16,14,7,41,4];class U extends l.a{constructor(P,aa){super();this.Pa=new m.a;this.nP=null;this.ZJc=[];this.uoc=()=>
{this.$.oa.gMa?this.removeEntry(13):this.ih(13,null)};this.eh=(X,Z)=>{for(let da=0,qa=U.Fdc().length;da<qa;da++)X=U.Fdc()[da],this.removeEntry(X);Z.context&&0<Z.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.omj()};this.wm=(X,Z)=>{var da;X=this.oGh(Z.errors);let qa=[];for(let ca=0,wa=X.length;ca<wa;++ca){const ia=
X[ca];if(1===ia.Type&&ia.Appearance&32)qa=this.P$h(ia,qa);else if(Z.awj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var O=(null===(da=Z.context)||void 0===da?0:da.stopwatch)?Z.context.stopwatch.Bc:-1;5E3>O?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${O}ms).`):b.AFrameworkApplication.tui()||
this.cLg(ia,Z.context.methodName)}O=[...U.Fdc()];for(let Ha=0,Sa=qa.length;Ha<Sa;++Ha){const Da=qa[Ha];this.ih(Da,ia);Array.remove(O,Da)}for(let Ha=0,Sa=O.length;Ha<Sa;++Ha)this.removeEntry(O[Ha])}};this.Rc=(X,Z)=>{this.uc(X,Z)};this.uc=()=>{const X=this.$.ea;X.Xb||X.Bf()||(this.aLd(),this.ZJc.length=0)};this.dd=(X,Z)=>{this.$.ea.Bf()&&!Z.iV||this.eef(Z.iV)};this.SGb=()=>{const X=this.$.userOperationManager.rdc();X&&X.operation.flags&1&&this.L9f()};this.NDf=()=>{this.L9f()};this.tf=()=>{this.HBe();
this.T9f()};this.rN=()=>{if(this.$.X4&&this.$.ea.Bf()&&this.$.ea.Xb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const X=this.$.da.Aa(331);X&&X.AJa||this.removeEntry(55);this.removeEntry(5)}};this.$=P;this.sZa=aa;this.CTg();b.AFrameworkApplication.Bd&&b.AFrameworkApplication.Bd.BWc(this);this.IFa=Array(70);for(let X=0;70>X;X++)this.IFa[X]=
null;this.uh=H.EcmaDateClock.instance;this.Fof=this.uh.Ub.getTime();aa&&(aa=P.oa,aa.ox(this.wm),aa.Xq(this.eh),aa.$nb(this.uoc),aa.NYa(this.uoc),P.ea.Jj(this.Rc),P.ea.$t(this.tf),P.Lk(this.dd),P.nj(this.uc),P.ea.e2(this.rN),P.userOperationManager.Lr(this.SGb),R.EwaSettings.sa(158)&&P.ea.wg.get(45)&&b.AFrameworkApplication.fa.pa("SupportsPolicies")||this.O$e(),this.eef(D.c(P)));P.da.Ha(5,this);L.a.Ijc()&&(this.$.CNb=this.Ali())}O$e(){I.a.oq(this.$.ea.pF)&&this.wm(this,new C.a(this.$.ea.pF,null,!1,
-1,-1,-1,-1,"",-1,"",-1))}HLg(P){this.Pa.addHandler("bBarAttachedOrDetached",P)}get L9c(){return this.ZJc}get domElement(){return this.nP?this.nP.domElement:null}dispose(){if(this.$){const P=this.$,aa=P.oa;aa.ky(this.wm);aa.ps(this.eh);aa.ruc(this.uoc);aa.DJb(this.uoc);P.ea.ik(this.Rc);P.ea.yv(this.tf);P.pl(this.dd);P.ol(this.uc);P.ea.D6(this.rN);P.userOperationManager.zo(this.SGb);G.h(P).Vb.nl(this.NDf)}e.a.Ja(this.nP);this.$=this.nP=null;super.dispose()}Ali(){for(let P=0;P<Y.length;P++)if(this.IFa[Y[P]])return!0;
return!1}bmi(P){switch(P){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:return!0;default:return!1}}ih(P,aa,X=null,Z=null,da=null){if(!this.$.isMobileMode||this.bmi(P))this.sZa&&!this.GG(P)&&(this.IFa[P]=this.uh.Gea,this.nP.dE(P,aa,Z,da),L.a.Ijc()&&this.pZj(P),this.Pa.raiseEvent("bBarAttachedOrDetached",new x(P,!0,X))),aa&&32===aa.Appearance&&E.a(this.$).gd.eca(aa)}uIj(P,aa,X,Z){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");w.a.initialize(P,aa,X,Z);this.ih(39,
null)}tHj(P,aa,X,Z){A.a.initialize(P,aa,X,Z);this.ih(40,null)}DJj(P,aa,X,Z){u.a.initialize(P,aa,X,Z);this.ih(41,null)}TIj(P,aa,X,Z){n.a.initialize(P,aa,X,Z);this.ih(42,null)}KJj(P,aa,X,Z){z.a.initialize(P,aa,X,Z);this.ih(54,null)}removeEntry(P){this.sZa&&(R.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(v,P)}`),this.IFa[P]=null,this.nP.removeEntry(P)&&this.Pa.raiseEvent("bBarAttachedOrDetached",
new x(P,!1)))}Eka(P){return this.sZa?this.nP.Eka(P):!1}GG(P){return this.sZa?this.nP.GG(P):!1}TEb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Cnc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}CTg(){const {BusinessBarControl:P}=a(1171);if(this.sZa&&!this.nP){G.h(this.$).Vb.xl(this.NDf);var aa=document.getElementById(this.$.Bb+
r.a.Jye);this.nP=new P(this.$,aa)}}aLd(){this.sZa&&this.nP.aLd()}pZj(P){0<=Y.indexOf(P)&&!this.$.CNb&&(this.$.CNb=!0,this.$.Wse&&this.iaj())}iaj(){try{const aa=f.a.get(r.a.xFd);if(S.a.lh(aa))c.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.nyc();else{var P=N.a(decodeURIComponent(aa));P.Options|=4096;try{const X=N.c(P);f.a.Av(r.a.xFd,X,d.AFrame.H0);c.ULS.sendTraceTag(509686989,
0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised")}catch(X){c.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${X.message}`)}}}catch(aa){c.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${aa.message}`)}}omj(){if(R.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const aa=
this.uh.Gea;if(3E5<=aa-this.Fof){this.Fof=aa;for(let X=0;70>X;X++){var P=this.IFa[X];if(P&&(P=aa-P,3E5<=P)){const Z=Enum.toString(v,X);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Z}] was activated but not turned off for ${P} Millis`)}}}}}oGh(P){const aa=[];for(const X of P)switch(X.MessageId){case -113742550:const Z=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||I.a.dh(P,Z))&&aa.push(-113742550)}return I.a.Dz(P,
aa)}P$h(P,aa){switch(P.MessageId){case 2113407564:const X=I.a.x_a([1821390342,-943219229,-502303485,1437034227]);for(let Z=0;Z<X.length;Z++)X[Z].HelpTopicId=P.HelpTopicId,X[Z].HelpDescription=P.HelpDescription,this.ZJc.push(X[Z])}switch(P.MessageId){case -395951567:this.ih(6,P);break;case 1643490758:this.ih(4,P);break;case -907264831:this.ih(5,P);break;case 757111532:case 2113407564:this.ih(7,P);break;case 2010656511:this.ih(15,P);break;case 1321660996:this.$.t7c=!0;this.ih(8,P);break;case 526339737:this.$.t7c=
!0;this.ih(9,P);break;case -407088521:this.ih(10,P);break;case 1756116017:this.ih(14,P);break;case -1703455218:this.ih(17,P);break;case 1393475740:this.ih(25,P);break;case -949523941:this.ih(26,P);break;case 1779381952:this.ih(44,P);break;case 1421575100:this.ih(45,P);break;case 613676060:this.ih(46,P);break;case 1233668252:this.ih(61,P);break;case 1911608588:P=!!(this.$.qd&64);!this.$.ea.Bf()&&P&&aa.push(29);break;case 1544494907:break;case -655555355:aa.push(this.Atd()?1:0);break;case -1221382671:aa.push(2);
break;case 1662282929:aa.push(3);break;case 104919273:this.$.ea.Bf()||aa.push(30);break;case -689453604:P=!!(this.$.qd&64);this.$.ea.abf=!0;!this.$.ea.Bf()&&P&&aa.push(31);break;case 157762400:this.$.ea.kic=!0;!this.$.ea.Bf()&&this.$.qd&64&&!this.$.isEditMode&&aa.push(32);break;case -1125398042:R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Bf()&&this.$.qd&64&&!this.$.isEditMode&&aa.push(34);break;case -73730134:!this.$.ea.Bf()&&this.$.qd&
64&&aa.push(33);break;case -293349236:aa.push(65);break;case 1580811823:aa.push(67);break;case -37299333:break;case 136737622:aa.push(47);break;case -1780327030:this.ih(55,P);break;case -113742550:this.ih(57,P);break;case -260312420:this.$.ea.Bf()||aa.push(66);break;default:this.ih(11,P)}return aa}egi(){if(b.AFrameworkApplication.fa.pa("WildFireExcelBizBar")&&!M.a.mrd(M.a.$ed(1))&&(h.a.Zo||h.a.Hg)){const P=y.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);B.TaskExtensions.za(P,()=>{this.ih(20,
null)},this.la,3)}}wfi(P){P||3!==this.$.workbookContext.WorkbookNovType||this.ih(63,null)}eef(P){(!P&&!this.$.printingEnabled||this.$.Xd.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.ih(16,null));this.egi();this.HBe();this.T9f();this.wfi(P)}HBe(){this.$.workbookContext.Options&32768&&this.jIj()}jIj(){this.IFa[37]||this.ih(37,null)}kKj(){this.IFa[38]||this.ih(38,null)}T9f(){this.$.workbookContext.Options&
524288&&this.ih(59,null)}p$f(P,aa){this.ih(58,P,null,aa)}fpe(P,aa=null){this.nP.GG(P)?this.nP.JPb(P,aa):this.ih(P,null,null,null,aa)}L9f(){this.$.qd&8&&this.ih(12,null)}Atd(){const P=this.$.da.Aa(38);return P?P.tokenExpired:!1}cLg(P,aa){if(!this.GG(21)&&-1387426400!==P.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const X={};X.FailedMethod=aa;this.ih(21,P,X)}}static Fdc(){return U.Hse||(U.Hse=[0,1,2,3])}cfd(P){return this.nP.cfd(P)}}
U.Hse=null;Object(t.a)(U,"BusinessBarManager",l.a,[691,2,67])},1298:function(t,F,a){t=a(0);var c=a(226),b=a(1286);class e extends c.a{constructor(h){super();this.$=h;this.Db()}create(){this.nb(this.$.da.Aa(5)||new b.a(this.$,!this.$.gba))}static ka(h){h.da.Ha(4,new e(h))}}Object(t.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(F,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1310:function(t,F,a){t=a(0);var c=a(15),b=a(85),e=a(869),f=a(853),d=a(1230);class h{constructor(){this.cHc=
new d.a;this.aHc=new d.a;this.$Gc=new d.a;this.qXg(this.cHc);this.pXg(this.aHc);this.oXg(this.$Gc);this.dMc=new d.a;this.cMc=new d.a;this.bMc=new d.a;this.PZg(this.dMc);this.OZg(this.cMc);this.NZg(this.bMc);this.sIc=new d.a;this.JXg(this.sIc);this.RFa(this.sIc);this.RFa(this.$Gc);this.RFa(this.aHc);this.RFa(this.cHc);this.RFa(this.cMc);this.RFa(this.dMc);this.RFa(this.bMc)}W3h(A,x){switch(A){case 1:return this.n7h(x);case 2:return this.AOh(x)}return f.a.vzc?this.sIc:null}qXg(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);
A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}pXg(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}oXg(A){A.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}PZg(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);A.add("OverlayBig","Get the Word app");A.add("OverlaySmall",
"Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover Word");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")}JXg(A){A.add("Headline","Get the Office Online extension for Chrome");A.add("UseAppButton","Get the extension");A.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}OZg(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);A.add("OverlayBig","Get the PowerPoint app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover PowerPoint");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")}NZg(A){A.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}RFa(A){A.add("Corporation","Microsoft Corporation")}n7h(A){switch(A){case 3:return this.dMc;case 2:return this.cMc;case 1:return this.bMc}return null}AOh(A){switch(A){case 3:return this.cHc;
case 2:return this.aHc;case 1:return this.$Gc}return null}static get instance(){h.La||(h.La=new h);return h.La}}h.La=null;Object(t.a)(h,"WildFireStringFactory",null,[]);var m=a(4),l=a(40),v=a(27);a.d(F,"a",function(){return r});class r{constructor(A,x,n,u,z=null,w=null){this.rQc=null;this._id=A;this.$Qc=x;this.ixg=z;this.Rjb=u;this.bmb=w;this.npa=null;this.jYa=n;this.ymb=h.instance.W3h(x,A)}n5c(){this.npa=new e.a(this.title,this.message,null);this.npa.addButton(this.Sye,Object(b.a)(this,this.gAf,
"onButtonOneClick"),"");this.jYa&&this.npa.mKg(this.Uye,Object(b.a)(this,this.jAf,"onButtonTwoClick"));this.npa.s$=Object(b.a)(this,this.uMe,"dismissBar");this.npa.image=3;this.npa.id=16;this.npa.closeable=!0}get title(){return this.ymb.ma("Headline")}get message(){return this.ymb.ma("CallToAction")}get B2j(){return this.jYa}get Sye(){return this.jYa?this.ymb.ma("InstallButton"):this.ymb.ma("UseAppButton")}get Uye(){return this.jYa?this.ymb.ma("OpenAppButton"):""}gAf(){this.jYa?this.cji():this.r2j()}jAf(){this.jYa&&
this.t1i()}get SZg(){return this.npa}get openUrl(){this.rQc||(this.rQc=this.ixg());return this.rQc}cji(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Rjb&&this.bmb&&this.bmb();f.a.cTf(this._id,this.$Qc)}t1i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Rjb&&this.bmb&&this.bmb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Kte(this._id),this.openUrl,0,!1))}r2j(){f.a.vzc?this.VZg():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),f.a.sSd("BizBarClicked"),1!==this.$Qc&&2!==this.$Qc||f.a.q5g(this.openUrl,this.Rjb,this._id,this.bmb))}VZg(){this.Rjb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");l.a.AU(m.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}enh(){this.Rjb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.sSd(f.a.eCe)}uMe(){f.a.vzc?
this.enh():(f.a.sSd(f.a.$ed(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static $5b(){const A=m.AFrameworkApplication.ra.Qa,x=new r(A.Oj,f.a.Ddc(),8<v.a.I5a,1===A.pca,()=>A.yx,A.x0f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return x}}Object(t.a)(r,"WildFireBusinessBar",null,[])},1311:function(t,F,a){t=a(0);var c=a(15),b=a(85),e=a(136),f=a(4),d=a(14),h=a(97),m=a(46),l=a(184),v=a(1096),r=a(88),A=a(57),x=a(79),n=a(956);class u extends e.StandardDialog{constructor(w,
C,y,B=null){super();this.ZO=this.im=this.aqa=null;this.$m=[];this.gWb=C;this.VO=w;this.Cxg=y;this.tXb=B;this.xmb=new n.a("LoadResource","LoadPrintablePdf")}MP(){this.Ob=5;this.width=40;const w=document.createElement("span");w.id=this.Dh("DirectPrintHeaderContent");const C=document.createElement("span");C.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(C,"DirectPrintHeader");this.ZO=document.createElement("iframe");this.ZO.name="pdfObjectFrame";this.ZO.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.ZO.onload=Object(b.a)(this,this.G8i,"printablePdfLoaded");if(this.tXb&&0<this.tXb.count){var y=x.a.Qhd(this.gWb,this.tXb);const B=x.a.yLd(this.gWb,this.tXb);this.im=document.createElement("form");this.im.id="printPreviewPostForm";this.im.method="POST";this.im.target=this.ZO.name;this.im.action=B;for(let H of y)y=document.createElement("input"),y.type="hidden",y.name=H.key,y.value=H.value,this.im.appendChild(y)}else this.ZO.setAttribute("src",this.gWb);Sys.UI.DomElement.addCssClass(this.ZO,l.a.ufe);
this.Cxg?(Sys.UI.DomElement.addCssClass(this.ZO,"DirectPrintPdfObjectHidden"),C.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,r.a.nh(this.ZO,r.a.dC,r.a.Uj)):(Sys.UI.DomElement.addCssClass(this.ZO,"DirectPrintPdfObject"),this.$m.push(this.ZO));w.appendChild(C);w.appendChild(document.createElement("br"));w.appendChild(this.ZO);this.im&&w.appendChild(this.im);w.appendChild(document.createElement("br"));w.appendChild(this.a9g(this.im?"#":this.gWb));this.xmb.start();this.rEb(CommonUIStrings.l_AppTitle,
null,null,null,null,w);this.AW(this.Dh("DirectPrintHeaderContent"));this.im&&this.im.submit();this.cdh();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}a9g(w){const C=document.createElement("span");var y=document.createElement("span");y.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;C.appendChild(y);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.ra.Qa.Oj&&f.AFrameworkApplication.fa.pa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ra.Qa.Oj&&
f.AFrameworkApplication.fa.pa("XLODisableDirectPrintDialogOpenPDFLink"))?(w=document.createElement("span"),2===f.AFrameworkApplication.ra.Qa.Oj?w.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ra.Qa.Oj&&(w.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.aqa=w,C.appendChild(document.createElement("br")),C.appendChild(w)):(y=document.createElement("a"),y.innerText=
CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,y.href=w,y.target="_blank",y.id="PrintPDFLink",y.className="AllowBrowserClick",this.aqa=y,C.appendChild(document.createElement("br")),C.appendChild(y),this.im&&m.a.addHandler(y,"click",Object(b.a)(this,this.rqc,"onSubmit")),this.VO.ta(d.a.click,this.aqa,Object(b.a)(this,this.ENe,"downloadPDFLinkClicked"),null));this.$m.push(this.aqa);return C}rqc(w){this.im&&(this.im.target="_blank",this.im.submit());w.preventDefault()}cdh(){if(0<this.$m.length){const w=
new v.a(this.$m),C=h.FocusManager.instance().gQ();C&&(this.aqa.focus(),C.ef=w,C.d_=!0)}}ENe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}uwd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}G8i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.xmb&&this.xmb.stop()}dispose(){this.aqa&&(this.VO.Ba(d.a.click,this.aqa,Object(b.a)(this,this.ENe,"downloadPDFLinkClicked")),this.aqa=null);
A.a.R_(this.ZO);this.ZO=null;super.dispose()}}Object(t.a)(u,"DirectPrintDialog",e.StandardDialog,[262]);a.d(F,"a",function(){return z});class z{constructor(w){this.VO=w}qTh(w,C){return new u(this.VO,w,C,null)}}Object(t.a)(z,"DirectPrintDialogFactory",null,[224])},1312:function(t,F,a){t=a(0);var c=a(15),b=a(551),e=a(85),f=a(1367),d=a(1097);class h{constructor(x,n){this.Qcg=x;this.nTa=n}}Object(t.a)(h,"DirectPrintProbeResults",null,[]);var m=a(4),l=a(268),v=a(27),r=a(111);a.d(F,"a",function(){return A});
class A{constructor(x,n,u,z,w,C,y,B,H,I){this.OYb=null;this.yvg=x;this.Wkb=n;this.TPc=u;this.Iyg=z;this.nzg=w;this.jRc=new b.a(Object(e.a)(this,this.v0h,"getProbeResults"));this.DVa=C;this.lde=H;this.sEg=y;this.ozg=B;this.vzg=I}get BC(){return this.yvg}start(){}Q$i(){const x=Array(this.BC.mTa.length);if(void 0!==this.Wkb&&null!==this.Wkb)for(let n=0;n<this.BC.mTa.length;n++)x[n]=this.BC.mTa[n]in this.Wkb&&this.Iyg(this.Wkb[this.BC.mTa[n]]);return x}R$i(){const x=Array(this.BC.nTa.length),n=!(void 0===
this.TPc||null===this.TPc);for(let u=0;u<this.BC.nTa.length;u++){const z=this.BC.nTa[u];x[u]=n&&z in this.TPc?!0:this.nzg(z)}return x}j4h(){const x=this.Q$i(),n=Array(x.length);for(let u=0;u<x.length;u++)n[u]=x[u]?this.HEh(this.Wkb[this.BC.mTa[u]]):null;return n}HEh(x){if(void 0===x||null===x)return null;x=x.enabledPlugin;return void 0===x||null===x?null:x.name}v0h(){var x=this.j4h();const n=this.R$i(),u={},z={};for(let w=0;w<this.BC.mTa.length;w++)u[this.BC.mTa[w]]=x[w];for(x=0;x<this.BC.nTa.length;x++)z[this.BC.nTa[x]]=
n[x];return new h(u,z)}cHj(){return this.vzg||!this.BC.isEnabled||m.AFrameworkApplication.isUnifiedHostMode?!1:this.jPj()}Z8f(){if(null!=this.OYb)return this.OYb;const x=A.Yhf(this.BC);return this.OYb=this.BC.Zhf&&x||this.Bmi()}Bmi(){return v.a.$o&&this.BC.Dmi&&v.a.gCe>=this.BC.f4g?!0:!1}jPj(){if(!this.ozg(this.BC))return!1;var x=r.a.Fjd(this.jRc.value.Qcg);for(const n of x)if(void 0!==n&&null!==n)return!0;x=r.a.Fjd(this.jRc.value.nTa);for(const n of x)if(n)return!0;return!1}Tai(){const x=r.a.Fjd(this.jRc.value.Qcg);
for(const n of x)if(l.a.contains(this.BC.hei,n))return!0;return!1}rJj(x){m.AFrameworkApplication.ra&&m.AFrameworkApplication.fa.pa("DirectPrintDialogAsStandardDialogIsEnabled")?this.lde(x,null):this.cHj()?this.wnh(x,this.Tai()&&!0):this.lde(x,null)}wnh(x,n){const u=this.sEg.Gc("UserAction","OpenDirectPrintDialog");this.DVa.qTh(x,n).MP();u.stop()}static Emf(x){try{return new ActiveXObject(x),!0}catch(n){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",x)}return!1}static $hf(x){return void 0===
x||null===x?!1:!(void 0===x.enabledPlugin||null===x.enabledPlugin)}static create(x){const n=new d.a(m.AFrameworkApplication.fa.appSettings);let u=null;try{u=window.navigator.mimeTypes}catch(I){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let z=null;try{z=window.navigator.plugins}catch(I){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const w=A.$hf,C=A.Emf;x=x.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const y=m.AFrameworkApplication.ra.ED,
B=A.Fmf,H=!!m.AFrameworkApplication.ra&&m.AFrameworkApplication.ra.Qa.sv&&!m.AFrameworkApplication.fa.pa("PrintDialogFallbackLinkEnabled");return new A(n,u,z,w,C,x,y,B,(I,R)=>new f.a(I,!1,R,!0,H),m.AFrameworkApplication.z4)}static Fmf(x){return v.a.$o||v.a.rv&&x.dqi||x.Zhf&&A.Yhf(x)?!0:!1}static Yhf(x){var n=v.a.Ytb;if(n){var u=n.split(".");if(2===u.length)return n=parseInt(u[0]),u=parseInt(u[1]),n>x.ozd||n===x.ozd&&u>=x.Vvf}return!1}}Object(t.a)(A,"DirectPrintManager",null,[223])},1362:function(t,
F,a){a.d(F,"a",function(){return l});t=a(0);var c=a(85);F=a(136);var b=a(1085),e=a(265),f=a(4),d=a(14),h=a(79),m=a(27);class l extends F.StandardDialog{constructor(v,r=!0,A=!1,x=null,n=null,u=!1){super();this.$Va=this.ZVa=this.im=this.EX=null;var z=this.GYd?this.GYd:CommonUIStrings.l_DefaultDialogTitle;l.y5a=u;this.cTb=x||new b.a(v,!0);this.cTb.Vve(this);const w=[],C=[];l.Iu&&(this.XXc&&this.XXc.forEach(H=>{Array.add(w,H)}),this.$re&&this.$re.forEach(H=>{Array.add(C,H)}));r?A?(this.Ob=4,this.tc(1,
this.buttonText),this.tc(2,CommonUIStrings.l_DialogClose)):(this.Ob=6,this.tc(0,CommonUIStrings.l_DialogClose)):this.Ob=5;u=document.createElement("span");this.J6c&&(u.className=this.J6c);x=document.createElement("a");x.innerText=this.rlc;x.href=v;x.target="_blank";x.id=this.qlc;x.className=e.AFrame.Kse;var y=!m.a.WA&&!!n&&0<n.count;if(y){const H=h.a.Qhd(v,n);n=h.a.yLd(v,n);x.href="#";x.target="_self";this.im=document.createElement("form");this.im.id="printPreviewPostForm1";this.im.method="post";
this.im.target="_blank";this.im.action=n;for(var B of H)n=document.createElement("input"),n.type="hidden",n.name=B.key,n.value=B.value,this.im.appendChild(n)}else this.im=null;this.im||l.y5a?l.y5a||Array.add(C,{["type"]:"AppLinkProps",["id"]:this.qlc,["text"]:this.rlc,["onExecute"]:()=>{this.vRf()}}):Array.add(C,{["type"]:"AppLinkProps",["id"]:this.qlc,["text"]:this.rlc,["handler"]:{["href"]:y?"#":v,["target"]:y?"_self":"_blank"}});this.pOa&&Array.add(w,this.pOa);A?(v=document.createElement("span"),
v.innerText=this.pOa.replace("{0}",""),u.appendChild(v)):this.Lvf?(v=document.createElement("span"),v.id=this.Dh("message"),B=document.createElement("span"),n=document.createElement("span"),y=this.pOa.split("{0}"),B.innerText=y[0],n.innerText=y[1],v.appendChild(B),v.appendChild(x),v.appendChild(n),u.appendChild(v)):(v=document.createElement("span"),v.innerText=this.pOa,u.appendChild(v),u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br")),u.appendChild(x),l.y5a||
Array.add(w,"{0}"));this.im&&u.appendChild(this.im);l.Iu&&(this.M8a&&(this.eDb?this.Foe(this.M8a,this.eDb):(Array.add(w,"{0}"),Array.add(C,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.M8a,["onExecute"]:()=>{this.klc()}}))),this.Ira(w,C));this.rEb(z,null,this.ndf,null,Object(c.a)(this,this.iu,"dialogHandler"),l.Iu?null:u);this.AW(this.Dh("message"));!l.Iu&&this.eDb&&this.M8a&&(z=document.createElement("div"),z.className="WACDialogLearnMoreLinkContainer",this.EX=document.createElement("a"),
this.EX.innerText=this.M8a,this.EX.href=this.eDb,this.EX.target="_blank",this.EX.id=this.Dh("LearnMoreLinkId"),this.EX.className=e.AFrame.Kse,z.appendChild(this.EX),r?this.lb.insertBefore(z,this.lb.lastChild):this.lb.appendChild(z),this.AW(String.format("{0} {1}",this.Dh("message"),this.Dh("LearnMoreLinkId"))));this.Eib=x;A?this.iI(this.LB):this.iI(this.Eib);this.yrf();f.AFrameworkApplication.ra.OW.ta(d.a.click,this.Eib,Object(c.a)(this,this.CNe,"downloadLinkClicked"),null);this.EX&&f.AFrameworkApplication.ra.OW.ta(d.a.click,
this.EX,Object(c.a)(this,this.klc,"learnMoreLinkClicked"),null);this.bTb=!1}get ndf(){return null}get GYd(){return null}get pOa(){return null}get eDb(){return null}get M8a(){return null}get Lvf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get J6c(){return null}get XXc(){return null}get $re(){return null}xZc(){this.im&&(this.ZVa||(this.ZVa=Object(c.a)(this,this.eNi,"onActionButtonClicked"),this.Dy.ta(d.a.click,this.LB,this.ZVa)),this.$Va||(this.$Va=Object(c.a)(this,this.fNi,"onActionButtonKeyUp"),
this.Zd.ta(d.a.Kd,this.LB,this.$Va)));super.xZc()}eNi(v){this.UVe(v);return!0}fNi(v){return this.xof(v,Object(c.a)(this,this.UVe,"executeDismissActionButtonFromArgs"))}UVe(v){this.im&&this.im.submit();this.sua(v.Mb)}uwd(){}CNe(){this.Arf();this.im?this.im.submit():this.cTb.P8c();return!0}klc(){return!1}dispose(){this.cTb.dispose();this.Eib&&(f.AFrameworkApplication.ra.OW.Ba(d.a.click,this.Eib,Object(c.a)(this,this.CNe,"downloadLinkClicked")),this.Eib=null);this.EX&&(f.AFrameworkApplication.ra.OW.Ba(d.a.click,
this.EX,Object(c.a)(this,this.klc,"learnMoreLinkClicked")),this.EX=null);this.Dy&&this.ZVa&&(this.Dy.Ba(d.a.click,this.LB,this.ZVa),this.ZVa=null);this.Zd&&this.$Va&&(this.Zd.Ba(d.a.Kd,this.LB,this.$Va),this.$Va=null);super.dispose()}vRf(){this.im&&(document.body.appendChild(this.im),this.im.submit(),document.body.removeChild(this.im))}iu(v){1===v&&(this.uwd(),this.im?l.Iu&&this.vRf():this.cTb.P8c());this.dispose()}static get Iu(){return f.AFrameworkApplication.ra.Qa.sv&&f.AFrameworkApplication.ra.Qa.nlf}static get y5a(){return l.G$d}static set y5a(v){l.G$d=
v}}l.G$d=!1;Object(t.a)(l,"ADialogWithLinkToResource",F.StandardDialog,[])},1363:function(t,F,a){a.r(F);a.d(F,"ReactOICErrorDialogWithTrial",function(){return f});t=a(0);var c=a(85);F=a(1087);var b=a(422),e=a(150);class f extends F.a{constructor(d,h,m,l,v,r){super(d,h,m,l,v,r);h={["errorMessage"]:this.vQe,["offerString"]:this.Byf};d=new e.a(!1,!1,!0);this.M9f?(d.Ob=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Zva,["onExecute"]:()=>{b.Redirect.showHelp(this.Jbf)}}):(d.Ob=4,
d.tc(2,this.hdf));d.tc(1,this.gZb);d.pe=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.el,Object(c.a)(this,this.pcj,"reactOICErrorDialogWithTrialHandler"),h)}}Object(t.a)(f,"ReactOICErrorDialogWithTrial",F.a,[])},1364:function(t,F,a){a.r(F);a.d(F,"OICErrorDialogWithTrial",function(){return e});t=a(0);var c=a(85);F=a(1087);var b=a(136);class e extends F.a{constructor(f,d,h,m,l,v){super(f,d,h,m,l,v);f=document.createElement("span");f.innerText=this.vQe;
f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.Byf;f.appendChild(d);d=new b.StandardDialog;this.M9f?(d.Ob=1,d.Poe(this.Zva,this.Jbf)):(d.Ob=4,d.tc(2,this.hdf));d.tc(1,this.gZb);d.pe=this.id;d.Wl(this.el,null,this.icon,Object(c.a)(this,this.ozi,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(t.a)(e,"OICErrorDialogWithTrial",F.a,[])},1365:function(t,F,a){a.r(F);a.d(F,"CheckRoamingRightsRequest",function(){return c});
t=a(0);a=a(1088);class c extends a.a{constructor(){super()}yxb(){return 2}Iaa(){return 1}}Object(t.a)(c,"CheckRoamingRightsRequest",a.a,[])},1366:function(t,F,a){a.r(F);a.d(F,"GetRoamingLauncherRequest",function(){return c});t=a(0);a=a(1088);class c extends a.a{constructor(){super()}yxb(){return 0}Iaa(){return 2}}Object(t.a)(c,"GetRoamingLauncherRequest",a.a,[])},1367:function(t,F,a){a.d(F,"a",function(){return l});t=a(0);var c=a(15),b=a(1362),e=a(1085),f=a(4),d=a(88),h=a(79),m=a(27);class l extends b.a{constructor(v,
r,A=null,x=!0,n=!1){super(v,!0,!(l.VBa&&x),new e.a(v,r),A,n);l.VBa=l.VBa&&x;if(l.VBa){r=document.createElement("iframe");x=null;n=this.tmh;r.name="pdfObjectFrame";r.id="pdfObjectIFrame";if(A&&0<A.count){const u=h.a.Qhd(v,A);v=h.a.yLd(v,A);x=document.createElement("form");x.id="printPreviewPostForm";x.method="POST";x.target=r.name;x.action=v;for(let z of u)v=document.createElement("input"),v.type="hidden",v.name=z.key,v.value=z.value,x.appendChild(v)}else r.src=v;n.appendChild(r);x&&(n.appendChild(x),
x.submit());Sys.UI.DomElement.addCssClass(r,"DirectPrintPdfObjectHidden");d.a.nh(r,d.a.dC,d.a.Uj)}}get ndf(){return"Print_32x32x32"}get GYd(){return l.VBa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get pOa(){return l.VBa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get XXc(){const v=[];Array.add(v,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.y5a){let r=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ra.Qa.PJe&&(r=f.AFrameworkApplication.ra.Qa.PJe);
Array.add(v,r)}return l.VBa?v:null}get rlc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get qlc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get J6c(){return f.AFrameworkApplication.KLe?"UIFontDialogTextLarge":null}yrf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Arf(){f.AFrameworkApplication.Fn.uzb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}uwd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get VBa(){return!!f.AFrameworkApplication.ra&&
f.AFrameworkApplication.ra.Qa.sv&&f.AFrameworkApplication.fa.pa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(m.a.WA||m.a.rv||m.a.Cf||m.a.YMa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.pa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set VBa(v){}}Object(t.a)(l,"PrintDialogWithLinkToPdf",b.a,[])},1384:function(t,F,a){t=a(0);var c=a(85),b=a(39);class e{constructor(){this.classId=0}static DIa(l){try{return b.a(l)}catch(v){}return null}}Object(t.a)(e,"ARoamingAppsResponse",
null,[]);class f{constructor(){this.state=this.callback=null;this.yqd=!1}}Object(t.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(109);a.d(F,"a",function(){return m});class m{constructor(l){this.qIc=!1;this.xXa=m.Vfc;this.aSc=this.eQc=0;this.platform=null;this.RCg=l;this.hme=this.bSc=!1}get roamingAppsAreEnabled(){return this.RCg}get N2j(){return this.roamingAppsAreEnabled&&this.bSc?this.hme:!1}T3g(){d.AFrameworkApplication.Gic&&this.roamingAppsAreEnabled&&!this.bSc&&!this.qIc&&(this.aSc=
1,this.qIc=!0,this.noj(),this.RVe())}noj(){this.xXa=m.Vfc;this.eQc=0}getRoamingAppsLauncher(l,v,r){this.N2j?(l=new f,l.callback=v,l.state=r,l.yqd=!0,this.XVe(l)):v(!1,"",r)}RVe(){const l=new (a(1365).CheckRoamingRightsRequest);l.RoamingApp=this.aSc;l.BaseDocQuerySignature=d.AFrameworkApplication.ti;l.execute(Object(c.a)(this,this.V3g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.U3g,"checkUserRoamingRightsFailed"),null)}V3g(l){d.AFrameworkApplication.rg||((l=e.DIa(l.data.de))?this.uSd(l.HasRights):
this.uSd(!1))}U3g(){if(!d.AFrameworkApplication.rg)if(this.eQc>=m.YGi)this.uSd(!1);else{var l=new h.a(2,1,this.xXa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.hi.fg(l);this.eQc++;this.xXa*=m.Jpj;this.xXa>m.fvf&&(this.xXa=m.fvf)}}uSd(l){this.hme=l;this.bSc=!0;this.qIc=!1}retryCheckUserRoamingRights(){this.RVe()}XVe(l){const v=new (a(1366).GetRoamingLauncherRequest);v.RoamingApp=this.aSc;v.BaseDocQuerySignature=d.AFrameworkApplication.ti;
v.execute(Object(c.a)(this,this.Z1h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.Y1h,"getRoamingAppsLauncherFailed"),l)}Z1h(l){if(!d.AFrameworkApplication.rg){var v=e.DIa(l.data.de);l=l.data.state;v?(this.platform=v.Platform,l.callback(!0,v.Launcher,l.state)):l.callback(!1,"",l.state)}}Y1h(l){if(!d.AFrameworkApplication.rg){var v=l.data.state;5===l.data.status&&v.yqd?(v.yqd=!1,this.XVe(v)):v.callback(!1,"",v.state)}}static get instance(){return m.XB||(m.XB=new m(d.AFrameworkApplication.VSg))}}
m.Vfc=1E3;m.Jpj=5;m.fvf=12E5;m.YGi=5;m.XB=null;Object(t.a)(m,"RoamingAppsManager",null,[])},1459:function(t,F,a){a.r(F);var c={};a.r(c);a.d(c,"SheetOptionsToggleCommandHandler",function(){return ec});var b=a(1070),e=a(0),f=a(252);class d{get name(){return"Common.App.DialogWithLinkToResource"}Ah(){}init(){}dispose(){}static main(){f.a.instance.gi(new d)}}Object(e.a)(d,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var h=a(551),m=a(15),l=a(85),v=a(191),r=a(826),A=a(30),x=a(135);class n{static Nrh(tc){return n.Dye("New",
tc)}static Orh(tc){return n.Dye("Open",tc)}static nye(tc,Yc){return n.hha("LoadingMenuSection",n.LAi,tc,n.iqb("lblLoading",Yc))}static jqb(tc,Yc,fb=null,Hb=null){return n.hha("MessageMenuSection",n.swf,Yc,n.iqb("lblMessage",tc,fb,Hb))}static DYg(tc){return n.nye(tc,CommonUIStrings.l_VoicedLoadingText)}static EYg(tc,Yc){return n.jqb(CommonUIStrings.l_NewCreationLocationMessage,tc.ei,Yc.hR,Yc.eoa)}static CYg(tc,Yc){return n.jqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Yc.eoa,"\n\n"),
tc.ei)}static pye(tc){return n.jqb(CommonUIStrings.l_NewGenericErrorMessage,tc.ei)}static AYg(tc,Yc,fb){return n.hha("menuNewBlank",n.Cbi,fb?tc.ei:null,n.eqb(tc.tbf,tc.ubf,tc.vbf,null,tc.gka,tc.hzb,Yc,"blank"))}static AZg(){return n.iqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Aye(){return n.iqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static BZg(tc,Yc){return n.hha("menuNewTemplates",tc,null,Yc)}static yYg(tc,Yc){return n.hha("menuNewMoreTemplates",
n.lZe,null,n.eqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,tc,Yc))}static BXg(tc,Yc,fb){let Hb="";fb&&Yc&&(Hb=n.hha("BrowseMoreMenuSection",n.lZe,null,n.eqb("btnBrowseMore",Yc,Yc,null,null,null,tc||"1959943459",fb)));return Hb}static iqb(tc,Yc,fb=null,Hb=null){let cc=Hb;Yc&&0<Yc.length&&(cc=n.nxf.Frc(Yc).trimEnd(),cc=0<=cc.indexOf("{0}")?String.format(cc,Hb):String.format("{0} {1}",cc,Hb));fb=fb&&Hb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
A.a.Xe(fb),A.a.Xe(Hb),A.a.Xe(cc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',A.a.Xe(tc||""),n.nxf.Frc(A.a.Xe(Yc||"")),fb)}static eqb(tc,Yc,fb,Hb,cc,Hc,od,Dd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',A.a.Xe(tc||""),A.a.Xe(Yc||
""),A.a.Xe(fb||""),Hb||"32by32",A.a.Xe(cc||""),A.a.Xe(Hc||""),od,A.a.Xe(Dd||""))}static Dye(tc,Yc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',tc,Yc)}static hha(tc,Yc,fb,Hb){fb=fb?String.format('Title="{0}"',A.a.Xe(fb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
A.a.Xe(tc||""),A.a.Xe(Yc||""),fb,Hb)}}n.swf="MenuMru";n.LAi="MenuLoading";n.Cbi="MenuHeader";n.lZe="MenuFooter";n.nxf=x.a.Cx("\n","&#10;");Object(e.a)(n,"NewAndOpenXmlUtilities",null,[]);var u=a(4),z=a(99),w=a(145),C=a(146);class y{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(e.a)(y,"HostInformation",null,[]);var B=a(109),H=a(104),I=a(40),R=a(268),S=a(376),G=a(167),D=a(652),E=a(575),M=a(108),L=a(25);class N{constructor(tc,Yc,fb,Hb,cc,Hc){this.sYb=this.Go=this.URb=
null;this.QXb=this.nTc=!1;this.kee=0;this.bTc=this.ANc=!1;this.z1=tc;this.$ib=Yc;this.ODa=new h.a(()=>new r.a(fb.value,Object(l.a)(this,this.gxb,"getMoreInfoEventReceived")));this.uAg=Hb;this.Lqa=cc;this.IDg=Hc;this.pmb=this.tzc;2===this.sK.kca&&(this.bTc=!0);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.oFh()}get gP(){switch(this.sK.kca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}oFh(){H.a.instance.fg(new B.a(5,1,0,()=>{this.getTemplateListJson()}))}Ag(){const tc=this.sK.K9a;tc.Nb(L.a.newDocument,M.a.frame,Object(l.a)(this,this.newDocument,"newDocument"));tc.Nb(L.a.Zrc,M.a.frame,Object(l.a)(this,this.Zrc,"populateNewMenu"))}newDocument(tc,Yc,fb,Hb,cc){if(1===fb)return 32;if(2===fb&&cc){if(u.AFrameworkApplication.fa.pa("BackstagePremiumTemplateExperienceEnabled")&&cc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),
u.AFrameworkApplication.rb.processAction(L.a.v7i,2);if(cc.MenuItemId&&cc.SourceControlId)return"NewDocumentHome"===cc.SourceControlId&&w.a("NewDocumentFromHomeTab"),this.c1a(cc.MenuItemId,cc.SourceControlId)}return 8}c1a(tc,Yc){var fb=this.Fnc.a6c;if(null===fb)return 8;var Hb=u.AFrameworkApplication.fa.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(u.AFrameworkApplication.Hba&&Hb){m.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const cc={};cc[S.a.$dg]=tc;cc[S.a.gP]=this.gP;cc[S.a.lcid]=u.AFrameworkApplication.lcid.toString();cc[S.a.reason]=D.a.createNew;u.AFrameworkApplication.nQ().execute(Hc=>{Hc.jj(G.a.c1a,cc)})}else Hb=(new Date).getTime(),Yc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",fb,A.a.hf(this.Ila),A.a.hf(tc),A.a.hf(this.gP),A.a.hf(u.AFrameworkApplication.lcid.toString()),A.a.hf(Hb.toString()),A.a.hf(Yc),A.a.hf(u.AFrameworkApplication.canary),
u.AFrameworkApplication.ti),(fb=u.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==fb&&(Yc+="&wdscenarioid="+A.a.hf(fb)),Yc+="&"+u.AFrameworkApplication.gdc(),u.AFrameworkApplication.Twa&&(Yc+="&"+u.AFrameworkApplication.Acc()),(fb=this.Go?this.Go.hR:null)&&(Yc+="&DestinationUrl="+A.a.hf(fb)),I.a.gf(Yc,"_blank",void 0,"CreateNewDocument");2===this.sK.kca&&m.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:E.a[this.sK.kca],["Template"]:tc});return 32}aEi(tc){let Yc=
Number.MAX_VALUE,fb=Number.MIN_VALUE;const Hb=window.performance;if(Hb&&"undefined"!==typeof Hb.getEntriesByName){for(let Hc=0;Hc<tc.length;Hc++){var cc=Hb.getEntriesByName(tc[Hc]);cc&&0<cc.length&&(cc=cc[0],Yc=Math.min(parseInt(String(cc.fetchStart)),Yc),fb=Math.max(parseInt(String(cc.responseEnd)),fb))}fb>Yc&&m.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:fb-Yc,["MinFetchStart"]:Yc,["MaxResponseEnd"]:fb})}}Zrc(tc,Yc,fb,Hb,cc){if(1===fb)return this.bTc&&
(u.AFrameworkApplication.fN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.bTc=!1),32;2!==fb||this.ANc||(this.kee=(new Date).getTime(),m.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.tzc,["CachedNewMenuXmlExists"]:!!this.URb,["ShouldCallGetMoreInfo"]:this.sK.supportsGetMoreInfoForPersonalStorage}));u.AFrameworkApplication.ola("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");return this.m6i(cc)}m6i(tc){tc&&
(this.URb?tc.PopulationXML=this.URb:(this.sK.supportsGetMoreInfoForPersonalStorage&&!this.Go&&this.EKi.rZ("Opened New menu",!0),tc.PopulationXML=this.qNh(this.getTemplateListJson())));return 32}slf(){return!this.sK.supportsGetMoreInfoForPersonalStorage||!!this.Go&&3===this.Go.state&&!!this.Go.eoa&&!!this.Go.hR}Gsi(){return u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.Qa.RZ?!0:this.slf()}getTemplateListJson(){if(!this.tzc||!this.Gsi())return null;if(this.pmb&&!this.QXb){var tc="9";u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(tc="21");const Yc=u.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Yc&&(tc=Yc.NumberOfTemplatesInBackstage);let fb=this.gP;"TemplateCollectionId"in Yc&&(fb=Yc.TemplateCollectionId);tc=String.format(this.sK.o_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",A.a.hf(u.AFrameworkApplication.lcid.toString()),A.a.hf(fb),tc);Boolean.parse(Yc.AppendOriginQueryParam||
"false")&&(tc+="&org=backstage");Boolean.parse(Yc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in Yc&&(tc+="&templateTier="+Yc.TemplateTier);tc+="&"+u.AFrameworkApplication.gdc();u.AFrameworkApplication.Twa&&(tc+="&"+u.AFrameworkApplication.Acc());this.sK.UEb.Im(tc,1,null,null,!1,2,Hb=>{this.sK.WNa("CreateNewActor.GetTemplateListJson",Hb.data);this.RQj(Hb.data.de)},Hb=>{this.sK.WNa("CreateNewActor.GetTemplateListJson",Hb.data);this.QQj()},null,void 0,void 0,void 0,void 0,"5");
this.pmb=!1}return this.sYb}RQj(tc){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.sYb=this.rGh(tc):this.sYb=tc;this.pmb=!1;this.VIb();if(u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.Qa.RZ&&C.c()){tc=u.AFrameworkApplication.fa.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Yc=u.AFrameworkApplication.Hba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.sYb,
!0,tc&&Yc))}}QQj(){this.QXb=this.pmb=!0;this.VIb();u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.Qa.RZ&&C.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));z.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}rGh(tc){tc=JSON.parse(tc);const Yc=new v.a;Yc.add("TM00002102");Yc.add("TM00002101");Yc.add("TM16392939");const fb=R.a.x2d(tc,Hb=>Yc.contains(Hb.AssetId));tc=tc.slice(0,9);tc.splice.apply(tc,[2,0].concat(fb));
return JSON.stringify(tc)}R4h(tc){var Yc=0;for(var fb=0;fb<tc.length;fb++)if("ST"===tc[fb].ImageType){Yc=fb;break}const Hb=tc.length?tc[Yc]:null;tc=Hb?Hb.Url||"":"";var cc;let Hc=fb=Yc=!1;if(Hb&&(cc=Hb.AspectRatio))cc=parseFloat(cc),1>cc?Yc=!0:1.5<cc?fb=!0:1===cc&&(Hc=!0);else switch(m.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:tc}),this.sK.kca){case 3:Yc=!0;break;case 2:fb=!0;break;case 5:Hc=!0}return{returnValue:tc,bei:Yc?"95by123":fb?"123by69":Hc?"100by100":"123by95"}}qNh(tc){tc=
({Yyc:Yc}=this.BYg(tc,this.Fnc,this.Fnc.VGa||"1056925771")).returnValue;if(Yc){this.URb=tc;var Yc=(new Date).getTime()-this.kee;m.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:Yc})}return tc}gxb(tc,Yc){m.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Go||3!==tc.state?2===tc.state&&(m.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.nTc=!0,this.VIb()):(this.Go=tc,Yc||this.VIb(),
u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.Qa.RZ&&C.c()&&C.d("setFileMenuHostInformation")&&(tc=Object.assign(new y,{hostUrl:this.Go.hR,hostName:this.Go.eoa,folderUrl:u.AFrameworkApplication.breadcrumbFolderUrl,folderName:u.AFrameworkApplication.breadcrumbFolderName}),m.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(tc))))}BYg(tc,Yc,fb){let Hb;Hb=!1;const cc=this.slf();let Hc="";this.sK.supportsGetMoreInfoForPersonalStorage&&
(this.nTc?(Hc=n.pye(Yc),this.nTc=!1,m.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Go?cc?Hc=n.EYg(Yc,this.Go):this.Go.lji?(Hb=!0,this.pmb=!1,Hc=n.CYg(Yc,this.Go),m.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Hb=!0,Hc=n.pye(Yc),m.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Go.hR,
["StorageServiceDisplayNameIsSet"]:!!this.Go.eoa})):(Hc=n.DYg(Yc.ei),m.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));cc&&(Hc+=n.AYg(Yc,fb,!Hc)+({Yyc:Hb}=this.zZg(tc,fb)).returnValue);return{returnValue:n.Nrh(Hc),Yyc:Hb}}zZg(tc,Yc){let fb;fb=!1;if(!this.tzc)return fb=!0,m.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Yyc:fb};let Hb="",cc="",Hc="MenuTemplate";if(this.QXb)Hb=n.Aye(),this.QXb=!1,m.ULS.sendTraceTag(5849610,
202,10,"Rendering File>New with template error message");else if(tc){try{const od=Sys.Serialization.JavaScriptSerializer.deserialize(tc,!0);Hb=this.yZg(od,Yc);m.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");u.AFrameworkApplication.oxf&&"OneDrive"===this.Ila&&(cc=n.yYg(this.FKi,u.AFrameworkApplication.oxf))}catch(od){m.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:tc}),Hb=n.Aye()}fb=!0}else Hc="MenuLoading",
Hb=n.AZg(),m.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:n.BZg(Hc,Hb)+cc,Yyc:fb}}yZg(tc,Yc){let fb="";const Hb=[];for(let Hc=0;Hc<tc.length;Hc++){var cc=tc[Hc];let od="";if(cc){const Dd=cc.Title,be=cc.AssetId;cc=cc.Thumbnails;be&&Dd&&cc&&({bei:cc,returnValue:od}=this.R4h(cc),fb+=n.eqb("jbtnNewTemplate"+Hc,Dd,null,cc,null,od,Yc,be))}Hb[Hc]=od}tc=new B.a(4,1,5E3,()=>{this.aEi(Hb)},106);this.sK.Dnc.fg(tc);return fb}VIb(){this.ANc=!0;this.sK.gxf.Vw(this.Fnc.zvb);
this.ANc=!1}get sK(){return this.z1.value}get Fnc(){return this.$ib.value}get EKi(){return this.ODa.value}get FKi(){return this.uAg.value}get Ila(){return this.Lqa.value}get tzc(){return this.IDg.value}}Object(e.a)(N,"CreateNewActor",null,[]);var Y=a(1361);class U extends Y.a{constructor(){super()}Epe(){this.hT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.hT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.hT(2,CommonUIStrings.l_Open);this.hT(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.hT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.hT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return U.La||(U.La=new U)}static R1i(tc){return U.instance.ga(tc)}}U.La=null;Object(e.a)(U,"MruActorIntlHelper",Y.a,[]);var P;(function(tc){tc[tc.success=0]="success";tc[tc.failure=1]="failure";tc[tc.spinner=2]="spinner";tc[tc.none=3]="none"})(P||(P={}));Object(e.b)("DisplayState",P);var aa=a(39);class X{constructor(tc,Yc,fb,Hb,cc,Hc,od,Dd){this.ZHc=null;this.ZUc=!0;this.TRb="";this.sFg=
0;this.LWa=null;this.rOc=3;this.mb=Dd;this.z1=tc;this.Zi=Yc;this.swg=fb;this.wtg=Hb;this.vtg=cc;this.ODa=new h.a(()=>new r.a(Hc.value,null));this.cxg=new h.a(()=>new r.a(od.value,Object(l.a)(this,this.nJi,"mruEventResultReceived")));this.mb.pa("WacInTabOpenMRUIsEnabledForUiHost");this.mb.pa("UiHostSupportsDocRebootFeatures")}nJi(tc,Yc){this.LWa=tc;Yc||this.tTf()}fgj(){this.kD.K9a.Ne(L.a.Yrc,M.a.frame,Object(l.a)(this,this.Yrc,"populateMruMenu"),96)}Yrc(tc,Yc,fb,Hb,cc){return 1!==fb&&cc?this.j6i(cc):
32}j6i(tc){this.ssh();this.rsh();tc.PopulationXML=n.Orh(this.TRb+this.ZHc);return 32}ssh(){var tc=3;let Yc=!1;if(this.TRb&&this.sFg===this.LWa.DSj)m.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),tc=this.rOc;else{m.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var fb=this.kD.gw();this.LWa=this.mJi.rZ("File Open opened",!0);this.TRb&&2!==this.rOc&&3!==this.LWa.state?
Yc=!0:(tc=this.K2h(this.LWa),u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.Qa.RZ&&C.c()&&tc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(tc,!0)),this.TRb=({wKi:tc}=this.rNh(this.LWa)).returnValue);fb=this.kD.gw()-fb;m.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:fb})}2!==tc&&(fb={["DisplayState"]:P[tc]},1!==tc&&(fb.IsStale=Yc),m.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
fb));this.rOc=tc}K2h(tc){let Yc;try{Yc=aa.c(tc.Ozd)}catch(fb){Yc=null,m.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",fb)}return Yc}rsh(){this.ZUc?(m.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.ZHc=({K5j:this.ZUc}=this.tFi()).returnValue):m.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");m.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.ZUc,["NotDisplayingLink"]:!this.ZHc})}rNh(tc){let Yc;1===tc.state||0===tc.state?(m.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),tc=2,Yc=n.nye(this.Nja(2),this.Nja(5))):3===tc.state&&tc.Ozd?(Yc=this.zYg(tc.Ozd),tc=0):(m.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Yc=n.jqb(this.Nja(1),this.Nja(2)),tc=1);return{returnValue:Yc,wKi:tc}}zYg(tc){let Yc;const fb=this.nEb.VGa||"2155708348";if(tc.length){Yc=
n.iqb("lblRecentDocuments",this.Nja(3));let Hb=0;for(let cc=0;cc<tc.length;cc++){const Hc=tc[cc];"FileName"in Hc&&"DocumentUrl"in Hc&&"Path"in Hc&&(Yc+=n.eqb("MruButton"+cc,Hc.FileName.toString(),Hc.Path.toString(),null,this.nEb.gka,this.nEb.hzb,fb,Hc.DocumentUrl.toString()),Hc.IsPinned&&Hb++)}Yc=n.hha("RecentDocumentsMenuSection",n.swf,this.Nja(2),Yc);m.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:tc.length,["NumPinnedDocuments"]:Hb})}else Yc=
n.jqb(this.Nja(0),this.Nja(2)),m.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Yc}tFi(){let tc;tc=!0;let Yc=this.VWg;var fb=this.UWg;if(Yc&&fb||!this.kD.supportsGetMoreInfoForPersonalStorage)tc=!1;else{const Hb=this.Hcc.rZ("File Open",!1);3===Hb.state&&(Yc=Hb.hR,fb=Hb.eoa,tc=!1)}fb=fb?String.format(this.Nja(4),fb):null;return{returnValue:n.BXg(this.nEb.VGa,fb,Yc),K5j:tc}}tTf(){this.kD.gxf.Vw(this.nEb.zvb)}get kD(){return this.z1.value}get Nja(){return this.Zi.value}get nEb(){return this.swg.value}get VWg(){return this.wtg.value}get UWg(){return this.vtg.value}get Hcc(){return this.ODa.value}get mJi(){return this.cxg.value}}
Object(e.a)(X,"MruRenderer",null,[]);var Z=a(242),da=a(777);class qa{constructor(tc,Yc,fb,Hb,cc,Hc,od){this.Go=null;this.cje=!1;this.cqa=this.M5d=0;this.BAg=tc;this.aXa=Yc;this.HVb=fb;this.$ib=Hb;this.Lqa=cc;this.z1=Hc;this.ODa=new h.a(()=>new r.a(od.value,Object(l.a)(this,this.gxb,"getMoreInfoEventReceived")))}c1a(){!this.Go&&this.wAd.supportsGetMoreInfoForPersonalStorage?this.Hcc.rZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}gxb(tc){if(!this.Go&&3===tc.state)this.Go=tc;else if(2===
tc.state){this.cje?m.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Hcc.rZ("NewDocumentFromStream",!0),this.cje=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.M5d=(new Date).getTime();var tc=this.JFh.a6c;if(null===tc)this.aXa(null);else{var Yc=this.HVb.menuItemId,fb=this.HVb.HF,Hb=this.HVb.xOj,cc=this.HVb.OFh;this.cqa="streamBase64"===Hb?cc.length/1024:0;m.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.gP,
this.cqa);var Hc=(new Date).getTime();tc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",tc,A.a.hf(this.Ila),A.a.hf(Yc),A.a.hf(this.gP),A.a.hf(u.AFrameworkApplication.lcid.toString()),A.a.hf(Hc.toString()),A.a.hf(fb),A.a.hf(u.AFrameworkApplication.canary),u.AFrameworkApplication.ti,A.a.hf(Hb));tc+="&"+u.AFrameworkApplication.gdc();u.AFrameworkApplication.Twa&&(tc+="&"+u.AFrameworkApplication.Acc());(Yc=this.Go?this.Go.hR:null)&&
(tc+="&DestinationUrl="+A.a.hf(Yc));this.wAd.UEb.Im(tc,2,cc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(l.a)(this,this.zKi,"newDocumentFromStreamSuccessHandler"),Object(l.a)(this,this.yKi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}zKi(tc){if(tc&&tc.data&&tc.data.de)if(({ht:Yc}=aa.d(tc.data.de)).returnValue)if(tc=Yc,tc.StatusCode!==Z.a.EO&&tc.StatusCode!==Z.a.Hsb)m.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.gP,this.cqa,tc.StatusCode),this.aXa(null);else if(tc.NewDocumentUrl&&""!==tc.NewDocumentUrl){var Yc=(new Date).getTime()-this.M5d;m.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.gP,this.cqa,Yc);this.BAg(tc.NewDocumentUrl)}else m.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.gP,this.cqa),this.aXa(null);else m.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.gP,this.cqa,{["ResponseData"]:da.a.Qfb(tc.data.de)}),this.aXa(null);else m.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.gP,this.cqa),this.aXa(null)}yKi(tc){tc&&tc.data&&m.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.gP,this.cqa,tc.data.status);this.aXa(null)}get gP(){switch(this.wAd.kca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get JFh(){return this.$ib.value}get Ila(){return this.Lqa.value}get wAd(){return this.z1.value}get Hcc(){return this.ODa.value}}Object(e.a)(qa,"NewDocumentFromStreamOperation",null,[]);class O{constructor(tc,Yc,fb,Hb){this.$ib=tc;this.Lqa=Yc;this.z1=fb;this.bxg=Hb}create(tc,Yc,fb){return new qa(tc,Yc,fb,this.$ib,this.Lqa,this.z1,this.bxg)}}Object(e.a)(O,"NewDocumentFromStreamOperationFactory",null,[714]);var ca=a(83),wa=a(518),ia=a(55);
class Ha{get name(){return"Common.App.NewAndOpen.UX"}Ah(tc){tc.register(O,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").qc().yc(()=>new O(new h.a(()=>u.AFrameworkApplication.ra.Qa.ngd()),new h.a(()=>u.AFrameworkApplication.Ila),new h.a(()=>tc.mg("Common.INewAndOpenCommonHelpers")),new h.a(()=>tc.mg("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){u.AFrameworkApplication.fa.ru(()=>{this.zzb()})}zzb(){const tc=
wa.a.Pq(ca.a.instance.Tb("Common.INewAndOpenCommonHelpers")),Yc=wa.a.Pq(ca.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));u.AFrameworkApplication.Ila&&ia.Task.WAA.call(null,tc,Yc).continueWith(()=>{const fb=new N(new h.a(()=>tc.result),new h.a(()=>u.AFrameworkApplication.ra.Qa.ngd()),new h.a(()=>Yc.result),new h.a(()=>u.AFrameworkApplication.ra.Qa.ogd().VGa||"1959943459"),new h.a(()=>u.AFrameworkApplication.Ila),new h.a(()=>u.AFrameworkApplication.hri));fb.Ag();fb.VIb()});if(u.AFrameworkApplication.QRf){const fb=
wa.a.Pq(ca.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));ia.Task.WAA.call(null,tc,Yc,fb).continueWith(()=>{const Hb=new X(new h.a(()=>tc.result),new h.a(()=>U.R1i),new h.a(()=>u.AFrameworkApplication.ra.Qa.ogd()),new h.a(()=>u.AFrameworkApplication.Q1i),new h.a(()=>u.AFrameworkApplication.P1i),new h.a(()=>Yc.result),new h.a(()=>fb.result),u.AFrameworkApplication.fa);Hb.fgj();Hb.tTf()})}}dispose(){}}Object(e.a)(Ha,"UXPackageManager",null,[4,5,2]);var Sa=a(1200),Da=a(1207),ea=a(1180),sa=
a(1216),Ea=a(1208),ba;(function(tc){tc[tc.myFiles=0]="myFiles";tc[tc.recent=1]="recent";tc[tc.currentFolder=2]="currentFolder";tc[tc.yourPhone=3]="yourPhone"})(ba||(ba={}));Object(e.b)("SharedFilePickerLandingLocation",ba);class ka{constructor(tc){this.ELa=this.dbb=null;this._initialized=!1;this.qmd=tc}x2a(tc){this._initialized||(tc.Yn(G.a.ySf),tc.Dl(G.a.ySf,Object(l.a)(this,this.XXi,"onReceivedPickerResponse")),this._initialized=!0)}pgd(tc){return this.ELa=new Promise((Yc,fb)=>{const Hb={};Hb[S.a.T4i]=
tc;this.dbb=(cc,Hc)=>{""===Hc?(m.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Yc(cc)):("Canceled"===Hc?m.ULS.sendTraceTag(572548164,306,50,Hc):m.ULS.sendTraceTag(556901065,306,10,Hc),fb(Hc))};this.qmd.execute(cc=>{this.x2a(cc);cc.jj(G.a.V1i,Hb)})})}XXi(tc){this.dbb(tc.Values[S.a.iuj],void 0===tc.Values[S.a.jGd]||null===tc.Values[S.a.jGd]?"":tc.Values[S.a.jGd])}Vsd(){return u.AFrameworkApplication.fa.pa("UiHostCommonFilePicker")}MHe(tc,Yc,fb,Hb,cc,Hc,od){const Dd={};Dd[S.a.Vtj]=
tc;Dd[S.a.titleText]=Yc;Dd[S.a.HQg]=fb;Dd[S.a.IQg]=Hb;Dd[S.a.JQg]=!1;Dd[S.a.vnh]=!0;Dd[S.a.UFh]=cc;Dd[S.a.X4i]=Hc;Dd[S.a.W4i]=ba[od];C.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Dd[S.a.Y4i]="Dark");return Dd}}Object(e.a)(ka,"SharedFilePickerManager",null,[296]);class Ca{constructor(){this.$a=null}get name(){return"Common.App.SharedFilePicker"}Ah(tc){this.$a=tc;tc.register(ka,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").qc().yc(()=>
new ka(tc.Tb("Postmessage.IHostPostmessenger")))}init(){u.AFrameworkApplication.fa.ru(()=>{this.zzb()})}zzb(){this.$a.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){f.a.instance.gi(new Ca)}}Object(e.a)(Ca,"SharedFilePickerPackage",null,[4,5]);var db=a(1310),yb=a(853),kb=a(27);class mb{get name(){return"Common.App.WildFire"}koe(tc){let Yc=!1;tc&&(tc.n5c(),tc.SZg&&(Yc=!1));return Yc}Gbh(){var tc=u.AFrameworkApplication.ra.Qa;tc=new db.a(tc.Oj,yb.a.Ddc(),!1,1===tc.pca);
this.koe(tc)&&m.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}$5b(tc,Yc,fb,Hb,cc,Hc){tc=new db.a(tc,fb,Hb,Yc,cc,Hc);this.koe(tc)&&m.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Phh(){const tc=u.AFrameworkApplication.ra.Qa;var Yc=u.AFrameworkApplication.fa;const fb=tc.Oj,Hb=1===tc.pca;if(Yc.pa(yb.a.B6h(fb))){var cc=yb.a.Ddc(),Hc=8<kb.a.I5a;if(2!==fb||2!==cc||!Hb){Yc=Yc.pa(yb.a.C6h(fb));var od=tc.x0f(),Dd=()=>tc.yx;Yc&&!yb.a.mrd(yb.a.$ed(fb))&&this.$5b(fb,Hb,cc,Hc,Dd,od)}}}init(){var tc=
u.AFrameworkApplication.fa;const Yc=tc.pa("WildFireChromeExtensionEnabled");tc=tc.pa("WildFireChromeExtensionBar")&&Yc;yb.a.vzc&&tc&&!yb.a.mrd(yb.a.eCe)?this.Gbh():(document.body&&yb.a.AGj&&this.Phh(),u.AFrameworkApplication.rb.Nb(L.a.yvd,M.a.frame,Object(l.a)(this,this.yvd,"launchWildFireBusinessBar")))}yvd(tc,Yc,fb,Hb,cc){if(1===fb)return 32;if(!cc)return 8;this.$5b(cc.app,cc.mode,cc.platform,cc.useTwoButton,null,null);return 32}dispose(){}Ah(){}static main(){f.a.instance.gi(new mb)}}Object(e.a)(mb,
"PackageManager",null,[4,5]);var W=a(1298);a(1084);var Q=a(9),va=a(709),na=a(50),Ba=a(37),Oa=a(188),oa=a(1);class Ja{constructor(tc){this.hh=tc}Hc(){return!1}executeCommand(tc,Yc,fb){return 2!==this.hh.Wd(L.a.newDocument,2,fb)?ia.Task.Ra(!0):Oa.a(Yc.command)}wc(tc,Yc){return 1056925771===Yc.command}Mc(tc,Yc,fb){tc=!0;switch(Yc){case "PopulateNewMenu":this.hh&&(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&u.AFrameworkApplication.Sp("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(u.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",u.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.hh.Wd(L.a.Zrc,2,fb));break;default:tc=!1}return tc}}Object(e.a)(Ja,"CreateNewCommandHandler",null,[221]);class Wb extends va.a{constructor(tc){super(tc)}hd(){const tc=na.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),Yc=na.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([tc,Yc],this.la),()=>{this.$c([new Ja(u.AFrameworkApplication.rb)])},this.la,3)}static ka(tc){va.a.Ld(87,new Wb(tc))}}Object(e.a)(Wb,"CreateNewCommandHandlerFactory",va.a,[]);var nc=a(1194),Yb=a(1086),pb=a(1236),Fa=a(511),ab=a(103),Gb=a(192),Ga=a(11),Ma=a(22),Qa=a(282),wb=a(1013);class Na{}Na.create="Create";Na.activate="Activate";Na.close="Close";Na.remove="Delete";Na.duplicate="Duplicate";Object(e.a)(Na,"Actions",null,[]);var ya=a(29),
nb=a(45);class vb extends ia.Task{constructor(tc){super();this.X2d=null;this.Z2d=0;this.JRb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.bXa=this.bXa()}catch(Yc){this.dispose(),this.GAa(Yc),this._state=3}};this.Rt=tc;this.bXa=this.NFc;this.moveNext()}NFc(){this.X2d=ya.a.ed(3,2,0,1664,0,-1244327602,"MsFormDeleteConfirmation");this.JRb=nb.a(this.Rt.$).kj(this.X2d).G();this.JRb.isCompleted||(this._state=2,this.JRb.h$a(this.moveNext));return this.eog}eog(){this.Z2d=
this.JRb.rZ();0===this.Z2d&&(this.Rt.$.workbookContext.Options=Ga.HelperMethods.bO(!1,this.Rt.$.workbookContext.Options,2048),this.Rt.deleteMsFormMetaDataSheet());this._state=3;this.ORa(!0)}dispose(){}}Object(e.a)(vb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",ia.Task,[2]);class gb{}gb.action="Action";gb.iIh="FlexPane";gb.Bac="formId";gb.id="id";gb.title="Title";gb.WQb="XlWorkbookId";gb.dKh="Fragment";gb.host="Host";gb.FTj="TopView";gb.accountType="auth_pvr";
Object(e.a)(gb,"Parameters",null,[]);var cb=a(60);const La=(tc,Yc,fb,Hb,cc,Hc,od=null)=>{od=tc.Na(9,od);od.sheetName=Yc;od.confirmationChoice=!0;return cb.g(tc,"DeleteSheet",od,fb,Hb,cc,Hc,0)};class ja{constructor(tc){this.ho="Excel";this.$=tc;this.BU=wb.a.current}get hasMsForm(){return ab.c(this.$.dg)}get rnc(){return this.$.workbookContext.MsFormId}get TQb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return Ma.a.contains(this.$.Wu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":
"OrgId"}Hc(tc,Yc){switch(Yc){case -105284469:return!ab.i(this.$.dg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(tc,Yc){tc=Ba.TaskExtensions.Tj();Yc=Yc.command;switch(Yc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:tc=this.deleteMsForm();break;default:tc=Oa.a(Yc)}return tc}wc(tc,
Yc){if(!this.$.ea.wg.get(61))return!1;tc=!1;switch(Yc.command){case -105284469:tc=ab.i(this.$.dg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:tc=this.hasMsForm}return tc}Mc(){return!1}insertMsForm(){const tc=A.a.Kp(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Yc={},fb={};Yc[gb.action]=Na.create;Yc[gb.accountType]=this.accountType;fb[gb.action]=Na.create;fb[gb.WQb]=encodeURIComponent(this.TQb);fb[gb.host]=this.ho;fb[gb.title]=encodeURIComponent(tc);
this.eEb(Yc,fb);this.$.workbookContext.Options=Ga.HelperMethods.bO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const tc={},Yc={};tc[gb.accountType]=this.accountType;Yc[gb.Bac]=this.rnc;Yc[gb.WQb]=encodeURIComponent(this.TQb);Yc[gb.host]=this.ho;this.eEb(tc,Yc)}previewMsForm(){const tc={},Yc={};tc[gb.accountType]=this.accountType;Yc[gb.Bac]=this.rnc;Yc[gb.WQb]=encodeURIComponent(this.TQb);Yc[gb.host]=this.ho;Yc[gb.FTj]="Preview";this.eEb(tc,Yc)}sendMsForm(){const tc={},Yc={};tc[gb.accountType]=
this.accountType;Yc[gb.Bac]=this.rnc;Yc[gb.iIh]="SendForm";Yc[gb.WQb]=encodeURIComponent(this.TQb);Yc[gb.host]=this.ho;this.eEb(tc,Yc)}deleteMsForm(){return new vb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.FE(new Gb.a(158,0,(tc,Yc,fb)=>La(this.$.oa.Aw,this.BU.Fvb,Qa.b(tc,()=>{this.Rkh()}),Yc,fb,null)))}Rkh(){const tc={},Yc={};tc[gb.action]=Na.remove;tc[gb.accountType]=this.accountType;Yc[gb.action]=Na.remove;Yc[gb.host]=this.ho;Yc[gb.Bac]=encodeURIComponent(this.rnc);Yc[gb.WQb]=
encodeURIComponent(this.TQb);this.eEb(tc,Yc)}eEb(tc,Yc){const fb=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Hb="";var cc="";if(Yc){for(let Dd in Yc){var Hc=Dd,od=Yc[Dd];cc+=cc.length?"&":"";cc+=Hc+"="+od}tc||(tc={});tc[gb.dKh]=encodeURIComponent(cc)}if(tc)for(let Dd in tc)Yc=Dd,cc=tc[Dd],Hb+=Hb.length?"&":"?",Hb+=Yc+"="+cc;window.open(fb+Hb,"_blank")}}Object(e.a)(ja,"MsFormCommandHandler",null,[221]);class Ua extends va.a{constructor(tc){super(tc)}hd(){const tc=na.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([tc],this.la),()=>{this.$c([new ja(this.$)])},this.la,3)}static ka(tc){tc.ea.wg.get(61)&&va.a.Ld(215,new Ua(tc))}}Object(e.a)(Ua,"MsFormCommandHandlerFactory",va.a,[]);var lb=a(226);class sb extends lb.a{constructor(tc){super();this.$=tc;this.Db()}create(){Ba.TaskExtensions.za(na.GetServiceTaskFactory.create(this.$.da,164,this.la,this.Xa),()=>{this.nb(new Ha)},this.la,3)}}Object(e.a)(sb,"NewAndOpenUXFactory",lb.a,[]);class V{constructor(tc,
Yc){this.hh=Yc;this.$=tc}executeCommand(tc,Yc,fb){tc=2;switch(Yc.command){case L.a.openUrlInNewTab:tc=this.hh.Wd(L.a.openUrlInNewTab,2,fb);break;case L.a.pPa:tc=this.hh.Wd(L.a.pPa,2,fb)}return 2!==tc?ia.Task.Ra(!0):Oa.a(Yc.command)}wc(tc,Yc){return Yc.command===L.a.openUrlInNewTab||Yc.command===L.a.pPa}Mc(tc,Yc,fb){return"PopulateMruMenu"===Yc?(this.hh.Wd(L.a.Yrc,2,fb),!0):!1}Hc(){return!1}}Object(e.a)(V,"OpenFromMruCommandHandler",null,[221]);class za extends va.a{constructor(tc){super(tc)}hd(){const tc=
na.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),Yc=na.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([tc,Yc],this.la),()=>{this.$c([new V(this.$,u.AFrameworkApplication.rb)])},this.la,3)}static ka(tc){va.a.Ld(88,new za(tc))}}Object(e.a)(za,"OpenFromMruCommandHandlerFactory",va.a,[]);var Ra=a(1170),Xa=a(1209),$a=a(1249),ma=a(1089),fa=a(1190),eb=a(1090),ua=a(1091),xa=a(1195),tb=a(1237),Qb=a(1238),pc=a(173),hb=a(84),ib=a(374),Vb=a(101),
wc=a(21),Lc=a(375);class Fc{constructor(tc,Yc){this.sheetName=null;this.value=!1;this.sheetName=tc;this.value=Yc}getSheetName(){return this.sheetName}Gva(){return this.value}}Object(e.a)(Fc,"MacroRecorderSheetOptionToggledPayload",null,[122]);const fd=(tc,Yc,fb,Hb,cc,Hc,od,Dd=null)=>{Dd=tc.Na(9,Dd);Dd.sheetName=Yc;Dd.show=fb;return cb.g(tc,"ShowGridlines",Dd,Hb,cc,Hc,od,0)},Ta=(tc,Yc,fb,Hb,cc,Hc,od,Dd=null)=>{Dd=tc.Na(9,Dd);Dd.sheetName=Yc;Dd.show=fb;return cb.g(tc,"ShowHeadings",Dd,Hb,cc,Hc,od,0)},
Fb=(tc,Yc,fb,Hb,cc,Hc,od,Dd=null)=>{Dd=tc.Na(9,Dd);Dd.sheetName=Yc;Dd.directionRtl=fb;return cb.g(tc,"ChangeSheetDirection",Dd,Hb,cc,Hc,od,0)};var ic=a(186),zb=a(105),Bb;let ec=Bb=class{constructor(tc){this.$=tc}Hc(){return!1}executeCommand(tc,Yc){const fb={};this.$.ak(fb);tc=Yc.command;const Hb=Object(hb.a)(Vb.a,this.$.va.getItemByName(fb.SheetName));if(!Hb)return Oa.a(tc);let cc,Hc,od,Dd,be;switch(tc){case 705559150:case -1411193626:cc=16;Hc=!Hb.hideGridLines;od=fd;be=183;Dd=Hb.hideGridLines;break;
case -2052321504:case 515737500:cc=4;Hc=!Hb.headersVisible;od=Ta;be=184;Dd=!Hb.headersVisible;break;case -1478455630:cc=2;Hc=!Hb.displayRtl;od=Fb;be=185;Dd=!Hb.displayRtl;wc.h(this.$).Ca.jZj(Hc);break;default:return Oa.a(tc)}Hb.Tqb(cc,Hc);const Jb=()=>new Fc(fb.SheetName,Dd),sc=this.$.oa.xa;return ib.a(this.$.userOperationManager,(ed,xd,le)=>od(sc,fb.SheetName,Dd,Qa.b(ed,Sd=>{Bb.IGb(Sd,Hb,cc,Hc)}),Qa.a(xd,()=>{Bb.UFb(Hb,cc,Hc)}),le,null),ed=>new Gb.a(be,0,ed,void 0,Jb),Yc)}wc(tc,Yc){tc=!1;switch(Yc.command){case -1411193626:case 515737500:case -1478455630:tc=
!0;break;case 705559150:case -2052321504:tc=Lc.a(this.$)}return tc}Mc(){return!1}static IGb(tc,Yc,fb,Hb){ya.a.oq(tc.Errors)&&Yc.Tqb(fb,!Hb)}static UFb(tc,Yc,fb){tc.Tqb(Yc,!fb)}};ec=Bb=Object(pc.b)([Object(ic.d)(zb.m),Object(pc.c)(0,Object(zb.f)())],ec);Object(e.a)(ec,"SheetOptionsToggleCommandHandler",null,[221]);class Qd extends va.a{constructor(tc){super(tc)}hd(){this.$c([new ec(this.$)])}static ka(tc){va.a.Ld(100,new Qd(tc))}}Object(e.a)(Qd,"SheetOptionsToggleCommandHandlerFactory",va.a,[]);String(c);
window.___1675790552009_closurehack=c;var fc=a(174),cd=a(181),jd=a(152),nd=a(65),vd=a(56),wd=a(213),Td=a(592),jc=a(94),bd=a(254),Hd=a(215),ge=a(12);class Mb extends Hd.a{constructor(tc,Yc,fb,Hb=null){super(tc,fb,2,Hb);this.ZLc=null;this.onResize=()=>{const cc=this.GWh();this.GLa.setAttribute("width",cc.x.toString());this.GLa.setAttribute("height",cc.y.toString());this.XZj(cc);this.pDd()};this.NKe=Yc;this.$.bC(this.onResize);this.Rec()}get GLa(){return this.ZLc}initialize(){const tc=this.$.Bb+"iframeDialog_frame",
Yc=this.$.Bb+"iframeDialog";this.Fb.style.margin=Ga.HelperMethods.sc(0);this.Fb.style.marginBottom=Ga.HelperMethods.sc(-2);if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var fb=document.createElement("iframe");fb.id=tc;fb.frameBorder="0";fb.scrolling="auto";fb.src=this.Egd(Yc);this.Fb.appendChild(fb)}else fb=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',tc,this.Egd(Yc)),this.Fb.innerHTML=fb;this.ZLc=document.getElementById(tc);
this.domElement.id=Yc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.xF(this.onResize);super.dispose()}setFocus(){ge.DOMElementExtensions.setFocus(this.GLa)}onHide(){this.GLa.contentWindow.close();ge.DOMElementExtensions.vf(this.GLa);this.ZLc=null;super.onHide()}XZj(tc){const Yc=this.domElement.style;Yc.width=Ga.HelperMethods.sc(tc.x);Yc.marginLeft=Ga.HelperMethods.sc(-tc.x/2)}GWh(){const tc=ge.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
tc.width),this.NKe.x),Math.min(Math.floor(.9*tc.height),this.NKe.y))}}Object(e.a)(Mb,"IFrameDialog",Hd.a,[]);var Kc=a(5),Ob=a(77),Mc=a(13);class Dc extends Mb{constructor(tc){super(tc,new Sys.UI.Point(960,680),Mc.a.instance.ga(1262));this.name=Kc.a.dPe}get kc(){return"EmbeddingDialog"}Egd(tc){const Yc=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);wd.a.Mk(Yc,Kc.a.vuh,tc);Ob.a(this.$.ya,32)&&wd.a.Mk(Yc,Kc.a.rRe,"1");Ob.a(this.$.ya,33)&&wd.a.Mk(Yc,Kc.a.sRe,"1");Ob.a(this.$.ya,34)&&wd.a.Mk(Yc,
Kc.a.qRe,"1");return Yc.toString()}onShow(){m.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(e.a)(Dc,"EmbeddingDialog",Mb,[]);var $c=a(1263),td=a(89),Yd=a(79),ae=a(838);class je{}je.h7f="FrameDialog_ShareFromEdit";je.view="FrameDialog_View";je.nDe="FrameDialog_CloseAndRefresh";je.iDj="FrameDialog_ShareFromView";je.edit="FrameDialog_Edit";je.tej="FrameDialog_RefreshGrid";je.Q5g="FrameDialog_CloseMe";je.xDe="FrameDialog_CloseMeError";je.ready=
"FrameDialog_Ready";je.A5i="FrameDialog_PleaseClose";je.PJ="GotoRange";Object(e.a)(je,"PostMessageConstants",null,[]);var Ke=a(284),Fd=a(113),fe=a(250);class ne{constructor(){this.PJ=null;this.OGd=1461300262}}Object(e.a)(ne,"SessionUpdateContext",null,[]);class ce extends Mb{constructor(tc,Yc,fb){super(tc,new Sys.UI.Point(ce.qkh,ce.Rjh),Mc.a.instance.ga(Yc?1267:1266));this.j1a=null;this.pNc=!1;this.yqc=Hb=>{const cc=this.$,Hc=new ne;Hc.PJ=Hb.Values[je.PJ];let od=!1;switch(Hb.MessageId){case je.h7f:this.dv();
od=!0;Hc.OGd=1334518759;break;case je.view:this.qoa=Mc.a.instance.ga(1267);this.Bkg(!0);break;case je.nDe:this.dv(),od=!0}Hb=new Gb.a(140,0,(Dd,be,Jb)=>Ke.n(cc.oa.xa,Qa.b(Dd,this.qZi),be,Jb,Hc));Hb.flags=od?16:80;cc.userOperationManager.Jc(Hb,this.Sd)};this.dRi=()=>{const Hb=this.$;Hb.ya.SurveyRedirectUrl?(this.dv(),Hb.Zc(1305810481,0,8,null)):(this.qoa=Mc.a.instance.ga(1266),this.Bkg(!1))};this.EZi=()=>{const Hb=this.$;this.dv();Hb.Zc(1334518759,0,8,null)};this.Goc=Hb=>{const cc=this.$;this.dv();
Hb.MessageId===je.xDe&&cc.ea.Add()};this.SXi=()=>{this.pNc=!0;this.raiseEvent(ce.Lvd)};this.qZi=(Hb,cc)=>{if(!fe.a(Hb)){Hb=this.$;if(cc.PJ){const Hc=Hb.ea.va;if(Hc.contains(cc.PJ.SheetName))this.spc(cc);else{let od=null;od=()=>{Hc.Wma(od);this.spc(cc)};Hc.Kga(od)}}1461300262!==cc.OGd&&Hb.Zc(cc.OGd,0,8,null)}};this.Jbe=Yc;this.Sd=fb}nNg(tc){this.addHandler(ce.Lvd,tc)}Vjj(tc){this.removeHandler(ce.Lvd,tc)}get kc(){return"FormDialog"}get Njf(){return this.pNc}get u7a(){return this.Jbe}dispose(){td.a.Ja(this.j1a);
this.j1a=null;super.dispose()}initialize(){super.initialize();const tc=Yd.a.Qaa(this.$.ya.FormLightBoxUrl),Yc=this.j1a=new $c.a(this.GLa.contentWindow,tc);Yc.isEnabled()&&Yc.PFa(tc)&&(this.Nma(je.h7f,this.yqc),this.Nma(je.view,this.yqc),this.Nma(je.nDe,this.yqc),this.Nma(je.iDj,this.EZi),this.Nma(je.edit,this.dRi),this.Nma(je.tej,this.yqc),this.Nma(je.ready,this.SXi),this.Nma(je.Q5g,this.Goc),this.Nma(je.xDe,this.Goc))}close(tc){tc===this.fM&&this.Njf&&this.j1a.send(new ae.a(je.A5i))||super.close(tc)}Egd(){return this.KHe(this.u7a)}KHe(tc){const Yc=
this.$.ya,fb=new Sys.StringBuilder(Yc.FormLightBoxUrl);wd.a.Mk(fb,Kc.a.MJh,this.$.ea.sessionId);wd.a.Mk(fb,Kc.a.KJh,tc?Kc.a.LJh:Kc.a.JJh);Fd.a.Rob(fb,Yc);return fb.toString()}Bkg(tc){this.pNc=!1;this.GLa.src=this.KHe(tc);this.Jbe=tc}Nma(tc,Yc){this.j1a.Yn(tc);this.j1a.Dl(tc,Yc)}spc(tc){const Yc=this.$.ea.va.getItemByName(tc.PJ.SheetName);Yc&&0===Yc.yB&&wc.h(this.$).qg(tc.PJ,null,null,null,20,"FormDialog.OnItemInserted")}}ce.qkh=900;ce.Rjh=1200;ce.Lvd="lightBoxReady";Object(e.a)(ce,"FormDialog",Mb,
[202]);var te;(function(tc){tc[tc.comment=10]="comment";tc[tc.range=12]="range";tc[tc.table=13]="table";tc[tc.chart=14]="chart";tc[tc.sheet=15]="sheet"})(te||(te={}));Object(e.b)("NavigationType",te);var we=a(996),Pe=a(87),qf=a(19),Ve=a(559),Qe=a(960),Ze=a(286),Re=a(765),Za=a(51);class Xb extends Re.a{constructor(tc,Yc,fb,Hb,cc,Hc=0,od){super(tc,Mc.a.instance.ga(Yc),!1);this.htmlSanitizationHelper=null;this.message=fb;this.WMi=Hb;this.n2d=cc;this.operationFlags=Hc;this.htmlSanitizationHelper=od}get kc(){return"WebMethodConfirmationDialog"}get GB(){return 1005}get GHa(){return this.operationFlags}initialize(){let tc=
"<div class='"+Pe.a.Nl+"'>\r\n\t<div class='"+Pe.a.fad+"'>\r\n\t\t<div class='"+qf.a.L2c+"'>\r\n\t\t\t<img src='{0}' class='"+qf.a.MUe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Pe.a.iad+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";tc=String.format(tc,Za.a.qe(13),Mc.a.instance.ga(25),Mc.a.instance.ga(this.message));this.htmlSanitizationHelper&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
this.htmlSanitizationHelper.Ph(this.Fb,tc):this.Fb.innerHTML=tc;this.addButton(0,this.WMi);this.addButton(1);super.initialize()}DG(){return this.n2d}}Object(e.a)(Xb,"WebMethodConfirmationDialog",Re.a,[]);class jb extends we.a{constructor(tc,Yc){super(tc,Mc.a.instance.ga(1269));this.htmlSanitizationHelper=this.YTa=this.yRa=this.textBox=null;this.JJf=()=>{const fb=this.$;this.dv();const Hb=new Xb(fb,1272,1273,1274,(cc,Hc,od)=>{var Dd=fb.oa.xa.Wb(),be=fb.oa.xa;Dd=be.Na(1,Dd);return cb.g(be,"UnshareForm",
Dd,cc,Hc,od,null,0)},16,this.htmlSanitizationHelper);Hb.initialize();Hb.kg()};this.htmlSanitizationHelper=Yc}get kc(){return"ShareFormDialog"}dispose(){this.YTa&&this.YTa.qda(this.JJf);td.a.pc([this.textBox,this.yRa,this.YTa]);this.YTa=this.yRa=this.textBox=null;super.dispose()}initialize(){let tc="<div class='"+Pe.a.Nl+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Pe.a.lJa+"'>\r\n\t<input type='text' id='{1}' class='"+Pe.a.Mx+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
tc=String.format(tc,Mc.a.instance.ga(1270),"sfd_input","sfd_unshare",qf.a.eo,Mc.a.instance.ga(1271));this.htmlSanitizationHelper&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.Ph(this.Fb,tc):this.Fb.innerHTML=tc;this.textBox=new Ze.a(this.getElementById("sfd_input"));this.yRa=new Qe.a(this.textBox.domElement);this.YTa=Ve.a.create(this.getElementById("sfd_unshare"));
this.YTa.f2(this.JJf);this.textBox.text=Mc.a.instance.ga(735);this.textBox.enabled=!1;this.textBox.readOnly=!kb.a.Hg;this.addButton(1,10);super.initialize()}y_a(){return(tc,Yc,fb)=>{var Hb=this.$.oa.xa.Wb(),cc=this.$.oa.xa;tc=this.d4a(tc);Yc=this.kKa(Yc);Hb=cc.Na(1,Hb);return cb.g(cc,"ShareForm",Hb,tc,Yc,fb,null,0)}}t_(tc,Yc,fb){this.textBox.text=tc.Result;this.textBox.enabled=!0;ge.DOMElementExtensions.setVisible(this.YTa.domElement,!0);super.t_(tc,Yc,fb)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(tc){}super.setFocus()}}Object(e.a)(jb,"ShareFormDialog",we.a,[]);var Sb=a(249),lc=a(6),oc=a(82),Qc=a(257),Kb=a(73),hc=a(628),Cc=a(142),Ka=a(428),Ib=a(259),dc=a(17),yc=a(256);class Eb extends cd.a{constructor(tc,Yc,fb){super();this.Oze=this.Pze=!1;this.a3a=0;this.Gia=!1;this.sOi=()=>{this.Pze=!0;this.p9f()};this.$=tc;this.Va=Yc;this.KJ=fb;Kb.a(this.$).vKd(new Cc.a(lc.a.xig,lc.a.idle,Eb.G2g),new Sb.a(lc.a.vDe,lc.a.m_,null,lc.a.yO,lc.a.idle))}get AFc(){return ab.b(this.$.dg)}get lPd(){return this.$.isEditMode&&
(this.$.ea.bqh||this.$.PM)}Hc(tc,Yc){switch(Yc){case 353606613:case -1099009678:case 192430811:return!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.T7f();case 783415632:return!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.T7f();case 869186573:return this.U7f();case -1570751769:case 1986648902:return 131072!==(this.$.xU&131072);case 330035228:return!(this.y3a(!0)&&this.AFc);case -509039657:return!(this.y3a()&&this.AFc);
case 1334518759:return!(this.y3a()&&this.AFc&&this.aAe())}return!1}T7f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.U7f()}U7f(){const tc=this.$.workbookContext.FullDocumentInfo,Yc=Ib.a()&&this.$.ea.wg.get(5);return!tc.FileSharingUrl&&!Yc}executeCommand(tc,Yc,fb){tc=this.$.workbookContext.FullDocumentInfo;var Hb=L.a.workflow,cc=Ba.TaskExtensions.Tj();const Hc=Yc.command;if(Hc===Hb||-266099===Hc)return this.rai(Yc,Hb,tc);switch(Hc){case 1986648902:this.w6f();break;case -1570751769:this.P8h(Yc);
break;case 869186573:Yc=L.a.hDj;cc=u.AFrameworkApplication.fa.pa("ShareMenuIsEnabled");Hb=null;(oa.EwaSettings.sa(478)||cc)&&fb&&"CopyLink"===fb.SourceControlId?(Hb={},Hb[S.a.CMb]="copy",Yc=L.a.g7f):cc&&fb&&"ManageAccess"===fb.SourceControlId?(Hb={},Hb[S.a.CMb]="manageAccess",Yc=L.a.jDj):fb&&"LinkToComment"===fb.SourceControlId&&(Hb={},Hb[S.a.CMb]="copy",Hb[S.a.MSd]=fb.navId,Yc=L.a.g7f);cc=this.w$f(tc,Hb);w.c(Yc);break;case -1099009678:cc=this.Fyc(12,tc);break;case 192430811:cc=this.Fyc(13,tc);break;
case 353606613:cc=this.Fyc(14,tc);break;case 783415632:fb&&"LinkToThisSheet"===fb.SourceControlId&&m.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");cc=this.Fyc(15,tc);break;case -59906385:case 1197060601:this.D$h(Yc,tc);break;case 1305810481:this.x$e(!1,Yc);break;case 330035228:this.x$e(!0,Yc);break;case -509039657:oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
Ba.TaskExtensions.za(na.GetServiceTaskFactory.Oa(this.$.da,498,499,0),od=>{this.deleteForm(od.result)},this.$.la,3):this.deleteForm(null);break;case 1334518759:Yc.yAb=!0;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?Ba.TaskExtensions.za(na.GetServiceTaskFactory.Oa(this.$.da,498,499,0),od=>{this.shareForm(od.result)},this.$.la,3):this.shareForm(null);break;case 710925581:vd.a.pg.$yc("710925581")&&
(cc=Ba.TaskExtensions.za(this.KJ.value,od=>{od.result.jj(G.a.conversation,{})},this.la,3));break;case 327119921:this.C8h();break;default:cc=Oa.a(Hc)}return cc}wc(tc,Yc){tc=!1;Yc=Yc.command;if(Yc===L.a.workflow)return!0;switch(Yc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:tc=!0;break;case 353606613:case -1099009678:case 192430811:tc=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:tc=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return tc}Mc(tc,Yc,fb){if("PopulateFormMenu"===Yc){Yc=this.AFc?this.aAe()?Eb.XDh:Eb.YDh:Eb.DKi;tc=this.Va.Ec();for(let Hb=0;Hb<Yc.length;Hb++)tc.buttons.push(this.Va.pb(Yc[Hb]));Yc=this.Va.sq("Forms.Flyout");Yc.rc.push(tc);fb.MenuItems=Yc.lE();return!0}return!1}rai(tc,Yc,fb){return this.lPd&&tc.command===Yc?(this.jPd(tc,-266099),
Ba.TaskExtensions.Uaa()):Ba.TaskExtensions.za(this.KJ.value,Hb=>{Td.a(Hb.result,G.a.workflow,null,fb.WorkflowPostMessage)||Ga.HelperMethods.gf(fb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}aAe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.wg.get(26)}C8h(){var tc=fc.a.create().toString();m.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${tc}`);var Yc=this.$.frame,fb=Yc.G9a,Hb=this.$;const cc=new yc.QueryStringBuilder(u.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));
cc.$i("deeplinkId",tc);cc.$i("lm","deeplink");tc=cc.$i;var Hc={};const od=new yc.QueryStringBuilder(u.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));od.$i("auth","2");od.$i("flight","officeunihost");od.$i("source","TEAMS-ELECTRON.meetingStage.deeplink");var Dd={};Dd.fileType=A.a.T3(Hb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Dd.objectUrl=Hb.workbookContext.FullDocumentInfo.WorkbookPath;Dd.baseUrl=Hb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Hb=Hb.workbookContext.WorkbookFileVersionId;
let be=decodeURIComponent(Hb);for(;Hb!=be;)Hb=be,be=decodeURIComponent(Hb);0>Hb.indexOf("{")||0>Hb.indexOf("}")?(m.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Hb}`),Hb=""):Hb=Hb.substring(Hb.indexOf("{")+1,Hb.indexOf("}")).toLowerCase()}Dd.fileId=Hb;Dd=aa.c(aa.c(Dd));od.$i("subEntityId",Dd.substring(1,Dd.length-1));Hc.appSharingUrl=od.toString();Hc.appId=u.AFrameworkApplication.fa.Wa("TeamsAppId");Hc=JSON.stringify(Hc);tc.call(cc,"appContext",Hc);
fb.call(Yc,cc.toString(),!0)}P8h(tc){this.lPd?this.jPd(tc,1986648902):this.w6f()}x$e(tc,Yc){!tc&&this.$.ya.SurveyRedirectUrl?this.Q9i():(tc=new ce(this.$,tc,Yc),tc.initialize(),tc.kg())}D$h(tc,Yc){this.lPd&&1197060601===tc.command?this.jPd(tc,-59906385):Ba.TaskExtensions.za(this.KJ.value,fb=>{fb=fb.result;fb&&Td.a(fb,G.a.replyWithChanges,null,this.$.ea.wg.get(8))||(fb=new Sys.StringBuilder(Yc.ReplyWithChangesUrl),wd.a.Mk(fb,Ka.e,Ka.d),jd.a.ntw(fb.toString(),this.$))},this.la,3)}jPd(tc,Yc){const fb=
Kb.a(this.$).gd.activityState,Hb=new jc.a(Yc,tc.method,tc.mode,tc.We,tc.tabName);nb.a(this.$).tr(new bd.a(lc.a.ew,5,()=>{fb[Qc.a.Bp]=lc.a.y0f;fb[hc.a.VVc]=Hb;this.$.Uk.Ky("SocialSharingSaveBeforeCommand");this.$.Uk.ope(Hb.command)}))}w6f(){const tc=this.$.ya.DocumentHostInfo;tc.HostEmbeddedViewUrl||this.Pze?this.p9f():this.$.Xd.get(53)&&Ba.TaskExtensions.za(this.KJ.value,Yc=>{this.HWj(Yc.result)||jd.a.ntw(tc.FileEmbedCommandUrl,this.$)},this.la,3)}HWj(tc){return tc.isEnabled()&&(this.Oze||(this.Oze=
tc.Dl(G.a.Nze,this.sOi)))?tc.jj(G.a.xFh,null):!1}p9f(){if(kb.a.cp)jd.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const tc=new Dc(this.$);tc.initialize();tc.kg()}}deleteForm(tc){const Yc=this.$;tc=new Xb(Yc,1275,1276,1268,(fb,Hb,cc)=>{var Hc=Yc.oa.xa.Wb(),od=Yc.oa.xa;Hc=od.Na(9,Hc);Hc.surveyId=null;return cb.g(od,"DeleteSurvey",Hc,fb,Hb,cc,null,0)},0,tc);tc.initialize();tc.kg()}shareForm(tc){const Yc=this.$.workbookContext.FullDocumentInfo;this.$.ea.wg.get(26)?(tc=new jb(this.$,tc),tc.initialize(),
tc.kg()):Ba.TaskExtensions.za(this.KJ.value,fb=>{Td.a(fb.result,G.a.shareForm,{[S.a.APj]:this.$.workbookContext.SurveyTitle},this.$.ea.wg.get(10))||jd.a.ntw(Yc.ShareFormCommandUrl,this.$)},this.la,3)}Q9i(){const tc=this.$;tc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const Yc=new Sys.StringBuilder(tc.ya.SurveyRedirectUrl);wd.a.Mk(Yc,"startupDialog","FormEdit");const fb=Kb.a(this.$),Hb=fb.gd.activityState;Hb[oc.a.X1]=Yc.toString();Hb[oc.a.JL]=oc.a.gAd;this.$.Uk.Ky("SocialSharingEnvironmentChange");
nb.a(tc).tr(new bd.a(lc.a.ew,5,()=>{const cc=ya.a.ed(3,2,1320,1321,1322,554412057,"FossEnvironmentUnsupported");fb.gd.Wq([cc]);Hb[Qc.a.Bp]=lc.a.xig}))}y3a(tc=!1){return(this.$.ea.isEditMode||tc)&&this.$.ea.wg.get(25)&&Ib.a()}b3h(tc){var Yc=wc.h(this.$).ha;const fb=this.$.va.na?nd.d(this.$.va.na):null;if(!fb)return m.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${te[tc]}.`),null;var Hb=null;14===tc?Hb=this.A2h(Yc):12===
tc?(Hb=Yc.cia,Hb=Ma.a.contains(Hb,"!",!0)?Hb.split("!")[1]:Hb):13===tc&&(Yc=Yc.qa.selectedRanges,Yc[0]&&(Yc=wc.h(this.$).wb.zi(Yc[0])))&&(Hb=Yc.Gi);if(!Hb&&15!==tc)return m.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${te[tc]}`),null;Yc={};Yc[S.a.CMb]="copy";Yc[S.a.MSd]=this.cUh(tc,Hb,fb);Yc[S.a.kDj]="deepLinkShare";m.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${te[tc]} and sectionNameOrId: ${Hb} and SheetId: ${fb}`);
return Yc}A2h(tc){if(tc.Sa.G4&&(tc=tc.Sa.dc.floatingObject)&&0===tc.type){const Yc=tc.id.split(".");if(1<Yc.length)return Yc[1];m.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${tc.id}`)}return null}cUh(tc,Yc,fb){let Hb=tc+"_";Hb=btoa(15===tc?Hb+fb:Hb+(Yc+"_"+fb));Hb=Hb.replace(RegExp("\\+","g"),"-");Hb=Hb.replace(RegExp("\\/","g"),"_");return Hb=Hb.replace(RegExp("\\=+$","g"),"")}w$f(tc,Yc,fb=!1){return Ba.TaskExtensions.za(this.KJ.value,
Hb=>{Td.a(Hb.result,G.a.sharing,Yc,this.$.ea.wg.get(5))?(m.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${Yc?Yc[S.a.CMb]:""}`),fb&&oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.Gia&&(this.a3a=window.setInterval(()=>{this.EUj()},6E4),this.Gia=!0)):Ga.HelperMethods.gf(tc.FileSharingUrl,"_blank",
void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)}Fyc(tc,Yc){if(15===tc&&!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==tc&&!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const fb=this.b3h(tc);if(fb)return m.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${fb[S.a.MSd]}`),this.w$f(Yc,fb,!0);m.ULS.sendTraceTag(537151643,
0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${te[tc]}`);return null}EUj(){this.Gia&&window.clearInterval(this.a3a);oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Zc(638984051,0,0,null),m.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}Eb.DKi=[103];Eb.XDh=[107,104,105,106];Eb.YDh=[104,105];Eb.G2g=[new dc.a(lc.a.vDe,554412057,
0,0,1323),new dc.a(lc.a.idle,554412057,0,1)];Object(e.a)(Eb,"SocialSharingCommandHandler",cd.a,[221]);class Ac extends va.a{constructor(tc){super(tc)}hd(){const tc=new h.a(()=>na.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Xa));Ba.TaskExtensions.za(na.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),Yc=>{this.$c([new Eb(this.$,Yc.result,tc)])},this.la,3)}static ka(tc){va.a.Ld(114,new Ac(tc))}}Object(e.a)(Ac,"SocialSharingCommandHandlerFactory",va.a,[]);var ld=a(1176);class Vd{constructor(tc){this.hh=
tc}executeCommand(tc,Yc,fb){return 2!==this.hh.Wd(L.a.tryOfficeThroughTellMe,2,fb)?ia.Task.Ra(!0):Oa.a(Yc.command)}wc(tc,Yc){return 215809929===Yc.command}Mc(){return!1}Hc(){return!1}}Object(e.a)(Vd,"TryOfficeThroughTellMeCommandHandler",null,[221]);class Od extends va.a{constructor(tc){super(tc)}hd(){this.$c([new Vd(u.AFrameworkApplication.rb)])}static ka(tc){va.a.Ld(207,new Od(tc))}}Object(e.a)(Od,"TryOfficeThroughTellMeCommandHandlerFactory",va.a,[]);var he=a(160),Ye=a(266),se=a(150),bf=a(189);
class tf{static HU(){return se.a.xq(tf.Ll,bf.a.Ta(444))}}tf.Ll="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(e.a)(tf,"NamedSheetViewTeachingDialogHtml",null,[]);var Ie=a(68),uf=a(158),Ya=a(52);class Nb extends Ye.a{constructor(tc){super(tc);
this.stopwatch=this.jt=null;this.NJi=Yc=>{if(1===Yc)this.$.Ia.Hb(new jc.a(-2050946363,Ie.a.zb,2,8,null)).continueWith(fb=>{this.jt.setResult(!uf.a(fb)&&fb.result)}),Yc="Yes";else{const fb=2===Yc;this.jt.setResult(fb);Yc=2===Yc?"No":"Close";fb&&this.o8i()}this.OCi(Yc);this.hide()}}get kc(){return"ShowNamedSheetViewTeachingDialog"}ig(){this.Ob=4;this.stopwatch=this.$.Jb.Gc("UserAction",this.kc);const tc=Mc.a.instance.ga(1910);this.og=tf.HU();this.jt=new he.a;this.initializeAndShow(tc,this.NJi,{});return this.jt.task}qy(tc){super.qy(tc);
this.tc(1,Mc.a.instance.ga(1912));this.tc(2,Mc.a.instance.Ta(457))}o8i(){this.$.ea.aAd=!1}OCi(tc){const Yc={};Yc.a=this.$.ya.UserSessionId;Yc.b="NamedSheetViewTeachingDialogClose";Yc.c=tc;Yc.e=!0;this.stopwatch&&(this.stopwatch.stop(),Yc.d=this.stopwatch.Bc);Ya.b().Te(53,Yc,!0)}}Object(e.a)(Nb,"NamedSheetViewTeachingDialog",Ye.a,[]);var rc=a(161);class Oc{constructor(tc){this.$=tc;tc.da.Ha(309,this)}ASa(){return this.iGj()?(new Nb(this.$)).ig():ia.Task.Ra(!0)}iGj(){const tc=this.$.va.na;return this.$.ea.U9a&&
this.$.ea.aAd&&!tc.$d.iz&&this.$.ea.pM&&!rc.g(this.$)}}Object(e.a)(Oc,"NamedSheetViewPublic",null,[693]);class sd extends lb.a{constructor(tc){super();this.$=tc;this.Db()}create(){this.nb(this.$.da.Aa(309)||new Oc(this.$))}static ka(tc){tc.da.Ha(310,new sd(tc))}}Object(e.a)(sd,"NamedSheetViewPublicFactory",lb.a,[]);var zd=a(7),Pd=a(1360),ue=a(878),ze=a(462);class Ne{constructor(tc,Yc,fb,Hb,cc,Hc,od){this.title=tc;this.body=Yc;this.y8i=fb;this.primaryButtonAction=Hb;this.secondaryButtonAction=Hc;this.Z1f=
cc;this.targetObject=od}}Object(e.a)(Ne,"NamedSheetViewTeachingCalloutContent",null,[]);class ff{constructor(tc){this.kle=0;this.Odg=tc}get Mdg(){return this.kle}get a$i(){return this.Mdg<this.Odg.count?this.Odg.ma(this.kle++):null}}Object(e.a)(ff,"NamedSheetViewTeachingCalloutList",null,[]);var Ge=a(1095);class af{constructor(tc){this.stopwatch=this.C0b=this.JBc=this.bYd=null;this.Ndg=0;this.$=tc}Xfi(tc){this.Ndg=tc;const Yc=Object(zd.a)(new v.a,{});af.Doi(tc)?(Yc.add(new Ne(Mc.a.instance.Ta(446),
Mc.a.instance.Ta(447),Mc.a.instance.ga(1940),()=>{this.u5(2,"Continue");this.baa(!0)},Mc.a.instance.ga(1941),()=>{this.baa();this.u5(1,"ExitGuide")},Ge.a())),1===tc&&Yc.add(new Ne(Mc.a.instance.ga(1942),Mc.a.instance.Ta(449),Mc.a.instance.ga(1940),()=>{this.u5(2,"FirstEnterTempViewContinueSecond");this.baa(!0)},Mc.a.instance.ga(1941),()=>{this.baa();this.u5(1,"FirstEnterTempViewExitGuideSecond")},Ge.a())),Yc.add(new Ne(Mc.a.instance.Ta(450),Mc.a.instance.Ta(451),Mc.a.instance.ga(1940),()=>{this.u5(2,
"FirstEnterExitCalloutContinue");this.baa(!0)},Mc.a.instance.ga(1941),()=>{this.baa();this.u5(1,"FirstEnterExitCalloutGuide")},af.fZh())),Yc.add(new Ne(Mc.a.instance.ga(1943),Mc.a.instance.Ta(448),Mc.a.instance.ga(1944),()=>{this.WIj();this.baa();this.u5(1,"LearnMore")},Mc.a.instance.ga(1945),()=>{this.baa();this.u5(1,"Done")},af.eZh()))):2===tc&&Yc.add(new Ne(Mc.a.instance.ga(1942),Mc.a.instance.Ta(449),Mc.a.instance.ga(1939),()=>{this.baa();this.u5(1,"EnterTempViewAfterPersistedView")},null,null,
Ge.a()));this.bYd=new ff(Yc)}WIj(){const tc=new jc.a(-859308420,Ie.a.zb,this.$.xc,9,null);this.$.Ia.Hb(tc,{[Ie.a.Pf]:"HelpID=SheetViews",["InputMethod"]:Ie.a.zb,[Ie.a.Kc]:Kc.a.RU,["ShouldCanvasTakeFocus"]:!0})}show(tc){this.Xfi(tc);this.peb()}Kzj(tc){this.C0b=tc}peb(){var tc=this.bYd.a$i;if(tc){var Yc=Object(zd.a)(new Pd.a,{label:tc.y8i,onExecute:tc.primaryButtonAction}),fb=null;tc.Z1f&&(fb=Object(zd.a)(new Pd.a,{label:tc.Z1f,onExecute:tc.secondaryButtonAction}));tc=Object(zd.a)(new ue.a,{target:tc.targetObject,
content:tc.body,title:tc.title,showCloseIcon:!0,primaryButtonProps:Yc,secondaryButtonProps:fb,useTeachingStyles:!0});tc=this.C0b.callout(tc);Yc=Object(zd.a)(new ze.a,{onShow:()=>{this.u5(0)}});this.JBc=this.C0b.addNotification(tc,Yc)}}dismiss(){this.baa();this.u5(1,"DismissedByOthers")}baa(tc=!1){this.JBc&&(this.C0b.removeNotification(this.JBc),this.JBc=null);tc&&this.peb()}u5(tc,Yc=null){const fb={};fb.a=this.$.ya.UserSessionId;fb.b=this.Ndg;fb.c=this.bYd.Mdg;fb.d=tc;fb.e=Yc;0===tc?this.stopwatch=
this.$.Jb.Gc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),fb.f=this.stopwatch.Bc,this.stopwatch=null),2===tc&&(this.stopwatch=this.$.Jb.Gc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Ya.b().Te(52,fb,!0)}static eZh(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static fZh(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Doi(tc){return 0===tc||1===tc}}Object(e.a)(af,"NamedSheetViewTeachingCallout",
null,[692]);class wf extends lb.a{constructor(tc){super();this.$=tc;this.Db()}create(){let tc=this.$.da.Aa(322);tc||(tc=new af(this.$),this.$.da.Ha(322,tc));this.nb(tc)}static ka(tc){tc.da.Ha(323,new wf(tc))}}Object(e.a)(wf,"NamedSheetViewTeachingCalloutFactory",lb.a,[]);var cf=a(1273),vf=a(1167),ag=a(1272);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(b.a)();Type.registerNamespace("CADWLTR");d.main();Type.registerNamespace("Common.App.NewAndOpen.UX");f.a.instance.gi(new Ha);Object(Sa.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(Da.a)();Object(ea.a)();
Object(sa.a)();Object(Ea.a)();Type.registerNamespace("Common.App.SharedFilePicker");Ca.main();Type.registerNamespace("Common.App.WildFire");mb.main();Object(W.a)();Q.a.Fa(Wb.ka);Object(nc.a)();Object(Yb.a)();Object(pb.a)();Fa.a.Ai(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Q.a.Fa(tc=>{Ua.ka(tc)})})();(()=>{Q.a.Fa(tc=>{tc.da.Ha(165,
new sb(tc))})})();Q.a.Fa(za.ka);Object(Ra.a)();Object(Xa.a)();Object($a.a)();Object(ma.a)();Object(fa.a)();Object(eb.a)();Object(ua.a)();Object(xa.a)();Object(tb.a)();Object(Qb.a)();Object(ag.a)();(()=>{Q.a.Fa(tc=>{oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||Qd.ka(tc)})})();Q.a.Fa(Ac.ka);Object(ld.a)();Q.a.Fa(Od.ka);(()=>{Q.a.Fa(tc=>{sd.ka(tc);wf.ka(tc)})})();Object(cf.a)();Object(vf.a)()},722:function(t,F,a){a.d(F,"a",function(){return R});t=a(0);var c=
a(7),b=a(15),e=a(89),f=a(227),d=a(14),h=a(110),m=a(176),l=a(4),v=a(86);F=a(239);var r=a(1077),A=a(19),x=a(5),n=a(325),u=a(51),z=a(12),w=a(74),C=a(13),y=a(21),B=a(90),H=a(918),I=a(1);class R extends F.a{constructor(S,G){super(document.createElement("div"));this.kqf=this.Zse=this.fne=this.X3b=this.Wba=this.S7=this.GO=this.Qy=null;this.Tva=this.QU=this.Yr=this.hideCloseButton=!1;this.nPi=D=>{this.fD(D)};this.tPi=D=>{13===D.keyCode&&this.fD(D)};this.TBd=D=>{this.Rm(D.ub);return!0};this.YBd=D=>{this.wV(D.ub);
return!0};this.wpc=D=>{this.fma(D.ub?D.ub:0);return!0};this.oPi=D=>{this.fD(D.Ea);return!0};this.nqg=(D=null)=>{this.Rm(D.inputMethod?D.inputMethod:0);return!0};this.oqg=(D=null)=>{this.wV(D.inputMethod?D.inputMethod:0);return!0};this.Z0=S;this.mu=G;this.TZc=G.B_a.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get UZg(){return this.mu.B_a}get businessBar(){return this.Z0}get actionButton(){return this.mu?this.mu.actionButton:""}get Yra(){return this.mu?this.mu.Yra:
""}get linkText(){return this.mu?this.mu.link:""}get ek(){return this.mu?this.mu.ek:""}get alt(){return this.mu?this.mu.alt:""}yna(S){this.mu.businessBarType=S}dispose(){e.a.pc([this.X3b,this.GO,this.S7]);this.Yr&&this.GO&&(f.a.instance.Ba(d.a.click,this.GO.domElement,this.TBd),h.KeyInputManager.instance.Uw(this.domElement,this.fne));this.QU&&this.S7&&(f.a.instance.Ba(d.a.click,this.S7.domElement,this.YBd),h.KeyInputManager.instance.Uw(this.domElement,this.Zse));this.Tva&&this.Wba&&(f.a.instance.Ba(d.a.click,
this.Wba,this.wpc),h.KeyInputManager.instance.Uw(this.domElement,this.kqf));this.Wba=this.Qy=this.Z0=this.S7=this.GO=null;super.dispose()}update(){}oZj(){this.wIe(!0)}n5c(){this.wIe(!1)}Ofh(){const S=this.businessBar.$.Jb.zg("DOMUpdate","ReactBusinessBar");S.start();this.message=B.a.kf(this.message);this.title=B.a.kf(this.title);m.UISurfaces.thd().then(G=>{G.initializeMessageBarInStore();let D=Object(c.a)(new H.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.mu.businessBarType,
dismissButtonAriaLabel:C.a.instance.ga(10)});this.hideCloseButton||(D.onDismiss=this.oPi);this.Tva&&(D.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.wpc});this.Yr&&(D.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.nqg});this.QU&&(D.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.Yra,["onExecute"]:this.oqg});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.mu.iconName&&
(D.messageBarIconProps={["iconName"]:this.mu.iconName});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?G.createNewMessageBarWithCallback(this.domElement,D,()=>{S.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.mu.gJa} in: ${S.Bc} milliSeconds.`)}):G.createNewMessageBar(this.domElement,D);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.mu.gJa} could not be initialized`);return null});l.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")&&
(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}Zeh(S){S||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var G=this.businessBar.$.Bb;S=G+"ewaBusinessBarEntryBody"+this.TZc;const D=G+"ewaBusinessBarEntryTitle"+this.TZc;var E=G+"ewaBusinessBarEntryIcon"+this.TZc;
this.domElement.className=r.a.Yth;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){z.DOMElementExtensions.HG(this.domElement);G=document.createElement("div");G.className=r.a.WQe;G.id=S;var M=document.createElement("div");M.className=r.a.VQe;var L=document.createElement("a");L.className=r.a.bRe;L.title=this.alt;const N=document.createElement("span");N.classList.add(A.a.orb);N.classList.add(r.a.YQe);N.id=E;this.ek.length&&(E=document.createElement("img"),E.classList.add(this.ek),
E.src=u.a.qe(0),N.appendChild(E));L.appendChild(N);M.appendChild(L);E=document.createElement("span");E.classList.add(r.a.aRe);E.id=D;E.innerText=B.a.kf(this.title);M.appendChild(E);E=document.createElement("span");E.classList.add(r.a.$Qe);E.id="message";E.innerText=B.a.kf(this.message);M.appendChild(E);E=document.createElement("a");E.id="link";E.href="#";E.className=r.a.ZQe;E.innerText=B.a.kf(this.linkText);M.appendChild(E);E=document.createElement("span");E.classList.add(r.a.u9b);L=document.createElement("button");
L.type="button";L.id="action";L.className=r.a.t9b;L.innerText=B.a.kf(this.actionButton);E.appendChild(L);M.appendChild(E);E=document.createElement("span");E.classList.add(r.a.u9b);L=document.createElement("button");L.type="button";L.id="altAction";L.className=r.a.t9b;L.innerText=B.a.kf(this.Yra);E.appendChild(L);M.appendChild(E);G.appendChild(M);M=document.createElement("a");M.className=r.a.XQe;M.tabIndex=0;M.setAttribute("role","button");E=document.createElement("span");E.id="close";E.classList.add(A.a.Or);
L=document.createElement("img");L.classList.add(A.a.Jub);L.src=u.a.qe(13);L.alt=C.a.instance.ga(792);L.title=C.a.instance.ga(792);L.setAttribute("role","button");E.appendChild(L);M.appendChild(E);G.appendChild(M);this.domElement.appendChild(G)}else G="<div class='"+r.a.WQe+"' id='{0}'><div class='"+r.a.VQe+"'><a class='"+r.a.bRe+"' title='{1}'><span class='"+A.a.orb+" "+r.a.YQe+"' id='{2}'>",this.ek.length&&(G+="<img class='{3}' src='{4}'/>"),G+="</span></a><span class='"+r.a.aRe+"' id='{5}'>{6}</span><span class='"+
r.a.$Qe+"' id='message'>{7}</span><a id='link' href='#' class='"+r.a.ZQe+"'>{8}</a><span class='"+r.a.u9b+"'><button type='button' id='action' class='"+r.a.t9b+"'>{9}</button></span><span class='"+r.a.u9b+"'><button type='button' id='altAction' class='"+r.a.t9b+"'>{10}</button></span></div><a class='"+r.a.XQe+"' tabindex='0' role='button'><span id='close' class='"+A.a.Or+"'><img class='"+A.a.Jub+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",this.domElement.innerHTML=String.format(G,
S,this.alt,E,this.ek,u.a.qe(0),D,this.title,this.message,this.linkText,this.actionButton,this.Yra,u.a.qe(13),C.a.instance.ga(792));z.DOMElementExtensions.It(this.domElement,x.a.fsa,D,S);this.Wba=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.Wba,this.Tva);this.Tva&&(f.a.instance.ta(d.a.click,this.Wba,this.wpc),this.kqf=h.KeyInputManager.instance.Dt(this.Wba,this.wpc,v.a.Jh,v.a.XW));this.GO=new n.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.GO.isVisible=
this.Yr;this.S7=new n.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.S7.isVisible=this.QU;this.Yr&&(f.a.instance.ta(d.a.click,this.GO.domElement,this.TBd),this.fne=h.KeyInputManager.instance.Dt(this.GO.domElement,this.TBd,v.a.Jh,v.a.XW),this.QU&&(f.a.instance.ta(d.a.click,this.S7.domElement,this.YBd),this.Zse=h.KeyInputManager.instance.Dt(this.GO.domElement,this.YBd,v.a.Jh,v.a.XW)));this.Qy=$get("close",this.domElement);this.X3b=this.ze.ie(this.Qy);this.X3b.ka("click",
this.nPi);this.X3b.ka("keydown",this.tPi);z.DOMElementExtensions.setVisible(this.Qy,!this.hideCloseButton)}wIe(S){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")?this.Ofh():this.Zeh(S)}Rm(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.mu.gJa}`);y.h(this.businessBar.$).Do(!0)}wV(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.mu.gJa}`);
y.h(this.businessBar.$).Do(!0)}fma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.mu.gJa}`);y.h(this.businessBar.$).Do(!0)}fD(S){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.mu.gJa}`);this.set_visible(!1);this.businessBar.removeEntry(this.UZg);w.g(S)}FJ(){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")?
this.domElement.getElementsByTagName("button")[0]:this.GO.domElement}}Object(t.a)(R,"BusinessBarEntry",F.a,[])},793:function(t,F,a){a.r(F);var c=a(173);t=a(0);var b=a(7),e=a(15),f=a(4);a(27);var d=a(387),h=a(38),m=a(50),l=a(12),v=a(132),r=a(1),A=a(13),x=a(21);class n extends Sys.EventArgs{constructor(N){super();this.D8i=N}}Object(t.a)(n,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var u=a(264),z=a(251);class w{constructor(N){this.jg=N}Xh(){u.a(this.jg.$).kw(this.Yd)||u.a(this.jg.$).Xh(this)}E7(){u.a(this.jg.$).kw(this.Yd)&&
u.a(this.jg.$).Cz(this)}get Yd(){return z.a.KOf}get jc(){const {PrintPreviewPane:N}=a(793);return document.getElementById(N.B8i)}get Ff(){return!0}sh(N){return l.DOMElementExtensions.Af(this.jc,N)}rj(){this.jg.$.frame.Ke.kk(this.jg.$.frame.Ke.DE)}dk(){}ag(N,Y){return Y?!1:(this.jg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(t.a)(w,"PrintPreviewHeaderKeyboardAccessibleSection",null,[28]);class C{constructor(N){this.jg=N}Xh(){u.a(this.jg.$).kw(this.Yd)||u.a(this.jg.$).Xh(this)}E7(){u.a(this.jg.$).kw(this.Yd)&&
u.a(this.jg.$).Cz(this)}get Yd(){return z.a.LOf}get jc(){const {PrintPreviewPane:N}=a(793);return this.jg.useMSPdfViewer?document.getElementById(a(793).PrintPreviewPane.PFd):document.getElementById(N.eMf)}get Ff(){return!0}sh(N){return l.DOMElementExtensions.Af(this.jc,N)}rj(){this.jg.$.frame.Ke.kk(this.jg.$.frame.Ke.DE)}dk(){}ag(N,Y){return Y?!1:(this.jg.useMSPdfViewer?(N=document.getElementById(a(793).PrintPreviewPane.PFd))&&l.DOMElementExtensions.setFocus(N,!0):l.DOMElementExtensions.setFocus(this.jg.xK),
!0)}}Object(t.a)(C,"PrintPreviewKeyboardAccessibleSection",null,[28]);class y{constructor(N){this.jg=N}Xh(){u.a(this.jg.$).kw(this.Yd)||u.a(this.jg.$).Xh(this)}E7(){u.a(this.jg.$).kw(this.Yd)&&u.a(this.jg.$).Cz(this)}get Yd(){return z.a.NOf}get jc(){const {PrintPreviewPane:N}=a(793);return document.getElementById(N.XHd)}get Ff(){return!0}sh(N){return l.DOMElementExtensions.Af(this.jc,N)}rj(){this.jg.$.frame.Ke.kk(this.jg.$.frame.Ke.DE)}dk(){}ag(N,Y){return Y?!1:(this.jg.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)}}Object(t.a)(y,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[28]);class B{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(t.a)(B,"MSPdfViewerFileUrl",null,[]);class H{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=
!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(t.a)(H,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(t.a)(I,"ViewerPaneProps",null,[]);var R=a(1098),S=a(382),G=a(5);class D{}D.printDialogTitle="PrintDialogTitle";D.w9b="ewa-dlg-elements-container-rtl";D.Iw="PrintPreviewerContainer";Object(t.a)(D,"CssClassNames",null,[]);var E=a(186),M=a(105);a.d(F,"PrintPreviewPane",
function(){return L});class L extends h.a{constructor(N,Y,U,P){super();this.tDb=this.ylc=this.xK=this.nIb=this.Iw=this.LV=this.sD=this.tF=null;this.sDb=!1;this.Lwa=!0;this.YHd=this.UHd=this.VHd=this.ewaAccessibilityManager=this.vrc=null;this.Vpd=!1;this.qEf=()=>{e.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.sDb}`);this.sDb&&(this.Aci(),this.xK.style.visibility="visible",this.ylc?this.ylc.stop():e.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(L.gFb,new n(1)),this.wRd(),this.sDb=!1)};this.$=N;this.rD=Y;this.Bfh();this.useMSPdfViewer=U;this.isUniversalPrintEnabled=P;this.eF=r.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG");this.sAb=r.EwaSettings.isChangeGateEnabled("OfficeVSO:7451487_DisabledPrintBtnOnError");this.isExportPdfMode=!1}DNg(N){this.addHandler(L.gFb,N)}ikj(N){this.removeHandler(L.gFb,N)}uJj(N){this.isExportPdfMode=N;this.wfh()}vJj(){var N=this.$.Jb.Gc("UserAction","createSettingsPaneStopwatch");
const Y=document.getElementById(L.XHd);this.Cfh();const U=this.Dfh();this.sD.createPrintSettingsTaskPane(Y,U);N.stop();this.sDb=!1;if(this.isUniversalPrintEnabled&&this.Iw){N="A4";switch(U.selectedPrintSettingsValues.selectedPaperSize){case 8:N="A3";break;case 9:N="A4";break;case 11:N="A5";break;case 12:N="JIS B4";break;case 13:N="JIS B5";break;case 5:N="North America Legal";break;case 1:N="North America Letter";break;case 6:N="North America Invoice";break;case 7:N="North America Executive";break;
case 3:N="North America Ledger"}this.tF.setDocumentSettings({mediaSize:N,orientation:2===U.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===U.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.JKd()}setPageRangeSettings(N,Y,U,P,aa){this.sD&&(this.sD.setPageRangeSettings(N,Y,U,P,aa),this.H5f(String.format(A.a.instance.ob(205),P,aa,N)))}qci(){this.Iw&&(this.Iw.style.display="none")}Ynh(){this.dispose();this.E_d();this.m_d();this.tF&&this.tF.closePrintPreviewPane();
this.LV=this.sD=this.tF=this.Iw=null}sAi(N){e.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.tDb=this.$.Jb.Gc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||e.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.LV.renderPdf(N)):this.xK&&((this.ylc=this.$.Jb.Gc("UserAction","loadPdfStopwatch"))||e.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),
this.sDb=!0,this.xK.src&&this.xK.src===N?this.qEf(null):this.xK.src=N);if(this.eF&&this.Iw){const Y=S.b(this.$.workbookContext);this.tF.setFileUrl(N,Y)}}onPdfLoad(){this.tDb?(e.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.tDb.Bc} ms, isFirstTimeLoad: ${this.Lwa}`),this.tDb.stop()):e.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(L.gFb,new n(1));this.hideWaitCursor();this.sAb&&this.enablePrintButton();
this.wRd()}printPdf(){l.DOMElementExtensions.setFocus(this.xK);this.xK.contentWindow.print()}iKj(){this.showSpinner();this.showWaitCursor();this.sAb&&this.disablePrintButton();this.H5f("")}Aci(){this.hideSpinner();this.hideWaitCursor();this.sAb&&this.enablePrintButton()}Kz(N,Y,U=null){this.Iw&&this.LV&&(this.Vpd=!1,this.LV.showErrorDetails(Y,N,U),this.rD.E6a=!0,this.xK&&(this.xK.src=""),this.hideWaitCursor(),this.disablePrintButton(),L.Lri(Y)&&(this.Vpd=!0,this.hXi()))}hidePreviewError(){this.rD.E6a=
!1;this.LV.hidePreviewError();this.enablePrintButton()}Pnh(){(this.nIb=document.getElementById(L.MOf))&&this.nIb.parentNode&&this.nIb.parentNode.removeChild(this.nIb)}hideErrorMessageForPrintOptions(){this.sD&&this.sD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(N){this.sD&&this.sD.showErrorMessageForPrintOptions(N)}showSpinner(){this.rD.E6a||this.Vpd?this.hidePreviewError():this.xK&&(this.xK.style.visibility="hidden");this.LV&&this.LV.showSpinner()}hideSpinner(){this.LV&&this.LV.hideSpinner()}enablePrintButton(){this.sD&&
this.sD.enablePrintButton();this.eF&&this.Iw&&this.tF.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.sD&&this.sD.disablePrintButton();this.eF&&this.Iw&&this.tF.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.sD&&this.sD.showWaitCursor();!this.sAb&&this.eF&&this.Iw&&this.tF.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.sD&&this.sD.hideWaitCursor();!this.sAb&&this.eF&&this.Iw&&this.tF.updatePrintButtonEnableDisableState(!0)}zfh(){if(this.Iw)e.ULS.sendTraceTag(591927430,
0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Iw=document.createElement("div"),this.Iw.id=L.MOf,this.Iw.classList.add(L.E8i),this.$.Yq.insertBefore(this.Iw,this.$.Yq.firstChild),f.AFrameworkApplication.ra&&f.AFrameworkApplication.ra.Qa.Qe){const N=document.getElementById(G.a.bsa);N&&(this.Iw.style.top=`${N.clientHeight}px`,this.Iw.style.height=`calc(100vh - ${N.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.tF.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.tF.enterPrintSettingsTaskPaneFocusTrapZone()}q6i(){this.$.da.gb(15,
N=>{this.ewaAccessibilityManager=N;this.ewaAccessibilityManager.mode=3})}Bfh(){this.YHd=new y(this);this.VHd=new C(this);this.UHd=new w(this)}JKd(){this.YHd.Xh();this.VHd.Xh();this.UHd.Xh();this.q6i()}E_d(){this.YHd.E7();this.VHd.E7();this.UHd.E7();x.h(this.$).l0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}XH(){this.vrc=v.a.instance.ie(this.xK);this.vrc.ka("load",this.qEf)}m_d(){this.vrc&&this.xK&&this.vrc.detach("load")}wRd(){this.eF?this.M4f(L.C8i,L.HKi):this.M4f(L.XHd,
L.GOf)}M4f(N,Y){this.Lwa&&(N=document.getElementById(N))&&(Y=l.DOMElementExtensions.getElementById(N,Y))&&(this.Lwa=!1,Y.focus())}hXi(){this.rD.E6a=!1;this.enablePrintButton();this.wRd()}wfh(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void E.a.resolve(M.d,{Tl:0}).then(Y=>Object(c.a)(this,void 0,void 0,function*(){yield Y("excel-print-preview-sprite");yield Y("printPreviewer");yield Y("excelPrintPreviewer");this.DIe()}));else{var N=m.GetServiceTaskFactory.Oa(this.$.da,
283,284,0).result.Hl;N.loadScript("excel-print-preview-sprite").then(()=>{N.loadScript("printPreviewer").then(()=>{N.loadScript("excelPrintPreviewer").then(()=>{this.DIe()})},()=>{e.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{e.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}}DIe(){const N=
this.$.Jb.Gc("UserAction","createEmptyPreviewerStopwatch");this.zfh();this.Afh();this.eF?this.tF.createEmptyPrintPreviewPaneAsync(this.Iw,this.CIe()).then(()=>{N.stop();this.tFe();this.tF.updatePrintButtonEnableDisableState(!1)}):(this.tF.createEmptyPrintPreviewPane(this.Iw,this.CIe()),N.stop(),this.tFe())}tFe(){const N=this.$.Jb.Gc("UserAction","createPdfPreviewPaneStopwatch"),Y=document.getElementById(L.PFd);this.useMSPdfViewer&&(Y.tabIndex=0);this.ifh();this.hfh(Y);N.stop();this.raiseEvent(L.gFb,
new n(0))}Afh(){this.tF||(this.tF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.tF||e.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}Cfh(){this.sD||(this.sD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.sD||e.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}ifh(){this.LV||
(this.LV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.LV||e.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}hfh(N){this.LV.createPrintPreviewPane(N,this.Mhh());this.useMSPdfViewer||(this.xK=l.DOMElementExtensions.getElementById(this.Iw,L.eMf),this.xK.title=A.a.instance.ga(1210),this.XH())}Dfh(){let N,Y="en-US";N=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?
Y=this.$.ya.DataCultureTag:e.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(b.a)(new H,{whatToPrintOptions:this.rD.xv.whatToPrintOptions,orientationOptions:this.rD.xv.orientationOptions,paperSizeOptions:this.rD.xv.paperSizeOptions,scalingOptions:this.rD.xv.scalingOptions,marginDetailedOptions:this.rD.rYh(),selectedPrintSettingsValues:this.rD.s0h(),printSettingsTaskPaneCallbacks:this.rD.q0h(),
logger:new d.a,shouldDisableCurrentSelection:this.rD.S7f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:N,dataCultureTag:Y,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}CIe(){return this.eF?this.rD.o0h():Object(b.a)(new R.a,{backActionButtonText:A.a.instance.ga(1208),printPreviewPaneCallbacks:this.rD.b6e(),logger:new d.a,disableTellMeControl:!0,isExportPdfMode:!1})}Mhh(){return this.useMSPdfViewer?Object(b.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.veh(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(b.a)(new I,{useMSPdfViewer:!1})}veh(){return Object(b.a)(new B,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}H5f(N){this.Iw&&this.tF.setAdditionalHeaderText(N)}static Lri(N){return 3===N||2===N}}L.MOf="PrintPreviewerContainer";L.XHd="printSettingsTaskPaneId";L.PFd="previewId";L.eMf="printpreviewiframe";L.B8i="printPreviewHeaderId";L.GOf="printButton";
L.C8i="printPreviewPaneId";L.HKi="printButtonId";L.E8i=D.Iw;L.gFb="pppnosu";Object(t.a)(L,"PrintPreviewPane",h.a,[375])},853:function(t,F,a){a.d(F,"a",function(){return d});t=a(0);var c=a(15),b=a(4),e=a(40),f=a(27);class d{static k0e(h,m){switch(h){case 3:return d.F6h(m);case 2:return d.m_h(m);case 1:return d.rUh(m)}return""}static F6h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static m_h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static rUh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,m,l){if(f.a.Hg||f.a.Zo)window.setTimeout(()=>{d.cTf(l,d.Ddc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.Kte(l),h,0,!1)}static q5g(h,m,l,v){m&&
v&&v();d.openInClient(h,m,l)}static Ddc(){return f.a.Hg?1:f.a.Zo?2:f.a.i8a?3:f.a.isMac?4:0}static B6h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static C6h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get aBb(){return"zh-CN"===window.navigator.language}static cTf(h,m){1===m?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),h=d.k0e(h,m),8<f.a.I5a?e.a.gf(h,void 0,void 0,"RedirectToAppStore"):e.a.AU(h)):document.hidden||(d.aBb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.AU(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.k0e(h,
m),null,null)))}static Kte(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get vzc(){return(f.a.i8a||f.a.isMac)&&f.a.$o}static get AGj(){return f.a.Hg||f.a.Zo}static $ed(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static mrd(h){return(h=d.oXh(h))&&""!==h?Boolean.parse(h):!1}static sSd(h){d.hzj(h)}static oXh(h){try{return localStorage.getItem(h)}catch(m){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}}static hzj(h){try{localStorage.setItem(h,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}}}d.eCe="ChromeExtensionBarDismiss";Object(t.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/fe1849b7f3ecaea8f5ea9257ca43bb5b/EwaDSEsNext.kmhv.js.map