'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1001:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.Szi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.aqf="letName";c.all="*";c.bXd="structRefRange";Object(t.a)(c,"TraverseFormulaInterestTypes",null,[])},1002:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.cell="cell";c.range="range";c.row="row";c.column="col";Object(t.a)(c,
"TraverseFormulaRefTypes",null,[])},1184:function(t,F,a){t={};a.r(t);a.d(t,"CalcManager",function(){return ka});var c=a(0),b=a(15),e=a(226),f=a(173),d=a(8),h=a(111);a(175);var m=a(191),l=a(84),v=a(179),r=a(204),A=a(65);class x{}x.local="Local";x.vRj="Thread";Object(c.a)(x,"RecalcServiceCreateMode",null,[]);var n=a(166);class u{constructor(W){this.A6d=null;this.init(W)}get t$(){return this.A6d}init(W){this.A6d=new v.a;if(void 0!==W&&null!==W&&void 0!==W.HeadersList&&null!==W.HeadersList&&0<W.HeadersList.length)for(const Q of W.HeadersList)this.t$.ia(Q.Index,
Q.Name)}}Object(c.a)(u,"ColHeadersListData",null,[]);var z=a(1),w=a(33),C=a(101),y=a(22),B=a(21),H=a(177);class I{constructor(W,Q){this.jze=W;this.sheetName=Q;this.txc=!1}}Object(c.a)(I,"CalcBlockInformation",null,[]);class R{constructor(W,Q,va,na,Ba){this.type=W;this.fullName=Q;this.range=va;this.sheetId=na;this.attributes=Ba;this.uE=null}}Object(c.a)(R,"CalcNamedObject",null,[]);class S{get lk(){return this.Pje}constructor(W){this.klg=W;this.Pje=[];this.zig=[];this.M_a={};this.hTd=new Map}g6f(W,
Q){this.Pje[W]=Q;this.klg&&Q.d7&&this.hTd.set(Q.d7.sheetName,W)}getSheetIndex(W){if(this.klg){if(this.hTd.has(W))return this.hTd.get(W)}else for(let Q=1;Q<this.lk.length;Q++)if(y.a.equals(this.lk[Q].d7.sheetName,W,!1))return Q;return-1}}Object(c.a)(S,"GridCache",null,[]);var G=a(697),D=a(552);class E{constructor(W){this.d7=W;this.I5=new G.a(D.a.Ni());this.ync=!1}}Object(c.a)(E,"SheetInformation",null,[]);var M=a(955),L;(function(W){W[W.initialization=0]="initialization";W[W.contentReady=1]="contentReady";
W[W.cellEdit=2]="cellEdit"})(L||(L={}));Object(c.b)("UpdateDataTrigger",L);class N{constructor(W){this.QJd=null;this.kwd=this.PJd=this.dEd=!1;this.IHd=0;this.AHd=this.CHd=this.DHd=this.BHd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Kq=this.errorTypeNames=null;this.xt=this.currentStateId=-1;this.nta="";this.Q$=null;this.getNameLoc=(Q,va)=>this.xic()?this.df.ma(this.currentStateId).lk[0].I5.hb(va)?(Q=excelOnlineCalc.location.nameLoc(Q,va),excelOnlineCalc.util.success(Q)):
excelOnlineCalc.util.success(null):(Q=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Q));this.getContainingTable=Q=>{if(!this.xic())return Q=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Q);const va=Q.range.col,na=Q.range.row;var Ba=this.df.ma(this.currentStateId).lk[0].I5,Oa=null;for(let oa of Ba)if(Ba=oa.value,2===Ba.type&&y.a.equals(Q.sheet.index.toString(),Ba.sheetId,!0)){const Ja=Ba.range;va>=Ja.left-1&&va<=Ja.right-1&&na<=Ja.bottom-1&&na>=Ja.top-1&&(Oa=
excelOnlineCalc.location.nameScope(this.documentLoc,Ba.sheetId),Oa=excelOnlineCalc.location.nameLoc(Oa,Ba.fullName))}return Oa?excelOnlineCalc.util.success(Oa):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(Q,va)=>{if(!this.xic()){var na=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(na)}na=Q.name;var Ba=this.df.ma(this.currentStateId).lk[0].I5;if(Ba.hb(na)){Ba=Ba.ma(na);const oa=Ba.range;if(2!==Ba.type)return excelOnlineCalc.util.failure(this.T5c(5));const Ja=
Ba.uE?Ba.uE.t$:null;if(!Ja)return excelOnlineCalc.util.success(null);for(var Oa of Ja)if(y.a.equals(Oa.value,va,!0))return Q=excelOnlineCalc.location.documentLoc(Q.scope.document.path,Q.scope.document.name),Q=excelOnlineCalc.location.sheetIndex(Q,Ba.sheetId),Oa=excelOnlineCalc.location.gridRange(oa.top-1,Oa.key,oa.bottom-oa.top+1,1),Oa=excelOnlineCalc.location.sheetGridRange(Q,Oa),na=excelOnlineCalc.location.structRefColumnLoc(na,Oa,!!(Ba.attributes&16),!!(Ba.attributes&8)),excelOnlineCalc.util.success(na);
return oa.right-oa.left+1!==Ja.count?(na=excelOnlineCalc.util.unavailable([17,Q,va]),excelOnlineCalc.util.failure(na)):excelOnlineCalc.util.failure(this.T5c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(Q,va)=>{if(!this.xic())return va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(va);var na=this.df.ma(this.currentStateId).lk[0].I5;if(na.hb(Q.name)){var Ba=na.ma(Q.name);if(2!==Ba.type)return excelOnlineCalc.util.failure(this.T5c(5));na=!!(Ba.attributes&
16);const Oa=!!(Ba.attributes&8),oa=na?1:0,Ja=Oa?1:0;Q=excelOnlineCalc.location.documentLoc(Q.scope.document.path,Q.scope.document.name);Q=excelOnlineCalc.location.sheetIndex(Q,Ba.sheetId);Ba=Ba.range;let Wb={};if(1===va)Wb=excelOnlineCalc.location.gridRange(Ba.top-oa-1,Ba.left-1,Ba.bottom+Ja-Ba.top+oa+1,Ba.right-Ba.left+1);else if(2===va)Wb=excelOnlineCalc.location.gridRange(Ba.top-1,Ba.left-1,Ba.bottom-Ba.top+1,Ba.right-Ba.left+1);else if(3===va)if(na)Wb=excelOnlineCalc.location.gridRange(Ba.top-
2,Ba.left-1,1,Ba.right-Ba.left+1);else return excelOnlineCalc.util.success(null);else if(4===va)if(Oa)Wb=excelOnlineCalc.location.gridRange(Ba.bottom,Ba.left-1,1,Ba.right-Ba.left+1);else return excelOnlineCalc.util.success(null);va=excelOnlineCalc.location.sheetGridRange(Q,Wb);return excelOnlineCalc.util.success(va)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(Q,va)=>{if((y.a.equals(Q,this.documentLoc.path,!0)||!Q)&&y.a.equals(va,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
Q=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(Q,va)]);return excelOnlineCalc.util.failure(Q)};this.getSheetIndex=(Q,va)=>{if(!this.df.hb(this.currentStateId)||!this.df.ma(this.currentStateId).lk)return va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(va);Q=this.df.ma(this.currentStateId).lk;for(let na=1;na<Q.length;na++)if(y.a.equals(Q[na].d7.sheetName,va,!0))return excelOnlineCalc.util.success(Q[na].d7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(Q,va)=>{if(!this.df.hb(this.currentStateId)||!this.df.ma(this.currentStateId).lk)return va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(va);Q=this.df.ma(this.currentStateId).lk;for(let na=1;na<Q.length;na++)if(y.a.equals(Q[na].d7.sheetId,va,!0))return excelOnlineCalc.util.success(Q[na].d7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.WFf=()=>{this.setNumberFormats()};this.dd=()=>{b.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.df=new v.a;this.currentStateId=this.xt=-1;this.nta="";this.Ssb=null;this.PJd=!1;this.Kq&&this.clearCache()};this.Oc=W;this.df=new v.a;this.Ssb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Oc.workbookContext.FullDocumentInfo.BreadcrumbDocName);
this.Aoa();this.Iqd=w.a.Iqd();this.eIh=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7403363_fixTextWithWhitespaces")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.cMd(this.WFf);this.Oc&&this.Oc.pl(this.dd);this.close()}HPb(W){if(!this.Kq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Oc.da.Aa(268),!this.instantaneousSupportInformationManager))return b.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==W&&(this.currentStateId=this.Oc.ea.YCb,this.currentStateId===d.a.oe&&(this.currentStateId=this.Oc.ea.se));if(1===W&&this.currentStateId<this.xt)return b.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.xt} - ignoring update`),!1;this.Fxj();0!==W&&this.PJd||(this.$Bj(),this.ezj(),this.Rzj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.bre(this.WFf),this.Oc.Lk(this.dd),this.PJd=!0);this.rdj();
let Q=!1;0===W&&(Q=this.$gi());if(0!==W||Q)this.mBj()?(this.OBj(W),this.NBj(),this.xt=this.currentStateId,this.q4g()):b.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==W&&this.resumeRecalc();return!0}evalFormula(W,Q,va,na){if(!this.Kq)return b.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});Q=excelOnlineCalc.calc.sheetCellLocation(null!==va&&void 0!==va?
va:A.d(this.Oc.va.na),Q.top-1,Q.left-1);W=this.Kq.evalFormula(this.Oc.ea.se,W,Q,na);this.resumeRecalc();return W}a0g(W,Q,va,na=null){const Ba=A.d(this.Oc.va.na);let Oa=W.cell.vQ-1,oa=W.cell.uQ-1;var Ja=Oa,Wb=oa;let nc=null;na&&(nc=excelOnlineCalc.calc.cellLocation(Oa,oa),Oa=na.top-1,oa=na.left-1,Ja=na.bottom-1,Wb=na.right-1);va=this.x1d(W,va,"SetCell");0>va||(Wb=N.M$("CalculateFormula.cell",Ba,Oa,oa,Ja,Wb),Ja=[],na=this.Hjd(Ba),Q=excelOnlineCalc.calc.inferredRangeFormulaEdit(Wb,Q,nc,na),Ja.push(Q),
W=(Q=this.S8e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ba,Oa,oa,y.a.ite(W.cell.text),va,Q.top-1,Q.left-1,Q.bottom-1,Q.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ba,Oa,oa,y.a.ite(W.cell.text),va,"","","",""),b.ULS.sendTraceTag(537170180,0,50,W),this.Kq.editRangeFormulas(va,Ja),this.resumeRecalc())}Aub(W,Q,va,
na){if(!this.Kq)return b.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!va||!Q)return b.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!va}, outputColumnRange null: ${!Q}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");b.ULS.shipAssertTag(537170178,0,va.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Ba=A.d(this.Oc.va.na),Oa=this.Hjd(Ba);var oa=null;if(W){oa=[];for(const Wb of W)if(Wb.column!==va.left){W=Wb.row-1;var Ja=Wb.column-1;W=N.M$("EvalFormulaRangeOnClone.cell",Ba,W,Ja,W,Ja);Ja=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?Y(Wb.Fr,Wb.formulaBarText,Wb.hj):excelOnlineCalc.calc.valueCellData(Wb.text,Wb.text,Wb.hj,null);oa.push(excelOnlineCalc.calc.rangeWrite(W,Ja))}}va=excelOnlineCalc.calc.cellLocation(va.top-1,va.left-1);Q=N.M$("EvalFormulaRangeOnClone.outputColumnRange",
Ba,Q.top-1,Q.left-1,Q.bottom-1,Q.right-1);na=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(Q,na,va,Oa)];oa=this.Kq.evalOnClonedModel(oa,na);this.resumeRecalc();return oa}mJe(W){let Q=null;try{if(W)if(this.nta=B.h(this.Oc).Ca.Uua(W),this.currentStateId=W.jTa,this.currentStateId<this.xt||this.currentStateId===d.a.oe)b.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.nta} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.xt}`);else{if(this.fhi(),
!this.gWg())if(Q=this.Oc.Jb.Gc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.nta} StateId:${this.currentStateId}`),this.Ssb=this.Mxb(W.na.sheetName),!this.Ssb){const Oa=!!(this.Oc.qd&32),oa=this.df.hb(this.currentStateId)&&this.df.ma(this.currentStateId).lk?this.df.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${oa}, scratchPad:${Oa}, sheetNameLength:${W.na.sheetName?
W.na.sheetName.length:-1} Hash:${W.na.hash}`)}else if(B.h(this.Oc).Ca.Am.X1a(W.Xc)){var va=W.lf;if(va){var na=va.getCalcBlockModel();if(!na)b.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.ZVg(na)){this.df.ma(this.currentStateId).M_a[this.nta]=new I(na,W.na.sheetName);var Ba=W.Td;Ba?this.yJg(Ba.NamedObjects):b.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else b.ULS.sendTraceTag(537170146,
0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.nta}`)}}else b.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{Q&&Q.stop()}}Qxb(W){var Q;if(!this.df.hb(this.currentStateId))return b.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const va=null===(Q=this.df.ma(this.currentStateId))||void 0===Q?void 0:Q.lk;
if(!va||!va[0])return null;Q=va[0].I5;if(!Q||!Q.hb(W.name))return b.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==Q}`),null;W=Q.ma(W.name);if(!W||!W.uE)return null;Q=new m.a;for(let na of W.uE.t$)Q.add(na.value);return Q}b0g(W,Q,va){var na=B.h(this.Oc),Ba=na.Qb(Q);Ba=this.x1d(Ba,null,"CopyPaste");va=this.x1d(na.Qb(W),va,"CopyPaste");if(0>Ba||0>va||Ba!==va)b.ULS.sendTraceTag(537170143,
0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${va}, targetRevision:${Ba}.`);else{va=[];na=A.d(this.Oc.va.na);var Oa=this.Hjd(na);W=N.M$("CalculateFormulaForCopyPaste.srcRange",na,W.top-1,W.left-1,W.bottom-1,W.right-1);Q=N.M$("CalculateFormulaForCopyPaste.targetRange",na,Q.top-1,Q.left-1,Q.bottom-1,Q.right-1);Q=excelOnlineCalc.calc.copyPasteRangePasteEdit(Q,W,Oa);va.push(Q);Q=Oa?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
na,Ba,Oa.row,Oa.column,Oa.lastRow,Oa.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",na,Ba,"","","","");b.ULS.sendTraceTag(537170142,0,50,Q);this.Kq.editRangePaste(Ba,va);this.resumeRecalc()}}Hjd(W){const Q=this.S8e();let va=null;Q?va=N.M$("GetViewport.viewport",W,Q.top-1,Q.left-1,Q.bottom-1,Q.right-1):b.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");
return va}S8e(){const W=B.h(this.Oc);let Q=W.fi;if(B.h(this.Oc).ib.gj){Q=W.Rf(1).fi;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!Q)return b.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;Q.Pda(1,1);Q.Pda(3,1)}return Q}x1d(W,Q,va){let na;if(!this.Kq||!W)return b.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Kq}, modifiedCell is null:${!W}, operation:${va}`),
-1;const Ba=W.cell.vQ-1,Oa=W.cell.uQ-1;if(W.cell.Ux){if(na=W.cell.Ux.sxe,na===d.a.oe)return b.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${W.cell.Ux.Xc}, operation:${va}`),-1}else return b.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${W.cell.vQ},${W.cell.uQ}), operation:${va}`),-1;if(na<this.xt)return b.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Ba},${Oa}) - blockRevision:${na} < lastUpdatedStateId:${this.xt}, operation:${va}`),
-1;if(na<this.currentStateId)return b.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Ba},${Oa}) - blockRevision:${na} < currentStateId:${this.currentStateId}, operation:${va}`),-1;Q&&!this.dEd&&(this.Kq.setOnRecalcResults(Q),this.dEd=!0);return this.xYj()&&!this.HPb(2)?(b.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${va}`),-1):na}getFormulaBarText(W,Q,va){return Q&&Q.startsWith("'")?
Q:W.cell.formulaBarText||va.toString()}Mfh(W,Q,va){let na=null;if(this.Wze()&&this.df.ma(this.xt).M_a){const Ba=this.df.ma(this.xt).M_a[W];if(null===Ba||void 0===Ba?0:Ba.txc)na=Ba.jze}va=this.Rli(na,Q,va);Q=this.I7g(na,Q,va);b.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${W} StateId:${this.currentStateId} number of formulas ${Q}`)}Rli(W,Q,va){let na=!1;const Ba=N.L0e(Q);if(W){const Oa=N.L0e(W);y.a.equals(Oa,Ba,!1)&&(na=!0)}na?this.ZJg(W,this.xt,
va):this.aKg(Q,va);return na}Wze(){let W=!1;this.Kq&&-1!==this.xt&&(W=this.Kq.stateIdAvailable(this.xt));return W&&this.df.hb(this.xt)&&this.xt<this.currentStateId}I7g(W,Q,va){let na;na=0;let Ba,Oa;for(Q.reset();Ba=Q.getNextCell();)H.f(Ba.formula)&&na++,(Oa=va?W.getCell(Ba.row,Ba.col):null)?this.E7g(Q,Ba,Oa):this.$Jg(Q,Ba);if(va)for(W.reset();Oa=W.getNextCell();)(Ba=Q.getCell(Oa.row,Oa.col))||this.npe(W,Oa);return na}Rzj(){this.Kq.setOnUpdateRequest(()=>{})}Qzj(){this.Kq.setOnUnresponsive((W,Q,va,
na)=>{this.l0i(W,Q,va,na)})}l0i(W,Q,va,na){b.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${W}, waitTime:${Q}, timeoutCount:${va}, hasBeenClosed:${na}.`);na&&(this.Boj(),this.Aoa())}Boj(){this.dd(null,null);this.kwd=this.dEd=!1;this.IHd=0;this.AHd=this.CHd=this.DHd=this.BHd=-1}close(){this.Kq.close()}clearCache(){this.Kq.clearCache()}resumeRecalc(){this.Kq.resumeRecalc()}ezj(){this.Kq.setA1ReferenceStyle(!0)}rdj(){if(this.instantaneousSupportInformationManager){var W=
this.instantaneousSupportInformationManager.fji;const va=this.instantaneousSupportInformationManager.iji,na=this.instantaneousSupportInformationManager.hji,Ba=this.instantaneousSupportInformationManager.gji;var Q=!1;W!==this.BHd&&(Q=!0,this.BHd=W);va!==this.DHd&&(Q=!0,this.DHd=va);na!==this.CHd&&(Q=!0,this.CHd=na);Ba!==this.AHd&&(Q=!0,this.AHd=Ba);const Oa=[];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(Q=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Oa.push(Q),Q=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(Q=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Oa.push(Q),Q=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(Q=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Oa.push(Q),Q=!0);Q&&(W=excelOnlineCalc.calc.recalcServiceConfig(null,W,null,va,null,null,null,na,Oa,Ba),this.Kq.reconfigure(W))}}OBj(W){let Q=null;
if(this.df.hb(this.currentStateId))try{this.Q$=[],Q=this.Oc.Jb.Gc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${L[W]}`),h.a.forEach(this.df.ma(this.currentStateId).M_a,(va,na)=>{na.txc||(this.Mfh(va,na.jze,na.sheetName),na.txc=!0)},null),this.Kq.updateRanges(this.currentStateId,this.Q$)}finally{Q&&Q.stop()}else b.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}NBj(){const W=
[],Q=this.Wze();var va=Q&&this.df.ma(this.xt).lk&&this.df.ma(this.xt).lk[0]&&this.df.ma(this.xt).lk[0].ync?this.df.ma(this.xt).lk[0].I5:null;this.YEe(va,this.df.ma(this.currentStateId).lk[0].I5,null,this.xt,W);this.df.ma(this.currentStateId).lk[0].ync=!0;for(let na=1;na<this.df.ma(this.currentStateId).lk.length;na++)va=-1,Q&&this.df.ma(this.xt).lk&&(va=this.Nid(this.df.ma(this.currentStateId).lk[na].d7.sheetName,this.xt)),va=-1!==va&&this.df.ma(this.xt).lk[va].ync?this.df.ma(this.xt).lk[va].I5:null,
this.YEe(va,this.df.ma(this.currentStateId).lk[na].I5,this.df.ma(this.currentStateId).lk[na].d7.sheetId,this.xt,W),this.df.ma(this.currentStateId).lk[na].ync=!0;this.Kq.updateNamedObjects(this.currentStateId,W)}YEe(W,Q,va,na,Ba){if(void 0!==va&&null!==va){var Oa=excelOnlineCalc.calc.undefinedNamesWrite(va);Ba.push(Oa)}if(W){var oa=!1;Oa=[];var Ja=[];if(Q)for(let nc of Q){const Yb=nc.value;if(W.hb(nc.key)){var Wb=W.ma(nc.key);N.OKi(Wb,Yb)?oa=!0:(Wb=excelOnlineCalc.calc.namedObject(nc.key,null),Oa.push(Wb),
N.AWc(nc.key,Yb,Ja))}else N.AWc(nc.key,Yb,Ja)}for(let nc of W)Q&&Q.hb(nc.key)||(W=excelOnlineCalc.calc.namedObject(nc.key,null),Oa.push(W));oa&&(Q=excelOnlineCalc.calc.namedObjectsPromote(va,na),Ba.push(Q));0<Oa.length&&(Q=excelOnlineCalc.calc.namedObjectsWrite(va,Oa),Ba.push(Q));0<Ja.length&&(va=excelOnlineCalc.calc.namedObjectsWrite(va,Ja),Ba.push(va))}else if(Q){na=[];for(Ja of Q)N.AWc(Ja.key,Ja.value,na);0<na.length&&(va=excelOnlineCalc.calc.namedObjectsWrite(va,na),Ba.push(va))}}gWg(){return this.df.ma(this.currentStateId).M_a[this.nta]?
(b.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.nta} StateId:${this.currentStateId} previously handled`),!0):!1}ZVg(W){return 1===W.getColumnNumbers().length&&W.getColumnNumbers()[0]===N.Nyd+1?!1:!0}$gi(){let W=!1;B.h(this.Oc).Ca.Evb(Q=>{Q.state&1&&this.Oc.ea.se===Q.ae.Revision&&(this.mJe(Q),W=!0)});return W}gHe(W,Q){var va=W.getRowNumbers(),na=W.getColumnNumbers();W=va[0]-1;va=va[va.length-1]-1;const Ba=na[0]-1;na=na[na.length-1]-1;Q=this.Mxb(Q);if(!Q){const Oa=
this.df.hb(this.currentStateId)&&this.df.ma(this.currentStateId).lk?this.df.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Oa}`)}return N.M$("CreateBlockRangeLocation",Q,W,Ba,va,na)}ZJg(W,Q,va){if(va=this.gHe(W,va)){var na=N.I5b(W.getRowNumbers());W=N.I5b(W.getColumnNumbers());Q=excelOnlineCalc.calc.rangePromote(va,Q,na,W);this.Q$[this.Q$.length]=Q}}aKg(W,Q){if(Q=this.gHe(W,Q)){var va=
N.I5b(W.getRowNumbers());W=N.I5b(W.getColumnNumbers());W=excelOnlineCalc.calc.rangeWrite(Q,null,va,W);this.Q$[this.Q$.length]=W}}E7g(W,Q,va){let na=null,Ba=0,Oa=0;switch(Q.valueType){case 2:na=this.Ejd(Q);var oa=this.Ejd(va);oa=y.a.equals(oa,na,!1);break;case 1:null===Q.value&&null===va.value?oa=!0:(Ba=parseFloat(Q.value),oa=parseFloat(va.value)===Ba);break;default:null===Q.value&&null===va.value?oa=!0:(Oa=parseFloat(Q.value),oa=Oa===parseFloat(va.value))}oa&&Q.valueType===va.valueType&&Q.ifmt===
va.ifmt&&Q.formulaType===va.formulaType&&y.a.equals(va.formula,Q.formula,!1)||(void 0!==Q.formula&&null!==Q.formula||void 0!==Q.value&&null!==Q.value||void 0!==Q.text&&null!==Q.text||this.eIh&&0!==Q.valueType?this.g_b(W,Q,na,Ba,Oa):this.npe(W,Q))}yJg(W){if(this.Oc.yb&&this.Oc.yb.items)for(let Oa=0;Oa<this.Oc.yb.count;Oa++){var Q=this.Oc.yb.items[Oa];if(2!==Q.type&&3!==Q.type)continue;var va=0,na=Q.name,Ba=na.lastIndexOf("!");if(0<Ba){va=na.substr(0,Ba);"'"===va.charAt(0)&&(va=va.substr(1,va.length-
2));va=this.Nid(va,this.currentStateId);if(-1===va){Q=this.df.hb(this.currentStateId)&&this.df.ma(this.currentStateId).lk?this.df.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Q}`);continue}na=na.substr(Ba+1)}va=this.df.ma(this.currentStateId).lk[va].I5;let oa=Q.usedRange;2===Q.type&&(oa=n.a(Q));if(va.hb(na)){if(Ba=va.ma(na),Ba.range=oa,Ba.attributes=Q.attributes,2===Ba.type&&(na=N.QXe(Q.name,
W),Q=(va=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?Q.lO:null===na||void 0===na?void 0:na.ColHeadersList,na||va))if(!Ba.uE)Ba.uE=new u(Q);else if(Q)for(const Ja of Q.HeadersList)Ba.uE.t$.ia(Ja.Index,Ja.Name)}else if(Ba=this.Mxb(Q.sheetName)){Ba=new R(Q.type,Q.name,oa,Ba,Q.attributes);if(2===Ba.type)if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&Q.lO)Ba.uE=new u(Q.lO);else if(Q=N.QXe(Q.name,W))Ba.uE=new u(Q.ColHeadersList);
va.ia(na,Ba)}else Q=this.df.hb(this.currentStateId)&&this.df.ma(this.currentStateId).lk?this.df.ma(this.currentStateId).lk.length:0,b.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Q}`)}}g_b(W,Q,va,na,Ba){var Oa=W.getRowNumbers()[Q.row]-1;W=W.getColumnNumbers()[Q.col]-1;Oa=N.M$("AddRangeUpdateCommand",this.Ssb,Oa,W,Oa,W);W=null;let oa=Q.formula||Q.text;const Ja=excelOnlineCalc.calc.blankValue;let Wb=null;void 0!==Q.text&&null!==
Q.text||void 0!==Q.value&&null!==Q.value||(va="",Wb="This cell contains blanks only",0===Q.formulaType&&(oa=""));switch(Q.valueType){case 2:null!==va&&(0===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData(oa,va,Q.ifmt,Wb)),1===Q.formulaType&&(W=excelOnlineCalc.calc.cellFormulaCellData(oa,va,Q.ifmt,Wb)),2===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData("",Ja,0,"This cell is a part of an array")));break;case 1:isNaN(na)?b.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${Q.row},${Q.col}) invalid numeric value`):
(0===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData(oa,na,Q.ifmt,null)),1===Q.formulaType&&(W=excelOnlineCalc.calc.cellFormulaCellData(oa,na,Q.ifmt,null)),2===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData("",Ja,0,"This cell is a part of an array")));break;case 3:isNaN(Ba)?b.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${Q.row},${Q.col}) invalid boolean value`):(va=1===Ba?!0:!1,0===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData(oa,va,Q.ifmt,null)),
1===Q.formulaType&&(W=excelOnlineCalc.calc.cellFormulaCellData(oa,va,Q.ifmt,null)),2===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData("",Ja,0,"This cell is a part of an array")));break;case 4:isNaN(Ba)?b.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${Q.row},${Q.col}) invalid error value`):(va=excelOnlineCalc.calc.errorValue(Ba),0===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData(oa,va,Q.ifmt,null)),1===Q.formulaType&&(W=excelOnlineCalc.calc.cellFormulaCellData(oa,
va,Q.ifmt,null)),2===Q.formulaType&&(W=excelOnlineCalc.calc.valueCellData("",Ja,0,"This cell is a part of an array")));break;default:W=excelOnlineCalc.calc.valueCellData("",Ja,Q.ifmt,null)}W&&(Q=excelOnlineCalc.calc.rangeWrite(Oa,W,null,null),this.Q$[this.Q$.length]=Q)}$Jg(W,Q){switch(Q.valueType){case 2:this.g_b(W,Q,this.Ejd(Q),null,0);break;case 1:this.g_b(W,Q,null,parseFloat(Q.value),0);break;default:this.g_b(W,Q,null,null,parseFloat(Q.value))}}npe(W,Q){var va=W.getRowNumbers()[Q.row]-1;W=W.getColumnNumbers()[Q.col]-
1;va=N.M$("AddRangeUpdateCommandEmptyCell",this.Ssb,va,W,va,W);Q=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,Q.ifmt,null);Q=excelOnlineCalc.calc.rangeWrite(va,Q,null,null);this.Q$[this.Q$.length]=Q}Mxb(W){W=this.Nid(W,this.currentStateId);return 0<W?this.df.ma(this.currentStateId).lk[W].d7.sheetId:null}Nid(W,Q){if(!this.df.hb(Q))return b.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${Q} does not exist in GridCache`),-1;const va=this.df.ma(Q);
return va.lk?va.getSheetIndex(W):(b.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${Q}`),-1)}mBj(){if(!this.df.hb(this.currentStateId)||!this.df.ma(this.currentStateId).lk.length)return b.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const W=[];for(let Q=1;Q<this.df.ma(this.currentStateId).lk.length;Q++){const va=
this.df.ma(this.currentStateId).lk[Q];va&&W.push(va.d7)}this.Kq.updateSheetNames(this.currentStateId,W);this.Kq.updateUnusedCells(this.currentStateId,this.df.ma(this.currentStateId).zig);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var W=[];for(const Q of this.instantaneousSupportInformationManager.pya){const va=excelOnlineCalc.calc.numberFormat(Q.IfmtIndex,Q.FormatString,Q.Builtin);W.push(va)}this.Kq.setNumberFormats(W,!0)}}Fxj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.He){var W=this.dhi();if(!this.kwd||W)this.H5b(),this.instantaneousSupportInformationManager.He.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.He.TrueValueString),this.instantaneousSupportInformationManager.He.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.He.FalseValueString),W=M.CalcHelper.bIe(this.instantaneousSupportInformationManager,W),this.Kq.setLocale(W),this.kwd=!0}}$Bj(){var W=null;if(void 0!==
this.Oc.workbookContext.TimeZoneInformation&&null!==this.Oc.workbookContext.TimeZoneInformation){W=null;this.Oc.workbookContext.TimeZoneInformation.StandardDate.Month&&(W=excelOnlineCalc.date.dateTime(this.Oc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Oc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Oc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Oc.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Oc.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.Oc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Oc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Oc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let Q=null;this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(Q=excelOnlineCalc.date.dateTime(this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Oc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));W=excelOnlineCalc.date.tzData(this.Oc.workbookContext.TimeZoneInformation.Bias,W,this.Oc.workbookContext.TimeZoneInformation.StandardBias,Q,this.Oc.workbookContext.TimeZoneInformation.DaylightBias)}else b.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");W=excelOnlineCalc.calc.workbookProps(this.Oc.workbookContext.F1904,this.Oc.workbookContext.FDateCompatibility,W);this.Kq.setWorkbookProps(W)}Aoa(){const W=z.EwaSettings.sa(570)?x.local:x.vRj,[Q,va]=w.a.bV(this.Oc)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.QJd=r.c(excelOnlineCalc.calc.createRecalcService(W,Q,va));this.QJd.continueWith(na=>
{na.exception?b.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${na.exception.toString()}`):(b.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Kq=this.QJd.result)?this.HPb(0)?this.Qzj():b.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):b.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}dhi(){const W=
this.instantaneousSupportInformationManager.jja;if(!W||this.IHd===W.length)return null;this.IHd=W.length;return M.CalcHelper.OHe(W)}H5b(){this.errorTypeNames=M.CalcHelper.H5b()}fhi(){if(!(this.df.hb(this.currentStateId)&&0<this.df.ma(this.currentStateId).lk.length)){this.df.ia(this.currentStateId,new S(this.Iqd));this.df.ma(this.currentStateId).g6f(0,new E(null));var W=this.Oc.va;for(let na=0;na<W.count;na++){var Q=Object(l.a)(C.a,W.getItem(na));if(Q){void 0!==Q.sheetId&&null!==Q.sheetId&&void 0!==
Q.name&&null!==Q.name&&Q.sheetId.length&&Q.sheetName.length||b.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${na} Id:${Q.sheetId} Hash:${Q.hash} NameLength:${Q.name?Q.name.length:-1}`);var va=void 0;va=excelOnlineCalc.calc.sheetName(Q.sheetId,Q.name);this.df.ma(this.currentStateId).g6f(na+1,new E(va));va=Q.usedRange.ZR();va=excelOnlineCalc.calc.rangeLocation(0,0,va.LastRow,va.LastColumn);Q=excelOnlineCalc.calc.unusedCellsUpdate(Q.sheetId,va);this.df.ma(this.currentStateId).zig.push(Q)}else b.ULS.sendTraceTag(537170073,
0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${na}`)}}}q4g(){for(let W of this.df)W.key<this.xt&&this.df.remove(W.key)}Ejd(W){W=W.value||W.text;if(void 0===W||null===W)W="";return W}xYj(){if(!this.df.hb(this.currentStateId))return!1;let W=!1;h.a.forEach(this.df.ma(this.currentStateId).M_a,(Q,va)=>{va.txc||(W=!0)},null);return W}T5c(W){const Q={};Q.reason=W;Q.kind=1;return Q}xic(){return this.df.hb(this.currentStateId)&&this.df.ma(this.currentStateId).lk&&
this.df.ma(this.currentStateId).lk[0]&&this.df.ma(this.currentStateId).lk[0].I5?!0:!1}static Nbh(W){const Q=[];if(null===W||void 0===W?0:W.t$)for(let va of W.t$)W=excelOnlineCalc.calc.columnData(va.key,va.value),Q.push(W);return Q}static OKi(W,Q){if(W.type!==Q.type||W.attributes!==Q.attributes||!y.a.equals(W.fullName,Q.fullName,!1)||!W.range.equals(Q.range))return!1;if(!W.uE&&!Q.uE)return!0;if(!W.uE||!Q.uE||W.uE.t$.count!==Q.uE.t$.count)return!1;for(let va of W.uE.t$){let na;if(!(va.value&&({value:na}=
Q.uE.t$.Fc(va.key)).returnValue&&na&&y.a.equals(va.value,na,!1)))return!1}return!0}static AWc(W,Q,va){var na=N.M$("NamedObject",Q.sheetId,Q.range.top-1,Q.range.left-1,Q.range.bottom-1,Q.range.right-1);if(2===Q.type){const Ba=!!(Q.attributes&16),Oa=!!(Q.attributes&8);Q=N.Nbh(Q.uE);na=excelOnlineCalc.calc.namedTableData(na,Ba,Oa,Q);W=excelOnlineCalc.calc.namedObject(W,na)}else na=excelOnlineCalc.calc.namedRangeData(na),W=excelOnlineCalc.calc.namedObject(W,na);va.push(W)}static L0e(W){const Q=Sys.Serialization.JavaScriptSerializer.serialize(W.getRowNumbers());
W=Sys.Serialization.JavaScriptSerializer.serialize(W.getColumnNumbers());return Q+W}static I5b(W){let Q=null;if(1<W.length)for(let va=1;va<W.length;va++){let na=0;for(;W[va-1]+1+na<W[va];)Q=Q||[],Q.push(W[va-1]+na),na++}return Q}static QXe(W,Q){if(!Q)return null;for(let va=0,na=Q.length;va<na;++va)if(y.a.equals(W,Q[va].Name,!1))return Q[va];return null}static M$(W,Q,va,na,Ba,Oa){const oa=(Ja,Wb,nc,Yb)=>{(0>nc||nc>=Yb)&&b.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Ja} invalid ${Wb}:${nc}`)};
void 0!==Q&&null!==Q||b.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${W} sheetId is null`);oa(W,"top",va,N.jvf);oa(W,"left",na,N.Nyd);oa(W,"bottom",Ba,N.jvf);oa(W,"right",Oa,N.Nyd);return excelOnlineCalc.calc.sheetRangeLocation(Q,va,na,Ba,Oa)}}N.jvf=1048576;N.Nyd=16384;Object(c.a)(N,"CalcAsyncEngine",null,[2]);const Y=(W,Q,va)=>{switch(W.type){case 2:return excelOnlineCalc.calc.valueCellData(Q,W.value,va,null);case 1:return excelOnlineCalc.calc.valueCellData(Q,
parseFloat(W.value),va,null);case 3:return excelOnlineCalc.calc.valueCellData(Q,1===parseFloat(W.value),va,null);case 4:return excelOnlineCalc.calc.valueCellData(Q,excelOnlineCalc.calc.errorValue(parseFloat(W.value)),va,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,va,null)}};class U{constructor(){this.VJ=this.WJ=this.bF=this.cF=this.QZ=!1}}Object(c.a)(U,"AbsoluteRelativeReferenceInfo",null,[]);var P=a(1E3),aa=a(24);class X{}X.ANf="#";Object(c.a)(X,"Operators",
null,[]);var Z=a(1001);class da{}da.sheet="Sheet";da.sheetRange="SheetRange";da.document="Document";da.Kdi="Ident";Object(c.a)(da,"TraverseFormulaQualifierTypes",null,[]);var qa=a(1002),O=a(890),ca=a(803),wa=a(41),ia=a(55),Ha=a(71),Sa=a(292),Da=a(38);class ea extends Sys.EventArgs{constructor(W){super();this.Yj=W}}Object(c.a)(ea,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var sa=a(186),Ea=a(105),ba;let ka=ba=class extends Da.a{constructor(W){super();this.cu=null;this.bng=!1;this.jOd=this.instantaneousSupportInformationManager=
this.vHb=null;this.wBd=new Map;this.lfe=null;this.ypc=Q=>{b.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");Q.cMd(this.ypc);Q.jja.length?this.dpc(Q,Sys.EventArgs.Empty):(b.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),Q.Gqe(this.dpc))};this.dpc=Q=>{b.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");Q.TLd(this.dpc);this.fWj(Q)};this.onContentReady=()=>{this.cu&&(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.qod||ia.Task.delay(0).continueWith(()=>{this.cu.HPb(1)},0,null,Ha.a.current))};this.aAf=(Q,va)=>{this.cu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.qod||this.cu.mJe(va.Yc.block))};b.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Ygc=!1;this.jb=W;this.Wt=B.h(W);this.cIc=null;this.gridView.Uu(this.onContentReady);this.gridView.Ca.ZWc(this.aAf);this.$.da.gb(268,Q=>{Q.He?(b.ULS.sendTraceTag(537170066,
0,50,"CalcManager.ctor: LocaleInformation already available..."),this.ypc(Q,Sys.EventArgs.Empty)):(b.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),Q.bre(this.ypc))})}oMg(W){this.addHandler(ba.sOe,W)}Rxf(W){this.raiseEvent(ba.sOe,new ea(W))}get Nr(){return this.cIc}get gridView(){return this.Wt}get $(){return this.jb}get hB(){return this.lfe}get localeInfo(){return this.Nr?this.Nr.config.localeInfo:null}get config(){return this.Nr.config}dispose(){b.ULS.sendTraceTag(537170064,
0,50,"CalcManager.Dispose called");this.$.da.gb(268,W=>{W.cMd(this.ypc);W.TLd(this.dpc)});this.gridView&&(this.gridView.jy(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.KVf(this.aAf),this.Wt=null);this.cIc=null;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.Ygc=!1)}c0g(W,Q,va,na=null){this.cu&&this.cu.a0g(W,Q,va,na)}evalFormula(W,Q,va,na){return this.cu?this.cu.evalFormula(W,Q,va,na):Promise.reject("calc engine not initialized")}Aub(W,Q,va,
na){return this.cu?this.cu.Aub(W,Q,va,na):Promise.reject("CalcEngine is null")}Qxb(W){if(!W)return b.ULS.sendTraceTag(509649312,0,10,"CalcManager.GetTableHeaders: table is null"),null;if(!this.cu)return null;b.ULS.shipAssertTag(537170059,0,2===W.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.cu.Qxb(W)}Gse(W,Q){if(!Q||2!==W.type)return!1;W=n.a(W);return W.right-W.left+1===Q.count}FWe(W,Q){if(!this.vHb)return this.bng||b.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var va=this.bta(aa.Range.Pc(1,1));va=this.vHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,va.range),W);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(va))return b.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let na;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const Ba=null!==Q&&void 0!==Q?Q:this.gridView.ha.qa.activeCell,Oa=excelOnlineCalc.location.gridCell(Ba.top-
1,Ba.left-1),oa=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Ja=excelOnlineCalc.location.sheetIndex(oa,this.$.va.na.sheetId),Wb=this.igh(Oa,Ja);this.jOd||(this.jOd=excelOnlineCalc.util.createResolver(this.hgh()));na=excelOnlineCalc.parse.parseResultHelper.extractReferences(va,this.Nr.config.localeInfo,z.EwaSettings.sa(512),Wb,this.jOd)}else na=excelOnlineCalc.parse.parseResultHelper.extractReferences(va,this.Nr.config.localeInfo,z.EwaSettings.sa(512));
z.EwaSettings.sa(101)&&this.U0j(na,W);return na}catch(na){return b.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${na.message}`),null}}extractLetVariables(W,Q){if(!this.vHb)return this.bng||b.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const va=this.bta(aa.Range.Pc(1,1));W=this.vHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,va.range),W);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(W))return b.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(W,Q,this.Nr.config.localeInfo)}catch(na){return b.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${na.message}`),null}}extractReferences(W,Q,va,na,Ba){if(!Q)return b.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!va)return b.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;Ba=this.FWe(W,Ba);if(!Ba)return b.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.ffh(Ba,Q,va,W,na)}catch(Oa){return b.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${Oa.message}`),null}}Y3h(W,Q,va,na){if(!W)return b.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!Q||0>=Q.length)return b.ULS.sendTraceTag(537170018,
0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;W=this.bta(W);if(!this.Nr||!W)return null;const Ba=this.qwb(W).returnValue;if(!Ba||Ba.I6a)return null;va=excelOnline.utils.getCharIndexInTextFromPoint(va,na,z.EwaSettings.sa(512));return 0>va?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Nr.config,va,Q,W)}R_g(W,Q,va,na){if(!W)return b.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),
null;let Ba=null;return this.evalFormula(Q,W,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(Oa=>{let oa;const Ja=({kind:oa}=this.Nr.Fth(Oa,va)).returnValue;8!==oa||Ja.length&&Ja!==M.CalcHelper.unknownError?Oa=0:(b.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),Oa=excelOnlineCalc.calc.getEvalFailureReason(Oa),void 0!==Oa&&null!==Oa||b.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),
Oa=1);return Ba=na?new P.a(Ja,na.start,na.end,Oa):new P.a(Ja,-1,-1,Oa)},Oa=>{b.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${Oa}`);return Promise.resolve(Ba)})}getSubExpressionSpan(W){return this.Nr&&W?excelOnlineCalc.runtime.getSubExpressionSpan(W):null}getFormulaSubExpressionObject(W,Q,va){return this.Nr&&W&&Q&&va?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Nr.config,Q,va,this.bta(W)):null}a4h(W,Q,va){return this.Nr&&W&&Q?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Nr.config,
Q,va,this.bta(W)):null}Z3h(W,Q,va){return this.Nr&&W&&Q?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Nr.config.localeInfo,Q,va):null}aYh(){return this.Nr?this.Nr.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(W){return this.Nr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Nr.config.localeInfo,W):!1}bta(W,Q=!0){return W&&this.Nr?this.Nr.Fgh(this.Nr.sih(),W.top-1,W.left-1,Q):null}Qif(W,Q){if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7173486_IsFormulaCellRefactor")){W=
this.E4a(W);if(!Object(Sa.c)(W))return null;Q=this.hB.parseEdit(Q,W.value);return excelOnlineCalc.util.isSuccess(Q)?Q.value.kind===O.a.formula:null}W=this.Ncc(W);if(void 0===W||null===W)return null;W=this.hB.createFormat(W.FormatString,W.Builtin);if(!excelOnlineCalc.util.isSuccess(W))return null;Q=this.hB.parseEdit(Q,W.value);return excelOnlineCalc.util.isSuccess(Q)?Q.value.kind===O.a.formula:null}gvi(W){W=this.E4a(W);return Object(Sa.c)(W)?"Text"===W.value.valueType:null}E4a(W){if(null==this.hB)return Object(Sa.a)("Number formatter is null");
if(null==this.instantaneousSupportInformationManager)return Object(Sa.a)("Instantaneous manager is null");if(this.wBd.has(W))return Object(Sa.d)(this.wBd.get(W));if("number"===typeof W){var Q=this.Ncc(W);if(null==Q)return Object(Sa.a)(`Invalid ifmt=${W}`);var va=Q.FormatString;Q=Q.Builtin}else va=W,Q=!1;va=this.hB.createFormat(va,Q);return excelOnlineCalc.util.isSuccess(va)?(this.wBd.set(W,va.value),Object(Sa.d)(va.value)):Object(Sa.a)("Could not create number format")}getWorksheetFuncId(W){return this.localeInfo.getWorksheetFuncId(W)}ffh(W,
Q,va,na,Ba){const Oa={Items:[]};for(let nc=0;nc<W.length;nc++){var oa=W[nc];const Yb={};Yb.Start=oa.span.start;Yb.End=oa.span.end;if(Ba||oa.kind!==Z.a.func)if(Ba||oa.kind!==Z.a.Szi){if(!this.Soh(oa,Q,va))continue;var Ja=new U;const pb=this.R0h(oa,Q,Ja,na);if(z.EwaSettings.sa(512)){var Wb=this.SXh(oa);const Fa=this.RXh(oa);if(pb||Fa&&0<=Wb){let ab={};ab.Span=Yb;ab.LetNumber=Wb;ab.LetName=Fa;ab.Range=pb;ab.IsRangeRef=Ja.QZ;ab.IsAbsoluteFirstRow=Ja.cF;ab.IsAbsoluteFirstColumn=Ja.bF;ab.IsAbsoluteSecondRow=
Ja.WJ;ab.IsAbsoluteSecondColumn=Ja.VJ;ab.IsStructRef=oa.kind===Z.a.bXd;Oa.Items.push(ab)}}else pb&&(Wb={},Wb.Span=Yb,Wb.Range=pb,Wb.IsRangeRef=Ja.QZ,Wb.IsAbsoluteFirstRow=Ja.cF,Wb.IsAbsoluteFirstColumn=Ja.bF,Wb.IsAbsoluteSecondRow=Ja.WJ,Wb.IsAbsoluteSecondColumn=Ja.VJ,Wb.IsStructRef=oa.kind===Z.a.bXd,Oa.Items.push(Wb))}else oa=oa.ref.value.oper.kind,Ja={},Ja.Span=Yb,Ja.IsString=2===oa,Ja.IsBoolean=4===oa,Ja.IsNumber=1===oa,Oa.Items.push(Ja);else Yb.End=oa.span.start+oa.ref.name.length,oa={},oa.Span=
Yb,oa.IsFunction=!0,oa.FunctionId=this.getWorksheetFuncId(na.substring(Yb.Start,Yb.End)),Oa.Items.push(oa)}Oa.Items.sort((nc,Yb)=>nc.Span.Start-Yb.Span.Start);return Oa}SXh(W){return W.kind===Z.a.aqf?W.ref.number:-1}RXh(W){return W.kind===Z.a.aqf?W.ref.name:null}R0h(W,Q,va,na){if(W.kind===Z.a.range)return va.QZ=!0,this.gGe(W,Q,va,na);if(W.kind===Z.a.namedRange){va=W.ref;(W=this.$.yb.getItemByName(va.name))||(W=this.$.yb.getItemByName(Q+"!"+va.name));if(!(W&&W.sheetName&&W.usedRange&&y.a.equals(W.sheetName,
Q,!0)))return null;Q=2===W.type?n.a(W):W.usedRange;return wa.m(Q,W)}if(W.kind===Z.a.bXd){let Ba=W.ref,Oa;Ba.name?(Oa=this.$.yb.getItemByName(Ba.name))||(Oa=this.$.yb.getItemByName(Q+"!"+Ba.name)):Oa=this.gridView.wb.zi(this.gridView.ha.qa.activeCell);if(!(Oa&&Oa.sheetName&&Oa.usedRange&&y.a.equals(Oa.sheetName,Q,!0)))return null;va.QZ=!1;return this.gGe(W,Q,va,na)}return null}gGe(W,Q,va,na){W=W.ref;if(W.type){if(W.type===qa.a.column){var Ba=W.startIndex;W=W.endIndex;va.bF=Ba.kind===ca.a.abs;va.VJ=
W.kind===ca.a.abs;return this.createRange(0,Ba.index,d.a.Vg,W.index,Q)}if(W.type===qa.a.row)return Ba=W.endIndex,va.cF=W.startIndex.kind===ca.a.abs,va.WJ=Ba.kind===ca.a.abs,this.createRange(W.startIndex.index,0,W.endIndex.index,d.a.Ug,Q);if(W.type===qa.a.cell){Ba=W.row;var Oa=W.col;va.cF=va.WJ=Ba.kind===ca.a.abs;va.bF=va.VJ=Oa.kind===ca.a.abs;return this.d3b(W.span.end,na)&&(va=aa.Range.Pc(Ba.index+1,Oa.index+1),va=this.gridView.wb.G7e(va))?wa.n(va,Q):this.createRange(Ba.index,Oa.index,Ba.index,Oa.index,
Q)}if(W.type===qa.a.range){Ba=W.top;Oa=W.left;na=W.bottom;W=W.right;const oa=Math.min(Ba.index,na.index),Ja=Math.min(Oa.index,W.index),Wb=Math.max(Ba.index,na.index),nc=Math.max(Oa.index,W.index);va.cF=Ba.kind===ca.a.abs;va.WJ=na.kind===ca.a.abs;va.bF=Oa.kind===ca.a.abs;va.VJ=W.kind===ca.a.abs;return this.createRange(oa,Ja,Wb,nc,Q)}b.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${W.type}'`);return null}b.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");
return null}d3b(W,Q){return Q.length>=W&&0<W&&Q.charAt(W-1)===X.ANf}X_g(W,Q,va){this.cu&&this.cu.b0g(W,Q,va)}Ncc(W){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.pya&&this.instantaneousSupportInformationManager.pya[W]&&this.hB?this.instantaneousSupportInformationManager.pya[W]:null}toXLNumber(W){if(!this.hB)return null;W=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.hB,W);return excelOnlineCalc.util.isSuccess(W)?W.value:null}U0j(W,Q){if(W)for(const va of W)va.ref.type&&
va.ref.type===qa.a.cell&&(W=va.ref,ba.b7i(W,Q)&&(W.span.end+=1,va.span.end+=1))}createRange(W,Q,va,na,Ba){const Oa={};Oa.FirstRow=W;Oa.FirstColumn=Q;Oa.LastRow=va;Oa.LastColumn=na;Oa.SheetName=Ba;return Oa}Soh(W,Q,va){var na=W.ref.qualifier;if(!na)return!0;switch(W.ref.qualifier.type){case da.sheet:return W=na.document,y.a.equals(na.sheet,Q,!0)&&(!W||y.a.equals(W.document,va,!0));case da.sheetRange:return Q=this.$.va.getItemByName(Q),va=this.$.va.getItemByName(na.sheet1),na=this.$.va.getItemByName(na.sheet2),
!!Q&&!!va&&!!na&&(va.index<=Q.index&&Q.index<=na.index||na.index<=Q.index&&Q.index<=va.index);case da.document:return y.a.equals(na.document,va,!0);case da.Kdi:return na=na.name,y.a.equals(na,Q,!0)||y.a.equals(na,va,!0);default:return b.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${na.type}'`),!1}}fWj(W){this.instantaneousSupportInformationManager=W;W.pya.length&&W.jja.length?(this.cIc=new M.CalcHelper(this.gridView.$),this.vHb=this.Nr.createParser(),
this.lfe=this.Nr.createNumberFormatter(),this.Ygc=!0,b.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.cu||(b.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.cu=new N(this.$))):b.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${W.pya.length}, functions info count = ${W.jja.length}`)}qwb(W){if(!W)return{returnValue:null,
emptyCell:!1};var Q=this.getSheetName(W.sheet.index);if(!Q)return b.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${W.sheet.index}`),{returnValue:null,emptyCell:!1};const va=ba.convertToRange(W);Q=this.gridView.qwb(Q,va.top,va.left);return Q?Q.Ooh?{returnValue:Q,emptyCell:!1}:(b.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${W.range.row} ${W.range.col} is empty`),{returnValue:null,emptyCell:!0}):(b.ULS.sendTraceTag(537169997,0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${W.range.row} ${W.range.col}`),
{returnValue:null,emptyCell:!1})}getSheetName(W){const Q=this.gridView.$.va.getItem(W);return Q?Q.sheetName:(b.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${W}`),null)}igh(W,Q){const va={allowUnqualifiedCell:!0,wrapCellReferences:!0};va.config=this.Nr.config;va.originGridCell=excelOnlineCalc.util.success(W);va.originSheet=excelOnlineCalc.util.success(Q);return va}hgh(){const W={};W.config=this.Nr.config;W.getNameLoc=this.cu.getNameLoc;W.getContainingTable=this.cu.getContainingTable;
W.getStructRefColumn=this.cu.getStructRefColumn;W.getStructRefSpecialRef=this.cu.getStructRefSpecialRef;W.getDocumentLoc=this.cu.getDocumentLoc;W.getSheetIndex=this.cu.getSheetIndex;W.getSheetName=this.cu.getSheetName;W.getUserDefinedFuncLoc=this.cu.getUserDefinedFuncLoc;W.getSheetRangeIndexes=this.cu.getSheetRangeIndexes;return W}static b7i(W,Q){return Q.length>W.span.end&&Q.charAt(W.span.end)===X.ANf}static convertToRange(W){return aa.Range.Pc(W.range.row+1,W.range.col+1)}};ka.sOe="ECRC";ka=ba=
Object(f.b)([Object(sa.d)(Ea.b),Object(f.c)(0,Object(Ea.f)()),Object(f.c)(1,Object(Ea.g)())],ka);Object(c.a)(ka,"CalcManager",Da.a,[502,2]);var Ca=a(37),db=a(51);class yb extends e.a{constructor(W){super();this.$=W;this.Db()}create(){if(this.$){b.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var W=76;var Q="Current"}else W=79,Q="Stable";b.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${Q} JS was loaded`);
Ca.TaskExtensions.za(db.a.loadScript(W,4,this.Xa,void 0,void 0,265),()=>{b.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let va=this.$.da.Aa(266,!1);va||(b.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),va=new ka(this.$),this.$.da.Ha(266,va));this.nb(va)},this.la,3)}else b.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(W){W&&
W.da&&W.da.Ha(265,new yb(W))}}Object(c.a)(yb,"CalcManagerFactory",e.a,[]);var kb=a(9);a.d(F,"a",function(){return mb});const mb=()=>{kb.a.Fa(W=>{z.EwaSettings.ZJ()||yb.ka(W)})};String(t);window.___1675790529144_closurehack=t},1231:function(t,F,a){var c=a(9);t=a(0);var b=a(15),e=a(226),f=a(89),d=a(4),h=a(191),m=a(8),l=a(38),v=a(889),r=a(229),A=a(60),x=a(888);class n extends Sys.EventArgs{constructor(){super()}}Object(t.a)(n,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var u=a(48),z=a(44);a(35);
var w=a(29),C=a(1),y=a(618);a(22);var B=a(282),H=a(21);a(177);class I{constructor(M){this.data=M}}Object(t.a)(I,"NumberFormatDataHolder",null,[]);var R=a(179);class S extends l.a{constructor(M,L){super();this.cvd=m.a.oe;this.y0c=null;this.Pgb=this.Gkc=!1;this.ezf=(N,Y)=>{var U;(N=H.h(this.$))&&(Y=null!==(U=null===Y||void 0===Y?void 0:Y.cell)&&void 0!==U?U:N.Qb(null))&&this.KBa(Y.cell.hj,!0)};this.ySi=N=>{this.isActive()&&(w.a.oq(N.Errors)||!N.Result?(N=N.Errors?N.Errors.map(Y=>JSON.stringify(Y)).join(","):
"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${N}`)):(N=N.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${N.Index}, category = ${N.Category}`),this.Mzj(N.Index,N.Category),this.raiseEvent(S.t1c,new v.a(N.Index,N.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.P2b();this.isActive()&&this.ea.$b.allowEdits&&
(this.Pgb||this.un&&!(this.ea.YCb>this.cvd)?this.nFc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.fhd=x.a(this.$.oa.xa,this.un?this.un.Digest:"",this.gTi,this.fTi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.k3e())};this.wDf=N=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${N.data.status}, HTTP status = ${N.data.httpStatus}.`);
this.AKa=null};this.u_=()=>{this.Pgb=!1;this.ea.rB(this.u_);this.tRa(this.Gkc?S.rTd:S.TAd)};this.Rc=(N,Y)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");r.a(Y)&&this.tRa(S.rTd)};this.tf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.fBd(0===this.$.workbookContext.CalcMode)};this.dd=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.tRa(S.rTd);C.EwaSettings.sa(269)&&3!==this.$.workbookContext.CalcMode&&this.fBd(0===this.$.workbookContext.CalcMode)};this.ZSi=(N,Y,U)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.AKa=null;this.isActive()?N.StateId===m.a.oe?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.nFc()):!N.Result||this.wX&&this.wX.length?this.tRa(S.TAd):this.aHf(N,
Y,U):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.aHf=N=>{this.wX=N.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.wX?this.wX.length:-1} functions.`);N=!1;if(this.wX){for(const Y of this.wX)Y&&(this.SZe[Y.NameUI.toLocaleUpperCase()]=Y.FunctionIndex.toString(),Y.NameUI!==Y.NameDataStrings&&(this.SZe[Y.NameDataStrings.toLocaleUpperCase()]=
Y.FunctionIndex.toString(),N=!0),this.SKh.ia(Y.FunctionIndex,Y.NameUI));this.raiseEvent(S.eed,Sys.EventArgs.Empty,this)}N&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.gTi=N=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.Gkc=!1,this.cvd=N.StateId,this.cvd===m.a.oe)this.Gkc=!0,this.nFc();else{if(N.Result){var Y=this.un;this.un=N.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.un.Digest}.`);N=[];if(Y)N=S.HYh(Y.NumberFormats,this.un.NumberFormats);else for(Y=0;Y<this.un.NumberFormats.length;Y++)this.Ync.ia(Y,this.un.NumberFormats[Y].NumberFormatCategory);for(const U of N)this.Ync.ia(U,this.un.NumberFormats[U].NumberFormatCategory);this.raiseEvent(S.BBd,new n(N),this);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7299165_StructuredReferencesInRangePicker")&&this.raiseEvent(S.arf)}this.tRa(S.TAd)}};this.fTi=
N=>{this.isActive()&&(10===N.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${N.data.status}, HTTP status = ${N.data.httpStatus}.`),this.Gkc=!0,this.nFc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=M;this.$=L;this.un=this.AKa=this.fhd=this.XIb=null;this.Ync=new R.a;this.pwb=new R.a;this.wX=[];this.SKh=
new R.a;this.SZe={};this.ea.Jj(this.Rc);this.$.Lk(this.dd);H.h(this.$).ha.Jga(this.ezf);C.EwaSettings.sa(269)&&this.ea.$t(this.tf);this.tRa(S.Kdf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}bre(M){this.addHandler(S.BBd,M)}cMd(M){this.removeHandler(S.BBd,M)}NLg(M){this.addHandler(S.t1c,M)}Iij(M){this.removeHandler(S.t1c,M)}Gqe(M){this.addHandler(S.eed,M)}TLd(M){this.removeHandler(S.eed,M)}qNg(M){this.addHandler(S.arf,M)}get He(){return this.un?this.un.LocaleInformation:
null}get pya(){return this.un?this.un.NumberFormats:[]}get jja(){this.wX&&this.wX.length||this.k3e();return this.wX}get fji(){return this.un&&void 0!==this.un.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.un.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.un.InstantaneousCalcWebWorkerPrecisionSamplingRate:S.Tjh}get iji(){return this.un&&void 0!==this.un.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.un.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?
this.un.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:S.Xjh}get hji(){return this.un&&void 0!==this.un.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.un.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.un.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:S.Wjh}get gji(){return this.un&&void 0!==this.un.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.un.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.un.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:
S.Vjh}get vff(){return this.un?this.un.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:S.Ujh}get qod(){return null!==this.y0c?this.y0c:this.un?this.un.InstantaneousCalcManualMode:!1}XVj(M){let L;if(!M)return{returnValue:!0,category:"General"};L="";if(!({category:M}=this.KBa(M,!1)).returnValue)return{returnValue:!1,category:L};L=this.t$g(M);return{returnValue:!0,category:L}}t$g(M){let L="";switch(M){case 0:L="General";break;case 1:L="Number";break;case 2:L="Currency";break;case 3:L="Accounting";break;
case 4:L="Date";break;case 5:L="Time";break;case 6:L="Percentage";break;case 7:L="Fraction";break;case 8:L="Scientific";break;case 9:L="Text";break;case 10:L="Special";break;case 11:L="Custom"}return L}KBa(M,L){let N,Y=({value:N}=this.Ync.Fc(M,0)).returnValue;!Y&&0<M&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${M}`),this.xQh(M),L&&(N=this.wQh(M),Y=!0),y.a(M,this.$.UF)&&
(N=6));return{returnValue:Y,category:N}}Toi(M){let L=0;if(({category:L}=this.KBa(M,!0)).returnValue)return 6===L;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${M}`);return!1}qJh(M){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.AKa=A.o(this.$.oa.xa,{FilterType:0},B.b(this.aHf,M),this.wDf,null,null,null)}oZe(){this.tRa(S.Kdf)}fBd(M){this.y0c=
M}xQh(M){if(this.pwb&&this.$){var L;if(!({value:L}=this.pwb.Fc(M)).returnValue||L.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${M}`),(L=x.c(this.$.oa.xa,M,this.ySi,null,null,null))&&this.pwb.ia(M,L)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}wQh(M){return 1<=M&&8>=M?1:9<=M&&12>=M?2:13===M||14===M?6:15===M?8:17===M|18===M?7:19===M?4:16===M||20<=
M&&29>=M||31===M?11:30===M?9:32<=M&&35>=M?3:0}isActive(){const M=void 0===this.ea||null===this.ea,L=!M&&this.ea.Xb;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${L} - sessionStateManager IsNullOrUndefined: ${M}`);return L}Mzj(M,L){this.Ync.ia(M,L)}dispose(){f.a.Ja(this.XIb);this.XIb=null;this.P2b();for(let M of this.pwb){const L=M.value;L&&!L.isCompleted&&d.AFrameworkApplication.Bd.Nt(L.Rs)}this.pwb=null;this.ea&&
(this.ea.ik(this.Rc),this.Pgb&&this.ea.rB(this.u_),this.Pgb=!1,this.ea.yv(this.tf));this.ea=null;this.$&&H.h(this.$)&&H.h(this.$).ha&&(H.h(this.$).ha.Tma(this.ezf),this.$.pl(this.dd));this.$=null;super.dispose()}isFeatureEnabled(M){try{switch(M){case "LocaleLongDateFormat":return C.EwaSettings.sa(184);case "GetLocaleDayNames":return C.EwaSettings.sa(185);case "CalculateTextWidthIgnoreLetterSpacing":return C.EwaSettings.sa(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return C.EwaSettings.sa(101);
default:return M.startsWith("OfficeVSO:")?C.EwaSettings.isChangeGateEnabled(M):!1}}catch(L){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${M}): feature parsing failed, returning false. Exception: ${L.toString()}.`),!1}}tRa(M){this.isActive()&&this.ea.$b.allowEdits?(f.a.Ja(this.XIb),this.XIb=null,this.XIb=u.a.instance.create(this.refresh,M,z.a.jji)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.$b&&null!==this.ea.$b?this.ea.$b.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}k3e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.AKa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.wX&&this.wX.length||(this.AKa=A.o(this.$.oa.xa,{FilterType:0},this.ZSi,
this.wDf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}nFc(){this.Pgb||(this.Pgb=!0,this.ea.lA(this.u_))}P2b(){this.Nt(this.fhd);this.Nt(this.AKa);this.AKa=this.fhd=null}Nt(M){M&&!M.isCompleted&&this.$.oa.xa.Rfb(M.Rs)}static HYh(M,L){if(!M||!M.length)return[];if(!L||!L.length){L=Array(M.length);for(var N=0;N<M.length;++N)L[N]=M[N].IfmtIndex;return L}N=new R.a;for(const Y of M)N.ia(Y.IfmtIndex,
new I(Y));M=new h.a;for(const Y of L){let U;({value:U}=N.Fc(Y.IfmtIndex)).returnValue&&U.data.FormatString===Y.FormatString||M.add(Y.IfmtIndex)}return M.toArray()}}S.BBd="isim0";S.t1c="isim1";S.eed="isim2";S.arf="isim3";S.Kdf=100;S.rTd=1E3;S.TAd=3E5;S.Tjh=.001;S.Xjh=.1;S.Wjh=.2;S.Vjh=.001;S.Ujh=50;Object(t.a)(S,"InstantaneousSupportInformationManager",l.a,[518,2]);var G=a(712);class D extends e.a{constructor(M){super();this.$=M;this.Db()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");
var M=Object(G.a)(this.$.da,268,()=>new S(this.$.ea,this.$));this.nb(M)}}static ka(M){if(!M)throw Error.argumentNull("ewaControl");M.da.Ha(246,new D(M))}}Object(t.a)(D,"InstantaneousSupportInformationManagerFactory",e.a,[]);a.d(F,"a",function(){return E});const E=()=>{c.a.Fa(D.ka)}},1247:function(t,F,a){function c(U){if(U){var P=new v(U.IsRangeRef);P.cF=U.IsAbsoluteFirstRow;P.bF=U.IsAbsoluteFirstColumn;P.WJ=U.IsAbsoluteSecondRow;P.VJ=U.IsAbsoluteSecondColumn;return P}}function b(U){var P;if(U){var aa=
new v(0===U.kind);U=null===(P=null===U||void 0===U?void 0:U.rangeInfo)||void 0===P?void 0:P.positionKindInfo;if(!U)return aa;aa.cF=0===U.firstRow;aa.bF=0===U.firstColumn;aa.WJ=0===U.secondRow;aa.VJ=0===U.secondColumn;return aa}}t=a(0);var e=a(226),f=a(7),d=a(15),h=a(84),m=a(5),l=a(323);class v{constructor(U){this.VJ=this.WJ=this.bF=this.cF=!1;this.QZ=U}}Object(t.a)(v,"MarqueeRangeData",null,[]);class r{constructor(U,P,aa,X=!1){this.nYd=U;this.IOb=P;this.u7a=X;aa?(this.QZ=aa.QZ,this.cF=aa.cF,this.bF=
aa.bF,this.WJ=aa.WJ,this.VJ=aa.VJ):d.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(t.a)(r,"MarqueeMetadata",null,[]);var A=a(41),x=a(141),n=a(35),u=a(1),z=a(22),w=a(580),C=a(21),y=a(177),B=a(345),H=a(33),I=a(740),R=a(891);const S="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");class G{constructor(U,P){this.UJ=this.afb=this.Gsf=!1;
this.s8=null;this.WMa=u.EwaSettings.WMa();this.vya=()=>{this.UJ=!1};this.Oc=U;this.gridView=C.h(U);this.calcManager=P;this.qgf=u.EwaSettings.sa(595);this.qH=H.a.qH(U);this.gridView.Vb.Jm(this.vya)}get formulaAssistanceManager(){this.s8||(this.s8=this.Oc.da.Aa(464));return this.s8}get formulaAssistanceTelemetryManager(){this.KDa||(this.KDa=this.Oc.da.Aa(491));return this.KDa}GD(U,P){U.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.afb||U.dF)return!1;const aa=
void 0===P||null===P?U.text:P;if(this.calcManager&&1<aa.length&&y.f(aa)){var X=this.Fja(),Z=this.z5e(),da=this.Oc.workbookContext.WorkbookFileName;let qa=!1;const O=.01>Math.random()?Object(h.a)(x.a,this.Oc.Jb.Gc("LoadingUIShown","ColoredReferencesManager")):null;try{const ca=this.calcManager.extractReferences(aa,Z,da,!this.qgf);if(!ca)return d.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;Z=[];da=[];
const wa=[],ia=[];let Ha=0,Sa=0;const Da=new n.a(!1);let ea="";for(const Ea of ca.Items)if(qa=Ea.IsStructRef||qa,Ea.IsBoolean||Ea.IsNumber||Ea.IsString){const ba=Ea.IsBoolean?"rgba(0, 0, 255, 1)":Ea.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.eE(da,aa,Ha,Ea.Span.Start,null);this.eE(da,aa,Ea.Span.Start,Ea.Span.End,ba);Ha=Ea.Span.End}else if(u.EwaSettings.sa(512)){if(Ea.Range||Ea.LetName&&0<=Ea.LetNumber){let ba=null;if(Ea.Range){let Ca=A.D(Ea.Range);ba=this.jZ(Ca,Da,1);Z.push(new B.a(Ca,
X))}else Ea.LetName&&0<=Ea.LetNumber&&(ba=ea=this.kRh(Ea.LetName,Ea.LetNumber,Da,ea),Sa!==Da.count&&U.colors.add(Ea.Span.Start+"-"+Ea.Span.End,S[(Da.count-1)%S.length]));this.eE(da,aa,Ha,Ea.Span.Start,null);this.eE(da,aa,Ea.Span.Start,Ea.Span.End,ba);Ha=Ea.Span.End;wa.push(Ea.Span);let ka=da.length-1;ia.push(new r(ka,da[ka].text,c(Ea)));Sa=Da.count}}else if(Ea.Range){let ba=A.D(Ea.Range),ka=this.jZ(ba,Da,1);this.eE(da,aa,Ha,Ea.Span.Start,null);this.eE(da,aa,Ea.Span.Start,Ea.Span.End,ka);Z.push(new B.a(ba,
X));Ha=Ea.Span.End;wa.push(Ea.Span);let Ca=da.length-1;ia.push(new r(Ca,da[Ca].text,c(Ea)))}this.formulaAssistanceTelemetryManager?0<ca.Items.length&&this.formulaAssistanceTelemetryManager.Iac.formulaHighlightsCounter++:this.Ulc("ColoredReferencesManager.tryUpdateColoredReferences: FormulaAssistanceTelemetryManager unavailable");this.eE(da,aa,Ha,aa.length,null);this.xyc(U,da,!!P);const sa=U.textBox.text;if(!z.a.equals(sa,aa,!1)){d.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${sa.length}], originalTextLength [${aa.length}]`);
let Ea=U.textBox.caretPosition;U.textBox.text=aa;U.textBox.caretPosition=Ea;return!0}this.az(Z,Da,ia);u.EwaSettings.sa(512)&&0<Z.length&&d.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");u.EwaSettings.sa(512)&&0<U.colors.count&&d.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.UJ=!0}finally{O&&O.dBa(()=>{qa&&d.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${O.Bc} ms`)})}}else return this.az(null,
null),this.UJ&&(this.UJ=!1,this.WMa||(X=U.textBox.caretPosition,U.textBox.setPlainText(aa),U.textBox.caretPosition=Math.min(X,aa.length)),P)?!0:!1}Ufb(U,P,aa){if(this.afb||U.dF)return!1;const X=isNullOrUndefined(P)?U.text:P;var Z=[];const da=new n.a(!1);if(1<X.length&&Object(I.b)(aa)){const O=[],ca=[],wa=[];var qa=0;const ia=this.Fja();for(const Ha of aa.formulaHighlights){this.eE(O,X,qa,Ha.span.start,null);switch(Ha.kind){case 0:case 1:case 2:aa=A.B(Ha.rangeInfo.sharedRange);if(isNullOrUndefined(aa)){d.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${Ha.kind.toString()},`);this.eE(O,X,Ha.span.start,Ha.span.end,null);break}qa=this.jZ(aa,da,1);this.eE(O,X,Ha.span.start,Ha.span.end,qa);Z.push(new B.a(aa,ia));ca.push({Start:Ha.span.start,End:Ha.span.end});aa=O.length-1;wa.push(new r(aa,O[aa].text,b(Ha)));break;case 3:this.eE(O,X,Ha.span.start,Ha.span.end,null,"rgba(229, 229, 229, 1)")}qa=Ha.span.end}this.eE(O,X,qa,X.length);
this.xyc(U,O,!!P);P=U.textBox.text;if(!z.a.equals(P,X,!1))return d.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${P.length}], originalTextLength [${X.length}]`),P=U.textBox.caretPosition,U.textBox.text=X,U.textBox.caretPosition=P,!0;this.az(Z,da,wa);return this.UJ=!0}this.az(null,null);return this.UJ&&(this.UJ=!1,this.WMa||(Z=U.textBox.caretPosition,U.textBox.setPlainText(X),
U.textBox.caretPosition=Math.min(Z,X.length)),P)?!0:!1}CEb(U,P,aa){if(!U||!P||!aa)return d.ULS.shipAssertTag(524039685,0,!!U,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),d.ULS.shipAssertTag(524039684,0,!!P,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),d.ULS.shipAssertTag(524039683,0,!!aa,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const X=Object(h.a)(r,P.metadata);if(!X)return d.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var Z=X.nYd,da=X.IOb,qa=this.gridView.wb.fqd(aa)?aa.Iwb(X.bF,X.cF):aa.KKa(X.bF,X.cF,X.VJ,X.WJ);if(!qa)return d.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const O=da.indexOf("!");-1!==O&&(qa=da.substring(0,O+1)+qa);if(!U.textBox.changeTextInExistingTextPart(Z,da,qa))return d.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;X.IOb=qa;Z=!0;for(da=1;4>=da;da++)(qa=C.h(this.Oc).Cb.KC(3,
da,P.KT))?(qa.range=aa,qa.metadata=X):(d.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),Z=!1);this.gridView.Cb.update(!1,!1);this.gridView.Ql&&(this.gridView.mc.textBox.text=U.text);this.gridView.mc.ZPa(new l.a({wAb:!0}));return Z}Cqi(U){if(3!==U.yq)return d.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;U=Object(h.a)(r,U.metadata);return U?U.QZ&&!U.u7a:(d.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}iBa(U,P){d.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(P?"suspending":"resuming")+" colored references");P&&this.UJ&&(this.UJ=!1,this.az(null,null),U.textBox.ECe());this.afb=P}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.$l(this.vya)}Yyb(U){const P=this.formulaAssistanceTelemetryManager;P||this.Ulc("ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable");
null===P||void 0===P?void 0:P.BD(["highlightPreviewRanges"]);this.qH?this.Kci(U):this.Jci(U);null===P||void 0===P?void 0:P.dw(["highlightPreviewRanges"],!0)}Kci(U){var P=this.formulaAssistanceManager.u4a(U,R.a);if(isNullOrUndefined(P))this.az(null,null);else{var aa=this.Fja(),X=[],Z=new n.a(!1),da=[];P=P.formulaHighlights;for(const qa of P)if(P=qa.kind,0===P||2===P||1===P)P=A.B(qa.rangeInfo.sharedRange),Object(I.b)(P)&&(X.push(new B.a(P,aa)),this.jZ(P,Z,1),da.push(new r(qa.span.start,U.substring(qa.span.start,
qa.span.end),b(qa),!0)));this.az(X,Z,da)}}Jci(U){const P=this.Fja();var aa=this.z5e();const X=this.Oc.workbookContext.WorkbookFileName,Z=[],da=new n.a(!1),qa=[];if(aa=this.calcManager.extractReferences(U,aa,X,!this.qgf)){for(const O of aa.Items)O.Range&&(aa=A.D(O.Range),Z.push(new B.a(aa,P)),this.jZ(aa,da,1),qa.push(new r(O.Span.Start,U.substring(O.Span.Start,O.Span.End),c(O),!0)));this.az(Z,da,qa)}else this.az(null,null)}jZ(U,P,aa){let X=P.getItem(U.toString());X||(X=S[P.count%S.length],P.add(U.toString(),
X));return String.format(X,aa)}kRh(U,P,aa,X){U="["+U+", "+P+"]";P=aa.getItem(U);P||(P=aa.count%S.length,P=S[P],X===String.format(P,1)&&(aa.add("skip-"+U,P),P=aa.count%S.length,P=S[P]),aa.add(U,P));return String.format(P,1)}eE(U,P,aa,X,Z=null,da=null){d.ULS.shipAssertTag(524039648,0,aa<=X,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");aa<X&&(P=P.substring(aa,X),U.push(Object(f.a)(new w.a,{text:P,color:Z,backgroundColor:da})))}az(U,P,aa=null){U&&U.length?(d.ULS.sendTraceTag(524039647,
0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+U.length),U.reverse(),aa.reverse(),this.gridView.Cb.xB(U,[3],!0,(X,Z)=>{if(X&&X.range&&Z){d.ULS.shipAssertTag(524039643,0,P.hb(X.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${X.range.toString()}' doesn't exist in the range to color dictionary`);var da=this.jZ(X.range,P,.1),qa=this.jZ(X.range,P,1);this.Oc.frame&&this.Oc.frame.TC&&this.Oc.frame.TC.SM||(Z.style.background=da);Z.style.borderColor=
qa;aa&&(Z.setAttribute(m.a.W5a,X.KT.toString()),X.metadata=aa[X.KT])}else d.ULS.shipAssertTag(524039646,0,!!X,"ColoredReferencesManager.HighlightRanges: state is null"),d.ULS.shipAssertTag(524039645,0,!!X.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),d.ULS.shipAssertTag(524039644,0,!!Z,"ColoredReferencesManager.HighlightRanges: div is null")})):(U=this.Oc.Jb.Gc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Cb.Nj([3]),this.gridView.Cb.XRa(new B.a(null,this.Fja()),
[3]),U.stop())}xyc(U,P,aa){const X=U.textBox;X.XE=!0;var Z=X.selection;const da=Z.index;Z=da+Z.length;X.setTextFromTextParts(P);P=X.text.length;X.selectRange(Math.min(da,P),Math.min(Z,P));aa&&U.ZPa(new l.a);X.XE=!1}Ulc(U){this.Gsf||(d.ULS.sendTraceTag(521211935,0,50,U),this.Gsf=!0)}Fja(){return this.Rcc().sheetId}z5e(){return this.Rcc().sheetName}Rcc(){return this.gridView.Gq&&this.gridView.Gq.qF?this.gridView.Gq.qF:this.Oc.na}}Object(t.a)(G,"ColoredReferencesManager",null,[367,2]);var D=a(186),E=
a(105),M=a(712);class L extends e.a{constructor(U){super();this.$=U;this.Db()}create(){u.EwaSettings.ZJ()?void D.a.resolve(E.b,{Tl:this.Xa}).then(U=>{const P=Object(M.a)(this.$.da,281,()=>new G(this.$,U));this.nb(P)}):this.$.da.gb(266,U=>{U=u.EwaSettings.cl()||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.Aa(281)||this.$.da.Ha(281,new G(this.$,U)):new G(this.$,U);this.nb(U)})}static ka(U){U.da.Ha(282,new L(U))}}Object(t.a)(L,"ColoredReferencesManagerFactory",
e.a,[]);var N=a(9);a.d(F,"a",function(){return Y});const Y=()=>{N.a.Fa(L.ka)}},1294:function(t,F,a){t=a(0);var c=a(226),b=a(823),e=a(1),f=a(186),d=a(105);class h extends c.a{constructor(v){super();this.$=v;this.Db()}create(){(e.EwaSettings.ZJ()?v=>f.a.resolve(d.b).then(r=>setTimeout(()=>v(r),0)):v=>this.$.da.gb(266,v))(v=>{v=this.$.da.Aa(294)||this.$.da.Ha(294,new b.RelativeAndAbsoluteReferencesManager(v));this.nb(v)})}static ka(v){v.da.Ha(295,new h(v))}}Object(t.a)(h,"RelativeAndAbsoluteReferencesManagerFactory",
c.a,[]);var m=a(9);a.d(F,"a",function(){return l});const l=()=>{m.a.Fa(h.ka)}},1421:function(t,F,a){a.r(F);t=a(1231);F=a(1184);var c=a(1247);a=a(1294);Type.registerNamespace("_Ewa");Object(t.a)();Object(F.a)();Object(c.a)();Object(a.a)()},803:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(t.a)(c,"PositionBaseType",null,[])},823:function(t,F,a){a.r(F);t=a(0);var c=a(7),b=a(15);class e{}Object(t.a)(e,"Reference",null,[]);class f extends e{constructor(){super();
this.column=this.row=null}}Object(t.a)(f,"CellReference",e,[]);class d{constructor(){this.end=this.start=0;this.ur=null}gSg(B,H){for(let I=0;I<this.ur.length;I++){const R=this.N0b(B,this.ur[I]);H+=R;I<this.ur.length-1&&(H+=":")}return H}}Object(t.a)(d,"IReferenceSequence",null,[]);var h=a(24),m=a(803);class l extends d{constructor(){super();this.Vic=!1}Kcc(){const {RelativeAndAbsoluteReferencesManager:B}=a(823),H=this.ur[0];return B.uxf(H.row.kind===m.a.abs,H.column.kind===m.a.abs)}N0b(B,H){H=h.Range.Pc(H.row.index+
1,H.column.index+1);return this.Vic?H.Iwb(1===B||3===B,1===B||2===B):H.KKa(1===B||3===B,1===B||2===B,!0,!0)}}Object(t.a)(l,"CellReferenceSequence",d,[]);class v extends e{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(t.a)(v,"ColumnReference",e,[]);class r extends d{constructor(){super()}Kcc(){const B=this.ur[0];return a(823).RelativeAndAbsoluteReferencesManager.Uvf(B.firstColumn,B.secondColumn).kind===m.a.abs?2:3}N0b(B,H){return h.Range.Nvb(H.firstColumn.index+1,H.secondColumn.index+
1).KKa(1===B||3===B,!0,1===B||3===B,!0)}}Object(t.a)(r,"ColumnReferenceSequence",d,[]);class A extends e{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(t.a)(A,"RangeReference",e,[]);class x extends d{constructor(){super()}Kcc(){const {RelativeAndAbsoluteReferencesManager:B}=a(823),H=this.ur[0];return B.uxf(H.top.kind===m.a.abs,H.left.kind===m.a.abs)}N0b(B,H){H=new h.Range(H.top.index+1,H.left.index+1,H.bottom.index+1,H.right.index+1,!1,!1);const I=1===B||3===B;B=1===
B||2===B;return H.KKa(I,B,I,B)}}Object(t.a)(x,"RangeReferenceSequence",d,[]);class n extends e{constructor(){super();this.secondRow=this.firstRow=null}}Object(t.a)(n,"RowReference",e,[]);class u extends d{constructor(){super()}Kcc(){const B=this.ur[0];return a(823).RelativeAndAbsoluteReferencesManager.Uvf(B.firstRow,B.secondRow).kind===m.a.abs?0:1}N0b(B,H){return h.Range.Mac(H.firstRow.index+1,H.secondRow.index+1).KKa(!0,1===B||2===B,!0,1===B||2===B)}}Object(t.a)(u,"RowReferenceSequence",d,[]);var z=
a(1001),w=a(1002),C=a(177);a.d(F,"RelativeAndAbsoluteReferencesManager",function(){return y});class y{constructor(B){this.calcManager=B}w1a(B,H,I){let R,S;R=H;S=I;if(!B||!C.f(B))return{returnValue:B,FAd:R,EAd:S};var G=this.calcManager.FWe(B);if(!G)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,FAd:R,EAd:S};G=this.J2h(G,B,H,I);let D=0,E="",M=0,L=0;for(;L<
G.length;L++)if(this.pNe(G[L],H,I)){D=G[L].Kcc();R=G[L].start;break}for(;L<G.length&&this.pNe(G[L],H,I);L++)E+=B.substring(M,G[L].start),E=G[L].gSg(D,E),M=G[L].end;M&&(S=E.length);E+=B.substring(M,B.length);return{returnValue:E,FAd:R,EAd:S}}J2h(B,H,I,R){const S=[];for(let M=0;M<B.length;M++){var G=B[M];if(G.kind===z.a.range)if(G=G.ref,G.type===w.a.cell){var D=G;G=Object(c.a)(new l,{start:G.span.start,end:G.span.end,ur:[Object(c.a)(new f,{column:D.col,row:D.row})],Vic:this.calcManager.d3b(G.span.end,
H)});S.push(G)}else if(G.type===w.a.range)this.qNe(G.topLeftSpan,I,R)&&this.qNe(G.bottomRightSpan,I,R)?(D=new A,G.top.index<=G.bottom.index?(D.top=G.top,D.bottom=G.bottom):(D.bottom=G.top,D.top=G.bottom),G.left.index<=G.right.index?(D.left=G.left,D.right=G.right):(D.right=G.left,D.left=G.right),G=Object(c.a)(new x,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,ur:[D]}),S.push(G)):(D=Object(c.a)(new l,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,ur:[Object(c.a)(new f,{column:G.left,row:G.top})],
Vic:this.calcManager.d3b(G.topLeftSpan.end,H)}),G=Object(c.a)(new l,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,ur:[Object(c.a)(new f,{column:G.right,row:G.bottom})],Vic:this.calcManager.d3b(G.topLeftSpan.end,H)}),S.push(D),S.push(G));else if(G.type===w.a.column){D=G;for(G=Object(c.a)(new r,{start:G.span.start,end:G.span.end,ur:[Object(c.a)(new v,{firstColumn:D.startIndex,secondColumn:D.endIndex})]});G.end<H.length-1&&":"===H.charAt(G.end)&&M<B.length-1;)if(D=B[M+1].ref,D.type===w.a.column&&
D.span.start===G.end+1){var E=D;G.ur.push(Object(c.a)(new v,{firstColumn:E.startIndex,secondColumn:E.endIndex}));G.end=D.span.end;M++}else break;S.push(G)}else if(G.type===w.a.row){D=G;for(G=Object(c.a)(new u,{start:G.span.start,end:G.span.end,ur:[Object(c.a)(new n,{firstRow:D.startIndex,secondRow:D.endIndex})]});G.end<H.length-1&&":"===H.charAt(G.end)&&M<B.length-1;)if(D=B[M+1].ref,D.type===w.a.row&&D.span.start===G.end+1)E=D,G.ur.push(Object(c.a)(new n,{firstRow:E.startIndex,secondRow:E.endIndex})),
G.end=D.span.end,M++;else break;S.push(G)}}return S}pNe(B,H,I){return!(B.start>I||H>B.end)}qNe(B,H,I){return!(B.start>I||H>B.end)}static Uvf(B,H){return B.index<=H.index?B:H}static uxf(B,H){return H||B?H&&B?2:!H&&B?3:0:1}}Object(t.a)(y,"RelativeAndAbsoluteReferencesManager",null,[362])},955:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(268),e;(function(u){u[u.paren=0]="paren";u[u.lead=1]="lead";u[u.intern=2]="intern";u[u.trail=3]="trail";u[u.undefined=4]="undefined"})(e||(e={}));Object(t.b)("CurrencyFormatOption",
e);var f;(function(u){u[u.none=-1]="none";u[u.mdy=0]="mdy";u[u.dmy=1]="dmy";u[u.ymd=2]="ymd";u[u.myd=3]="myd";u[u.dym=4]="dym";u[u.ydm=5]="ydm"})(f||(f={}));Object(t.b)("DateOrderOption",f);var d=a(8);class h{constructor(u,z){({CalcHelper:u}=a(955));z&&(z.He||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.Szg=u.bIe(z,u.OHe(z.jja));this.Tzg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.Tzg}get localeData(){return this.Szg}formatNumber(u){return this.localeInfo.formatNumber(u)}}
Object(t.a)(h,"LocaleHolder",null,[]);var m=a(999),l=a(51),v=a(1),r=a(22),A=a(13),x=a(175);a.d(F,"CalcHelper",function(){return n});class n{constructor(u){this.$=u;(this.Xx=this.$.da.Aa(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let z;z=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.lo(76):l.a.current.lo(79);this.logger=new m.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Yba=new h(u,this.Xx);excelOnlineCalc.config.initCalc(this.logger,this.Xx?w=>this.Xx.isFeatureEnabled(w):()=>!1,z);this.zug=excelOnlineCalc.config.calcConfig(this.Yba.localeInfo)}get config(){return this.zug}sih(){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const u=this.$.va.na;
return u?u.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.na.index}createParser(){const u={};u.config=this.config;return excelOnlineCalc.parse.createParser(u)}createNumberFormatter(){const u=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(z,w)=>excelOnlineCalc.calc.getTime(this.config,z,w,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(u)}Fgh(u,z,w,C){if(!C)return{range:{row:z,col:w},sheet:{document:this.documentLoc,
index:u}};z=excelOnlineCalc.location.gridCell(z,w);u=excelOnlineCalc.location.sheetIndex(this.documentLoc,u);return excelOnlineCalc.location.sheetGridCell(u,z)}Fth(u,z){let w;w=excelOnlineCalc.calc.getEvalResultKind(u);switch(w){case 4:return{returnValue:u?this.Yba.localeInfo.trueName:this.Yba.localeInfo.falseName,kind:w};case 1:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.FCc(this.Yba.formatNumber(u),z):this.Yba.formatNumber(u),
kind:w};case 2:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.FCc(u.toString(),z):u.toString(),kind:w};case 128:return{returnValue:"",kind:w};case 8:switch(u.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.Yba.localeInfo.errorNames[u.type],kind:w};default:return{returnValue:n.unknownError,kind:w}}case 32:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.FCc(this.Vgh(u,z),z):"##UNSUPPORTED: ARRAY",kind:w};default:return{returnValue:A.a.instance.ga(2217),kind:w}}}FCc(u,z){return u.length<=z?u:u.substring(0,z-3)+"..."}Vgh(u,z){let w=this.Yba.localeInfo.leftBrace;for(let C=0;C<u.rows;++C){for(let y=0;y<u.cols;++y)w+=u.opers[C][y],y<u.cols-1&&(w+=this.Yba.localeInfo.columnSeparator);C<u.rows-1&&(w+=this.Yba.localeInfo.rowSeparator)}return this.FCc(w,z-1)+this.Yba.localeInfo.rightBrace}static bIe(u,z=null){const w=n.H5b(),C=u.He.TrueValueString,y=
u.He.FalseValueString,B=u.He.DecimalSeparator.toString(),H=u.He.ListSeparator.toString(),I=u.He.ColumnSeparator.toString(),R=u.He.RowSeparator.toString(),S=u.He.ThousandsDataArray,G=u.He.ThousandSeparator.toString(),D=u.He.Lcid,E=u.He.Country,M=u.He.DigitsNumber,L=u.He.ExpSeparatedBySpace,N=u.He.FractionSeparator.toString(),Y=u.He.PercentSeparatedBySpace,U=r.a.I1g(Enum.toString(e,u.He.CurrencyFormat)),P=u.He.CurrencySymbolLead,aa=u.He.CurrencySeparatedBySpace,X=u.He.CurrencySymbolString,Z=u.He.DigitsCurrency,
da=-1===u.He.DateOrder?"MDY":x.e(Enum.toString(f,u.He.DateOrder)),qa=u.He.DateSeparator.toString(),O=u.He.DateAlternativeSeparator.toString(),ca=u.He.Year4Digits,wa=u.He.Month2Digits,ia=u.He.Day2Digits,Ha=u.He.LongDateFormat,Sa=u.He.TimeSeparator.toString(),Da=u.He.TimeAltSeparator,ea=u.He.Hour2Digits,sa=u.He.Use24HourClock,Ea=u.He.AmPmSeparatedBySpace,ba=[u.He.AmString,u.He.PmString],ka=u.He.DayNameShortArray,Ca=u.He.DayNameLongArray,db=u.He.MonthNameShortArray,yb=u.He.MonthNameLongArray,kb=u.He.PictureSpecialArray,
mb=b.a.map(("\x00"+u.He.PictureSingleString).split(""),nc=>"\x00"===nc?null:nc),W=u.He.PictureColorArray,Q=u.He.PictureDbnumArray,va=u.He.RowLetter.toString(),na=u.He.ColumnLetter.toString(),Ba=u.He.LeftBrace.toString(),Oa=u.He.RightBrace.toString(),oa=u.He.LeftBracket.toString(),Ja=u.He.RightBracket.toString(),Wb=n.B3h(u.He);return excelOnlineCalc.calc.localeData(z,w,C,y,va,na,Ba,Oa,oa,Ja,B,H,I,R,S,G,D,E,M,L,N,Y,U,P,aa,X,Z,da,qa,O,ca,wa,ia,Ha,Sa,Da,ea,sa,Ea,ba,ka,Ca,db,yb,kb,mb,W,Q,Wb,u.He.SysDateFormatString,
u.He.SysTimeFormatString)}static OHe(u){const z=[];if(!u)return z;for(const w of u)u=null,w.IsDynamicUdf||(u=excelOnlineCalc.calc.worksheetFunctionName(w.FunctionIndexInServer,w.NameUI)),u&&z.push(u);return z}static H5b(){const u=[],z=Object.keys(d.a.errorNames);for(let w=0;w<z.length;w++){const C=excelOnlineCalc.calc.errorTypeName(w+1,z[w]);C&&u.push(C)}return u}static B3h(u){const z=Array(6);z[1]="#"+u.AllStructRefString;z[3]="#"+u.HeadersStructRefString;z[2]="#"+u.DataStructRefString;z[4]="#"+
u.TotalsStructRefString;z[5]="#"+u.ThisRowStructRefString;return z}}n.unknownError="##ERR##";Object(t.a)(n,"CalcHelper",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/5299109c1a0321c410b8f468baef9b56/EwaDSEsNext.calc.js.map