'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1223:function(t,F,a){t=a(0);var c=a(85),b=a(15),e=a(146),f=a(40);class d{constructor(C){this.Vfa=this.Pfa=this.Zfa=this.Yfa=null;this.q$d=this.Lce=this.$w=this.zL=!1;this.IRc=this.ade=null;this.Tce=0;this.mb=this.Zce=null;this.l1=C;this.Vz=3;this.Ojb=!0}initialize(C,y,B){this.Yfa=this.yid(C,y);this.Zfa=CommonUIStrings.l_SavingStatus;this.Pfa=CommonUIStrings.l_ReadOnlyStatus;this.Vfa=CommonUIStrings.l_ReviewModeStatus;
this.l1&&this.l1.execute(H=>{H.oXc(Object(c.a)(this,this.ZPb,"updateToSavingStatus"))});this.$w=!0;this.mb=B;return!0}Bea(C,y){this.zL=C;this.Vz=y;this.eS(this.Ojb)}eS(C){!this.Ojb&&C&&(this.Zce=new Date);this.Ojb=C;C=null;3===this.Vz&&(C=this.Ojb?this.Yfa:this.Zfa);this.qnh(C)}yid(C,y){return C?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):y&&y.length?String.format(CommonUIStrings.l_SavedToStatus,y):CommonUIStrings.l_SavedStatus}ZPb(){this.eS(!1)}FYh(){switch(this.Vz){case 1:return this.Pfa;
case 2:return this.Vfa;default:return null}}Hni(C){return this.Lce===this.zL&&this.Tce===this.Vz&&this.ade===C}E8c(C){appChrome.getHeaderApi().then(y=>{y.updateDocumentTitleStatus(this.zL,C,this.FYh(),this.Zce,this.Ojb);this.q$d=!0;return null});this.IRc=null}qnh(C){this.$w&&e.c()&&!this.Hni(C)&&(!this.q$d&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.E8c(C):f.a.tNd()?(this.IRc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.IRc=window.requestIdleCallback(()=>{this.E8c(C)})):window.requestAnimationFrame(()=>{this.E8c(C)}),this.Lce=this.zL,this.ade=C,this.Tce=this.Vz)}}Object(t.a)(d,"ReactSaveStatusUIHandler",null,[552]);var h=a(167);class m{constructor(C,y){this.ds=null;this.Yfa=CommonUIStrings.l_SavedStatus;this.Zfa=CommonUIStrings.l_SavingStatus;this.Pfa=CommonUIStrings.l_ReadOnlyStatus;this.Vfa=CommonUIStrings.l_ReviewModeStatus;this.cUb=y;this.l1=C;this.Vz=3;this.gra=!0}Et(){this.l1&&this.l1.execute(C=>{C.oXc(Object(c.a)(this,
this.ZPb,"updateToSavingStatus"))});this.cUb.execute(C=>{this.ds=C})}Bea(C,y){this.Vz=y;3===y?this.eS(this.gra):2===y?this.i_d(this.Vfa):this.i_d(this.Pfa)}ZPb(){this.eS(!1)}eS(C){this.gra=C;this.i_d(this.gra?this.Yfa:this.Zfa)}i_d(C){this.ds&&this.ds.jj(h.a.VWj,this.e9g(C))}e9g(C){const y={};y.StatusText=C;return y}}Object(t.a)(m,"SaveStatusPostMessageHandler",null,[552]);var l=a(91),v=a(125),r=a(57);class A{constructor(C,y,B,H){this.Vfa=this.Pfa=this.Zfa=this.Yfa=null;this.qEa=0;this.ZD=this.uSc=
this.FCa=this.gHc=this.nFa=null;this.Od=C;this.x8=y;this.l1=B;this.Yi=H;this.dbe=!0;this.zL=!1;this.Vz=3;this.gra=!0}initialize(C,y){if(!this.Od)return!1;this.Yfa=this.yid(C,y);this.Zfa=CommonUIStrings.l_SavingStatus;this.Pfa=CommonUIStrings.l_ReadOnlyStatus;this.Vfa=CommonUIStrings.l_ReviewModeStatus;this.Et();return!0}yid(C,y){return C?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):y&&y.length?String.format(CommonUIStrings.l_SavedToStatus,y):CommonUIStrings.l_SavedStatus}Et(){this.x8&&
this.x8.execute(C=>{C.YNg(Object(c.a)(this,this.aJe,"createStatusAndModeElements"));C.RNg(Object(c.a)(this,this.BIj,"showHideSaveStatusElement"));C.ETj&&this.aJe(null,null)});this.l1&&this.l1.execute(C=>{C.oXc(Object(c.a)(this,this.ZPb,"updateToSavingStatus"))})}Gv(){this.ZD&&this.Od&&this.Od.VF(this.ZD)}BIj(C,y){this.Bea("true"===y,this.Vz)}Bea(C,y){this.zL=C;this.Vz=y;this.gHc&&(this.gHc.style.display=this.zL||3===this.Vz||!this.nFa?"none":"");this.FCa&&(this.FCa.style.display=this.zL||3===this.Vz?
"none":"",this.FCa.innerText=1===this.Vz?this.Pfa:this.Vfa,this.FCa.title=1===this.Vz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.uSc&&(this.uSc.style.display=this.zL||1===this.Vz||!this.nFa&&!this.FCa?"none":"");this.ZD&&(this.ZD.style.display=this.zL||1===this.Vz?"none":"",this.eS(this.gra),this.ZD.title=CommonUIStrings.l_SaveStatusTooltip)}aJe(C,y){C=document.getElementById(l.CuiHelper.Abf);y&&y.c6j||!C||""===this.Yfa||""===this.Zfa||""===this.Pfa||""===
this.Vfa||(this.nFa=document.getElementById(l.CuiHelper.Z1b),this.gHc=l.CuiHelper.eta(C,"BreadcrumbAppModeDash","-",null,!1),this.FCa=l.CuiHelper.eta(C,"BreadcrumbAppModeStatus",1===this.Vz?this.Pfa:this.Vfa,null,!1),this.ojg(this.FCa),this.uSc=l.CuiHelper.eta(C,"BreadcrumbSaveStatusDash","-",null,!1),this.ZD=l.CuiHelper.eta(C,"BreadcrumbSaveStatus",this.Yfa,null,!1),this.ojg(this.ZD),this.Bea(this.zL,this.Vz))}ZPb(){this.eS(!1)}eS(C){this.gra=C;this.h1j(this.gra?this.Yfa:this.Zfa)}h1j(C){!this.ZD||
3!==this.Vz&&2!==this.Vz||(this.dbe&&!this.gra?(this.qEa=this.ZD.offsetWidth<this.qEa?this.qEa:this.ZD.offsetWidth,this.ZYj(this.Zfa),this.dbe=!1):this.ZD.innerText=C)}ojg(C){C.style.direction=this.Yi?"rtl":"ltr";C.style.width="auto";C.style.textAlign=this.Yi?"right":"left";C.style.display=this.zL?"none":"";C.setAttribute("Unselectable","on")}ZYj(C){this.ZD&&(this.ZD.style.width="",this.ZD.innerText=C,this.qEa=this.ZD.offsetWidth<this.qEa?this.qEa:this.ZD.offsetWidth,C=v.a.KA(this.ZD),this.ZD.style.width=
this.qEa-r.a.nD(C.paddingLeft)-r.a.nD(C.paddingRight)+1+"px")}}Object(t.a)(A,"SaveStatusUIHandler",null,[552]);var x=a(4),n=a(95);class u{constructor(){this.vSc=this.uRc=this.dmb=this.$a=null}get name(){return"Common.App.SaveStatus"}Ah(C){this.$a=C;x.AFrameworkApplication.fa.pa("PostMessageEmbedded")&&x.AFrameworkApplication.hideHeaderEmbedded?this.$a.register(m,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new m(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),
this.$a.Tb("Postmessage.IHostPostmessenger"))):x.AFrameworkApplication.ra.Qa.Imf||(x.AFrameworkApplication.ra.Qa.gs?this.$a.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new d(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"))):this.$a.register(A,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new A(n.EventHandlerManager.instance,this.$a.Tb("Common.App.Header.HeaderEventSource"),
this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),x.AFrameworkApplication.isRtl)))}init(){x.AFrameworkApplication.fa.ru(Object(c.a)(this,this.jB,"onFullAppSettingsReady"))}jB(){const C=x.AFrameworkApplication.fa,y=!!x.AFrameworkApplication.ra.Qa&&4===x.AFrameworkApplication.ra.Qa.Oj;if(C.pa("WordEditorAutoSaveImprovementIsEnabled")||C.pa("PptEditorSaveStatusInHeaderEnabled")||y&&C.pa("SimplifiedReactRibbonUxIsEnabled")||C.pa("ExcelSaveStatusInHeaderEnabled")||C.pa("VisioSaveStatusInHeaderEnabled"))x.AFrameworkApplication.fa.pa("PostMessageEmbedded")&&
x.AFrameworkApplication.hideHeaderEmbedded?(this.vSc=this.$a.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.vSc.Et():x.AFrameworkApplication.ra.Qa.Imf||C.pa("PreventSaveStatusInitializationWithHiddenHeader")&&x.AFrameworkApplication.hideHeader||(x.AFrameworkApplication.ra.Qa.gs?(this.uRc=this.$a.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.uRc.initialize(C.pa("IsSkyDrive"),C.Wa("HostNameToIncludeInSavedStatus"),x.AFrameworkApplication.fa):(this.dmb=this.$a.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.dmb.initialize(C.pa("IsSkyDrive"),C.Wa("HostNameToIncludeInSavedStatus")))}dispose(){this.dmb&&this.dmb.Gv()}}Object(t.a)(u,"PackageManager",null,[4,5]);var z=a(252);a.d(F,"a",function(){return w});const w=()=>{Type.registerNamespace("Common.App.SaveStatus");z.a.instance.gi(new u)}},1279:function(t,F,a){var c=a(9);t=a(0);var b=a(83),e=a(226),f=a(229),d=a(29),h=a(21);class m{constructor(A,x){this.Rie=this.NMc=!1;this.Sya=(n,u)=>{(null===u||void 0===u?0:u.QG)&&d.a.XSg([u.QG])&&(this.gLb=!0)};this.xo=
()=>{this.gLb=!1};this.Rc=(n,u)=>{f.b(u)&&this.Bea(!0);this.gLb=!1};this.dd=()=>{this.PM=this.$.PM;this.Bea()};this.CHf=()=>{this.eS()};this.HGf=()=>{this.PM=this.$.PM};this.nCd=()=>{h.h(this.$).Ca.Mw(this.nCd);this.PM=this.$.PM};this.W0f=x;this.$=A;this.$.userOperationManager.Lr(this.HGf);this.$.Lk(this.dd);this.$.ea.yOg(this.CHf);this.$.ea.Jj(this.Rc);this.$.I_b(this.Sya);this.$.ea.ML(this.xo);this.Bea()}get ayi(){return this.$.ea?this.$.ea.upf:!1}get PM(){return this.NMc}set PM(A){A?this.NMc=!0:
h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.v4()?this.NMc=!1:h.h(this.$).Ca.Rv(this.nCd));this.eS()}get gLb(){return this.Rie}set gLb(A){this.Rie=A;this.eS()}dispose(){this.$&&(this.$.pl(this.dd),this.$.Muc(this.Sya),this.$.userOperationManager&&this.$.userOperationManager.zo(this.HGf),this.$.ea&&(this.$.ea.Ukj(this.CHf),this.$.ea.ik(this.Rc),this.$.ea.rR(this.xo)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.Mw(this.nCd))}Bea(A=!1){A=!this.$.isEditMode||A;this.W0f.Bea(A,this.$.isEditMode?3:1);this.eS()}eS(){this.$.isEditMode&&
this.W0f.eS(!this.PM&&!this.ayi&&!this.gLb)}}Object(t.a)(m,"SaveStatusManager",null,[2]);var l=a(712);class v extends e.a{constructor(A){super();this.Oc=A;this.Db()}create(){const A=b.a.instance;A.Tb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(x=>{const n=new m(this.Oc,x);A.register(m,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").qc().yc(()=>n);x=Object(l.a)(this.Oc.da,300,()=>A.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.nb(x)})}static ka(A){A.da.Ha(299,
new v(A))}}Object(t.a)(v,"SaveStatusFactory",e.a,[]);a.d(F,"a",function(){return r});const r=()=>{c.a.Fa(v.ka)}},1427:function(t,F,a){a.r(F);t=a(1223);a=a(1279);Type.registerNamespace("_Ewa");Object(t.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/b2f22ff968bca0761f96201042c3a4d8/EwaDSEsNext.savestatus.js.map