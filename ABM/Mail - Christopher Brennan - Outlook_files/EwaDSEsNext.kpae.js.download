'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1099:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1100:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}mt(){return this.command}}Object(t.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[122])},1101:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1102:function(t,F,a){a.d(F,"a",function(){return"FieldInfoListContextLoaded"});a.d(F,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(F,"d",function(){return"Days from Today"});a.d(F,"g",function(){return"Years from Today"});a.d(F,"c",function(){return"Day of the Week"});a.d(F,"f",function(){return"Month of the Year"});a.d(F,"e",function(){return"End of Month"});a.d(F,"b",function(){return"Next Day"})},1103:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>
{c.a.Ai(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1104:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1105:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(t.b)("DataValidationRuleType",c)},1107:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-facp-text-box{position:absolute}")}},1108:function(t,F,a){a.d(F,"b",function(){return"MinorThemeFont"});
a.d(F,"a",function(){return"MajorThemeFont"})},1110:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1111:function(t,F,a){a.d(F,"a",function(){return m});t=a(0);F=a(239);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class m extends F.a{constructor(l){super(document.createElement("div"));this.QQ=this.JIa=this.IIa=this.KIa=this.MIa=this.LIa=!1;this.zI=null;this.visible=void 0;this.hpc=(v,r)=>{this.zt(v,r)};this.LLa=()=>{this.eb.textBox.XE=!0};this.Oya=()=>{this.My(!0)};this.Pzf=()=>{this.eb.textBox.focus()};this.Eh=()=>{f.h(this.$).inRangePicker||(this.re=!1)};this.$=l;f.h(l)&&f.h(l).ha&&f.h(this.$).ha.wG(this.Eh);
this.Nk=b.a.u4(l)}get HH(){return this.au.HH}get re(){return this.au.re}set re(l){this.au.re=l}get eb(){return this.zI}set eb(l){(this.zI=l)&&this.zI.c2d.add(this)}get XJh(){return b.a.TM(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(l){if(this.visible===l)return l;this.visible=l;return super.set_visible(l)}zt(){this.QBa(!1);this.au.zt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.EK(this.Eh);this.$=null;super.dispose()}Mh(l,
v,r=!1){l=!1;if((this.l1a||r)&&!this.Rwa()&&this.get_visible()&&this.re)switch(this.Nk&&this.yDc(v),v){case 1872288872:this.re=!1;l=!0;break;case -798660877:this.au.dB(1);l=!0;break;case 137938150:this.au.dB(-1);l=!0;break;case 2091832999:this.au.dB(this.HH-1);l=!0;break;case 742457698:this.au.dB(-(this.HH-1));l=!0;break;case 125627505:l=this.My(!1);break;case 267796030:b.a.u4(this.$)&&(l=this.My(!1))}return l}QBa(l){if(this.re||l){var v=f.h(this.$);l=v.domElement;var r=this.zI.textBox.domElement,
A=d.a(this.$).ki(r.offsetHeight),x=d.a(this.$).ki(r.offsetTop),n=d.a(this.$).ki(r.offsetWidth);r=d.a(this.$).ki(r.offsetLeft);v=v.Ql;var u=h.AFrameworkApplication.ra&&h.AFrameworkApplication.ra.Qa.Qe,z=$get(this.$.Bb+c.a.p0a,this.$.domElement);u&&(z=document.getElementById("EditorContainer"));var w=new Sys.UI.Point(v?this.au.Hac:0,v?this.XJh:m.d8h);A=z.offsetTop+w.y+(b.a.TM(this.$)&&v?0:A+x);this.$.NZ||(x=$get(c.a.bsa,this.$.domElement),A+=x&&!u?x.offsetHeight:0);x=this.domElement;x.style.top=e.HelperMethods.sc(A);
r=z.offsetLeft+r+w.x;!b.a.TM(this.$)&&this.$.isChromeRtl?x.style.right=e.HelperMethods.sc(v?this.au.Hac:l.offsetLeft+l.offsetWidth-r-n):x.style.left=e.HelperMethods.sc(r)}}gTa(l){this.au&&(l&&!this.QQ?(this.au.s9(this.Pzf),this.au.z_b(this.LLa),this.au.qob(this.Oya),this.QQ=!0):this.QQ&&(this.au.rda(this.Pzf),this.au.Duc(this.LLa),this.au.SJb(this.Oya),this.QQ=!1))}yDc(l){switch(l){case -798660877:case 137938150:case 2091832999:case 742457698:this.LIa=!0;break;case 125627505:this.KIa=!0;break;case 267796030:b.a.u4(this.$)&&
(this.IIa=!0)}}}m.Hac=0;m.d8h=1;Object(t.a)(m,"AutoCompleteControl",F.a,[265])},1112:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.EF=f;this.description=d}}Object(t.a)(c,"ListEventArgs",Sys.EventArgs,[])},1113:function(t,F,a){a.d(F,"a",function(){return x});t=a(0);var c=a(15),b=a(27);F=a(856);var e=a(786),f=a(5),d=a(68),h=a(33),m=a(12),l=a(1),v=a(116),r=a(21),A=a(929);class x extends F.a{constructor(n,
u){super(n,u,new A.a(e.a.listItem,e.a.mDb,e.a.pDb,e.a.qDb));this.Xdc=!1;this.jmb=this.To=null;this.GZe=!1;this.visible=void 0;this.fBa(!0);this.GZe=l.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get Hac(){if(h.a.TM(this.$)){var n=document.getElementById(this.$.Bb+f.a.FZe);return!this.GZe||n?m.DOMElementExtensions.getBoundingClientRect(n).x:0}n=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.Xzd):document.getElementById(this.$.Bb+
f.a.Xzd+"-"+f.a.Iwf);c.ULS.shipAssertTag(537170323,0,!!n||this.$.aK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return n?n.offsetWidth:0}get ee(){return this.jmb}set ee(n){this.jmb=n}get re(){return void 0!==this.visible?this.visible&&0<this.To.length:(this.visible=m.DOMElementExtensions.isVisible(this.Df))&&0<this.To.length}set re(n){this.visible!==n&&(m.DOMElementExtensions.setVisible(this.Df,n),m.DOMElementExtensions.setVisible(this.JTa,n),this.visible=
n);const u=r.h(this.$).view;n?this.Xdc||(u.Ps(this.FGa.hpc),this.Xdc=!0):(this.To.length=0,this.Xdc&&(u.Jq(this.FGa.hpc),this.Xdc=!1))}eya(){var n=460;const u=r.h(this.$);var z=u.domElement,w=this.JTa.style;const C=this.Df.offsetTop+this.Ej.offsetHeight*this.Ej.sectionRowIndex-this.Df.scrollTop;w.width="auto";w.whiteSpace="nowrap";w.position="absolute";const y=z.offsetLeft+z.offsetWidth-(this.domElement.offsetLeft+this.Df.offsetLeft+this.Df.offsetWidth+3);z=this.domElement.offsetLeft-3-(z.offsetLeft+
this.Hac);n=Math.min(this.JTa.offsetWidth,n,Math.max(y,z));m.DOMElementExtensions.Hv(this.JTa,n);w.whiteSpace="";w.position="absolute";C+3>this.Df.offsetTop+this.Df.offsetHeight||C<this.Df.offsetTop||(n=this.Df.offsetLeft-3-this.JTa.offsetWidth,w=this.Df.offsetLeft+this.Df.offsetWidth+3,m.DOMElementExtensions.updatePosition(this.JTa,z>y!==u.rtl?n:w,C,!1))}dB(n){super.dB(n);this.eya()}zt(){this.eya()}Ura(){const n=this.vn,u=this.Df,z=3===d.a.zb||b.a.cp,w=z?this.iEb:this.HH;this.re=!0;u.style.height=
"auto";this.FGa.set_visible(!0);this.Vnb(n,z);this.To.length>w&&(m.DOMElementExtensions.vI(u,Math.floor(u.offsetHeight*w/this.To.length)),u.style.overflowY="auto");m.DOMElementExtensions.Hv(u,n.offsetWidth+(this.To.length>w?v.a.Bu:0))}}Object(t.a)(x,"AutoCompleteListBox",F.a,[])},1114:function(t,F,a){a.d(F,"a",function(){return r});t=a(0);var c=a(227),b=a(14),e=a(110),f=a(241);F=a(239);var d=a(746),h=a(5),m=a(51),l=a(12),v=a(74);class r extends F.a{constructor(A,x,n,u,z,w,C,y,B,H){super(document.createElement("a"));
this.Zw=!1;this.fd=I=>{this.raiseEvent("ClickButton",I);return!0};this.onKeyDown=I=>{this.raiseEvent("KeyDown",I);return!1};this.Bw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.xN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=I=>{v.g(I);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=I=>{v.g(I);this.focused=!0;this.raiseEvent("Focus")};this.Mrh=y;this.anh=B;this.EI=r.pb(this.domElement,x,n,u,z,w,C,H);this.Cc.ka("contextmenu",I=>{v.g(I)});this.enable();
this.focused=this.hovered=!1;A.appendChild(this.domElement)}aXc(A){this.get_events().addHandler("ClickButton",A)}NLd(A){this.get_events().removeHandler("ClickButton",A)}lXc(A){this.get_events().addHandler("KeyDown",A)}ZLd(A){this.get_events().removeHandler("KeyDown",A)}N_b(A){this.get_events().addHandler("PointerOver",A)}iMd(A){this.get_events().removeHandler("PointerOver",A)}M_b(A){this.get_events().addHandler("PointerOut",A)}hMd(A){this.get_events().removeHandler("PointerOut",A)}bob(A){this.get_events().addHandler("Blur",
A)}EJb(A){this.get_events().removeHandler("Blur",A)}s9(A){this.get_events().addHandler("Focus",A)}rda(A){this.get_events().removeHandler("Focus",A)}get Bl(){return this.EI}get isEnabled(){return this.Zw}enable(){this.domElement&&(this.domElement.classList.remove(d.a.VT),this.domElement.style.cursor="",c.a.instance.ta(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.ta(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.ta(b.a.pointerOver,this.domElement,this.Bw),f.a.instance.ta(b.a.pointerOut,
this.domElement,this.xN),this.Cc.Bi("blur")||this.Cc.ka("blur",this.onBlur),this.Cc.Bi("focus")||this.Cc.ka("focus",this.onFocus),this.domElement.title=this.Mrh,this.Zw=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.VT),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Bw),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.xN)),this.domElement.title=this.anh,this.Zw=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Bw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.xN),this.Zw=!1);l.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(A,x,n,u,z,w,C,y){A.removeAttribute("Href");A.setAttribute(h.a.Cd,h.a.Qs);A.className=x;A.tabIndex=
y;x=document.createElement("span");x.className=C;x.classList.add(n);x.tabIndex=-1;A.appendChild(x);A=document.createElement("img");A.src=m.a.qe(u);A.className=z;A.alt=w;A.tabIndex=-1;x.appendChild(A);return A}}Object(t.a)(r,"ListButton",F.a,[272,2])},1115:function(t,F,a){a.d(F,"a",function(){return d});t=a(0);var c=a(114),b=a(28),e=a(1),f=a(740);class d{constructor(l){this.Tvf=l;this.MV=Object.assign({},m);this.Utb=[];this.Mmc=-1;(this.Svf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
l&&(this.MV.countAboveThresholds={},l.forEach(v=>this.MV.countAboveThresholds[v]=0))}static get tYd(){return b.a.Ya.ue.m}YSa(){this.Mmc=d.tYd}u3(l,v=null){if(-1!==this.Mmc||Object(f.b)(v))l?(this.Snb(d.tYd-(v||this.Mmc)),this.Mmc=-1):this.MV.failedCount++}CXe(){this.MV.excludingFirstAction=d.BXe(this.Utb);this.Utb.push(this.MV.firstAction);this.MV.includingFirstAction=d.BXe(this.Utb)}Snb(l){this.MV.count?1E3>this.MV.count&&this.Utb.push(l):this.MV.firstAction=l;this.Svf&&this.Tvf&&this.Tvf.forEach(v=>
{l>v&&this.MV.countAboveThresholds[v]++});this.MV.count++}static BXe(l){const v=Object.assign({},h);0<l.length&&(c.i(l),v.median=l[Math.floor(.5*l.length)],v.P75=l[Math.floor(.75*l.length)],v.P95=l[Math.floor(.95*l.length)],v.max=l[l.length-1],v.average=c.g(l,r=>r)/l.length);return v}}Object(t.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},m={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1161:function(t,F,a){function c(bb){var Lb=Object(H.h)(bb),mc=Object(R.a)(bb);const Uc=Lb.li;var pd=Lb.mc.Akf;pd=Lb.Ql||pd&&mc;mc=b((pd?mc:Uc).textBox.domElement);if(pd)Lb={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(Lb=b(Lb.domElement),{zoom:bb}=Object(S.a)(bb),1!==bb)for(const ta of[mc,Lb])for(const rb in ta)ta[rb]*=bb;return{target:mc,bounds:Lb}}function b(bb){const {top:Lb,left:mc,right:Uc,bottom:pd}=bb.getBoundingClientRect();return{top:Lb,left:mc,right:Uc,bottom:pd}}function e(bb){var Lb;
if(bb){var mc=new Jb(0===bb.kind);bb=null===(Lb=null===bb||void 0===bb?void 0:bb.rangeInfo)||void 0===Lb?void 0:Lb.positionKindInfo;if(!bb)return mc;mc.cF=0===bb.firstRow;mc.bF=0===bb.firstColumn;mc.WJ=0===bb.secondRow;mc.VJ=0===bb.secondColumn;return mc}}var f=a(9),d=a(0),h=a(709),m=a(50),l=a(37),v=a(15),r=a(19),A=a(386),x=a(68);class n{}n.lbd="!";n.SKf="[";n.RKf="]";n.openParen="(";n.closeParen=")";n.Cng=" /.(*\\".split("");n.L8b="...";n.qHb="param_help_link";n.DFd="param_help_udf";n.fed="function_list_box";
n.UKh="function_param_box";n.hed="function_reader_description";n.aed="function_description_box";n.XZe="function_param_table";n.f3i="param_row_";n.erc="param_set";n.CLf="param_row_0";n.DLf="param_row_1";n.VKh="<div id='{0}' class='{1}'></div>";n.TKh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";n.ELf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
n.RKh="<div id='{0}' class='{1} {2} {3}'></div>";n.NKh="<div id='{0}' class='{1} {2} {3} {4}'></div>";n.Wpf="[@";n.sah=1;n.rah=3;n.vkh=500;n.ovf=50;Object(d.a)(n,"FormulaAssistanceConstants",null,[]);var u=a(13),z=a(285),w=a(8),C=a(5),y=a(94),B=a(11),H=a(21),I=a(357),R=a(117),S=a(34),G=a(105),D=a(186),E=a(1);const M=(bb,Lb,mc)=>{if(bb){const Uc=bb.da.Aa(491);Uc?Uc.VI("lm"):v.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");
mc?N(bb,Lb,mc):(mc=new y.a(-859308420,x.a.zb,bb.xc,0,null),bb.Ia.Hb(mc,{[x.a.Kc]:C.a.RU,[x.a.Pf]:"HelpID="+Lb}))}},L=(bb,Lb,mc)=>{const Uc={};Uc[C.a.sM]=Lb;Lb={};Lb.FunctionName=mc;Uc[C.a.Qbd]=Lb;bb.Zc(802602464,0,8,Uc)},N=(bb,Lb,mc)=>{if(mc){if(Lb&&(!Lb||Lb.startsWith("http://")||Lb.startsWith("https://"))){if(bb.sa(147)){let Uc;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7574381_RemoveResolveSyncV2"))Uc=D.a.RKa(G.l);else try{Uc=D.a.TQa(G.l)}catch(pd){}if(Uc&&Uc.LBa(Lb))return}B.HelperMethods.gf(Lb,
"_blank",I.a)}}else B.HelperMethods.GV(bb.UF,"XLWAEndUser_"+Lb,bb.gS)},Y=bb=>{let Lb=w.a.q_;const mc=bb.da.Aa(368);mc&&!Object(H.h)(bb).Ql&&(Lb=mc.zoom);return Lb};var U=a(240),P=a(4),aa=a(30),X=a(740);class Z{constructor(bb){this.$=bb;this.Y9d={};this.Kbb={};this.Bce=void 0;this.vQg=u.a.instance.ga(1031);this.TJd=u.a.instance.ga(1032);this.XEe=u.a.instance.ga(1030);this.OKh="InsertFunctionDialog";this.CSf="recentlyUsedFunctions";this.dHi=15;this.nfi=()=>{this.pfa=this.$.da.Aa(19);this.pfa.dJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.eNe(this.ofi,this.Gfi,this.Yei)};this.Gfi=()=>{if(this.Ujf){this.qbf=this.mWh();this.Kbb=JSON.parse(this.localStorage.x4a(this.CSf));this.Kbb||(this.Kbb={});const Lb=this.Kbb[this.qbf];Lb&&(Array.isArray(Lb)&&Lb.every(this.hpi)?this.Gza=Lb:qa("initRecentlyUsedFunctions: Recently used functions are not an array of numbers as expected"))}this.Gza||(this.Gza=this.pfa.BKa(this.XEe).map(da))};this.ofi=()=>{this.q0b=this.pfa.Rac.filter(this.xkf);this.q0b.forEach(Lb=>
{this.Y9d[Lb.FunctionIndex]=Lb})};this.Yei=()=>{this.categories=this.functionInfoManager.Qvb.filter(Lb=>Lb!==this.XEe);this.categories.unshift(this.TJd)};this.c$i=Lb=>{this.Gza?(this.Gza=this.Gza.filter(mc=>mc!==Lb).slice(0,this.dHi-1),this.Gza.unshift(Lb),this.Ujf&&(this.Kbb[this.qbf]=this.Gza,this.localStorage.fyc(this.CSf,JSON.stringify(this.Kbb)))):qa("pushFunctionToRecentlyUsed: Recently used functions array was not initialized.")};this.xkf=Lb=>!this.pfa.Uhc(Lb);this.eNe=(...Lb)=>{if(this.pfa.cV)Lb.forEach(mc=>
mc());else{const mc=()=>{this.pfa.hcb(mc);Lb.forEach(Uc=>{Uc()})};this.pfa.YFa(mc)}};this.mWh=()=>{const Lb=P.AFrameworkApplication.fa.Wa("LoggableUserId");return Lb?aa.a.Yu(Lb).toString():"0"};this.hpi=Lb=>"number"===typeof Lb&&Object(X.b)(this.functionInfoManager.Hgd(Lb));this.localStorage=new U.a;this.Ujf=this.localStorage.Fe();this.nfi()}static instance(bb){this.La||(this.La=new Z(bb));return this.La}get functionInfoManager(){return this.pfa}get PKh(){return this.Y9d}get Qvb(){return this.categories}get NHh(){var bb;
return null!==(bb=this.Bce)&&void 0!==bb?bb:this.TJd}BKa(bb){this.Bce=bb;return bb===this.TJd?this.Gza:this.pfa.BKa(bb).filter(this.xkf).map(da)}qGh(bb=""){bb=bb.toLocaleLowerCase();const Lb=this.q0b.filter(({NameUI:mc})=>mc.toLocaleLowerCase().startsWith(bb));3<=bb.length&&(Lb.push(...this.q0b.filter(mc=>mc.NameUI.toLocaleLowerCase().includes(bb)&&!Lb.includes(mc))),Lb.push(...this.q0b.filter(mc=>mc.Help.toLocaleLowerCase().includes(bb)&&!Lb.includes(mc))));return Lb.map(da)}}Object(d.a)(Z,"FunctionDialogUtils",
null,[]);const da=bb=>bb.FunctionIndex,qa=bb=>{v.ULS.sendTraceTag(509670041,0,10,`FunctionDialogUtils.${bb}`)};var O=a(266),ca=a(22),wa;(function(bb){bb.functionInfo="functionInfo";bb.giveFeedbackCallback="giveFeedbackCallback";bb.listSeparator="listSeparator"})(wa||(wa={}));Object(d.b)("SignatureDialogPropKeys",wa);class ia extends z.a{static show(bb,Lb){bb=Z.instance(Lb).functionInfoManager.Hgd(bb);new ia(bb,Lb)}constructor(bb,Lb){super(Lb);this.functionInfo=bb;this.Epg=(mc,Uc)=>{1===mc?(this.hide(),
mc=new y.a(1117706454,0,this.$.xc,8,null),this.$.Ia.Hb(mc,{[Qa.Qac]:Uc.selectedFunctionInfo,["argumentsDialogSource"]:2})):2===mc&&(this.hide(),Uc=new y.a(753860909,0,this.$.xc,8,null),this.$.Ia.Hb(Uc))};this.TCd=mc=>{this.hide();L(this.$,"functionSignatureDialog",mc)};this.el=u.a.instance.ga(1033);this.Dnd()}Dnd(){this.initializeAndShow(this.el,this.Epg,{[ia.it]:this.kc,[wa.functionInfo]:this.functionInfo,[wa.giveFeedbackCallback]:this.TCd.bind(this),[wa.listSeparator]:this.$.listSeparator})}get kc(){return"FunctionSignatureDialog"}}
Object(d.a)(ia,"FunctionSignatureDialog",z.a,[]);var Ha;(function(bb){bb[bb.FunctionsDialog=0]="FunctionsDialog";bb[bb.RibbonButton=1]="RibbonButton";bb[bb.SignatureDialog=2]="SignatureDialog"})(Ha||(Ha={}));Object(d.b)("ArgumentsDialogSource",Ha);class Sa extends z.a{static show(bb,Lb,mc,Uc,pd){new Sa(bb,Lb,mc,Uc,pd)}constructor(bb,Lb,mc,Uc,pd){super(bb);this.functionInfo=Lb;this.formulaAuthoringHelper=mc;this.Q$f=Uc;this.bTg=pd;this.KKh=(ta,rb)=>{var gc;this.hide();if(1===ta){ta=this.functionInfo.NameUI;
for(rb=null!==(gc=rb.functionArgs)&&void 0!==gc?gc:[];1<rb.length&&ca.a.lh(rb[rb.length-1]);)rb.pop();gc={[x.a.Kc]:ta,["functionArgs"]:rb,["ibdk"]:!0};rb=new y.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(rb,gc)}else if(2===ta)switch(this.bTg){case Ha.FunctionsDialog:gc=new y.a(753860909,0,this.$.xc,8,null);this.$.Ia.Hb(gc);break;case Ha.SignatureDialog:ia.show(this.functionInfo.FunctionIndex,this.$)}};this.GV=()=>N(this.$,this.functionInfo.HelpId,!1);this.UVh=()=>this.formulaAuthoringHelper.hasRepeatingParams(this.functionInfo)?
ta=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.Q$f,this.functionInfo,ta):void 0;this.feedbackCallback=ta=>L(this.$,"functionArgumentsDialog",ta);this.el=u.a.instance.ga(1033);this.rangePickerController=Object(H.h)(this.$).Gg.Fxb();this.ig()}get kc(){return"FunctionArgumentsDialog"}ig(){this.Ob=1;this.uq={[O.a.it]:this.kc,["functionInfo"]:this.functionInfo,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.Q$f,this.functionInfo),["generateArgByIndex"]:this.UVh(),["helpCallback"]:this.GV,
["giveFeedbackCallback"]:this.feedbackCallback,["isModal"]:!1,["rangePickerController"]:this.rangePickerController};this.initializeAndShow(this.el,this.KKh,this.uq)}hide(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7428201_supportStopRangePickerWithoutSupplyingTextboxId")&&this.rangePickerController.disposeRangePicker(void 0);super.hide()}}Object(d.a)(Sa,"FunctionArgumentsDialog",z.a,[]);var Da;(function(bb){bb.CategoryList="categoryList";bb.FunctionsMap="functionsMap";bb.FunctionIdsToDisplay="functionIdsToDisplay";
bb.RefreshListCallback="refreshListCallback";bb.HelpCallback="helpCallback";bb.feedbackCallback="giveFeedbackCallback";bb.InitialCategory="initialCategory";bb.AllCategoryName="allFunctionsCategoryName"})(Da||(Da={}));Object(d.b)("PropsKeys",Da);class ea extends z.a{static show(bb){new ea(bb)}constructor(bb){super(bb);this.RZe=(Lb,mc)=>{if(1===Lb){this.hide();Lb=this.functionInfoManager.j3e(mc.functionName);mc={[Qa.Qac]:Lb,["ibdk"]:!0,["argumentsDialogSource"]:0};const Uc=new y.a(0<Lb.Params.length?
1117706454:-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(Uc,mc);this.utils.c$i(Lb.FunctionIndex)}};this.Dnd=()=>{const Lb=this.utils.NHh;this.uq={[ea.it]:this.kc,[Da.CategoryList]:this.utils.Qvb,[Da.FunctionsMap]:this.utils.PKh,[Da.FunctionIdsToDisplay]:this.utils.BKa(Lb),[Da.RefreshListCallback]:this.NUi.bind(this),[Da.feedbackCallback]:this.TCd.bind(this),[Da.HelpCallback]:this.Rbi,[Da.InitialCategory]:Lb,[Da.AllCategoryName]:this.utils.vQg};this.initializeAndShow(this.el,this.RZe,this.uq)};this.Rbi=
Lb=>{N(this.$,Lb,!1)};this.TCd=Lb=>{this.hide();L(this.$,this.utils.OKh,Lb)};this.el=u.a.instance.ga(1033);this.utils=Z.instance(bb);this.ig()}get kc(){return"FunctionDialog"}get functionInfoManager(){return this.utils.functionInfoManager}ig(){this.Ob=1;this.utils.eNe(this.Dnd)}b_j(bb){this.uq[Da.FunctionIdsToDisplay]=bb;this.aUa(this.el,this.P4a(this.RZe),this.uq)}NUi(bb,Lb){bb=Lb?this.utils.qGh(Lb):this.utils.BKa(bb);this.b_j(bb)}}Object(d.a)(ea,"FunctionDialog",z.a,[]);var sa=a(55),Ea=a(71),ba=
a(33),ka=a(89),Ca=a(27),db=a(215),yb=a(72),kb=a(87),mb=a(229),W=a(51),Q=a(749),va=a(12),na=a(74);const Ba=yb.a.$uh,Oa=yb.a.hvh,oa=yb.a.ivh,Ja=yb.a.RRe,Wb=yb.a.bvh,nc=yb.a.dvh,Yb=yb.a.LRe,pb=yb.a.VRe,Fa=yb.a.cvh,ab=yb.a.ORe;class Gb extends db.a{constructor(bb,Lb){super(bb,u.a.instance.ga(1033),void 0,void 0,void 0,E.EwaSettings.sa(350));this.Svb=this.brf=this.ZZe=this.WZe=this.hja=this.VZe=this.Uvb=this.ZJa=this.ija=this.$Ja=null;this.zld=!1;this.Nyb=this.NEb=this.X2b=null;this.onFunctionInfoLoaded=
()=>{if(!this.ZJa.count){const mc=this.functionInfoManager.Qvb;for(let Uc=0,pd=mc.length;Uc<pd;++Uc)this.ZJa.aY(mc[Uc],mc[Uc],!1).className=yb.a.avh;this.ZJa.selectedIndex=0;ka.a.pc([this.X2b,this.NEb,this.Nyb]);this.X2b=this.ze.ie(this.$Ja);this.NEb=this.ze.ie(this.ija);this.Nyb=this.ze.ie(this.Svb);this.X2b.ka("change",this.hDf);this.NEb.ka("change",this.mSi);this.NEb.ka("dblclick",this.nSi);this.Nyb.ka("click",this.Aca);this.Nyb.ka("keyup",this.tUi);va.DOMElementExtensions.setVisible(this.ija,
!0);va.DOMElementExtensions.setVisible(this.VZe,!1);this.$.t7c&&va.DOMElementExtensions.setVisible(this.brf,!0)}this.hDf(null);this.getButton(0).get_element().disabled=!1;this.$Ja.disabled=!1;this.URa();this.zld=!0};this.Aca=()=>{this.P$&&M(this.$,this.P$.HelpId,this.P$.IsDynamicUdf)};this.tUi=mc=>{13!==mc.keyCode&&32!==mc.keyCode||this.Aca(mc)};this.hDf=()=>{const mc=this.functionInfoManager.BKa(this.ZJa.ee.value);this.M3a(mc);this.ija.scrollTop=0;this.g4f()};this.mSi=()=>{this.g4f()};this.nSi=mc=>
{this.P$&&(na.g(mc),this.close(0))};this.Rc=(mc,Uc)=>{mb.b(Uc)&&this.dv()};this.functionInfoManager=bb.da.Aa(19);this.formulaAssistanceControl=bb.da.Aa(221);if(this.Jvb=ba.a.aV(this.$))this.formulaAssistanceManager=bb.da.Aa(464);this.lU=Lb}get kc(){return"FunctionDeprecatedDialog"}get P$(){if(!this.ija||!this.ija.firstChild)return null;const bb=Number.parseInvariant(this.ija.children[this.ija.selectedIndex].value);return this.functionInfoManager.Hgd(bb)}initialize(){this.Fb.classList.add(yb.a.Zuh);
if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var bb=document.createElement("div");bb.classList.add(yb.a.KRe);var Lb=document.createElement("label");Lb.setAttribute("for",Gb.$dd);Lb.innerText=u.a.instance.ga(1036)+" ";bb.appendChild(Lb);Lb=document.createElement("select");Lb.id=Gb.$dd;Lb.classList.add(Ba);Lb.setAttribute("disabled","true");bb.appendChild(Lb);this.Fb.appendChild(bb);bb=document.createElement("div");bb.classList.add(kb.a.Nl);bb.innerText=
u.a.instance.ga(1037);this.Fb.appendChild(bb);bb=document.createElement("div");bb.classList.add(yb.a.JRe);Lb=document.createElement("select");Lb.id=Gb.UZe;Lb.classList.add(Oa,Ca.a.qw?oa:null,r.a.eo,r.a.fo);Lb.size=7;bb.appendChild(Lb);Lb=document.createElement("div");Lb.classList.add(nc);Lb.innerText=u.a.instance.ga(735);bb.appendChild(Lb);this.Fb.appendChild(bb);bb=document.createElement("div");bb.classList.add(yb.a.MRe);Lb=document.createElement("div");Lb.classList.add(ab);Lb.style.direction="ltr";
var mc=document.createElement("span");mc.classList.add(Fa,r.a.eo);const Uc=document.createElement("span");Uc.classList.add(r.a.Or,yb.a.NRe);const pd=document.createElement("img");pd.title=u.a.instance.ob(3);pd.classList.add(r.a.KUe);pd.src=W.a.qe(13);Uc.appendChild(pd);mc.appendChild(Uc);Lb.appendChild(mc);mc=document.createElement("span");mc.id=Gb.ced;mc.classList.add(pb);Lb.appendChild(mc);mc=document.createElement("a");mc.tabIndex=0;mc.title=u.a.instance.ga(1038);mc.classList.add(Wb);Lb.appendChild(mc);
mc=document.createElement("span");mc.id=Gb.Pac;Lb.appendChild(mc);bb.appendChild(Lb);Lb=document.createElement("div");Lb.classList.add(Yb);Lb.id=Gb.bed;bb.appendChild(Lb);this.Fb.appendChild(bb)}else this.Fb.innerHTML=Gb.JG();this.If||(this.tt(),this.Mra());super.initialize();bb=va.DOMElementExtensions.$j(this.Fb,ab);this.rtl&&(bb.align="right",this.Svb.style.marginLeft="5px");this.If&&(bb.style.padding="1px");this.functionInfoManager.dJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&
(this.functionInfoManager.hcb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.ik(this.Rc));ka.a.pc([this.X2b,this.NEb,this.Nyb,this.ZJa,this.Uvb]);super.dispose()}tt(){this.$Ja=va.DOMElementExtensions.$j(this.Fb,Ba);this.ija=va.DOMElementExtensions.$j(this.Fb,Oa);this.$Ja.setAttribute(C.a.Cd,C.a.X0b);this.ZJa=new Q.a(this.$Ja,!0);this.Uvb=new Q.a(this.ija,!0);this.VZe=va.DOMElementExtensions.$j(this.Fb,nc);this.Svb=va.DOMElementExtensions.$j(this.Fb,Wb);this.ZZe=va.DOMElementExtensions.$j(this.Fb,
pb);this.brf=va.DOMElementExtensions.$j(this.Fb,Fa);this.WZe=$get(Gb.Pac,this.Fb);this.hja=va.DOMElementExtensions.$j(this.Fb,Yb);this.If&&(this.hja.style.paddingLeft="1px");this.functionInfoManager.YFa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Jj(this.Rc)}wQ(bb){this.$.da.gb(40,()=>{this.ZJa.wQ(bb)})}Yp(){this.Jvb?this.formulaAssistanceManager.N7b():this.formulaAssistanceControl.set_visible(!1);super.Yp();this.zld||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.$Ja.disabled&&
this.zld&&va.DOMElementExtensions.setFocus(this.$Ja)}commit(){return!0}Erb(){let bb=this.P$.NameDataStrings;const Lb=new y.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(Lb,{[x.a.Kc]:bb,["ibdk"]:!0})}Asa(){this.Jvb?this.formulaAssistanceManager.yda():this.formulaAssistanceControl.qpb()}M3a(bb){this.Uvb.clear();const Lb=Gb.Pac+" "+Gb.bed;for(let mc=0,Uc=bb.length;mc<Uc;++mc){const pd=this.Uvb.aY(bb[mc].NameUI,bb[mc].FunctionIndex.toString(),!1);Ca.a.qw&&pd.classList.add(Ja);pd.setAttribute(C.a.TL,Gb.ced);
pd.setAttribute(C.a.AG,Lb)}this.Uvb.selectedIndex=0}g4f(){if(this.P$){this.Svb.parentNode.className=yb.a.ORe+(this.functionInfoManager.Uhc(this.P$)?"-udf":"");var bb=this.P$.NameDataStrings;this.ZZe.innerText=bb;this.Svb.innerText=bb;this.hja.innerText=this.P$.Help;bb=this.P$.Params.split(n.lbd);this.WZe.innerText=n.openParen+(1<bb.length?n.L8b:bb[0])+n.closeParen}}static JG(){return String.format("<div class='"+yb.a.KRe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+
kb.a.Nl+"'>{1}</div>\r\n<div class='"+yb.a.JRe+"'>\r\n\t<select id='{16}' class='{17} "+r.a.eo+" "+r.a.fo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+yb.a.MRe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+r.a.eo+"'>\r\n\t\t\t<span class='"+r.a.Or+" "+yb.a.NRe+"'>\r\n\t\t\t\t<img title='{3}' class='"+r.a.KUe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
u.a.instance.ga(1036),u.a.instance.ga(1037),u.a.instance.ga(735),u.a.instance.ob(3),W.a.qe(13),u.a.instance.ga(1038),Gb.$dd,Gb.Pac,7,Ba,Wb,nc,Yb,pb,Fa,ab,Gb.UZe,Oa+(Ca.a.qw?" "+oa:""),Gb.bed,Gb.ced)}}Gb.Pac="function_dialog_param_string";Gb.bed="function_dialog_function_description";Gb.ced="function_dialog_function_name";Gb.UZe="function_list";Gb.$dd="function_category";Object(d.a)(Gb,"FunctionDeprecatedDialog",db.a,[]);var Ga=a(7),Ma=a(267);class Qa{constructor(bb,Lb,mc){this.$=bb;this.Va=Lb;this.functionInfoManager=
mc;this.QKh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.QKh.includes(this.menuId)&&this.frame.Vw(this.menuId)};this.aV=ba.a.aV(this.$);this.gBb=ba.a.qkf();this.aV&&(this.formulaAssistanceManager=this.$.da.Aa(464));this.lY={};this.frame=this.$.frame;this.functionInfoManager.YFa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=
bb.da.Aa(491)}Hc(bb,Lb){switch(Lb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return bb=H.h(this.$).li,bb.U5a||!bb.fb||0>=bb.text.length?!1:!0;default:return!1}}executeCommand(bb,Lb,mc){var Uc,pd;Lb=Lb.command;bb=H.h(this.$);const ta=bb.li;switch(Lb){case 753860909:case -2060563418:null===(Uc=this.formulaAssistanceManager)||
void 0===Uc?void 0:Uc.N7b();bb.inRangePicker&&ta.nE(!1);this.gBb?ea.show(this.$):(new Gb(this.$,ta)).kg();this.formulaAssistanceTelemetryManager.E3a.dialogShownCounter++;break;case 1117706454:null===(pd=this.formulaAssistanceManager)||void 0===pd?void 0:pd.N7b();bb.inRangePicker&&ta.nE(!1);void 0===mc.argumentsDialogSource&&(mc.argumentsDialogSource=1,mc[Qa.Qac]=this.functionInfoManager.j3e(mc[x.a.Kc]));const rb=mc[Qa.Qac];if(rb.Params.includes("!")){ia.show(rb.FunctionIndex,this.$);break}const gc=
ca.a.DUf(rb.Params).split(this.$.listSeparator).filter(Cd=>"..."!==Cd);l.TaskExtensions.V2(m.GetServiceTaskFactory.Oa(this.$.da,520,521,0),Cd=>{Sa.show(this.$,rb,Cd.result,gc,mc.argumentsDialogSource)},this.$.la,3);mc.ibdk?this.formulaAssistanceTelemetryManager.E3a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.E3a.argsDialogOpenedByRibbonCounter++;break;case -433697611:Uc=mc.functionArgs;mc.ibdk&&(void 0!==Uc?this.formulaAssistanceTelemetryManager.E3a.argsDialogCommitedCounter++:
this.formulaAssistanceTelemetryManager.E3a.dialogCommitedCounter++);let Pc=mc[x.a.Kc]+n.openParen;this.gBb&&(void 0!==Uc&&(Pc+=Uc.join(this.$.listSeparator)),Pc+=n.closeParen);mc.UILocation&&this.$.Zc(-1075437823,-1,0,null);bb.view.visibleArea.contains(bb.xg(null))||bb.ov(bb.ha.qa.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const hd=ta.textBox;Uc=ta.textBox.caretPosition;ta.fb?(pd=ta.text,Lb=Uc?pd.substring(0,Uc):"=",ta.text=Lb+Pc+pd.substring(Uc+(hd.oy?hd.oy.length:0),pd.length),
hd.caretPosition=Lb.length+Pc.length):this.gBb?bb.setCell(Object(Ga.a)(new Ma.a,{Text:`=${Pc}`}),bb.ha.qa.activeCell,0,127,null):l.TaskExtensions.za(bb.startEdit(!0,1),()=>{ta.text="="+Pc;const Cd=Pc.length+1;hd.wdb(Cd);hd.caretPosition=Cd},this.$.la,11,Ea.a.current);bb.Ql&&(bb=bb.Vb,bb.text=hd.text,bb.setCaretPosition(hd.caretPosition));this.aV?this.formulaAssistanceManager.yda():(bb=ta.o2.get(A.a.Tvb),null===bb||void 0===bb?void 0:bb.tY(!1));break;case -1334919469:M(this.$,"154468",!1)}return sa.Task.Ra(!0)}wc(bb,
Lb){switch(Lb.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.gBb;default:return!1}}MLh(bb,Lb){Lb=this.Va.sq(Lb);const mc=this.Va.Ec();var Uc=this.functionInfoManager.BKa(bb);if(!Uc)return v.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Lb.lE();const pd=this.gBb?1117706454:-433697611;for(let ta=0;ta<Uc.length;++ta){const rb=Uc[ta].NameUI,gc=this.Va.AP(280,"Formulas."+bb+"MenuItem_"+
Uc[ta].FunctionIndex.toString(),pd,null,1,"None",0,0,rb,!1,0);gc.label=rb;const Pc=Uc[ta].Params.split(n.lbd);gc.JR(rb+" "+(n.openParen+(1<Pc.length?n.L8b:Pc[0])+n.closeParen)+"\n"+Uc[ta].Help);mc.buttons.push(gc)}bb=this.Va.Ec();Uc=this.Va.AP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,r.a.aVe,3,"Image16by16",1035,0,"Formulas.MoreFunctionsMenuItem",!1,0);bb.buttons.push(Uc);Lb.rc.push(mc);Lb.rc.push(bb);return Lb.lE()}Mc(bb,Lb,mc){bb=this.MVh(Lb);if(-1===bb)return!1;this.menuId=mc.MenuId;if(!this.functionInfoManager.cV)return this.functionInfoManager.dJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;bb=this.functionInfoManager.Qvb[bb];this.lY[bb]=this.lY[bb]||this.MLh(bb,mc.MenuId);mc.MenuItems=this.lY[bb];return!0}MVh(bb){switch(bb){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;
case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Qa.Qac="functionInfo";Object(d.a)(Qa,"FormulaAssistanceCommandHandler",null,[221]);class wb extends h.a{constructor(bb){super(bb)}hd(){const bb=m.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),Lb=m.GetServiceTaskFactory.create(this.$.da,153,this.la,this.Xa);l.TaskExtensions.za(l.TaskExtensions.Fd([bb,Lb],this.la),()=>{this.$c([new Qa(this.$,bb.result,Lb.result)])},this.la,3)}static ka(bb){h.a.Ld(92,
new wb(bb))}}Object(d.a)(wb,"FormulaAssistanceCommandHandlerFactory",h.a,[]);var Na=a(226);class ya{constructor(bb,Lb){this.aKa=this.Iua=this.cja=null;this.RGf=(mc,Uc)=>{this.Mcj(Uc.functionName,Uc.ged)};this.TGf=(mc,Uc)=>{this.Lcj(Uc.ged,Uc.aQd,Uc.g3i)};this.SGf=(mc,Uc)=>{mc=[];for(var pd of Uc.aQd)(!this.vwa||void 0!==pd&&null!==pd)&&(Uc=pd.trim())&&mc.push(Uc);if(!this.vwa||mc.length){pd="";for(Uc=0;Uc<mc.length;Uc++){const ta=this.Z_c(mc[Uc]),rb=ya.IGd(Uc,mc.length);pd+=ta+rb;rb&&(pd+=this.ariaLiveNotifier.Jxa)}this.ariaLiveNotifier.readText(pd)}};
this.UGf=(mc,Uc)=>{this.ariaLiveNotifier.Ocj(Uc.EF,Uc.description,Uc.selectedIndex.toString(),Uc.length.toString())};this.NGf=(mc,Uc)=>{this.ariaLiveNotifier.RRf(Uc.description,Uc.length)};this.bDf=()=>{this.ariaLiveNotifier.Abb(u.a.instance.ga(882),C.a.BGa)};this.UCf=()=>{this.ariaLiveNotifier.readText(u.a.instance.ga(883))};this.XCf=()=>{this.ariaLiveNotifier.readText(u.a.instance.ga(884))};this.$=Lb;this.ariaLiveNotifier=bb;this.$.da.Ha(219,this);this.vwa=ba.a.u4(Lb)}dispose(){this.A_d();this.aKa=
this.Iua=this.cja=null}zZc(bb){bb&&(this.cja=bb,this.cja.Hqe(this.RGf),this.cja.zre(this.TGf),this.vwa&&this.cja.yre(this.SGf))}AZc(bb){bb&&(this.Iua=bb,this.vwa&&(this.Iua.Fqe(this.bDf),this.Iua.Dqe(this.UCf)),this.Iua.Eqe(this.XCf))}BZc(bb){bb&&(this.aKa=bb,this.aKa.BXc(this.UGf),this.aKa.E_b(this.NGf))}A_d(){var bb,Lb,mc;this.cja&&(this.cja.jWf(this.RGf),this.cja.HWf(this.TGf),this.vwa&&this.cja.GWf(this.SGf));this.aKa&&(this.aKa.nMd(this.UGf),this.aKa.Guc(this.NGf));this.vwa&&(null===(bb=this.Iua)||
void 0===bb?void 0:bb.iWf(this.bDf),null===(Lb=this.Iua)||void 0===Lb?void 0:Lb.gWf(this.UCf));null===(mc=this.Iua)||void 0===mc?void 0:mc.hWf(this.XCf)}Mcj(bb,Lb){if(Lb){let mc="";this.vwa||(mc+=u.a.instance.ob(57)+this.ariaLiveNotifier.Jxa);for(let Uc=0;Uc<Lb.length;Uc++)mc+=bb+this.ariaLiveNotifier.Jxa+this.Z_c(Lb[Uc])+ya.IGd(Uc,Lb.length);this.vwa&&(mc+=u.a.instance.ga(881)+this.ariaLiveNotifier.Jxa);this.ariaLiveNotifier.readText(mc)}}Lcj(bb,Lb,mc){if(bb){let pd="",ta=0;if(Lb){for(let rb=0;rb<
Lb.length;rb++){if(mc>=bb[rb].split(this.$.listSeparator).length){ta++;continue}var Uc=Lb[rb].trim();if(!Uc)return;Uc=this.Z_c(Uc);const gc=ya.IGd(rb-ta,Lb.length-ta);pd+=Uc+gc;gc&&(pd+=this.ariaLiveNotifier.Jxa)}this.ariaLiveNotifier.readText(pd)}}}Z_c(bb){if(!bb)return"";var Lb=bb.split(this.$.listSeparator);bb="";for(const mc of Lb){if(ya.iqd(mc))bb+=mc;else{const Uc=(Lb=ya.yri(mc))?mc.replace("[","").replace("]",""):mc;bb+=String.format(Lb?u.a.instance.ob(59):u.a.instance.ob(58),Uc)}bb+=this.ariaLiveNotifier.Jxa}return bb}static IGd(bb,
Lb){return bb>=Lb||1===Lb?(v.ULS.shipAssertTag(537161997,0,bb<Lb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(u.a.instance.ob(55),bb+1,Lb)+"\r\n"}static iqd(bb){return ca.a.contains(bb,n.L8b,!0)}static yri(bb){return bb.trimStart().startsWith(n.SKf)||bb.trimEnd().endsWith(n.RKf)}}Object(d.a)(ya,"FormulaAssistanceReadoutHandler",null,[258,2]);class nb extends Na.a{constructor(bb){super();this.$=bb;this.Db()}create(){const bb=this.$.da;l.TaskExtensions.za(m.GetServiceTaskFactory.Oa(bb,
211,212,this.Xa),Lb=>{Lb=bb.Aa(219)||new ya(Lb.result,this.$);this.nb(Lb)},this.la,3)}static ka(bb){bb.da.Ha(220,new nb(bb))}}Object(d.a)(nb,"FormulaAssistanceReadoutHandlerFactory",Na.a,[]);var vb=a(649),gb=a(111),cb=a(1E3),La=a(59),ja=a(41),Ua=a(113);class lb{constructor(){this.YQa={}}$id(bb){return this.YQa&&bb in this.YQa?this.YQa[bb]:null}Zbg(bb,Lb){this.YQa||(this.YQa={});this.YQa[bb]=Lb}EZ(){this.YQa=null}}Object(d.a)(lb,"FormulaAssistanceContextualPreviewCache",null,[]);var sb=a(60);const V=
(bb,Lb,mc,Uc,pd,ta,rb=null)=>{rb=bb.Na(1,rb);rb.getPartialCalcResultsParameters=Lb;return sb.g(bb,"GetPartialCalcResults",rb,mc,Uc,pd,ta,4)};var za=a(562);class Ra{constructor(bb){this.RGi=30;this.calcManager=null;this.Ed=!1;this.oPa=this.FHb=this.xab=null;this.Cw=()=>{this.nha.EZ()};this.$=bb;this.nha=new lb;this.NYf=-1;this.$.ea.lA(this.Cw)}dispose(){this.Ed||(this.$&&(this.$.ea.rB(this.Cw),this.$=null),this.nha=this.FHb=null,this.Ed=!0)}Bfd(bb,Lb,mc,Uc){if(Lb&&0>=Lb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!bb)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=Object(za.a)({Q5:266,new:G.b,registry:this.$.da,G3:E.EwaSettings.dX});if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let pd="="+Lb.substring(mc.start,mc.end);E.EwaSettings.sa(512)&&(pd=this.calcManager.a4h(H.h(this.$).ha.qa.activeCell,bb,mc));const ta=this.URh(pd,mc);if(E.EwaSettings.sa(512)){if(ta&&!this.calcManager.isFormulaSubExpressionVolatile(bb))return Promise.resolve(ta)}else if(ta)return Promise.resolve(ta);
return this.WRh(pd,mc).then(rb=>{if(this.X1c(Uc))throw Error.create("OperationCanceledException");if(!rb||rb.Apj||rb.cna.startsWith("##UNSUPPORTED:"))return this.D1e(Lb,pd,mc,Uc);this.nha.Zbg(pd,rb.cna);return Promise.resolve(rb)})}URh(bb,Lb){return(bb=this.nha.$id(bb))?new cb.a(bb,Lb.start,Lb.end,0):null}WRh(bb,Lb){if(!bb||0>=bb.length||!Lb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.R_g(H.h(this.$).ha.qa.activeCell,
bb,this.RGi,Lb)}D1e(bb,Lb,mc,Uc){if(!bb||0>=bb.length||!Lb||0>=Lb.length||!mc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.oPa)return this.VRh(bb,Lb,mc,Uc);const pd={};pd.PartialFormula=Lb;pd.Formula=bb;pd.SourceRange=ja.v(H.h(this.$).ha.qa.activeCell,this.$);return this.oPa=new Promise((ta,rb)=>{this.FHb=new vb.a;this.NYf=this.$.ea.se;this.xab=V(this.$.oa.xa,pd,gc=>{this.U0i(Lb,mc,Uc,gc,ta,rb)},gc=>{this.xab=
this.oPa=null;rb(gc)},null,null,null);this.FHb.token.register(()=>{this.z1g(rb)})})}U0i(bb,Lb,mc,Uc,pd,ta){this.xab=this.oPa=null;if(this.NYf!==this.$.ea.se)ta(Error.create("OperationCanceledException"));else if(Uc.Result)if(Uc=La.a.Wh(Uc.Result),!Uc||gb.a.isEmpty(Uc))pd(null);else{for(let rb in Uc)this.nha.Zbg(rb,Uc[rb]);this.X1c(mc)?ta(Error.create("OperationCanceledException")):(bb=this.nha.$id(bb))?(""===bb&&(bb=" "),pd(new cb.a(bb,Lb.start,Lb.end,0))):ta(Error.create("SubexpressionNotFoundException"))}else pd(null)}VRh(bb,
Lb,mc,Uc){return new Promise((pd,ta)=>{this.oPa.then(()=>{this.yZf(bb,Lb,mc,Uc,pd,ta)}).catch(()=>{this.yZf(bb,Lb,mc,Uc,pd,ta)})})}yZf(bb,Lb,mc,Uc,pd,ta){if(this.X1c(Uc))ta(Error.create("OperationCanceledException"));else{const rb=this.nha.$id(Lb);rb?pd(new cb.a(rb,mc.start,mc.end,0)):this.D1e(bb,Lb,mc,Uc).then(gc=>{pd(gc)}).catch(gc=>{ta(gc)})}}z1g(bb){this.xab&&(Ua.a.Nt(this.xab.Rs)?(this.oPa=this.xab=null,bb(Error.create("PendingWebReqeuestCancelled"))):v.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}EZ(){this.A1g();
this.nha&&this.nha.EZ()}A1g(){this.FHb&&this.FHb.cancel()}X1c(bb){return this.Ed||bb.YJ}}Object(d.a)(Ra,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var Xa=a(160),$a=a(217);class ma{}ma.Lvh="ewa-facp-text-box";Object(d.a)(ma,"CssClassNames",null,[]);class fa{constructor(bb){this.zqa=this.iTa=this.G2a=this.zP=this.B$=this.eb=null;this.jld=!1;this.Oc=bb}dispose(){(this.B$||this.zP)&&this.Xbf();this.eb=this.zqa=null}OZj(bb,Lb,mc,Uc){bb&&Lb&&Uc&&Lb.cna&&!(1>Lb.cna.length)&&(this.eb=bb,this.jVf(),
this.G2a=Lb,this.iTa=Uc,this.NHj(Lb,mc,Uc))}Xbf(){this.dci();this.jVf();this.iTa=this.G2a=null}NHj(bb,Lb,mc){if(bb.cna&&!(1>bb.cna.length)){var Uc=Object(za.a)({Q5:266,new:G.b,registry:this.Oc.da,G3:E.EwaSettings.dX});if(Uc){var pd=Uc.aYh();pd&&l.TaskExtensions.za(this.uDb,()=>{if(Lb)if(E.EwaSettings.sa(512)&&this.eb.fb&&0<mc.length){this.Xyb(bb.XJa,mc[0].start,null);var ta=this.U7e(mc[0],pd),rb=this.eb.text.substring(mc[0].start,mc[0].end).trim();rb=this.eb.text.indexOf(rb);rb=this.eb.text.substring(0,
rb).lastIndexOf("\n");this.Xyb(0>rb||1>=mc.length?mc[0].start:rb+1,mc[0].end,ta?String.format(ta,.3):null);for(var gc=1;gc<mc.length;gc++)ta=this.U7e(mc[gc],pd),rb=this.eb.text.substring(mc[gc].start,mc[gc].end).trim(),rb=this.eb.text.indexOf(rb),rb=this.eb.text.substring(mc[gc-1].end,rb).lastIndexOf("\n"),this.Xyb(0>rb?mc[gc-1].end:rb+1+mc[gc-1].end,mc[gc].end,ta?String.format(ta,.3):null);rb=this.eb.text.substring(mc[mc.length-1].end,bb.Kua).indexOf("\n");this.Xyb(0>rb?mc[mc.length-1].end:rb+1+
mc[mc.length-1].end,bb.Kua,null);v.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Xyb(bb.XJa,bb.Kua,null),v.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.B$||(this.B$=document.createElement($a.a.div),this.eb.textBox.domElement.appendChild(this.B$));
this.zP||(this.zP=document.createElement($a.a.div),this.zP.className=ma.Lvh,this.Oc.domElement.appendChild(this.zP));ta=bb.Kua;E.EwaSettings.sa(512)&&this.eb.fb&&mc&&0<mc.length&&mc[0].start<ta&&mc[0].start!==bb.XJa&&!this.eb.textBox.oy.length&&(ta=mc[0].start);gc=ca.a.contains(this.eb.textBox.Ie.id,"FormulaBar",!0)&&ca.a.contains(this.eb.text.substring(bb.XJa,bb.Kua),"\n",!0);rb=this.eb.fb?this.eb.textBox.caretPosition:0;ta=excelOnline.utils.getBoundingRectForText(this.eb.textBox.Ie,gc?rb:bb.XJa,
gc?rb:ta,E.EwaSettings.sa(512));this.zP.style.left=B.HelperMethods.sc(ta.left);this.zP.style.top=B.HelperMethods.sc(ta.top);this.zP.style.width=B.HelperMethods.sc(ta.width);this.zP.style.height=B.HelperMethods.sc(ta.height);dialogControls.renderToolTip(this.B$,`FormulaAssistancePreviewToolTip_${bb.Kua}_${bb.Kua}`,bb.cna,this.zP,0,!1,!1,1)},this.Oc.la,3)}}}U7e(bb,Lb){const mc=this.eb.text;var Uc=mc.substring(bb.start,bb.end);Uc=Uc.trim();bb=mc.indexOf(Uc,bb.start);Lb=mc.indexOf(Lb,bb);Uc=mc.substring(bb,
Lb);Uc=Uc.trim();return this.eb.colors.getItem(bb+"-"+(bb+Uc.length))}dci(){this.eb&&this.B$&&this.zP&&l.TaskExtensions.za(this.uDb,()=>{this.eb.textBox.domElement.contains(this.B$)&&(dialogControls.clearToolTip(this.B$),this.eb.textBox.domElement.removeChild(this.B$),this.B$=null);this.Oc.domElement.contains(this.zP)&&(this.Oc.domElement.removeChild(this.zP),this.zP=null)},this.Oc.la,3)}Xyb(bb,Lb,mc){!this.eb||bb>=Lb||(this.eb.textBox.formatText(bb,Lb-bb,{["background"]:mc||"#E3DDCC"}),this.jld=
!0)}jVf(){if(this.eb&&this.G2a&&this.jld){var bb=this.G2a.Kua;E.EwaSettings.sa(512)&&0<this.iTa.length&&this.iTa[this.iTa.length-1].end>bb&&(bb=this.iTa[this.iTa.length-1].end);this.eb.textBox.formatText(this.G2a.XJa,bb-this.G2a.XJa,{["background"]:!1});this.jld=!1}}get uDb(){if(this.zqa)return this.zqa;const bb=new Xa.a;this.Oc.Sx(Lb=>{l.TaskExtensions.za(Lb.$vd(),()=>{bb.setResult(!0)},this.Oc.la,3)});return this.zqa=bb.task}}Object(d.a)(fa,"FormulaAssistanceContextualPreviewControl",null,[2]);
var eb=a(84),ua=a(48),xa=a(44);class tb{constructor(bb){this.w7=0;this.Gdd=bb}s9f(bb,Lb,mc){mc?this.tch(bb,Lb,mc):this.$9e(bb,Lb,mc,!0)}doj(){this.w7=0}tch(bb,Lb,mc){this.w7++;const Uc=this.w7;ua.a.instance.create(()=>{this.$9e(bb,Lb,mc,Uc===this.w7)},500,xa.a.NJh,!0,!0)}$9e(bb,Lb,mc,Uc){const pd=this.Gdd.Bfd(bb,Lb);pd&&pd.then(ta=>{Uc&&this.Gdd.Sqd(Lb)&&this.Gdd.NZj(bb,ta,mc)}).catch(ta=>{ta=Object(eb.a)(Error,ta);"OperationCanceledException"===ta.message?v.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${ta}`):
v.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${ta}`)})}}Object(d.a)(tb,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var Qb=a(177);class pc{constructor(bb){this.Isb=this.lha=this.calcManager=this.eb=null;this.o$a=()=>{this.x5a(!1,!1)};this.$=bb;this.Ivb=new fa(bb);this.Eac=new Ra(bb);this.Fac=new tb(this);H.h(bb).Vb.Jm(this.o$a);this.$.da.Ha(317,this)}dispose(){this.Y0c();ka.a.pc([this.Ivb,this.Eac]);this.Fac=this.Eac=this.Ivb=null;this.$&&
H.h(this.$).Vb.$l(this.o$a);this.lha=this.eb=this.$=null}OHj(bb,Lb){Lb&&Qb.f(Lb.text)&&!(Lb.Iwa||Lb.textBox.oy||this.eb&&this.eb.textBox.oy)&&(this.eb=Lb,this.calcManager=Object(za.a)({Q5:266,new:G.b,registry:this.$.da,G3:E.EwaSettings.dX}))&&(v.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),bb=B.HelperMethods.vwb(bb),bb=this.calcManager.Y3h(H.h(this.$).ha.qa.activeCell,this.eb.text,bb.x,
bb.y),Lb=this.calcManager.getSubExpressionSpan(bb),!Lb||Lb.end<=Lb.start||this.Sqd(Lb)||(this.lha=Lb,this.Fac.s9f(bb,Lb,!0)))}EUd(bb){if(bb&&Qb.f(bb.text))if(bb.textBox.oy&&bb.textBox.oy.trim()){if(this.eb=bb,this.calcManager=Object(za.a)({Q5:266,new:G.b,registry:this.$.da,G3:E.EwaSettings.dX})){v.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");bb={};var Lb=this.eb.textBox.oy.trim();
bb.start=this.eb.text.indexOf(Lb,this.eb.textBox.caretPosition);bb.end=bb.start+Lb.length;(Lb=this.calcManager.getFormulaSubExpressionObject(H.h(this.$).ha.qa.activeCell,this.eb.text,this.eb.textBox.oy))&&!this.Sqd(bb)&&(this.lha=bb,this.Fac.s9f(Lb,bb,!1))}}else this.x5a(!1,!0)}x5a(bb,Lb){!this.eb||Lb&&this.eb.textBox.oy||(this.lha=null,bb&&(this.Y0c(),this.Eac.EZ(),this.Fac.doj()),this.Ivb&&this.Ivb.Xbf(),this.eb.Iwa||(this.eb.Iwa=!1,this.eb=null))}Bfd(bb,Lb){if(!this.eb||this.eb.Iwa)return null;
this.Y0c();this.Isb=new vb.a;return this.Eac.Bfd(bb,this.eb.text,Lb,this.Isb.token)}NZj(bb,Lb,mc){this.Isb=null;!bb||!Lb||!Lb.cna||0>=Lb.cna.length?this.x5a(!1,!1):(bb=this.calcManager.Z3h(H.h(this.$).ha.qa.activeCell,bb,this.eb.text),this.Ivb.OZj(this.eb,Lb,mc,bb))}Sqd(bb){return this.lha?bb.start===this.lha.start&&bb.end===this.lha.end&&bb.pre===this.lha.pre&&bb.post===this.lha.post:!1}Y0c(){this.Isb&&this.Isb.cancel()}}Object(d.a)(pc,"FormulaAssistanceContextualPreviewManager",null,[315,2,316]);
var hb=a(227),ib=a(14),Vb=a(191),wc=a(1111),Lc=a(64),Fc=a(786),fd=a(31),Ta=a(24),Fb=a(65),ic=a(284),zb=a(251),Bb=a(166);class ec{constructor(bb=!1){this.GS=0;this.Rae=!1;this.dWa=this.sce=null;this.izg=bb;this.textEdit=null}S4f(bb){this.GS=0;this.Rae=bb.IsCompatibility;this.set_name(bb.NameDataStrings);this.dWa=bb.Help}fyj(bb){this.GS=1;this.set_name(bb.Name)}Ixj(bb){this.GS=2;this.set_name(bb.name);this.dWa=bb.tooltip}lzj(bb){this.GS=3;this.set_name(bb.name);this.dWa=bb.toolTip}o6f(bb){this.GS=4;
this.set_name(bb.name)}DBj(bb){this.GS=5;this.set_name(bb.name);this.dWa=bb.toolTip}CBj(bb){this.GS=7;this.set_name(bb.name)}cAj(){this.GS=6;this.set_name(u.a.instance.ob(192));this.dWa=u.a.instance.ob(193)}get itemType(){return this.GS}get Wmi(){return this.Rae}get name(){return this.label}set_name(bb){return this.sce=bb}get label(){return this.sce}get hja(){return this.dWa}get QBb(){return this.izg}static Pgh(){return Object(Ga.a)(new ec(!0),{})}}Object(d.a)(ec,"AutoCompleteItem",null,[359]);class Qd{constructor(){this.sheetName=
this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(Qd,"DefinedNameInfo",null,[]);var fc=a(168);class cd{constructor(bb){this.WKe={};this.$=bb}get VKe(){const bb=[];if(!this.$.yb||!this.$.yb.items)return bb;let Lb=0;const mc=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&ba.a.aV(this.$);for(const Uc of this.$.yb.items)if(Uc&&(3===Uc.type&&Uc.usedRange||mc&&2===Uc.type)){const pd=new Qd;pd.tooltip=Uc.sheetName+Lc.a.exclamation+Uc.usedRange.toString();
pd.name=Uc.name;pd.namedRange=this.z$g(Uc.usedRange);pd.sheetName=Uc.sheetName;pd.type=this.r$g(Uc.type);bb.push(pd);this.WKe[Uc.name.toUpperCase()]=pd;++Lb;if(!E.EwaSettings.isChangeGateEnabled("OfficeVSO:7395300_FixTableAutoCompleteMissingInfo")&&Lb===n.ovf){v.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${n.ovf}`);break}}return bb}cWj(bb){var Lb=this.WKe[bb.toUpperCase()];if(!Lb)return{returnValue:!1,sheetName:"",range:null};bb=Lb.sheetName;Lb=
this.j$g(Lb.namedRange);return{returnValue:!0,sheetName:bb,range:Lb}}z$g(bb){if(null!=bb&&void 0!=bb)return{top:bb.top,left:bb.left,bottom:bb.bottom,right:bb.right,maxRows:bb.maxRows,maxColumns:bb.maxColumns,sheetName:void 0}}j$g(bb){if(null!=bb&&void 0!=bb)return new fc.a(bb.top,bb.left,bb.bottom,bb.right,bb.maxRows,bb.maxColumns)}r$g(bb){switch(bb){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(cd,"DefinedNameInfoManager",null,[]);var jd=a(134),nd=a(268),vd=a(265),wd=a(239);class Td extends Sys.EventArgs{constructor(bb,
Lb){super();this.functionName=bb;this.ged=Lb}}Object(d.a)(Td,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class jc extends Sys.EventArgs{constructor(bb){super();this.aQd=bb}}Object(d.a)(jc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class bd extends Sys.EventArgs{constructor(bb,Lb,mc){super();this.ged=bb;this.aQd=Lb;this.g3i=mc}}Object(d.a)(bd,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Hd=a(264);class ge{constructor(bb,Lb,
mc,Uc,pd=null){this.Ogc=this.M0c=!1;this.$=bb;this.formulaAssistanceUIControl=Lb;this.BZe=mc;this.Qtj=Uc;this.t$e=pd;this.Ogc=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Ff(){return this.M0c}set Ff(bb){this.M0c!==bb&&(bb?Hd.a(this.$).Xh(this):Hd.a(this.$).Cz(this),this.M0c=bb)}get Yd(){return this.Qtj}get jc(){return this.formulaAssistanceUIControl.getRootElement(this.BZe)}ag(bb,Lb){bb=!1;Lb||(H.h(this.$).li.textBox.XE=!0,bb=this.formulaAssistanceUIControl.focus(this.BZe));
return bb}sh(bb){const Lb=this.jc;return!(void 0===Lb||null===Lb)&&va.DOMElementExtensions.Af(Lb,bb)}rj(){this.t$e&&this.t$e();const bb=H.h(this.$).li.textBox;this.selection=bb.selection;bb.removeSelection()}dk(){H.h(this.$).li.textBox.selection=this.selection}dispose(){Hd.a(this.$).Cz(this)}}Object(d.a)(ge,"FormulaAssistanceFocusManager",null,[28,2]);var Mb=a(38),Kc=a(374),Ob=a(192),Mc=a(35),Dc=a(250),$c=a(282),td=a(931);class Yd extends Mb.a{constructor(bb,Lb){super();this.Qwg=[];this.jed={};this.ked=
{};this.DS=null;this.u8=[];this.bKa={};this.zDf=(mc,Uc)=>{v.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.jDf(mc,!!Uc&&1!==Uc.FilterType,!0)};this.yDf=()=>{v.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.DS=null};this.gDf=mc=>{v.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.kKd(mc.jja,
!0,!1)};this.xDf=mc=>{v.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.jDf(mc,!0,!1)};this.fNc=this.hNc=!1;this.jb=bb;this.pluginScheduler=Lb;this.$.da.Ha(19,this)}YFa(bb){this.addHandler("FunctionInfoLoaded",bb)}hcb(bb){this.removeHandler("FunctionInfoLoaded",bb)}GMg(bb){this.addHandler("FunctionInfoReset",bb)}vjj(bb){this.removeHandler("FunctionInfoReset",bb)}get cV(){return this.hNc}get Soi(){return this.fNc}get Rac(){var bb=this.DS,Lb=td.a(this.$);if(!Lb)return bb;
Lb=Lb.cVh();const mc=Lb.length;if(0>=mc)return bb;const Uc=[];Uc.push(...bb);for(bb=0;bb<mc;bb++){const pd=Lb[bb],ta={};ta.FunctionIndex=Uc.length;ta.HelpId=ta.GroupUI=null;ta.Help=pd.description;ta.IsCommonlyUsed=ta.IsCompatibility=!1;ta.NameDataStrings=pd.name;ta.NameUI=pd.name;ta.Params=null;ta.ParamsHelp=null;Uc.push(ta)}return Uc}get Qvb(){return this.u8}get $(){return this.jb}dispose(){const bb=this.$.da.Aa(268);bb&&bb.TLd(this.gDf);this.jb=null;super.dispose()}fZf(){this.raiseEvent("FunctionInfoReset")}FNd(){this.fZf();
this.hNc=!1;this.DS=null;this.fNc=!0}dJa(bb,Lb=!1){if(this.cV)this.yQf();else{v.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let Uc=null;(Uc=this.$.da.Aa(268))||v.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===Uc||void 0===Uc?0:Uc.jja)&&0<Uc.jja.length)E.EwaSettings.sa(114)?Uc.qJh(this.xDf):this.kKd(Uc.jja,!0,!1);else{var mc=this.$.oa.xa.Wb();bb&&(this.$.ea.Xb||Lb)&&!this.Soi&&
(Lb?Kc.a(this.$.userOperationManager,(pd,ta,rb)=>sb.o(this.$.oa.xa,bb,$c.b(pd,this.zDf),$c.a(ta,this.yDf),rb,bb,mc),pd=>new Ob.a(130,0,pd,16),null):sb.o(this.$.oa.xa,bb,this.zDf,this.yDf,null,bb,mc));!this.cV&&this.$.ea.Xb&&(Uc?(v.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.cV}, IsSessionActive=${this.$.ea.Xb}`),Uc.Gqe(this.gDf)):(v.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
sb.o(this.$.oa.xa,{FilterType:0},this.xDf,null,null,null,mc),this.fNc=!1))}}}Hgd(bb){return 0>bb||bb>=this.DS.length?null:this.DS[bb]}Igd(bb){return Mc.a.Fc(this.jed,bb.toUpperCase())}j3e(bb){return Mc.a.Fc(this.ked,bb.toUpperCase())}BKa(bb){return Mc.a.Fc(this.bKa,bb)}Uhc(bb){return!bb.GroupUI}jDf(bb,Lb,mc){const Uc=Dc.a(bb);v.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${Uc}`);Uc?(H.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.Sn(bb.Errors)):(this.kKd(bb.Result,Lb,mc),ba.a.bV(this.$)&&!ba.a.aV(this.$)&&this.i1j())}kKd(bb,Lb,mc){v.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${bb.length}, isCategorized = ${Lb}, partialResult = ${mc} IsFullyLoaded = ${this.cV}`);this.cV||(this.DS=bb,this.EXg(Lb),this.hNc=!mc,this.yQf())}yQf(){this.raiseEvent("FunctionInfoLoaded")}i1j(){const bb=this.Rac;this.pluginScheduler.notifier().setFunctionsInfo(bb);v.ULS.sendTraceTag(512278604,
0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===bb||void 0===bb?void 0:bb.length} functions}`)}EXg(bb){var Lb=u.a.instance.ga(1030),mc=[];this.bKa={};this.u8=[];this.bKa[Lb]=mc;const Uc=u.a.instance.ga(1031),pd=[];this.u8.push(Lb);this.u8.push(Uc);for(let rb=0,gc=this.DS.length;rb<gc;rb++){Lb=this.DS[rb];Lb.IsCompatibility||pd.push(Lb);var ta=Lb.NameUI;const Pc=Lb.NameDataStrings;this.jed[Pc.toUpperCase()]||(this.jed[Pc.toUpperCase()]=Lb);
this.ked[ta.toUpperCase()]||(this.ked[ta.toUpperCase()]=Lb);if(!this.Uhc(Lb)){if(bb){ta=Lb.GroupUI;let hd=Mc.a.Fc(this.bKa,ta);hd||(hd=[],this.bKa[ta]=hd,this.u8.push(ta));hd.push(Lb)}Lb.IsCommonlyUsed&&mc.push(Lb);Lb.IsCompatibility||this.Qwg.push(Pc)}}this.bKa[Uc]=pd;bb&&(Yd.xUf(mc,[2,3,0,5,4,9,1,7,8,6]),mc=Array(14),mc[0]=0,mc[1]=1,mc[2]=7,mc[3]=11,mc[4]=5,mc[5]=2,mc[6]=6,mc[7]=10,mc[8]=9,mc[9]=3,mc[10]=4,mc[11]=13,mc[12]=12,mc[13]=8,Yd.xUf(this.u8,mc),mc=[],mc.push(...this.u8),mc.splice(13,1),
this.u8=mc);mc=(rb,gc)=>rb.NameUI.localeCompare(gc.NameUI);this.DS=[...this.DS];this.DS.sort((rb,gc)=>rb.NameDataStrings.localeCompare(gc.NameDataStrings));for(let rb=1,gc=this.u8.length;rb<gc&&bb;rb++)this.bKa[this.u8[rb]].sort(mc);for(let rb=0,gc=this.DS.length;rb<gc;rb++)this.DS[rb].FunctionIndex=rb}static xUf(bb,Lb){const mc=[...bb];for(let Uc=0;Uc<mc.length&&Uc<Lb.length;Uc++)bb[Uc]=mc[Lb[Uc]]}}Object(d.a)(Yd,"FunctionInfoManager",Mb.a,[260,261,2]);var ae=a(241),je=a(96),Ke=a(49),Fd=a(724);class fe extends je.a{constructor(bb,
Lb,mc,Uc=null){super(bb,Uc);this.m3=null;this.bOb=this.iXd=!1;this.offsetParent=this.n7=this.c2a=null;this.DLc=!1;this.LCd=pd=>this.W5(pd);this.KCd=pd=>this.oN(pd);this.ZBf=pd=>{const ta=B.HelperMethods.ko(pd);ta.button===Sys.UI.MouseButton.leftButton&&2===pd.ub&&(this.qqd(ta.target)||this.WSa(ta));return!1};this.t8d=Lb;mc&&(this.iXd=!0,ae.a.instance.ta(ib.a.pointerDown,this.MNe,this.ZBf));this.ffa=!1}get w8b(){return this.ffa}get MNe(){return this.t8d}get Yai(){return this.DLc}dispose(){this.iXd&&
(ae.a.instance.Ba(ib.a.yj,this.MNe,this.ZBf),this.iXd=!1);this.bOb&&(this.bOb=!1,ae.a.instance.Ba(ib.a.Kf,this.domElement.ownerDocument.body,this.LCd),ae.a.instance.Ba(ib.a.yj,this.domElement.ownerDocument.body,this.KCd));this.m3=this.t8d=null;super.dispose()}Aoe(bb){this.m3?this.m3.push(bb):this.m3=[bb]}qqd(bb){if(this.m3)for(let Lb=0,mc=this.m3.length;Lb<mc;++Lb)if(va.DOMElementExtensions.Af(this.m3[Lb],bb))return!0;return!1}WSa(bb){this.w8b||(this.ffa=!0,ca.a.equals(this.domElement.currentStyle.position,
"absolute",!0)||(this.domElement.style.position="absolute"),this.Nsh(),ae.a.instance.ta(ib.a.Kf,this.domElement.ownerDocument.body,this.LCd),ae.a.instance.ta(ib.a.yj,this.domElement.ownerDocument.body,this.KCd),this.bOb=!0,this.drag(!0,bb))}drag(bb,Lb){na.g(Lb);var mc=new Ke.a(0,0),Uc=new Sys.UI.Point(Lb.clientX,Lb.clientY);Lb=this.domElement.parentNode;Uc=Fd.a.Gu(mc,Lb,Uc,this.isRtl());bb?(mc=Fd.a.QE(mc,Lb,this.domElement,this.isRtl()),this.c2a=Fd.a.CD(Uc,mc),this.n7=Uc,this.DLc=!1):!this.Yai&&this.Uai(Uc,
this.n7)&&(this.DLc=!0);mc=Fd.a.CD(Uc,this.c2a);Fd.a.Cdb(Lb,this.domElement,mc,this.isRtl(),bb)}cw(bb){this.bOb&&(this.bOb=!1,ae.a.instance.Ba(ib.a.Kf,this.domElement.ownerDocument.body,this.LCd),ae.a.instance.Ba(ib.a.yj,this.domElement.ownerDocument.body,this.KCd));na.g(bb);this.ffa=!1;this.n7=this.c2a=null}W5(bb){const Lb=B.HelperMethods.ko(bb);Lb.button===Sys.UI.MouseButton.leftButton&&2===bb.ub&&this.cw(Lb);return!1}oN(bb){2===bb.ub&&this.drag(!1,B.HelperMethods.ko(bb));return!1}Uai(bb,Lb){return Lb.x<
bb.x-2||Lb.x>bb.x+2||Lb.y<bb.y-2||Lb.y>bb.y+2}Nsh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;va.DOMElementExtensions.getLocation(this.offsetParent)}}Object(d.a)(fe,"BaseDraggableBehavior",je.a,[]);class ne extends fe{constructor(bb,Lb,mc=null,Uc=!1){super(bb,Lb,!1,mc);this.cSa(Uc);this.Yi=ca.a.equals("rtl",bb.dir,!0)}setVisible(bb){va.DOMElementExtensions.setVisible(this.domElement,bb);bb||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.Yi}cSa(bb){const Lb=
this.domElement.style;Lb.cursor="move";Lb.position=bb?"relative":"absolute"}}Object(d.a)(ne,"FunctionParamBoxDraggableItem",fe,[]);class ce{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(d.a)(ce,"FormulaArgumentAssistanceCallbacks",null,[]);class te{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(d.a)(te,"FormulaArgumentAssistanceRenderingInfo",
null,[]);var we=a(86),Pe=a(110),qf=a(156);class Ve{constructor(bb){this.fv=bb;this.SA=this.oSa=this.Bi=!1;this.onKeyDown=Lb=>!this.SA&&Lb.keyCode===we.a.Hea&&Lb.altKey&&Lb.ctrlKey?(this.A2a(),Lb.stopPropagation(),Lb.preventDefault(),!0):!1;this.cla=Lb=>{if(!this.SA)return!1;if(Lb.eventName===ib.a.Sb){const mc=Lb.Ea.ctrlKey?1:Lb.Ea.shiftKey?50:10;switch(Lb.Ea.keyCode){case we.a.Poa:this.oK(0,-mc);break;case we.a.K7:this.oK(0,mc);break;case we.a.L7:this.oK(-mc,0);break;case we.a.bCa:this.oK(mc,0);break;
case we.a.XF:case we.a.Jh:this.oSa=!0;break;default:return!1}}Lb.eventName===ib.a.Kd&&this.oSa&&this.rM(!0);Lb.Ea.preventDefault();return!0};this.fza=Lb=>{if(!this.SA)return!1;Lb.Ea.preventDefault();this.rM();return!0};this.onBlur=()=>{if(!this.SA)return!1;this.rM();return!0};this.qo=Pe.KeyInputManager.instance;this.pointerInputManager=ae.a.instance}ka(bb){(this.root=bb)&&!this.Bi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Bi=!0)}detach(){this.root&&this.Bi&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.Bi=!1)}A2a(){this.root&&(this.target=this.fv.GGb("move",!0),this.GWd=this.target.getBoundingClientRect(),this.SA=!0,this.oSa=!1,this.Et(),this.gya||this.wsb(),this.target.appendChild(this.gya))}rM(bb=!1){this.fv.Voc(bb);this.SA=!1;this.tJb();this.jJb();this.GWd=this.target=void 0}Et(){this.qo.capture(this.cla,null);this.pointerInputManager.ms(ib.a.pointerDown,this.target,this.fza,!0);this.target.addEventListener("blur",this.onBlur)}jJb(){this.qo.releaseCapture();this.pointerInputManager.ys(ib.a.pointerDown,
this.target,this.fza,!0);this.target.removeEventListener("blur",this.onBlur)}tJb(){var bb;this.target&&(null===(bb=this.gya)||void 0===bb?void 0:bb.parentNode)===this.target&&this.target.removeChild(this.gya)}oK(bb,Lb){const mc=this.target.getBoundingClientRect();this.fv.onMove(bb+mc.left-this.GWd.left,Lb+mc.top-this.GWd.top)}wsb(){this.gya=qf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Ve,"FormulaAssistanceMoveAdapter",null,[]);var Qe=a(280);class Ze{constructor(bb){this.fv=
bb;this.Bi=!1}y4(){return this.Bi&&!!this.QC}Bya(bb){this.QC.style.cursor="grabbing";this.CNj=bb.clientPoint.x;this.DNj=bb.clientPoint.y;this.fv.GGb("drag");return!0}yca(bb){this.fv.onMove(bb.clientPoint.x-this.CNj,bb.clientPoint.y-this.DNj);return!0}xca(){this.cw()}wca(){this.cw()}ka(bb){if(this.QC=bb)this.QC.style.cursor="grab",Qe.a.instance.fW(this.QC,this),this.Bi=!0}detach(){this.Bi&&this.QC&&(this.QC.style.cursor="",Qe.a.instance.J0(this.QC,this),this.Bi=!1)}cw(){this.QC.style.cursor="grab";
this.fv.Voc()}}Object(d.a)(Ze,"FormulaAssistanceDragAdapter",null,[307]);class Re{get sFc(){return this.TJa.getWindowEdgeBuffer()+1}constructor(bb,Lb){this.TJa=bb;this.formulaAssistanceTelemetryManager=Lb;this.Bi=!1;this.zGa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.O0={[Za.Drag]:0,[Za.Move]:0};this.AEb=new Ve(this);this.Ptb=new Ze(this)}ka(bb,Lb,mc,Uc){this.root=bb;this.render=mc;this.dismiss=Uc;this.detach();Lb&&(this.Ptb.ka(Lb),this.AEb.ka(bb.firstChild),
this.Bi=!0)}detach(){this.Bi&&(this.Ptb.detach(),this.AEb.detach(),this.Bi=!1);va.DOMElementExtensions.vf(this.placeholder)}clear(){this.TJa.setOverrideTarget(void 0);this.detach();this.kKb()}GGb(bb,Lb=!1){this.O0[bb]+=1;this.EAc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);bb=this.placeholder.firstChild;bb.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Lb&&(this.TPa=document.activeElement,bb.tabIndex=0,bb.focus());this.dismiss();
return bb}onMove(bb,Lb){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(bb,this.sFc-this.EAc.left),window.innerWidth-this.EAc.right-this.sFc)}px, ${Math.min(Math.max(Lb,this.sFc-this.EAc.top),window.innerHeight-this.EAc.bottom-this.sFc)}px)`}Voc(bb=!0){const Lb=this.placeholder.firstChild.getBoundingClientRect(),mc=this.TJa.getDirectionalHint({top:Lb.top,left:Lb.left});this.TJa.setOverrideTarget({top:1===mc?Lb.bottom:Lb.top,left:Lb.left});this.render();window.requestAnimationFrame(()=>
{va.DOMElementExtensions.vf(this.placeholder);this.TPa&&(bb&&this.TPa.focus(),this.TPa=void 0)})}kKb(){const bb=this.O0[Za.Drag],Lb=this.O0[Za.Move];0<bb&&(this.formulaAssistanceTelemetryManager.VI("d"),this.zGa||(this.formulaAssistanceTelemetryManager.hP.argumentAssistanceDragTotalCounter+=bb),this.O0[Za.Drag]=0);0<Lb&&(this.formulaAssistanceTelemetryManager.VI("m"),this.zGa||(this.formulaAssistanceTelemetryManager.hP.argumentAssistanceMoveTotalCounter+=Lb),this.O0[Za.Move]=0)}}Object(d.a)(Re,"FormulaAssistanceDragControl",
null,[]);var Za;(function(bb){bb.Drag="drag";bb.Move="move"})(Za||(Za={}));Object(d.b)("FormulaAssistanceDragMode",Za);class Xb extends wd.a{constructor(bb,Lb,mc,Uc,pd,ta,rb){super(Xb.eKa(ba.a.u4(bb),E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage"),rb));this.$=bb;this.pj=Lb;this.functionInfoManager=mc;this.formulaAssistanceUIControl=Uc;this.formulaAssistanceTelemetryManager=pd;this.pluginScheduler=ta;this.htmlSanitizationHelper=rb;this.e2a=null;this.P9=0;this.wq=null;this.bZc=
!1;this.gla=this.Ao=null;this.Ika=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Zjf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=gc=>{this.U_d(gc);1===gc?this.formulaAssistanceTelemetryManager.VI("c"):this.formulaAssistanceTelemetryManager.VI("e")};this.FRa=gc=>{const Pc={};Pc[C.a.sM]="ArgumentAssistanceCard";const hd={};hd.FunctionName=gc.functionName;Pc[C.a.Qbd]=
hd;this.$.Zc(802602464,0,8,Pc)};this.$f=()=>{this.fv.clear()};this.lSi=gc=>{gc.button===Sys.UI.MouseButton.leftButton&&gc.target&&(na.g(gc),this.e2a&&this.e2a.WSa(gc))};this.zt=()=>{void 0!==this.Ao&&null!==this.Ao&&this.Ao()};this.Nk=ba.a.u4(bb);this.zwi=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage");this.Nk?(this.GRd(),this.wq=new ge(this.$,this.formulaAssistanceUIControl,0,zb.a.Fdd),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&
H.h(this.$).mc.Jm(this.$f),this.fv=new Re(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)):(this.e2a=new ne(this.domElement,this.$.tE,void 0,ba.a.TM(this.$)),this.Cc.ka("mousedown",this.lSi),bb=$get(n.fed,this.pj),this.pj.insertBefore(this.domElement,bb));H.h(this.$).view.Ps(this.zt)}Hqe(bb){this.addHandler("FAFunctionNameUpdated",bb)}jWf(bb){this.removeHandler("FAFunctionNameUpdated",
bb)}zre(bb){this.addHandler("FAParameterSelectionChangedOld",bb)}HWf(bb){this.removeHandler("FAParameterSelectionChangedOld",bb)}yre(bb){this.addHandler("FAParameterSelectionChanged",bb)}GWf(bb){this.removeHandler("FAParameterSelectionChanged",bb)}set_visible(bb){this.Nk?bb||this.M7b():Sys.UI.Control.prototype.set_visible.call(this,bb);return bb}M7b(){this.formulaAssistanceUIControl&&(this.Ao=null,this.fv.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.gla=null,this.wq.Ff=!1)}show(bb){this.Nk||
(this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceRender"]),this.e2a.setVisible(!!bb),this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceRender"]),this.bZc&&(this.bZc=!1,this.formulaAssistanceTelemetryManager.dua("argumentAssistanceOverall")))}qNd(){this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceComputation"]);const bb=H.h(this.$).li,Lb={content:bb.text,caretPosition:bb.textBox.caretPosition};
(this.Ika?this.pluginScheduler.getRequester().argumentAssistance(Lb,0):this.pluginScheduler.requester().argumentAssistance(Lb)).then(mc=>{0===mc.kind?mc.payload?(this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceComputation"]),this.rHj(this.nsc(mc.payload),bb.textBox.domElement)):this.M7b():this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceComputation"],!1);return null})}update(bb,Lb,mc,Uc){if(!this.Nk&&bb){this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.bZc=!0;var pd=this.$.listSeparator;try{var ta=$get(n.hed,this.pj);const rb=$get(n.aed,this.pj);ta.innerText="";rb.innerText="";const gc=$get(n.XZe,this.pj),Pc=bb.Params.split(n.lbd);ta=[];for(let hd=0,Cd=gc.rows.length;hd<Cd;hd++){const Zd=gc.rows[hd];va.DOMElementExtensions.setVisible(Zd,hd<Pc.length);let Wd=Pc[hd];const Se=n.f3i+hd+"_",Le=bb.NameDataStrings;$get(Se+n.qHb,Zd).innerText=Le;$get(Se+n.DFd,Zd).innerText=Le;if(Wd){const ve=Pc[hd].split(pd),We=Xb.iqd(ve[ve.length-
1]),rf=Xb.Eri(bb);We&&(rf&&(2<ve.length?(ve[ve.length-2]+="1",ve[ve.length-3]+="1"):v.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Le,ve.length.toString(),Lb)),Xb.QRg(ve,rf,Lb,bb));Wd=ve.join(pd.toString()+" ");Pc[hd]=Wd;mc<ve.length?(ta[hd]=ve[mc],v.ULS.shipAssertTag(537162072,0,!!ve[mc]&&1<=ve[mc].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
mc,ve.length,Le,hd),ve[mc]=`${"<b>"}${ve[mc]}${"</b>"}`,Wd=ve.join(pd.toString()+" ")):v.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+mc+"currRowParamsArray.Length = "+ve.length+", current row = "+hd);Uc&&v.ULS.sendTraceTag(558474578,0,50,`formula '${Le}', ${ve.length} params, isElipsis = ${We}, isPairsParamsFormula = ${rf}, currentParameterIndex = ${Lb}`)}this.zwi?this.htmlSanitizationHelper.Ph($get(Se+n.erc,Zd),"("+(Wd||
"")+")"):$get(Se+n.erc,Zd).innerHTML="("+(Wd||"")+")"}Uc?this.raiseEvent("FAFunctionNameUpdated",new Td(bb.NameDataStrings,Pc)):this.raiseEvent("FAParameterSelectionChangedOld",new bd(Pc,ta,mc));gc.className=Fc.a.qwh+(this.functionInfoManager.Uhc(bb)?"-udf":"")}catch(rb){throw v.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",bb.NameDataStrings,Lb,rb),rb;}this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceComputation"])}}dispose(){this.Nk||
(this.Cc.AC(),ka.a.Ja(this.Cc),H.h(this.$).view.Jq(this.zt),ka.a.Ja(this.e2a),this.e2a=null);this.Nk&&(ka.a.Ja(this.wq),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&H.h(this.$).mc.$l(this.$f));this.functionInfoManager=this.$=null;super.dispose()}nsc(bb){const Lb=new te;Lb.functionRenderingInfo=bb;Lb.cardMode=this.P9;this.QKd(Lb);return Lb}QKd(bb){bb.callbacks=new ce;bb.callbacks.onHelpLink=this.Sgd(bb.functionRenderingInfo);bb.callbacks.onCardModeChange=this.onCardModeChange;
bb.callbacks.onFeedback=this.FRa}rHj(bb,Lb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceRender"]);const mc={};mc.zoomLevel=Y(this.$);this.formulaAssistanceUIControl.updateContext(mc);this.Ao=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Lb,bb,()=>{})};this.Ao();this.svc();this.Erc(bb);this.fv.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ao,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.wq.Ff=!0;this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.dua("argumentAssistanceOverall")}}Sgd(bb){return()=>{M(this.$,bb.helpID,bb.isUDF)}}GRd(){const bb=jd.a.get(C.a.epb);this.P9=bb?parseInt(bb,10):Xb.T7c;this.formulaAssistanceTelemetryManager.z3f(this.P9)}Erc(bb){var Lb=bb.functionRenderingInfo.functionName;this.gla&&ca.a.equals(this.gla,Lb,!0)?(Lb=nd.a.map(bb.functionRenderingInfo.signatures,
mc=>{let Uc="";0<=mc.signatureParams.activeParam&&mc.signatureParams.activeParam<mc.signatureParams.params.length&&(Uc=mc.signatureParams.params[mc.signatureParams.activeParam]);return Uc}),this.raiseEvent("FAParameterSelectionChanged",new jc(Lb))):(this.gla=Lb,bb=nd.a.map(bb.functionRenderingInfo.signatures,mc=>mc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Td(Lb,bb)))}U_d(bb){this.P9=bb;try{jd.a.Av(C.a.epb,bb.toString(),vd.AFrame.H0)}catch(Lb){v.ULS.sendTraceTag(537162070,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Lb.message}`)}}svc(){const bb=this.formulaAssistanceUIControl.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.VI(bb)}static iqd(bb){return ca.a.contains(bb,n.L8b,!0)}static Eri(bb){return!!bb&&ca.a.s2a(bb.NameDataStrings,"IFS")}static QRg(bb,Lb,mc,Uc){try{if(!bb||2>bb.length)v.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${Uc.NameDataStrings}', ${bb?bb.length.toString():
"currRowParamsArray == null"} params, isPairsParamsFormula = ${Lb}, currentParameterIndex = ${mc}.`);else{var pd=bb.pop().toString();for(let ta=bb.length-1;ta<mc;ta++){const rb=bb[ta].trim();if(Lb){const gc=bb[ta-1].trim();bb.push(Xb.DMh(gc,rb))}else{const gc=Xb.Wdf(rb);bb.push(Xb.z_e(gc))}}bb.push(pd)}}catch(ta){throw v.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${Uc.NameDataStrings}', ${bb?bb.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Lb}, currentParameterIndex = ${mc}.
Exception: ${ta}`),ta;}}static DMh(bb,Lb){bb=Xb.Wdf(bb);const mc=Xb.G5e(bb);Lb=Xb.G5e(Lb);return Xb.z_e(bb,!0,!!mc&&!!Lb&&mc!==Lb)}static Wdf(bb){var Lb=bb.match(Xb.EBd);bb=ca.a.trimEnd(ca.a.trimStart(bb,n.SKf),n.RKf);if(Lb&&Lb.length){Lb=Lb[Lb.length-1];const mc=Number.parseLocale(Lb)+1;bb=bb.replace(Lb,mc.toString())}else bb=`${bb}${1}`;return bb}static z_e(bb,Lb=!1,mc=!1){let Uc="[{0}]";Lb&&(Uc=mc?"[{0}":"{0}]");return String.format(Uc,bb)}static G5e(bb){return(bb=bb.match(Xb.EBd))&&bb.length?
bb[0]:null}static eKa(bb,Lb,mc){if(bb)return document.createElement("div");bb=String.format(n.ELf,n.CLf,n.DFd,Fc.a.jSe,n.qHb,Fc.a.iSe,n.erc);var Uc=String.format(n.ELf,n.DLf,n.DFd,Fc.a.jSe,n.qHb,Fc.a.iSe,n.erc);bb=String.format(n.TKh,n.UKh,Fc.a.fTe,Fc.a.Qth,r.a.eo,n.XZe,bb,Uc);Uc=document.createElement("div");Lb?mc.Ph(Uc,bb):Uc.innerHTML=bb;return Uc.firstChild}}Xb.EBd=RegExp("\\d+");Xb.T7c=0;Object(d.a)(Xb,"FormulaArgumentAssistanceControlDeprecated",wd.a,[360]);class jb{constructor(){this.Eha=this.Nsa=
this.Osa=!1;this.GKf=40;this.zDe=41;this.s0a=this.iFd=this.jFd=this.rHb=0;this.yBf=!0;this.PDd=!1;this.mYe=this.PPd=-1}}Object(d.a)(jb,"ParseContext",null,[]);var Sb=a(420),lc=a(930),oc=a(326),Qc=a(857),Kb=a(966);class hc extends lc.a{constructor(bb,Lb,mc,Uc){super(bb,Lb);this.formulaAssistanceControl=mc;this.formulaAssistanceTelemetryManager=Uc;this.pKf=!1;this.tSa=null;this.ind=0;this.uIa=this.dIc=null;this.LP=0;this.Dpb=Lb.textBox;this.Nk=ba.a.u4(bb);this.Ihj=E.EwaSettings.vb()}get rAb(){return Object(Sb.a)(Gb,
this.$.qb.$g)}get $J(){return this.formulaAssistanceControl.re}set $J(bb){this.formulaAssistanceControl.re=bb}get U5a(){return this.eb.U5a}get oei(){var bb=this.Dpb.text;let Lb=!1;if(0>=bb.length)return Lb;const mc=this.$.Jb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),Uc=H.h(this.$).ha.qa.activeCell.clone();var pd=bb.charCodeAt(0);this.uIa="";this.LP=this.R1g(bb,this.Dpb.caretPosition);pd=61===pd&&-1!==this.LP;if(!E.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))pd&&
(Lb=!0);else if(pd){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){pd=0;for(var ta=this.LP-1;1<=ta&&!(this.LP-ta>hc.kvf);ta--)if(hc.Sxe.includes(bb.charAt(ta))){pd=ta;break}pd=bb.substring(pd+1,this.LP);bb=""!==pd?this.$.yb.getItemByName(pd):null;ta=this.LP;for(var rb=this.LP+1;rb<=this.eb.textBox.caretPosition;rb++)if("["===this.eb.text.charAt(rb))ta=rb;else break;this.LP=ta}else{pd=bb.lastIndexOf("[");ta=0;for(rb=pd-1;1<=rb&&!(pd-rb>hc.kvf);rb--)if(hc.Sxe.includes(bb.charAt(rb))){ta=
rb;break}pd=bb.substring(ta+1,pd);bb=""!==pd?this.$.yb.getItemByName(pd):null}bb&&2===bb.type?(Lb=!0,this.uIa=pd):H.h(this.$).wb.zi(Uc)&&(Lb=!0,this.uIa="")}mc.stop();this.ind=mc.Bc;v.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.ind} milliseconds`);return Lb}get key(){return A.a.Tvb}get calcManager(){this.dIc||(this.dIc=Object(za.a)({Q5:266,new:G.b,registry:this.$.da,G3:E.EwaSettings.dX}));
return this.dIc}get dUd(){if(null!=this.tSa)return this.tSa;if(!E.EwaSettings.sa(128))return this.tSa=!1;const bb=H.h(this.$).ha.qa.activeCell.clone();if(1!==bb.Puf||!bb.left||H.h(this.$).ha.qa.tic())return!1;let Lb=this.formulaAssistanceControl.tableManager.Mp(bb);if(Lb)return this.tSa=!1;--bb.left;--bb.right;if(!bb.lz)return!1;Lb=this.formulaAssistanceControl.tableManager.Mp(bb);return this.tSa=!!Lb&&bb.top===Lb.top&&this.formulaAssistanceControl.tableManager.pah(Lb,H.h(this.$))}Mh(bb,Lb){this.formulaAssistanceControl.eb=
this.eb;-1470715894!==Lb&&-1231471547!==Lb||!this.XLe()||(this.$J=!1);return super.Mh(bb,Lb)}bCd(){var bb=this.U5a;if(bb||this.dUd)if(this.formulaAssistanceControl.eb=this.eb,this.formulaAssistanceTelemetryManager.Jpb.formulaAssistanceRequestAttemptedCounter++,this.XLe())if(!bb&&this.dUd)this.formulaAssistanceControl.Hve();else if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.oei){if(bb=this.$.Jb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.Jve(),bb.stop(),this.Dpb.text.endsWith("[")&&"["!==this.Dpb.text.charAt(this.Dpb.text.length-2)){const Lb=""===this.uIa?this.formulaAssistanceControl.tableManager.Dg:Object(eb.a)(oc.a,this.$.yb.getItemByName(this.uIa));v.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${Lb.Gi} in ${bb.Bc} ms with cell edit regression time of ${this.ind} ms and popup visibility - ${this.$J}`)}}else this.formulaAssistanceControl.qpb(),
this.pKf&&(this.pKf=this.$J=!1);else this.formulaAssistanceTelemetryManager.Jpb.formulaAssistanceRequestOptimizedCounter++;else this.$J=!1}Ri(){this.Ihj||(this.tSa=null,this.dUd&&this.formulaAssistanceControl.kZ())}$f(){this.$J=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Bvc();this.Nk&&this.jCi()}yId(bb,Lb){return this.formulaAssistanceControl.Mh(bb,Lb)}jCi(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.W$&&
!this.formulaAssistanceControl.jia&&!this.formulaAssistanceControl.Yna&&(this.formulaAssistanceTelemetryManager.aJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.W$=!1);this.formulaAssistanceControl.mI&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionShownCounter++,this.formulaAssistanceControl.mI=!1,Object(Qc.a)(Kb.a));this.formulaAssistanceControl.Yna&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.Yna=
!1,Object(Qc.a)(Kb.c));this.formulaAssistanceControl.RSa&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.RSa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.XG.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.jMa&&(this.formulaAssistanceTelemetryManager.XG.isCellContentFormulaCounter++,this.formulaAssistanceControl.jMa=
!1)}R1g(bb,Lb){let mc=0,Uc;for(;-1!==mc;)if(mc=bb.indexOf("[",mc+1),-1!==mc&&mc<Lb&&(Uc=bb.indexOf("]",mc+1),-1===Uc||Uc>=Lb))return mc;return-1}XLe(){const bb=this.eb.text,Lb=this.eb.textBox.caretPosition,mc=this.formulaAssistanceControl.Qba,Uc=this.formulaAssistanceControl.hla;if(this.$J&&ca.a.equals(bb,mc,!0)&&Lb===Uc)return!1;this.formulaAssistanceControl.Qba=bb;this.formulaAssistanceControl.hla=Lb;return!0}}hc.Sxe=" !%&'()*+,-/:;<=>@[]^{|}~".split("");hc.kvf=255;Object(d.a)(hc,"FormulaAutoCompleteListAutoCompleteBehavior",
lc.a,[]);var Cc;(function(bb){bb[bb.function=0]="function";bb[bb.field=1]="field";bb[bb.definedName=2]="definedName";bb[bb.letVariable=3]="letVariable";bb[bb.tableColHeaderName=4]="tableColHeaderName";bb[bb.tableSpecialStructRef=5]="tableSpecialStructRef";bb[bb.pendingData=6]="pendingData";bb[bb.tableNamedObject=7]="tableNamedObject"})(Cc||(Cc={}));Object(d.b)("ItemType",Cc);var Ka=a(1113),Ib=a(1112);class dc{constructor(bb){this.index=bb}execute(bb){bb.push(this.index)}}Object(d.a)(dc,"AppendIndexOperation",
null,[376]);class yc{execute(){}}Object(d.a)(yc,"NopIndexOperation",null,[376]);class Eb{constructor(bb,Lb){this.m8i=bb;this.lxf=Lb}execute(bb){for(let Lb=0;Lb<bb.length;Lb++)bb[Lb]===this.m8i&&(bb[Lb]=this.lxf)}}Object(d.a)(Eb,"ReplaceIndexOperation",null,[376]);var Ac=a(80);class ld{constructor(bb,Lb){this.$=bb;this.items=Lb;this.AMa=ba.a.AMa(this.$)}pIe(bb,Lb){const mc=new dc(Lb);if(!this.AMa)return mc;bb=this.Ewi(bb,Lb);return null!=bb?this.items[bb].QBb?new Eb(bb,Lb):new yc:mc}Ewi(bb,Lb){const mc=
this.items[Lb];v.ULS.shipAssertTag(537162075,0,!!mc,"Internal error: invalid item index");bb=Ac.where(Ac.asEnumerable(bb),Uc=>this.items[Uc].name===mc.name);return Ac.Ct(bb)?Ac.first(bb):null}}Object(d.a)(ld,"FilterItemOperationFactory",null,[]);var Vd=a(116),Od=a(856);class he{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(he,"CompletionItem",null,[]);const Ye=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${r.a.eo}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${r.a.eo}'>{5}</td>\r\n</tr>`,
se=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${r.a.eo}'></td>\r\n\t<td id='${"item_type_cell"}' class='${r.a.eo}'>{2}</td>\r\n</tr>`,bf=`<td>\r\n\t<div class='${r.a.Or}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,tf=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${r.a.eo}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${r.a.eo}'>{2}</td>\r\n</tr>`;
class Ie extends Ka.a{constructor(bb,Lb,mc,Uc,pd,ta){super(bb,Lb);this.htmlSanitizationHelper=pd;this.lra=null;this.Geb=this.dxc=0;this.Krb=null;this.YZe=mc;this.Rvb=Uc;this.formulaAssistanceControl=ta;this.To=[];this.UV=[];this.Nk=ba.a.u4(bb);this.Ipi=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")}BXc(bb){this.addHandler("FLBSelectedRowChanged",bb)}nMd(bb){this.removeHandler("FLBSelectedRowChanged",bb)}E_b(bb){this.addHandler("ACLBUpdated",bb)}Guc(bb){this.removeHandler("ACLBUpdated",
bb)}get Ejc(){return 0<this.Geb&&this.Geb===this.To.length}get cui(){return 0<this.Geb}get re(){return super.re}set re(bb){super.re=bb;bb||(this.dxc=0,this.ee=null);0===this.dxc?va.DOMElementExtensions.setVisible(this.Rvb,bb&&!this.Nk):va.DOMElementExtensions.setVisible(this.Rvb,!1)}get Ej(){return this.lra}set Ej(bb){this.yBa(this.Ej);if(bb){this.YZe.innerText="";this.lra=bb;var Lb=this.yBa(this.Ej);const mc=bb.rowIndex+1,Uc=$get("description_cell"+mc,bb);this.Rvb.innerText=Uc.innerText;const pd=
$get("item_type_cell",bb);this.ee=Lb=Lb.innerText;this.dxc="field"===pd.innerText?1:"definedName"===pd.innerText?2:"letVariable"===pd.innerText?3:"tableColHeaderName"===pd.innerText?4:"tableSpecialStructRef"===pd.innerText?5:"pendingData"===pd.innerText?6:"tableNamedObject"===pd.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Ib.a(this.To.length,mc,Lb,Uc.innerText));this.Owc(bb)}}get JTa(){return this.Rvb}get FGa(){return this.formulaAssistanceControl}get f0(){return this.dxc}dispose(){super.dispose();
this.lra=this.YZe=this.Rvb=null}oBc(bb,Lb,mc,Uc=0){this.Nk||this.q7(!1);let pd="";mc&&(pd+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${Fc.a.A6g}'>${mc}</td></tr></table>`);pd+=`<table class='${this.p5}' aria-live='off'><tbody>`;const ta=new Vb.a;for(let gc=0,Pc=this.UV.length;gc<Pc;gc++)pd+=this.b8e(bb[this.UV[gc]],gc+1,Lb,Uc),this.Nk&&ta.add(this.x1e(bb[this.UV[gc]]));let rb=this.UV.length;for(let gc=0,Pc=this.To.length;gc<Pc;gc++)this.UV.includes(this.To[gc])||(rb++,pd+=
this.b8e(bb[this.To[gc]],rb,Lb,Uc),this.Nk&&ta.add(this.x1e(bb[this.To[gc]])));pd+="</tbody></table>";this.Ipi?this.htmlSanitizationHelper.Ph(this.Df,pd):this.Df.innerHTML=pd;this.vn=va.DOMElementExtensions.$j(this.domElement,this.p5);this.Nk&&(this.Krb=ta.toArray());this.Nk?(this.re=!0,this.FGa.set_visible(!0)):(this.q7(!0),this.KPg(!!mc))}HJa(bb,Lb,mc,Uc="",pd=0,ta=!1){if(bb){var rb=[],gc=[];this.Geb=0;var Pc=new ld(this.$,bb);if(Lb){var hd=!!Lb&&0<pd,Cd=hd&&91===Lb.charCodeAt(pd+1)?pd+2:pd+1;ta=
hd?Lb.length===Cd:!1;hd&&Lb.length===pd&&E.EwaSettings.sa(128)&&(ta=!0);var Zd=null;!ta&&hd&&Lb.length>pd+1&&(Zd=Lb.substring(Cd,Lb.length));if(Lb)for(let Wd=0,Se=bb.length;Wd<Se;Wd++)if(hd=bb[Wd].name,!bb[Wd].Wmi){Cd=Pc.pIe(rb,Wd);bb[Wd].QBb&&this.Geb++;if(!Zd&&!ta||0===bb[Wd].itemType)({aef:rb,JNf:gc}=this.uXe(Lb,hd,mc,Cd,rb,gc));Zd&&1===bb[Wd].itemType&&({aef:rb,JNf:gc}=this.uXe(Zd,hd,!0,Cd,rb,gc));ta&&1===bb[Wd].itemType&&Cd.execute(rb)}}else for(mc=0;mc<bb.length;++mc)if(bb[mc].QBb||ta)Zd=Pc.pIe(rb,
mc),Zd.execute(rb),Zd.execute(gc),bb[mc].QBb&&this.Geb++;this.UV=gc;this.To=rb;this.oBc(bb,Lb,Uc,pd)}}i0j(bb){if(bb&&!(1<bb.length)){var Lb=[],mc=[];Lb.push(0);mc.push(0);this.UV=Lb;this.To=mc;this.oBc(bb,"","",0)}}eya(){this.Ej&&super.eya()}Maj(bb,Lb){this.raiseEvent("ACLBUpdated",new Ib.a(bb,void 0,void 0,Lb))}pkg(bb){const Lb=this.vn.rows[bb];return(!this.Ej||this.Ej!==Lb)&&bb<this.vn.rows.length?(this.Ej=Lb,!0):!1}static y1e(bb){switch(bb){case 0:return 3;case 2:return 100;case 1:case 6:return 103;
case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(bb){na.g(bb.Ea);0===this.f0||2===this.f0||3===this.f0||4===this.f0||5===this.f0||7===this.f0?(this.raiseEvent(Od.a.Z4a),this.eya()):1===this.f0?this.FGa.My(!1):(this.FGa.My(!1),bb=H.h(this.$),bb.Do(!1),bb.focus());return!0}KPg(bb){this.Ura();if(bb){var Lb=this.vn.offsetWidth+(this.To.length>this.HH?Vd.a.Bu:0);bb=$get("list_column_header");bb.offsetWidth>Lb&&va.DOMElementExtensions.Hv(this.Df,bb.offsetWidth);
Lb=this.Df.getElementsByClassName(this.pV);for(let mc=0;mc<Lb.length;mc++)Lb[mc].style.width=B.HelperMethods.sc(bb.offsetWidth)}}b8e(bb,Lb,mc,Uc){if(1===bb.itemType){const pd=aa.a.yg(bb.name),ta=aa.a.yg(Uc?mc.substring(Uc+1,mc.length):mc);let rb=0;pd.substring(0,ta.length).toLowerCase()!==ta.toLowerCase()&&(rb=Ie.jNj(pd,n.Cng,ta));mc="";mc=0<=rb?mc+(pd.substring(0,rb)+"<b>"+pd.substring(rb,rb+ta.length)+"</b>"+pd.substring(rb+ta.length,pd.length)):mc+pd;Uc=Uc?String.format(bf,r.a.GTe,aa.a.TJ(W.a.qe(0)),
u.a.instance.ga(711)):"";return String.format(se,Uc,Lb,Cc[bb.itemType],this.pV,mc)}if(5===bb.itemType)return String.format(tf,"",Lb,Cc[bb.itemType],this.pV,aa.a.yg(bb.name),aa.a.yg(bb.hja));if(4===bb.itemType)return String.format(tf,"(...)",Lb,Cc[bb.itemType],this.pV,aa.a.yg(bb.name));if(6===bb.itemType)return Uc=Uc?String.format(bf,r.a.GTe,aa.a.TJ(W.a.qe(0)),u.a.instance.ga(711)):"",String.format(Ye,Uc,this.pV,aa.a.yg(bb.name),aa.a.yg(bb.hja),Lb,Cc[bb.itemType]);Uc=String.format(bf,2===bb.itemType||
3===bb.itemType?r.a.xzh:r.a.vzh,aa.a.TJ(W.a.qe(0)),u.a.instance.ga(708));return String.format(Ye,Uc,this.pV,aa.a.yg(bb.name),aa.a.yg(bb.hja),Lb,Cc[bb.itemType])}x1e(bb){const Lb=new he;Lb.label=bb.label;Lb.textEdit=bb.textEdit;Lb.kind=Ie.y1e(bb.itemType);Lb.type=bb.QBb?1:0;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Lb.kind){const mc=this.formulaAssistanceControl.NVh(bb.label);Lb.detail=mc?mc:bb.hja}else Lb.detail=bb.hja;return Lb}uXe(bb,Lb,mc,Uc,pd,ta){ca.a.equals(Lb,
"Pretend this is the line.",!1)&&0<pd.length||ca.a.KF(Lb,bb)?(Uc.execute(pd),Uc.execute(ta)):mc&&bb.length>=n.sah&&Ie.Zkh(Lb,n.Cng,bb)?Uc.execute(pd):!mc&&bb.length>=n.rah&&ca.a.contains(Lb,bb,!0)&&Uc.execute(pd);return{aef:pd,JNf:ta}}static Zkh(bb,Lb,mc){for(const Uc of Lb)if(Lb=bb.split(Uc),!(2>Lb.length))for(const pd of Lb)if(ca.a.KF(pd,mc))return!0;return!1}static jNj(bb,Lb,mc){for(const Uc of Lb)if(Lb=bb.toLowerCase().indexOf((Uc+mc).toLowerCase()),0<Lb)return Lb+1;return-1}}Object(d.a)(Ie,"FormulaAutoCompleteListBox",
Ka.a,[346]);class uf{constructor(){this.e9=this._name=null}get name(){return this._name}get toolTip(){return this.e9}}Object(d.a)(uf,"LETVariableInfo",null,[]);class Ya{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Ya,"TableColHeaderNameInfo",null,[]);class Nb{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Nb,"TableNamedObjectInfo",null,[]);class rc{constructor(){this.e9=this._name=null}get name(){return this._name}get toolTip(){return this.e9}}Object(d.a)(rc,
"TableSpecialStructRefInfo",null,[]);var Oc=a(162),sd=a(29),zd=a(101),Pd=a(927),ue=a(255),ze=a(52),Ne=a(145);class ff{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(ff,"FormulaAutoCompleteCallbacks",null,[]);class Ge{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(Ge,"FormulaAutoCompleteRenderingInfo",null,[]);class af{}Object(d.a)(af,"RunExperimentRequest",null,
[]);class wf extends wc.a{constructor(bb,Lb,mc,Uc,pd,ta,rb,gc,Pc,hd){super(bb);this.functionInfoManager=Lb;this.calcManager=Uc;this.instantaneousSupportInformationManager=pd;this.formulaAssistanceUIControl=rb;this.formulaAssistanceTelemetryManager=gc;this.pluginScheduler=Pc;this.Nec=!1;this.f5=this.jud=this.jV=this.Dg=this.GGa=this.wq=null;this.t6b=this.sOb=this.Ntb=this.tNe=this.l3=this.Sac=this.F3a=0;this.mzc=!1;this.mrc=this.Kia=null;this.columnName="";this.rAe=this.b8c=!1;this.UJa=[];this.KP=
null;this.HNb=[];this.U7=this.ied=this.Ao=null;this.jia=this.W$=this.jMa=this.isCellContentOnlyEqualDuringEdit=this.RSa=this.Yna=this.mI=this.ufa=!1;this.Qba=null;this.hla=0;this.X4d=null;this.$od=!1;this.onRestoreFocus=()=>{};this.Ngb=void 0;this.Ika=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Zjf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.ikd=()=>{this.Nk&&this.raiseEvent(wf.ldd,
null)};this.qXe=()=>{this.Kia=!1;this.jV=this.eb.text;this.Qg.HJa(this.$q,this.jV,!0,this.columnName,void 0,!1);1===this.Qg.To.length&&1===this.Qg.UV.length?(this.set_visible(!1),this.rAe||this.bnd()):this.show()};this.jDd=Cd=>{if(Dc.a(Cd))-315732528!==Cd.Errors[0].MessageId&&v.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${sd.a.nc(Cd.Errors)}`);else if((Cd=Cd.Result)&&Cd.length){this.Dg.lO||(this.Dg.lO={},this.Dg.lO.HeadersList=
[]);this.Dg.lO.IsFullTableHeaders=!0;for(let Zd=0;Zd<Cd.length;++Zd)this.Dg.lO.HeadersList[Zd]={},this.Dg.lO.HeadersList[Zd].Index=Zd,this.Dg.lO.HeadersList[Zd].Name=Cd[Zd];this.kNf(!0);this.jV=this.a8e();this.Qg.HJa(this.$q,this.jV,!0,void 0,void 0,!0);this.show()}else v.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.iDd=Cd=>{Cd=Ua.a.Pe(Cd.data);v.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${sd.a.nc(Cd)}`)};
this.fzf=(Cd,Zd)=>{this.gridView.fb||this.gridView.Uh||this.eFb(null===Zd||void 0===Zd?void 0:Zd.cell)};this.U5=(Cd,Zd)=>{this.$Od(Zd.newValue)};this.Uc=()=>{(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Nk)&&this.set_visible(!1)};this.iDf=()=>{this.U7=this.GGa=null};this.ij=()=>{this.Nk&&this.T1a()};this.onFunctionInfoLoaded=()=>{this.qpb()};this.Cya=()=>{this.ika?(this.GGa=this.U7=null,this.qpb()):this.Og.Pk&&this.Hve()};this.Aca=()=>{this.KP&&
M(this.$,this.KP.HelpId,this.KP.IsDynamicUdf);return!0};this.Dca=(Cd,Zd)=>{0==Zd.sr&&(170==Zd.Lf.operation.operationName&&this.formulaAssistanceTelemetryManager.clc++,this.$.userOperationManager.zo(this.Dca))};this.aPa=(Cd,Zd)=>{0==Zd.sr&&(12==Zd.Lf.operation.operationName&&this.$.userOperationManager.Lr(this.Dca),this.$.userOperationManager.zo(this.aPa))};this.T1a=()=>{this.Nk&&this.rwd();E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.mI&&(this.W$=!0);
this.dF&&this.eb.fb&&this.Sma();this.Ao=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.v1b),this.wq.Ff=!1);this.$od=!1};this.bIf=()=>{this.dF&&this.Sma();this.o$f();1===this.i2f.type&&E.EwaSettings.vb()&&!this.eb.text.includes("\n")&&this.sHd(this.i2f)};this.onDismiss=()=>{this.re=!1;this.gridView.li.textBox.focus()};this.FRa=()=>{const Cd={};Cd[C.a.sM]=this.Qg.Ejc?"SmartSuggestionsCard":this.Qg.cui?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Zc(802602464,
0,8,Cd)};this.BCd=(Cd,Zd)=>{this.Qg.pkg(Zd);this.Nk&&(this.MIa=!0)};this.ACd=Cd=>{this.Nk&&(this.JIa=!0);this.dF?(this.OEe(),this.M0f(),this.gridView.kaa.p3f(),this.gridView.li.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Cd.textEdit?this.Frb(Cd.textEdit):this.My(!0)};this.gridView=H.h(bb);this.domElement.className=Fc.a.UQe;this.Og=ta.A5c(bb,mc);this.g7b=new cd(bb);this.LEg=mc;wf.tfc||(wf.tfc=wf.eKa());E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")?
hd.Ph(this.domElement,wf.tfc):this.domElement.innerHTML=wf.tfc;this.EBd=RegExp("\\d+");ue.d(this.style,this.$.isChromeRtl);this.bja=new Xb(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,hd);Lb=$get(n.fed,this.domElement);mc=$get(n.aed,this.domElement);Uc=$get(n.hed,this.domElement);this.Lwg=new Ie(this.$,Lb,Uc,mc,hd,this);this.Og.v_b(this.Cya);this.functionInfoManager.YFa(this.onFunctionInfoLoaded);this.functionInfoManager.GMg(this.iDf);
this.v1b=this.domElement;this.Nk&&(this.$.va.Vf(this.ij),this.Qg.BXc(this.bIf),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.v1b=document.createElement("div")));this.gTa(!0);this.Ccg(!0);this.$.domElement.appendChild(this.v1b);this.FSc=0;(hd=R.a(bb))&&this.UJa.push(new hc(bb,hd,this,this.formulaAssistanceTelemetryManager));this.UJa.push(new hc(bb,this.gridView.Vb,this,this.formulaAssistanceTelemetryManager));this.Kvb=this.UJa[0];this.Pqb=this.UJa[this.UJa.length-
1];bb.da.Ha(221,this);this.instantaneousSupportInformationManager||this.$.da.gb(268,Cd=>{this.instantaneousSupportInformationManager=Cd});this.KWe=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);this.QSa=ba.a.AMa(this.$);this.WFj=ba.a.Cpb(this.$);this.eBd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.r_c=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");ba.a.bV(this.$)&&this.Ynd();
ba.a.TM(this.$)&&Lb.classList.add("ewa-fb-refactor");this.Nk?this.gridView.ha.cC(this.Uc):this.gridView.ha.lT(this.Uc);this.wq=new ge(this.$,this.formulaAssistanceUIControl,1,zb.a.Hdd,this.ikd)}Fqe(bb){this.addHandler(wf.Ndd,bb)}iWf(bb){this.removeHandler(wf.Ndd,bb)}Dqe(bb){this.addHandler(wf.ldd,bb)}gWf(bb){this.removeHandler(wf.ldd,bb)}Eqe(bb){this.addHandler("FormulaAutoCompleteShown",bb)}hWf(bb){this.removeHandler("FormulaAutoCompleteShown",bb)}get au(){return this.Qg}get $q(){return this.U7}get yLb(){return this.Qg.ee}get TZe(){return this.Qg}get AZe(){return this.bja}get Qg(){return this.Lwg}get l1a(){return this.QSa?
this.eb?this.eb.text:null:this.jV}get wkf(){var bb;return 0===(null===(bb=this.lYe)||void 0===bb?void 0:bb.type)}get lui(){var bb;return 1===(null===(bb=this.lYe)||void 0===bb?void 0:bb.type)}get_visible(){return void 0!==this.Ngb?this.Ngb:this.Ngb=super.get_visible()}set_visible(bb){if(this.Ngb===bb)return this.Nk&&!bb&&this.T1a(),bb;this.bja.set_visible(bb);this.Nk&&!bb&&this.T1a();Sys.UI.Control.prototype.set_visible.call(this,bb);return this.Ngb=bb}get re(){return this.au.re}set re(bb){this.Nk&&
!bb&&this.T1a();this.au.re=bb}get tableManager(){return this.LEg}get ika(){return 0<this.QY}get dF(){return this.ufa}get wb(){return this.gridView.wb}$0g(bb,Lb){this.re&&(bb+=n.openParen,Lb++,this.HFd(bb,Lb));var mc=Lb===bb.length||bb.charAt(Lb)===n.closeParen;if(!(0<Lb&&bb.charAt(Lb-1)===n.openParen&&mc))return v.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${Lb} is invalid. Is cell empty: ${!bb.length}. Function exists in cell: ${!!this.KP}`),
!1;mc=bb.substring(0,Lb).lastIndexOf(this.$.listSeparator);const Uc=bb.substring(0,Lb-1).lastIndexOf(n.openParen);bb=bb.substring(-1===mc&&-1===Uc?1:Math.max(mc,Uc)+1,Lb-1).trim();return this.functionInfoManager.Igd(bb)?!0:(v.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.KP}`),!1)}Nii(bb,Lb){var mc=this.$0g(bb,Lb);if(!mc||!this.KP)return v.ULS.shipAssertTag(537162051,0,!mc||mc&&!!this.KP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),
{returnValue:null,hxf:0,nYe:0};mc=this.KP.Params;mc=mc.replace(RegExp("[\\[\\]]","g"),"");const Uc=bb.charAt(Lb-1)===n.openParen,pd=Uc?"":"(",ta=Lb===bb.length?")":"";var rb=this.$.listSeparator;rb=mc.includes(rb)?mc.indexOf(rb):mc.length;return{returnValue:bb.substring(0,Lb)+pd+mc+ta+bb.substring(Lb,bb.length),hxf:Uc?Lb:Lb+1,nYe:rb}}zt(bb,Lb){this.Nk&&void 0!==this.Ao&&null!==this.Ao&&this.Ao();this.Nk||super.zt(bb,Lb)}get g1b(){return this.X4d}get QY(){return this.tNe}set QY(bb){this.tNe=bb;bb||
(this.l3=0)}get zFj(){if(null==this.mrc){const bb=this.$.$b;this.mrc=!!bb&&!bb.inEmbedView}return this.mrc}get i2f(){return this.Qg.Krb[this.Qg.Ej.rowIndex]}get lYe(){var bb,Lb;return null===(Lb=null===(bb=this.Qg)||void 0===bb?void 0:bb.Krb)||void 0===Lb?void 0:Lb[0]}get a_e(){!this.ied&&this.pluginScheduler&&(this.ied=this.pluginScheduler.getFunctionsShortDescriptions());return this.ied}dispose(){if(this.$){this.gTa(!1);const bb=this.gridView;this.$.userOperationManager.zo(this.Dca);this.$.userOperationManager.zo(this.aPa);
bb&&(bb.ha&&(this.Nk?bb.ha.sB(this.Uc):bb.ha.tR(this.Uc),ba.a.bV(this.$)&&bb.ha.Tma(this.fzf)),bb.view.Jq(this.hpc));this.Nk&&this.$.va&&this.$.va.sg(this.ij)}this.functionInfoManager&&(this.functionInfoManager.hcb(this.onFunctionInfoLoaded),this.functionInfoManager.vjj(this.iDf));this.Og&&this.Og.yuc(this.Cya);this.Nk&&this.Qg&&this.Qg.nMd(this.bIf);ba.a.Pgc&&this.eb&&this.eb.FJb(this.U5);this.Ccg(!1);ka.a.Ja(this.Qg);ka.a.Ja(this.g1b);ka.a.Ja(this.bja);ka.a.Ja(this.wq);this.eb=this.functionInfoManager=
this.Og=null;ka.a.pc(this.UJa);this.Dg=this.U7=this.bja=this.UJa=null;super.dispose()}Rwa(){return!this.$q}hqi(){return!this.GGa}QYj(bb){this.lui&&1872288872===bb&&(this.formulaAssistanceTelemetryManager.dw(["autoCompleteSmartSuggestionActiveDismissing"]),this.jia=!0)}Mh(bb,Lb){if(!this.Rwa()){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.QYj(Lb);if(this.Nk&&this.dF){if(125627505===Lb||267796030===Lb)return this.Nk&&this.yDc(Lb),this.OEe(),this.M0f(),
!1;if(1872288872===Lb)return this.Sma(),this.re=!1,!0;if(this.Qg.Ejc&&(-798660877===Lb||137938150===Lb))return!1}if(1!==this.Qg.f0||125627505!==Lb&&267796030!==Lb)if(6===this.Qg.f0){var mc=bb.keyCode;13!==mc&&9!==mc||this.My(!1)}else{if(4===this.Qg.f0||5===this.Qg.f0)return super.Mh(bb,Lb,!0);1===this.Qg.UV.length&&(mc=bb.keyCode,this.rAe=8===mc||127===mc||46===mc?!0:!1)}else{if(this.My(!1)&&!this.ika)return this.gridView.ha.Mh(bb,Lb);if(125627505===Lb&&this.ika)return!0}}return super.Mh(bb,Lb)}Bvc(){this.Og.Gcb();
this.U7=null;null==this.Kia||this.Kia||this.Glc("NoFieldChosen",1,2,1);this.Kia=null;this.QY=0;this.f5=this.jud=this.mrc=null}qpb(){this.Zjf&&this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceOverall"]);const bb=!!this.eb&&!Fb.f(this.$.na);let Lb=null;bb&&(Lb=this.eb.text,Lb.startsWith("=")&&(this.jMa=!0,1===Lb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.WFj&&bb){const mc={content:Lb,caretPosition:null};(this.Ika?this.pluginScheduler.getRequester().functionSuggestion(mc,
0):this.pluginScheduler.requester().functionSuggestion(mc)).then(Uc=>{if(0===Uc.kind){v.ULS.shipAssertTag(537162050,0,!!Uc&&!!Uc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const pd=Ac.toArray(Ac.select(Ac.asEnumerable(Uc.payload.items),ta=>wf.g$g(ta)));this.gridView.kaa.LRd(Uc.payload,Lb);this.QSa&&(this.HNb=pd,P.AFrameworkApplication.rg||(this.r_c&&this.wb.U4(this.gridView.ha.qa.activeCell)?this.formulaAssistanceTelemetryManager.XG.smartSuggestionWouldSuggestInsidePivotCounter++:
this.Ive(bb,!0)))}return null})}this.QSa&&bb||this.Ive(bb,!1)}a8e(){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var bb=this.gridView.Ql?this.Kvb.LP:this.Pqb.LP;this.sOb="@"===this.eb.text.charAt(bb+1)&&this.eb.textBox.caretPosition>bb+1?bb+2:bb+1}else{bb=this.eb.text.lastIndexOf(n.Wpf);const Lb=this.eb.text.lastIndexOf("[");this.sOb=bb+1>=Lb?bb+2:Lb+1}return this.eb.text.substring(this.sOb,this.eb.textBox.caretPosition)}Jve(){this.B$f()&&(this.ehh(),
this.$q&&(this.Kia=!1,this.jV=this.a8e(),this.Qg.HJa(this.$q,this.jV,!0,void 0,void 0,!0),this.show(),E.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.bja.M7b()))}Hve(){this.B$f()&&(this.g1b&&this.g1b.cancel(),this.Og.O6a?(this.Rwa()&&this.cHe(!0),this.get_visible()?this.qXe():this.X4d=Oc.AsyncMethodContext.tq(this.qXe,n.vkh,xa.a.OJh,this.g1b)):this.kZ())}B$f(){return this.eb?0<this.$.qb.gR||!this.eb.text||!this.eb.fb?(this.set_visible(!1),
!1):Fb.f(this.$.na)?!1:!0:!1}Frb(bb){this.eb&&this.re&&(this.mod(this.eb.text,bb),this.eb.textBox.caretPosition=bb.range.start.character+bb.newText.length,this.set_visible(!1))}My(){var bb;if(!this.eb||!this.re)return!1;const Lb=this.Qg.f0;this.formulaAssistanceTelemetryManager.NXf(Ie.y1e(Lb));let mc="";var Uc=0;const pd=this.gridView;var ta=this.eb.text,rb=0,gc=this.Qg.ee,Pc=!1;if(0===Lb||2===Lb||3===Lb||7===Lb)mc+=ta.substr(0,this.F3a)+this.Qg.ee,0!==Lb||this.Qg.ee.endsWith(")")||(mc+="("),Uc=mc.toString().length,
mc+=ta.substr(this.Sac),2===Lb&&(rb=4,gc="DefinedName",Pc=!0,this.set_visible(!1));else if(1===Lb)if(this.Kia=!0,this.ika){mc+=ta.substr(0,this.QY+2);!mc.toString().endsWith(Lc.a.jU)&&E.EwaSettings.sa(128)&&(mc+=Lc.a.jU);rb=this.Qg.ee;rb=rb.replace("'","''");rb=rb.replace("[","'[");rb=rb.replace("]","']");if(this.b8c||this.tFh(rb))rb=Lc.a.fzi+rb+Lc.a.zqj,Pc=!0;mc+=rb;Uc=mc.length;rb=3;Ne.a("PulloutFieldAccepted")}else return this.eb.text=this.Qg.ee,this.set_visible(!1),pd.Do(!1),pd.focus(),this.Glc("FieldName",
1,1,1),Ne.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Lb)v.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),mc+=ta.substr(0,this.sOb),ca.a.equals(this.Qg.ee,"@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString,!1)?mc+="@":(mc+=this.Qg.ee,Pc=!0,this.set_visible(!1)),Uc=mc.length;else if(4===Lb){v.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");
mc+=ta.substr(0,this.sOb);Pc="";Uc=!1;var hd=[39,91,93,64,35];for(let Cd=0;Cd<this.Qg.ee.length;Cd++){const Zd=this.Qg.ee.charCodeAt(Cd);hd.includes(Zd)&&(Pc+="'");Pc+=this.Qg.ee.charAt(Cd).toString();Uc||ca.a.isNumeral(Zd)||ca.a.Ljf(Zd)||(Uc=!0)}hd=this.gridView.Ql?this.Kvb.LP:this.Pqb.LP;ta=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===ta.charAt(hd+1)&&Uc:ta.lastIndexOf(n.Wpf)+1>=ta.lastIndexOf("[")&&Uc;mc+=ta?"["+Pc+"]":Pc;Pc=!0;this.set_visible(!1);
Uc=mc.toString().length}else if(6===Lb)mc+=ta.substr(0,this.Ntb);else return v.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.eb.text=mc;this.eb.textBox.caretPosition=Uc;this.eb.fxa()&&(null===(bb=pd.Qr)||void 0===bb?0:bb.Jua)&&pd.Qr.FLb(this.eb.text,this.eb.textBox.caretPosition,this.eb.textBox.caretPosition,this.eb.textBox.oy.length);pd.Ql&&(bb=pd.Vb,bb.text=this.eb.text,bb.setCaretPosition(this.eb.textBox.caretPosition));gc=(null==this.Kia?
0:this.Kia)?"FieldName":gc;this.Qg.Ej.sectionRowIndex>=this.Qg.UV.length?this.Glc(gc,4,rb,0):this.Glc(gc,1,rb,0);Pc||(5===Lb||4===Lb?this.Jve():E.EwaSettings.isChangeGateEnabled("OfficeVSO:7386867_dontShowAutocompleteAfterCommitingTableName")&&7===Lb?this.set_visible(!1):this.qpb());return!0}kZ(bb=null,Lb=null){bb?(this.Og.Gcb(),this.Og.kZ(bb,!1,!1,Lb)):(bb=this.gridView,bb.ha.qa.Tg&&(bb=ja.v(bb.ha.qa.ld,this.$),this.Og.kZ(bb,!0,!0,Lb)))}Sma(){this.ufa=!1;this.eb.xMe()}NVh(bb){bb=this.calcManager.getWorksheetFuncId(bb);
return this.a_e?this.a_e.descriptionsMap.get(bb):null}cHe(bb){if(this.hqi()){if(this.Og.O6a&&this.Og.Pk&&(!this.Og.Pk.length||!this.Og.Pk[0].FieldInfoDataList))return;this.cZj(bb)}bb=Ac.asEnumerable(this.GGa);bb=Ac.concat(bb,this.TXh(this.eb.text));E.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Nk&&(bb=Ac.concat(bb,this.aZh()));Ac.OBc(bb,Lb=>Lb.name,new Pd.a);this.QSa&&(bb=Ac.concat(Ac.asEnumerable(this.HNb),bb),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?
0<this.HNb.length?(this.mI||this.formulaAssistanceTelemetryManager.BD(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.mI=!0):this.mI&&this.wkf&&(this.W$=!0):0<this.HNb.length&&(this.mI=!0),this.HNb=[]);this.U7=Ac.toArray(bb)}ehh(){var bb=this.eb.text;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Lb=this.gridView.Ql?this.Kvb.uIa:this.Pqb.uIa,mc=!0;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==
Lb&&(this.Dg=Object(eb.a)(oc.a,this.$.yb.getItemByName(Lb))),this.Dg||(this.Dg=this.tableManager.Dg,mc=!1),!this.Dg){v.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Dg=Object(eb.a)(oc.a,this.$.yb.getItemByName(Lb)),this.Dg||(this.Dg=this.tableManager.Dg,mc=!1);this.Dg.lO&&this.Dg.lO.IsFullTableHeaders?this.kNf(mc):Bb.d(this.Dg)?
(v.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),ic.q(this.$.oa.xa,this.Dg.Gi,this.jDd,this.iDd,null,null)):v.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Dg)if(Lb=this.calcManager.Qxb(this.tableManager.Dg))if(this.calcManager.Gse(this.tableManager.Dg,Lb)){bb=
Ac.empty();if(91===this.eb.text.charCodeAt(this.eb.text.length-1)){const Uc=this.g1a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);bb=Ac.concat(bb,(mc=new Vb.a,mc.add(Uc),mc))}bb=Ac.concat(bb,Ac.select(Ac.asEnumerable(Lb.toArray()),Uc=>{const pd=new ec,ta=new Ya;ta._name=Uc.toString();pd.o6f(ta);return pd}));this.U7=Ac.toArray(bb)}else bb.endsWith("[")&&"["!==bb.charAt(bb.length-2)&&v.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${Lb.count} columns for a table with id ${this.tableManager.Dg.Gi} of size ${this.tableManager.Dg.usedRange.right-
this.tableManager.Dg.usedRange.left+1}`);else bb.endsWith("[")&&"["!==bb.charAt(bb.length-2)&&v.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}tFh(bb){if(!bb)return!1;let Lb=bb.charCodeAt(0);if(46===Lb||48<=Lb&&57>=Lb||63===Lb)return!0;for(let mc=0;mc<bb.length;mc++,Lb=bb.charCodeAt(mc))if(!((E.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
ca.a.isLetter(Lb):ca.a.ird(Lb))||92===Lb||95===Lb||63===Lb||48<=Lb&&57>=Lb))return!0;return!1}HFd(bb,Lb){let mc=!1,Uc=!1;var pd=!1,ta=0;let rb=0;this.F3a=0;this.Sac=Lb;this.t6b=1;for(let gc=Lb-1;0<=gc;--gc)switch(bb.charCodeAt(gc)){case 39:Uc=!Uc;break;case 34:mc=!mc;break;case 91:++ta;pd=ta>rb;break;case 93:++rb}pd=Object(Ga.a)(new jb,{Nsa:!mc,Osa:!Uc,Eha:!pd,rHb:1});ta=this.B3i(bb,Lb,pd);Lb=this.C3i(bb,Lb,pd.Nsa,pd.Osa,pd.Eha);this.t6b=ta+Lb;if(this.FSc=ta-1)this.mzc=!1;this.iGh(bb,mc,Uc,pd.iFd,
pd.jFd)}Ynd(){this.gridView.ha.Jga(this.fzf);const bb=ba.a.Wzb()?this.gridView.Qb(null):void 0;this.eFb(bb);ba.a.Pgc&&this.gridView.li.PYa(this.U5);wf.bPd(this.pluginScheduler);this.QSa&&this.u3g()}LEh(){return this.QSa||this.KWe}D3i(){var bb=this.f5;if(!this.zFj||!bb)return this.QY=0,this.GGa=this.U7=null,!1;bb=bb.endsWith(Lc.a.jU);let Lb;if(E.EwaSettings.sa(128)&&({sheetRange:Lb}=this.tWj(this.f5.substring(0,this.l3))).returnValue){const mc=this.f5.substring(0,this.QY);if(bb&&mc!==this.jud)return this.jud=
mc,this.QY=this.f5.length-(bb?1:0),this.kZ(Lb,this.f5),this.Kia=!1,v.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}TXh(bb){const Lb=new Vb.a;this.calcManager&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&v.ULS.shipAssertTag(537162014,0,!!this.calcManager.bta(Ta.Range.Pc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.KWe&&(bb=this.calcManager.extractLetVariables(bb,
this.eb.textBox.caretPosition)))for(const mc of bb){bb=new uf;bb._name=mc;bb.e9=u.a.instance.ga(2216);const Uc=new ec;Uc.lzj(bb);Lb.add(Uc)}return Lb}aZh(){const bb=new Vb.a,Lb=this.$.yb.items;for(let Uc=0,pd=Lb.length;Uc<pd;Uc++){var mc=Lb[Uc];if(!Fb.n(mc))continue;const ta=new Nb;ta._name=mc.name;mc=new ec;mc.CBj(ta);bb.add(mc)}return bb}g1a(bb){const Lb=new ec,mc=new rc;mc._name=bb;Lb.DBj(mc);return Lb}kNf(bb){const Lb=new Vb.a,mc=this.eb.text.charCodeAt(this.eb.text.length-1),Uc=this.eb.textBox.caretPosition-
1;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.eb.text.charCodeAt(Uc):91===mc){var pd=this.g1a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);Lb.add(pd)}for(var ta of this.Dg.lO.HeadersList){pd=new ec;const rb=new Ya;rb._name=ta.Name;pd.o6f(rb);Lb.add(pd)}ta=this.gridView.Ql?this.Kvb.LP:this.Pqb.LP;pd=this.eb.text.charCodeAt(ta+1);(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
!bb||Uc!==ta&&35!==pd:!bb||91!==mc&&35!==mc)||(bb=this.g1a("#"+this.instantaneousSupportInformationManager.He.AllStructRefString),Lb.add(bb),bb=this.g1a("#"+this.instantaneousSupportInformationManager.He.DataStructRefString),Lb.add(bb),bb=this.g1a("#"+this.instantaneousSupportInformationManager.He.HeadersStructRefString),Lb.add(bb),bb=this.g1a("#"+this.instantaneousSupportInformationManager.He.TotalsStructRefString),Lb.add(bb));Lb&&(this.U7=Lb.toArray())}cZj(bb){let Lb=Ac.empty();!bb&&this.functionInfoManager.cV&&
(Lb=Ac.concat(Lb,Ac.select(Ac.asEnumerable(this.functionInfoManager.Rac),mc=>{const Uc=new ec;Uc.S4f(mc);return Uc})),bb=this.g7b.VKe,0<bb.length&&(Lb=Ac.OBc(Ac.concat(Lb,Ac.select(Ac.asEnumerable(bb),mc=>{const Uc=new ec;Uc.Ixj(mc);return Uc})),mc=>mc.name,new Pd.a)));if(this.Og.O6a&&this.Og.Pk){if(!this.Og.Pk.length||!this.Og.Pk[0].FieldInfoDataList)return;Lb=Ac.OBc(Ac.concat(Lb,Ac.select(Ac.asEnumerable(this.Og.Pk[0].FieldInfoDataList),mc=>{const Uc=new ec;Uc.fyj(mc);return Uc})),mc=>mc.name,new Pd.a);
this.columnName=this.Og.Pk[0].ColumnName}this.GGa=Ac.toArray(Lb)}eFb(bb){var Lb;const mc=this.gridView.ha.qa.activeCell;if(mc){var Uc=this.calcManager.bta(mc,!1);if(Uc){var pd=this.$.va,ta=Uc.sheet.index;0>=pd.count||0>ta||ta>=pd.count?v.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${pd.count}, currentSheetIndex = ${ta}.`):(ta=pd=null,this.eBd&&void 0!==this.calcManager&&null!==this.calcManager&&(bb=null!==(Lb=null===bb||void 0===
bb?void 0:bb.cell)&&void 0!==Lb?Lb:this.gridView.Ca.Ur(mc))&&(Lb=this.calcManager.Ncc(bb.hj),void 0!==Lb&&null!==Lb&&(pd=Lb.FormatString,ta=Lb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:Uc.range.col,rowIndex:Uc.range.row,sheetIndex:this.$.va.getItem(Uc.sheet.index).sheetId,docName:Uc.sheet.document.name,docPath:Uc.sheet.document.path,formatString:pd,builtIn:ta}),v.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${Uc.range.col}, row: ${Uc.range.row}, format: ${pd}`))}else v.ULS.sendTraceTag(512278612,
0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else v.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}M0f(){this.formulaAssistanceTelemetryManager.BH={Yj:this.gridView.ha.qa.activeCell,e3b:this.gridView.Vb.text,Hrb:!0};this.formulaAssistanceTelemetryManager.XCb=this.$.ea.se;this.formulaAssistanceTelemetryManager.alc=this.$.va.na.sheetId;this.$.userOperationManager.Lr(this.aPa)}u3g(){this.gridView.Ql?
this.Kvb.tY(!1):this.Pqb.tY(!1)}wnf(bb){let Lb;Lb=E.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?ca.a.isLetter(bb):ca.a.ird(bb);return 48<=bb&&57>=bb||46===bb||95===bb||Lb}show(){if(this.$q){var bb=this.Qg.pkg(0);this.Nk?0<this.Qg.To.length?(this.formulaAssistanceTelemetryManager.OXf(this.Qg.Krb),bb||this.o$f()):this.T1a():((bb=0<this.Qg.To.length)&&this.formulaAssistanceTelemetryManager.BD(["autoCompleteRender"]),!this.re&&this.columnName&&
bb&&this.Qg.Maj(this.Qg.To.length,this.columnName),this.re=bb,this.bja.show(this.KP),this.QBa(!0),this.Qg.eya(),bb&&this.formulaAssistanceTelemetryManager.dw(["autoCompleteRender"]))}}C3i(bb,Lb,mc,Uc,pd){for(mc=Object(Ga.a)(new jb,{GKf:41,zDe:40,Nsa:mc,Osa:Uc,Eha:pd});Lb<bb.length&&!this.ILf(bb,Lb,mc);++Lb);return mc.rHb}B3i(bb,Lb,mc){for(--Lb;0<=Lb&&!this.ILf(bb,Lb,mc);--Lb);return mc.rHb}ILf(bb,Lb,mc){const Uc=bb.charCodeAt(Lb);0>=this.l3&&(this.l3=bb.substring(0,Lb).lastIndexOf(Lc.a.jU));46===
Uc&&(Lb<this.l3?this.l3=Lb:Lb>this.Ntb&&(this.QY=this.Ntb=Lb));if(!this.wnf(Uc)&&!wf.$vi(Uc)&&(!this.ika||Lb<=this.l3||!wf.Odi(Uc,mc))){mc.yBf&&(mc.yBf=!1,this.F3a=Lb+1);if(mc.PDd){mc.jFd=Lb+1;if(this.functionInfoManager.Igd(bb.substring(mc.jFd,mc.iFd)))return!0;mc.PDd=!1}switch(Uc){case 39:mc.Osa=!mc.Osa;break;case 34:mc.Nsa=!mc.Nsa;break;case 91:mc.Eha=!1;break;case 93:mc.Eha=!0}Uc===this.$.listSeparator.toString().charCodeAt(0)&&mc.Osa&&mc.Nsa&&!mc.s0a&&(!this.ika||mc.Eha)&&(Lb<mc.PPd||-1===mc.PPd)&&
(mc.rHb+=1,this.t6b++);Uc===mc.zDe&&mc.Nsa&&mc.Osa&&(!this.ika||mc.Eha)?mc.s0a+=1:Uc===mc.GKf&&mc.Nsa&&mc.Osa&&(!this.ika||mc.Eha)?0<mc.s0a?--mc.s0a:(mc.PPd=mc.mYe,mc.mYe=Lb,0<Lb&&this.wnf(bb.charCodeAt(Lb-1))&&(mc.PDd=!0,mc.iFd=Lb)):this.ika&&46===Uc&&Lb>this.l3&&(Lb<this.l3?this.l3=Lb:Lb>this.Ntb&&(this.QY=this.Ntb=Lb))}return!1}iGh(bb,Lb,mc,Uc,pd){this.Sac>this.F3a&&0<=this.F3a?Lb||mc||(this.jV=bb.substring(this.F3a,this.Sac)):this.jV=null;Uc!==pd?(bb=bb.substring(pd,Uc),this.KP&&ca.a.equals(this.KP.NameDataStrings,
bb,!0)||(this.mzc=!0),this.KP=this.functionInfoManager.Igd(bb)):(this.mzc=!1,this.KP=null)}Ccg(bb){const Lb=$get(n.CLf+"_"+n.qHb,this.domElement),mc=$get(n.DLf+"_"+n.qHb,this.domElement);bb&&!this.Nec?(Lb&&hb.a.instance.ta(ib.a.click,Lb,this.Aca),mc&&hb.a.instance.ta(ib.a.click,mc,this.Aca),this.Nec=!0):this.Nec&&(Lb&&hb.a.instance.Ba(ib.a.click,Lb,this.Aca),mc&&hb.a.instance.Ba(ib.a.click,mc,this.Aca),this.Nec=!1)}tWj(bb){let Lb;Lb=null;var mc;if(({sheetName:Uc,range:mc}=ja.Y(bb,this.$.ea.va)).returnValue&&
mc){if(!Uc){var Uc=Object(eb.a)(zd.a,this.$.na);if(!Uc)return{returnValue:!1,sheetRange:Lb};Uc=Uc.name}Lb=ja.v(mc,this.$);Lb.SheetName=Uc;this.b8c=!1;return{returnValue:!0,sheetRange:Lb}}return({sheetName:Uc,range:mc}=this.g7b.cWj(bb)).returnValue?(Lb=ja.v(mc,this.$),Lb.SheetName=Uc,this.b8c=!0,{returnValue:!0,sheetRange:Lb}):{returnValue:!1,sheetRange:Lb}}$Od(bb){bb={content:bb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Ika?this.pluginScheduler.getRequester().runAuthoringExperiment(bb,
0):this.pluginScheduler.requester().runAuthoringExperiment(bb)}bnd(){if(1===this.Qg.UV.length&&this.$q.length){var bb=this.$q[this.Qg.UV[0]];if(1===bb.itemType){var Lb=bb.name;bb=this.eb.text;Lb=Lb.substring(bb.length,Lb.length);Lb.length&&(this.eb.text=bb+Lb,this.eb.textBox.selectRange(bb.length,this.eb.text.length))}}else v.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Qg.UV.length})`)}Glc(bb,Lb,mc,Uc){const pd={};pd.a=bb;
pd.b=Lb;pd.c=mc;pd.d=Uc;ze.b().Te(38,pd,!0)}Ive(bb,Lb){if(!this.functionInfoManager.cV){if(bb)if(this.HFd(this.eb.text,this.eb.textBox.caretPosition),this.QSa||this.jV){const mc={};mc.Filter=this.jV?this.jV.charAt(0).toString():"";mc.FilterType=1;mc.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.dJa(mc)}else E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!Lb)return}0<this.$.qb.gR||this.eb&&!this.eb.fb?
this.set_visible(!1):bb&&(this.HFd(this.eb.text,this.eb.textBox.caretPosition),this.bja.update(this.KP,this.t6b,this.FSc,this.mzc),this.f5=this.eb.text.substring(1,this.eb.textBox.caretPosition),this.l3=this.f5.indexOf(Lc.a.jU),this.QY=this.f5.lastIndexOf(Lc.a.jU),this.D3i()?(bb=new ec,bb.cAj(),this.GGa=this.U7=bb=[bb],this.Qg.i0j(bb),this.show()):((this.LEh()||this.Rwa())&&this.cHe(!1),0<this.QY?this.Qg.HJa(this.$q,this.f5,!1,void 0,this.f5.lastIndexOf(Lc.a.jU),!1):this.Qg.HJa(this.$q,this.jV,!1,
void 0,this.QY,!1),this.show(),this.Nk&&(this.Qg.To.length||this.gridView.li.BK?this.bja.M7b():(this.bja.qNd(),this.Nk&&this.T1a()))))}o$f(){if(0<this.Qg.To.length){this.formulaAssistanceTelemetryManager.BD(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const bb={};bb.zoomLevel=Y(this.$);this.formulaAssistanceUIControl.updateContext(bb);this.Ao=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.v1b,this.gridView.li.textBox.domElement,this.icc(),()=>{})};this.Ao();this.Nk&&
this.Qg.Ejc&&this.raiseEvent(wf.Ndd,null);this.$od||this.Qg.Ejc||this.raiseEvent("FormulaAutoCompleteShown");this.$od=this.wq.Ff=!0}this.formulaAssistanceTelemetryManager.dw(["autoCompleteRender"]);E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.mI&&this.wkf&&(this.W$=!0)}}rwd(){this.LIa&&(this.formulaAssistanceTelemetryManager.aJ.selectByArrowKeyCounter++,this.LIa=!1);this.MIa&&(this.formulaAssistanceTelemetryManager.aJ.selectByMouseHoverCounter++,this.MIa=
!1);this.KIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByTabKeyCounter++,this.KIa=!1);this.IIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByEnterKeyCounter++,this.IIa=!1);this.JIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByMouseClickCounter++,this.JIa=!1);E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.jia&&(this.formulaAssistanceTelemetryManager.aJ.dismissSmartSuggestionExplicitlyCounter++,this.jia=!1)}icc(){const bb=new Ge;bb.completionItems=
this.Qg.Krb;bb.activeItemIndex=this.Qg.Ej?this.Qg.Ej.rowIndex:-1;this.MKd(bb);return bb}MKd(bb){bb.callbacks=new ff;bb.callbacks.onCompletionItemSelected=this.BCd;bb.callbacks.onCompletionItemCommitted=this.ACd;bb.callbacks.onFeedback=this.FRa;bb.callbacks.onDismiss=this.onDismiss;bb.callbacks.onRestoreFocus=this.onRestoreFocus}sHd(bb){this.ufa=!0;const Lb=bb.textEdit.newText;this.eb.teb(Lb.substring(this.eb.text.length-bb.textEdit.range.start.character,Lb.length))}OEe(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.dw(["autoCompleteSmartSuggestionAccepted"]);this.My(!0);this.ufa=this.re=!1;this.RSa=this.Yna=!0}mod(bb,Lb){this.eb.text=bb.substring(0,Lb.range.start.character)+Lb.newText+bb.substring(Lb.range.end.character,bb.length);this.gridView.Ql&&(this.gridView.Vb.text=this.eb.text)}static bPd(bb){E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?bb.getRequester().runExperiment(new af,0):bb.requester().runExperiment(new af)}static g$g(bb){const Lb=
ec.Pgh(),mc={IsCompatibility:!1};mc.NameDataStrings=bb.label;mc.Help=bb.detail;Lb.S4f(mc);Lb.textEdit=bb.textEdit;return Lb}static eKa(){const bb=String.format(n.VKh,n.hed,fd.a.mSe),Lb=String.format(n.RKh,n.fed,Fc.a.A9b,r.a.fo,r.a.eo),mc=String.format(n.NKh,n.aed,Fc.a.A9b,r.a.fo,Fc.a.fTe,r.a.eo);return`${bb}
${Lb}
${mc}`}static $vi(bb){return 36===bb||58===bb||33===bb||39===bb||32===bb}static Odi(bb,Lb){return 32===bb||91===bb||!Lb.Eha}}wf.Ndd="FACardOpened";wf.ldd="FAFocusOnSmartSuggestionsCard";wf.tfc=null;Object(d.a)(wf,"FormulaAssistanceControl",wc.a,[313,265,2,294,314]);class cf{constructor(bb){this.fv=bb;this.SA=this.oSa=this.Bi=!1;this.onKeyDown=Lb=>this.SA||"Space"!==Lb.code&&" "!==Lb.key||!Lb.altKey||!Lb.ctrlKey?!1:(this.A2a(),Lb.stopPropagation(),Lb.preventDefault(),!0);this.cla=Lb=>{if(!this.SA)return!1;
if(Lb.eventName===ib.a.Sb){const mc=Lb.Ea.ctrlKey?1:Lb.Ea.shiftKey?50:10;switch(Lb.Ea.keyCode){case we.a.Poa:this.oK(0,-mc);break;case we.a.K7:this.oK(0,mc);break;case we.a.L7:this.oK(-mc,0);break;case we.a.bCa:this.oK(mc,0);break;case we.a.XF:case we.a.Jh:this.oSa=!0;break;default:return!1}}Lb.eventName===ib.a.Kd&&this.oSa&&this.rM(!0);Lb.Ea.preventDefault();return!0};this.fza=Lb=>{if(!this.SA)return!1;Lb.Ea.preventDefault();this.rM();return!0};this.onBlur=()=>{if(!this.SA)return!1;this.rM();return!0};
this.qo=Pe.KeyInputManager.instance;this.pointerInputManager=ae.a.instance}ka(bb){(this.root=bb)&&!this.Bi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Bi=!0)}detach(){this.root&&this.Bi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Bi=!1)}A2a(){this.root&&(this.fv.GGb("move",!0),this.root.focus(),this.SA=!0,this.oSa=!1,this.Et(),this.gya||this.wsb(),this.root.appendChild(this.gya))}rM(bb=!1){this.SA&&(this.SA=!1,this.fv.Voc(bb),this.tJb(),this.jJb())}Et(){this.qo.capture(this.cla,
null);this.pointerInputManager.ms(ib.a.pointerDown,this.root,this.fza,!0);this.root.addEventListener("blur",this.onBlur)}jJb(){this.qo.releaseCapture();this.pointerInputManager.ys(ib.a.pointerDown,this.root,this.fza,!0);this.root.removeEventListener("blur",this.onBlur)}tJb(){var bb;null===(bb=this.gya)||void 0===bb?void 0:bb.remove()}oK(bb,Lb){const mc=this.fv.getPosition();mc.x+=bb;mc.y+=Lb;this.fv.setPosition(mc)}wsb(){this.gya=qf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(d.a)(cf,"FormulaAssistanceMoveAdapter",null,[]);class vf{constructor(bb){this.fv=bb;this.startOffset={x:0,y:0};this.ibg=!0;this.Bi=!1;this.aZc=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}y4(){return this.Bi&&!!this.QC}Bya(bb){this.aZc||(this.QC.style.cursor="grabbing");const Lb=this.fv.getPosition();this.ibg=Lb.renderDown;this.startOffset.x=Lb.x-bb.clientPoint.x;this.startOffset.y=Lb.y-bb.clientPoint.y;this.fv.GGb("drag");
return!0}yca(bb){this.fv.setPosition({x:bb.clientPoint.x+this.startOffset.x,y:bb.clientPoint.y+this.startOffset.y,renderDown:this.ibg});return!0}xca(){this.cw()}wca(){this.cw()}ka(bb,Lb){this.QC=Lb;this.root=bb;this.QC&&(this.QC.style.cursor=this.aZc?"move":"grab",Qe.a.instance.fW(this.QC,this,!1),this.Bi=!0)}detach(){this.Bi&&this.QC&&(this.QC.style.cursor="",Qe.a.instance.J0(this.QC,this),this.Bi=!1)}cw(){this.aZc||(this.QC.style.cursor="grab")}}Object(d.a)(vf,"FormulaAssistanceDragAdapter",null,
[307]);class ag{get getPosition(){return this.dxg}get setPosition(){return this.Cje}constructor(bb){this.formulaAssistanceTelemetryManager=bb;this.Bi=!1;this.zGa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.O0={[tc.Drag]:0,[tc.Move]:0};this.AEb=new cf(this);this.Ptb=new vf(this)}ka(bb,Lb,mc,Uc){this.dxg=mc;this.Cje=Uc;this.AEb.ka(bb);this.Ptb.ka(bb,Lb);this.Bi=!0}detach(){this.Bi&&(this.Ptb.detach(),this.AEb.detach(),this.Bi=!1)}clear(){var bb;
null===(bb=this.Cje)||void 0===bb?void 0:bb.call(this,null);this.detach();this.kKb()}GGb(bb,Lb=!1){this.O0[bb]++;Lb&&(this.TPa=document.activeElement)}Voc(bb=!0){this.TPa&&(bb&&this.TPa.focus(),this.TPa=null)}kKb(){const bb=this.formulaAssistanceTelemetryManager.hP,Lb=this.O0[tc.Drag],mc=this.O0[tc.Move];0<Lb&&(this.formulaAssistanceTelemetryManager.VI("d"),this.zGa||(bb.argumentAssistanceDragTotalCounter+=Lb),this.O0[tc.Drag]=0);0<mc&&(this.formulaAssistanceTelemetryManager.VI("m"),this.zGa||(bb.argumentAssistanceMoveTotalCounter+=
mc),this.O0[tc.Move]=0)}}Object(d.a)(ag,"FormulaAssistanceDragControl",null,[]);var tc;(function(bb){bb.Drag="drag";bb.Move="move"})(tc||(tc={}));Object(d.b)("FormulaAssistanceDragMode",tc);class Yc extends wd.a{constructor(bb,Lb,mc){super(Yc.eKa());this.$=bb;this.formulaAssistanceUIControl=Lb;this.formulaAssistanceTelemetryManager=mc;this.showCollapseText=this.isExpanded=!0;this.P9=0;this.gla=this.Ao=this.wq=null;this.Ru=!1;this.setPosition=Uc=>{this.formulaAssistanceUIControl.setFixedPosition(Uc);
this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Uc=()=>{this.visible=!1};this.onCardModeChange=Uc=>{this.U_d(Uc);this.showCollapseText=!1;1===Uc?this.formulaAssistanceTelemetryManager.VI("c"):this.formulaAssistanceTelemetryManager.VI("e")};this.onIsExpandedChange=Uc=>{this.X_j(Uc);this.showCollapseText=!1;Uc?this.formulaAssistanceTelemetryManager.VI("e"):this.formulaAssistanceTelemetryManager.VI("c")};this.FRa=Uc=>{L(this.$,
"ArgumentAssistanceCard",Uc.functionName);this.formulaAssistanceTelemetryManager.VI("gf")};this.zt=()=>{this.E4?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Ao&&null!==this.Ao&&this.Ao()};this.$f=()=>{this.E4?this.fv.clear():this.b9c.clear()};this.E4=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.GRd();this.wq=new ge(this.$,this.formulaAssistanceUIControl,0,zb.a.Fdd);this.grid=Object(H.h)(bb);this.grid.view.Ps(this.zt);this.grid.ha.cC(this.Uc);
this.E4?this.fv=new ag(this.formulaAssistanceTelemetryManager):this.b9c=new Re(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.grid.mc.Jm(this.$f);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Hqe(bb){this.addHandler("FAFunctionNameUpdated",bb)}jWf(bb){this.removeHandler("FAFunctionNameUpdated",bb)}zre(bb){this.addHandler("FAParameterSelectionChangedOld",bb)}HWf(bb){this.removeHandler("FAParameterSelectionChangedOld",
bb)}yre(bb){this.addHandler("FAParameterSelectionChanged",bb)}GWf(bb){this.removeHandler("FAParameterSelectionChanged",bb)}get visible(){return this.Ru}set visible(bb){bb||this.dismiss();this.Ru=bb}dismiss(){this.Ru=!1;this.formulaAssistanceUIControl&&(this.Ao=null,this.E4?this.fv.detach():this.b9c.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.gla=null,this.wq.Ff=!1)}lKj(bb,Lb){this.Ru=!0;const mc=this.nsc(bb);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceRender"]);
bb={};bb.zoomLevel=Y(this.$);this.formulaAssistanceUIControl.updateContext(bb);const Uc=()=>{};E.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Ao=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Lb,mc,Uc)},this.Ao()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Lb,mc,Uc);this.svc();this.Erc(mc);this.b9c.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Ao,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.wq.Ff=!0;this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.dua("argumentAssistanceOverall")}}show(bb,Lb){this.E4?this.mKj(bb):this.lKj(bb,Lb)}mKj(bb){this.Ru=!0;const Lb=this.nsc(bb);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceRender"]);const mc=()=>c(this.$);this.Ao=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
void 0,Lb,mc)};this.Ao();this.svc();this.Erc(Lb);this.fv.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.wq.Ff=!0;this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.dua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.sB(this.Uc),this.grid.view.Jq(this.zt),this.grid.mc.$l(this.$f));ka.a.Ja(this.wq);
this.$=null}nsc(bb){const Lb=new te;Lb.functionRenderingInfo=bb;Lb.showCollapseText=this.showCollapseText;this.E4?Lb.isExpanded=this.isExpanded:Lb.cardMode=this.P9;this.QKd(Lb);return Lb}QKd(bb){bb.callbacks=new ce;bb.callbacks.onHelpLink=this.Sgd(bb.functionRenderingInfo);this.E4?bb.callbacks.onIsExpandedChange=this.onIsExpandedChange:bb.callbacks.onCardModeChange=this.onCardModeChange;bb.callbacks.onFeedback=this.FRa}Sgd(bb){return()=>{M(this.$,bb.helpID,bb.isUDF)}}GRd(){const bb=jd.a.get(C.a.epb);
this.E4?(bb?(this.isExpanded="false"!==bb,this.showCollapseText=!1):(this.isExpanded=Yc.Pjh,this.formulaAssistanceTelemetryManager.y3f()),this.formulaAssistanceTelemetryManager.Iwj(this.isExpanded)):(bb?(this.P9=parseInt(bb,10),this.showCollapseText=!1):(this.P9=Yc.T7c,this.formulaAssistanceTelemetryManager.y3f()),this.formulaAssistanceTelemetryManager.z3f(this.P9))}Erc(bb){var Lb=bb.functionRenderingInfo.functionName;this.gla&&ca.a.equals(this.gla,Lb,!0)?(Lb=nd.a.map(bb.functionRenderingInfo.signatures,
mc=>{let Uc="";0<=mc.signatureParams.activeParam&&mc.signatureParams.activeParam<mc.signatureParams.params.length&&(Uc=mc.signatureParams.params[mc.signatureParams.activeParam]);return Uc}),this.raiseEvent("FAParameterSelectionChanged",new jc(Lb))):(this.gla=Lb,bb=nd.a.map(bb.functionRenderingInfo.signatures,mc=>mc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Td(Lb,bb)))}U_d(bb){this.P9=bb;try{jd.a.Av(C.a.epb,bb.toString(),vd.AFrame.H0)}catch(Lb){v.ULS.sendTraceTag(537162074,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Lb.message}`)}}X_j(bb){this.isExpanded=bb;try{jd.a.Av(C.a.epb,bb.toString(),vd.AFrame.H0)}catch(Lb){v.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Lb.message}`)}}static eKa(){return document.createElement("div")}svc(){const bb=this.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.VI(bb)}}Yc.T7c=0;Yc.Pjh=!0;Object(d.a)(Yc,
"FormulaArgumentAssistanceControl",wd.a,[295]);var fb;(function(bb){bb[bb.Dismissed=0]="Dismissed";bb[bb.Smart=1]="Smart";bb[bb.Simple=2]="Simple";bb[bb.Mixed=3]="Mixed"})(fb||(fb={}));Object(d.b)("UIState",fb);class Hb extends wd.a{constructor(bb,Lb,mc){super(Hb.eKa());this.$=bb;this.formulaAssistanceUIControl=Lb;this.formulaAssistanceTelemetryManager=mc;this.wq=this.eb=this.gridView=null;this.W$=this.jia=this.JIa=this.IIa=this.KIa=this.MIa=this.LIa=!1;this.$q=null;this.vW=0;this.Ao=null;this.RSa=
this.Yna=this.mI=this.ufa=this.Ru=!1;this.vPb=fb.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.Ru=!1;this.a7a&&this.mI&&this.zMa&&(this.W$=!0);this.rwd();this.dF&&this.eb.fb&&this.Sma();this.Ao=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.wq.Ff=!1,this.vPb=fb.Dismissed)};this.ikd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.Dca=(Uc,pd)=>{0==pd.sr&&(170==pd.Lf.operation.operationName&&this.formulaAssistanceTelemetryManager.clc++,
this.$.userOperationManager.zo(this.Dca))};this.aPa=(Uc,pd)=>{0==pd.sr&&(12==pd.Lf.operation.operationName&&this.$.userOperationManager.Lr(this.Dca),this.$.userOperationManager.zo(this.aPa))};this.JQi=()=>{this.dismiss();this.gridView.li.textBox.focus()};this.FRa=()=>{const Uc={};Uc[C.a.sM]=this.qKf?"SmartSuggestionsCard":this.TVd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Zc(802602464,0,8,Uc)};this.$f=()=>{E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",
!1)&&1===this.formulaAssistanceTelemetryManager.XG.smartSuggestionShownCounter&&this.mI&&this.$.Zc(1073817162,-1,0,null);this.zMa&&this.jQg()};this.BCd=(Uc,pd)=>{this.sgb(pd);this.MIa=!0};this.Uc=()=>{this.visible=!1};this.ACd=Uc=>{this.JIa=!0;this.Frb(Uc)};this.ij=()=>{this.dismiss()};this.zt=()=>{this.E4?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Ao&&null!==this.Ao&&this.Ao()};this.gridView=H.h(this.$);this.wq=new ge(this.$,this.formulaAssistanceUIControl,1,zb.a.Hdd,this.ikd);
this.gridView.view.Ps(this.zt);this.gridView.ha.cC(this.Uc);this.$.va.Vf(this.ij);this.zMa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.E4=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.a7a=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.zMa&&this.gridView.mc.Jm(this.$f);
E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Fqe(bb){this.addHandler("FACardOpened",bb)}iWf(bb){this.removeHandler("FACardOpened",bb)}Dqe(bb){this.addHandler("FAFocusOnSmartSuggestionsCard",bb)}gWf(bb){this.removeHandler("FAFocusOnSmartSuggestionsCard",bb)}Eqe(bb){this.addHandler("FormulaAutoCompleteShown",bb)}hWf(bb){this.removeHandler("FormulaAutoCompleteShown",bb)}BXc(bb){this.addHandler("SelectedRowChanged",
bb)}nMd(bb){this.removeHandler("SelectedRowChanged",bb)}E_b(bb){this.addHandler("ListBoxUpdated",bb)}Guc(bb){this.removeHandler("ListBoxUpdated",bb)}dispose(){this.$&&(this.$.userOperationManager.zo(this.Dca),this.$.userOperationManager.zo(this.aPa),this.gridView&&(this.gridView.ha&&this.gridView.ha.sB(this.Uc),this.gridView.mc&&this.zMa&&this.gridView.mc.$l(this.$f),this.gridView.view.Jq(this.zt)),this.$.va&&this.$.va.sg(this.ij));ka.a.Ja(this.wq);this.$=null}ZLg(bb){this.addHandler("CVIC",bb)}Tij(bb){this.removeHandler("CVIC",
bb)}get visible(){return this.Ru}set visible(bb){bb||this.dismiss();this.Ru=bb}get dF(){return this.ufa}get TVd(){var bb,Lb;return 1===(null===(Lb=null===(bb=this.$q)||void 0===bb?void 0:bb.items[0])||void 0===Lb?void 0:Lb.type)}get qKf(){return 1===this.$q.items.length&&this.TVd}Mh(bb,Lb){if(!this.visible)return!1;this.yDc(Lb);let mc;return(mc=this.h$h(Lb)).rec?mc.result:this.cFj(Lb)}eyb(bb){if(!this.visible)return!1;let Lb=!1;switch(bb){case 1872288872:this.dF&&this.Sma();this.a7a&&this.TVd&&(this.formulaAssistanceTelemetryManager.dw(["autoCompleteSmartSuggestionActiveDismissing"]),
this.jia=!0);this.visible=!1;Lb=!0;break;case -798660877:this.sgb(this.Lxb(this.vW+1));Lb=!0;break;case 137938150:this.sgb(this.Lxb(this.vW-1));Lb=!0;break;case 2091832999:this.sgb(this.Lxb(this.vW+8));Lb=!0;break;case 742457698:this.sgb(this.Lxb(this.vW-8));Lb=!0;break;case 125627505:case 267796030:this.Frb(this.$q.items[this.vW]),Lb=!0}return Lb}show(bb){this.eb=this.gridView.li;this.Ru=!0;this.vW=0;this.$q=bb;0<this.$q.items.length&&(this.render(),this.sgb(this.Lxb(this.vW)),this.a7a?this.zMa&&
(1===this.$q.items[0].type?(this.mI||this.formulaAssistanceTelemetryManager.BD(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.mI=!0):this.mI&&(this.W$=!0)):1===this.$q.items[0].type&&this.zMa&&(this.mI=!0));this.formulaAssistanceTelemetryManager.OXf(bb.items)}Sma(){this.ufa=!1;this.eb.xMe()}cFj(bb){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(bb)}h$h(bb){return this.dF?125627505===bb||267796030===bb?(this.Frb(this.$q.items[this.vW]),
{rec:!0,result:!1}):!this.qKf||-798660877!==bb&&137938150!==bb?{rec:!1}:{rec:!0,result:!1}:{rec:!1}}render(){this.formulaAssistanceTelemetryManager.BD(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.E4){const bb=()=>c(this.$);this.Ao=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,this.icc(),bb)}}else{const bb={};bb.zoomLevel=Y(this.$);this.formulaAssistanceUIControl.updateContext(bb);this.Ao=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,
this.eb.textBox.domElement,this.icc(),()=>{})}}this.Ao();this.Baj();this.wq.Ff=!0;this.Srh()}}Srh(){this.formulaAssistanceTelemetryManager.dw(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.dua("autoCompleteOverall");const bb=this.$q.items.some(mc=>1===mc.type),Lb=this.$q.items.some(mc=>0===mc.type);bb&&Lb?this.formulaAssistanceTelemetryManager.dua("autoCompleteOverallSimpleAndSmart"):bb?this.formulaAssistanceTelemetryManager.dua("autoCompleteOverallSmartOnly"):Lb&&this.formulaAssistanceTelemetryManager.dua("autoCompleteOverallSimpleOnly")}Baj(){const bb=
this.vPb;this.vPb=this.z5h(this.$q.items);bb!==fb.Dismissed&&bb!==fb.Smart||this.vPb!==fb.Simple&&this.vPb!==fb.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}jbj(){var bb;if(0!==this.$q.items.length){var Lb=0<=this.vW?this.vW:0,mc=this.$q.items[Lb];mc={EF:mc.label,description:null!==(bb=mc.detail)&&void 0!==bb?bb:"",selectedIndex:Lb+1,length:this.$q.items.length};this.raiseEvent("SelectedRowChanged",mc)}}Frb(bb){if(this.eb&&this.visible){var Lb=bb.textEdit;this.mod(this.eb.text,Lb);this.eb.textBox.caretPosition=
Lb.range.start.character+Lb.newText.length;this.dF&&(this.ufa=!1,this.zMa&&(this.a7a&&this.formulaAssistanceTelemetryManager.dw(["autoCompleteSmartSuggestionAccepted"]),this.RSa=this.Yna=!0),this.pzj(),this.gridView.kaa.p3f(),this.eb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:bb.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.NXf(bb.kind)}}pzj(){this.formulaAssistanceTelemetryManager.BH=
{Yj:this.gridView.ha.qa.activeCell,e3b:this.gridView.Vb.text,Hrb:!0};this.formulaAssistanceTelemetryManager.alc=this.$.va.na.sheetId;this.formulaAssistanceTelemetryManager.XCb=this.$.ea.se;this.$.userOperationManager.Lr(this.aPa)}jQg(){this.a7a&&this.W$&&!this.jia&&!this.Yna&&(this.formulaAssistanceTelemetryManager.aJ.dismissSmartSuggestionImplicitlyCounter++,this.W$=!1);this.mI&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionShownCounter++,this.mI=!1,Object(Qc.a)(Kb.a));this.Yna&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionSelectedCounter++,
this.Yna=!1,Object(Qc.a)(Kb.c));this.RSa&&(this.formulaAssistanceTelemetryManager.XG.smartSuggestionCommittedCounter++,this.RSa=!1)}icc(){const bb=new Ge;bb.completionItems=this.$q.items;bb.activeItemIndex=this.vW;this.MKd(bb);return bb}MKd(bb){bb.callbacks=new ff;bb.callbacks.onCompletionItemSelected=this.BCd;bb.callbacks.onCompletionItemCommitted=this.ACd;bb.callbacks.onFeedback=this.FRa;bb.callbacks.onDismiss=this.JQi;bb.callbacks.onRestoreFocus=this.onRestoreFocus}sHd(bb){this.ufa=!0;const Lb=
bb.textEdit.newText;this.eb.teb(Lb.substring(this.eb.text.length-bb.textEdit.range.start.character,Lb.length))}sgb(bb){const Lb=this.vW;this.vW=bb;const mc=this.$q.items[bb];this.dF&&this.Sma();Lb!==bb&&this.render();1===mc.type&&E.EwaSettings.vb()&&!this.gridView.li.text.includes("\n")&&this.sHd(mc);this.jbj()}Lxb(bb){return 0>bb?0:Math.min(bb,this.$q.items.length-1)}mod(bb,Lb){this.eb.text=bb.substring(0,Lb.range.start.character)+Lb.newText+bb.substring(Lb.range.end.character,bb.length);this.gridView.Ql&&
(this.gridView.Vb.text=this.eb.text)}rwd(){this.LIa&&(this.formulaAssistanceTelemetryManager.aJ.selectByArrowKeyCounter++,this.LIa=!1);this.MIa&&(this.formulaAssistanceTelemetryManager.aJ.selectByMouseHoverCounter++,this.MIa=!1);this.KIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByTabKeyCounter++,this.KIa=!1);this.IIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByEnterKeyCounter++,this.IIa=!1);this.JIa&&(this.formulaAssistanceTelemetryManager.aJ.commitByMouseClickCounter++,this.JIa=
!1);this.a7a&&this.jia&&(this.formulaAssistanceTelemetryManager.aJ.dismissSmartSuggestionExplicitlyCounter++,this.jia=!1)}yDc(bb){switch(bb){case -798660877:case 137938150:case 2091832999:case 742457698:this.LIa=!0;break;case 125627505:this.KIa=!0;break;case 267796030:this.IIa=!0}}static eKa(){return document.createElement("div")}z5h(bb){return bb.reduce((Lb,mc)=>Lb|=0===mc.type?fb.Simple:fb.Smart,fb.Dismissed)}}Object(d.a)(Hb,"FormulaAutoCompleteControl",wd.a,[293,2,294]);class cc{constructor(bb,
Lb){var mc,Uc;this.Og=bb;this.$=Lb;this.tBc=new Map;this.bfb=null;this.Cya=()=>{this.C$b.resolve(this.Og.Pk);this.xhg()};this.rDf=()=>{this.C$b.reject(null);this.xhg()};this.$f=()=>{this.Og.Gcb();this.Nud=null;this.tBc.clear();this.Xme()};this.jDd=(pd,ta)=>{if(ta!==this.Dpf)v.ULS.sendTraceTag(509678923,0,15,"onGetTableColHeadersSuccess called with a tableName different than the one saved for last request"),this.lBa.reject();else if(Object(Dc.a)(pd))this.lBa.reject();else{var rb=pd.Result;Object(X.b)(rb)&&
0!==rb.length?(this.tBc.set(ta,rb),void this.lBa.resolve(pd.Result)):this.lBa.reject()}};this.iDd=()=>{this.lBa.reject()};null===(Uc=null===(mc=H.h(this.$))||void 0===mc?void 0:mc.mc)||void 0===Uc?void 0:Uc.Jm(this.$f);this.GKj=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(bb,Lb,mc,Uc){const pd={j$:bb,uNe:Lb};var ta;if(ta=Object(X.b)(this.Nud))ta=this.Nud,ta=!(pd.j$.FirstRow===ta.j$.FirstRow&&pd.j$.FirstColumn===ta.j$.FirstColumn&&
pd.j$.LastRow===ta.j$.LastRow&&pd.j$.LastColumn===ta.j$.LastColumn&&pd.j$.SheetName===ta.j$.SheetName&&pd.uNe===ta.uNe);ta&&this.Og.Gcb();this.Nud=pd;this.GKj&&this.Og.O6a||this.Og.kZ(bb,mc,Uc,Lb);this.C$b=new X.a;this.Og.O6a?this.C$b.resolve(this.Og.Pk):this.gfj();return this.C$b.promise}getTableColHeaders(bb){if(this.bfb&&3>=this.bfb.status&&bb===this.Dpf)return this.lBa.promise;this.lBa=new X.a;if(this.tBc.has(bb))this.lBa.resolve(this.tBc.get(bb));else{this.Xme();this.Dpf=bb;const Lb=this.$.yb.getItemByName(bb).Gi;
this.bfb=Object(ic.q)(this.$.oa.xa,Lb,mc=>this.jDd(mc,bb),this.iDd,null,null)}return this.lBa.promise}dispose(){var bb,Lb;null===(Lb=null===(bb=H.h(this.$))||void 0===bb?void 0:bb.mc)||void 0===Lb?void 0:Lb.$l(this.$f)}gfj(){this.Og.v_b(this.Cya);this.Og.IMg(this.rDf)}xhg(){this.Og.yuc(this.Cya);this.Og.xjj(this.rDf)}Xme(){Object(X.b)(this.bfb)&&(P.AFrameworkApplication.Bd.Nt(this.bfb.Rs),this.bfb=null)}}Object(d.a)(cc,"ServerDataProvider",null,[290]);var Hc=a(323),od=a(580),Dd=a(345),be=a(891);class Jb{constructor(bb){this.VJ=
this.WJ=this.bF=this.cF=!1;this.QZ=bb}}Object(d.a)(Jb,"MarqueeRangeData",null,[]);class sc{constructor(bb,Lb,mc,Uc=!1){this.nYd=bb;this.IOb=Lb;this.u7a=Uc;mc?(this.QZ=mc.QZ,this.cF=mc.cF,this.bF=mc.bF,this.WJ=mc.WJ,this.VJ=mc.VJ):v.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(sc,"MarqueeMetadata",null,[]);const ed="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class xd{constructor(bb,Lb,mc){this.$=bb;this.pluginScheduler=Lb;this.formulaAssistanceTelemetryManager=mc;this.UJ=this.afb=!1;this.vR=null;this.WMa=E.EwaSettings.WMa();this.vya=()=>{this.UJ=!1;this.vR=null};this.gridView=H.h(bb);this.gridView.Vb.Jm(this.vya);this.Z7a=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1)}get coloredReferencesManager(){this.oVa||(this.oVa=this.$.da.Aa(281));return this.oVa}QWj(bb,Lb,mc){return isNullOrUndefined(this.coloredReferencesManager)?
!1:this.coloredReferencesManager.Ufb(bb,Lb,mc)}Ufb(bb,Lb,mc){var Uc;bb.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.afb||bb.dF)return!1;const pd=isNullOrUndefined(Lb)?bb.text:Lb;if(1>=pd.length)return this.ckg(bb,pd,Object(X.b)(Lb));mc=this.K5h(bb,Lb,mc);mc=null===(Uc=this.u4a(pd,mc))||void 0===Uc?void 0:Uc.formulaHighlights;if(!mc)return v.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),
this.ckg(bb,pd,Object(X.b)(Lb));const {fRj:ta,Qbj:rb,Obj:gc,pGi:Pc}=this.AWh(mc,pd);this.xyc(bb,ta,!!Lb);Lb=bb.textBox.text;if(!ca.a.equals(Lb,pd,!1))return v.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Lb.length}], updatedTextLength [${pd.length}]`),Lb=bb.textBox.caretPosition,bb.textBox.text=pd,bb.textBox.caretPosition=Lb,!0;this.az(rb,gc,Pc);return this.UJ=
!0}CEb(bb,Lb,mc){if(!bb||!Lb||!mc)return v.ULS.shipAssertTag(512349463,0,!!bb,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),v.ULS.shipAssertTag(512349462,0,!!Lb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),v.ULS.shipAssertTag(512349461,0,!!mc,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const Uc=Object(eb.a)(sc,Lb.metadata);if(!Uc)return v.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),
!1;var pd=Uc.nYd,ta=Uc.IOb,rb=this.gridView.wb.fqd(mc)?mc.Iwb(Uc.bF,Uc.cF):mc.KKa(Uc.bF,Uc.cF,Uc.VJ,Uc.WJ);if(!rb)return v.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const gc=ta.indexOf("!");-1!==gc&&(rb=ta.substring(0,gc+1)+rb);if(!bb.textBox.changeTextInExistingTextPart(pd,ta,rb))return v.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;Uc.IOb=rb;pd=!0;for(ta=1;4>=ta;ta++)(rb=H.h(this.$).Cb.KC(3,
ta,Lb.KT))?(rb.range=mc,rb.metadata=Uc):(v.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),pd=!1);this.gridView.Cb.update(!1,!1);this.gridView.Ql&&(this.gridView.mc.textBox.text=bb.text);this.gridView.mc.ZPa(new Hc.a({wAb:!0}));return pd}Dqi(bb){if(3!==bb.yq)return v.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;bb=Object(eb.a)(sc,bb.metadata);return bb?bb.QZ&&
!bb.u7a:(v.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}iBa(bb,Lb){v.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(Lb?"suspending":"resuming")+" colored references");Lb&&this.UJ&&(this.UJ=!1,this.az(null,null),bb.textBox.ECe());this.afb=Lb}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.$l(this.vya)}Yyb(bb){this.formulaAssistanceTelemetryManager.BD(["highlightPreviewRanges"]);
var Lb=this.u4a(bb,be.a);if(isNullOrUndefined(Lb))this.Ogc&&this.az(null,null);else{var mc=this.Fja(),Uc=[],pd=new Mc.a(!1),ta=[];Lb=Lb.formulaHighlights;for(const rb of Lb)if(Lb=rb.kind,0===Lb||2===Lb||1===Lb)Lb=ja.B(rb.rangeInfo.sharedRange),Object(X.b)(Lb)&&(Uc.push(new Dd.a(Lb,mc)),this.jZ(Lb,pd,1),ta.push(new sc(rb.span.start,bb.substring(rb.span.start,rb.span.end),e(rb),!0)));this.az(Uc,pd,ta);this.formulaAssistanceTelemetryManager.dw(["highlightPreviewRanges"],!0)}}R_j(bb,Lb){bb&&this.formulaAssistanceTelemetryManager.Iac.formulaHighlightsCounter++;
Lb&&this.formulaAssistanceTelemetryManager.Iac.parenthesesCouplingCounter++}ckg(bb,Lb,mc){this.az(null,null);if(this.UJ){this.UJ=!1;if(!this.WMa){const Uc=bb.textBox.caretPosition;bb.textBox.setPlainText(Lb);bb.textBox.caretPosition=Math.min(Uc,Lb.length)}if(mc)return!0}return!1}K5h(bb,Lb,mc){let Uc=mc;Object(X.b)(Lb)?Object(X.b)(mc)||(Uc={index:Lb.length,length:0}):Uc=bb.textBox.selection;return Uc}u4a(bb,Lb){if(this.Z7a&&this.Msi({content:bb,selection:Lb}))return this.vR.result;this.formulaAssistanceTelemetryManager.BD(["formulaHighlightsRequest"]);
const mc=this.pluginScheduler.syncRequester().formulaHighlighting({content:bb,caretPosition:Lb.index,selectionLength:Lb.length});this.Z7a&&(this.vR={content:bb,selection:Lb,result:mc});this.formulaAssistanceTelemetryManager.dw(["formulaHighlightsRequest"]);return mc}jZ(bb,Lb,mc){let Uc=Lb.getItem(bb.toString());Uc||(Uc=ed[Lb.count%ed.length],Lb.add(bb.toString(),Uc));return String.format(Uc,mc)}eE(bb,Lb,mc,Uc,pd=null,ta=null){v.ULS.shipAssertTag(512349453,0,mc<=Uc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");
mc<Uc&&(Lb=Lb.substring(mc,Uc),bb.push(Object(Ga.a)(new od.a,{text:Lb,color:pd,backgroundColor:ta})))}az(bb,Lb,mc=null){bb&&bb.length?(v.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+bb.length),bb.reverse(),mc.reverse(),this.gridView.Cb.xB(bb,[3],!0,(Uc,pd)=>{if(Uc&&Uc.range&&pd){v.ULS.shipAssertTag(512349448,0,Lb.hb(Uc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${Uc.range.toString()}' doesn't exist in the range to color dictionary`);
var ta=this.jZ(Uc.range,Lb,.1),rb=this.jZ(Uc.range,Lb,1);this.$.frame&&this.$.frame.TC&&this.$.frame.TC.SM||(pd.style.background=ta);pd.style.borderColor=rb;mc&&(pd.setAttribute(C.a.W5a,Uc.KT.toString()),Uc.metadata=mc[Uc.KT])}else v.ULS.shipAssertTag(512349451,0,!!Uc,"FormulaHighlightsControl.HighlightRanges: state is null"),v.ULS.shipAssertTag(512349450,0,!!Uc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),v.ULS.shipAssertTag(512349449,0,!!pd,"FormulaHighlightsControl.HighlightRanges: div is null")})):
(bb=this.$.Jb.Gc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Cb.Nj([3]),this.gridView.Cb.XRa(new Dd.a(null,this.Fja()),[3]),bb.stop())}xyc(bb,Lb,mc){const Uc=bb.textBox;Uc.XE=!0;var pd=Uc.selection;const ta=pd.index;pd=ta+pd.length;Uc.setTextFromTextParts(Lb);Lb=Uc.text.length;Uc.selectRange(Math.min(ta,Lb),Math.min(pd,Lb));mc&&bb.ZPa(new Hc.a);Uc.XE=!1}Rcc(){return this.gridView.Gq&&this.gridView.Gq.qF?this.gridView.Gq.qF:this.$.na}Fja(){return this.Rcc().sheetId}AWh(bb,Lb){const mc=
[],Uc=new Mc.a(!1),pd=[],ta=[],rb=[];let gc=!1;var Pc=!1;let hd=0;const Cd=this.Fja();for(const Zd of bb){this.eE(pd,Lb,hd,Zd.span.start,null);switch(Zd.kind){case 0:case 1:case 2:bb=ja.B(Zd.rangeInfo.sharedRange);if(isNullOrUndefined(bb)){v.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${Zd.kind.toString()}`);this.eE(pd,Lb,Zd.span.start,Zd.span.end,null);break}Pc=this.jZ(bb,Uc,1);this.eE(pd,Lb,
Zd.span.start,Zd.span.end,Pc);mc.push(new Dd.a(bb,Cd));ta.push({Start:Zd.span.start,End:Zd.span.end});Pc=pd.length-1;rb.push(new sc(Pc,pd[Pc].text,e(Zd)));Pc=!0;break;case 3:this.eE(pd,Lb,Zd.span.start,Zd.span.end,null,"rgba(229, 229, 229, 1)"),gc=!0}hd=Zd.span.end}this.eE(pd,Lb,hd,Lb.length);this.R_j(Pc,gc);return{fRj:pd,Qbj:mc,Obj:Uc,pGi:rb}}Msi(bb){return Object(X.b)(this.vR)&&this.vR.content===bb.content&&this.vR.selection.index===bb.selection.index&&this.vR.selection.length===bb.selection.length}}
Object(d.a)(xd,"FormulaHighlightsControl",null,[277,2]);class le{constructor(bb,Lb,mc,Uc,pd,ta,rb){this.$=bb;this.functionInfoManager=Lb;this.calcManager=mc;this.pluginScheduler=Uc;this.formulaAssistanceUIControl=pd;this.formulaAssistanceTelemetryManager=ta;this.Og=rb;this.jMa=this.isCellContentOnlyEqualDuringEdit=!1;this.Qba=null;this.hla=-1;this.Pca=0;this.Ika=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Scd=E.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.C0d=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.cmf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7395449_isSendingSchedulerWorkbookClosingNotificationEnabled");this.uc=(gc,Pc)=>{Pc.Bf||Pc.cqd||this.pluginScheduler.notifier().notifyWorkbookClosing()};this.Eh=(gc,Pc)=>{this.gridView.fb||this.gridView.Uh||this.eFb(null===Pc||void 0===Pc?void 0:Pc.cell)};this.onFunctionInfoLoaded=()=>{this.Scd||this.functionInfoManager.hcb(this.onFunctionInfoLoaded);
this.mkg();this.yda()};this.Ozf=(gc,Pc)=>{var hd=this.eb;gc=hd.text;hd=hd.textBox.caretPosition;0<this.Pca&&this.formulaAssistanceTelemetryManager.aJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.BD(["argumentAssistanceComputation","argumentAssistanceOverall"]);Pc.shouldRequestAutocompleteOnCommit?this.y2f(gc,hd):this.qNd(gc,hd)};this.$f=()=>{this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.XG.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=
!1);this.jMa&&(this.formulaAssistanceTelemetryManager.XG.isCellContentFormulaCounter++,this.jMa=!1);E.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.N7b()};this.U5=(gc,Pc)=>{this.$Od(Pc.newValue)};this.vj=()=>{this.hjg()};this.hjg=()=>{const gc=this.g7b.VKe;this.pluginScheduler.notifier().setDefinedNamesInfo(gc);v.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===gc||void 0===gc?void 0:gc.length} names}`)};
this.u4a=(gc,Pc)=>{gc=this.pluginScheduler.syncRequester().formulaHighlighting({content:gc,caretPosition:null===Pc||void 0===Pc?void 0:Pc.index,selectionLength:null===Pc||void 0===Pc?void 0:Pc.length});if(isNullOrUndefined(gc)||isNullOrUndefined(gc.formulaHighlights))v.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(gc)}`);else return gc};this.functionInfoManager=Lb;
this.formulaAssistanceUIControl=pd;this.pluginScheduler=Uc;this.gridView=H.h(this.$);this.pkf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.eBd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.r_c=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.pkf&&(this.g7b=new cd(bb),this.gridView.Ca.Rv(this.vj),this.hjg());this.bWa=new Yc(this.$,this.formulaAssistanceUIControl,
this.formulaAssistanceTelemetryManager);this.t8=new Hb(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.bpi=ba.a.qH(bb);this.xLj=ba.a.Cpb(bb);this.Dli=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.mui=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.bpi&&(this.eqa=new xd(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));bb.da.Ha(464,this);this.calcManager=
mc;ba.a.bV(this.$)&&this.Ynd();this.gridView.mc.Jm(this.$f);this.Scd&&(this.functionInfoManager.YFa(this.onFunctionInfoLoaded),this.functionInfoManager.cV?this.mkg():this.functionInfoManager.dJa({}))}get dja(){return this.t8}get zZe(){return this.bWa}get IA(){return this.eqa}get OHb(){return this.eb.jsi?1:0}get eb(){return this.gridView.li}get wb(){return this.gridView.wb}dispose(){if(this.$){const bb=this.gridView;bb&&(bb.ha&&ba.a.bV(this.$)&&bb.ha.Tma(this.Eh),this.pkf&&bb.Ca&&bb.Ca.Mw(this.vj));
this.cmf&&this.$.ol(this.uc)}this.gridView.mc.$l(this.$f);this.t8.Tij(this.Ozf);this.functionInfoManager&&this.functionInfoManager.hcb(this.onFunctionInfoLoaded);ba.a.Pgc&&this.eb&&this.eb.FJb(this.U5);ka.a.Ja(this.bWa);ka.a.Ja(this.t8);this.t8=this.bWa=this.functionInfoManager=this.$=null}Qnj(){this.hla=-1;this.Qba=null}N7b(){this.t8.visible=!1;this.bWa.visible=!1}Mh(){this.yda();return!1}yda(){if(!this.eb.BK)if(this.formulaAssistanceTelemetryManager.Jpb.formulaAssistanceRequestAttemptedCounter++,
this.PFj()){this.Scd||this.functionInfoManager.cV||(this.functionInfoManager.YFa(this.onFunctionInfoLoaded),this.functionInfoManager.dJa({}));var bb=this.eb,Lb=bb.text;bb=bb.textBox.caretPosition;Lb.startsWith("=")&&(this.jMa=!0,1===Lb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));this.formulaAssistanceTelemetryManager.BD("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" "));
this.y2f(Lb,bb);this.Dli&&this.Dnj(Lb,bb)}else this.formulaAssistanceTelemetryManager.Jpb.formulaAssistanceRequestOptimizedCounter++}y2f(bb,Lb){const mc=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:bb,caretPosition:Lb},argumentAssistance:{content:bb,caretPosition:Lb},inCellSuggestion:{content:bb,caretPosition:Lb}});this.Pca+=1;this.C0d&&(this.Qba=bb,this.hla=Lb);mc.then(Uc=>{--this.Pca;0===Uc.kind&&(this.R9e(Uc.payload.argumentAssistance),
this.h9h(Uc.payload.functionSuggestion,bb));return null})}Dnj(bb,Lb){Lb={content:bb,caretPosition:Lb,enableAutocompleteWrapperPlugin:this.mui&&!this.xLj};this.Ika&&(Lb=this.pluginScheduler.getRequester().runPerCharacterExperiment(Lb,this.OHb),this.Pca+=1,Lb.then(mc=>{--this.Pca;if(0===mc.kind)for(const Uc of mc.payload.results)0===Uc.kind&&this.gridView.kaa.LRd(Uc.value,bb);return null}))}qNd(bb,Lb){const mc={content:bb,caretPosition:Lb};this.C0d&&(this.Qba=bb,this.hla=Lb);bb=this.Ika?this.pluginScheduler.getRequester().argumentAssistance(mc,
this.OHb):this.pluginScheduler.requester().argumentAssistance(mc);this.Pca+=1;bb.then(Uc=>{--this.Pca;0===Uc.kind&&this.R9e(Uc.payload)})}PFj(){var bb=this.eb;const Lb=bb.text;bb=bb.textBox.caretPosition;if(this.t8.visible&&ca.a.equals(Lb,this.Qba,!0)&&!Qb.e(Lb)&&bb===this.hla)return!1;this.C0d||(this.Qba=Lb,this.hla=bb);return!0}bPd(){this.Ika?this.pluginScheduler.getRequester().runExperiment(new af,this.OHb):this.pluginScheduler.requester().runExperiment(new af)}R9e(bb){bb&&this.eb.fb?(this.formulaAssistanceTelemetryManager.dw(["argumentAssistanceComputation"]),
this.bWa.show(bb,this.eb.textBox.domElement)):this.bWa.dismiss()}h9h(bb,Lb){bb&&0<bb.items.length&&this.eb.fb&&this.eb.text===this.Qba?this.r_c&&this.wb.U4(this.gridView.ha.qa.activeCell)?(this.formulaAssistanceTelemetryManager.XG.smartSuggestionWouldSuggestInsidePivotCounter++,this.t8.dismiss()):(this.formulaAssistanceTelemetryManager.dw(["autoCompleteComputation"]),this.t8.show(bb)):this.t8.dismiss();this.gridView.kaa.LRd(bb,Lb)}$Od(bb){bb={content:bb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};
this.Ika?this.pluginScheduler.getRequester().runAuthoringExperiment(bb,this.OHb):this.pluginScheduler.requester().runAuthoringExperiment(bb)}eFb(bb){var Lb;const mc=this.gridView.ha.qa.activeCell;if(mc){var Uc=this.calcManager.bta(mc,!1);if(Uc){var pd=this.$.va,ta=Uc.sheet.index;0>=pd.count||0>ta||ta>=pd.count?v.ULS.sendTraceTag(512278608,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${pd.count}, currentSheetIndex = ${ta}.`):(ta=pd=null,this.eBd&&void 0!==
this.calcManager&&null!==this.calcManager&&(bb=null!==(Lb=null===bb||void 0===bb?void 0:bb.cell)&&void 0!==Lb?Lb:this.gridView.Ca.Ur(mc))&&(Lb=this.calcManager.Ncc(bb.hj),void 0!==Lb&&null!==Lb&&(pd=Lb.FormatString,ta=Lb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:Uc.range.col,rowIndex:Uc.range.row,sheetIndex:this.$.va.getItem(Uc.sheet.index).sheetId,docName:Uc.sheet.document.name,docPath:Uc.sheet.document.path,formatString:pd,builtIn:ta}),v.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${Uc.range.col}, row: ${Uc.range.row}, format: ${pd}`))}else v.ULS.sendTraceTag(537162002,
0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else v.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}mkg(){const bb=this.functionInfoManager.Rac;this.pluginScheduler.notifier().setFunctionsInfo(bb);v.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===bb||void 0===bb?void 0:bb.length} functions}`)}Ynd(){this.gridView.ha.Jga(this.Eh);
const bb=ba.a.Wzb()?this.gridView.Qb(null):void 0;this.eFb(bb);ba.a.Pgc&&this.eb.PYa(this.U5);this.bPd();this.t8.ZLg(this.Ozf);this.pluginScheduler.setServerDataProvider(new cc(this.Og,this.$));this.yda();this.cmf&&this.$.nj(this.uc)}Ufb(bb,Lb,mc){mc=Object(X.b)(Lb)?this.u4a(Lb,Object(X.b)(mc)?mc:be.a):this.u4a(bb.text,bb.textBox.selection);return this.eqa.QWj(bb,Lb,mc)}}Object(d.a)(le,"FormulaAssistanceManager",null,[259,2]);var Sd=a(204);class me extends Na.a{constructor(bb){super();this.$=bb;this.Db()}create(){var bb=
ba.a.bV(this.$);const Lb=E.EwaSettings.sa(329),mc=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Uc=ba.a.aV(this.$),pd=this.$.da,ta=m.GetServiceTaskFactory.create(pd,134,this.la,this.Xa),rb=m.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa);let gc;gc=ba.a.u4(this.$)?m.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):sa.Task.Ra(null);let Pc;Pc=ba.a.bV(this.$)?m.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):sa.Task.Ra(null);let hd;hd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
!Uc?m.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):sa.Task.Ra(null);if(mc||bb){let Cd;Cd=E.EwaSettings.ZJ()?Object(Sd.c)(D.a.resolve(G.b,{Tl:this.Xa})):m.GetServiceTaskFactory.Oa(pd,266,265,this.Xa);const Zd=m.GetServiceTaskFactory.Oa(pd,219,220,this.Xa),Wd=m.GetServiceTaskFactory.Oa(pd,491,492,this.Xa);bb=[Cd,Pc,gc,Zd,Wd,hd];E.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&bb.push(ta,rb);l.TaskExtensions.za(l.TaskExtensions.Fd(bb,this.la),
()=>{const Se=pd.Aa(19)||new Yd(this.$,Pc.result),Le=Zd.result;if(Uc){var ve=pd.Aa(464);ve||(ve=new le(this.$,Se,Cd.result,Pc.result,gc.result,Wd.result,rb.result.A5c(this.$,ta.result)),Le.zZc(ve.zZe),Le.AZc(ve.dja),Le.BZc(ve.dja))}else ve=pd.Aa(221),ve||(ve=new wf(this.$,Se,ta.result,Cd.result,null,rb.result,gc.result,Wd.result,Pc.result,hd.result),Le.zZc(ve.AZe),Le.BZc(ve.TZe),Le.AZc(ve)),Lb&&(pd.Aa(317)||new pc(this.$));this.nb(Se)},this.la,3)}else{const Cd=m.GetServiceTaskFactory.Oa(pd,219,220,
this.Xa),Zd=m.GetServiceTaskFactory.Oa(pd,491,492,this.Xa);bb=[Cd,gc,Pc,hd];E.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&bb.push(ta,rb,Zd);l.TaskExtensions.za(l.TaskExtensions.Fd(bb,this.la),()=>{const Wd=pd.Aa(19)||new Yd(this.$,Pc.result),Se=Cd.result;let Le=pd.Aa(221);Le||(Le=new wf(this.$,Wd,ta.result,null,null,rb.result,gc.result,Zd.result,Pc.result,hd.result),Se.zZc(Le.AZe),Se.BZc(Le.TZe),Se.AZc(Le));Lb&&(pd.Aa(317)||new pc(this.$));this.nb(Wd)},
this.la,3)}}static ka(bb){bb.da.Ha(153,new me(bb))}}Object(d.a)(me,"FunctionInfoManagerFactory",Na.a,[]);a.d(F,"a",function(){return Ee});const Ee=()=>{f.a.Fa(bb=>{wb.ka(bb);nb.ka(bb);me.ka(bb)})}},1163:function(t,F,a){var c=a(0),b=a(709),e=a(153),f=a(7),d=a(15),h=a(83),m=a(4),l=a(160),v=a(1094),r=a(1092),A=a(734),x=a(5),n=a(463),u=a(563),z=a(68),w=a(59),C=a(926),y=a(127),B=a(41),H=a(192),I=a(60),R=a(50),S=a(763),G=a(140),D=a(37),E=a(113),M=a(214),L=a(94),N=a(74),Y=a(35),U=a(29),P=a(250),aa=a(1),
X=a(188),Z=a(13),da=a(62),qa=a(282),O=a(21),ca=a(128),wa=a(782),ia=a(783),Ha=a(129),Sa=a(115),Da=a(52),ea=a(34),sa=a(427);class Ea{constructor(){this.Sections=this.Id=null}}Object(c.a)(Ea,"AutoFilterMenu",null,[]);class ba{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(ba,"MenuItem",null,[]);class ka{constructor(){this.Title=this.MenuItems=this.Id=
null;this.DisplayType=0}}Object(c.a)(ka,"MenuSection",null,[]);class Ca{constructor(){this.isSuccess=!1}}Object(c.a)(Ca,"ApplyFilterByValueResponse",null,[]);class db{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(db,"FilterByValueItem",null,[]);class yb{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}}Object(c.a)(yb,"GetColorsAndIconsResponse",null,[]);class kb{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(kb,"GetFilterByValueItemsResponse",null,[]);class mb{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(mb,"ShowSortFilterMenuParams",null,[]);class W{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=
null}}Object(c.a)(W,"SortFilterControllerFactoryParams",null,[]);class Q{constructor(){this.top=this.left=0}}Object(c.a)(Q,"TargetPoint",null,[]);var va=a(55),na=a(204),Ba=a(33),Oa=a(161),oa=a(230),Ja=a(8),Wb=a(186),nc=a(105);const Yb=x.a.F9g;class pb extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateAutoFilterContextMenu",1675506831,1651433993,Yb,!0,!1,"AutoFilterContextMenuRoot",Hb,cc,!1,Hc);this.OYc=this.MTa=this.sheetName=this.Msb=null;this.e3a=this.Xqf=!1;this.N6c=this.rab=this.HJe=this.EPa=
this.Qcc=this.jbd=this.Keb=this.YHb=null;this.xV=()=>{this.nAc();this.$.ea.Bn(this.xV)};this.sDf=od=>{this.e3a||ca.b(this.$).rd(y.a.tDf,this.sm(),void 0,!0);var Dd={};this.$.ak(Dd);var be=this.$.ea.isNamedObjectViewMode;const Jb=w.a.Wh(this.OYc);Jb.SheetName=be?Dd.NamedObjectName:Dd.SheetName;Jb.NamedObjectView=be;Dd=!!od.searchText;be=586;this.e3a&&(Dd&&(Jb.ItemListOptions=this.ubh(od.searchText),be=597),ca.b(this.$).rd(y.a.tDf,{["UserOperation"]:be.toString()},void 0,!0));const sc=this.cDd(Dd),
ed=this.VSi(),xd=this.$.oa.xa.Wb();this.HJe=xd.RequestId;this.e3a&&this.Qcc&&!this.Qcc.dequeueUtcTime&&(this.$.userOperationManager.Dta(this.Qcc),this.u1g());od=new H.a(be,0,(le,Sd,me)=>this.N6c=I.n(this.$.oa.xa,Jb,qa.b(le,sc),this.e3a?qa.a(Sd,ed):Sd,me,null,xd),80);this.Qcc=this.$.userOperationManager.Jc(od,null);this.rab=this.N6c;this.EPa=this.HJe};this.onMenuItemClick=(od,Dd,be)=>{ca.b(this.$).rd(y.a.OXi,this.sm(),void 0,!0);Dd={["CommandValueId"]:Dd,["MenuItemId"]:Dd,["InputMethod"]:be,["TopCellAddress"]:this.MTa};
const Jb=new L.a(od,be,this.$.isEditMode?2:1,19,null);this.$.Ia.Hb(Jb,Dd);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${od}, ${be}`)};this.focusShiftOnMenuDismiss=()=>{O.h(this.$).focus()};this.Ezf=od=>{if(od.checkedItems&&od.checkedItems.length){ca.b(this.$).rd(y.a.Fzf,this.sm(),void 0,!0);var Dd=w.a.Wh(this.OYc),be={};this.$.ak(be);be.FirstRow=0;be.FirstColumn=Dd.Column;var Jb=this.$.ea.isNamedObjectViewMode;Dd.NamedObjectView=Jb;Dd.SheetName=Jb?be.NamedObjectName:
be.SheetName;var sc=le=>{if(wa.a.ozc(le)){const Sd=wa.a.obc(le);this.PMa?wa.a.JQa(ia.a.applyItemFilter,Sd.MessageIdName,Sa.a.HGa,!0,wa.a.isSessionEndingError(Sd.MessageId)):d.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${Sd.MessageIdName}`)}P.a(le)||(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ca.b(this.$).rd(y.a.lDf,this.sm(),void 0,!0),le=Object(f.a)(new Ca,{isSuccess:!0}),
this.Keb.onApplyFilterByValueFinish(le),this.aS(this.MTa))},ed=this.m5c(Dd,be),xd=new H.a(208,0,(le,Sd,me)=>I.a(this.$.oa.xa,ed,od.checkedItems,qa.b(le,sc),Sd,me,null,null),6,()=>new C.a(od.checkedItems,ed));this.XIj(()=>{this.$.userOperationManager.Jc(xd,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.Uue=od=>{const Dd=B.o(this.MTa,this.$),be=B.v(this.MTa,this.$);var Jb=Object(f.a)(new v.a,{SortConditionType:od.type,
RowColOffset:Dd.FirstColumn-be.FirstColumn,SortColor:od.color,SortIconSet:od.icon.IconSet,SortIcon:od.icon.Icon,IsAscending:!0});Jb=Object(f.a)(new r.a,{OperationType:1,ActiveCell:Dd,SelectedRange:be,SortConditions:[Jb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const sc={};sc.SortOptions=Jb;sc.SelectedRange=be;sc.OriginalActiveCell=Dd;sc.ShouldRestoreSelection=!1;sc.ShouldPromptNamedSheetViewTeachingDialog=!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${od.type}`);
this.$.Zc(-1089513346,z.a.zb,19,{["CustomSortCommandData"]:sc})};this.PMa=wa.a.apd();this.UA=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Gw(){return"PopulateAutoFilterContextMenu"}get qB(){return x.a.qRf}executeCommand(fb,Hb,cc){fb=Hb.command;switch(fb){case 1701016594:return A.a.CDh(cc),va.Task.Ra(!0);case 966232027:if(aa.EwaSettings.cl()){const Hc=new l.a;D.TaskExtensions.za(R.GetServiceTaskFactory.Oa(this.$.da,8,9,0),od=>{this.eaf(Hb,cc,od.result);Hc.setResult(!0)},
this.la,3).continueWith(()=>{Hc.setResult(!1)},5,this.la,oa.a.instance);return Hc.task}this.eaf(Hb,cc);return va.Task.Ra(!0);default:return X.a(fb)}}eaf(fb,Hb,cc){const Hc=Hb.domEvent;if(N.e(Hc.rawEvent)&&(N.g(Hc),Hc.target)){var od=new G.a(this.$.va);if(od.Pd(4096)||od.Pd(2048)){var Dd=w.a.Wh(Hb[z.a.Pf]);this.w8f(Dd)&&(this.Xqf?this.bvc(Hc,Hc.target,Dd,fb,cc):(this.YHb=()=>{this.w8f(Dd)&&(this.Yhi(),this.bvc(Hc,Hc.target,Dd,fb,cc),this.e3a=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),this.Xqf=!0)},this.nAc()))}}}wc(fb,Hb,cc){if(fb=!!cc)switch(Hb.command){case 1701016594:case 966232027:aa.EwaSettings.cl()||n.a(this.$)||(fb=!1,Hb=Da.b().Cj(Hb.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${Hb}`));break;default:fb=!1}return fb}zGd(fb){fb.MenuSectionList.push(...this.Msb)}Yhi(){sa.a(()=>{aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?
this.Keb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new W,{getFilterByValueItemsRequest:this.sDf,applyFilterByValueRequest:this.Ezf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:pb.NZc,applySortByColorOrIconRequest:this.Uue})):this.Keb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new W,{getFilterByValueItemsRequest:this.sDf,applyFilterByValueRequest:this.Ezf,
onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:pb.NZc,applySortByColorOrIconRequest:this.Uue}))});this.jbd=h.a.instance.mg("Common.IExternalUICommandDefinitionMapping")||new u.a(this.$.Bb,this.$)}bvc(fb,Hb,cc,Hc,od){ca.b(this.$).rd(y.a.bvc,this.sm(),void 0,!0);if(cc){fb=this.$Oh(cc,od);Hc=Sys.UI.DomElement.getBounds(Hb);Hb=Hc.x+Hc.width;Hc=Hc.y;if(this.UA&&!cc.IsHeaderSnapped){if(!A.a.Fpd(this.$,cc.Cell))return;cc=A.a.Afd(this.$,cc.Cell,!0);Hb=cc.x;Hc=cc.y}cc=O.h(this.$).rtl?new Sys.UI.Point(Hb-
ea.a(this.$).mGa(pb.NZc),Hc):new Sys.UI.Point(Hb,Hc);cc=ea.a(this.$).Ija(cc);cc=Object(f.a)(new mb,{targetPoint:Object(f.a)(new Q,{left:cc.x,top:cc.y}),autoFilterMenu:fb});this.Keb.showSortFilterMenu(cc);this.$.Zc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!cc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}w8f(fb){return(null===fb||void 0===fb?0:fb.Cell.SheetName)?O.h(this.$).P4?fb.Cell.SheetName===this.$.na.name:fb.Cell.SheetName===this.$.na.sheetName:
!0}$Oh(fb,Hb){return(fb=this.aPh(fb,Hb))?this.ePf(fb):null}ePf(fb){const Hb=[];for(const cc of fb.Sections){if(Object(Oa.g)(this.$)&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&cc.Title===Z.a.instance.ga(1948))continue;const Hc=this.W8i(cc);Hb.push(Hc)}return Object(f.a)(new Ea,{Id:fb.Id,Sections:Hb})}W8i(fb){const Hb=[];for(const cc of fb.MenuItems)if(2===cc.Identifier)this.OYc=cc.CommandData;else switch(cc.Type){case 3:case 2:Hb.push(this.U8i(cc,2===cc.Type));break;
case 1:Hb.push(this.V8i(cc))}return Object(f.a)(new ka,{MenuItems:Hb,DisplayType:fb.DisplayType,Id:this.qMh(fb)})}V8i(fb){({label:od,HLa:Hc}=this.C_e(fb));const Hb=this.ePf(fb.SubMenu),cc=this.t_e(fb);var Hc=this.jbd.ccc(Hc);var od=od||fb.Label;return Object(f.a)(new ba,{Disabled:fb.Disabled,Type:fb.Type,Identifier:fb.Identifier,Id:cc,CommandData:fb.CommandData,Label:od,SubMenu:Hb,IsChecked:fb.IsChecked,IconName:"MissingIcon_20"===Hc?null:Hc})}U8i(fb,Hb){let cc;({label:Hb,HLa:od,vr:cc}=this.Zac(fb,
Hb&&fb.IsChecked));const Hc=this.ued(fb,Hb);var od=this.jbd.ccc(od);return Object(f.a)(new ba,{Disabled:fb.Disabled,Type:fb.Type,Identifier:fb.Identifier,Id:Hc,RibbonCommand:cc,CommandData:fb.CommandData,Label:Hb||fb.Label,SubMenu:null,IsChecked:fb.IsChecked,IconName:"MissingIcon_20"===od?null:od})}aPh(fb,Hb){var cc;this.MTa=cc=B.C(fb.Cell);this.sheetName=this.$.na.sheetName;Hb=Hb||n.a(this.$);if(fb.IsHeaderSnapped)cc=Hb.L$b.uWh(cc);else{Hb=O.h(this.$).Ca.HKa(cc);if(!Hb)return this.PMa?wa.a.JQa(ia.a.sRf,
Ha.a.U7h,Sa.a.Ipb,!0,!1):(fb=O.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${cc}, visible range: ${fb}`)),null;cc=Hb.autoFilterMenu}if(!cc)return this.PMa?wa.a.JQa(ia.a.sRf,Ha.a.GHi,Sa.a.Ipb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;
this.Etb=fb.Cell.FirstRow+"_"+fb.Cell.FirstColumn;return cc}nAc(){let fb=()=>R.GetServiceTaskFactory.Oa(this.$.da,283,284,1);aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")&&(fb=()=>na.c(Wb.a.resolve(nc.e,{Tl:1})));if(this.$.ea.Zf){const Hb=fb();D.TaskExtensions.za(Hb,()=>{this.PMa?Hb.result.Hl.loadScript("sortFilter").then(()=>{this.YHb()},cc=>{da.a.Fj(cc,"AutoFilterContextMenu.SortFilterScriptLoad");wa.a.JQa(ia.a.nAc,Ha.a.MLj,Sa.a.Ipb,!1,!1)}):D.TaskExtensions.za(na.c(Hb.result.Hl.loadScript("sortFilter")),
()=>{this.YHb()},this.$.la,3)},this.$.la,3)}else this.$.ea.Dk(this.xV)}ubh(fb){const Hb={};Hb.SearchText=fb;Hb.Page=1;Hb.DateNodeType=-1;return Hb}u1g(){this.EPa&&(d.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.EPa}`),I.h(this.$.oa.xa,this.EPa,null,null,null),this.EPa=null);this.rab&&(m.AFrameworkApplication.Bd.Nt(this.rab.Rs),this.rab=null)}cDd(fb){return Hb=>{this.rab=this.EPa=null;if(wa.a.ozc(Hb)){var cc=
wa.a.obc(Hb);this.PMa?wa.a.JQa(fb?ia.a.searchAutoFilterItemList:ia.a.getAutoFilterItemList,cc.MessageIdName,Sa.a.Ipb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${cc.MessageIdName}`)}if(!P.a(Hb)){d.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Hb=Hb.Result;cc=new Y.a(!0);const Hc=Hb.AutoFilterDateNodes?!0:!1;Hb.AutoFilterItems&&cc.add("AutoFilterItemsCount",
Hb.AutoFilterItems.length);Hc&&cc.add("AutoFilterDateItemsCount",Hb.AutoFilterDateNodes.length);cc.add("Location","contextMenu");ca.b(this.$).rd(y.a.cDd,cc.tu,void 0,!0);cc=this.e3a?Object(f.a)(new kb,{filterByValueItems:this.fGe(Hb),hasMoreRecords:Hb.ItemListMaxExceeded,searchText:Hb.SearchText}):Object(f.a)(new kb,{filterByValueItems:this.fGe(Hb),hasMoreRecords:Hb.ItemListMaxExceeded});this.Keb.onGetFilterByValueItemsFinish(cc);fb||(d.ULS.shipAssertTag(529063959,0,null!==Hb.FontColors&&null!==Hb.CellColors&&
null!==Hb.Icons&&null!==Hb.SelectedSortFontColors&&null!==Hb.SelectedSortCellColors&&null!==Hb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Hb=Object(f.a)(new yb,{fontColors:Hb.FontColors,cellColors:Hb.CellColors,icons:Hb.Icons,selectedSortFontColor:0<Hb.SelectedSortFontColors.length?Hb.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Hb.SelectedSortCellColors.length?Hb.SelectedSortCellColors[0]:null,selectedSortIcon:0<
Hb.SelectedSortIcons.length?Hb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),this.Keb.onGetColorsAndIconsFinish(Hb))}}}VSi(){return fb=>{this.rab=this.EPa=null;fb=E.a.Pe(fb.data);fb=U.a.nc(fb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${fb}].`)}}fGe(fb){const Hb=this.f$g(fb),cc=this.m$g(fb.AutoFilterItems),Hc=[],od=[];let Dd=0,be=0;fb.HasBlanks&&(fb=pb.B5c(Z.a.instance.ga(781),fb.IsBlanksSelected?1:0,x.a.ywe),Hc[Dd++]=fb);
for(const Jb of Hb)Hc[Dd++]=Jb;if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Jb of cc)-1!==Array.indexOf(Ja.a.L$c,Jb.displayText)?od[be++]=Jb:Hc[Dd++]=Jb;else for(const Jb of cc)Hc[Dd++]=Jb;return Array.prototype.concat(od,Hc)}f$g(fb){const Hb=[];if(!fb.AutoFilterDateNodes||!fb.AutoFilterDateNodes.length)return Hb;const cc=[this.z4a(fb.YearKeys,fb.YearValues),this.z4a(fb.MonthKeys,fb.MonthValues),this.z4a(fb.DayKeys,fb.DayValues),this.z4a(fb.HourKeys,
fb.HourValues),this.z4a(fb.MinuteKeys,fb.MinuteValues),this.z4a(fb.SecondKeys,fb.SecondValues)];let Hc=!1,od=!1,Dd=0;var be=null;const Jb=Array(6);var sc=null;for(const ed of fb.AutoFilterDateNodes){Jb[0]&&(sc.Year!==ed.Year?(Hc=!0,Dd=0,be=null):sc.Month!==ed.Month?(od=!0,Dd=1,be=Jb[0]):sc.Day!==ed.Day?(Dd=2,be=Jb[1]):fb.ShowTime&&(sc.Hour!==ed.Hour?(Dd=3,be=Jb[2]):sc.Minute!==ed.Minute?(Dd=4,be=Jb[3]):(Dd=5,be=Jb[4])));for(;6>Dd;){let xd;switch(Dd){case 0:xd=ed.Year;sc=cc[0].getItem(xd.toString());
break;case 1:xd=ed.Month;sc=cc[1].getItem(xd.toString());break;case 2:xd=ed.Day;sc=cc[2].getItem(xd.toString());break;case 3:xd=ed.Hour;sc=cc[3].getItem(xd.toString());break;case 4:xd=ed.Minute;sc=cc[4].getItem(xd.toString());break;case 5:xd=ed.Second;sc=cc[5].getItem(xd.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}sc=pb.B5c(sc,-1!==ed.NodeType&&Dd>=ed.NodeType?1:0,be?be.key+";"+xd:x.a.OZc+xd,!1,[]);be=be?be.children:Hb;be=be[be.length]=sc;Jb[Dd]=sc;switch(Dd){case 5:Dd=
6;break;case 2:Dd=fb.ShowTime?Dd+1:6;break;default:Dd++}}sc=ed}Hc||(Jb[0].expanded=!0,od||(Jb[1].expanded=!0));return Hb}m$g(fb){const Hb=[];if(!fb)return Hb;let cc=0;for(const Hc of fb)Hb[cc++]=pb.B5c(Hc.DisplayString,Hc.Selected?1:0,x.a.PZc+Hc.DisplayString);return Hb}z4a(fb,Hb){const cc=new Y.a(!0);if(!fb||!Hb)return cc;const Hc=fb.length<Hb.length?fb.length:Hb.length;for(let od=0;od<Hc;od++)cc.add(fb[od].toString(),Hb[od]);return cc}m5c(fb,Hb){const cc={};cc.Location=Hb;cc.FieldId=fb.Id.toString();
cc.DataSourceIndex=-1;cc.FilterType=fb.AutoFilterType;cc.AnchorType=0;cc.ChartId=null;cc.AnchorValue1=-1;cc.AnchorValue2=-1;cc.Property=fb.RichProperty;return cc}aS(fb){Ba.a.Tka(this.$)&&D.TaskExtensions.za(R.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Hb=>{Hb.result.sea(fb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}getColorName(fb){return S.a.GKa(M.a.YG(fb))}XIj(fb){D.TaskExtensions.za(R.GetServiceTaskFactory.Oa(this.$.da,
309,310,3),Hb=>{Hb.result.ASa().continueWith(cc=>{cc.result&&fb()})},this.$.la,3)}static B5c(fb=null,Hb=0,cc=null,Hc=!1,od=null){return Object(f.a)(new db,{displayText:fb?A.a.kf(fb):fb,state:Hb,key:cc,parent:null,children:od,indentationLevel:0,expanded:Hc})}}pb.NZc=268;Object(c.a)(pb,"AutoFilterContextMenu",A.a,[]);var Fa=a(739),ab=a(84),Gb=a(191),Ga=a(64),Ma=a(19);class Qa{}Qa.rXe=26;Qa.icd=[227,228,0,98,0,94,93];Object(c.a)(Qa,"Constants",null,[]);class wb{constructor(fb,Hb,cc,Hc){this.pAg=fb;this.Wug=
Hb;this.$ug=cc;this.DEg=Hc}get Iqi(){return 3===this.b6b}get Eui(){return 4===this.b6b&&!!this.subMenu}get subMenu(){return this.DEg}get Bvf(){return this.pAg}get b6b(){return this.Wug}get b7c(){return this.$ug}}Object(c.a)(wb,"FiltersMenuData",null,[]);class Na extends wb{constructor(fb,Hb){super(fb,2,0,null);this.zwe=Hb}}Object(c.a)(Na,"AutoFilterFiltersMenuData",wb,[]);class ya{}ya.YQj=[new wb(99,2,0,null),new wb(100,2,1,null),new wb(0,3,0,null),new wb(169,2,2,null),new wb(171,2,4,null),new wb(0,
3,0,null),new wb(173,2,6,null),new wb(174,2,7,null),new wb(0,3,0,null),new wb(107,0,0,null)];ya.bMi=[new wb(99,2,0,null),new wb(100,2,1,null),new wb(0,3,0,null),new wb(101,2,8,null),new wb(102,2,10,null),new wb(103,2,12,null),new wb(0,3,0,null),new wb(104,1,0,null),new Na(105,1),new Na(106,2),new wb(0,3,0,null),new wb(107,0,0,null)];ya.cjh=[new wb(99,2,0,null),new wb(0,3,0,null),new wb(111,2,10,null),new wb(112,2,8,null),new wb(103,2,12,null),new wb(0,3,0,null),new Na(109,8),new Na(108,9),new Na(110,
10),new wb(0,3,0,null),new Na(114,11),new Na(113,12),new Na(115,13),new wb(0,3,0,null),new Na(116,14),new Na(117,15),new Na(118,16),new wb(0,3,0,null),new Na(119,17),new Na(120,18),new Na(121,19),new wb(0,3,0,null),new Na(122,20),new Na(123,21),new Na(124,22),new wb(0,3,0,null),new Na(125,23),new wb(126,2,12,[new Na(127,24),new Na(128,25),new Na(129,26),new Na(130,27),new wb(0,3,0,null),new Na(131,28),new Na(132,29),new Na(133,30),new Na(134,31),new Na(135,32),new Na(136,33),new Na(137,34),new Na(138,
35),new Na(139,36),new Na(140,37),new Na(141,38),new Na(142,39)]),new wb(0,3,0,null),new wb(107,0,0,null)];Object(c.a)(ya,"Constants",null,[]);var nb=a(927),vb=a(80);class gb extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,gb.pFh,!0,!1,gb.QKb,Hb,cc,!1,Hc);this.qm=null}get Gw(){return"PopulateAutoFilterFieldListContextMenu"}get qB(){return x.a.rRf}executeCommand(fb,Hb,cc){fb=Hb.command;switch(fb){case -699941697:this.applyAutoFilterFieldList(Hb,
cc);break;case 216058793:break;case -1494291901:break;default:return X.a(fb)}return va.Task.Ra(!0)}rfd(fb,Hb){return!fb||fb.length<=Hb?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(fb[Hb],10)}gId(fb,Hb,cc,Hc,od,Dd){const be=this.rfd(od,Dd);0>be&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Qa.icd[be]){case 98:fb=new L.a(-2058042992,Hb.method,Hb.mode,Hb.We,Hb.tabName);
this.qm.CG.Sub(this.$,Hc,0,fb);break;case 227:fb=new L.a(504133448,Hb.method,Hb.mode,Hb.We,Hb.tabName);this.qm.CG.Sub(this.$,Hc,0,fb);break;case 228:fb=new L.a(-798968736,Hb.method,Hb.mode,Hb.We,Hb.tabName);this.qm.CG.Sub(this.$,Hc,0,fb);break;case 232:fb=new L.a(-1677817820,Hb.method,Hb.mode,Hb.We,Hb.tabName);this.qm.CG.Sub(this.$,Hc,0,fb);break;case 94:this.xPf(fb,Hb,Hc,cc,od,Dd+1);break;case 93:this.qm.CG.Ayi(this.$,Hc)}}xPf(fb,Hb,cc,Hc,od,Dd){const be=this.rfd(od,Dd);0>be&&d.ULS.sendTraceTag(537167115,
0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Hc||be>=Hc.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Hc=Hc[be],Hc.b6b){case 1:this.qm.CG.Uyi(this.$,cc);break;case 2:(od=Object(ab.a)(Na,Hc))?(fb=new L.a(-2058042992,Hb.method,Hb.mode,Hb.We,Hb.tabName),this.qm.CG.Sub(this.$,cc,od.zwe,fb)):this.qm.CG.Jpf(this.$,fb,cc,Hc.b7c);break;case 0:this.qm.CG.Jpf(this.$,fb,cc,Hc.b7c);break;
case 4:this.xPf(fb,Hb,cc,Hc.subMenu,od,Dd+1)}}applyAutoFilterFieldList(fb,Hb){var cc=Hb[Fa.a.HF];if(cc)if(cc=cc.split(Ga.a.jU),3>cc.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Hc=this.rfd(cc,1),od=this.tKa(Hc),Dd=this.wvf(Hc).returnValue;Dd?this.gId(Hb,fb,Dd,od,cc,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+Hc.toString()+
Ga.a.jU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}wc(fb,Hb){if(fb=this.$.isEditMode)switch(Hb.command){case 216058793:break;case -699941697:break;case -1494291901:fb=!0;break;default:fb=!1}return fb}r0(fb,Hb,cc){this.$.isEditMode&&((this.qm=Object(ab.a)(318,cc))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.CY(),super.r0(fb,Hb,null,
null,!0))}u5c(){if(!this.qm||!this.qm.Pk||1!==this.qm.Pk.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const fb=this.qm.Pk[0];let Hb=new Gb.a;Hb.add(Z.a.instance.ga(248));Hb=vb.OBc(vb.concat(Hb,vb.select(vb.asEnumerable(fb.FieldInfoDataList),cc=>cc.Name)),cc=>cc,new nb.a);return vb.toArray(Hb)}fieldIndex(fb){if(!this.qm||!this.qm.Pk||1!==this.qm.Pk.length||!this.qm.Pk[0].FieldInfoDataList)return-1;for(let Hb=
0;Hb<this.qm.Pk[0].FieldInfoDataList.length;++Hb)if(this.qm.Pk[0].FieldInfoDataList[Hb].Name===fb)return Hb;return-1}tKa(fb){return 0>fb||!this.qm||!this.qm.Pk||1!==this.qm.Pk.length||!this.qm.Pk[0].FieldInfoDataList||this.qm.Pk[0].FieldInfoDataList.length<fb?null:this.qm.Pk[0].FieldInfoDataList[fb].Name}CY(){var fb=this.u5c();if(!fb||!fb.length)return null;const Hb=this.Va,cc=Hb.Ec();for(let be=0;be<fb.length;++be){const Jb=fb[be],sc=0<be?this.fieldIndex(Jb):-1,ed=gb.Cag+sc.toString()+Ga.a.jU;let xd=
null;const le=this.qm.CG.Nai(0<be?Jb:null),Sd=this.F5c(Hb,le,gb.Cag+sc.toString(),Jb);for(let me=0;me<Qa.icd.length;++me){var Hc=Qa.icd[me],od=ed+me.toString();xd||(xd=Hb.Ec());switch(Hc){case 227:xd.buttons.push(Hb.Lc(223,od,-699941697,this.qm.CG.oui(0<be?Jb:null)?Ma.a.O9b:Ma.a.nJa,8,227,!1,null));break;case 228:xd.buttons.push(Hb.Lc(224,od,-699941697,this.qm.CG.pui(0<be?Jb:null)?Ma.a.P9b:Ma.a.oJa,8,228,!1,null));break;case 232:xd.buttons.push(Hb.Lc(225,od,-699941697,Ma.a.M9b,1,232,!1,null));break;
case 98:Hc=this.TYg(Jb);od=Hb.YHa(od+(le?".enabled":".disabled"),Hc,-699941697,null,"None",null,!le,void 0,!0);od.LR("Image16by16",8,Ma.a.Q2a);xd.buttons.push(od);break;case 94:var Dd=void 0;const Ee=({AXe:Dd,isChecked:Hc}=this.wvf(sc)).returnValue;if(!Ee)return null;Dd=this.F5c(Hb,Hc&&le,od,Dd);od=this.H_e(Dd.menu,Hb,od+Ga.a.jU,Ee,Hc&&le);Dd.menu.rc.push(od);xd.buttons.push(Dd);break;case 0:xd&&(Sd.menu.rc.push(xd),xd=null);break;default:od=Hb.YHa(od,Z.a.instance.ga(Hc),-699941697,null,"None",null,
!1,void 0,!0),this.S3f(od,le&&93===Hc&&this.qm.CG.filter(),Z.a.instance.ga(Hc)),xd.buttons.push(od)}}Sd.menu.rc.push(xd);cc.buttons.push(Sd)}fb=Hb.sq(this.menuId);fb.rc.push(cc);return fb}H_e(fb,Hb,cc,Hc,od){let Dd=null;for(let xd=0;xd<Hc.length;++xd){var be=Hc[xd],Jb=cc+xd.toString(),sc=!1;switch(be.b6b){case 1:sc=od&&this.qm.CG.tg.IsTop10;break;case 2:sc=Object(ab.a)(Na,be);sc=od&&this.qm.CG.ini(sc?sc.zwe:0,be.b7c);break;case 0:sc=od&&this.qm.CG.tg.IsCustomSupportedAndNotPresent}Dd||(Dd=Hb.Ec());
if(be.Iqi)Dd&&(fb.rc.push(Dd),Dd=null);else if(be.Eui){var ed=Z.a.instance.ga(be.Bvf);ed=this.F5c(Hb,sc,Jb,ed);ed.menu.rc.push(this.H_e(ed.menu,Hb,Jb+Ga.a.jU,be.subMenu,sc));Dd.buttons.push(ed)}else be=Z.a.instance.ga(be.Bvf),Jb=Hb.YHa(Jb,be,-699941697,null,"None",null,!1,void 0,!0),this.S3f(Jb,sc,be),Dd.buttons.push(Jb)}return Dd}S3f(fb,Hb,cc){Hb?fb.LR("Image16by16",8,Ma.a.nua):fb.LR("None",0,null);fb.JR(cc);fb.label=cc}F5c(fb,Hb,cc,Hc){return Hb?fb.v5c(cc,this.menuId,Hc,798637440,8,Ma.a.nua):fb.Xv(cc,
this.menuId,Hc,798637440)}lh(fb){return!fb||!fb.length}wvf(fb){var Hb=0>fb?0:this.qm.Pk[0].FieldInfoDataList[fb].MajorityDataTypeForField;var cc=null;fb=this.qm.CG.Mai(Hb);switch(Hb){case 0:cc=95;Hb=ya.YQj;break;case 1:cc=94;Hb=ya.bMi;break;case 2:cc=96;Hb=ya.cjh;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,AXe:cc,isChecked:fb}}cc=Z.a.instance.ga(cc);return{returnValue:Hb,AXe:cc,isChecked:fb}}TYg(fb){!fb||
this.lh(fb.trim())?fb=Z.a.instance.ga(97):fb.length>Qa.rXe?(fb=fb.substring(0,Qa.rXe),fb=String.format(Z.a.instance.ob(155),fb)):fb=String.format(Z.a.instance.ob(156),fb);return fb}}gb.pFh=x.a.E9g;gb.QKb="AutoFilterFieldListContextMenuRoot";gb.Cag="ApplyAutoFilterFieldList.";Object(c.a)(gb,"AutoFilterFieldListContextMenu",A.a,[]);var cb=a(547),La=a(855),ja=a(11),Ua=a(124),lb=a(375),sb=a(784);class V extends A.a{constructor(fb,Hb,cc,Hc,od="PopulateFloatingObjectContextMenu",Dd=-2017893763,be=1350204367,
Jb=x.a.L9g,sc=!0,ed=!1){super(fb,od,Dd,be,Jb,sc,ed,Jb,Hb,cc,!0,Hc);this.floatingObject=null;this.ub=0;this.Omc=!0}get Gw(){return"PopulateFloatingObjectContextMenu"}get qB(){return x.a.zRf}executeCommand(fb,Hb,cc){fb=Object(ab.a)(cb.a,cc.eventArgs);switch(Hb.command){case -1372040782:cc=O.h(this.$).ha.Sa.dc;d.ULS.shipAssertTag(537167048,0,!!cc);cc&&(this.floatingObject=cc.floatingObject,this.ub=Hb.method,Hb=this.Mbc(fb),this.rp(Hb,!0,fb.ub));break;case 848910589:fb&&(Hb=[La.a.d7f],fb=new Sys.UI.Point(fb.Ea.clientX,
fb.Ea.clientY),this.showFloatie(Hb,new Sys.UI.Bounds(fb.x,fb.y,0,0),2))}return va.Task.Ra(!0)}wc(fb,Hb,cc){switch(Hb.command){case -1372040782:return!!cc&&this.Gmf(fb);case 848910589:return fb=O.h(this.$).ha.Sa.dc,!!cc&&!!fb&&fb.fb;default:return!1}}Gmf(fb){switch(fb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}mWc(fb,Hb,cc){lb.a(this.$)?O.h(this.$).ib.gj||(ea.a(this.$).fUd()?cc.buttons.push(fb.pb(265)):cc.buttons.push(fb.pb(264))):(this.$.isEditMode&&3===this.ub&&!this.lac()&&
cc.buttons.push(fb.pb(101)),5!==this.floatingObject.type||Ua.a.nH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.Msd()?cc.buttons.push(fb.pb(186)):cc.buttons.push(fb.pb(147))),this.lac()||this.Msd()||cc.buttons.push(fb.pb(146)),aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7439032_ChangeFOZOrder")&&(this.qLh(cc),this.TMh(cc)),aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&cc.buttons.push(fb.pb(287)),aa.EwaSettings.sa(155)&&
0===this.floatingObject.type&&cc.buttons.push(fb.pb(249)),5===this.floatingObject.type&&O.h(this.$).ha.Sa.dc.Y4()&&this.$.Qka&&this.$.rT&&cc.buttons.push(fb.pb(273)))}wKa(fb){const Hb=[];if(lb.a(this.$))return Hb;3===fb?(fb=!!this.$.Xd.get(5)&&this.floatingObject.qXd(),this.lac()||(this.$.isEditMode?(fb&&Hb.push(La.a.rIh),5===O.h(this.$).ha.Sa.wA.floatingObject.type&&Hb.push(La.a.ZCj)):fb&&Hb.push(La.a.copy)),Hb.push(La.a.sIh)):2===fb&&(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
O.h(this.$).ha.Sa.dc&&this.J4e(O.h(this.$).ha.Sa.dc,Hb):this.J4e(O.h(this.$).ha.Sa.wA,Hb));return Hb}CY(){const fb=this.Va,Hb=fb.sq(this.menuId);var cc=lb.a(this.$);if(this.$.isEditMode){var Hc=fb.Ec();this.mWc(fb,Hb,Hc);Hb.rc.push(Hc)}this.$.Xd.get(5)&&this.floatingObject.qXd()&&!this.lac()&&!cc&&(Hc=fb.Ec(),this.BIg(fb,Hc),Hb.rc.push(Hc));(Hc=this.$.va.na)&&Hc.$d&&(Hc=Hc.$d.iz||Hc.$d.cK,!aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||
!sb.g(this.$)||this.$.ea.isNamedObjectViewMode||cc||this.$.isMobileMode||Hc||(cc=fb.Ec(),this.sKg(fb,cc),Hb.rc.push(cc)));return Hb}Mbc(fb){var Hb=O.h(this.$).ha.Sa.dc;fb=fb&&1!==fb.ub&&fb.clientPoint?fb.clientPoint:Sys.UI.DomElement.getLocation(Hb.domElement);const cc=this.$.domElement,Hc=O.h(this.$).rtl;(Hb=ja.HelperMethods.LC(Hb.ug.domElement,cc,Hc))?(fb.y=Math.max(fb.y,Hb.y),fb.x=Math.max(fb.x,Hb.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${m.AFrameworkApplication.rg}`);
return fb}Msd(){const fb=O.h(this.$).ha.Sa.dc;return!!fb&&fb.fb}BIg(fb,Hb){if(this.$.isEditMode){Hb.buttons.push(fb.pb(42));Hb.buttons.push(fb.pb(43));const cc=this.$.da.Aa(254,!0);(cc&&2===cc.OCb()||this.Msd())&&Hb.buttons.push(fb.pb(44))}else Hb.buttons.push(fb.pb(43))}sKg(fb,Hb){Hb.buttons.push(fb.pb(274))}lac(){return aa.EwaSettings.sa(407)&&!!O.h(this.$).ha.Sa.Un}J4e(fb,Hb){5===fb.floatingObject.type?fb.fb?Hb.push(La.a.d7f):Hb.push(La.a.VCj):Hb.push(A.a.EYe)}qLh(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(282));
Hb.buttons.push(this.Va.pb(281));const cc=this.Va.Xv("BringToFront","BringToFrontMenuId",Z.a.instance.ga(821),-1777747317);cc.menu.rc.push(Hb);fb.buttons.push(cc)}TMh(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(284));Hb.buttons.push(this.Va.pb(283));const cc=this.Va.Xv("SendToBack","SendToBackMenuId",Z.a.instance.ga(822),-1777747317);cc.menu.rc.push(Hb);fb.buttons.push(cc)}}Object(c.a)(V,"FloatingObjectContextMenu",A.a,[]);var za=a(801),Ra=a(103),Xa=a(556),$a=a(516);const ma=x.a.H9g;class fa extends V{constructor(fb,
Hb,cc,Hc){super(fb,Hb,cc,Hc,"PopulateChartContextMenu",-498523270,1640762262,ma);this.isPivotChart=this.refresh=this.ZY=this.$va=this.UAa=!1}get Gw(){return"PopulateChartContextMenu"}get qB(){return x.a.tRf}executeCommand(fb,Hb,cc){const Hc=this.$;this.ub=Hb.method;Hb=cc[fa.L1c];if(!(fb&68)){if(!Hb){if(8===fb)Hb=$a.a(Hc).Wc;else{var od=O.h(Hc).ha.Sa.dc;if(null===od||void 0===od?0:od.floatingObject)Hb=od.floatingObject.Wc}if(!Hb)return va.Task.Ra(!0)}this.isPivotChart=!!(Hb.Attributes&4)}if(this.isPivotChart||
Hc.isEditMode)if(this.refresh=this.ZY=this.$va=this.UAa=!1,od=O.h(this.$).ha.Sa.dc,d.ULS.shipAssertTag(537167107,0,!!od),od){this.floatingObject=od.floatingObject;od=Xa.a(Hc);if(null===od||void 0===od?0:od.FTd)this.UAa=od=Ra.f(Hc.dg),this.$va=!od;od=Hc.$b;this.ZY=!!za.a(Hc)&&!!Hb&&!!(Hb.Attributes&512)&&!(fb&8)&&od.m2(32768);od.allowManualDataRefresh&&od.allowInteractivity&&(this.refresh=!0);fb=this.Mbc(Object(ab.a)(cb.a,cc.eventArgs));this.rp(fb,!0)}return va.Task.Ra(!0)}wc(fb,Hb,cc){return-149612405===
Hb.command&&!!cc&&this.Gmf(fb)}mWc(fb,Hb,cc){this.isPivotChart&&(this.refresh&&cc.buttons.push(fb.pb(100)),this.ZY&&cc.buttons.push(fb.pb(99)),this.UAa?cc.buttons.push(fb.pb(59)):this.$va&&cc.buttons.push(fb.pb(58)));super.mWc(fb,Hb,cc)}static get L1c(){return"chartMetaData"}}Object(c.a)(fa,"ChartContextMenu",V,[]);var eb=a(12);const ua=x.a.J9g;class xa extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateFieldListContextMenu",-1045020714,-170383950,ua,!0,!1,ua,Hb,cc,!1,Hc);this.jL=this.io=null;
this.sXd=this.isOlap=this.fV=this.IZ=!1}get Gw(){return"PopulateFieldListContextMenu"}get qB(){return x.a.rJd}executeCommand(fb,Hb,cc){fb=Hb.command;switch(fb){case 330754562:Hb=cc.domElement;this.isOlap=cc.isOlap;this.jL=cc.versionkey;this.io=cc.fieldItem;this.IZ=cc.isChart;this.fV=cc.isPpm;this.sXd="supportsImplicitMeasures"in cc?cc.supportsImplicitMeasures:!1;O.h(this.$).Do(!0);Hb=eb.DOMElementExtensions.getBounds(Hb);Hb=new Sys.UI.Point(Hb.x+Hb.width,Hb.y+Hb.height/2);"isKeyboardInput"in cc&&
cc.isKeyboardInput?this.rp(Hb,!1,1):this.rp(Hb,!1);break;case 926905850:this.sXd&&this.io&&5===this.io.TypeTag&&!this.io.IsCollapsible&&d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Xa.a(this.$).vJ(this.io,8,-1,this.jL,Hb);break;case -67292059:Xa.a(this.$).vJ(this.io,1,-1,this.jL,Hb);break;case 745182485:Xa.a(this.$).vJ(this.io,2,-1,this.jL,Hb);break;case 359279088:Xa.a(this.$).vJ(this.io,4,-1,this.jL,Hb);break;case 547535945:Xa.a(this.$).dcj(this.io);break;default:return X.a(fb)}return va.Task.Ra(!0)}wc(fb,
Hb,cc){fb=!1;switch(Hb.command){case 330754562:fb=!!cc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:fb=!0}return fb}CY(){const fb=this.Va.sq(this.menuId);this.t6i(fb);this.IZ||this.isOlap||this.s6i(fb);return fb}t6i(fb){const Hb=this.Va,cc=Hb.Ec();let Hc=!1;aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Hc=this.isOlap&&!this.fV&&this.sXd&&5===this.io.TypeTag&&!this.io.IsCollapsible);3!==this.io.TypeTag&&37!==this.io.TypeTag||
this.io.IsSet?17===this.io.TypeTag||this.fV?(cc.buttons.push(Hb.pb(79)),cc.buttons.push(Hb.pb(this.IZ?91:80)),cc.buttons.push(Hb.pb(this.IZ?92:81)),cc.buttons.push(Hb.pb(82))):13===this.io.TypeTag||this.io.IsSet?(cc.buttons.push(Hb.pb(83)),cc.buttons.push(Hb.pb(this.IZ?91:80)),cc.buttons.push(Hb.pb(this.IZ?92:81)),cc.buttons.push(Hb.pb(86))):(cc.buttons.push(Hb.pb(79)),cc.buttons.push(Hb.pb(this.IZ?91:80)),cc.buttons.push(Hb.pb(this.IZ?92:81)),cc.buttons.push(Hb.pb(Hc?82:86))):(cc.buttons.push(Hb.pb(83)),
cc.buttons.push(Hb.pb(this.IZ?93:84)),cc.buttons.push(Hb.pb(this.IZ?94:85)),cc.buttons.push(Hb.pb(82)));fb.rc.push(cc)}s6i(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(78));fb.rc.push(Hb)}}Object(c.a)(xa,"FieldListContextMenu",A.a,[]);var tb=a(420),Qb=a(65);class pc{constructor(fb){this.$=fb;this.iN={}}get(fb,Hb,cc){const Hc=this.Fgg(fb,"PivotFilterContextMenuCache.Get");return Hc&&this.iN[Hc]?this.iN[Hc][pc.qhd(Hb,this.$,fb,cc)]:null}set(fb,Hb,cc,Hc){const od=this.Fgg(fb,"PivotFilterContextMenuCache.Set");
od&&(this.iN[od]||(this.iN[od]={}),this.iN[od][pc.qhd(Hb,this.$,fb,Hc)]=cc)}z8b(fb){fb in this.iN&&this.iN[fb]&&(this.iN[fb]=null)}Fgg(fb,Hb){return Qb.f(this.$.na)?this.$.activeItemName:(fb=this.QVj(fb,Hb))?fb.Xc:null}QVj(fb,Hb){fb=B.C(fb);fb=O.h(this.$).Ca.kva(fb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!fb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Hb}`);return fb}static qhd(fb,
Hb,cc,Hc){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Hc?Hb.na.index+"_"+fb.id+"_"+cc.FirstRow.toString()+"_"+cc.FirstColumn.toString():Hb.na.index+"_"+fb.id}}Object(c.a)(pc,"PivotFilterContextMenuCache",null,[]);class hb{constructor(){this.cell=null;this.dataSourceIndex=0;this.yo=this.pivotName=null}}Object(c.a)(hb,"ShowPivotFilterData",null,[]);var ib=a(460),Vb=a(1317),wc=a(51);const Lc=x.a.UFe;class Fc extends A.a{constructor(fb,Hb,cc,Hc,od,Dd,be,Jb=Lc){super(fb,
Hb,cc,Hc,Jb,!0,!1,"PivotFilterMenuRootName",od,Dd,!1,be);this.foc=this.FBd=this.pivotData=this.hnb=this.Oof=this.l6b=null;this.fY=this.p3b=this.pFb=0;this.Msb=null;this.pTi=(sc,ed)=>{if(ed)if(P.a(sc))this.Ayd(ed,!1);else if(sc=sc.Result){this.Etb=pc.qhd(ed,this.$,this.pivotData.cell,this.fY);var xd=this.xvf(sc.MenuModel.Sections);this.Msb=xd;Fc.iN.set(this.pivotData.cell,ed,xd,this.fY);Vb.a(this.$).oOj(sc);this.Ayd(ed,!0)}};this.oTi=(sc,ed)=>{this.Ayd(ed,!1)};this.nf=(sc,ed)=>{Fc.iN.z8b(ed.Yc.hash)};
this.Sm=(sc,ed)=>{Fc.iN.z8b(ed.Yc.hash)};this.Eza=null;this.yBe=this.p3b=this.GBd=this.pFb=-1;this.ete=this.fY=0;this.UA=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Fc.iN||(Fc.iN=new pc(this.$),O.h(this.$).Ca.Ns(this.nf),O.h(this.$).Ca.xG(this.Sm),O.h(this.$).Ca.r9(this.nf))}obd(fb,Hb){const cc=fb.rawEvent,Hc=fb.cell,od=fb.requiresConfirmation;ib.a(this.$).zx(od,Dd=>{if(Dd){Dd=cc?new Sys.UI.DomEvent(cc):null;this.pivotData=new hb;this.pivotData.pivotName=fb.pivotName;this.pivotData.dataSourceIndex=
fb.dataSourceIndex;this.pivotData.cell=Hc;this.pivotData.yo=fb.optionalPivotMenuAnchorParameter;if(this.pivotData.yo&&0<this.pivotData.yo.AnchorType){this.foc=fb.objectId;this.pFb=fb.objectVersion;const be=this.pivotData.yo.AnchorType;if(4===be||5===be||6===be||11===be||9===be||10===be||8===be)this.hnb=fb.location}else this.FBd=this.foc=null,this.GBd=this.pFb=-1;O.h(this.$).Do(!0);this.$.ak(Hc);this.r0(Dd,Dd?Dd.target:fb.domElement,this.pivotData,Hb,this.qMa())}});return!0}r0(fb,Hb,cc,Hc){if(Object(tb.a)(hb,
cc)){this.pivotData=cc;this.l6b=Hb;this.Oof=fb;this.p3b=this.pivotData.yo?this.pivotData.yo.AnchorValue1:-1;this.fY=this.pivotData.yo?this.pivotData.yo.AnchorType:0;var od=!1,Dd=null;Dd=Fc.iN.get(this.pivotData.cell,Hb,this.fY);od=!!Dd;var be=!0;switch(this.fY){case 4:case 5:case 6:this.Eza=new Sys.UI.Point(this.hnb.x,this.hnb.y);be=!1;break;case 7:var Jb=Sys.UI.DomElement.getBounds(Hb);be=Jb.x+(0<=Jb.x?0:Jb.width);Jb=Jb.y+(0<=Jb.y?0:Jb.height);this.Eza=new Sys.UI.Point(0<=be?be:0,0<=Jb?Jb:0);be=
!1;break;case 8:case 10:case 9:case 11:this.Eza=new Sys.UI.Point(this.hnb.x,this.hnb.y);break;default:this.Eza=null}od&&this.foc===this.FBd&&this.pFb===this.GBd&&this.p3b===this.yBe&&this.fY===this.ete?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Msb=Dd,this.Eza?this.rp(this.Eza,this.qMa()):this.UA?A.a.Fpd(this.$,this.pivotData.cell)&&this.rp(A.a.Afd(this.$,this.pivotData.cell,!1),this.qMa()):super.r0(fb,Hb,
cc,Hc,this.qMa())):1!==Fc.CUh(Hb)&&(be&&(Hb.parentNode.menuFetchStates=1,this.vxj(Hb),this.B3f(!0)),this.$.userOperationManager.Jc(new H.a(126,0,(sc,ed,xd)=>{const le=this.$;return I.p(le.oa.xa,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,le.domElement.id,le.isChromeRtl,le.workbookContext.NovMode,qa.b(sc,this.pTi),qa.a(ed,this.oTi),xd,Hb,this.pivotData.yo)},16),Hc))}}zGd(fb){fb.MenuSectionList.push(...this.Msb)}Ayd(fb,Hb){fb.parentNode.menuFetchStates=2;this.B3f(!1);
if(Hb){if(this.l6b!==fb||this.HHi())this.rp(this.Eza,this.qMa());else if(this.UA&&!this.Eza){if(!A.a.Fpd(this.$,this.pivotData.cell))return;this.rp(A.a.Afd(this.$,this.pivotData.cell,!1),this.qMa())}else super.r0(this.Oof,fb,null,null,this.qMa());this.FBd=this.foc;this.GBd=this.pFb;this.ete=this.fY;this.yBe=this.p3b}}qMa(){return 8!==this.fY&&9!==this.fY&&10!==this.fY&&11!==this.fY}HHi(){switch(this.pivotData.yo?this.pivotData.yo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;
default:return!1}}B3f(fb){const Hb=this.l6b;if(Hb){if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var cc=eb.DOMElementExtensions.hZ(Hb,"ewaprevsrc","");cc=!!cc&&"null"!==cc}else cc=!!eb.DOMElementExtensions.hZ(Hb,"ewaprevsrc","");fb&&cc||!fb&&!cc||(fb?(Hb.setAttribute("ewaprevsrc",Hb.src),Hb.src=wc.a.current.lo(98)):(fb=eb.DOMElementExtensions.hZ(Hb,"ewaprevsrc",""),Hb.src=fb,Hb.setAttribute("ewaprevsrc",null)))}}vxj(fb){this.l6b=fb}static CUh(fb){const Hb=
fb.parentNode.menuFetchStates;void 0===Hb&&(fb.parentNode.menuFetchStates=0);return Hb}}Fc.iN=null;Object(c.a)(Fc,"PivotFilterContextMenuBase",A.a,[]);const fd="FieldList"+x.a.UFe;class Ta extends Fc{constructor(fb,Hb,cc,Hc){super(fb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Hb,cc,Hc,fd)}get Gw(){return"PopulateFieldListPivotMenu"}get qB(){return x.a.xRf}executeCommand(fb,Hb,cc){return this.obd(cc,Hb)?va.Task.Ra(!0):X.a(Hb.command)}wc(fb,Hb,cc){return-1065117584===Hb.command&&!!cc}}Object(c.a)(Ta,
"FieldListPivotContextMenu",Fc,[]);var Fb=a(268),ic=a(30),zb=a(89),Bb=a(765);class ec{}Object(c.a)(ec,"PivotValueFieldSettingsApplyData",null,[]);class Qd{}Qd.emg="valueFieldSettingTabs";Qd.Iih="dataFieldCustomLabel";Qd.WJe="dataFieldSourceLabel";Qd.oVd="showValueAsSelect";Qd.mVd="showValueAsBaseFieldSelect";Qd.nVd="showValueAsBaseItemSelect";Qd.G1d="valueFieldsSettingsFieldName";Object(c.a)(Qd,"CssElementIds",null,[]);var fc=a(87);class cd{constructor(fb,Hb,cc){this.baseItemIndex=this.baseFieldIndex=
this.dataFormat=0;this.dataFormat=fb;this.baseFieldIndex=Hb;this.baseItemIndex=cc}}Object(c.a)(cd,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class jd{constructor(fb,Hb,cc,Hc,od){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=fb;this.activeCell=Hb;this.pivotFieldTitle=cc;this.summarizeBy=Hc;this.showAsValueParameters=od}getActiveCell(){return this.activeCell}}Object(c.a)(jd,"MacroRecorderPivotValueFieldSettingAppliedPayload",
null,[122]);var nd=a(239);class vd{}Object(c.a)(vd,"PivotValueFieldShowValueAsApplyData",null,[]);var wd=a(749),Td=a(45);const jc=`<div id='showValueAsControlBody'><label for='${Qd.oVd}' class='${fc.a.Nl} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Qd.oVd}' class='${fc.a.Mx}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Qd.mVd}'>{1}</label><div><select size=6 id='${Qd.mVd}' class='${fc.a.Mx}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Qd.nVd}'>{2}</label><div><select size=6 id='${Qd.nVd}' class='${fc.a.Mx}'></select></div></div></div>`;
class bd extends nd.a{constructor(fb,Hb,cc,Hc,od,Dd,be,Jb,sc){super(fb);this.htmlSanitizationHelper=this.z7d=this.j5d=this.i5d=this.E1b=this.O6b=this.ZC=null;this.BBf=()=>{var ed=parseInt(this.T$.ee.value,10);this.i1g(ed)?(this.iP.np.disabled=!0,this.jP.np.disabled=!0,this.jP.clear(),bd.Igf(ed)?(this.iP.np.disabled=!1,this.DPb(!1)):bd.Jgf(ed)?(this.iP.np.disabled=!1,this.jP.np.disabled=!1,this.DPb(!0),this.zqf()):this.DPb(!1)):(ed=U.a.ed(1,0,0,1129,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Td.a(this.$).Jt([ed]),this.T$.upj())};this.UNi=()=>{0>this.iP.selectedIndex||this.jP.np.disabled||(this.DPb(!0),this.zqf())};this.iUi=ed=>{this.ZC.cTa();this.jP.np.style.overflowY="scroll";if(ed&&!P.a(ed)){ed=ed.Result;this.jP.clear();for(const xd of ed.BaseItems)this.jP.aY(xd.DisplayString,xd.Id.toString(),xd.Id===ed.SelectedBaseItem);this.DPb(!1)}};this.get_visible=this.Qja;this.set_visible=this.Gna;this.$=Hb;this.cell=cc;this.yo=Hc;this.externalSourceIndex=od;this.Sd=Dd;this.Ysa=be;this.eri=Jb;
this.htmlSanitizationHelper=sc;this.v0j=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.kka()}Qja(){return this.isVisible}Gna(fb){return this.isVisible=fb}get title(){return Z.a.instance.ga(1117)}get uxb(){const fb=this.T$.ee?parseInt(this.T$.ee.value,10):-1,Hb=this.iP.ee?parseInt(this.iP.ee.value,10):-1,cc=this.jP.ee?parseInt(this.jP.ee.value,10):-1;return Object(f.a)(new vd,{SelectedDataFormat:0<=fb?fb:-1,SelectedBaseField:Hb,SelectedBaseItem:cc})}get iP(){return this.i5d}get jP(){return this.j5d}get T$(){return this.z7d}setFocus(){eb.DOMElementExtensions.setFocus(this.T$.np)}render(fb){fb.appendChild(this.domElement)}dispose(){zb.a.pc([this.T$,
this.iP,this.jP,this.O6b,this.E1b]);super.dispose()}hAj(fb){zb.a.pc([this.O6b,this.E1b]);this.T$.clear();for(const Hb of fb.DataFormatTypes)this.T$.aY(bd.MSh(Hb),Hb.toString(),Hb===fb.SelectedDataFormat);this.O6b=this.ze.ie(this.T$.domElement);this.O6b.ka("change",this.BBf);this.iP.clear();for(const Hb of fb.BaseFieldList)this.iP.aY(Hb.DisplayString,Hb.Id.toString(),Hb.Id===fb.SelectedBaseField);this.E1b=this.ze.ie(this.iP.domElement);this.E1b.ka("change",this.UNi);this.ZC=this.Ysa.Gsb(this.jP.np.parentNode,
1E3,null,"",735);this.ZC.cTa();this.BBf(null)}wQ(fb){this.T$.wQ(fb);this.iP.wQ(fb);this.jP.wQ(fb)}kka(){this.htmlSanitizationHelper.Ph(this.domElement,String.format(jc,Z.a.instance.ga(1118),Z.a.instance.ga(1119),Z.a.instance.ga(1120)));this.z7d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.oVd),!1);this.i5d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.mVd),!1);this.j5d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.nVd),!1)}i1g(fb){return this.eri||
!bd.Igf(fb)&&!bd.Jgf(fb)?!0:!!this.iP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Jc(new H.a(108,0,(fb,Hb,cc)=>{var Hc=this.$.oa.xa,od=parseInt(this.iP.ee.value,10);fb=qa.b.call(null,fb,this.iUi);const Dd=I.L(Hc,this.cell,this.externalSourceIndex,this.yo);Dd.selectedBaseField=od;return I.g(Hc,"GetPivotValueFieldSettingsShowValueAsBaseItems",Dd,fb,Hb,cc,null,4)},16),this.Sd)}zqf(){this.jP.clear();this.iP.ee&&(this.ZC.XSa(),this.jP.np.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}DPb(fb){const Hb=
document.getElementById("WACDialogActionButton");this.v0j&&Hb&&(Hb.disabled=fb)}static MSh(fb){switch(fb){case 0:return Z.a.instance.ga(1121);case 1:return Z.a.instance.ga(1122);case 2:return Z.a.instance.ga(1123);case 3:return Z.a.instance.ga(1124);case 4:return Z.a.instance.ga(1125);case 5:return Z.a.instance.ga(1126);case 6:return Z.a.instance.ga(1127);case 7:return Z.a.instance.ga(1128);case 8:return Z.a.instance.ga(1130);case 9:return Z.a.instance.ga(1131);case 10:return Z.a.instance.ga(1132);
case 11:return Z.a.instance.ga(1133);case 12:return Z.a.instance.ga(1134);case 13:return Z.a.instance.ga(1135);case 14:return Z.a.instance.ga(1136);default:return""}}static Igf(fb){return 11===fb||12===fb||14===fb||13===fb||4===fb}static Jgf(fb){return 1===fb||3===fb||2===fb}}Object(c.a)(bd,"ShowValueAsControl",nd.a,[283,2]);class Hd{}Object(c.a)(Hd,"PivotValueFieldSummarizeValueByApplyData",null,[]);const ge="<div id='summarizeValuesByControlBody'>"+`<label class='${fc.a.Nl} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+
`<div id='${"pivotDataFieldSelectDescription"}' class='${fc.a.Nl} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${fc.a.Mx}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${x.a.AG}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class Mb extends nd.a{constructor(fb,Hb){super(fb);this.htmlSanitizationHelper=this.Mge=null;this.get_visible=this.Qja;this.set_visible=this.Gna;this.htmlSanitizationHelper=Hb;this.kka()}get uxb(){const fb=this.ml.ee?parseInt(this.ml.ee.value,
10):-1;return Object(f.a)(new Hd,{Aggregation:0<=fb?fb:-1})}Qja(){return this.isVisible}Gna(fb){return this.isVisible=fb}get title(){return Z.a.instance.ga(1116)}get enabled(){return!this.ml.np.disabled}set enabled(fb){this.ml.np.disabled=!fb}get ml(){return this.Mge}setFocus(){eb.DOMElementExtensions.setFocus(this.ml.np)}render(fb){fb.appendChild(this.domElement)}dispose(){zb.a.Ja(this.ml);super.dispose()}focus(){eb.DOMElementExtensions.setFocus(this.ml.np)}gAj(fb){this.ml.lWd();for(const Hb of fb.AggregationTypes){const cc=
Hb===fb.SelectedAggregation;this.ml.kWc(Mb.jOh(Hb),Hb.toString(),cc,"")}this.ml.X9c();this.ml.np.disabled=fb.AggregationsDisabled}qpj(){this.ml.rpj()}kka(){this.htmlSanitizationHelper.Ph(this.domElement,String.format(ge,Z.a.instance.ga(1101),Z.a.instance.ga(1102)));this.Mge=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Mb.AMf),!1)}static jOh(fb){switch(fb){case 0:return Z.a.instance.ga(1104);case 1:return Z.a.instance.ga(1105);case 2:return Z.a.instance.ga(1106);case 3:return Z.a.instance.ga(1107);
case 4:return Z.a.instance.ga(1108);case 5:return Z.a.instance.ga(1109);case 6:return Z.a.instance.ga(1110);case 7:return Z.a.instance.ga(1111);case 8:return Z.a.instance.ga(1112);case 9:return Z.a.instance.ga(1113);case 10:return Z.a.instance.ga(1114);case 11:return Z.a.instance.ga(1115);default:return""}}}Mb.AMf="pivotDataFieldSelect";Object(c.a)(Mb,"SummarizeValuesByControl",nd.a,[283,2]);var Kc=a(215),Ob=a(468),Mc=a(1261);class Dc extends Bb.a{constructor(fb,Hb,cc,Hc,od,Dd,be,Jb,sc,ed){super(od,
Z.a.instance.ob(61),!0,2,!0);this.a9f=!0;this.htmlSanitizationHelper=this.PTc=this.q7c=this.ctb=this.Ffa=this.GSa=this.qme=null;this.INi=xd=>{Fb.a.any(xd.Errors,le=>-103190598===le.MessageId)&&this.kTa.qpj()};this.hUi=xd=>{xd&&!P.a(xd)&&(xd=xd.Result,this.htmlSanitizationHelper.w4f(this.q7c,Z.a.instance.ga(1099)+ic.a.yg(xd.ValueFieldSourceName)),this.isOlap&&!this.fV?(this.kTa.enabled=!1,this.Ffa.activeTab=this.Ffa.sBc-1):(this.kTa.enabled=!0,this.Ffa.activeTab=0),this.kTa.gAj(xd.PivotValueFieldSettingsSummarizeValueByInfo),
this.GSa.hAj(xd.PivotValueFieldShowValueAsInitialInfo),this.kg())};this.cell=fb;this.yo=Hb;this.externalSourceIndex=cc;this.dmg=Hc;this.Sd=Dd;this.Ysa=be;this.isOlap=Jb;this.fV=sc;this.htmlSanitizationHelper=ed}get kc(){return"ValueFieldSettingsDialog"}get dCa(){return this.qme}get MEb(){return this.Ffa}get kTa(){return this.PTc}get GB(){return 560}dispose(){this.q7c=this.ctb=this.GSa=this.PTc=null;zb.a.Ja(this.Ffa);this.Ffa=null;super.dispose()}initialize(){let fb="<div id='"+Qd.WJe+"' class='"+
fc.a.Nl+"'></div><div id='"+Qd.Iih+"' class='"+fc.a.Nl+"'><label for='"+Qd.G1d+"'>{0}</label><input type='text' id='"+Qd.G1d+"' value='{1}' class='"+fc.a.Mx+" UIFont' /></div><div id='"+Qd.emg+"'></div>";fb=String.format(fb,Z.a.instance.ga(1100),ic.a.yg(this.dmg));this.htmlSanitizationHelper.Ph(this.Fb,fb);this.If||(this.Mra(),this.tt());this.qme=[-103190598];this.i6h();super.initialize()}close(fb){1===fb&&(this.a9f=!1);super.close(fb)}fMe(fb){this.isDisabled=fb;this.domElement.disabled=fb;const Hb=
["input","option","select"];for(let cc=0,Hc=Hb.length;cc<Hc;++cc){const od=this.domElement.getElementsByTagName(Hb[cc]);for(let Dd=0;Dd<od.length;++Dd)od[Dd].disabled=fb}}tt(){this.ctb=document.getElementById(Qd.G1d);this.q7c=eb.DOMElementExtensions.getElementById(this.Fb,Qd.WJe);const fb=eb.DOMElementExtensions.getElementById(this.Fb,Qd.emg);this.PTc=new Mb(document.createElement("div"),this.htmlSanitizationHelper);this.GSa=new bd(document.createElement("div"),this.$,this.cell,this.yo,this.externalSourceIndex,
this.Sd,this.Ysa,!this.isOlap,this.htmlSanitizationHelper);let Hb;this.Ffa=new Mc.a(fb,(Hb=new Gb.a,Hb.add(this.kTa),Hb.add(this.GSa),Hb));this.Ffa.bXf()}KGd(){const fb=new Dc(this.cell,this.yo,this.externalSourceIndex,this.dmg,this.$,this.Sd,this.Ysa,this.isOlap,this.fV,this.htmlSanitizationHelper);fb.initialize();fb.kg()}sQb(){const fb=new Ob.a;if(!this.a9f)return fb.isValid=!0,fb;this.ctb.value.length?fb.isValid=!0:(this.fMe(!0),fb.error=U.a.ed(1,0,750,765,0,1783218700,"PivotTableValueFieldNoBlank"),
this.isDisabled=!0,this.If||(this.Qy.disabled=!0),fb.isValid=!1);return fb}i$e(){this.isDisabled=!1;this.If||(this.Qy.disabled=!1);this.fMe(!1)}zya(fb){const Hb=new L.a(2105621672,0,this.$.xc,30,null);this.$.Ia.Hb(Hb);this.tB(5,fb.ub,"Number Format");return!0}Yp(){this.qoa=String.format(Z.a.instance.ob(61),null);super.Yp()}setFocus(){if(this.If){const fb=eb.DOMElementExtensions.getElementById(this.Fb,Mb.AMf);Kc.a.j_d(fb)}else this.Ffa.setFocus()}Vj(){const fb=this.GSa.uxb,Hb=new cd(fb.SelectedDataFormat,
fb.SelectedBaseField,fb.SelectedBaseItem);return()=>new jd(this.externalSourceIndex,this.cell,this.ctb.value,this.kTa.uxb.Aggregation,Hb)}DG(){const fb=Object(f.a)(new ec,{PivotValueFieldSummarizeValueByApplyData:this.kTa.uxb,PivotValueFieldShowValueAsApplyData:this.GSa.uxb,PivotValueFieldTitle:this.ctb.value});return(Hb,cc,Hc)=>{var od=this.$.oa.xa;Hb=qa.b(Hb,this.INi);const Dd=I.L(od,this.cell,this.externalSourceIndex,this.yo);Dd.pivotValueFieldSettingsApplyData=fb;return I.g(od,"ApplyPivotValueFieldSettings",
Dd,Hb,cc,Hc,null,0)}}wQ(fb){this.$.da.gb(40,()=>{this.GSa.wQ(fb)})}i6h(){this.$.userOperationManager.Jc(new H.a(123,0,(fb,Hb,cc)=>{var Hc=this.$.oa.xa;fb=qa.b.call(null,fb,this.hUi);const od=I.L(Hc,this.cell,this.externalSourceIndex,this.yo);return I.g(Hc,"GetPivotValueFieldSettingsInitial",od,fb,Hb,cc,null,4)},16),this.Sd)}}Object(c.a)(Dc,"ValueFieldSettingsDialog",Bb.a,[]);const $c=x.a.K9g;class td extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateFieldWellContextMenu",1374696078,495005930,
$c,!0,!1,$c,Hb,cc,!1,Hc);this.yo=this.io=this.cell=null;this.Q2d=this.externalSourceIndex=-1;this.TSa=0;this.pAc=-1;this.jL=null;this.d3a=this.fV=this.isOlap=!1}get Gw(){return"PopulateFieldWellContextMenu"}get qB(){return x.a.sJd}executeCommand(fb,Hb,cc,Hc){fb=Hb.command;switch(fb){case -1453503574:Hc=cc.domElement;this.io=cc.fieldItem;this.Q2d=cc.zoneCount;this.TSa=cc.sourceAxis;this.pAc=cc.sourceAxisPos;this.yo=cc.optionalPivotMenuAnchorParameter;this.jL=cc.versionkey;this.isOlap=cc.isOlap;this.fV=
cc.isPpm;this.d3a="fieldItemsupportsImplicitMeasures"in cc?cc.fieldItemsupportsImplicitMeasures:!1;this.cell=cc.cell;this.externalSourceIndex=cc.externalSourceIndex;O.h(this.$).Do(!0);Hc=eb.DOMElementExtensions.getBounds(Hc);fb=new Sys.UI.Point(Hc.x,Hc.y+Hc.height);this.$.isChromeRtl&&(fb.x+=Hc.width);"isKeyboardInput"in cc&&cc.isKeyboardInput?this.rp(fb,!1,1):this.rp(fb,!1);break;case 495005930:break;case -1170196828:Xa.a(this.$).vJ(this.io,this.TSa,this.pAc-1,this.jL,Hb);break;case -889576107:Xa.a(this.$).vJ(this.io,
this.TSa,this.pAc+2,this.jL,Hb);break;case 2033235475:Xa.a(this.$).vJ(this.io,this.TSa,this.Q2d,this.jL,Hb);break;case 389774337:Xa.a(this.$).vJ(this.io,this.TSa,0,this.jL,Hb);break;case -96230454:Xa.a(this.$).vJ(this.io,4,-1,this.jL,Hb);break;case 74086617:Xa.a(this.$).vJ(this.io,1,-1,this.jL,Hb);break;case 1529312473:Xa.a(this.$).vJ(this.io,2,-1,this.jL,Hb);break;case 563292088:this.d3a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Xa.a(this.$).vJ(this.io,
8,-1,this.jL,Hb);break;case -1092351914:Xa.a(this.$).vJ(this.io,0,-1,this.jL,Hb);break;case -2141589616:const od=R.GetServiceTaskFactory.Oa(this.$.da,12,477,Hc.Y3()),Dd=R.GetServiceTaskFactory.Oa(this.$.da,498,499,Hc.Y3());return D.TaskExtensions.za(D.TaskExtensions.Fd([od,Dd],this.$.la),()=>{(new Dc(this.cell,this.yo,this.externalSourceIndex,this.io.Name,this.$,Hb,od.result,this.isOlap,this.fV,Dd.result)).initialize()},this.la);default:return X.a(fb)}return va.Task.Ra(!0)}wc(fb,Hb,cc){fb=!1;switch(Hb.command){case -1453503574:fb=
!!cc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:fb=!0}return fb}CY(){const fb=this.Va.sq(this.menuId);this.A6i(fb,this.pAc,this.Q2d);this.B6i(fb,this.TSa);this.C6i(fb);8===this.TSa&&this.y6i(fb);return fb}A6i(fb,Hb,cc){const Hc=this.Va,od=Hc.Ec();Hb||Hb!==cc-1?!Hb&&Hb<cc-1?(od.buttons.push(Hc.pb(64)),od.buttons.push(Hc.pb(61)),od.buttons.push(Hc.pb(66)),od.buttons.push(Hc.pb(63))):
0<Hb&&Hb<cc-1?(od.buttons.push(Hc.pb(60)),od.buttons.push(Hc.pb(61)),od.buttons.push(Hc.pb(62)),od.buttons.push(Hc.pb(63))):0<Hb&&Hb===cc-1&&(od.buttons.push(Hc.pb(60)),od.buttons.push(Hc.pb(65)),od.buttons.push(Hc.pb(62)),od.buttons.push(Hc.pb(67))):(od.buttons.push(Hc.pb(64)),od.buttons.push(Hc.pb(65)),od.buttons.push(Hc.pb(66)),od.buttons.push(Hc.pb(67)));fb.rc.push(od)}B6i(fb,Hb){const cc=this.Va,Hc=cc.Ec(),od=1!==Hb&&(!this.isOlap||this.fV||8!==Hb||this.d3a),Dd=2!==Hb&&(!this.isOlap||this.fV||
8!==Hb||this.d3a),be=8!==Hb&&-2!==this.io.PivotTableIndex&&(!this.isOlap||this.fV||this.d3a);Hc.buttons.push(cc.pb(4===Hb||this.io.IsSet||-2===this.io.PivotTableIndex||this.isOlap&&!this.fV&&8===Hb&&!this.d3a?72:68));8===this.yo.AnchorType||10===this.yo.AnchorType?(Hc.buttons.push(cc.pb(od?95:97)),Hc.buttons.push(cc.pb(Dd?96:98))):(Hc.buttons.push(cc.pb(od?69:73)),Hc.buttons.push(cc.pb(Dd?70:74)));Hc.buttons.push(cc.pb(be?71:75));fb.rc.push(Hc)}C6i(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(76));
fb.rc.push(Hb)}y6i(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(77));fb.rc.push(Hb)}}Object(c.a)(td,"FieldWellContextMenu",A.a,[]);var Yd=a(1243);class ae extends Fc{constructor(fb,Hb,cc,Hc){super(fb,"PopulatePivotContextMenu",2123758504,912277356,Hb,cc,Hc)}get Gw(){return"PopulatePivotContextMenu"}get qB(){return x.a.DRf}executeCommand(fb,Hb,cc){let Hc=!1;const od=Hb.command;switch(od){case 37023044:Hc=this.obd(cc,Hb);break;case 541421805:case -569786022:Hc=this.Rkd(fb,Hb)}return Hc?va.Task.Ra(!0):
X.a(od)}wc(fb,Hb,cc){fb=!1;switch(Hb.command){case 37023044:fb=!!cc;break;case 541421805:case -569786022:fb=!0}return fb}Rkd(fb,Hb){var cc=8===fb,Hc=this.$,od=$a.a(Hc),Dd=O.h(Hc).ha.Sa.dc;let be=fb=null;cc&&od?(fb=od.chartId,be=od.Wc):!cc&&Dd&&(fb=Dd.floatingObject.id,be=Dd.floatingObject.Wc);return ae.cve(be,260)?(cc={},Hc.ak(cc),cc.FirstColumn=cc.FirstRow=-1,Hc={["rawEvent"]:null,["pivotName"]:null,["cell"]:cc,["requiresConfirmation"]:ae.cve(be,64),["dataSourceIndex"]:be.ExternalSourceIndex},Dd?
(od=Dd.floatingObject,Hc.domElement=Dd.domElement,Hc.objectId=od.id,Hc.objectVersion=od.version):od&&(Hc.domElement=od.Bl,Hc.objectId=od.chartId,Hc.objectVersion=od.BBe),Dd={AnchorType:7},Dd.ChartId=fb,Dd.AnchorValue1=-1,Dd.AnchorValue2=-1,Hc.optionalPivotMenuAnchorParameter=Dd,this.obd(Hc,Hb)):!1}static cve(fb,Hb){return(fb.Attributes&Hb)===Hb}}Object(c.a)(ae,"PivotFilterContextMenu",Fc,[]);var je=a(1316);const Ke=(fb,Hb,cc,Hc,od,Dd,be,Jb,sc,ed=null)=>{ed=fb.Na(41,ed);ed.activeCell=Hb;ed.operationType=
cc;ed.fieldCaption=Hc;ed.prevFieldCaption=od;return I.g(fb,"ExecutePivotTableOperation",ed,Dd,be,Jb,sc,0)},Fd=(fb,Hb,cc,Hc,od,Dd,be,Jb=null)=>{Jb=fb.Na(41,Jb);Jb.activeCell=Hb;Jb.pivotValueFieldSettingsApplyData=cc;return I.g(fb,"ApplyValueFieldSettingsToPivotTable",Jb,Hc,od,Dd,be,0)};var fe=a(152),ne=a(374),ce=a(284),te=a(28),we=a(22);const Pe=x.a.O9g,qf=Pe+".RemoveField",Ve=Pe+".Subtotal",Qe=Pe+".ClearFilter",Ze=Pe+".LayoutSameColumn",Re=Pe+".LayoutNextColumn";class Za extends A.a{constructor(fb,
Hb,cc,Hc){super(fb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Pe,!0,!1,"PivotTableContextMenuRootName",Hb,cc,!0,Hc);this.t2d=this.activeCell=this.fc=null;this.ZY=this.refresh=this.expandCollapse=this.uqd=this.Qjc=!1;this.Qab=this.tb=this.T0a=this.Pz=this.ye=null;this.wba=!1;this.BTi=od=>{od&&!U.a.Wf(od.Errors)&&this.fc&&(this.fc.Oo=od.Result,this.XLb());this.showPivotTableContextMenu()};this.ATi=()=>{};this.jXi=()=>{this.Fcb()};this.iXi=()=>{this.Fcb()};this.NNi=()=>{this.Fcb()};this.MNi=
()=>{this.Fcb()};this.cy=()=>{this.I_d();this.wba=!1};this.Eq=()=>{if(this.wba){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");const od=this.fc;this.grid.wb.Wo(this.grid.ha.qa.activeCell)!==od&&(this.Fcb(),this.oci())}};this.Zoh=new DOMParser;this.tEj=!0;this.grid=O.h(fb);this.Omc=!0}get Gw(){return"PopulatePivotTableContextMenu"}get qB(){return x.a.ERf}executeCommand(fb,Hb,cc){Hb=Hb.command;fb=null;
this.grid=O.h(this.$);this.activeCell=B.o(this.grid.ha.qa.activeCell,this.$);if(this.$.isEditMode&&(this.fc=this.grid.wb.Wo(this.grid.ha.qa.activeCell),!this.fc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),D.TaskExtensions.Uaa();this.t2d=this.$.oa.xa;this.T0a=Object(ab.a)(cb.a,cc.eventArgs);switch(Hb){case 671488277:this.mGj()?this.E_h():(this.Fcb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,
6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,
10);break;case -771066011:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.fSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.fSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.fSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.fSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.fSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;
case -1067664355:this.fSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:cc=Number.parseInvariant(cc.MenuItemId.split(".")[2]);this.fSa(11,cc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Zc(-1556797033,z.a.zb,8,null);break;case 1514686611:this.Iyi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:cc=
Number.parseInvariant(cc.MenuItemId);this.V4g(cc);break;case 1778578888:cc=Number.parseInvariant(cc.MenuItemId);this.hSg(cc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,
16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:fb=X.a(Hb)}return fb||D.TaskExtensions.Uaa()}wc(fb,Hb){fb=!1;switch(Hb.command){case 671488277:fb=sb.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:fb=!0;break;case 1600778266:fb=!0;break;case -556893687:fb=!0;break;case -1966978671:fb=!0;break;case -1951357930:fb=!0;break;case -1390365353:case -1457478532:fb=!0;
break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:fb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:fb=!0;break;case -1007663920:case 234234584:case 1194992911:fb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:fb=
!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:fb=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return fb}mGj(){if(!this.$.isEditMode||this.fc.Dhc)return!1;let fb=this.W7f(!1);return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.fc.isOlap||fb:!this.fc.Dic()||fb}Hc(fb,Hb){let cc=!1;switch(Hb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:cc=
this.NR();break;case -1007663920:case 234234584:cc=this.LEj()||this.NR();break;case 1194992911:cc=this.MEj()||this.NR();break;case 1217404289:cc=!je.j(this.tb.LabelOrDateFilterType)||this.NR();break;case -743135194:cc=!je.m(this.tb.ValueFilterType)&&!je.l(this.tb.ValueFilterType)||this.NR();break;case 771421327:cc=0===this.tb.LabelOrDateFilterType&&0===this.tb.ValueFilterType&&!this.tb.HasManualFilter||this.NR();break;case 1015867427:cc=!je.i(this.tb.LabelOrDateFilterType)||this.NR();break;case 1105960559:cc=
!je.k(this.tb.LabelOrDateFilterType)||this.NR()}return cc||super.Hc(fb,Hb)}Fcb(){this.Qab=this.tb=this.ye=null}dXd(){this.grid.iT(this.Eq);this.$.Ia.UYa(this.cy)}I_d(){this.grid.MN(this.Eq);this.$.Ia.LJb(this.cy)}XLb(){if(this.fc&&this.fc.Oo){this.ye=this.fc.Oo;this.tb=this.fc.Qbc();if(this.L8f()){const fb=this.fc.LK[4===this.ye.CellType?this.fc.s7c-1:this.ye.CurrentFieldIndex-1];fb&&(this.Qab=-2===fb.Index?this.fc.aKe:fb.Caption)}this.cgi();this.tb&&8===this.ye.CellArea&&(this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
this.tb.DataFieldAggregationType,this.Pz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.tb.DataFieldFormatType,this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.tb.BaseFieldIndex,this.Pz.PivotValueFieldTitle=this.tb.Caption)}}W7f(fb){return this.fc?this.fc.isOlap&&!this.fc.nNa(!fb):!1}TEj(){const fb=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.tb.MeasureType&&(!this.fc.vlf||fb&&2===this.tb.MeasureType)}CY(){const fb=
this.Va.sq(this.menuId),Hb=this.Va.Ec(),cc=O.h(this.$).Qb(null);if(this.fc)this.ye&&this.fc.Oo&&this.ye!==this.fc.Oo&&d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.tb&&this.tb!==this.fc.Qbc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return fb;this.uLh(fb);if(this.$.isEditMode){this.refresh&&this.LMh(fb);if(this.ye&&this.tb){var Hc=this.Va.Ec();this.aNh(Hc);this.JLh(Hc);
fb.rc.push(Hc)}this.ZY&&Hb.buttons.push(this.Va.pb(99));this.ye&&this.tb&&this.iMh(fb);if(this.expandCollapse){Hc=this.Va.Xv("ContextMenu.PivotExpandCollapse",null,Z.a.instance.ga(1165),589118293);const od=this.Va.Ec();od.buttons.push(this.Va.pb(243));od.buttons.push(this.Va.pb(244));od.buttons.push(this.Va.pb(245));od.buttons.push(this.Va.pb(246));Hc.menu.rc.push(od);Hc&&0<od.buttons.length&&Hb.buttons.push(Hc)}this.ye&&(Hc=this.Va.Ec(),aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&this.tMh(Hc),this.MMh(Hc),0<Hc.buttons.length&&fb.rc.push(Hc));this.ye&&this.tb&&8===this.ye.CellArea&&8!==this.ye.CellType&&(Hc=this.Va.Ec(),this.TEj()&&this.cNh(Hc),3!==this.ye.CellType&&this.YMh(Hc),fb.rc.push(Hc));!this.fc.Dic()&&""!==(null===cc||void 0===cc?void 0:cc.text)&&this.ye&&0===this.ye.CellType&&aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.XMh(fb);this.Sri()?Hb.buttons.push(this.Va.pb(257)):Hb.buttons.push(this.Va.pb(258));this.uqd?
Hb.buttons.push(this.Va.pb(59)):Hb.buttons.push(this.Va.pb(58))}fb.rc.push(Hb);return fb}vSa(){return this.tb&&this.tb.Caption?20<this.tb.Caption.length:!1}uKa(fb){return this.tb&&this.tb.Caption?fb?this.tb.Caption.substring(0,20)+"...":this.tb.Caption:""}lva(fb){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?we.a.hashCode(fb).toString():fb}aNh(fb){if(this.ye&&this.tb&&4!==this.ye.CellArea){var Hb=this.kja(this.aH("PivotTableContextMenu.Sort",this.lva(this.tb.Caption)),
-1777747317,0,0!==this.tb.SortInfo,Z.a.instance.ga(226)),cc=this.Va.Ec();cc.buttons.push(this.Rd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.tb.SortInfo,Z.a.instance.ga(227)));cc.buttons.push(this.Rd("PivotTableContextMenu.SortDescending",234234584,0,2===this.tb.SortInfo,Z.a.instance.ga(228)));1!==this.ye.CellArea&&2!==this.ye.CellArea||cc.buttons.push(this.Rd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.tb.SortInfo||4===this.tb.SortInfo,Z.a.instance.ga(153)));Hb.menu.rc.push(cc);
Hb&&0<cc.buttons.length&&fb.buttons.push(Hb)}}JLh(fb){if(this.ye&&this.tb&&(1===this.ye.CellArea||2===this.ye.CellArea)){var Hb=this.lGj();const Dd=this.kja(this.aH("PivotTableContextMenu.Filter",this.lva(this.tb.Caption)),-1777747317,0,Hb,Z.a.instance.ga(650)),be=this.Va.Ec();var cc="",Hc=this.vSa(),od=String.format(Z.a.instance.ob(156),this.uKa(Hc));Hc&&(cc=String.format(Z.a.instance.ob(156),this.tb.Caption));Hb=this.lva(this.tb.Caption)+"."+(Hb?"enabled":"disabled");cc=this.Rd(this.aH(Qe,Hb),771421327,
0,!1,od,"0",cc,8,Ma.a.Q2a);Hb=this.lva(this.tb.Caption)+"."+this.tb.LabelOrDateFilterType.toString();this.tb.IsDateField?(od=this.kja(this.aH("PivotTableContextMenu.DateFilter",Hb),-1777747317,0,0!==this.tb.LabelOrDateFilterType,Z.a.instance.ga(96)),this.xLh(od.menu)):(od=this.kja(this.aH("PivotTableContextMenu.LabelFilter",Hb),-1777747317,0,0!==this.tb.LabelOrDateFilterType,Z.a.instance.ga(648)),this.hMh(od.menu));Hb=this.lva(this.tb.Caption)+"."+this.tb.ValueFilterType.toString();Hb=this.kja(this.aH("PivotTableContextMenu.ValueFilter",
Hb),-1777747317,0,0!==this.tb.ValueFilterType,Z.a.instance.ga(649));this.oNh(Hb.menu);Hc=this.Va.Ec();Hc.buttons.push(this.Rd("PivotTableContextMenu.ManualFilter",1514686611,0,this.tb.HasManualFilter,Z.a.instance.ga(93)));be.buttons.push(cc);be.buttons.push(od);be.buttons.push(Hb);Dd.menu.rc.push(be);Dd.menu.rc.push(Hc);Dd&&0<be.buttons.length&&fb.buttons.push(Dd)}}xLh(fb){fb.rc.push(this.kcc(!0,!1));fb.rc.push(this.QSh());fb.rc.push(this.PSh());fb.rc.push(this.HUh());fb.rc.push(this.KUh());fb.rc.push(this.IUh());
fb.rc.push(this.JUh());fb.rc.push(this.LUh());fb.rc.push(this.MUh());fb.rc.push(this.DSh())}mLh(fb){fb.rc.push(this.kcc(!0,!0));fb.rc.push(this.C0h());fb.rc.push(this.LYh())}hMh(fb){fb.rc.push(this.kcc(!0,!1));fb.rc.push(this.y2e(!0));fb.rc.push(this.fPh());fb.rc.push(this.ORh());fb.rc.push(this.w1e(!0));fb.rc.push(this.A0e(!0))}oNh(fb){fb.rc.push(this.kcc(!1,!1));fb.rc.push(this.y2e(!1));fb.rc.push(this.w1e(!1));fb.rc.push(this.A0e(!1));fb.rc.push(this.c5h())}c5h(){const fb=this.Va.Ec();fb.buttons.push(this.Rd("PivotTableContextMenu.Top10",
-1611233597,0,je.l(this.tb.ValueFilterType),Z.a.instance.ga(104)));return fb}ORh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.Contains",786260386,0,10===this.tb.LabelOrDateFilterType,Z.a.instance.ga(651),"10")),fb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.tb.LabelOrDateFilterType,Z.a.instance.ga(652),"11")));return fb}fPh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.BeginsWith",786260386,
0,6===this.tb.LabelOrDateFilterType,Z.a.instance.ga(653),"6")),fb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.tb.LabelOrDateFilterType,Z.a.instance.ga(654),"7")),fb.buttons.push(this.Rd("PivotTableContextMenu.EndsWith",786260386,0,8===this.tb.LabelOrDateFilterType,Z.a.instance.ga(655),"8")),fb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.tb.LabelOrDateFilterType,Z.a.instance.ga(656),"9")));return fb}y2e(fb){const Hb=this.Va.Ec();
if(this.tb){const cc=fb?je.c:je.f;Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.Equals",cc),786260386,0,fb?4===this.tb.LabelOrDateFilterType:18===this.tb.ValueFilterType,Z.a.instance.ga(99),fb?"4":"18"));Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.DoesNotEqual",cc),786260386,0,fb?5===this.tb.LabelOrDateFilterType:19===this.tb.ValueFilterType,Z.a.instance.ga(100),fb?"5":"19"))}return Hb}w1e(fb){const Hb=this.Va.Ec();if(this.tb){const cc=fb?je.c:je.f;Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.GreaterThan",
cc),786260386,0,fb?12===this.tb.LabelOrDateFilterType:20===this.tb.ValueFilterType,Z.a.instance.ga(101),fb?"12":"20"));Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.GreaterThanOrEqualTo",cc),786260386,0,fb?13===this.tb.LabelOrDateFilterType:21===this.tb.ValueFilterType,Z.a.instance.ga(657),fb?"13":"21"));Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.LessThan",cc),786260386,0,fb?14===this.tb.LabelOrDateFilterType:22===this.tb.ValueFilterType,Z.a.instance.ga(102),fb?"14":"22"));Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.LessThanOrEqualTo",
cc),786260386,0,fb?15===this.tb.LabelOrDateFilterType:23===this.tb.ValueFilterType,Z.a.instance.ga(658),fb?"15":"23"))}return Hb}A0e(fb){const Hb=this.Va.Ec();if(this.tb){const cc=fb?je.c:je.f;Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.Between",cc),786260386,0,fb?16===this.tb.LabelOrDateFilterType:24===this.tb.ValueFilterType,Z.a.instance.ga(103),fb?"16":"24"));Hb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.NotBetween",cc),786260386,0,fb?17===this.tb.LabelOrDateFilterType:25===
this.tb.ValueFilterType,Z.a.instance.ga(659),fb?"17":"25"))}return Hb}kcc(fb,Hb){const cc=this.Va.Ec();if(this.tb){var Hc=Z.a.instance.ga(97);const Dd=fb?this.tb.LabelOrDateFilterType.toString():this.tb.ValueFilterType.toString();var od=["PivotTableContextMenu.ClearFilter",this.lva(this.tb.Caption),Dd];fb=fb?this.tb.IsDateField?Hb?1015867427:1105960559:1217404289:-743135194;od.push(fb.toString());od=od.join(".");Hc=this.Rd(od,fb,0,!1,Hc,Dd,Hc,8,Ma.a.Q2a);cc.buttons.push(Hc)}return cc}QSh(){const fb=
this.Va.Ec();this.tb&&fb.buttons.push(this.Rd(this.aH("PivotTableContextMenu.Equals",je.d),786260386,0,26===this.tb.LabelOrDateFilterType,Z.a.instance.ga(99),"26"));return fb}PSh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.Before",786260386,0,27===this.tb.LabelOrDateFilterType,Z.a.instance.ga(111),"27")),fb.buttons.push(this.Rd("PivotTableContextMenu.After",786260386,0,28===this.tb.LabelOrDateFilterType,Z.a.instance.ga(112),"28")),fb.buttons.push(this.Rd("PivotTableContextMenu.Between",
786260386,0,29===this.tb.LabelOrDateFilterType,Z.a.instance.ga(103),"29")));return fb}HUh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.tb.LabelOrDateFilterType,Z.a.instance.ga(109),"30")),fb.buttons.push(this.Rd("PivotTableContextMenu.Today",1778578888,0,31===this.tb.LabelOrDateFilterType,Z.a.instance.ga(108),"31")),fb.buttons.push(this.Rd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.tb.LabelOrDateFilterType,Z.a.instance.ga(110),
"32")));return fb}KUh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.tb.LabelOrDateFilterType,Z.a.instance.ga(114),"33")),fb.buttons.push(this.Rd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.tb.LabelOrDateFilterType,Z.a.instance.ga(113),"34")),fb.buttons.push(this.Rd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.tb.LabelOrDateFilterType,Z.a.instance.ga(115),"35")));return fb}IUh(){const fb=this.Va.Ec();this.tb&&
(fb.buttons.push(this.Rd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.tb.LabelOrDateFilterType,Z.a.instance.ga(116),"36")),fb.buttons.push(this.Rd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.tb.LabelOrDateFilterType,Z.a.instance.ga(117),"37")),fb.buttons.push(this.Rd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.tb.LabelOrDateFilterType,Z.a.instance.ga(118),"38")));return fb}JUh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.tb.LabelOrDateFilterType,Z.a.instance.ga(119),"39")),fb.buttons.push(this.Rd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.tb.LabelOrDateFilterType,Z.a.instance.ga(120),"40")),fb.buttons.push(this.Rd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.tb.LabelOrDateFilterType,Z.a.instance.ga(121),"41")));return fb}LUh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.NextYear",1778578888,0,42===this.tb.LabelOrDateFilterType,
Z.a.instance.ga(122),"42")),fb.buttons.push(this.Rd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.tb.LabelOrDateFilterType,Z.a.instance.ga(123),"43")),fb.buttons.push(this.Rd("PivotTableContextMenu.LastYear",1778578888,0,44===this.tb.LabelOrDateFilterType,Z.a.instance.ga(124),"44")));return fb}MUh(){const fb=this.Va.Ec();if(this.tb){fb.buttons.push(this.Rd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.tb.LabelOrDateFilterType,Z.a.instance.ga(125),"45"));const Hb=this.kja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,je.i(this.tb.LabelOrDateFilterType),Z.a.instance.ga(126));this.mLh(Hb.menu);fb.buttons.push(Hb)}return fb}DSh(){const fb=this.Va.Ec();this.tb&&fb.buttons.push(this.Rd("PivotTableContextMenu.CustomFilter",786260386,0,this.hGj(this.tb.LabelOrDateFilterType),Z.a.instance.ga(107),"26"));return fb}C0h(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.tb.LabelOrDateFilterType,Z.a.instance.ga(127),"46")),fb.buttons.push(this.Rd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.tb.LabelOrDateFilterType,Z.a.instance.ga(128),"47")),fb.buttons.push(this.Rd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.tb.LabelOrDateFilterType,Z.a.instance.ga(129),"48")),fb.buttons.push(this.Rd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.tb.LabelOrDateFilterType,Z.a.instance.ga(130),"49")));return fb}LYh(){const fb=this.Va.Ec();this.tb&&(fb.buttons.push(this.Rd("PivotTableContextMenu.January",1778578888,0,50===this.tb.LabelOrDateFilterType,Z.a.instance.ga(131),
"50")),fb.buttons.push(this.Rd("PivotTableContextMenu.February",1778578888,0,51===this.tb.LabelOrDateFilterType,Z.a.instance.ga(132),"51")),fb.buttons.push(this.Rd("PivotTableContextMenu.March",1778578888,0,52===this.tb.LabelOrDateFilterType,Z.a.instance.ga(133),"52")),fb.buttons.push(this.Rd("PivotTableContextMenu.April",1778578888,0,53===this.tb.LabelOrDateFilterType,Z.a.instance.ga(134),"53")),fb.buttons.push(this.Rd("PivotTableContextMenu.May",1778578888,0,54===this.tb.LabelOrDateFilterType,Z.a.instance.ga(135),
"54")),fb.buttons.push(this.Rd("PivotTableContextMenu.June",1778578888,0,55===this.tb.LabelOrDateFilterType,Z.a.instance.ga(136),"55")),fb.buttons.push(this.Rd("PivotTableContextMenu.July",1778578888,0,56===this.tb.LabelOrDateFilterType,Z.a.instance.ga(137),"56")),fb.buttons.push(this.Rd("PivotTableContextMenu.August",1778578888,0,57===this.tb.LabelOrDateFilterType,Z.a.instance.ga(138),"57")),fb.buttons.push(this.Rd("PivotTableContextMenu.September",1778578888,0,58===this.tb.LabelOrDateFilterType,
Z.a.instance.ga(139),"58")),fb.buttons.push(this.Rd("PivotTableContextMenu.October",1778578888,0,59===this.tb.LabelOrDateFilterType,Z.a.instance.ga(140),"59")),fb.buttons.push(this.Rd("PivotTableContextMenu.November",1778578888,0,60===this.tb.LabelOrDateFilterType,Z.a.instance.ga(141),"60")),fb.buttons.push(this.Rd("PivotTableContextMenu.December",1778578888,0,61===this.tb.LabelOrDateFilterType,Z.a.instance.ga(142),"61")));return fb}iMh(fb){const Hb=this.Va.Ec();if(this.L8f()){var cc=this.fc.LK[4===
this.ye.CellType?this.fc.s7c-1:this.ye.CurrentFieldIndex-1];if(cc&&this.Qab){var Hc=this.Va.Xv("ContextMenu.PivotTableLayout",null,Z.a.instance.ga(646),-1777747317);var od=this.Va.Ec();const Dd=String.format(Z.a.instance.ob(169),this.Qab),be=String.format(Z.a.instance.ob(170),this.Qab);od.buttons.push(this.Rd(Re,-1457478532,0,!cc.IsCompactLayout,Dd));od.buttons.push(this.Rd(Ze,-1390365353,0,cc.IsCompactLayout,be));Hc.menu.rc.push(od);Hc&&Hb.buttons.push(Hc)}}if(1===this.ye.CellArea||2===this.ye.CellArea)this.tb.Caption&&
(cc="",od=this.vSa(),Hc=String.format(Z.a.instance.ob(159),this.uKa(od)),od&&(cc=String.format(Z.a.instance.ob(159),this.tb.Caption)),1===this.ye.CellArea?(cc=this.kja("ContextMenu.PivotTableSubtotal",1801458190,0,this.tb.ShowSubtotal,Hc),Hc=this.Va.Ec(),Hc.buttons.push(this.Va.pb(259)),Hc.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnTop",671485366,638,this.tb.ShowSubtotal&&this.tb.ShowSubtotalAtTop)),Hc.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnBottom",772221736,639,this.tb.ShowSubtotal&&
!this.tb.ShowSubtotalAtTop)),cc.menu.rc.push(Hc),cc&&0<Hc.buttons.length&&Hb.buttons.push(cc)):(od=od?this.aH(Ve,this.lva(Hc)):Ve,Hb.buttons.push(this.Rd(od,1801458190,0,this.tb.ShowSubtotal,Hc,null,cc)))),Hb.buttons.push(this.Rd("ContextMenu.RepeatItemLabels",-556893687,641,this.tb.RepeatItemLabels));1===this.ye.CellArea&&Hb.buttons.push(this.Rd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,640,this.tb.ShowBlankLineAfterEachItem));fb.rc.push(Hb)}XMh(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(247));
fb.rc.push(Hb)}tMh(fb){if(this.$.isEditMode&&this.grid){var Hb=this.grid.ha.qa.activeRange;if(Hb.top===Hb.bottom&&Hb.left===Hb.right&&0!==this.ye.MoveItemsMenuState){Hb=this.kja("PivotTableContextMenu.Move",-1777747317,0,!1,Z.a.instance.ga(73));var cc=this.Va.Ec();this.Oua(cc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(Z.a.instance.ob(162),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&1));this.Oua(cc,"PivotTableContextMenu.MoveUp",713270357,String.format(Z.a.instance.ob(163),
this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&2));this.Oua(cc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(Z.a.instance.ob(160),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&4));this.Oua(cc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(Z.a.instance.ob(161),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&8));Hb.menu.rc.push(cc);cc=this.Va.Ec();this.Oua(cc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(Z.a.instance.ob(167),this.uKa(this.vSa())),
0===(this.ye.MoveItemsMenuState&16));this.Oua(cc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(Z.a.instance.ob(164),this.uKa(this.vSa())),0===(this.ye.MoveItemsMenuState&32));this.Oua(cc,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(Z.a.instance.ob(165),this.uKa(this.vSa())),0===(this.ye.MoveItemsMenuState&64));this.Oua(cc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(Z.a.instance.ob(166),this.uKa(this.vSa())),0===(this.ye.MoveItemsMenuState&
128));Hb.menu.rc.push(cc);fb.buttons.push(Hb)}}}MMh(fb){var Hb="";let cc="";var Hc=!1;3===this.ye.CellType?Hb=Z.a.instance.ga(643):8===this.ye.CellType?this.fc&&(Hb=String.format(Z.a.instance.ob(168),this.fc.aKe)):this.tb&&((Hc=this.vSa())&&(cc=String.format(Z.a.instance.ob(168),this.tb.Caption)),Hb=String.format(Z.a.instance.ob(168),this.uKa(Hc)));Hb&&(Hc=Hc?this.aH(qf,this.lva(Hb)):qf,Hb=this.Rd(Hc,-1951357930,0,!1,Hb,null,cc,8,Ma.a.Mad),fb.buttons.push(Hb))}uLh(fb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(43));
this.tb&&this.ye&&this.$.isEditMode&&(0===this.ye.CellType||4===this.ye.CellType)&&Hb.buttons.push(this.Va.pb(136));if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&aa.EwaSettings.sa(102)&&this.grid&&this.grid.ha){const cc=this.grid.ha.qa.selectedRanges;cc&&1===cc.length&&(cc[0].isSingle||this.grid.wb.dNa(cc[0]))&&this.grid.wb.exa(cc[0])&&!this.grid.wb.Yzb(cc[0])&&Hb.buttons.push(this.Va.pb(this.grid.wb.Wgf(cc[0])?217:216))}fb.rc.push(Hb)}LMh(fb){const Hb=
this.Va.Ec();Hb.buttons.push(this.Va.pb(100));fb.rc.push(Hb)}cNh(fb){const Hb=2===this.tb.MeasureType&&!this.tb.IsNumeric,cc=this.Va.Xv("ContextMenu.SummarizeValuesBy",null,Z.a.instance.ga(644),-249874296),Hc=this.Va.Ec();Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesBySum",-1255320719,1104,0===this.tb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCount",1746132849,1105,1===this.tb.DataFieldAggregationType));Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByAverage",
-771066011,1106,2===this.tb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMax",835007294,1107,3===this.tb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMin",929115636,1108,4===this.tb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByProduct",1935475057,1109,5===this.tb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.W7f(!0)||Hb));2!==this.tb.MeasureType&&(Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1110,6===this.tb.DataFieldAggregationType)),Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1111,7===this.tb.DataFieldAggregationType)),Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1112,8===this.tb.DataFieldAggregationType)),Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariant",
1668427539,1113,9===this.tb.DataFieldAggregationType)),Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1114,10===this.tb.DataFieldAggregationType)));this.fc&&this.fc.Dic()&&Hc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1115,11===this.tb.DataFieldAggregationType));cc.menu.rc.push(Hc);fb.buttons.push(cc)}YMh(fb){const Hb=this.Va.Xv("ContextMenu.ShowValuesAs",null,Z.a.instance.ga(645),-1128612833),cc=this.Va.Ec();cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1121,0===this.tb.DataFieldFormatType));cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1128,7===this.tb.DataFieldFormatType));cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1127,6===this.tb.DataFieldFormatType));cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1126,5===this.tb.DataFieldFormatType));cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1131,9===this.tb.DataFieldFormatType));
cc.buttons.push(this.Rd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1132,10===this.tb.DataFieldFormatType));if(this.fc&&this.fc.LK&&0<this.fc.LK.length||this.fc.v$&&0<this.fc.v$.length){const Hc=this.kja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1133,11===this.tb.DataFieldFormatType),od=this.Va.Ec(),Dd=this.bNh();for(let be=0;be<Dd.length;be++){const Jb=Dd[be];od.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Jb.Caption,-2031744961,1133,11===this.tb.DataFieldFormatType&&
this.tb.BaseFieldIndex===Jb.Index,Jb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Jb.Index))}Hc.menu.rc.push(od);cc.buttons.push(Hc)}Hb.menu.rc.push(cc);fb.buttons.push(Hb)}showPivotTableContextMenu(){this.uqd=!0;this.expandCollapse=this.ZY=this.refresh=!1;var fb=this.$,Hb=O.h(fb),cc=ib.a(fb).yva();if(cc){var Hc=Xa.a(fb);if(null===Hc||void 0===Hc?0:Hc.FTd)this.uqd=Ra.f(fb.dg);Hc=fb.$b;this.ZY=cc.supportsBIExplore&&!!za.a(fb)&&Hc.m2(32768);Hc.allowInteractivity&&(fb=Hb.Qb(null),(null===
fb||void 0===fb?0:fb.cell)&&(fb.cell.J0c||fb.cell.I8f)&&(this.expandCollapse=!0),Hc.allowManualDataRefresh&&(this.refresh=!0))}fb=null;cc=1;this.T0a&&1!==this.T0a.ub?(fb=new Sys.UI.Point(this.T0a.clientPoint.x,this.T0a.clientPoint.y),cc=this.T0a.ub):(Hb=sb.e(Hb,this.$))&&(fb=new Sys.UI.Point(Hb.x+(this.$.isChromeRtl?0:Hb.width),Hb.y+Hb.height));z.a.zb=cc;this.Qjc=3===cc;this.rp(fb,!0,cc);this.wba=!0;this.dXd()}oci(){const fb=new L.a(1114549926,0,this.$.xc,19,null);this.$.Ia.Hb(fb)}E_h(){if(this.fc&&
this.fc.Oo){var fb=this.fc.Oo.CurrentCol;if(this.fc.Oo.CurrentRow===this.activeCell.FirstRow&&fb===this.activeCell.FirstColumn){this.XLb();this.showPivotTableContextMenu();return}}fb=new H.a(228,0,(Hb,cc,Hc)=>ce.l(this.$.oa.xa,this.activeCell,qa.b(Hb,this.BTi),qa.a(cc,this.ATi),Hc,null),16);this.$.userOperationManager.Jc(fb,null)}Sri(){if(Ba.a.Ad(this.$)){var fb=this.$.da.Aa(441);if(fb)return fb.Sr}else if(fb=this.$.da.Aa(346))return fb.Sr;return!1}aH(fb,Hb){return fb+"."+Hb}performPivotTableOperation(fb,
Hb){const cc=te.a.Ya.Ub;if(!this.fc||!this.tb&&this.ye&&3!==this.ye.CellType)this.kj();else{var Hc=this.fc.isOlap;ib.a(this.$).zx(Hc,od=>{od&&this.$.Jc(fb,(Dd,be,Jb)=>Ke(this.t2d,this.activeCell,Hb,this.tb?this.tb.Caption:null,this.Qab,qa.b(Dd,this.jXi),qa.a(be,this.iXi),Jb,null,this.$.oa.xa.Wb()),cc,0,4,229)})}}applyValueFieldSettingsToPivotTable(fb,Hb=!1){const cc=te.a.Ya.Ub;this.fc&&this.tb?(Hb&&2===this.tb.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
Hb=this.fc.isOlap,ib.a(this.$).zx(Hb,Hc=>{Hc&&this.$.Jc(fb,(od,Dd,be)=>Fd(this.t2d,this.activeCell,this.Pz,qa.b(od,this.NNi),qa.a(Dd,this.MNi),be,null,this.$.oa.xa.Wb()),cc,0,4,231)})):this.kj()}Rd(fb,Hb,cc,Hc,od=null,Dd=null,be=null,Jb=8,sc=null,ed=!1){Hc&&(fb+=".Checked");ed&&(fb+=".Disabled");this.Va.jpd(fb)&&this.Va.fLd(fb);cc=od||Z.a.instance.ga(cc);fb=this.Va.YHa(fb,cc,Hb,null,"None",Dd,ed,null);fb.Sxc(null);be&&fb.JR(be);Hc?fb.LR("Image16by16",3,Ma.a.oaa):sc?fb.LR("Image16by16",Jb,sc):fb.K3b();
return fb}kja(fb,Hb,cc,Hc,od=null){cc=od||Z.a.instance.ga(cc);this.Va.jpd(fb)?this.Va.fLd(fb):this.Va.fLd(fb+".Checked");Hc&&(fb+=".Checked");this.tEj&&(cc=this.Zoh.parseFromString(cc,"text/html").body.innerText);fb=this.Va.v5c(fb,null,cc,Hb,3,Ma.a.oaa);fb.Hdf=Hc;!Hc&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&fb.K3b();return fb}cgi(){this.Pz=Object(f.a)(new ec,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new Hd,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new vd,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}fSa(fb,Hb){this.Pz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=fb;this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Hb;this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}bNh(){const fb=[];if(this.fc&&this.fc.v$&&0<this.fc.v$.length)for(const Hb of this.fc.v$)Hb&&fb.push(Hb);if(this.fc&&this.fc.LK&&0<this.fc.LK.length)for(const Hb of this.fc.LK)Hb&&fb.push(Hb);fb.sort((Hb,
cc)=>Hb.Index-cc.Index);return fb}L8f(){if(!this.ye||!this.fc||!this.fc.LK)return!1;const fb=1===this.ye.CellArea||4===this.ye.CellType&&this.ye.IsRowAxis,Hb=4===this.ye.CellType?0<this.fc.s7c:0<this.ye.CurrentFieldIndex;return 1<this.fc.LK.length&&fb&&Hb}wKa(fb){const Hb=[];3===fb?this.$.isEditMode?Hb.push(...[La.a.CMf,La.a.EMf,La.a.e5i]):Hb.push(...[La.a.copy]):2===fb&&Hb.push(La.a.aBe);return Hb}kj(){const fb=U.a.ed(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");Td.a(this.$).kj(fb)}lGj(){return this.tb?
0!==this.tb.LabelOrDateFilterType||0!==this.tb.ValueFilterType||this.tb.HasManualFilter:!1}hGj(fb){return 62<=fb&&65>=fb}Iyi(){if(this.activeCell&&this.tb&&this.fc){var fb={};fb.cell=this.activeCell;fb.dataSourceIndex=this.fc.externalSourceIndex;fb.fieldId=this.tb.Index.toString();fb.isOlap=this.fc.isOlap;fb.confirmationRequired=this.fc.confirmationRequiredForDataOps;var Hb={};Hb.showPivotFilterDialogCommandData=fb;this.$.Zc(492140419,z.a.zb,19,Hb)}}V4g(fb){this.activeCell&&this.tb&&this.fc&&this.$.userOperationManager.Jc(new H.a(153,
0,(Hb,cc,Hc)=>I.A(this.$.oa.xa,this.activeCell,this.fc.externalSourceIndex,this.tb.Index.toString(),fb,Hb,cc,Hc,null,null)),null)}hSg(fb){!(30>fb||61<fb)&&this.activeCell&&this.tb&&this.fc&&this.$.userOperationManager.Jc(new H.a(152,0,(Hb,cc,Hc)=>I.e(this.$.oa.xa,this.activeCell,this.fc.externalSourceIndex,this.tb.Index.toString(),fb,Hb,cc,Hc,null,null)),null)}applyPivotSort(fb){if(this.fc&&this.tb&&this.activeCell&&this.ye){var Hb=1===this.ye.CellArea||2===this.ye.CellArea;8===this.ye.CellArea?ne.a(this.$.userOperationManager,
(cc,Hc,od)=>ce.b(this.$.oa.xa,this.activeCell,fb,this.tb.Caption,cc,Hc,od,null),cc=>new H.a(1015,0,cc,void 0,null),null):Hb&&(Hb=1===this.ye.CellArea?1:2,this.$.sa(600)?fe.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.tb.Index.toString(),this.tb.Caption,this.fc.isOlap?"":this.tb.Caption,Hb,1===fb):fe.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.tb.Index.toString(),1===
fb))}}NR(){return!this.fc||!this.fc.isActionable}LEj(){return(this.ye||this.fc)&&4!==this.ye.CellType&&(0!==this.ye.CellType||8!==this.ye.CellArea||this.fc.v$&&this.fc.v$.length||this.fc.LK&&this.fc.LK.length)?!1:!0}MEj(){return this.ye&&this.fc&&(1===this.ye.CellArea||2===this.ye.CellArea)&&this.fc.wQb&&this.fc.wQb.length?!1:!0}Oua(fb,Hb,cc,Hc,od){fb.buttons.push(this.Rd(Hb,cc,0,!1,Hc,null,null,8,null,od))}}Object(c.a)(Za,"PivotTableContextMenu",A.a,[]);class Xb{compare(fb,Hb){return(fb||"").localeCompare(Hb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(Xb,"DigitsAsNumberComparer",null,[338]);var jb=a(1102),Sb=a(157),lc=a(347),oc=a(267),Qc=a(24),Kb=a(145);const hc=x.a.Q9g;class Cc extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,hc,!0,!1,"TableFieldListContextMenuRoot",Hb,cc,!1,Hc);this.q6b=null;this.uBd=0;this.QEa=null;this.grid=O.h(fb)}get Gw(){return"PopulateTableFieldListContextMenu"}get qB(){return x.a.GRf}get AK(){this.QEa||(this.QEa=
this.$.da.Aa(261));return this.QEa}executeCommand(fb,Hb,cc){fb=Hb.command;switch(fb){case 639960842:this.applyTableFieldList(cc);this.AK.Ada();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.uBd}`);this.AK.Ada();break;case 1833782813:this.AK.showCallout();break;default:return X.a(fb)}return va.Task.Ra(!0)}applyTableFieldList(fb){var Hb=fb.MenuItemId.toString();aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Hb=Hb.replace("'","''"),Hb=Hb.replace("[","'["),Hb=Hb.replace("]","']"));var cc=Object(ab.a)(String,fb.SourceControlId);const Hc={};Hc.PulloutField=Hb;Hc.PulloutCardPath=fb.SourceCardKeyPath;Hc.PulloutCardSourceRow=fb.SourceCardRow;Hc.PulloutCardSourceColumn=fb.SourceCardColumn;if(this.AK.bN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Hc.ParameterType=2;fb=fb.ColumnIndex;if(void 0===fb||null===fb){if(void 0===cc||null===cc){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}fb=0<=this.AK.NPf?this.AK.NPf:parseInt(cc.substring(20+Hb.length+1,cc.length),10);if(isNaN(fb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${cc}`);return}}Hc.PulloutRichColumnSourceIndex=fb;if(this.QEa.EPg){this.sQg(Hb,Hc);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Hc.ParameterType=4,cc=this.AK.selectedRange.right,Ba.a.pAb()&&this.QEa.Dwa&&(Hc.ParameterType=8,fb=this.AK.Lla.top,fb=
Qc.Range.vP(cc)+fb,Hb==jb.d?(Hb="=DAYS("+fb+", TODAY())",Kb.a("DateFormulaPulledOut_DaysFromToday")):Hb==jb.g?(Hb="=IF(TODAY() < "+fb+", DATEDIF(TODAY(), "+fb+', "Y"), DATEDIF('+fb+', TODAY(), "Y"))',Kb.a("DateFormulaPulledOut_YearsFromToday")):Hb==jb.c?(Hb="=TEXT("+fb+', "dddd")',Kb.a("DateFormulaPulledOut_DayOfWeek")):Hb==jb.f?(Hb="=TEXT("+fb+', "mmmm")',Kb.a("DateFormulaPulledOut_MonthOfYear")):Hb==jb.e?(Hb="EOMONTH("+fb+", 0)",Hb="=DATE(YEAR("+Hb+"), MONTH("+Hb+"), DAY("+Hb+"))",Kb.a("DateFormulaPulledOut_EndOfMonth")):
Hb==jb.b&&(Hb="="+fb+" + 1",Kb.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Hc.PulloutCardSourceColumn&&null!==Hc.PulloutCardSourceColumn&&(cc=Hc.PulloutCardSourceColumn+1),Hc.PulloutRichColumnSourceIndex=cc;this.rRd(Hb,Hc)}rRd(fb,Hb,cc=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.uBd}, SelectedColumnIndex, ${Hb.PulloutRichColumnSourceIndex}`);fb=Object(f.a)(new oc.a,{Text:fb});this.grid.setCell(fb,this.AK.Lla,0,127,Hb,cc);this.grid.focus();
this.q6b=null;this.AK.Ada();this.AK.poj()}wc(fb,Hb,cc){if(fb=this.$.isEditMode&&aa.EwaSettings.sa(128)&&!!this.AK)switch(Hb.command){case -1085236154:break;case 639960842:fb=!!cc;break;case 1833782813:fb=this.AK.uwa&&this.AK.bDb;break;default:fb=!1}return fb}r0(fb,Hb,cc){this.$.isEditMode&&(this.q6b=this.oMh(Object(ab.a)(317,cc)),super.r0(fb,Hb,null,null,!1))}CY(){return this.q6b}u5c(fb){if(!this.AK||!fb||!fb.Pk)return d.ULS.shipAssertTag(537166994,0,!!this.AK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!fb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),fb&&d.ULS.shipAssertTag(537166992,0,!!fb.Pk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let Hb=new Gb.a;for(const Hc of fb.Pk){fb=new Gb.a;fb.add(Hc.ColumnName);fb.add(Hc.ColumnIndex.toString());let od=new Gb.a;var cc=null;Ba.a.pAb()&&this.QEa.Dwa?od=vb.toList(vb.select(vb.asEnumerable(Hc.FieldInfoDataList),Dd=>Dd.Name)):(cc=
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Xb:new nb.a,od=vb.OBc(vb.concat(od,vb.select(vb.asEnumerable(Hc.FieldInfoDataList),Dd=>Dd.Name)),Dd=>Dd,cc));cc=new Gb.a;cc.add(vb.toArray(vb.concat(fb,od)));Hb=vb.toList(vb.concat(Hb,cc))}return vb.toArray(Hb)}oMh(fb){var Hb=this.u5c(fb);if(!Hb||!Hb.length)return this.q6b=null;fb=this.Va;const cc=fb.sq(this.menuId);let Hc=fb.Ec();const od=1<Hb.length,Dd=Ba.a.pAb()&&this.QEa.Dwa;this.uBd=Hb.length;
for(const be of Hb){Dd?Hc.title="Calculate Date Information":od||(Hc.title=be[0]);Hb=fb.Ec();for(let Jb=2,sc=be.length;Jb<sc;++Jb)!Dd||be[Jb]!=jb.d&&be[Jb]!=jb.e||(cc.rc.push(Hc),Hc=fb.Ec()),(od?Hb.buttons:Hc.buttons).push(fb.YHa("ApplyTableFieldList."+be[Jb]+"."+be[1],be[Jb],639960842,null,"None",be[Jb],!1,void 0,!0));if(od){const Jb=fb.Xv("ApplyTableFieldList."+be[0],this.menuId,be[0],798637440);Jb.menu.rc.push(Hb);Hc.buttons.push(Jb)}}cc.rc.push(Hc);return cc}sQg(fb,Hb){const cc=U.a.ed(12,1,0,
898,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(aa.EwaSettings.kz()){const Hc=new lc.a(this.$,cc);Hc.cP(()=>{2===Hc.returnValue&&this.rRd(fb,Hb,8)})}else{const Hc=new Sb.ErrorDialog(this.$,cc);Hc.cP(()=>{2===Hc.returnValue&&this.rRd(fb,Hb,8)});Hc.kg()}}}Object(c.a)(Cc,"PulloutFieldListContextMenu",A.a,[]);const Ka=x.a.IRf;class Ib extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateRichTextContextMenu",679816325,1151222423,Ka,!0,!1,Ka,Hb,cc,!0,Hc);this.grid=O.h(fb)}get Gw(){return"PopulateRichTextContextMenu"}get qB(){return x.a.IRf}wc(fb,
Hb,cc){return-1687037502===Hb.command&&!!cc&&this.grid.fb}executeCommand(fb,Hb,cc){this.showRichTextFloatie(cc);return va.Task.Ra(!0)}wKa(){return[La.a.v2g]}showRichTextFloatie(fb){var Hb=Object(ab.a)(cb.a,fb.eventArgs);Hb&&(fb=this.wKa(Hb.ub),Hb=new Sys.UI.Point(Hb.Ea.clientX,Hb.Ea.clientY),this.showFloatie(fb,new Sys.UI.Bounds(Hb.x,Hb.y,0,0),2))}}Object(c.a)(Ib,"RichTextContextMenu",A.a,[]);var dc=a(101),yc=a(576);const Eb=x.a.P9g;class Ac extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,Eb,!0,!1,"SheetTabContextMenuRootName",Hb,cc,!1,Hc);this.Hjc=this.bic=!1}get Gw(){return"PopulateSheetOpsContextMenu"}get qB(){return x.a.JRf}executeCommand(fb,Hb,cc){if(lb.a(this.$))return va.Task.Ra(!0);this.$.isEditMode&&(fb=cc[x.a.y7f],fb=fb.x&&fb.y?new Sys.UI.Point(fb.x+(this.$.isChromeRtl?10:-10),fb.y):eb.DOMElementExtensions.getLocation(cc[x.a.z7f]),this.rp(fb,!1));return va.Task.Ra(!0)}wc(fb,Hb,cc){return-1075099431===Hb.command&&!!cc}CY(){const fb=this.Va.sq(this.menuId),
Hb=this.$.isEditMode;this.s1j();this.cMh(fb,Hb);this.SLh(fb);this.WMh(fb);return fb}d_b(fb,Hb,cc,Hc){fb.push(this.Va.pb(Hb?cc:Hc))}cMh(fb,Hb){var cc=this.Va;const Hc=cc.Ec();Hc.buttons.push(cc.pb(54));this.d_b(Hc.buttons,this.Hjc,127,56);Hc.buttons.push(cc.pb(55));Hb&&this.d_b(Hc.buttons,this.Hjc,126,125);Hc.buttons.push(cc.pb(158));Hb=this.$.va.na;aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.aK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
Hb&&Hb.$d&&(Hb.$d.iz||Hb.$d.cK||Hc.buttons.push(cc.pb(299)));this.$.ea.FMb&&m.AFrameworkApplication.Lsd(yc.a)&&(Hb=Object(ab.a)(dc.a,this.$.na))&&Qb.p(Hb)&&this.$.isEditMode&&(Hc.buttons.push(cc.pb(277)),Hb.isLockPausedInSession?Hc.buttons.push(cc.pb(279)):Hb.Nh&&Hc.buttons.push(cc.pb(278)));Hb=cc.Xv("ContextMenu.TabColor",null,Z.a.instance.ga(517),1841703919);cc=cc.s5c(467002767,1549407384,540,-221093529,this.qB);Hb.menu.rc.push(cc);Hc.buttons.push(Hb);fb.rc.push(Hc)}SLh(fb){const Hb=this.Va.Ec();
this.d_b(Hb.buttons,this.Hjc,114,112);this.d_b(Hb.buttons,!this.bic,115,113);fb.rc.push(Hb)}WMh(fb){if(aa.EwaSettings.sa(418)&&!Qb.e(this.$.va.na)){var Hb=this.Va,cc=Hb.Ec();cc.buttons.push(Hb.pb(263));fb.rc.push(cc)}}s1j(){let fb,Hb;({c5c:fb,IGe:Hb}=this.$.b5c());this.Hjc=1===fb;this.bic=0<Hb}}Object(c.a)(Ac,"SheetOpsContextMenu",A.a,[]);var ld=a(517);class Vd extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",
Hb,cc,!0,Hc)}get Gw(){return"PopulateSlicerContextMenu"}get qB(){return x.a.KRf}Hc(fb,Hb){var cc=!0;switch(Hb){case -231711729:cc=!1;break;case -1909381757:cc=this.jdc();cc=!!cc&&cc.Aoi;break;case 1312363469:cc=!0}return!cc||super.Hc(fb,Hb)}executeCommand(fb,Hb,cc){if(!this.$.isEditMode)return D.TaskExtensions.Uaa();fb=Hb.command;Hb=this.jdc();let Hc=null;switch(fb){case 2108047455:Hb&&Hb.aDe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;
case -1909381757:Hb&&Hb.S3b();break;case 1312363469:this.showSlicerContextMenu(cc);break;default:Hc=X.a(fb)}return Hc||D.TaskExtensions.Uaa()}wc(fb,Hb,cc){fb=!1;switch(Hb.command){case -231711729:case 2108047455:case -1909381757:fb=!0;break;case 1312363469:fb=!!cc}return fb}CY(){const fb=this.Va.sq(this.menuId);var Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(252));Hb.buttons.push(this.Va.pb(253));Hb.buttons.push(this.Va.pb(254));fb.rc.push(Hb);Hb=this.Va.Ec();this.iui()?Hb.buttons.push(this.Va.pb(266)):
Hb.buttons.push(this.Va.pb(267));fb.rc.push(Hb);return fb}iui(){if(Ba.a.Ad(this.$)){var fb=this.$.da.Aa(439);if(fb)return fb.Sr}else if(fb=this.$.da.Aa(371))return fb.Sr;return!1}showSlicerContextMenu(fb){var Hb=Object(ab.a)(cb.a,fb.eventArgs);fb=this.Mbc(Object(ab.a)(cb.a,fb.eventArgs));Hb=Hb.ub;z.a.zb=Hb;this.rp(fb,!1,Hb)}G_e(fb){const Hb=this.Va.Ec(),cc=this.Va.Ec();cc.buttons.push(this.Va.pb(255));cc.buttons.push(this.Va.pb(256));const Hc=this.Va.v5c("ContextMenu.SlicerSort",null,Z.a.instance.ga(2176),
-814639094,0,Ma.a.JTe);Hc.menu.rc.push(cc);Hb.buttons.push(Hc);fb.rc.push(Hb)}DGj(fb){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&fb.Mb.className===Ma.a.xad||aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===fb.ub}Mbc(fb){var Hb=O.h(this.$).ha.Sa.dc;let cc=fb&&1!==fb.ub&&fb.clientPoint?fb.clientPoint:Sys.UI.DomElement.getLocation(Hb.domElement);if(this.DGj(fb)){var Hc=this.jdc();
Hc&&(fb.Mb.className===Ma.a.xad&&(cc=ja.HelperMethods.vwb(fb.Ea)),1===fb.ub&&(cc=ea.a(this.$).Ija(eb.DOMElementExtensions.getLocation(Hc.frame))))}else if(fb=this.jdc())fb=this.GVh(fb.frame),(Hc=ja.HelperMethods.LC(this.$.rf,this.$.domElement,O.h(this.$).rtl,!1))?(fb.x=ea.a(this.$).ki(fb.x-Hc.x)+Hc.x,fb.y=ea.a(this.$).ki(fb.y-Hc.y)+Hc.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),cc.y+=fb.y,cc.x+=fb.x;fb=this.$.domElement;Hc=O.h(this.$).rtl;Hb=ja.HelperMethods.LC(Hb.ug.domElement,
fb,Hc);cc.y=Math.max(cc.y,Hb.y);cc.x=Math.max(cc.x,Hb.x);return cc}jdc(){const fb=O.h(this.$).ha.Sa.dc;d.ULS.shipAssertTag(537166988,0,!!fb);return ld.a(this.$).gH(fb.floatingObject.id)}GVh(fb){let Hb=new Sys.UI.Point(fb.offsetParent.offsetLeft,fb.offsetParent.offsetTop);var cc=O.h(this.$);if(!cc)return Hb;const Hc=O.h(this.$).rtl;Hb=ja.HelperMethods.LC(fb,this.$.Yq.ownerDocument.body,Hc);cc.BGe(Hb);Hb.x=Hc?this.$.Yq.clientWidth-Hb.x-fb.clientWidth:Hb.x;fb=cc.view.aqb;cc=Hc?-cc.FR.mca(fb.x):fb.x;
Hb.x-=cc;Hb.y-=fb.y;return Hb}}Object(c.a)(Vd,"SlicerContextMenu",A.a,[]);class Od{constructor(fb,Hb,cc){this.type=fb;this.N9g=Hb;this.vr=cc}}Object(c.a)(Od,"TimeSlicerRibbonButtonParameter",null,[]);class he extends A.a{constructor(fb,Hb,cc,Hc){super(fb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,he.ZRj,!0,!1,he.QKb,Hb,cc,!1,Hc);this.o1a=0;this.yOe=this.nva=this.Fsa=null}get Gw(){return"PopulateTimeSlicerLevelMenu"}get qB(){return x.a.NRf}executeCommand(fb,Hb,cc){fb=Hb.command;switch(fb){case 2000085697:fb=
cc.DOMElement;this.Fsa=cc.ChangeLevelCallback;this.nva=cc.GetLevelLabelCallback;this.o1a=cc.CurrentLevel;const Hc=cc.DomEvent;N.g(Hc);const od=cc.location;cc=cc.levelLabelText;this.yOe=eb.DOMElementExtensions.ez(document.activeElement,"iframe")&&cc?cc.parentNode:null;cc=Sys.UI.DomElement.getBounds(cc);cc.x=od.x;cc.y=od.y;this.r0(Hc,fb,cc,Hb,!0);break;case -649826274:this.Fsa(0);break;case 149600865:this.Fsa(1);break;case -2012435159:this.Fsa(2);break;case -1979934975:this.Fsa(3);break;case 1634477200:eb.DOMElementExtensions.setFocus(this.yOe);
break;default:return X.a(fb)}return va.Task.Ra(!0)}wc(fb,Hb,cc){fb=!1;switch(Hb.command){case 2000085697:fb=!!cc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:fb=!0}return fb}r0(fb,Hb,cc){fb=Sys.UI.DomElement.getBounds(Hb);cc.x=ea.a(this.$).ki(cc.x);cc.y=ea.a(this.$).ki(cc.y);fb.x=ea.a(this.$).ki(fb.x);fb.y=ea.a(this.$).ki(fb.y);fb=new Sys.UI.Point(fb.x+cc.x,fb.y+cc.y);this.showContextMenu(new Sys.UI.Bounds(fb.x,fb.y-cc.height,cc.width,cc.height))}CY(){const fb=
this.Va,Hb=fb.sq(this.menuId),cc=fb.Ec();for(let od=0;3>=od;od++){const Dd=this.nva(od);var Hc=he.WPh(od);Hc=fb.Rah(Hc.N9g,Hc.vr,this.o1a===od,he.aCe);Hc.label=Dd;Hc.JR(Dd);this.o1a===od?Hc.LR("Image16by16",8,he.aCe):Hc.K3b();cc.buttons.push(Hc)}Hb.rc.push(cc);return Hb}static WPh(fb){let Hb=null;switch(fb){case 0:Hb=new Od(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Hb=new Od(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Hb=new Od(89,"ContextMenu.TimeSlicerLevelMonth",
-2012435159);break;case 3:Hb=new Od(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Hb}}he.ZRj=x.a.R9g;he.QKb="TimeSlicerLevelMenuRootName";he.aCe=Ma.a.nua;Object(c.a)(he,"TimeSlicerLevelMenu",A.a,[]);var Ye=a(318),se=a(3);class bf extends b.a{constructor(fb){super(fb)}hd(){const fb=this.$,Hb=oa.a.h1a(Da.b(),this.la,"Task","IRootUser"),cc=e.a(fb);let Hc=null;Hc=(be,Jb)=>{cc.CWf(Hc);Hb.setResult(Jb.a5b)};cc.ere(Hc);cc.w5e();const od=R.GetServiceTaskFactory.create(fb.da,102,fb.la,this.Xa),Dd=
R.GetServiceTaskFactory.Oa(fb.da,342,338,this.Xa);D.TaskExtensions.za(D.TaskExtensions.Fd([Hb.task,od,Dd],this.la),()=>{const be=od.result,Jb=Hb.task.result,sc=Dd.result;this.$c([new pb(fb,Jb,be,sc),new fa(fb,Jb,be,sc),new xa(fb,Jb,be,sc),new Ta(fb,Jb,be,sc),new td(fb,Jb,be,sc),new V(fb,Jb,be,sc),new Yd.GridContextMenu(fb,Jb,be,sc),new ae(fb,Jb,be,sc),new Ac(fb,Jb,be,sc),new he(fb,Jb,be,sc),new Cc(fb,Jb,be,sc),new gb(fb,Jb,be,sc),new Za(fb,Jb,be,sc),new Vd(fb,Jb,be,sc),new Ib(fb,Jb,be,sc)])},fb.la,
3)}static initData(){const fb=Ye.a.n9;fb(2000085697,20479,0,0);fb(-227942804,se.a.oc|24576,0,0);fb(1634477200,se.a.oc|131072,0,0);fb(-649826274,4095,0,0);fb(149600865,4095,0,0);fb(-2012435159,4095,0,0);fb(-1979934975,4095,0,0);fb(1247109494,se.a.oc|24576,0,0);fb(-2064931494,se.a.oc|131072,0,0);fb(-1396319072,se.a.Ga,128,0);fb(-425234874,se.a.Ga,128,0);fb(-1253126584,se.a.Ga,0,0);fb(274207288,se.a.oc|24576,0,0);fb(-1497523576,se.a.oc|131072,0,0);fb(-498523270,se.a.oc|24576,64,0);fb(1640762262,se.a.oc|
131072,64,0);fb(-2017893763,se.a.oc|24576,0,0);fb(1350204367,se.a.oc|131072,0,0);fb(-889576107,se.a.Uv,128,0);fb(-1170196828,se.a.Uv,128,0);fb(389774337,se.a.Uv,128,0);fb(1529312473,se.a.Uv,128,0);fb(2033235475,se.a.Uv,128,0);fb(-96230454,se.a.Uv,128,0);fb(74086617,se.a.Uv,128,0);fb(563292088,se.a.Uv,128,0);fb(-1092351914,se.a.Uv,128,0);fb(-2141589616,se.a.Uv|16384,128,0);fb(745182485,se.a.Uv,0,0);fb(359279088,se.a.Uv,128,0);fb(-67292059,se.a.Uv,128,0);fb(926905850,se.a.Uv,128,0);fb(547535945,se.a.Uv,
128,0);fb(1374696078,se.a.oc|24576,0,0);fb(495005930,se.a.oc|212992,0,0);fb(-1045020714,se.a.oc|24576,0,0);fb(-170383950,se.a.oc|212992,0,0);fb(324156914,se.a.Ga,0,0);fb(-1085236154,se.a.$u,0,0);fb(-751848458,se.a.al|16384,0,0);fb(216058793,se.a.$u,0,0);fb(474690375,se.a.al|16384,0,0);fb(-1920954846,se.a.oc|24576,0,0);fb(723126814,se.a.oc|131072,0,0);fb(2108047455,128,128,0);fb(-231711729,128,128,0);fb(-1909381757,128,128,0);fb(-814639094,128,128,0);fb(1701016594,se.a.oc|3072,128,0);fb(-1475408662,
se.a.oc|24576,0,0);fb(1114549926,se.a.oc|131072,32,0)}static ka(fb){b.a.Ld(10,new bf(fb))}}Object(c.a)(bf,"ContextMenuCommandHandlerFactory",b.a,[]);var tf=a(226),Ie=a(1425),uf=a(95),Ya=a(195);class Nb{constructor(fb,Hb){this.$rb=Hb;this.$=fb}dispose(){}Z$(){this.$rb.i3()}DC(){this.$rb.DC()}CUd(fb,Hb,cc){sb.i(this.$,sb.b);this.$rb.showContextMenu(Object(f.a)(new Ie.a,{x:Hb.x,y:Hb.y}),cc,fb);uf.EventHandlerManager.instance.xdd()}Gzc(fb,Hb,cc){sb.i(this.$,sb.b);this.$rb.showFloatie(Object(f.a)(new Ie.a,
{x:Hb.x,y:Hb.y}),fb,cc);Ya.a(()=>{uf.EventHandlerManager.instance.xdd()},this.$.la)}BUd(fb,Hb,cc,Hc){sb.i(this.$,sb.b);this.$rb.BUd(Object(f.a)(new Ie.a,{x:Hb.x,y:Hb.y}),fb,cc,Hc)}}Object(c.a)(Nb,"ReactContextMenuController",null,[241,2]);class rc extends tf.a{constructor(fb){super();this.qef=!1;this.Cnd=()=>{let Hb;(Hb=this.$.da.Aa(342))?this.nb(Hb):this.$.Sx(cc=>{cc.Pfc().then(Hc=>{(Hb=this.$.da.Aa(342))?this.nb(Hb):(Hb=new Nb(this.$,Hc),this.nb(this.$.da.Ha(342,Hb)))})})};this.$=fb;this.Db()}dispose(){this.qef&&
this.$&&this.$.ea.Bn(this.Cnd);super.dispose()}create(){this.$.ea.Zf?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Zf}`),this.Cnd(null,null)):(this.qef=!0,this.$.ea.Dk(this.Cnd))}static ka(fb){fb.da.Ha(338,new rc(fb))}}Object(c.a)(rc,"ContextMenuControllerFactory",tf.a,[]);var Oc=a(159);class sd{constructor(){this.dictionary=this.Sd=null}}Object(c.a)(sd,"RibbonCommandParams",null,[]);class zd{constructor(){this.menuModel=
null;this.sJe=0}}Object(c.a)(zd,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class Pd{constructor(){this.Kec={}}iQh(fb){return(fb=this.Kec[fb.toString()])?fb.menuModel:null}E_g(fb,Hb){this.Kec[Hb.toString()]=Object(f.a)(new zd,{menuModel:fb,sJe:ja.HelperMethods.Kb()})}z8b(fb){this.Kec[fb.toString()]=null}U4h(fb){return(fb=this.Kec[fb.toString()])?fb.sJe:-1}}Object(c.a)(Pd,"FilterMenuCache",null,[]);var ue=a(14),ze=a(180),Ne=a(227);class ff{constructor(){this.Xc=this.Awe=this.cell=null}}Object(c.a)(ff,
"AutoFilterEventRegistrationArgs",null,[]);class Ge{constructor(fb){this.ZZa=null;this.WTd=!1;this.dDb=0;this.Y$c=1;this.NQe=0;this.$Fb=Hb=>{this.fQf(Hb.domElement,Hb.hashCode)};this.dUf=Hb=>{let cc=0;for(;window.performance.now()-Hb<this.Lth&&0<this.ZZa.length;)this.kpe(this.ZZa.shift()),cc++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.Y$c}, Events Registered in this frame: ${cc}, Events in queue: ${this.ZZa.length}`);0<this.ZZa.length?
this.dDb=window.requestAnimationFrame(this.dUf):(Hb=window.performance.now()-this.NQe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.Y$c}, Total time in MS: ${Hb}`),this.Y$c++,this.dDb=0)};this.onPointerDown=Hb=>{fe.a.slim(Hb.Ea.rawEvent);return!1};this.$=fb;this.gridView=O.h(this.$);this.ffi();this.Lth=10}dispose(){window.cancelAnimationFrame(this.dDb);this.gridView&&this.gridView.Buc(this.$Fb);this.gridView=null}ffi(){if(this.WTd=
ja.HelperMethods.r7a)this.ZZa=[];this.SJg();this.gridView.x_b(this.$Fb)}SJg(){for(const fb of this.gridView.xn){const Hb=fb.fCa;for(let cc in Hb){const Hc=Hb[cc];this.fQf(Hc.domElement,Hc.hashCode)}}}fQf(fb,Hb){if(O.h(this.$).Ca.Am.X1a(Hb))if(fb){fb=fb.querySelectorAll('[id^="'+x.a.hcd+'"]');for(let od=0;od<fb.length;od++){var cc=fb[od],Hc=cc.getAttribute(x.a.tGh);const Dd=cc.getAttribute(x.a.lGh);d.ULS.shipAssertTag(537167053,0,!!Hc&&!!Dd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${cc.id}, BlockHash: ${Hb}`);
Hc=Qc.Range.Pc(parseInt(Hc,10),parseInt(Dd,10));cc=Object(f.a)(new ff,{cell:Hc,Awe:cc,Xc:Hb});this.WTd?(this.ZZa.push(cc),this.dDb||(this.NQe=window.performance.now(),this.dDb=window.requestAnimationFrame(this.dUf))):this.kpe(cc)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${Hb}`);else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${Hb}`)}kpe(fb){const Hb=
this.gridView.Ca.HKa(fb.cell,fb.Xc);Hb?this.RJg(fb.Awe,Hb):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${fb.Xc}, AutoFilter Cell: ${fb.cell}`)}RJg(fb,Hb){Hb.hasAutoFilter?this.UHg(fb,Hb.bvb):Hb.i4?this.PJg(fb,Hb.bvb,Hb.Srd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Oc.a.instance.ta(ue.a.pf,
fb,this.onPointerDown);ze.a.instance.ta(ue.a.iya,fb,this.onPointerDown)}UHg(fb,Hb){Ne.a.instance.ta(ue.a.click,fb,cc=>{Hb&&fe.a.hrc(cc.Ea.rawEvent,966232027,Hb,null);return!0})}PJg(fb,Hb,cc){const Hc=w.a.Wh(Hb);Ne.a.instance.ta(ue.a.click,fb,od=>{cc?fe.a.spf(document.getElementById(Hc.EwaElementId),Hc.Cell,Hc.DataSourceIndex,Hc.FieldId,Hc.IsOlap,Hc.RequiresConfirmation,od.Ea.rawEvent,Hc.OptionalPivotMenuAnchor):fe.a.spfm(od.Ea.rawEvent,Hc.RequiresConfirmation,Hc.Cell,Hc.DataSourceIndex,Hc.PivotName,
Hc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Ge,"FilterMenuPointerEventsManager",null,[2]);class af{constructor(fb){this.vXe=null;this.$=fb;this.r9a=new Pd;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.vXe=new Ge(this.$))}dispose(){aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.vXe.dispose();
this.$=null}uWh(fb){const Hb=O.h(this.$).Ca.Z9(fb,this.$.activeItemName);return Hb&&Hb.blockPresentInViewportTimeStamp>this.r9a.U4h(fb.left)?Hb.Vr(fb).autoFilterMenu:this.r9a.iQh(fb.left)}rUi(fb,Hb,cc){this.r9a&&this.r9a.E_g(fb.menuModel[Hb],cc)}sUi(fb){this.r9a&&this.r9a.z8b(fb)}}Object(c.a)(af,"FilterMenuManager",null,[240,2]);var wf=a(209),cf=a(170);class vf{constructor(fb,Hb,cc){this.eAc={};this.Ed=!1;this.Xl=(Hc,od=null)=>{this.showContextMenu(od)};this.tBf=(Hc,od)=>{od.KHi===vf.L7h&&O.h(this.$).focus()};
this.aR=(Hc,od)=>{Hc=this.$.Ia.Jaa(od.Sd.command);(null===Hc||void 0===Hc?0:Hc.dismissesContextualUI)&&this.i3()};this.S5=()=>{this.$.da.eU(342);D.TaskExtensions.za(R.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),Hc=>{Hc=Hc.result;for(let od of this.eAc)od.MTf(Hc)},this.$.la)};this.$=fb;this.contextMenuController=cc;this.r9d=new af(this.$);fb.da.Ha(8,this);for(cc=0;cc<Hb.length;cc++)this.eAc[vf.S9g[cc]]=Hb[cc];this.ha=O.h(fb).ha;this.ha.r_b(this.Xl);this.$.Ia.UYa(this.tBf);Oc.a.instance.nBj();
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia.WFa(this.aR);aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.e2(this.S5)}get L$b(){return this.r9d}zfd(fb){return Y.a.Fc(this.eAc,fb)}dispose(){this.Ed?d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ed=!0,this.$&&(this.$.pl(vf.dd),this.$.da.eU(8),this.ha&&this.ha.uuc(this.Xl),
this.$.Ia.LJb(this.tBf),aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia&&this.$.Ia.Tza(this.aR),aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.D6(this.S5)),this.$=this.ha=null,this.L$b.dispose(),this.eAc=this.r9d=null)}showContextMenu(fb,Hb=null,cc=null){this.gGj(fb)&&(sb.i(this.$,sb.j),fb=this.ech(fb,Hb,cc),this.$.Ia.Hb(fb.Sd,fb.dictionary))}i3(){this.contextMenuController?this.contextMenuController.Z$():
d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}gGj(fb){return Td.a(this.$).ap()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Td.a(this.$).ZV(cf.a.grid,wf.a.showContextMenu),!1):!this.$.Ia.WDh&&(!fb||fb.Mb!==O.h(this.$).domElement&&!we.a.equals(fb.Mb.tagName,"INPUT",!0))}ech(fb,Hb=null,cc=null){cc={["eventArgs"]:fb,["creationParams"]:cc};
fb=fb?fb.ub:-1;const Hc=this.ha.Sa.dc;let od=1441131127;Hc?(Hb=Hc.floatingObject,d.ULS.shipAssertTag(537167059,0,!!Hb,"floatingObj shouldn't be null."),vf.dtd(Hb)?od=1312363469:vf.isPivotChart(Hb)?(cc[fa.L1c]=Hb?Hb.Wc:null,od=-149612405):od=-1372040782):vf.Vkf(Hb)?(cc[fa.L1c]=Hb,od=-149612405):!sb.h(this.$)&&sb.f(O.h(this.$))&&(od=671488277);Hb=new L.a(od,fb,this.$.xc,30,null);return Object(f.a)(new sd,{Sd:Hb,dictionary:cc})}static ka(fb){fb.Lk(vf.dd)}static isPivotChart(fb){return!!fb&&0===fb.type&&
vf.Vkf(fb.Wc)}static dtd(fb){return!!fb&&2===fb.type}static Vkf(fb){return!!fb&&!!(fb.Attributes&4)}}vf.S9g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");vf.L7h="GridContextMenu";vf.dd=fb=>{(fb=Object(ab.a)(6,fb))&&R.GetServiceTaskFactory.create(fb.da,9,fb.la,0)};Object(c.a)(vf,"ContextMenuManager",null,[220,2]);class ag extends tf.a{constructor(fb){super();this.$=
fb;this.Db()}create(){const fb=this.$,Hb=fb.$b;if(Hb.allowSelection||Hb.allowEdits||Hb.allowFiltering||Hb.allowSorting||Hb.allowPivotSpecificOperations){const cc=R.GetServiceTaskFactory.create(fb.da,10,fb.la,this.Xa),Hc=R.GetServiceTaskFactory.Oa(fb.da,342,338,this.Xa);D.TaskExtensions.za(D.TaskExtensions.Fd([cc,Hc],this.la),()=>{this.nb(n.a(fb)||new vf(fb,cc.result,Hc.result))},this.$.la,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),
fb.da.eU(8),this.nb(null)}static ka(fb){fb.da.Ha(9,new ag(fb))}}Object(c.a)(ag,"ContextMenuManagerFactory",tf.a,[]);var tc=a(9);a.d(F,"a",function(){return Yc});const Yc=()=>{bf.initData();tc.a.Fa(fb=>{rc.ka(fb);ag.ka(fb);bf.ka(fb);vf.ka(fb)})}},1174:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=a(15);const f=W=>{switch(W){case 0:W="Between";break;case 1:W="NotBetween";break;case 2:W="Equal";break;case 3:W="NotEqual";break;case 4:W="GreaterThan";break;case 5:W="LessThan";break;case 6:W="GreaterThanOrEqual";
break;case 7:W="LessThanOrEqual";break;default:W="Unknown"}return W},d=W=>{switch(W){case 0:W="AnyValue";break;case 1:W="WholeNumber";break;case 2:W="Decimal";break;case 3:W="List";break;case 4:W="Date";break;case 5:W="Time";break;case 6:W="TextLength";break;case 7:W="Custom";break;default:W="Unknown"}return W};var h=a(127),m=a(41),l=a(374),v=a(192),r=a(284);class A{constructor(W=null,Q=!1){this.J4=W?W.IsIgnoreBlank:!0;this.K4=W?W.IsInCellDropDown:!0;this.AN=!W||Q&&3!==W.RuleType?"":W.LowerBoundary;
this.BN=!W||Q&&3!==W.RuleType?"":W.UpperBoundary;this.uB=W?W.ConditionType:0;this.ruleType=Q?3:W?W.RuleType:0;this.HZ=W?W.IsAlertBlocking:!0;this.oT=W?W.AlertTitle:"";this.nT=W?W.AlertMessage:"";this.WU=W?W.InputMessage:"";this.ZE=W?W.InputTitle:"";this.Z4=W?W.IsShowErrorAlert:!0;this.a5=W?W.IsShowInputMessage:!0}isEqual(W){return W?this.J4===W.J4&&this.K4===W.K4&&this.AN===W.AN&&this.BN===W.BN&&this.uB===W.uB&&this.ruleType===W.ruleType&&this.HZ===W.HZ&&this.oT===W.oT&&this.nT===W.nT&&this.WU===
W.WU&&this.ZE===W.ZE&&this.Z4===W.Z4&&this.a5===W.a5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(t.a)(A,"DataValidationEditDialogState",null,[]);var x=a(250),n=a(188),u=a(282),z=a(21),w=a(128),C=a(52),y=a(55);class B{constructor(W,Q){this.zy=this.fia=this.selectedRanges=null;this.dOe=!1;this.Qh=null;this.FSi=va=>{this.oDf(va);this.UNf(!0)};this.GSi=va=>{this.oDf(va);this.UNf(!1)};this.bEh=va=>{this.tB("DataValidationEdit.ExpandExistingDialog",
va);this.zy.c=B.KY(va);1===va?this.G$(new A(this.fia)):2===va?this.G$(new A):this.Vlc()};this.cEh=va=>{this.tB("DataValidationEdit.ExpandExistingListDialog",va);this.zy.c=B.KY(va);1===va?this.G$(new A(this.fia,!0)):2===va?this.G$(new A(null,!0)):this.Vlc()};this.I2i=va=>{this.tB("DataValidationEdit.OverrideExistingDialog",va);this.zy.c=B.KY(va);1===va?this.G$(new A):this.Vlc()};this.cLf=va=>{this.tB("DataValidationEdit.OverrideExistingListDialog",va);this.zy.c=B.KY(va);1===va?this.G$(new A(null,!0)):
this.Vlc()};this.$=W;this.y1a=Q}Hc(){return!1}executeCommand(W,Q){-1728432249!==Q.command&&739109630!==Q.command&&n.a(Q.command);this.selectedRanges=m.r(z.h(this.$).ha.qa.selectedRanges,this.$);z.h(this.$).CSa(!0);this.getDataValidationInitialState(Q.command);this.Qh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogOpen");this.dOe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),
this.dOe=!0);return y.Task.Ra(!0)}wc(W,Q){return-1728432249===Q.command||739109630===Q.command}Mc(){return!1}getDataValidationInitialState(W=null){const Q=this.$.oa.xa.Wb(),va=739109630===W;l.a(this.$.userOperationManager,(na,Ba,Oa)=>r.g(this.$.oa.xa,this.selectedRanges,u.b(na,va?this.FSi:this.GSi),u.a(Ba),Oa,Q),na=>new v.a(120,0,na,16),null)}oDf(W){e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!W||x.a(W)?e.ULS.sendTraceTag(537163283,
0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):this.fia=W.Result}UNf(W=!1){var Q=this.zy={};let va;switch(this.fia.Command){case 0:va="CreateNew";break;case 1:va="CreateNewFromRule";break;case 2:va="ExpandExisting";break;case 3:va="OverrideExisting";break;default:va="Unknown"}Q.a=va;this.Qh&&(this.Qh.stop(),this.zy.r=this.Qh.id);switch(this.fia.Command){case 0:this.zy.b=!1;this.zy.c="None";this.G$(new A(null,W));break;case 1:this.zy.b=
!1;this.zy.c="None";W&&this.fia&&3!==this.fia.RuleType?this.y1a.XGe(this.$,this.cLf):this.G$(new A(this.fia,!1));break;case 2:this.zy.b=!0;W?this.y1a.$ah(this.$,this.cEh):this.y1a.abh(this.$,this.bEh);break;case 3:this.zy.b=!0;W?this.y1a.XGe(this.$,this.cLf):this.y1a.cbh(this.$,this.I2i);break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}G$(W){this.y1a.G$(this.$,this.selectedRanges,W,this.fia.Command);this.kEi(W)}kEi(W){B.vtb(W,
this.zy);this.zy.d=!0;C.b().Te(48,this.zy,!0)}Vlc(){this.zy.d=!1;C.b().Te(48,this.zy,!0)}tB(W,Q){W={["ButtonType"]:B.KY(Q),["DialogName"]:W,["Location"]:"dialog",["NumberOfSelectedRanges"]:z.h(this.$).ha.qa.dD};w.b(this.$).rd(h.a.stb,W)}static vtb(W,Q){Q.e=d(W.ruleType);Q.f=f(W.uB);Q.g=!!W.AN;Q.h=!!W.BN;Q.i=W.J4;Q.j=W.K4;Q.k=W.a5;Q.l=!!W.ZE;Q.m=!!W.WU;Q.n=W.Z4;Q.o=W.HZ;Q.p=!!W.oT;Q.q=!!W.nT}static KY(W){switch(W){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(t.a)(B,"DataValidationEditCommandHandler",null,[221]);var H=a(136),I=a(814),R;(function(W){W[W.between=0]="between";W[W.notBetween=1]="notBetween";W[W.equal=2]="equal";W[W.notEqual=3]="notEqual";W[W.greaterThan=4]="greaterThan";W[W.lessThan=5]="lessThan";W[W.greaterThanOrEqual=6]="greaterThanOrEqual";W[W.lessThanOrEqual=7]="lessThanOrEqual"})(R||(R={}));Object(t.b)("DataValidationRuleConditionType",
R);var S=a(1105),G=a(150),D=a(189);class E{static get og(){return G.a.xq(E.Ll,"")}static get LLe(){return G.a.xq(E.mmh,D.a.ga(1667),D.a.ga(1682),D.a.ga(1683),D.a.ga(1684),D.a.ga(1685),D.a.ga(1686),D.a.ga(1687),D.a.ga(1688),D.a.ga(1689),D.a.ga(1668),D.a.ga(1692),D.a.ga(1693),D.a.ga(1694),D.a.ga(1695),D.a.ga(1696),D.a.ga(1697),D.a.ga(1698),D.a.ga(1699),D.a.ga(1669),D.a.ga(1670),D.a.ga(1690),D.a.ga(1691),D.a.ga(1681),"255")}static get PLe(){return G.a.xq(E.nmh,D.a.ga(1704),D.a.ga(1708),D.a.ga(1709),
"255","32")}static get SLe(){return G.a.xq(E.omh,D.a.ga(1703),D.a.ga(1706),D.a.ga(1705),D.a.ga(1707),D.a.ga(1708),D.a.ga(1709),"255","32")}}E.feg=255;E.Ll="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";E.mmh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
E.nmh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
E.omh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(t.a)(E,"DataValidationEditDialogHtml",null,[]);var M=a(86),L=a(553),N=a(14),Y=a(191),U=a(239),P=a(12),aa=a(13),X=a(1);class Z extends U.a{constructor(W,Q,va,na){super(Q);this.cFd=this.Lqc=this.uPa=this.X$a=this.ONa=this.T5a=this.Xya=this.Wya=this.wK=this.pT=this.Hfc=this.hwa=null;this.UHh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Ftj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,
9],[1,1],[12,12]];this.mpc=Ba=>{let Oa=!1;(null===Ba||void 0===Ba?0:Ba.Ea)&&(Ba.Ea.keyCode===M.a.Hea||Ba.Ea.keyCode===M.a.Jh)&&(Oa=this.Bca(Ba),this.pT.blur(),this.wK.blur());return Oa};this.Bca=()=>{const Ba=this.pT.selectedIndex,Oa=this.wK.selectedIndex;this.Lqc.innerText=this.Owb(Ba,Oa);this.cFd.innerText=this.Eid(Ba,Oa);switch(Ba){case 0:return this.wK.disabled=!0,P.DOMElementExtensions.setVisible(this.X$a,!1),P.DOMElementExtensions.setVisible(this.uPa,!1),P.DOMElementExtensions.setVisible(this.T5a,
!1),P.DOMElementExtensions.setVisible(this.ONa,!1),this.hwa.disabled=!0,!1;case 3:return this.wK.disabled=!0,P.DOMElementExtensions.setVisible(this.X$a,!0),P.DOMElementExtensions.setVisible(this.uPa,!1),P.DOMElementExtensions.setVisible(this.T5a,!0),P.DOMElementExtensions.setVisible(this.ONa,!0),this.hwa.disabled=!1;case 7:return this.wK.disabled=!0,P.DOMElementExtensions.setVisible(this.X$a,!0),P.DOMElementExtensions.setVisible(this.uPa,!1),P.DOMElementExtensions.setVisible(this.T5a,!1),P.DOMElementExtensions.setVisible(this.ONa,
!1),this.hwa.disabled=!1;default:this.hwa.disabled=!1,P.DOMElementExtensions.setVisible(this.X$a,!0),P.DOMElementExtensions.setVisible(this.ONa,!1)}switch(Oa){case 0:case 1:P.DOMElementExtensions.setVisible(this.uPa,!0);break;default:P.DOMElementExtensions.setVisible(this.uPa,!1)}this.wK.disabled=!1;this.Lqc.disabled=!1;P.DOMElementExtensions.setVisible(this.T5a,!1);P.DOMElementExtensions.setVisible(this.ONa,!1);return!1};this.get_visible=this.Qja;this.set_visible=this.Gna;this.OQ=new Y.a;this.OQ.add(aa.a.instance.ga(1669));
this.OQ.add(aa.a.instance.ga(1670));this.OQ.add(aa.a.instance.ga(1673));this.OQ.add(aa.a.instance.ga(1671));this.OQ.add(aa.a.instance.ga(1672));this.OQ.add(aa.a.instance.ga(1674));this.OQ.add(aa.a.instance.ga(1675));this.OQ.add(aa.a.instance.ga(1676));this.OQ.add(aa.a.instance.ga(1677));this.OQ.add(aa.a.instance.ga(1678));this.OQ.add(aa.a.instance.ga(1679));this.OQ.add(aa.a.instance.ga(1680));this.OQ.add("");this.$=W;this.Jk=va;this.kka(na)}get title(){return aa.a.instance.ga(1700)}get m8g(){return this.pT.selectedIndex}AAa(W){this.pT.selectedIndex=
W.ruleType;this.wK.selectedIndex=W.uB;this.Hfc.checked=W.K4;this.hwa.checked=W.J4;this.Wya.value=W.AN;this.Xya.value=W.BN;this.Bca(null)}sqb(W){W.J4=this.hwa.checked;W.K4=this.Hfc.checked;W.uB=this.wK.selectedIndex;W.ruleType=this.pT.selectedIndex;W.AN=this.Wya.value;W.BN=this.Xya.value}dispose(){this.Sj();this.Jk=this.cFd=this.Lqc=this.uPa=this.X$a=this.ONa=this.T5a=this.Hfc=this.Xya=this.Wya=this.wK=this.pT=this.hwa=null;super.dispose()}render(W){W.appendChild(this.domElement)}Qja(){return this.isVisible}Gna(W){return this.isVisible=
W}setFocus(){}Owb(W,Q){return this.r5e(W,Q,this.UHh)}Eid(W,Q){return 0!==Q&&1!==Q?"":this.r5e(W,Q,this.Ftj)}kka(W){X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126092_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")?W.Ph(this.domElement,E.LLe):this.domElement.innerHTML=E.LLe;this.hwa=P.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.pT=P.DOMElementExtensions.getElementById(this.domElement,
"allowConditionSelectionId");this.wK=P.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Wya=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Xya=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Lqc=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.cFd=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.T5a=P.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownDivId");this.ONa=P.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.X$a=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.uPa=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Hfc=P.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Aj()}r5e(W,Q,va){return va.length<W||va[W].length<Q?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${W} operatorOption=${Q}, cannot get label.`),
""):this.OQ.ma(va[W][Q])}Aj(){L.a.instance.ta(N.a.Sb,this.pT,this.mpc);L.a.instance.ta(N.a.Sb,this.wK,this.mpc);L.a.instance.ta(N.a.change,this.pT,this.Bca);L.a.instance.ta(N.a.change,this.wK,this.Bca);L.a.instance.ta(N.a.change,this.wK,this.Jk);L.a.instance.ta(N.a.change,this.pT,this.Jk);L.a.instance.ta(N.a.change,this.Wya,this.Jk);L.a.instance.ta(N.a.Sb,this.Wya,this.Jk);L.a.instance.ta(N.a.change,this.Xya,this.Jk);L.a.instance.ta(N.a.Sb,this.Xya,this.Jk)}Sj(){L.a.instance.Ba(N.a.Sb,this.pT,this.mpc);
L.a.instance.Ba(N.a.Sb,this.wK,this.mpc);L.a.instance.Ba(N.a.change,this.pT,this.Bca);L.a.instance.Ba(N.a.change,this.wK,this.Bca);L.a.instance.Ba(N.a.change,this.wK,this.Jk);L.a.instance.Ba(N.a.change,this.pT,this.Jk);L.a.instance.Ba(N.a.change,this.Wya,this.Jk);L.a.instance.Ba(N.a.Sb,this.Wya,this.Jk);L.a.instance.Ba(N.a.change,this.Xya,this.Jk);L.a.instance.Ba(N.a.Sb,this.Xya,this.Jk)}static nja(){let W;return W=new Y.a,W.add("operatorInputId1"),W.add("operatorInputId2"),W}}Object(t.a)(Z,"DataValidationEditConditionsControl",
U.a,[283,2,289]);var da=a(60);const qa=(W,Q,va,na,Ba,Oa,oa,Ja=null)=>{Ja=W.Na(9,Ja);Ja.selectedRanges=Q;Ja.ruleOptions=va;return da.g(W,"CreateOrEditDataValidation",Ja,na,Ba,Oa,oa,0)};var O=a(29),ca=a(22),wa=a(177),ia=a(33);class Ha extends I.a{constructor(W,Q,va,na){super(W);this.QPd=this.lvb=null;this.rNa=this.disposed=this.yka=!1;this.Qh=null;this.f4j=(Ba,Oa)=>{let oa;this.Ubc(Ba);if(({errorString:Ba,vq:oa}=this.y1d()).returnValue)return this.XLa(121,this.NSh(this.$,Oa),0,this.yba,!1),"";this.pla("OkInvalidByClient",
oa);return Ba};this.u7c=Ba=>{this.tB(Ba,Ha.KY(Ba));this.Qh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogTryClose");0===Ba&&this.Xla()};this.selectedRanges=Q;this.YSb=va;this.command=na;3===na&&(this.yka=!0);this.Ob=2;this.Yw=!1}get yd(){return this.YSb}get kc(){return"DataValidationEditDialog"}lVd(){var W={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.uB,["OperatorInput1"]:this.yd.AN,["OperatorInput2"]:this.yd.BN,["IsIgnoreBlank"]:this.yd.J4,["IsInCellDropDown"]:this.yd.K4,
["IsAlertBlocking"]:this.yd.HZ,["AlertTitle"]:this.yd.oT,["AlertMessage"]:this.yd.nT,["InputTitle"]:this.yd.ZE,["InputMessage"]:this.yd.WU,["IsShowErrorAlert"]:this.yd.Z4,["IsShowInputMessage"]:this.yd.a5};this.tc(2,aa.a.instance.ga(1666));W={[Ha.it]:this.kc,["validateDialogValues"]:this.f4j,["RangePickerController"]:z.h(this.$).Gg.Fxb(),["isModal"]:!1,["bodyProps"]:W};this.initializeAndShow(aa.a.instance.ga(1665),this.u7c,W);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||
(super.dispose(),this.disposed=!0)}get b3b(){return 3===this.yd.ruleType}nja(){return Z.nja()}NSh(W,Q){return(va,na,Ba)=>{const Oa=W.oa.xa.Wb();return qa(this.$.oa.xa,this.selectedRanges,this.JYg(),this.c0a(va,this.ECd(Q)),u.a(na),Ba,Oa)}}ECd(W){return Q=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let va;x.a(Q)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${Q?
O.a.nc(Q.Errors):null}.`),Q.Errors&&1===Q.Errors.length&&((va=this.Lfd(Q.Errors[0].MessageId))?this.pla("OkInvalidByServer",Q.Errors[0].MessageIdName):(this.pla("OkValid","None"),this.hide()),W(va)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${O.a.nc(Q.Errors)}`)):this.hide()}}JYg(){const W={};W.Command=this.command;W.RuleType=this.yd.ruleType;W.ConditionType=this.yd.uB;W.IsIgnoreBlank=this.yd.J4;W.IsInCellDropDown=
this.yd.K4;W.LowerBoundary=this.yd.AN;W.UpperBoundary=this.yd.BN;W.IsAlertBlocking=this.yd.HZ;W.IsShowErrorAlert=this.yd.Z4;W.IsShowInputMessage=this.yd.a5;W.AlertTitle=this.yd.oT;W.AlertMessage=this.yd.nT;W.InputTitle=this.yd.ZE;W.InputMessage=this.yd.WU;W.ShouldIgnoreFormulaError=this.rNa;return W}Lfd(W){switch(W){case 1173235830:return aa.a.instance.ga(1718);case 43935303:return aa.a.instance.ga(1719);case -1323438439:return aa.a.instance.ga(1721);case 2112020473:return aa.a.instance.ga(1715);
case -219503282:return aa.a.instance.ga(1716);case 1689335445:return aa.a.instance.ga(1717);case 2146493810:return aa.a.instance.ga(1720);case -2104909922:return String.format(aa.a.instance.ob(105),this.lvb,this.QPd);case -869372599:return String.format(aa.a.instance.ob(104),this.lvb);case -885132625:return aa.a.instance.ga(1713);case -1181828368:return aa.a.instance.ga(1723);case -758480861:return aa.a.instance.ga(1724);case -13729088:return aa.a.instance.ga(1725);case -846654055:return aa.a.instance.ga(1726);
case 751854001:return aa.a.instance.ga(1727);case -453846397:return aa.a.instance.ga(1728);case 1102013489:return aa.a.instance.ga(1729);case 835813260:return ia.a.$qd()?aa.a.instance.ga(1731):aa.a.instance.ga(1730);case 1577787509:return aa.a.instance.ga(1732);case 2083564019:return aa.a.instance.ga(1722);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${W.toString()}.`)}return null}Xla(){this.pla("Cancel","None")}tB(W,Q){e.ULS.sendTraceTag(537163273,
0,50,`DataValidationEditDialog ${1===W?"Ok":"Cancel"} was clicked.`);W={["ButtonType"]:Q,["DialogName"]:this.kc,["Location"]:"dialog",["NumberOfSelectedRanges"]:z.h(this.$).ha.qa.dD};w.b(this.$).rd(h.a.stb,W)}pla(W,Q){const va={};Ha.vtb(this.yd,va);va.o=W;va.p=Q;va.n=this.yka;this.Qh&&(this.Qh.stop(),va.q=this.Qh.id);C.b().Te(49,va,!0)}Ubc(W){this.yd.ruleType=W.RuleType;this.yd.uB=W.RuleOperatorType;this.yd.AN=W.OperatorInput1;this.yd.BN=W.OperatorInput2;this.yd.HZ=W.IsAlertBlocking;this.yd.Z4=W.IsShowErrorAlert;
this.yd.oT=W.AlertTitle;this.yd.nT=W.AlertMessage;this.yd.a5=W.IsShowInputMessage;this.yd.ZE=W.InputTitle;this.yd.WU=W.InputMessage;this.yd.J4=W.IsIgnoreBlank;this.yd.K4=W.IsInCellDropDown;this.lvb=W.firstOperatorLabel;this.QPd=W.secondOperatorLabel}rQb(W,Q,va){let na,Ba;Ba=na=null;if(!W)return va?(na=String.format(aa.a.instance.ob(105),this.lvb,this.QPd),Ba="DataValidationEditNoMinMaxError"):ia.a.$qd()&&3===Q?(na=aa.a.instance.ga(1713),Ba="DataValidationEditNoValueListError"):(na=String.format(aa.a.instance.ob(104),
this.lvb),Ba="DataValidationEditNoValueError"),{returnValue:!1,errorString:na,vq:Ba};if(W.length>E.feg)return na=aa.a.instance.ga(1722),{returnValue:!1,errorString:na,vq:Ba};if(wa.d(W))return{returnValue:!0,errorString:na,vq:Ba};if(1===Q||2===Q||6===Q){if(!ca.a.R4(W))return na=aa.a.instance.ga(1715),{returnValue:!1,errorString:na,vq:Ba};if(1===Q&&!ca.a.isInteger(W))return na=aa.a.instance.ga(1716),{returnValue:!1,errorString:na,vq:Ba};if(6===Q){if(!ca.a.isInteger(W))return na=aa.a.instance.ga(1716),
{returnValue:!1,errorString:na,vq:Ba};if(0>parseInt(W,10))return na=aa.a.instance.ga(1717),{returnValue:!1,errorString:na,vq:Ba}}}return{returnValue:!0,errorString:na,vq:Ba}}y1d(){let W,Q;Q=W=null;const va=this.yd.AN,na=this.yd.BN,Ba=S.a[this.yd.ruleType];var Oa=R[this.yd.uB];if(0===Ba)return{returnValue:!0,errorString:W,vq:Q};Oa=(0===Oa||1===Oa)&&3!==Ba&&7!==Ba;return!({errorString:W,vq:Q}=this.rQb(va,Ba,Oa)).returnValue||Oa&&!({errorString:W,vq:Q}=this.rQb(na,Ba,Oa)).returnValue?{returnValue:!1,
errorString:W,vq:Q}:Oa&&(1===Ba||2===Ba||6===Ba)&&!wa.d(va)&&!wa.d(na)&&parseFloat(va)>parseFloat(na)?(W=aa.a.instance.ga(1720),{returnValue:!1,errorString:W,vq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:W,vq:Q}}static KY(W){switch(W){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static vtb(W,Q){Q.a=d(W.ruleType);Q.b=f(W.uB);
Q.c=!!W.AN;Q.d=!!W.BN;Q.e=W.J4;Q.f=W.K4;Q.g=W.a5;Q.h=!!W.ZE;Q.i=!!W.WU;Q.j=W.Z4;Q.k=W.HZ;Q.l=!!W.oT;Q.m=!!W.nT}}Object(t.a)(Ha,"DataValidationEditDialog",I.a,[]);var Sa=a(89);I=a(266);class Da{}Da.Xih="DataValidationDialogPanel";Da.Wih="DataValidationButtonPanel";Da.Vih="DataValidationButtonClearAll";Object(t.a)(Da,"CssClassNames",null,[]);class ea extends U.a{constructor(W,Q,va){super(W);this.jba=this.kba=this.iba=null;this.opc=()=>{this.iba.checked?(this.kba.disabled=!1,this.jba.disabled=!1):(this.kba.disabled=
!0,this.jba.disabled=!0);return!1};this.get_visible=this.Qja;this.set_visible=this.Gna;this.Jk=Q;this.kka(va)}get title(){return aa.a.instance.ga(1702)}render(W){W.appendChild(this.domElement)}Qja(){return this.isVisible}Gna(W){return this.isVisible=W}setFocus(){}dispose(){this.Sj();this.Jk=this.kba=this.jba=this.iba=null;super.dispose()}kka(W){X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126093_ReduceInnerHTMLUsageForDataValidationEditInputControl")?
W.Ph(this.domElement,E.PLe):this.domElement.innerHTML=E.PLe;this.iba=P.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");P.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.kba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.jba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.iba.checked=!0;this.Aj();this.opc(null)}AAa(W){this.kba.value=void 0===W.ZE||null===W.ZE?"":W.ZE;this.jba.value=
void 0===W.WU||null===W.WU?"":W.WU;this.iba.checked=W.a5;this.opc(null)}sqb(W){W.ZE=this.kba.value;W.WU=this.jba.value;W.a5=this.iba.checked}Aj(){L.a.instance.ta(N.a.change,this.iba,this.opc);L.a.instance.ta(N.a.change,this.iba,this.Jk);L.a.instance.ta(N.a.change,this.kba,this.Jk);L.a.instance.ta(N.a.Sb,this.kba,this.Jk);L.a.instance.ta(N.a.change,this.jba,this.Jk);L.a.instance.ta(N.a.Sb,this.jba,this.Jk)}Sj(){L.a.instance.Ba(N.a.change,this.iba,this.opc);L.a.instance.Ba(N.a.change,this.iba,this.Jk);
L.a.instance.Ba(N.a.change,this.kba,this.Jk);L.a.instance.Ba(N.a.Sb,this.kba,this.Jk);L.a.instance.Ba(N.a.change,this.jba,this.Jk);L.a.instance.Ba(N.a.Sb,this.jba,this.Jk)}}Object(t.a)(ea,"DataValidationEditInputControl",U.a,[283,2,285]);class sa extends U.a{constructor(W,Q,va){super(W);this.E9=this.G9=this.AUa=this.bha=this.D9=null;this.npc=()=>{this.D9.checked?(this.bha.disabled=!1,this.AUa.disabled=!1,this.G9.disabled=!1,this.E9.disabled=!1):(this.bha.disabled=!0,this.AUa.disabled=!0,this.G9.disabled=
!0,this.E9.disabled=!0);return!1};this.get_visible=this.Qja;this.set_visible=this.Gna;this.Jk=Q;this.kka(va)}get title(){return aa.a.instance.ga(1701)}render(W){W.appendChild(this.domElement)}Qja(){return this.isVisible}Gna(W){return this.isVisible=W}setFocus(){}dispose(){this.Sj();this.Jk=this.G9=this.E9=this.AUa=this.bha=this.D9=null;super.dispose()}kka(W){X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126094_ReduceInnerHTMLUsageForDataValidationEditMessagesControl")?
W.Ph(this.domElement,E.SLe):this.domElement.innerHTML=E.SLe;this.D9=P.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.bha=P.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.AUa=P.DOMElementExtensions.getElementById(this.domElement,"warningId");this.G9=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.E9=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.D9.checked=!0;this.bha.checked=
!0;this.Aj();this.npc(null)}AAa(W){this.bha.checked=W.HZ;this.AUa.checked=!W.HZ;this.G9.value=void 0===W.oT||null===W.oT?"":W.oT;this.E9.value=void 0===W.nT||null===W.nT?"":W.nT;this.D9.checked=W.Z4;this.npc(null)}sqb(W){W.oT=this.G9.value;W.nT=this.E9.value;W.HZ=this.bha.checked;W.Z4=this.D9.checked}Aj(){L.a.instance.ta(N.a.change,this.D9,this.npc);L.a.instance.ta(N.a.change,this.D9,this.Jk);L.a.instance.ta(N.a.change,this.bha,this.Jk);L.a.instance.ta(N.a.change,this.AUa,this.Jk);L.a.instance.ta(N.a.change,
this.G9,this.Jk);L.a.instance.ta(N.a.Sb,this.G9,this.Jk);L.a.instance.ta(N.a.change,this.E9,this.Jk);L.a.instance.ta(N.a.Sb,this.E9,this.Jk)}Sj(){L.a.instance.Ba(N.a.change,this.D9,this.npc);L.a.instance.Ba(N.a.change,this.D9,this.Jk);L.a.instance.ta(N.a.change,this.bha,this.Jk);L.a.instance.ta(N.a.change,this.AUa,this.Jk);L.a.instance.Ba(N.a.change,this.G9,this.Jk);L.a.instance.Ba(N.a.Sb,this.G9,this.Jk);L.a.instance.Ba(N.a.change,this.E9,this.Jk);L.a.instance.Ba(N.a.Sb,this.E9,this.Jk)}}Object(t.a)(sa,
"DataValidationEditMessagesControl",U.a,[283,2,284]);class Ea{constructor(W,Q){this.options=this.cellRange=null;this.cellRange=W;this.options=Q}}Object(t.a)(Ea,"MacroRecorderRangeDataValidationChangedPayload",null,[122]);var ba=a(1261);class ka extends I.a{constructor(W,Q,va,na,Ba){super(W);this.S2=this.hgc=this.Zmc=this.MEb=null;this.rNa=this.disposed=this.yka=!1;this.htmlSanitizationHelper=this.Qh=null;this.ECd=Oa=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(x.a(Oa)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${Oa?O.a.nc(Oa.Errors):null}.`);if(Oa.Errors&&1===Oa.Errors.length){const oa=Oa.Errors[0].MessageId,Ja=this.Lfd(oa);if(Ja){this.TGj(oa)?this.WBj(Ja):this.Jt(Ja);this.pla("OkInvalidByServer",
Oa.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${O.a.nc(Oa.Errors)}`)}this.pla("OkValid","None");this.hide()}};this.u7c=Oa=>{this.tB(Oa,ka.KY(Oa));2!==Oa&&(this.Qh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Oa?this.F$a():2===Oa?this.zya():this.Xla()};this.Bca=()=>{this.CZj();this.rNa?this.VCe():this.CCe();return this.yka=!1};this.selectedRanges=
Q;this.YSb=va;this.command=na;this.htmlSanitizationHelper=Ba;3===na&&(this.yka=!0);this.Ob=2;this.Yw=!1;this.og=E.og}get yd(){return this.YSb}get kc(){return"DataValidationEditDialog"}lVd(){const W={["key"]:this.yd};this.initializeAndShow(aa.a.instance.ga(1665),this.u7c,W);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.hgc=this.Zmc=this.S2=null,Sa.a.Ja(this.MEb),this.MEb=null,w.b(this.$)&&w.b(this.$).PWd("DataValidationDialogCorellation"),
super.dispose(),this.disposed=!0)}get gD(){return()=>{this.tB(1,ka.KY(1));this.F$a()}}qy(W){super.qy(W);this.tc(2,aa.a.instance.ga(1666));W=this.FJ(2);var Q=this.FJ(1),va=this.FJ(0),na=Q.parentNode;na.appendChild(W);na.appendChild(Q);na.appendChild(va);W.parentNode.classList.add(Da.Wih);W.classList.add(Da.Vih);W=document.getElementById("dataValidationTabsId");Q=new Z(this.$,document.createElement("div"),this.Bca,this.htmlSanitizationHelper);va=new ea(document.createElement("div"),this.Bca,this.htmlSanitizationHelper);
na=new sa(document.createElement("div"),this.Bca,this.htmlSanitizationHelper);this.fii(Q,va,na);let Ba;this.MEb=new ba.a(W,(Ba=new Y.a,Ba.add(Q),Ba.add(va),Ba.add(na),Ba));this.MEb.bXf();this.RP=document.getElementById("validationErrorMessageId");this.AAa();w.b(this.$)&&w.b(this.$).uWd("DataValidationDialogCorellation")}zD(){super.zD();document.getElementById(this.Dh("WACDialogPanel")).classList.add(Da.Xih)}get nY(){return!1}get b3b(){return 3===this.S2.m8g}nja(){return Z.nja()}cgd(){return"validationErrorMessageId"}fii(W,
Q,va){this.S2=W;this.hgc=Q;this.Zmc=va}Fuj(){const W={};W.IsClearAll=this.yka;W.Command=this.command;W.RuleType=this.yd.ruleType;W.ConditionType=this.yd.uB;W.IsIgnoreBlank=this.yd.J4;W.IsInCellDropDown=this.yd.K4;W.LowerBoundary=this.yd.AN;W.UpperBoundary=this.yd.BN;W.IsAlertBlocking=this.yd.HZ;W.IsShowErrorAlert=this.yd.Z4;W.IsShowInputMessage=this.yd.a5;W.AlertTitle=this.yd.oT;W.AlertMessage=this.yd.nT;W.InputTitle=this.yd.ZE;W.InputMessage=this.yd.WU;W.ShouldIgnoreFormulaError=this.rNa;const Q=
this.$.oa.xa.Wb(),va=()=>new Ea(this.selectedRanges,W);l.a(this.$.userOperationManager,(na,Ba,Oa)=>qa(this.$.oa.xa,this.selectedRanges,W,u.b(na,this.ECd),u.a(Ba),Oa,Q),na=>new v.a(121,0,na,void 0,va),null)}TGj(W){return 1577787509===W}WBj(W){this.RP.innerText=W;this.iI(this.FJ(0));this.rNa=!0}VCe(){this.rNa=!1;this.RP.innerText=""}Lfd(W){switch(W){case 1173235830:return aa.a.instance.ga(1718);case 43935303:return aa.a.instance.ga(1719);case -1323438439:return aa.a.instance.ga(1721);case 2112020473:return aa.a.instance.ga(1715);
case -219503282:return aa.a.instance.ga(1716);case 1689335445:return aa.a.instance.ga(1717);case 2146493810:return aa.a.instance.ga(1720);case -2104909922:return String.format(aa.a.instance.ob(105),this.S2.Owb(this.yd.ruleType,this.yd.uB),this.S2.Eid(this.yd.ruleType,this.yd.uB));case -869372599:return String.format(aa.a.instance.ob(104),this.S2.Owb(this.yd.ruleType,this.yd.uB));case -1181828368:return aa.a.instance.ga(1723);case -758480861:return aa.a.instance.ga(1724);case -13729088:return aa.a.instance.ga(1725);
case -846654055:return aa.a.instance.ga(1726);case 751854001:return aa.a.instance.ga(1727);case -453846397:return aa.a.instance.ga(1728);case 1102013489:return aa.a.instance.ga(1729);case 835813260:return aa.a.instance.ga(1730);case 1577787509:return aa.a.instance.ga(1732);case 2083564019:return aa.a.instance.ga(1722);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${W.toString()}.`)}return null}F$a(){e.ULS.sendTraceTag(537163264,
0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Ubc();let W,Q;if(!({errorString:W,vq:Q}=this.y1d()).returnValue)return this.Jt(W),this.pla("OkInvalidByClient",Q),!1;this.Fuj();return!0}Xla(){this.Ubc();this.pla("Cancel","None");this.hide()}zya(){e.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.rNa?this.VCe():this.CCe();this.Ynj();this.yka=!0}tB(W,Q){W={["ButtonType"]:Q,["DialogName"]:this.kc,["Location"]:"dialog",["NumberOfSelectedRanges"]:z.h(this.$).ha.qa.dD};
w.b(this.$).rd(h.a.stb,W)}Ynj(){this.YSb=new A;this.AAa()}AAa(){this.Zmc.AAa(this.yd);this.hgc.AAa(this.yd);this.S2.AAa(this.yd)}Ubc(){this.S2.sqb(this.yd);this.Zmc.sqb(this.yd);this.hgc.sqb(this.yd)}pla(W,Q){const va={};ka.vtb(this.yd,va);va.o=W;va.p=Q;va.n=this.yka;this.Qh&&(this.Qh.stop(),va.q=this.Qh.id);C.b().Te(49,va,!0)}rQb(W,Q){let va,na;na=va=null;if(!W)return Q?(va=String.format(aa.a.instance.ob(105),this.S2.Owb(this.yd.ruleType,this.yd.uB),this.S2.Eid(this.yd.ruleType,this.yd.uB)),na="DataValidationEditNoMinMaxError"):
(va=String.format(aa.a.instance.ob(104),this.S2.Owb(this.yd.ruleType,this.yd.uB)),na="DataValidationEditNoValueError"),{returnValue:!1,errorString:va,vq:na};if(W.length>E.feg)return va=aa.a.instance.ga(1722),{returnValue:!1,errorString:va,vq:na};if(wa.d(W))return{returnValue:!0,errorString:va,vq:na};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!ca.a.R4(W))return va=aa.a.instance.ga(1715),{returnValue:!1,errorString:va,vq:na};if(1===this.yd.ruleType&&!ca.a.isInteger(W))return va=
aa.a.instance.ga(1716),{returnValue:!1,errorString:va,vq:na};if(6===this.yd.ruleType){if(!ca.a.isInteger(W))return va=aa.a.instance.ga(1716),{returnValue:!1,errorString:va,vq:na};if(0>parseInt(W,10))return va=aa.a.instance.ga(1717),{returnValue:!1,errorString:va,vq:na}}}return{returnValue:!0,errorString:va,vq:na}}y1d(){let W,Q;Q=W=null;if(this.yka||0===this.yd.ruleType)return{returnValue:!0,errorString:W,vq:Q};const va=(0===this.yd.uB||1===this.yd.uB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:W,
vq:Q}=this.rQb(this.yd.AN,va)).returnValue||va&&!({errorString:W,vq:Q}=this.rQb(this.yd.BN,va)).returnValue?{returnValue:!1,errorString:W,vq:Q}:va&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&!wa.d(this.yd.AN)&&!wa.d(this.yd.BN)&&parseFloat(this.yd.AN)>parseFloat(this.yd.BN)?(W=aa.a.instance.ga(1720),{returnValue:!1,errorString:W,vq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:W,vq:Q}}set gD(W){super.gD=W}static KY(W){switch(W){case 0:return"Cancel";
case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static vtb(W,Q){Q.a=d(W.ruleType);Q.b=f(W.uB);Q.c=!!W.AN;Q.d=!!W.BN;Q.e=W.J4;Q.f=W.K4;Q.g=W.a5;Q.h=!!W.ZE;Q.i=!!W.WU;Q.j=W.Z4;Q.k=W.HZ;Q.l=!!W.oT;Q.m=!!W.nT}}Object(t.a)(ka,"DataValidationEditDialogDeprecated",I.a,[]);class Ca{constructor(W){this.htmlSanitizationHelper=null;this.htmlSanitizationHelper=W}G$(W,Q,va,na){X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new Ha(W,Q,va,na)).lVd():(new ka(W,Q,va,na,this.htmlSanitizationHelper)).lVd()}abh(W,Q){const va=new H.StandardDialog;va.Ob=3;va.Tna(W.qb.Faa,aa.a.instance.ga(1710),Q)}cbh(W,Q){const va=new H.StandardDialog;va.Ob=1;va.QR(W.qb.Faa,aa.a.instance.ga(1711),Q)}$ah(W,Q){const va=new H.StandardDialog;va.Ob=3;va.Tna(W.qb.Faa,aa.a.instance.ga(1712),Q)}XGe(W,Q){const va=new H.StandardDialog;va.Ob=1;va.QR(W.qb.Faa,aa.a.instance.ga(1714),Q)}}Object(t.a)(Ca,"DataValidationEditDialogFactory",null,[249]);var db=
a(50),yb=a(37);class kb extends b.a{constructor(W){super(W)}hd(){const W=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126077_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")&&!X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?db.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):y.Task.Ra(null);yb.TaskExtensions.za(W,()=>{this.$c([new B(this.$,new Ca(W.result))])},this.$.la,
3)}static ka(W){b.a.Ld(245,new kb(W))}}Object(t.a)(kb,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return mb});const mb=()=>{c.a.Fa(kb.ka)}},1177:function(t,F,a){function c(gb,cb,La,ja,Ua,lb){if(0===ja)return Object(ea.a)(Qa.UnsupportedZeroResize);if(0>ja||0===La.length)return Object(ea.a)(Qa.InvalidInput);if(gb.mbi())return Object(ea.a)(Qa.UnsupportedSkeletonInView);const sb=gb.Mj("ResizeCSE");if(!Object(Ma.c)(sb))return Object(ea.a)(Qa.NullSPD);var V=sb.value.E3e(La);if(V&&
0<V.length)return Object(ea.a)(V.length.toString()+" "+Qa.UnsupportedHiddenInRange);a:{for(const Ra of La)Ua?Ra.right=Z.a.Ug:Ra.bottom=Z.a.Vg;V=gb.K$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",La);try{for(V.$$rst();V.$$mn();)if(V.Mm.aMj){var za=!0;break a}}finally{V&&V.dispose()}za=!1}if(za)return Object(ea.a)(Qa.UnsupportedMergeCell);if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Ua&&"undefined"!==typeof gridRenderer)for(const Ra of La)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Ra.left);
gb=gb.Ca;za=Ga.a.create().toString();sb.value.E0d(La,ja,Ua);lb=gb.kZj(Ua,lb);cb.gej(La,Ua);gb.nQf(lb,za,Ua?"row":"column");return Object(ea.d)(ja)}var b=a(9);t=a(0);var e=a(226),f=a(7),d=a(15),h=a(89);a(268);var m=a(191),l=a(420),v=a(84),r=a(785),A=a(168),x=a(244),n=a(24),u=a(890),z=a(41);class w{}w.bLh="GalleryGeneral";w.dLh="GalleryNumber";w.$Kh="GalleryCurrency";w.YKh="GalleryAccounting";w.gLh="GalleryShortDate";w.cLh="GalleryLongDate";w.iLh="GalleryTime";w.eLh="GalleryPercentage";w.aLh="GalleryFraction";
w.fLh="GalleryScientific";w.hLh="GalleryText";w.WZg="ButtonComma";w.buttonPercentage="ButtonPercentage";w.keyboardNumber="KeyboardNumber";w.keyboardCurrency="KeyboardCurrency";w.keyboardDate="KeyboardDate";w.keyboardTime="KeyboardTime";w.keyboardPercentage="KeyboardPercentage";Object(t.a)(w,"RibbonFormatKind",null,[]);var C=a(60),y=a(296),B=a(624),H=a(623),I=a(622);class R extends y.a{constructor(gb,cb,La,ja,Ua,lb,sb,V,za,Ra,Xa,$a=null,ma=null){super(11,0,V,Xa);this.wJh=gb;this.Cdd=cb;this.format=
ja;this.activeCell=La;this.Mue=Ua;this.IMf=lb;this.DMf=sb;this.xFa=za;this.clientCorrelationId=Ra;this.Dmb=$a;this.Vib=ma}get Kt(){return this.Dmb}get taa(){return this.Vib}get CEc(){return this.xFa}w2(gb){return super.w2(gb)||this.wJh.w2(this.Cdd,this.activeCell,this.format,this.Mue,this.IMf,this.DMf,this.n0b,this.xFa,this.clientCorrelationId,this.Dmb,this.Vib)}Vj(){const gb=[];if(this.Vdc)for(const cb of this.Vdc)gb.push(I.a(cb));else gb.push(new H.a(this.format,this.Cdd,this.activeCell));return()=>
new B.a(gb)}vfb(){const gb={OperationType:0};gb.FormatCellsMultiRange=this.Cdd;gb.ActiveCell=this.activeCell;gb.Format=this.format;gb.ApplyFormatOnPivotTableValueField=this.Mue;gb.PivotTableXluid=this.IMf;gb.PivotTableFieldCaption=this.DMf;return gb}}Object(t.a)(R,"FormatCellsBatchOperation",y.a,[]);var S=a(33),G=a(213);class D{}D.editCell="Edited";D.dependentCell="Dependents";Object(t.a)(D,"RecalcPriorityGroupType",null,[]);var E=a(205),M=a(1);const L=gb=>{switch(gb.alignment){case "Center":return 2;
case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},N=gb=>{if(gb=gb.color){if("String"===Object.getType(gb).getName())return E.a.Uo(gb);if("Number"===Object.getType(gb).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},Y=(gb,cb)=>{gb=excelOnlineCalc.calc.getCellValueKind(gb.rangeDelta.data.value);
switch(gb){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;cb.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return cb.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${gb}`),!1}},U=gb=>{gb=excelOnlineCalc.calc.getCellValueKind(gb.rangeDelta.data.value);
let cb=0;switch(gb){case "number":cb=1;break;case "string":cb=2;break;case "boolean":cb=3;break;case "Error":cb=4;break;case "Blank":cb=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${gb}`)}return cb},P=gb=>{const cb=gb.value;switch(gb.type){case 2:return void 0===cb||null===cb?"":cb;case 1:return gb=parseFloat(cb),isNaN(gb)?null:gb;case 3:return gb=parseFloat(cb),isNaN(gb)?null:1===gb;case 4:return gb=parseFloat(cb),isNaN(gb)?
null:excelOnlineCalc.calc.errorValue(gb);default:return excelOnlineCalc.calc.blankValue}},aa=(gb,cb)=>{const La=X(cb);var ja=!(void 0===cb.rangeDelta.data.format||null===cb.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===La||!ja,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${cb.priorityGroup}`);gb=Math.max(gb.cell.hj,0);ja&&(ja=excelOnlineCalc.calc.getCellFormatKind(cb.rangeDelta.data.format.format),"number"===ja?gb=cb.rangeDelta.data.format.format:
"string"===ja?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ja?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return gb},X=gb=>{if(gb.priorityGroup===D.editCell)return 0;if(gb.priorityGroup===D.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2};var Z=a(8);class da{constructor(gb=0,cb="",La=0,ja="",Ua=""){this.mC=gb;this.cellValue=cb;this.ifmt=La;this.priorityGroup=ja;this.HA=Ua}}Object(t.a)(da,"RecalcAccuracyObject",null,[]);class qa{}qa.string="String";qa.blank="Blank";qa.general="General";qa.jIh="Flexible";Object(t.a)(qa,"FormattedUnitKind",null,[]);class O{constructor(gb=0,cb=0,La=0,ja=0,Ua=0,lb=0,sb=0,V=0,za=0,Ra=0,Xa=0,$a=0,ma=0,fa=0,eb=0,ua=!1,xa="",tb=0,Qb=null,pc=null,hb=null,ib=null,Vb=null,wc=null,Lc=null){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=gb;this.numberOfNonUpdatedCells=cb;this.numberOfUpdatedCells=La;this.numberOfCellsUpdatedAlreadyByServer=ja;this.numberOfCellsSkippedDueToTimeout=Ua;
this.numberOfCellsWithNoFormattedCell=lb;this.numberOfUnsupportedErrorCellTypes=sb;this.numberOfUnsupportedBlankCellTypes=V;this.numberOfUnsupportedRichCellTypes=za;this.numberOfSkippedCellsDueToMissingLocaleInfo=Ra;this.totalExecutionTime=Xa;this.originalProcessingTimeLimit=$a;this.newProcessingTimeLimit=ma;this.numberOfEditedRecalcedCellsInBatch=fa;this.numberOfDependentRecalcedCellsInBatch=eb;this.isNewTask=ua;this.lastSetCellInstantaneousOperation=xa;this.taskId=tb;this.isNewNumberFormatter=Qb;
this.numberOfRecalcedCellsWithFormattedValue=pc;this.numberOfRecalcedCellsWithoutFormattedValue=hb;this.totalNumberFormatterTime=ib;this.newNumberFormatterFinalizeFailures=Vb;this.numberOfMeasureTextWidthCalls=wc;this.numberOfHashFormattedValues=Lc}}Object(t.a)(O,"RecalcResultProcessingStatistics",null,[]);class ca{constructor(gb,cb,La,ja){this.rangeDelta=gb;this.stateId=cb;this.isFinished=La;this.priorityGroup=ja}}Object(t.a)(ca,"RecalcedCellInfo",null,[]);var wa=a(114),ia=a(11),Ha=a(22),Sa=a(55),
Da=a(71),ea=a(292),sa=a(186),Ea=a(105);class ba{constructor(gb,cb,La){this.fda=[];this.calcManager=this.fBc=this.lastSetCellInstantaneousOperation=null;this.uPf=ja=>{var Ua;if(ja&&ja.rangeDeltas){var lb=this.fda.length;for(let sb=0;sb<ja.rangeDeltas.length;sb++)(null===(Ua=ja.rangeDeltas[sb])||void 0===Ua?0:Ua.data)&&void 0!==ja.rangeDeltas[sb].data.value&&null!==ja.rangeDeltas[sb].data.value&&void 0!==ja.rangeDeltas[sb].range&&null!==ja.rangeDeltas[sb].range&&this.fda.push(new ca(ja.rangeDeltas[sb],
ja.stateId,ja.isFinished,ja.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${ja.stateId}, priorityGroup=${ja.priorityGroup}, recalcFinished=${ja.isFinished}, cellsFromCalc=${ja.rangeDeltas.length}, initialCellsToRender=${lb}, recalcedCells=${this.fda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);!lb&&this.fda.length&&this.WGf(!1,0)}};this.$=gb;this.grid=cb;this.Lh=La;this.bda=ba.HKe;this.$.da.gb(268,ja=>{this.fBc=
ja});M.EwaSettings.ZJ()?void sa.a.resolve(Ea.b).then(ja=>{this.calcManager=ja}):this.$.da.gb(266,ja=>{this.calcManager=ja})}dispose(){this.calcManager=this.fBc=this.Lh=this.grid=this.$=null}kcd(gb,cb,La,ja,Ua,lb,sb){if(!cb)return Object(ea.a)("Null");var V=excelOnlineCalc.numfmt.renderCallback(ja,Ra=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Ra,Ua,!0,M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),sb);let za=gb.renderValue(cb,V);if(!excelOnlineCalc.util.isSuccess(za))return Object(ea.a)("Finalize");
ja=null;if(sb=excelOnlineCalc.numfmt.isHashesValue(za.value)){if(za=gb.renderHashesValue(za.value,V),!excelOnlineCalc.util.isSuccess(za))return Object(ea.a)("Hashes")}else ja=ba.IJh(cb,za.value);V=za.value;gb=excelOnlineCalc.numfmt.renderedValueToString(V);cb=L(V);V=N(V);return Object(ea.d)({text:gb,valueType:La,fontColor:V,hj:lb,BOa:ja,horizontalAlignment:cb,isHashesValue:sb})}WGf(gb,cb){this.$&&this.grid&&this.calcManager&&this.fBc&&this.calcManager.hB?(gb&&(this.bda=this.fBc.vff),this.u9i(this.grid,
this.calcManager.hB,gb,cb),!this.bda&&this.fda.length?Sa.Task.delay(0).Qo(La=>{this.WGf(!0,La.id);return!0},0,null,Da.a.current):Sa.Task.Ra(!0)):(d.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Sa.Task.Ra(!1))}u9i(gb,cb,La,ja){const Ua=ia.HelperMethods.Kb();for(La=new O(this.fda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.bda,void 0,void 0,void 0,La,void 0,ja,!0,0,0,
0,0,0,0);0<this.fda.length;){ja=ia.HelperMethods.Kb()-Ua;if(!this.bda||ja>this.bda){La.numberOfCellsSkippedDueToTimeout=this.fda.length;break}ja=Array.dequeue(this.fda);if(Y(ja,La)){var lb=n.Range.Pc(ja.rangeDelta.range.row+1,ja.rangeDelta.range.column+1);(lb=gb.Qb(lb))?ba.P0g(ja.stateId,lb.cell)?(ba.Snc(gb,lb,ja,La),this.tSg(cb,lb,ja,La)):La.numberOfCellsUpdatedAlreadyByServer++:La.numberOfCellsWithNoFormattedCell++}}ja=Math.round(ia.HelperMethods.Kb()-Ua);this.R1j(ja);this.gPj(La,ja);this.fnj(La)}tSg(gb,
cb,La,ja){var Ua,lb,sb,V;const za=aa(cb,La),Ra=La.rangeDelta.data.formatted,Xa=U(La),$a=X(La);gb=this.kcd(gb,Ra,Xa,cb.cell.oBa,cb.cell.Zha,za,!1);if(Object(ea.c)(gb))cb.text!==gb.value.text&&(this.Lh.Wob(cb,gb.value),La=X(La),0===La?La=1:1===La?La=2:(d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),La=0),this.Lh.uPe(cb,this.lastSetCellInstantaneousOperation,1,La,!0,!0),0===$a&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&
(this.calcManager?this.calcManager.Rxf(cb.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),ja.numberOfUpdatedCells++);else switch(gb.reason){case "Null":ja.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Ua=ja.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Ua?Ua:0)+1;break;case "Hashes":ja.numberOfHashFormattedValues=(null!==(lb=ja.numberOfHashFormattedValues)&&void 0!==
lb?lb:0)+1;break;case "Finalize":ja.newNumberFormatterFinalizeFailures=(null!==(sb=ja.newNumberFormatterFinalizeFailures)&&void 0!==sb?sb:0)+1}Object(ea.b)(gb)&&"Null"!==gb.reason&&(ja.numberOfRecalcedCellsWithFormattedValue=(null!==(V=ja.numberOfRecalcedCellsWithFormattedValue)&&void 0!==V?V:0)+1);ja=0===$a?cb.cell.userInput:cb.formulaBarText;V=Object(ea.c)(gb)?gb.value.text:"";La=Object(ea.b)(gb)?gb.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${cb.range.top}, ${cb.range.left}) 2nd pass formatting, success: ${Object(ea.c)(gb)}, reason: ${La}, priority: ${$a}, ifmt: ${cb.cell.hj}, input: '${ja?
Ha.a.QL(ja):"null"}', prediction: '${V?Ha.a.QL(V):"null"}',`)}R1j(gb){this.bda=Math.max(this.bda-Math.max(gb,1),0)}gPj(gb,cb){gb.numberOfNonUpdatedCells=this.fda.length;gb.totalExecutionTime=cb;gb.newProcessingTimeLimit=this.bda;gb.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}fnj(gb){gb=Sys.Serialization.JavaScriptSerializer.serialize(gb);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${gb}`)}static IJh(gb,cb){gb=gb.units;var La=
cb.units;if(gb.length!==La.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;cb=[];let ja=-1;for(let Ua=0;Ua<gb.length;Ua++)switch(gb[Ua].kind){case qa.blank:cb.push(...wa.h(" ",La[Ua].str.length));break;case qa.string:cb.push(gb[Ua].str);break;case qa.jIh:cb.push("");ja=Ua;break;case qa.general:cb.push(La[Ua].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ja||""===La[ja].str)return null;La={};La.Start=cb.slice(0,ja).join("");La.Separator=gb[ja].str;La.End=cb.slice(ja+1,cb.length).join("");return La}static AQh(gb){return gb&&gb&&gb.Ux?gb.Ux.kE:Z.a.oe}static P0g(gb,cb){if(!cb)return!1;cb=ba.AQh(cb);return cb===Z.a.oe||cb===gb}static Snc(gb,cb,La,ja){var Ua=La.rangeDelta.data.value.toString();const lb=U(La),sb=aa(cb,La);Ua=new da(lb,Ua,sb,La.priorityGroup);cb.cell.Snc(Ua,
gb.Ca.yxa);1===X(La)?ja.numberOfDependentRecalcedCellsInBatch++:ja.numberOfEditedRecalcedCellsInBatch++}}ba.HKe=20;Object(t.a)(ba,"CalcResultProcessor",null,[308,2]);class ka{constructor(gb,cb=null,La=""){this.success=gb;this.Xnc=cb;this.reason=La}}Object(t.a)(ka,"GetRibbonNumberFormatResult",null,[]);var Ca=a(928);class db{constructor(gb,cb){this.rx=null;this.Ca=gb;this.c3a=cb}xdb(gb,cb,La,ja,Ua=!1,lb=!1){gb&&(gb.m0(cb,La,Ua,lb),gb.verticalAlignment=ja)}ULb(gb,cb,La){this.rx||(this.rx=new Ca.a(this.Ca,
this.c3a));this.rx.ULb(gb,cb,La)}}Object(t.a)(db,"FormatCellsActionModelAccessor",null,[306]);var yb=a(214),kb=a(28),mb=a(29),W=a(250),Q=a(255),va=a(282),na=a(66);class Ba{constructor(){this.hmg=this.M5j=!1;this.source=0;this.owa=this.Zic=!1}}Object(t.a)(Ba,"FormatCellInstantaneousResult",null,[]);class Oa{constructor(gb,cb){this.success=gb;this.HA=cb}}Object(t.a)(Oa,"FormatStringResult",null,[]);var oa=a(21),Ja=a(177),Wb=a(1106),nc=a(45),Yb=a(519),pb=a(52),Fa=a(175),ab=a(267),Gb=a(80),Ga=a(174),
Ma=a(61),Qa;(function(gb){gb.InvalidInput="invalid input";gb.UnsupportedZeroResize="resizing to 0 - ignore";gb.UnsupportedSkeletonInView="skeleton in view - ignore";gb.NullSPD="ActiveSheetProcessedData is null";gb.UnsupportedHiddenInRange="hiddens in resizeRanges";gb.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Qa||(Qa={}));Object(t.b)("InstantaneousRowColumnResizeFailureReason",Qa);var wb=a(379),Na=a(562);class ya{constructor(gb){this.rx=this.calcManager=this.Xx=this.LSa=
null;this.Jif=cb=>{if(cb){const La=ia.HelperMethods.jO.hasOwnProperty(cb);cb=oa.h(this.$).isFontSupported(cb);return!La&&cb}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.isFontFromFontService: fontName cannot be null");return!1};this.fSi=(cb,La)=>{if(cb&&!W.a(cb)&&La){const ja=!!cb&&!!cb.RequestTelemetryData;oa.h(this.$).vh.zla(La.toString(),cb.StateId,ja?cb.RequestTelemetryData.EcsOperationDuration:0,ja?cb.RequestTelemetryData.EcsRequestDuration:0,ja?cb.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=gb;this.$.da.gb(268,cb=>{this.Xx=cb});this.xJh=new db(oa.h(this.$).Ca,this.$);this.oha=new ba(this.$,oa.h(this.$),this);M.EwaSettings.ZJ()?void sa.a.resolve(Ea.b).then(cb=>{this.calcManager=cb}):this.$.da.gb(266,cb=>{this.calcManager=cb});this.vb=M.EwaSettings.vb();this.Rl=M.EwaSettings.Rl();this.iNa=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.jl=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get Hua(){return this.xJh}get hB(){return void 0===
this.calcManager||null===this.calcManager?null:this.calcManager.hB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.pc([this.LSa,this.oha]);this.$=this.oha=this.LSa=null}ySa(gb,cb,La,ja=!1,Ua="",lb=0,sb=null){return this.LIj(gb,cb,La,ja,lb,Ua,sb)}uPe(gb,cb,La,ja,Ua,lb){gb.cell.Ux.nJ|=ja;ya.$7g(oa.h(this.$),gb,La,Ua);this.oha.lastSetCellInstantaneousOperation=cb;lb&&(oa.h(this.$).vh.UR(cb,na.BasicTelemetryCalculator.zQ),M.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&
(1===La&&1===ja?oa.h(this.$).vh.UR(cb,na.BasicTelemetryCalculator.wff):1!==La&&oa.h(this.$).vh.UR(cb,na.BasicTelemetryCalculator.rod)))}Xda(gb,cb,La,ja=!1,Ua=null,lb=null){lb=lb||gb.ha.qa.selectedRanges;if(!(-1690267012===cb&&1<lb.length)){-1690267012===cb&&d.ULS.shipAssertTag(537162176,0,1===lb.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${lb.length}`);lb=gb.K$("FormatCellsAction.ShowInstantaneousFormatting",lb);try{lb.$$rst();let sb=!1;for(;lb.$$mn();){let V;const za=
lb.$$cu().sH?gb.vLb(lb.$$cu().range):(V=new m.a,V.add(lb.$$cu()),V);for(let Ra of za)if(oa.h(this.$),!Ra||lb.Gb.contains(Ra.range))if(this.Q9f(cb,Ra,La,ja,Ua,lb.$$cu().sH),sb||(gb.Ca.ZU(),sb=!0),Ua)break}}finally{lb&&lb.dispose()}}}Wob(gb,cb,La=null){La&&(La.owa=!0);La=!cb.text;const ja=Ha.a.Dkf(cb.text);let Ua;const lb=gb.sH?oa.h(this.$).vLb(gb.range):(Ua=new m.a,Ua.add(gb),Ua);for(let sb of lb)this.rSg(this.$,sb,cb.text,cb.horizontalAlignment,cb.fontColor,cb.hj,gb.cell.hj,La,ja,cb.valueType,cb.BOa);
gb.cell.qEc()}j4i(gb,cb,La,ja,Ua=null){try{const lb=z.D(cb);let sb=z.D(La);if(!wb.a.nxe){if(gb.wb.d7a(lb)||gb.wb.d7a(sb))return 8;if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&-185374993!==ja&&(gb.wb.Fnf(lb)||gb.wb.Fnf(sb)))return 18;if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste")&&-185374993!==ja&&(gb.wb.nhf(lb)||gb.wb.nhf(sb)))return 19}if(-185374993!==ja&&this.qui(gb,lb,sb))return 9;if(-185374993!==ja&&(gb.wb.V4(sb)||gb.wb.wBb(lb)))return 10;
if(1804571062!==ja&&gb.wb.U4(sb))return 11;if(this.Uoh(sb))return 12;if(this.nvi(lb,sb))return 13;const V=this.$.Jb.Gc("UserAction","PasteInstantaneous");V.start();Yb.a(V);Ua&&pb.b().aC(V.id,Ua.id,"actions","actions");!lb.isSingle&&sb.isSingle&&(sb=ya.expandRange(lb,sb),gb.ha.updateSelection(sb,sb,0));switch(ja){case 237279923:case 808159687:if(!this.B4i(lb,sb))return 14;this.N4c(gb,lb,sb,!0,!1);break;case 1804571062:this.N4c(gb,lb,sb,!0,!1);break;case -185374993:this.N4c(gb,lb,sb,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,
0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(lb){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(lb)}`),15}}Y4g(gb,cb){for(const La of gb)this.s2c(La,!0,cb)}s2c(gb,cb,La=""){if(gb){var ja=oa.h(this.$);if(cb){if(cb=ja.Wj("FormatCellsAction.ClearRangeInstantaneous",gb),ja=gb.isSingle?null:gb,cb.$$mn()&&void 0!==cb.$$cu()&&null!==cb.$$cu())for(gb=Object(f.a)(new ab.a,{Text:""}),this.ySa(cb.$$cu(),
gb,!1,S.a.drd(this.$),La,void 0,ja);cb.$$mn();)void 0!==cb.$$cu()&&null!==cb.$$cu()&&this.ySa(cb.$$cu(),gb,!1,!1,La)}else this.Xda(ja,-1228228458,{},void 0,void 0,[gb])}else d.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}gej(gb,cb){if(!cb){cb=ia.HelperMethods.Kb();var La=oa.h(this.$),ja=La.K$("FormatCellsAction.ReformatCells",gb);try{ja.$$rst();let Ua=!1;for(;ja.$$mn();){const lb=ja.$$cu().cell;if(0===lb.mC||2===lb.mC)this.updateSpillInformation(lb,
gb),Ua||(La.Ca.ZU(),Ua=!0)}}finally{ja&&ja.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${ia.HelperMethods.Kb()-cb}.`)}}bld(gb,cb){if(this.vb){if(gb.formulaBarText)return!Ha.a.equals(cb.Text,gb.formulaBarText,!1);let La=gb.cell.formattedText;La=Q.a(La,gb.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(La,cb).isEqual}return!Ha.a.equals(cb.Text,gb.text,!1)}DJh(gb,cb,La,ja){if(void 0===
cb||null===cb)return new Oa(!1,gb);const Ua={};Ua.value=gb;Ua.type=1;cb=this.v3a(Ua,cb,La,ja);return Object(ea.b)(cb)?new Oa(!1,gb):new Oa(!0,cb.value.text)}MIj(gb,cb,La,ja){return c(gb,this,cb,La,ja,!0)}JIj(gb,cb,La){if(!this.bld(cb,La))return Object(ea.d)("Skip unchanged cell content");cb=cb.cell;La=this.xZe(La.Text,cb.hj,cb.oBa,cb.Zha,!0);if(Object(ea.b)(La))gb=La;else{La=La.value;var ja=cb.hasRichValueIcon?"Unsupported rich value icon":cb.lS?"Unsupported wrapped text":cb.znf||null!=cb.eL&&0!==
cb.eL?"Unsupported rotated text":!0;!0!==ja?gb=Object(ea.a)(ja):(cb.isCellWidthFixed?ja="Skip fixed width cell":(ja=La.valueType,ja=0===ja?"Skip empty cell value":2===ja?"Skip string cell value":cb.XA&&!cb.gui?"Skip merged cell":cb.Wzc?"Skip shrunk to fit":La.isHashesValue?"Skip hashes cell value":!0),!0!==ja?gb=Object(ea.d)(ja):(La=cb.B9g(La.text),La>cb.offsetWidth?(cb=[cb.getRange().clone()],gb=c(gb,this,cb,La,!1,!1),gb=Object(ea.b)(gb)?gb:Object(ea.d)(La)):gb=Object(ea.d)("Column is wide enough")))}return gb}vZe(gb,
cb,La,ja,Ua){const lb={};lb.value=gb;lb.type=La;cb=this.v3a(lb,cb,ja,Ua);return Object(ea.b)(cb)?new Oa(!1,gb):new Oa(!0,cb.value.text)}updateSpillInformation(gb,cb){const La=gb.getRange();let ja=!1;for(const Ua of cb)if(La.left===Ua.left){ja=!0;break}gb.BZj(ja)}LIj(gb,cb,La,ja,Ua,lb="",sb=null){const V=new Ba;V.source=0;V.owa=!1;gb.cell.dHb=gb.cell.hj;let za=cb.Text;const Ra=!za,Xa=Ha.a.Dkf(za);Ha.a.Bq(za)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===za||null===za)&&void 0!==cb.TextRuns&&null!==
cb.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),cb=Object(f.a)(new ab.a,{Text:""}),za="");gb.cell.userInput=za;if(!this.bld(gb,cb))return this.w2g(gb,Ua,Ra,Xa,V);La?this.q2g(gb,za,this.$.workbookContext.DefaultHyperlinkStyle,V):this.k2g(gb,cb,za,Ra,Xa,ja,V,sb);this.uPe(gb,lb,Ua,1,V.Zic,V.owa);return V}w2g(gb,cb,La,ja,Ua){Ua.hmg=!0;Ua.Zic=!0;Ua.owa=!1;0===cb&&oa.h(this.$).Ca.ZU();0===gb.cell.lB&&(La?gb.cell.m0(0,!1):ja&&gb.cell.m0(1,!1));
this.d_d(gb.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Ua}q2g(gb,cb,La,ja){ja.owa=!0;gb.insertHyperlink(cb,G.a.Tcd(cb),La);this.d_d(gb.range,"FormatCellsAction.cellDataEntryCSE")}k2g(gb,cb,La,ja,Ua,lb,sb,V=null){sb.owa=!1;const za=gb.cell;this.Xx||(this.Xx=this.$.da.Aa(268));this.dVj(this.Xx,za.hj);M.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&lb&&this.Wfg(this.Xx,gb,La,V);ja||Ua?this.m2g(gb,ja,Ua,sb):(ja=this.xZe(La,za.hj,za.oBa,za.Zha,!1),Object(ea.c)(ja)?
(this.BFj(cb.TextRuns,cb.Fonts)&&this.o2g(gb,cb,ja.value),this.Wob(gb,ja.value,sb),this.d_d(gb.range,"FormatCellsAction.cellDataEntryCSE")):this.u2g(gb,cb.Text,sb),cb=Object(ea.c)(ja)?ja.value.text:"",Ua=Object(ea.b)(ja)?ja.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${gb.range.top}, ${gb.range.left}) 1st pass formatting, success: ${Object(ea.c)(ja)}, reason: ${Ua}, ifmt: ${za.hj}, input: '${Ha.a.xZa(za.userInput)}', prediction: '${Ha.a.xZa(cb)}',`));za.formulaBarText=
La;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||lb&&this.Wfg(this.Xx,gb,La,V);sb.Zic=!0}m2g(gb,cb,La,ja){ja.owa=!0;gb.text="";gb.formulaBarText="";gb.cell.userInput="";this.u1c(gb,null,null,cb,La)}o2g(gb,cb,La){cb.Text===La.text&&2===La.valueType&&(gb.cell.formattedText=cb)}u2g(gb,cb,La){La&&(La.owa=!0);gb.text=cb;gb.formulaBarText=cb;this.u1c(gb,1)}u1c(gb,cb,La=null,ja=!1,Ua=!1,lb=!1){let sb=gb.lB;La=null!=La?La:gb.verticalAlignment;0===gb.cell.lB&&(null!=cb||ja||
Ua||lb)&&(ja?sb=0:Ua||lb?sb=1:null!=cb&&(sb=cb),this.Hua.xdb(gb,sb,!1,La,!0))}d_d(gb,cb){if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const La=oa.h(this.$),ja=()=>{this.calcManager?this.calcManager.Rxf(gb):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${cb}, cell ${gb}`);La.Vb.$l(ja)};La.Vb.Jm(ja)}}dVj(gb,cb){(null===gb||void 0===gb?0:gb.pya)&&
cb>=ya.RHh&&cb>gb.pya.length-1&&(d.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${cb}. Triggering refresh...`),gb.oZe())}Wfg(gb,cb,La,ja=null){if(void 0!==gb&&null!==gb)if(this.Xx.qod)d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{try{var Ua=Object(Na.a)({Q5:266,new:Ea.b,registry:this.$.da,G3:M.EwaSettings.dX})}catch(lb){}Ua&&(this.oha.bda=ba.HKe,gb&&(this.oha.bda=gb.vff),
Ua.c0g(cb,La,this.oha.uPf,ja))}}v3a(gb,cb,La,ja){var Ua=Object(Na.a)({Q5:266,new:Ea.b,registry:this.$.da,G3:M.EwaSettings.dX});if(!Ua)return Object(ea.a)("calcManager is null");if(!Ua.hB)return Object(ea.a)("calcManager.NumberFormatter is null");if(!this.Xx)return Object(ea.a)("instantaneousManager is null");let lb;if("number"===typeof cb||"string"===typeof cb){var sb=Ua.E4a(cb);if(!Object(ea.c)(sb))return sb;lb=sb.value}else lb=cb;sb=Ua.hB;const V=P(gb);if(void 0===V||null===V)return Object(ea.a)("cellValue is null");
Ua=excelOnlineCalc.calc.cellValueToReadOper(Ua.config.mathpack,V);if(void 0===Ua||null===Ua)return Object(ea.a)("readOper is null");Ua=sb.applyFormat(lb,Ua,M.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Ua)?this.oha.kcd(sb,Ua.value,gb.type,La,ja,"number"===typeof cb?cb:-1,!1):Object(ea.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Ua.reason.kind))}xZe(gb,cb,La,ja,Ua){var lb=Object(Na.a)({Q5:266,new:Ea.b,registry:this.$.da,
G3:M.EwaSettings.dX});if(void 0===lb||null===lb)return Object(ea.a)("calcManager is null");if(void 0===lb.hB||null===lb.hB)return Object(ea.a)("calcManager.NumberFormatter is null");if(void 0===this.Xx||null===this.Xx)return Object(ea.a)("instantaneousManager is null");var sb=lb.E4a(cb);if(!Object(ea.c)(sb))return sb;var V=sb.value;sb=lb.hB;gb=sb.parseEdit(gb,V);if(!excelOnlineCalc.util.isSuccess(gb))return Object(ea.a)(`ParseEdit failure: reason=${gb.reason.kind}, features=${gb.reason.features}`);
if(gb.value.kind===u.a.formula)return Object(ea.a)("Main thread - skipping formula edit");lb=excelOnlineCalc.numfmt.applyValueEdit(sb,lb.localeInfo,V,gb.value);if(!excelOnlineCalc.util.isSuccess(lb))return Object(ea.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(lb.reason.kind));gb=gb.value;d.ULS.shipAssertTag(537162190,0,gb.kind!==u.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");gb=excelOnlineCalc.numfmt.getValueEditOperKind(gb);V=
0;switch(gb){case 0:case 128:V=0;break;case 1:V=1;break;case 2:V=2;break;case 4:V=3;break;case 8:V=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${gb} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${gb}`)}return this.oha.kcd(sb,lb.value,V,La,ja,"number"===typeof cb?cb:-1,Ua)}qui(gb,cb,La){if(cb.width<La.width){const ja=
gb.Wj("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new n.Range(cb.top,cb.left,cb.bottom,cb.left,!0,!0));for(;ja.$$mn();){let Ua=ja.$$cu();if(Ua&&Ua.oLa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(cb.height<La.height)for(gb=gb.Wj("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new n.Range(cb.top,cb.left,cb.top,cb.right,!0,!0));gb.$$mn();)if((cb=gb.$$cu())&&cb.qLa())return d.ULS.sendTraceTag(537162138,
0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}N4c(gb,cb,La,ja,Ua){const lb=cb.ZR().FirstRow,sb=cb.ZR().LastRow;var V=La.ZR().FirstRow;const za=La.ZR().LastRow;let Ra=lb;for(;V<=za;V++,Ra++){Ra>sb&&(Ra=lb);const Xa=cb.ZR();Xa.FirstRow=Xa.LastRow=Ra;const $a=La.ZR();$a.FirstRow=$a.LastRow=V;this.aah(gb,A.a.bQ(Xa),A.a.bQ($a),ja,Ua)}}B4i(gb,cb){const La=Object(Na.a)({Q5:266,new:Ea.b,registry:this.$.da,G3:M.EwaSettings.dX});return void 0!==La&&null!==La?(La.X_g(gb,
cb.topLeft,this.oha.uPf),!0):!1}nvi(gb,cb){const La=gb.right-gb.left+1;gb=gb.bottom-gb.top+1;const ja=cb.right-cb.left+1;cb=cb.bottom-cb.top+1;if(ja>La&&cb>gb){if(!(ja%La&&cb%gb))return!0}else if(ja===La&&cb>gb){if(!(cb%gb))return!0}else if(ja>La&&cb===gb&&!(ja%La))return!0;return!1}Uoh(gb){if(M.EwaSettings.sa(101)){gb=oa.h(this.$).R0(gb).gridView.getRangeInformation(gb);for(const cb of gb)if(Object(l.a)(x.DynamicArrayRange,cb)&&!Object(v.a)(x.DynamicArrayRange,cb).O9a)return!0}return!1}zGe(gb,cb,
La,ja,Ua,lb){for(let sb of cb)La&&(this.eah(sb,Ua),sb.setCell(!0)),ja&&(lb=this.$9h(Ua,sb)),lb||(gb.Ca.ZU(),lb=!0);return lb}CVh(gb,cb,La){cb=new n.Range(cb,La,cb,La,!0,!0);return gb.Qb(cb)}aah(gb,cb,La,ja,Ua){if(La){this.LSa&&La.equals(this.LSa.range)||(h.a.Ja(this.LSa),this.LSa=gb.Wj("FormatCellsAction.CopyBetweenRows",La));La=this.LSa;La.$$rst();var lb=!1;if(M.EwaSettings.getBooleanFeatureGate(wb.a.vJe,!1)){var sb=cb.ZR().FirstColumn+1,V=cb.ZR().LastColumn+1;cb=cb.ZR().FirstRow+1;let Ra=sb;for(;La.$$mn();){Ra>
V&&(Ra=sb);const Xa=this.CVh(gb,cb,Ra);Ra+=1;var za=void 0;const $a=La.$$cu().sH?gb.vLb(La.$$cu().range):(za=new m.a,za.add(La.$$cu()),za);Xa&&(lb=this.zGe(gb,$a,ja,Ua,Xa,lb));Gb.lastOrDefault($a)}}else for(za=gb.Wj("FormatCellsAction.CopyBetweenRows2",cb);La.$$mn();)za.$$mn()||(za.$$rst(),za.$$mn()),V=za.$$cu(),cb=La.$$cu().sH?gb.vLb(La.$$cu().range):(sb=new m.a,sb.add(La.$$cu()),sb),V&&(lb=this.zGe(gb,cb,ja,Ua,V,lb)),Gb.lastOrDefault(cb)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}k$f(){const gb=
mb.a.ed(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");nc.a(this.$).kj(gb)}ZFi(gb,cb){const La={ValidMembers:32},ja=cb.NumberFormat;switch(gb){case 1890566896:if(1001===ja||1002===ja||1003===ja){La.NumberFormat=14;La.NumberFormatOptions={};switch(ja){case 1001:La.NumberFormatOptions.TimeType=2;break;case 1002:La.NumberFormatOptions.DateType=7;break;case 1003:La.NumberFormatOptions.DecimalPlaces=0}La.NumberFormatOptions.NumberFormatCategory=this.fSg(ja)}else La.NumberFormat=ja;break;
case 1886928607:La.NumberFormat=13;break;case -992833457:La.NumberFormat=11;break;case 218524921:La.NumberFormat=12;break;case 996232352:La.NumberFormat=14;La.NumberFormatOptions=Object(f.a)(new r.a,{DecimalPlaces:0});La.NumberFormatOptions.NumberFormatCategory=6;break;default:return cb}return La}formatCells(gb,cb,La,ja=null,Ua=null,lb=null,sb=null){var V;const za=this.$.Jb.Gc("UserAction","FormatCellsInstantaneous, command = "+pb.b().Cj(gb)),Ra=this.$.Jb.zg("UserAction","FormatCellsInstantaneousFrame");
Ra.start();Yb.a(Ra);var Xa=pb.b().Cj(gb);const $a=this.$,ma=oa.h($a);var fa=ma.ha.qa,eb=Ua||fa.selectedRanges,ua=wa.g(eb,hb=>hb.Ny);Xa=`${Xa}, cellCount=${ua}`;oa.h(this.$).vh.u0(1,za.id,Xa);eb=z.r(eb,this.$);fa=fa.activeCell;Xa=-168056295===La.command;var xa=ua=null;if(Xa){xa=ma.wb.Wo(fa);if(!xa){this.k$f();return}ua=xa.Rca.substring(1,xa.Rca.length-1);xa=xa.Qbc();if(!xa){this.k$f();return}xa=xa.Caption}ma.Gg.dM(!1,!0);const tb=z.o(fa,$a),Qb=$a.oa.xa.Wb({xla:!0,qka:1}),pc=this.ZFi(La.command,cb);
Xa||this.Xda(ma,gb,cb,!1,ja,Ua);za.stop();oa.h(this.$).vh.UR(za.id,na.BasicTelemetryCalculator.zQ);La.dji=kb.a.Ya.Ub;ja=this.$.Jb.Gc("UserAction","FormatCellsUserAction");Ua=this.jl&&this.Jif(null===(V=null===cb||void 0===cb?void 0:cb.Font)||void 0===V?void 0:V.FontName);this.iCi(gb,La.taskId,cb,eb,fa,ja.id,Ua);pb.b().aC(za.id,ja.id,"actions","actions");pb.b().aC(Ra.id,ja.id,"actions","actions");$a.userOperationManager.Jc(new R(this,eb,tb,pc,Xa,ua,xa,Qb,ja,za.id,64,lb,sb),La)}w2(gb,cb,La,ja,Ua,lb,
sb,V,za,Ra,Xa){const $a=this.$;return(ma,fa,eb)=>{$a.my();ma=[ma,this.fSi];fa=[fa];Ra&&ma.push(Ra);Xa&&fa.push(Xa);return C.l($a.oa.xa,gb,cb,La,ja,Ua,lb,!1,va.b(...ma),va.a(...fa),eb,za,sb,V)}}Q9f(gb,cb,La,ja,Ua,lb,sb=null){if(cb&&La){var V=La.Font,za=La.HorizontalAlignment,Ra=La.VerticalAlignment;La.ValidMembers&2||(za=cb.lB);La.ValidMembers&1||(Ra=cb.verticalAlignment);var Xa=0!==za;ya.nli(gb)&&0===za&&(za=this.I3e(cb));var $a=!1;switch(gb){case -394785302:this.Hua.xdb(cb,za,Xa,0);break;case 1041132226:this.Hua.xdb(cb,
za,Xa,1);break;case -571165336:this.Hua.xdb(cb,za,Xa,2);break;case -1150205178:case -1142465846:case -286432209:this.Hua.xdb(cb,za,Xa,Ra,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.aEj(this.iNa,cb)&&this.bxj(cb,La,Xa);break;case 1650812936:this.setFillColor(cb,La,lb);break;case -287251124:cb.bold=V.Bold;break;case -1690267012:oa.h(this.$).ha.qa.Tg&&(V=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1)?sb?sb:oa.h(this.$).ha.qa.ld:oa.h(this.$).ha.qa.ld,this.Hua.ULb(cb,La,V));break;case 1970784898:La=E.a.Uo(cb.color,cb.backgroundColor);if(yb.a.compare(La,yb.a.red)&&(Ha.a.R4(cb.text)||Ha.a.Faf(cb.text)))break;La=yb.a.YG(V.FontColor);cb.color=Fa.e(E.a.PF(La));break;case -1925065947:cb.italic=V.Italic;break;case -1293291468:cb.fontName=V.FontName;this.Rl&&cb.P4f(V.FontScheme);break;case 862890474:case 963349338:cb.fontSize=V.FontSize;this.$.qf();break;case -1077965542:cb.fontSize=V.FontSize;break;
case 1764140053:cb.underline=V.Underline;break;case -1685033574:cb.doubleUnderline=V.DoubleUnderline;break;case -1590502662:cb.fontStrikethrough=V.Strikethrough;break;case -848953656:case 2045211913:$a=cb.frb();break;case 2105621672:La=Object(v.a)(Wb.a,Ua);if(!La)break;V=yb.a.CKh(La.color);cb.color=Fa.e(E.a.PF(V));this.Rue(cb,La.aoc);break;case -1409276245:this.Rue(cb,La.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.qSg(cb,La);break;case -1228228458:cb.frb();cb.clearFormat();
this.RYc(cb,0);$a=!0;break;case -730106152:cb.clearFormat();this.RYc(cb,0);break;case 932244020:this.axj(cb,La,lb);break;case -1942512156:case -1920201820:this.$yj(cb,La)}ja||($a?cb.oJb(!0):cb.setCell(!0))}else d.ULS.shipAssertTag(537162135,0,!cb,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!La,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}eah(gb,cb){gb&&cb?(gb.prb(cb),gb.N2c(cb),this.RYc(gb,cb.cell.hj)):d.ULS.sendTraceTag(537162133,
0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}RYc(gb,cb){if(0>cb)this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:gb,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var La=this.v3a(gb.Fr,cb,gb.cell.oBa,gb.cell.Zha);Object(ea.b)(La)?this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:gb,kind:"failure",reason:La.reason}):(this.Wob(gb,La.value),this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:gb,
kind:"success",HA:La.value,format:cb}))}}Rue(gb,cb){if(void 0===cb||null===cb)this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:gb,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var La=this.v3a(gb.Fr,cb,gb.cell.oBa,gb.cell.Zha);Object(ea.b)(La)?this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:gb,kind:"failure",reason:La.reason}):(this.Wob(gb,La.value),this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:gb,kind:"success",HA:La.value,format:cb}))}}qSg(gb,
cb=null){if(cb)if(cb=this.T1h(gb,cb),cb.success){var La=this.v3a(gb.Fr,cb.Xnc,gb.cell.oBa,gb.cell.Zha);Object(ea.b)(La)?this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:gb,kind:"failure",reason:La.reason,format:cb.Xnc}):(this.Wob(gb,La.value),this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:gb,kind:"success",HA:La.value,format:cb.Xnc}))}else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:gb,kind:"failure",reason:cb.reason,format:cb.Xnc});else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",
cell:gb,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}fSg(gb){switch(gb){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<gb?-1:gb}T1h(gb,cb){if(!this.Xx||!this.localeInfo||!cb)return gb=this.Xx?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new ka(!1,void 0,"GetRibbonNumberFormat: "+gb);cb=cb.NumberFormat;
switch(cb){case 0:gb=w.bLh;break;case 1:gb=w.dLh;break;case 2:gb=w.$Kh;break;case 3:gb=w.YKh;break;case 4:gb=w.gLh;break;case 5:gb=w.cLh;break;case 6:gb=w.iLh;break;case 7:gb=w.eLh;break;case 8:gb=w.aLh;break;case 9:gb=w.fLh;break;case 10:gb=w.hLh;break;case 11:case 12:return this.Xx.oZe(),this.TSh(gb,cb);case 13:gb=w.WZg;break;case 1006:gb=w.buttonPercentage;break;case 1004:gb=w.keyboardNumber;break;case 1005:gb=w.keyboardCurrency;break;case 1002:gb=w.keyboardDate;break;case 1001:gb=w.keyboardTime;
break;case 1003:gb=w.keyboardPercentage;break;case 14:return gb="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,gb),new ka(!1,void 0,gb);default:return gb="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,0,!1,gb),new ka(!1,void 0,gb)}return gb?(gb=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,gb))?new ka(!0,gb):new ka(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):
new ka(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}TSh(gb,cb){if(!this.calcManager||!this.hB)return cb=this.calcManager?"numberFormatter is null":"calcManager is null",new ka(!1,void 0,"GetDecimalChangeNumberFormat: "+cb);gb=this.calcManager.E4a(gb.cell.hj);if(!Object(ea.c)(gb))return new ka(!1,void 0,`getDecimalChangeNumberFormat: ${gb.reason}`);cb=this.hB.changeFormatDecimals(gb.value,11===cb?1:-1);return excelOnlineCalc.util.isSuccess(cb)?void 0===cb.value||null===cb.value?
new ka(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new ka(!0,cb.value):new ka(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}Zba(gb){const cb=gb.caller,La=gb.cell;var ja=gb.format;ja=null==ja?"null":"number"===typeof ja?ja:"string"===typeof ja?Ha.a.xZa(ja):Ha.a.xZa(ja.formatString);const Ua=Ha.a.xZa(La.Fr.value)||"null",lb="success"===gb.kind?Ha.a.xZa(gb.HA.text):"null";gb=JSON.stringify({caller:cb,"range.top":La.range.top,"range.left":La.range.left,
result:gb.kind,reason:"success"===gb.kind?"":gb.reason,value:Ua,valueType:La.Fr.type,ifmt:ja,prediction:lb});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${gb}`)}rSg(gb,cb,La,ja,Ua,lb,sb,V=!1,za=!1,Ra=0,Xa=null){const $a=cb.cell;$a.mC=Ra;Ra=cb.text;Ra!==La&&($a.text=La);$a.BOa=Xa;Ja.f(Ra)?cb.formulaBarText=Ra:cb.formulaBarText="";gb=oa.h(gb).wb.mlf(cb.range);this.u1c(cb,ja,null,V,za,gb);Ua&&(cb.color=Fa.e(E.a.PF(Ua)));cb.cell.hj=lb;cb.cell.dHb=sb;cb.cell.yAc=lb}iCi(gb,
cb,La,ja,Ua,lb,sb){const V={};V.a=this.$.ya.UserSessionId;V.b=cb;V.c=ja.Ranges.length;V.d=this.geh(ja.Ranges);V.e=Ua.toString();V.f=gb;V.h=lb;1890566896===gb?V.g=La.NumberFormat.toString():2105621672===gb?V.g=La.NumberFormatOptions.NumberFormatCategory.toString():this.jl&&-1293291468===gb&&(V.g=`{ "isNewFont": ${sb} }`);pb.b().Te(3,V,!0)}geh(gb){let cb=0,La=0,ja=0;for(let Ua=0;Ua<gb.length;Ua++){const lb=z.B(gb[Ua]).Ny;cb+=lb;lb>ja&&(ja=lb,La=Ua)}gb=z.B(gb[La]).toString();return"TotalCellCount:"+
cb+"; Max range:"+gb+"; MaxRangeSize:"+ja+";"}axj(gb,cb,La){64===(cb.ValidMembers&64)&&this.setFillColor(gb,cb,La);16===(cb.ValidMembers&16)&&ya.Byj(gb,cb);128===(cb.ValidMembers&128)&&this.Hua.ULb(gb,cb,gb.range);if(2===(cb.ValidMembers&2)||1===(cb.ValidMembers&1)){La=cb.VerticalAlignment;cb=cb.HorizontalAlignment;const ja=0!==cb;M.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ja&&this.I3e(gb);this.Hua.xdb(gb,cb,ja,La)}}setFillColor(gb,cb,La){(M.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
gb.JM:gb.JM&&gb.oyb&&!gb.ryb&&!gb.uyb)||(cb=-1===cb.FillColor?La?E.a.PF(yb.a.white):null:E.a.PF(yb.a.YG(cb.FillColor)),gb.backgroundColor=cb?Fa.e(cb):null)}$yj(gb,cb){0!==gb.lB&&2!==gb.lB||gb.m0(1,!1);0<=gb.indentation+cb.IndentationIncrease&&(gb.indentation+=cb.IndentationIncrease)}aEj(gb,cb){return gb&&!(0<cb.indentation)}bxj(gb,cb,La){const ja=cb.TextOrientation;ja!==Z.a.verticalText&&(0>ja||180<ja)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${ja}`);
gb.eL=cb.TextOrientation;La||gb.m0(0<=gb.eL?1:3,!1)}I3e(gb){gb=this.v3a(gb.Fr,gb.cell.hj,gb.cell.oBa,gb.cell.Zha);return Object(ea.b)(gb)?0:null!=gb.value.horizontalAlignment?gb.value.horizontalAlignment:0}pAj(gb,cb,La){this.rx||(this.rx=new Ca.a(oa.h(this.$).Ca,this.$));this.rx.ULb(gb,cb,La)}$9h(gb,cb){const La=new ab.a;if(gb.cell.formulaBarText&&gb.cell.formulaBarText.startsWith("'"))La.Text=gb.cell.formulaBarText;else{let ja=gb.cellValue;ja&&4!==gb.cell.mC||(ja=gb.text);La.Text=ja}this.ySa(cb,
La,!1,S.a.drd(this.$));return!0}BFj(gb,cb){return this.vb&&!!gb&&!!cb}static $7g(gb,cb,La,ja){ja&&cb.setCell(!0);0===La&&gb.Ca.ZU()}static expandRange(gb,cb){cb=cb.clone();cb.height<gb.height&&(cb.bottom=cb.top+gb.height-1);cb.width<gb.width&&(cb.right=cb.left+gb.width-1);return cb}static nli(gb){switch(gb){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static Byj(gb,cb){cb=cb.Font;var La=0!==(cb.ValidMembers&16);const ja=
0!==(cb.ValidMembers&16),Ua=0!==(cb.ValidMembers&16);gb.bold=0!==(cb.ValidMembers&4);gb.italic=0!==(cb.ValidMembers&8);La&&(gb.underline=La);ja&&(gb.doubleUnderline=ja);Ua&&(gb.fontStrikethrough=Ua);gb.fontName=cb.FontName;gb.fontSize=cb.FontSize;La=E.a.Uo(gb.color,gb.backgroundColor);yb.a.compare(La,yb.a.red)&&(Ha.a.R4(gb.text)||Ha.a.Faf(gb.text))||(cb=yb.a.YG(cb.FontColor),gb.color=Fa.e(E.a.PF(cb)))}}ya.RHh=36;Object(t.a)(ya,"FormatCellsAction",null,[235,2]);class nb extends e.a{constructor(gb){super();
this.$=gb;this.Db()}create(){this.nb(new ya(this.$))}static ka(gb){gb.da.Ha(18,new nb(gb))}}Object(t.a)(nb,"FormatCellsActionFactory",e.a,[]);a.d(F,"a",function(){return vb});const vb=()=>{b.a.Fa(nb.ka)}},1186:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(1),f=a(15),d=a(202),h=a(81),m=a(37),l=a(48),v=a(44),r=a(649),A=a(28),x=a(120);class n{constructor(){this.startTime=A.a.Ya.Ub;this.tx=new r.a}t2e(){return x.a(A.a.Ya,this.startTime)}}Object(t.a)(n,"OngoingAction",null,[]);class u extends h.a{constructor(Na,
ya,nb,vb,gb=null){super();this.nPa=this.Fob=null;this.h0c=0;this.Hqc=null;this.EYi=()=>{const cb=this.nPa.t2e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.ula}>.OnRunningLong: Operation running for more than ${cb}ms`);this.Hqc=l.a.instance.create(this.f6,Math.max(this.Xye-cb,0),v.a.ene)};this.f6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.ula}>.OnTimeout: Operation running for more than ${this.nPa.t2e()}ms, timing out. Has pending actions: ${this.l6a}`);this.h0c++;
this.h0c>this.Wye&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.ula}>.OnTimeout: passed the allowed bypassed count`);this.nPa.tx.cancel();this.bYe()};this.PH=()=>{this.l6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.ula}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.$La}, AggregatedActionParams not null: ${this.l6a}`);this.yod()};this.ZGg=Na;this.$Gg=ya;this.documentVisibilityObserver=nb;this.ula=vb;this.cL=gb;nb&&this.documentVisibilityObserver.Qra(this.PH);this.g0c=
!!nb&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.Wye=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ya=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.Xye=Na.Hed(ya);Na=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.g_g=Math.max(this.Xye-ya,0)+Na}get $La(){return!!this.nPa}get l6a(){return!!this.Fob}oMf(Na){f.ULS.sendTraceTag(537153864,
0,50,`ActionAggregator<${this.ula}>.PerformThrottledAction: Start. IsActionOngoing: ${this.$La}, AggregatedActionParams not null: ${this.l6a}`);this.Fob=this.$Gg.mYc(Na,this.Fob);this.yod()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.Uza(this.PH);this.EAe();super.dispose()}E5f(Na){this.g0c?(this.nPa=Na?new n:null,Na?this.startTimer():this.EAe()):this.nPa=Na?{}:null}bYe(Na=null){this.g0c&&Na&&Na.YJ?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.ula}>.FinishedCallback: timedout, skipping`):
(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.ula}>.FinishedCallback: Start. IsActionOngoing: ${this.$La}, AggregatedActionParams not null: ${this.l6a}`),this.E5f(!1),this.yod())}yod(){if(!this.aNb()){var Na=this.Fob;this.Fob=null;this.E5f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.ula}>.InternalPerformAction: Calling PerformAction.`);var ya=this.g0c?this.nPa.tx.token:d.a.none;m.TaskExtensions.za(this.ZGg.cGd(Na),()=>{this.bYe(ya)},ya,0,this.cL)}}aNb(){return!this.l6a||
this.$La?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Vh?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.ula}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}EAe(){this.Hqc&&this.Hqc.cancel()}startTimer(){this.h0c<=this.Wye&&(this.Hqc=l.a.instance.create(this.EYi,this.g_g,v.a.ene))}}Object(t.a)(u,"ActionAggregator",h.a,[787,2]);var z=a(27),w=a(86),C=a(110),y=a(14),B=a(46),H=a(38),I=a(19),R=a(5),S=a(132),G=a(13),D=a(21),E=a(55);class M extends H.a{constructor(Na){super();
this.vw=this.firstElement=null;this.xMa=!1;this.Cs=null;this.$Dj=z.a.Cf;this.LEf=ya=>{const nb=ya.Ea.keyCode;return nb===w.a.Jh?this.jRi():nb===w.a.Ay&&ya.Ea.shiftKey?this.ZDh(this.firstElement):!1};this.dKf=ya=>{if(!this.xMa||ya.Ea.keyCode!==w.a.XF)return!1;M.qcf();E.Task.delay(1).Qo(()=>{this.vw.focus();return!0},0,this.la);return!0};this.a1i=()=>{document.activeElement&&document.activeElement.id===this.vw.id||(M.qcf(),E.Task.delay(1).Qo(()=>{this.vw.focus();return!0},0,this.la))};this.LCf=()=>
{this.Qfg(this.vw)};this.KEf=ya=>{ya.stopPropagation();ya.preventDefault();this.xMa&&(this.xMa=!1)};this.$=Na;(Na=this.$.ea.$b)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Na.Usa}; InWebPart = '${Na.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Na.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Na&&(Na.inWebPart||Na.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Na.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${Na.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Xch(),this.Xdh(),C.KeyInputManager.instance.ta(y.a.Sb,this.$.domElement,this.dKf));this.$.da.Ha(238,this)}iNg(Na){this.addHandler("KBIS",Na)}Qjj(Na){this.removeHandler("KBIS",Na)}dispose(){this.firstElement&&B.a.removeHandler(this.firstElement,y.a.focus,this.LCf);this.Cs&&this.Cs.detach("focus");this.vw&&(B.a.removeHandler(this.vw,y.a.focus,this.KEf),B.a.removeHandler(this.vw,y.a.blur,M.onBlur),
C.KeyInputManager.instance.Ba(y.a.Sb,this.vw,this.LEf));C.KeyInputManager.instance.Ba(y.a.Sb,this.$.domElement,this.dKf);this.Cs=this.vw=this.firstElement=this.$=null;super.dispose()}Xch(){this.$Dj?(this.firstElement=document.documentElement,this.Cs=S.a.instance.KG(document.parentWindow),this.Cs.ka("focus",this.a1i)):(this.firstElement=M.HHe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),B.a.addHandler(this.firstElement,y.a.focus,this.LCf))}Xdh(){this.vw=M.HHe();this.vw.id=
R.a.bPe;this.vw.setAttribute(R.a.Vu,G.a.instance.ga(861));document.body.appendChild(this.vw);B.a.addHandler(this.vw,y.a.focus,this.KEf);B.a.addHandler(this.vw,y.a.blur,M.onBlur);C.KeyInputManager.instance.ta(y.a.Sb,this.vw,this.LEf)}ZDh(Na){this.Qfg(Na);return!1}jRi(){this.xMa=!0;D.h(this.$).focus();D.h(this.$).ha.s$e();this.raiseEvent("KBIS");return!0}Qfg(Na){this.xMa?this.xMa=!1:(this.xMa=!0,Na&&Na.focus())}static HHe(){const Na=document.createElement("div");Na.tabIndex=0;return Na}static qcf(){document.body.classList.add(I.a.XRe)}static onBlur(){document.body.classList.remove(I.a.XRe)}}
Object(t.a)(M,"EmbedViewFocusControl",H.a,[786,2]);var L=a(4),N=a(1102),Y=a(63),U=a(521),P=a(24),aa=a(41),X=a(374),Z=a(192),da=a(284),qa=a(113),O=a(29),ca=a(250),wa=a(282),ia=a(60);const Ha=(Na,ya,nb,vb,gb,cb,La,ja,Ua,lb,sb=null)=>{sb=Na.Na(1,sb);sb.selectedRange=ya;sb.richValueKeyPath=nb;sb.singleColumn=vb;sb.searchForRange=gb;sb.calculateMajorityDataType=cb;return ia.g(Na,"GetRichValueFieldListContextList",sb,La,ja,Ua,lb,4)};var Sa=a(33);class Da extends H.a{constructor(Na,ya){super();this.DKb=
this.mgd=this.Nwb=this.TO=null;this.gVb=!1;this.p7d=null;this.SId=!1;this.OSi=(nb,vb,gb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+gb);this.DKb&&this.DKb.stop();this.TO=null;this.raiseEvent(N.h)};this.PSi=nb=>{ca.a(nb)||(this.DKb&&this.DKb.stop(),this.gVb=!1,(this.TO=nb.Result)&&0<this.TO.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.TO.length} rich value field list context for autocomplete`),this.tWa=!0,this.Xsc())};this.tWa=!1;this.jb=
Na;this.NTb=-1;this.tableManager=ya;this.SId=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Sa.a.aV(Na)}v_b(Na){this.addHandler(N.a,Na)}yuc(Na){this.removeHandler(N.a,Na)}IMg(Na){this.addHandler(N.h,Na)}xjj(Na){this.removeHandler(N.h,Na)}get O6a(){return this.tWa}get IAi(){return this.gVb}get QZe(){return this.NTb}get W6c(){return this.p7d}get $(){return this.jb}get Pk(){return this.TO}get DUh(){return!!this.Nwb}dispose(){this.jb=null;this.Gcb();super.dispose()}X5i(){var Na=
Array(6);var ya={};ya.Name=N.f;Na[0]=ya;ya={};ya.Name=N.c;Na[1]=ya;ya={};ya.Name=N.d;Na[2]=ya;ya={};ya.Name=N.g;Na[3]=ya;ya={};ya.Name=N.e;Na[4]=ya;ya={};ya.Name=N.b;Na[5]=ya;ya={ColumnName:"",ColumnIndex:-1};ya.FieldInfoDataList=Na;Na=[];Na[0]=ya;this.pRd(Na)}kZ(Na,ya,nb,vb=null){if(Na){this.V0c();this.M2b();var gb=null,cb=!1;if(!vb&&({mab:cb,Pk:gb}=this.UVj(Na,ya,nb)).returnValue)if(this.SId||this.pRd(gb),this.gVb=!0,this.TO=gb,this.SId){if(!cb){this.tWa=!0;this.Xsc();return}}else if(this.TO&&0<
this.TO.length&&(this.tWa=!0,this.Xsc()),!cb)return;this.Ijg(Na,vb,ya,nb,!1)}}Ijg(Na,ya,nb,vb,gb){if(this.$.ea.Xb){this.$.Jb&&(this.DKb=this.$.Jb.Gc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Nwb=null;var cb=this.$.oa.xa.Wb();this.Nwb=Ha(this.$.oa.xa,Na,ya,nb,vb,gb,this.PSi,this.OSi,null,cb)}else this.TO=null}Gcb(){this.TO=null;this.tWa=!1;this.V0c();this.M2b();this.Nwb=null;this.NTb=-1}V0c(){Da.Mqb(this.Nwb)}M2b(){Da.Mqb(this.mgd)}Xsc(){this.raiseEvent(N.a)}Mp(Na){Na=aa.D(Na);--Na.left;
--Na.right;return this.tableManager.Mp(Na)}sKa(Na){Na.FirstColumn=Na.FirstColumn;Na.LastColumn=Na.LastColumn;Na.FirstRow=Na.FirstRow;Na.LastRow=Na.LastRow;this.M2b();this.mgd=null;return X.a(this.$.userOperationManager,(ya,nb,vb)=>da.i(this.$.oa.xa,Na,wa.b(ya,gb=>{this.YSi(gb)}),wa.a(nb,nb,gb=>{this.XSi(gb)}),vb,null),ya=>new Z.a(264,0,ya,80),null)}XSi(Na){Na=qa.a.Pe(Na.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${O.a.nc(Na)}`)}YSi(Na){if(ca.a(Na))-315732528!==
Na.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${O.a.nc(Na.Errors)}`);else if(Na&&Na.Result){Na=Na.Result;var ya=Na.HasHeaderRow;ya=new U.AutofilterRange(Na.TableRange.FirstRow+(ya?1:0)+1,Na.TableRange.FirstColumn+1,Na.TableRange.LastRow+1,Na.TableRange.LastColumn+1,null,null,null,0,ya);this.NTb=Na.TableRange.FirstColumn;(Na=this.wPf(!1,!0,ya))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");
this.pRd(Na)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}UVj(Na,ya,nb){let vb,gb;gb=null;vb=!1;if(Na.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,mab:vb,sKa:!1,Pk:gb};let cb;this.NTb=-1;if(nb){cb=this.Mp(Na);if(!cb||!cb.$ja)return{returnValue:!1,mab:vb,sKa:!1,Pk:gb};var La=D.h(this.$).wb.L6e(cb);this.p7d=cb;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&
La&&0<La.count)return--Na.FirstColumn,--Na.LastColumn,this.mgd=this.sKa(Na),{returnValue:!0,mab:vb,sKa:!0,Pk:gb};cb.top+=1;cb.right=aa.D(Na).right-1}else cb=new U.AutofilterRange(Na.FirstRow+1,Na.FirstColumn+1,Na.LastRow+1,Na.LastColumn+1,null,null,null,0,!1);if(cb.top>cb.bottom||cb.left>cb.right)return{returnValue:!0,mab:vb,sKa:!1,Pk:gb};Na=D.h(this.$);var ja=Na.ib.width,Ua=Na.ib.height;La=Na.view.visibleArea;ja=new Y.a(La.x-ja,La.y-Ua,La.width+ja,La.height+Ua);Ua=Na.xg(cb);if(!La||!Ua||!Na.bjc(cb))return{returnValue:!1,
mab:vb,sKa:!1,Pk:gb};ja.contains(Ua)||(vb=!0);gb=this.wPf(ya,nb,cb);return{returnValue:!0,mab:vb,sKa:!1,Pk:gb}}pRd(Na){Na&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Na.length} rich value field contexts from block cache`);this.gVb=!0;(this.TO=Na)&&0<this.TO.length&&(this.tWa=!0,this.Xsc())}wPf(Na,ya,nb){let vb;vb=null;const gb=nb.clone();if(ya)for(let cb=nb.right,La=0;cb>=nb.left;--cb){if(gb.left=cb,gb.right=cb,ya=this.I2e(gb,!0,nb.left)){vb||(vb=[]);vb[La]=ya;if(Na)break;++La}}else if(Na=this.I2e(gb,
!1))vb=[],vb[0]=Na;return vb}I2e(Na,ya,nb=0){var vb=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var gb=D.h(this.$).wb.W1h(Na);if(gb&&0<gb.count){var cb=Array(gb.count);vb=0;for(var La of gb.values)gb={},gb.Name=La,cb[vb]=gb,++vb;La="";gb=-1;0<Na.top&&ya&&(Na=new P.Range(Na.top-1,Na.left,Na.top-1,Na.left,!1,!1),null!=D.h(this.$).Qb(Na)&&null!=D.h(this.$).Qb(Na).originalText&&(La=D.h(this.$).Qb(Na).originalText),gb=Na.left-nb);vb={};vb.ColumnName=
La;vb.ColumnIndex=gb;vb.FieldInfoDataList=cb}}else if((La=D.h(this.$).wb.L6e(Na))&&0<La.count){cb=Array(La.count);vb=0;for(gb of La)La={},La.Name=gb,cb[vb]=La,++vb;La="";gb=-1;0<Na.top&&ya&&(Na=new P.Range(Na.top-1,Na.left,Na.top-1,Na.left,!1,!1),La=D.h(this.$).Qb(Na).originalText,gb=Na.left-nb);vb={};vb.ColumnName=La;vb.ColumnIndex=gb;vb.FieldInfoDataList=cb}return vb}static Mqb(Na){Na&&L.AFrameworkApplication.Bd.Nt(Na.Rs)}}Object(t.a)(Da,"FieldInfoManager",H.a,[317,2]);class ea extends Da{constructor(Na,
ya,nb,vb){super(Na,ya);this.l2a=null;this.FCf=()=>{this.yuc(this.FCf);if(this.Pk&&this.Pk.length&&this.contextMenuManager){var gb=this.contextMenuManager.zfd("autoFilterRichFieldList"),cb=window.document.getElementById(this.l2a);gb.r0(null,cb,this,null,!0)}};this.dtg=nb;this.contextMenuManager=vb}get CG(){return this.dtg}NUh(Na,ya){this.l2a=ya;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Na.FirstRow}, ${Na.FirstColumn}, ${Na.LastRow}, ${Na.LastColumn})`);
this.Ijg(Na,null,!0,!1,!0)}}Object(t.a)(ea,"FilterInfoManager",Da,[318,317,2]);var sa=a(856),Ea=a(1114),ba=a(30),ka=a(89),Ca=a(8);class db{}db.Zxh="ewa-sharedUi-launchButton";db.byh="ewa-sharedUi-launchButtonWithText";db.$xh="ewa-sharedUi-launchButtonClick";db.cyh="ewa-sharedUi-launchButtonWithTextClick";db.ayh="ewa-sharedUi-launchButtonText";Object(t.a)(db,"CssClassNames",null,[]);var yb=a(65);a(516);var kb=a(241),mb=a(227);H=a(239);var W=a(287),Q=a(74),va=a(11),na=a(255),Ba=a(34);class Oa extends H.a{constructor(Na,
ya,nb,vb,gb,cb,La,ja,Ua){super(document.createElement("div"));this.gpf=null;this.pVd=!1;this.htmlSanitizationHelper=this.GOb=this.HSa=null;this.uN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.tN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.oKj=()=>{this.qne()};this.fd=lb=>{this.raiseEvent(this.QHb,lb);this.PHb();return!0};this.QQi=lb=>{100<x.a(A.a.Ya,this.gpf)&&this.Bkd(new Sys.UI.Point(Math.round(lb.clientX),Math.round(lb.clientY)))};this.pN=lb=>{Q.g(lb.Ea,!1);return!1};this.OY=
this.ze.$Ha();this.set_visible(!1);this.Gjc=gb;this.QHb=cb;this.Mnc=Na;this.R3b=ya;this.htmlSanitizationHelper=Ua;this.Gjc&&(this.HSa=l.a.instance.create(this.oKj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));Na&&this.domElement.classList.add(Na);this.WGa=document.createElement("div");this.domElement.appendChild(this.WGa);nb&&this.WGa.classList.add(nb);this.T_d(vb);La&&(this.GOb=document.createElement("div"),this.domElement.appendChild(this.GOb),this.GOb.classList.add(ja),this.GOb.innerText=La,this.domElement.style.padding=
"3px",kb.a.instance.ta(y.a.pointerDown,this.domElement,this.pN));this.s_a=new W.a(this.domElement,7);mb.a.instance.ta(y.a.click,this.domElement,this.fd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&kb.a.instance.ta(y.a.pointerDown,this.domElement,this.pN);Na=lb=>{Q.g(lb)};this.Cc.ka("mouseup",Na);this.Cc.ka("click",Na);this.Cc.ka("dblclick",Na)}f2(Na){this.addHandler(this.QHb,Na)}qda(Na){this.get_events().removeHandler(this.QHb,Na)}BNg(Na){this.addHandler("OnObjectButtonMouseOver",
Na)}gkj(Na){this.get_events().removeHandler("OnObjectButtonMouseOver",Na)}ANg(Na){this.addHandler("OnObjectButtonMouseOut",Na)}fkj(Na){this.get_events().removeHandler("OnObjectButtonMouseOut",Na)}T_d(Na){Na&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.Ph(this.WGa,Na):this.WGa.innerHTML=Na)}qZj(Na,ya,nb){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.HG(this.WGa):this.WGa.innerHTML="";Na?Na.lba(ya,16,16,this.WGa,16,16,void 0,nb):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}rZj(Na,ya){Na&&(this.GOb.innerText=Na);this.domElement.title=ya}dispose(){this.get_isInitialized()&&(this.hide(),this.Cc.AC(),ka.a.pc([this.OY,this.s_a]),mb.a.instance.Ba(y.a.click,this.domElement,this.fd),kb.a.instance.Ba(y.a.pointerDown,
this.domElement,this.pN),this.HSa&&this.HSa.dispose(),super.dispose())}Ecb(){this.R3b&&this.domElement.classList.remove(this.R3b);this.Mnc&&this.domElement.classList.add(this.Mnc)}PHb(){this.Mnc&&this.domElement.classList.remove(this.Mnc);this.R3b&&this.domElement.classList.add(this.R3b);this.z2a()}z2a(){this.Gjc&&(this.HSa.cancel(),this.Pbg(),this.setOpacity(1));this.set_visible(!0)}rp(Na,ya,nb,vb,gb=!1){Na=Ba.a(vb).ki(Na);ya=Ba.a(vb).ki(ya);Ba.a(vb).kyc(this.domElement);this.domElement.style.top=
va.HelperMethods.sc(ya);this.domElement.style.left=this.domElement.style.right="";ya=Na;gb&&(ya=Na-this.domElement.offsetWidth);na.c(this.domElement.style,nb,va.HelperMethods.sc(ya));this.set_visible(!0);this.setOpacity(1);this.Gjc&&(this.pVd=!1,this.gNj(),this.HSa.Xp())}hide(){this.Ecb();this.set_visible(!1);this.Gjc&&(this.Pbg(),this.HSa.cancel())}Q8b(){this.Cc.ka("mouseover",this.uN,!0);this.Cc.ka("mouseout",this.tN,!0)}gNj(){this.OY.Bi("mousemove")||this.OY.ka("mousemove",this.QQi)}Pbg(){this.OY.Bi("mousemove")&&
this.OY.detach("mousemove")}Bkd(Na){if(this.domElement.parentNode){var ya=Sys.UI.DomElement.getBounds(this.domElement);const nb=new Sys.UI.Point(Math.round(ya.x+ya.width),Math.round(ya.y+ya.height));ya=Math.abs(nb.x-Na.x);Na=Math.abs(nb.y-Na.y);Na=ya>Na?ya:Na;this.pVd?this.setOpacity(Oa.j0g(Na)):100>=Na&&this.qne()}}qne(){this.pVd=!0;this.HSa.cancel()}setOpacity(Na){z.a.setOpacity(this.domElement,Na);this.gpf=A.a.Ya.Ub}static j0g(Na){return 100>=Na?1:250<=Na?0:.01*(100-(Na-100)/150*100)}}Object(t.a)(Oa,
"OnObjectButton",H.a,[793,166,2]);var oa=a(804);const Ja=db.ayh;class Wb extends h.a{constructor(Na,ya,nb,vb,gb,cb,La,ja,Ua=""){super();this.oka=null;this.Ucf=!1;this.htmlSanitizationHelper=this.knc=this.lnc=null;this.buttons={};this.IQe={};this.$=Na;this.svgIconProvider=ya;this.iPi=nb;this.Bfc=vb;this.Afc=gb;this.altText=cb;this.QHb=La;this.htmlSanitizationHelper=ja;this.buttonText=Ua}get Zy(){return Ba.a(this.$).mGa(Ca.a.QWi)}get o3b(){return Ca.a.PWi}get buttonWidth(){return Ba.a(this.$).mGa(Ca.a.RWi)}dispose(){this.Nnh();
this.$=null;super.dispose()}getButton(Na,ya=!0){return this.Xua(Na,ya)}Xua(Na,ya=!0){const nb=Na.toString();nb in this.buttons||this.Zdh(Na,ya);return this.buttons[nb]}rp(Na,ya,nb,vb,gb=!0,cb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&yb.i(this.$.na)){var La=D.h(this.$).FR.domElement;const ja=Na+this.buttonWidth-La.scrollWidth;La=ya+this.buttonWidth-La.scrollHeight;Na=0<ja?Na-ja:Na;ya=0<La?ya-La:ya}this.Xua(vb,gb).rp(Na,ya,nb,this.$,cb)}hide(){const Na=this.buttons;for(let ya in Na)Na[ya].hide()}Q8b(Na,
ya){!this.Ucf&&(ya=this.buttons[ya.toString()])&&(this.lnc=(nb,vb)=>{Na(vb,!0)},ya.BNg(this.lnc),this.knc=(nb,vb)=>{Na(vb,!1)},ya.ANg(this.knc),this.Ucf=!0,ya.Q8b())}Zdh(Na,ya){this.oka=String.format(this.Bfc===I.a.H9b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ba.a.yg(this.Bfc),ba.a.yg(this.Afc),"{0}");var nb=String.format(this.oka,ba.a.yg(this.altText));ya=new Oa(""===this.buttonText?
db.Zxh:db.byh,""===this.buttonText?db.$xh:db.cyh,I.a.Or,nb,ya,this.QHb,this.buttonText,Ja,this.htmlSanitizationHelper);nb=(vb,gb)=>{this.iPi(gb,Na)};ya.f2(nb);this.buttons[Na.toString()]=ya;this.IQe[Na.toString()]=nb;nb=D.h(this.$).Rf(Na);nb.domElement.insertBefore(ya.domElement,nb.domElement.firstChild)}Nnh(){for(const Na of oa.a(this.buttons)){const ya=this.buttons[Na];ya.qda(this.IQe[Na]);ka.a.Ja(ya);delete this.buttons[Na];this.lnc&&ya.gkj(this.lnc);this.knc&&ya.fkj(this.knc)}}domElement(Na){return this.Xua(Na).domElement}z2a(Na){this.Xua(Na).z2a()}Fjg(Na,
ya){this.Bfc=Na;this.Afc=ya}$Pb(Na,ya,nb=!0){this.oka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ba.a.yg(this.Bfc),ba.a.yg(this.Afc),"{0}");Na=String.format(this.oka,ba.a.yg(Na));this.Xua(ya,nb).T_d(Na)}gUa(Na,ya,nb){this.Xua(nb,!1).rZj(Na,ya)}Djg(){this.oka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",ba.a.yg(this.Afc),"{1}");const Na=String.format(this.oka,void 0,
ba.a.yg(void 0));this.Xua(void 0,!1).T_d(Na)}Ejg(Na,ya,nb){this.Xua(nb,!1).qZj(this.svgIconProvider,Na,ya)}}Object(t.a)(Wb,"OnObjectLaunchButton",h.a,[784,2]);h=a(96);class nc extends h.a{constructor(Na,ya){super(Na);this.wDb=null;this.xnh=()=>{this.display()};this.Mei=Math.max(1,ya)}dispose(){ka.a.Ja(this.wDb);this.wDb=null;super.dispose()}XSa(){ka.a.Ja(this.wDb);this.wDb=l.a.instance.create(this.xnh,this.Mei,v.a.MAi)}cTa(){ka.a.Ja(this.wDb);this.hide()}}Object(t.a)(nc,"LoadingIndicatorBehavior",
h.a,[737,2]);class Yb extends nc{constructor(Na,ya,nb,vb){super(Na,ya);this.vDb=null;this.Bvg=nb;this.Ybi=vb;this.oJg()}dispose(){this.vDb=null;super.dispose()}display(){this.Bvg(this.vDb)}hide(){this.Ybi(this.vDb)}oJg(){this.vDb=document.createElement("div");this.domElement.appendChild(this.vDb)}}Object(t.a)(Yb,"ShimmerLoadingIndicatorBehavior",nc,[]);var pb=a(72),Fa=a(51),ab=a(12);class Gb extends nc{constructor(Na,ya,nb,vb=null,gb=null,cb=0){super(Na,ya);this.ewa=this.SNa=null;this.ewa=nb;this.Gfc=
vb||Fa.a.current.lo(103);this.Zqf=cb;this.a7c=gb;this.nJg()}dispose(){this.SNa=null;super.dispose()}display(){ab.DOMElementExtensions.setVisible(this.SNa,!0)}hide(){ab.DOMElementExtensions.setVisible(this.SNa,!1)}nJg(){this.SNa=document.createElement("div");this.SNa.classList.add(pb.a.Kwh);const Na=document.createElement("div");Na.classList.add(pb.a.Lwh);this.a7c&&""!=this.a7c&&Na.classList.add(this.a7c);var ya=0===this.Zqf?"":G.a.instance.ga(this.Zqf);const nb=String.format('<div class="'+pb.a.Mwh+
'">{0}</div>',ya);this.Gfc?(ya=`<img src="${this.Gfc}" alt="${ya}" title="${ya}"/>`,this.ewa?this.ewa.Ph(Na,ya+nb):Na.innerHTML=ya+nb):this.ewa?this.ewa.Ph(Na,nb):Na.innerHTML=nb;this.SNa.appendChild(Na);this.domElement.appendChild(this.SNa)}}Object(t.a)(Gb,"SpinnerLoadingIndicatorBehavior",nc,[]);class Ga{constructor(Na){this.ewa=Na}Z5c(Na,ya,nb){return new sa.a(Na,ya,nb)}O5b(Na,ya,nb,vb,gb,cb,La,ja,Ua,lb){return new Ea.a(Na,ya,nb,vb,gb,cb,La,ja,Ua,lb)}Gsb(Na,ya,nb,vb,gb=0){return new Gb(Na,ya,this.ewa,
nb,vb,gb)}Khd(Na){return Na.da.Aa(238)||new M(Na)}R5b(Na,ya,nb,vb,gb,cb,La,ja=""){return new Wb(Na,ya,nb,vb,gb,cb,La,this.ewa,ja)}A5c(Na,ya){return new Da(Na,ya)}Sch(Na,ya,nb,vb){return new ea(Na,ya,nb,vb)}f5c(Na,ya,nb,vb){return new u(Na,ya,nb,vb)}}Object(t.a)(Ga,"SharedUIControlsFactory",null,[694]);var Ma=a(50);class Qa extends b.a{constructor(Na){super();this.$=Na;this.Db()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const Na=
Ma.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);m.TaskExtensions.za(Na,()=>{e.EwaSettings.cl()?this.nb(this.$.da.Aa(12)||new Ga(Na.result)):this.nb(new Ga(Na.result))},this.la,3)}else e.EwaSettings.cl()?this.nb(this.$.da.Aa(12)||new Ga(null)):this.nb(new Ga(null))}static ka(Na){Na.da.Ha(477,new Qa(Na))}}Object(t.a)(Qa,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(F,"a",function(){return wb});const wb=()=>{c.a.Fa(Qa.ka)}},1191:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(50),f=a(37),
d=a(1),h=a(825);class m extends b.a{constructor(V){super();this.$=V;this.Db()}create(){const V=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa),za=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([V,za],this.la),()=>{this.nb(this.$.da.Aa(296)||this.$.da.Ha(296,new h.BorderFormatManager(this.$,V.result,za.result)))},this.la,3)}static ka(V){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&V.da.Ha(468,
new m(V))}}Object(t.a)(m,"BorderFormatManagerFactory",b.a,[]);var l=a(709),v=a(15),r=a(268),A=a(174),x=a(841),n=a(27),u=a(40),z=a(30),w=a(97),C=a(265),y=a(356),B=a(353),H=a(99),I=a(191),R=a(8),S;(function(V){V[V.insert=1]="insert";V[V.delete=2]="delete";V[V.rows=4]="rows";V[V.columns=8]="columns";V[V.cellsShiftHorizontal=16]="cellsShiftHorizontal";V[V.cellsShiftVertical=32]="cellsShiftVertical";V[V.insertRows=5]="insertRows";V[V.insertColumns=9]="insertColumns";V[V.insertCellsShiftRight=17]="insertCellsShiftRight";
V[V.insertCellsShiftDown=33]="insertCellsShiftDown";V[V.deleteRows=6]="deleteRows";V[V.deleteColumns=10]="deleteColumns";V[V.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";V[V.deleteCellsShiftUp=34]="deleteCellsShiftUp";V[V.insertRowsBelow=37]="insertRowsBelow"})(S||(S={}));Object(t.b)("InsertDeleteCellFlags",S);var G=a(5),D=a(426),E=a(65),M=a(68);class L{constructor(V){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=V}}Object(t.a)(L,"MacroRecorderRangeInsertedOrDeletedPayload",
null,[122]);var N=a(1100),Y=a(41),U=a(374),P=a(192),aa=a(60),X=a(284),Z=a(140),da=a(460),qa=a(117),O=a(51),ca=a(205),wa=a(94),ia=a(35),Ha=a(29),Sa=a(250),Da=a(261),ea=a(11),sa=a(188),Ea=a(22),ba=a(282);class ka{constructor(V,za,Ra,Xa,$a=0){this.Jwg=V;this.Kwg=za;this.zEg=Ra;this.VXb=Xa;this.mJh=$a}get SJa(){return this.Jwg}get formattedText(){return this.Kwg}get style(){return this.zEg}get size(){return this.VXb}get gZ(){return this.mJh}static PYg(V,za){return new ka(V,za,null,null,null)}static $_c(V,
za){return new ka(V,null,za,null,null)}static QYg(V,za){return new ka(V,null,null,za,null)}static OYg(V,za,Ra){return new ka(V,null,za,null,Ra)}}Object(t.a)(ka,"CachedPreviewCellGroup",null,[]);var Ca=a(84);b=a(285);var db=a(101),yb=a(13);class kb extends b.a{constructor(V,za,Ra){super(V);this.el=null;this.r8c=0;this.Lii=(Xa,$a)=>{if(0===Xa)v.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Xa={};var ma="",fa=1035996630;switch($a.selectedKey){case 0:ma=
1896159024===this.vr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:ma=1896159024===this.vr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.vr?(ma="InsertRows",fa=-1113896058):(ma="DeleteRows",fa=1554436520);break;case 3:1896159024===this.vr?(ma="InsertColumns",fa=1415868706):(ma="DeleteColumns",fa=674605324)}v.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${ma}`);
$a=new wa.a(fa,1,2,8,null);Xa[M.a.Kc]=ma;this.$.Ia.Hb($a,Xa)}};this.vr=za;this.selectedRanges=Ra;this.isRtl=Object(Ca.a)(db.a,this.$.va.na).displayRtl}get kc(){return"InsertDeleteCellsDialog"}ig(){1896159024===this.vr?(this.el=yb.a.instance.ga(23),this.r8c=0):(this.el=yb.a.instance.ga(22),this.r8c=1);const V=this.selectedRanges[0].TZ&&!this.selectedRanges[0].c5?0:1;this.Ob=1;this.initializeAndShow(this.el,this.Lii,{[kb.it]:this.kc,["dialogToDisplay"]:this.r8c,["defaultSelectedKey"]:V,["isRtl"]:this.isRtl})}}
Object(t.a)(kb,"InsertDeleteCellsDialog",b.a,[]);const mb=(V,za,Ra,Xa,$a,ma,fa=null)=>{fa=V.Na(41,fa);fa.insertDeleteMultiRangeParameters=za;return aa.g(V,"InsertDeleteCells",fa,Ra,Xa,$a,ma,0)};class W{constructor(V,za,Ra,Xa){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=V;this.targetSheetRange=za;this.fillRangeType=Ra;this.fillRangeDirection=Xa}}Object(t.a)(W,"MacroRecorderRangeFilledPayload",null,[122]);var Q=a(7),va=a(24);class na{constructor(){this.dRa=
this.QGa=this.INa=this.LTa=0}}Object(t.a)(na,"RangeBorders",null,[]);class Ba{constructor(){this.scenario=0;this.ZP=null}}Object(t.a)(Ba,"ScenarioInfo",null,[]);var Oa=a(928),oa=a(21),Ja=a(267),Wb=a(214),nc=a(80),Yb=a(61);class pb{constructor(V,za){this.$=V;this.Lh=za;this.rx=new Oa.a(oa.h(this.$).Ca,this.$);this.kAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.qrd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.ric=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.ejf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.lni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.lnf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.ajc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.dBb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.sic=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Jqi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.tni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Vgf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.bjf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.ari=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.vwi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}sni(V,za){return!(void 0===za||null===za)&&!!(za.scenario&16384)&&!this.uni(V,za)&&this.Ogf(za,V)}C4e(){var V=u.a.Ud(),za=oa.h(this.$),Ra=za.ha.qa.selectedRanges;let Xa=0;var $a=
0,ma=Ra.length;const fa=new Ba;if(1<ma)return fa.scenario=4,fa;if(this.bjf&&(ma=za.Mj("MergeCell"),Object(Yb.a)(ma),ma.value.nBb(Ra[0])))return fa.scenario=262144,fa;this.qrd&&oa.h(this.$).rtl&&(Xa|=65536);if(!za.YM(Ra[0]))if(this.kAb)Xa|=32;else return fa.scenario=32,fa;if(za=za.Ca.jva(Ra[0],this.$.activeItemName)){fa.v_c=za;for(var eb of za)if($a+=1,1<$a){this.kAb?(Xa|=256,fa.scenario=Xa):fa.scenario=256;if(!this.dBb)return fa;break}}$a=oa.h(this.$).Ca.lja(Ra[0]);if(!$a)return fa.scenario=32768,
fa;eb=$a.length;Ra=Ra[0];za=Ra.bottom-Ra.top+1;ma=Ra.right-Ra.left+1;const ua=new na;for(let xa=0;xa<eb;xa++)if(this.K0h($a[xa],Ra,ua),Xa=Xa|(void 0!==$a[xa].text&&null!==$a[xa].text&&""!==$a[xa].text?1:0)|($a[xa].XA?2:0)|($a[xa].Yja?8:0)|($a[xa].pyb?16:0)|($a[xa].OA?64:0)|($a[xa].JM?128:0),void 0!==$a[xa].text&&null!==$a[xa].text&&""!==$a[xa].text||$a[xa].Yja)if(void 0===fa.ZP||null===fa.ZP)fa.ZP=oa.h(this.$).Qb($a[xa].getRange());else{if($a[xa].getRange().top<fa.ZP.range.top||$a[xa].getRange().top==
fa.ZP.range.top&&$a[xa].getRange().left<fa.ZP.range.left)fa.ZP=oa.h(this.$).Qb($a[xa].getRange());Xa|=16384}ua.LTa===ma&&(Xa|=512);ua.QGa===ma&&(Xa|=2048);ua.INa===za&&(Xa|=4096);ua.dRa===za&&(Xa|=1024);if(0<ua.LTa&&ua.LTa<ma||0<ua.QGa&&ua.QGa<ma||0<ua.INa&&ua.INa<za||0<ua.dRa&&ua.dRa<za)Xa|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Ra.right!==Ra.maxColumns&&Ra.bottom!==Ra.maxRows||(Xa|=131072);V=u.a.Ud()-V;v.ULS.sendTraceTag(537159424,0,50,
`Execution time of GetMergeCellScenario is : ${V}`);fa.scenario=Xa;return fa}Dvf(V,za){const Ra=V.command;if(void 0===za||null===za)za=this.C4e();if(!this.Ogf(za,Ra))return!1;V=oa.h(this.$).ha.qa.selectedRanges;var Xa=oa.h(this.$).Ca.lja(V[0]);if(!Xa)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Xa.length&&!Xa[0].XA)return-167499203===Ra?(Xa[0].m0(2,!0),!0):!1;Xa=oa.h(this.$).ha.qa.es;const $a=this.$.na.sheetName;let ma=!0;switch(Ra){case -167499203:2===
(za.scenario&2)&&this.ric?this.Mhg(za.scenario,V,Ra):ma=this.MHi(za,V);break;case 1097660126:(za=this.Evf(za,V))&&0!=za.length||(ma=!1);break;case 155820588:this.Mhg(za.scenario,V,Ra);break;default:return!1}oa.h(this.$).e4(V,Xa,$a,null,V[0],null,null,0,"MergeCellCommandAction");return this.dBb?ma:!0}Ogf(V,za){const Ra=this.cmi(V,za);if(!this.ejf)return Ra;const Xa=oa.h(this.$).ha.qa.selectedRanges[0].NC(!1);v.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${za.toString()}; Scenario Number: ${V.scenario}; IsCSEPossible result: ${Ra}; Range: ${Xa}`);
return Ra}cmi(V,za){if(-255094134===za)return!1;var Ra=V.scenario;if(this.bjf&&262144===Ra||this.qrd&&65536===(Ra&65536))return!1;if(this.knf(za,V))return Ra=oa.h(this.$).ha.qa.selectedRanges,0===Ra.length?!1:this.Bvi(za,V,Ra[0]);this.kAb&&32===(Ra&32)&&(Ra&=-33);if(256==(Ra&256))if(this.$qi(V))Ra&=-257;else return!1;return 32768===Ra||4===Ra||128===(Ra&128)||!this.kAb&&32===Ra?!1:-167499203!=za&&1097660126!==za||!this.hpd(V)?void 0!==V.ZP&&null!==V.ZP&&V.ZP.lS?!1:0===Ra?!0:16384===(Ra&16384)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",
!1):1!==(Ra&1)&&8!==(Ra&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.sic}ioi(V){return 131072===(V.scenario&131072)?!0:!1}$qi(V){if(!this.dBb)return!1;let za="Multi block",Ra=!0;this.hpd(V)&&(za+=" with border",Ra=!1);this.ioi(V)&&(Ra=!1,za+=" with entire row or column selected",16384===(V.scenario&16384)&&(za+=" and a data loss scenario"));Ra||v.ULS.sendTraceTag(523511383,0,50,`CSE for ${za}, is not enabled`);return Ra}hpd(V){return 16===
(V.scenario&16)||this.ald(V.scenario)||this.uld(V.scenario)||this.lld(V.scenario)||this.wld(V.scenario)||8192===(V.scenario&8192)?!0:!1}uni(V,za){return this.tni?this.knf(V,za):155820588===V}knf(V,za){return 155820588===V||(-167499203===V||1097660126===V)&&2===(za.scenario&2)&&this.ric?!0:!1}Avi(V){return this.wld(V.scenario)||this.lld(V.scenario)||this.ald(V.scenario)||this.uld(V.scenario)?!0:!1}Xai(V){V=oa.h(this.$).Ca.lja(V);if(!V||0===V.length)return!1;for(let za=0;za<V.length;za++)if(V[za].XA&&
V[za].lS)return!0;return!1}Bvi(V,za,Ra){if(1097660126===V&&2===(za.scenario&2))return!1;if(this.vwi){if(this.Xai(Ra))return!1}else if(this.lni&&void 0!==za.ZP&&null!==za.ZP&&za.ZP.lS)return!1;this.kAb&&32===(za.scenario&32)&&(za.scenario&=-33);return 32768===za.scenario||4===za.scenario||256===(za.scenario&256)&&this.Jqi||128===(za.scenario&128)?!1:2===(za.scenario&2)?this.Avi(za)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1):!1}K0h(V,za,Ra){const Xa=V.getRange();if(Xa.top===za.top)if(V.qLa)Ra.LTa+=Xa.right-Xa.left+1;else{var $a=this.rx.eQ(Xa,0);if($a)for(const fa of $a)fa.Qva&&(Ra.LTa+=fa.getRange().right-fa.getRange().left+1)}if(Xa.left===za.left)if(V.oLa)Ra.INa+=Xa.bottom-Xa.top+1;else if($a=this.rx.eQ(Xa,2))for(var ma of $a)ma.Uva&&(Ra.INa+=ma.getRange().bottom-ma.getRange().top+1);if(Xa.bottom===za.bottom)if(V.Qva)Ra.QGa+=Xa.right-Xa.left+1;else if(ma=this.rx.eQ(Xa,1))for(const fa of ma)fa.qLa&&(Ra.QGa+=fa.getRange().right-
fa.getRange().left+1);if(Xa.right===za.right)if(V.Uva)Ra.dRa+=Xa.bottom-Xa.top+1;else if(V=this.rx.eQ(Xa,3))for(const fa of V)fa.oLa&&(Ra.dRa+=fa.getRange().bottom-fa.getRange().top+1)}lhj(V,za){for(let Ra of za.v_c){za=V.De(Ra.Je);za=oa.h(this.$).Ca.lja(za);const Xa=za.length;for(let $a=1;$a<Xa;$a++){const ma=oa.h(this.$).Qb(za[$a].getRange());this.sic?ma.cell.deleteCellFromModel():(ma.frb(),ma.clearFormat(),ma.cell.mhj());ma.oJb(!0)}}}P1j(V,za){V.backgroundColor=za.backgroundColor;V.color=za.color}apg(V,
za){return{SpansBlocks:!0,OriginRow:V,OriginColumn:za,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}ZHg(V,za,Ra,Xa,$a){Ra=V.De(Ra.Je);if(!Ra)return v.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var ma=new va.Range(V.top,V.left,Ra.top,Ra.left,!1,!1);let fa;Ra.top==V.top?fa=0:(ma.bottom=Ra.top-1,fa=za.gid(ma));Ra.left==V.left?
ma=0:(ma.right=Ra.left-1,ma=za.hid(ma));za=this.apg(V.top-1,V.left-1);za.OriginDeltaY=fa;za.OriginDeltaX=ma;za.Rows=Ra.bottom-Ra.top;za.Columns=Ra.right-Ra.left;za.Height=$a;za.Width=Xa;Ra.top==V.top&&Ra.left==V.left&&(za.IsOrigin=!0);V=oa.h(this.$).Qb(Ra.topLeft);V.cell.s5f(za);return V}RRd(V,za){let Ra=[];const Xa=oa.h(this.$).Mj("MergeCell");if(!Object(Yb.c)(Xa))return Ra;const $a=Xa.value.gid(V),ma=Xa.value.hid(V);if(za.v_c)for(const fa of za.v_c)if(za=this.ZHg(V,Xa.value,fa,ma,$a))Ra.push(za);
else{Ra=[];break}return Ra}N1h(V,za,Ra,Xa){var $a=Ra.bottom-Ra.top,ma=Ra.right-Ra.left;let fa=[];const eb=Xa.scenario;if(256===(eb&256)){if(fa=this.RRd(Ra,Xa),!fa||0==fa.length)return fa}else za.cell.RRd($a,ma),fa.push(za);$a=this.D2(this.w4(za),!0,0,eb,"merge");if(void 0!==V&&null!==V)for(const ua of fa){ma=V.cell.formattedText;const xa=Object(Q.a)(new Ja.a,{TextRuns:ma.TextRuns,Fonts:ma.Fonts});xa.Text=void 0!==V.cell.originalText&&null!==V.cell.originalText?V.cell.originalText:void 0!==V.cell.userInput&&
null!==V.cell.userInput?V.cell.userInput:ma.Text;$a=this.D2(this.w4(ua),$a,1,eb,"merge");this.Lh.ySa(ua,xa,!1,!0,"MergeCells",1);$a=this.D2(this.w4(ua),$a,2,eb,"merge");this.qrd?ua.prb(V):this.P1j(ua,V);$a=this.D2(this.w4(ua),$a,3,eb,"merge");ua.cell.cah(V.cell);$a=this.D2(this.w4(ua),$a,4,eb,"merge");ua.cell.qEc(!1);$a=this.D2(this.w4(ua),$a,6,eb,"merge")}this.lhj(Ra,Xa);this.D2(this.w4(za),$a,5,eb,"merge");return fa}lld(V){return 4096===(V&4096)}wld(V){return 512===(V&512)}ald(V){return 2048===
(V&2048)}uld(V){return 1024===(V&1024)}ubc(V,za){let Ra=null;for(let Xa=0;Xa<V.length;Xa++)if(V[Xa].BorderPosition===za){Ra=V[Xa];break}return Ra}OXh(V,za){this.ajc?(za=this.ubc(za.cell.AM().Borders,2))&&V.push(za):(za=za.cell.AM().Borders,1<za.length&&(za=[za[1]]),V=[...za,...V]);return V}d5h(V,za){this.ajc?(za=this.ubc(za.cell.AM().Borders,0))&&V.push(za):(za=za.cell.AM().Borders,1<za.length&&(za=[za[0]]),V=[...za,...V]);return V}FPh(V,za){za=this.rx.eQ(za.cell.getRange(),1);if(!za||0===za.length)return V;
if(this.ajc){if(za=za[0].AM().Borders,za=this.ubc(za,0))za.BorderPosition=1,V.push(za)}else{let Ra=[];0<za.length&&(Ra=za[0].AM().Borders);Ra[0].BorderPosition=1;V=[...Ra,...V]}return V}X1h(V,za){za=this.rx.eQ(za.cell.getRange(),3);if(!za||0===za.length)return V;if(this.ajc){if(za=za[0].AM().Borders,za=this.ubc(za,2))za.BorderPosition=3,V.push(za)}else{let Ra=[];0<za.length&&(Ra=za[0].AM().Borders);Ra[0].BorderPosition=3;V=[...Ra,...V]}return V}L0h(V,za,Ra){this.lld(V.scenario)&&(za=this.OXh(za,Ra));
this.wld(V.scenario)&&(za=this.d5h(za,Ra));this.ald(V.scenario)&&(za=this.FPh(za,Ra));this.uld(V.scenario)&&(za=this.X1h(za,Ra));return za}iZ(V){if(0===V.length)return null;let za=[0,0,0,0],Ra=[1,1,1,1],Xa=0;V.forEach(function(ma){let fa=ma.BorderPosition;Ra[fa]=ma.BorderLineStyle;let eb=new Wb.a(ma.Color.Red,ma.Color.Green,ma.Color.Blue);za[fa]=eb.YR();Xa|=ea.HelperMethods.$3a(ma.BorderPosition)});V={};V.LineStyle=Ra;V.Color=za;let $a={};$a.BorderFormat=V;$a.Border=Xa;return $a}L3d(V,za,Ra=null){let Xa=
[];Xa=null!==Ra?[...Ra]:this.L0h(za,Xa,V);if(za=this.iZ(Xa))V.cell.Ybb(V.cell.getRange()),this.rx.nJb(V.cell.getRange()),this.Lh.Xda(oa.h(this.$),-1690267012,za,!1,null,[V.cell.getRange()])}msi(V){return 512===(V.scenario&512)||4096===(V.scenario&4096)||1024===(V.scenario&1024)||2048===(V.scenario&2048)?!0:!1}e5h(V){V=this.rx.eQ(V.cell.getRange(),1);return V&&0!==V.length?V[0].qLa?(V=V[0].AM().Borders[0],V.BorderPosition=1,V):null:null}f5h(V){V=this.rx.eQ(V.cell.getRange(),3);return V&&0!==V.length?
V[0].oLa?(V=V[0].AM().Borders[0],V.BorderPosition=3,V):null:null}K9h(V,za,Ra,Xa,$a){za.cell.Qjg();if(this.msi(V))this.L3d(za,V);else{const ma=8192===(V.scenario&8192),fa=za.cell.getRange();ma&&this.Vgf?(za.cell.Ybb(),this.rx.nJb(fa)):$a?($a=[],null!==Ra&&$a.push(Ra),null!==Xa&&$a.push(Xa),0<$a.length?this.L3d(za,V,$a):(za.cell.Ybb(),this.rx.nJb(fa))):ma&&!this.Vgf&&(za.cell.Ybb(),this.rx.nJb(fa))}}iXh(V,za){return null===V||void 0===V?!0:V.cell.getRange().top===za.topLeft.top&&V.cell.getRange().left===
za.topLeft.left&&V.cell.getRange().bottom===za.topLeft.bottom&&V.cell.getRange().right===za.topLeft.right?!0:!1}MHi(V,za){za=this.Evf(V,za);if(this.dBb&&(!za||0==za.length))return!1;for(let Ra=0;Ra<za.length;Ra++)za[Ra].m0(2,!0),this.D2(this.w4(za[Ra]),!0,8,V.scenario,"merge");return!0}m0j(V){const za=oa.h(this.$).Ca.jva(V,this.$.activeItemName);if(za&&nc.Ct(za))for(let Ra of za)Ra.s0d(V,!0)}Evf(V,za){const Ra=V.ZP,Xa=oa.h(this.$).Qb(za[0]);let $a=null,ma=null;this.sic&&($a=this.e5h(Xa),ma=this.f5h(Xa));
const fa=this.N1h(Ra,Xa,za[0],V);if(this.dBb&&(!fa||0==fa.length))return fa;this.ari?this.m0j(za[0]):oa.h(this.$).Ca.Z9(za[0],this.$.activeItemName).s0d(za[0],!0);this.D2(this.w4(Xa),!0,9,V.scenario,"merge");if(this.sic&&this.hpd(V)){za=this.iXh(Ra,za[0]);for(const eb of fa)this.K9h(V,eb,$a,ma,za)}return fa}dSg(V,za,Ra){if(!(1>V.Borders.length)){var Xa=this.iZ(V.Borders);Ra.forEach($a=>{$a=oa.h(this.$).Qb($a.getRange());this.Lh.Q9f(-1690267012,$a,Xa,!1,null,!1,za)})}}IXj(V,za,Ra){const Xa=V.length;
for(let ma=0;ma<Xa;ma++){V[ma].cell.qEc();const fa=V[ma].cell.getRange(),eb=oa.h(this.$).Ca.lja(fa),ua=eb.length;if(-167499203===za&&this.ric){var $a=0;2===V[ma].cell.KJd||1===V[ma].cell.mC?$a=3:2===V[ma].cell.mC&&($a=1);V[ma].m0($a,!1)}for($a=1;$a<ua;$a++)eb[$a].attachCellToModel(),eb[$a].prb(V[ma]),-167499203===za&&this.ric&&eb[$a].m0(null,!1);this.lnf&&Ra&&this.dSg(Ra[ma],fa,eb)}}V_e(V,za){let Ra=null;for(let Xa=0;Xa<V.length;Xa++)if(V[Xa].BorderPosition===za){Ra=V[Xa];break}return Ra}EPh(V,za){let Ra=
V.cell.AM();V.Qva()&&V.cell.wQa(1);V.Uva()&&V.cell.wQa(3);if((V=this.rx.eQ(za,0))&&V[0].Qva){var Xa=V[0].AM().Borders;Xa=this.V_e(Xa,1);Xa.BorderPosition=0;Ra.Borders.push(Xa);V.forEach($a=>{$a.wQa(1)})}(za=this.rx.eQ(za,2))&&za[0].Uva&&(V=za[0].AM().Borders,V=this.V_e(V,3),V.BorderPosition=2,Ra.Borders.push(V),za.forEach($a=>{$a.wQa(3)}));return Ra}Mhg(V,za,Ra){var Xa=oa.h(this.$).Ca.kva(za[0],this.$.activeItemName);const $a=oa.h(this.$).Ca.Z9(za[0],this.$.activeItemName),ma=[];if(void 0!==Xa&&null!==
Xa&&(za=oa.h(this.$).xja(za[0],Xa),void 0!==za&&null!==za)){za=za.$$ge();for(Xa=[];za.$$mn();){var fa=za.$$cu();if(fa.sH){ma.push(fa);this.D2(this.w4(fa),!0,10,V,"unmerge");fa.cell.O4g();const eb=fa.cell.getRange();this.D2(this.w4(fa),!1,11,V,"unmerge");$a.s0d(eb,!1);this.lnf&&(fa=this.EPh(fa,eb),Xa.push(fa))}}0<ma.length&&($a.lf.resetCellLookup(),this.IXj(ma,Ra,Xa))}}D2(V,za,Ra,Xa,$a){if(!this.ejf)return!1;V!==za&&v.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Ra}; Scenario: ${Xa}; Command: ${$a}; Expected: ${za?
"populated":"empty"}; Actual: ${V?"populated":"empty"}`);return V}w4(V){return!!V.cell.cell.Merge}}Object(t.a)(pb,"MergeCellCommandAction",null,[]);var Fa=a(66),ab=a(177),Gb=a(45),Ga=a(381),Ma=a(290),Qa=a(52),wb=a(73),Na=a(55),ya=a(1108),nb=a(33),vb=a(345),gb=a(145),cb=a(216),La=a(4),ja=a(379);class Ua{constructor(V,za,Ra,Xa,$a,ma,fa){this.$=V;this.gridView=za;this.Lh=Ra;this.pB=Xa;this.borderFormatManager=$a;this.moreColorsHelper=ma;this.fontDropdownHelper=fa;this.iC=null;this.K_a=1461300262;this.h5b=
this.ix=this.H_a=this.u9a=this.Dac=null;this.VUi=(eb,ua,xa)=>{const tb=!!eb&&!!eb.RequestTelemetryData;!Sa.a(eb)&&ua&&oa.h(this.$).vh.zla(ua,eb.StateId,tb?eb.RequestTelemetryData.EcsOperationDuration:0,tb?eb.RequestTelemetryData.EcsRequestDuration:0,tb?eb.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){ua=1;if(33===xa||17===xa||9===xa||5===xa||37===xa)ua=0;this.F0(ua,eb)}};this.FRi=
eb=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.F0(3,eb)};this.jrb=()=>{this.gridView.Q6a&&(this.copyPasteInfrastructure&&this.copyPasteInfrastructure.skj(this.jrb),this.gridView.Q6a=!1,this.gridView.Gg.qp(G.a.LU),this.gridView.ha.S_(this.Edd),oa.h(this.$).$.qf())};this.Edd=()=>{var eb=this.Dac;this.Dac=E.d(this.$.va.na);eb===this.Dac&&(this.gridView.ha.S_(this.Edd),this.copyPasteInfrastructure&&this.copyPasteInfrastructure.L0c(36,
oa.h(this.$).ha.qa.selectedRanges)?(eb=new wa.a(1804571062,2,2,0,null),this.$.Ia.Hb(eb,{[G.a.skipClipboardAccess]:!0,[G.a.i2c]:!0,[G.a.isFormatPainter]:!0}).continueWith(()=>{this.jrb()})):this.gridView.Gg.dM(!1))};this.uc=()=>{this.WG&&0!==this.WG.Umc&&v.ULS.sendTraceTag(509690145,0,20,`GridCommandHandler::onWorkbookClosing: Font Usage Telemetry - {"newFontCount":${this.WG.zAd},"oldFontCount":${this.WG.RBd},"setFontCount":${this.WG.zRd},"hoverFontCount":${this.WG.wmd},"menuOpenCount":${this.WG.Umc}}`)};
this.vb=d.EwaSettings.vb();this.mergeCellCommandAction=new pb(this.$,Ra);this.WC=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Rl=d.EwaSettings.Rl();this.jl=nb.a.jl();this.VA=nb.a.VA(this.$);if(this.Phc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:7376562_TelemetryForFontUsage"))this.WG={zAd:0,RBd:0,zRd:0,wmd:0,Umc:0},this.$.nj(this.uc)}get bmf(){return r.a.all(this.gridView.ha.qa.selectedRanges,V=>V.isRow)}get Zlf(){return r.a.all(this.gridView.ha.qa.selectedRanges,
V=>V.Rg)}get themesManager(){this.ix||(this.ix=this.$.da.Aa(422));return this.ix}F0(V,za){const Ra=this.$.da.Aa(465);Ra&&Ra.F0(V,za)}$pi(V){return 1896159024===V||-1554384558===V||-1113896058===V||1554436520===V||1415868706===V||674605324===V||1035996630===V}hvi(V){return 524773427===V||-1649235364===V||1886217042===V||928057943===V}Hc(V,za){const Ra=oa.h(this.$);return 2054778433===za&&V&1?!da.a(this.$).djc:600686207===za?!1:this.$pi(za)&&r.a.any(this.gridView.ha.qa.selectedRanges,Xa=>Xa.Rg||Xa.isRow)&&
!this.bmf&&!this.Zlf?!0:d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1)&&this.hvi(za)?Ra.wb.rjf(Ra.ha.qa.activeCell):this.Djc(V,za)}executeCommand(V,za,Ra){return this.Hb(za,Ra)}wc(V,za,Ra){if(V=1===V)switch(za.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:V=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:V=
!!Ra;break;case 862825906:case 1532790410:case 46555851:case -1522760979:V=!0;break;default:V=!1}return V}Mc(V,za,Ra){switch(za){case "PopulateFontColor":Ra.MenuItems=this.pB.Fbc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Ra.MenuId);break;case "PopulateFillColor":Ra.MenuItems=this.pB.Fbc(1650812936,null,87208751,454361567,673562736,1457172838,-446735083,1532790410,Ra.MenuId);break;case "PopulateBorderColor":Ra.MenuItems=this.pB.Fbc(-236759591,-1803452024,void 0,void 0,
void 0,void 0,void 0,46555851,Ra.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.e$h(Ra);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.jl&&(this.fontDropdownHelper.Czj(Ra.MenuId),!this.fontDropdownHelper.Moi()))return!1;Ra.MenuItems=this.fontDropdownHelper.u_e(-1293291468,324978188,-1428968098,Ra.MenuId);this.Phc&&(this.WG.Umc+=1);break;default:return!1}return!0}Djc(V,za){const Ra=oa.h(this.$).ha.qa.selectedRanges;return!(new Z.a(this.$.va)).um(V,za,Ra,
this.gridView)}Hb(V,za){var Ra=this.gridView;const Xa=V.command;var $a=f.TaskExtensions.Tj();let ma=!0;switch(Xa){case -1077965542:ma=this.w$e(za,V,!1);break;case 909774670:this.tqb(Xa);ma=this.w$e(za,V,!0);break;case -1293291468:ma=this.u$e(za,V,!1);break;case 324978188:this.tqb(Xa);ma=this.u$e(za,V,!0);break;case 862890474:case 963349338:ma=this.v9h(V);break;case -1832800737:ma=this.fec(Xa,za,!1,V);break;case 1970784898:ma=this.fec(Xa,za,!1,V);break;case -803000997:ma=this.fec(Xa,za,!1,V);break;
case -128950598:case 1688184685:this.tqb(Xa);ma=this.fec(Xa,za,!0,V);break;case 1597684571:ma=this.dyb(Xa,za,!1,V);break;case 87208751:za.Color="-1";za.IntColor=!0;ma=this.dyb(Xa,za,!1,V);break;case -446735083:this.tqb(Xa);za.Color="-1";za.IntColor=!0;ma=this.dyb(Xa,za,!0,V);break;case 1650812936:ma=this.dyb(Xa,za,!1,V);break;case 673562736:this.tqb(Xa);ma=this.dyb(Xa,za,!0,V);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.LZf(Xa);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:ma=
this.e9h(Xa,V);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:ma=this.k8h(Xa,V);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:ma=this.Z9h(Xa,V);break;case -1803452024:case -236759591:ma=this.kkd(Xa,za,V);break;case -2118943501:ma=this.borderFormatManager.v8h(za,V);break;case 1012765228:ma=this.borderFormatManager.v$h(za,V);break;case 1256700402:ma=this.borderFormatManager.okd(V);
break;case -1756763834:ma=this.borderFormatManager.pkd(V);break;case -1418159950:ma=this.borderFormatManager.h$e(V);break;case -1920201820:case -1942512156:ma=this.w9h(Xa,V);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:ma=this.borderFormatManager.S9e(za,V);this.jGh(za);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:ma=this.V9h(Xa,za,V);break;case -693675336:case 322710748:break;case 1696566924:ma=this.f9h(V);break;case -167499203:case -255094134:case 1097660126:case 155820588:$a=
this.handleMergeCellsCommand(this.gridView,V);break;case 1896159024:case -1554384558:za=this.gridView.ha.qa.selectedRanges;if(this.WEj(V.command))v.ULS.sendTraceTag(509694159,0,50,"Insert Copied Cells Keyboard Shortcut"),this.copyPasteInfrastructure.cff(null,V),$a=Na.Task.Ra(!0);else if(this.oGj(V,za))v.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new kb(this.$,Xa,za)).ig(),ma=!0;else if(r.a.any(za,fa=>this.gridView.wb.XM(fa))){Ra="";
$a=1461300262;const fa=-1554384558===Xa&&this.gridView.wb.nsi(za[0]);za=za[0].height>za[0].width&&!fa;switch(Xa){case 1896159024:Ra=za?"InsertColumnsTable":"InsertRowsTable";$a=za?622604322:942362098;break;case -1554384558:Ra=za?"DeleteColumnsTable":"DeleteRowsTable",$a=za?284490184:1405456548}za=ia.a.Zp(Ua.jod,Ra,1);new wa.a($a,1,2,6,null);$a=this.insertOrDeleteCells(za,V,!0)}else $a=this.insertOrDeleteCells(1896159024===Xa?1:2,V,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:$a=
this.insertOrDeleteCells(ia.a.Zp(Ua.jod,za[M.a.Kc],1),V,!0);this.VA&&(V=oa.h(this.$),cb.d(this.$,V.ha.qa.activeCell,Xa,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:$a=this.insertOrDeleteCells(ia.a.Zp(Ua.jod,za[M.a.Kc],1),V,!1);break;case 504848446:$a=Ra.startEdit(!1,1,za[G.a.event],void 0,void 0,!0);break;case 1504715724:if(oa.h(this.$).dz&&this.borderFormatManager.kU.YA)break;$a=Ra.startEdit(!0,0,za[G.a.event],void 0,void 0,!0);break;case 1872288872:this.jrb();
break;case 41465729:$a=this.fill(Ra.ha.qa.ld,null,0,1,V);break;case -1451655532:case 1972143101:$a=this.fillDownAbsoluteValueAndStartEdit(Ra,za[G.a.event],-1451655532===Xa);break;case -475861485:$a=this.fill(Ra.ha.qa.ld,null,Ra.rtl?1:2,1,V);break;case -978843926:$a=this.fill(Ra.ha.qa.ld,null,3,1,V);break;case 2098035706:$a=this.fill(Ra.ha.qa.ld,null,Ra.rtl?2:1,1,V);break;case -2142700828:$a=this.fill(Ra.ha.sourceRange,Ra.ha.qa.ld,Ua.L2e(Ra.ha.qa.ld,Ra.ha.sourceRange),2,V);break;case 1405660955:$a=
this.fill(Ra.ha.sourceRange,Ra.ha.qa.ld,Ua.L2e(Ra.ha.qa.ld,Ra.ha.sourceRange),4,V);break;case 1983983164:$a=this.fill(Ra.ha.qa.ld,null,0,0,V);break;case 478842689:(V=this.$.da.Aa(376))?(V.yaj(),ma=!0):v.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:ma=Ra.ha.Hb(null,Xa);break;case -208772570:this.Q9h();ma=!0;break;case -987339782:this.D8h();
ma=!0;break;case -1770246794:Ra.ha.E8h();ma=!0;break;case 748067091:case -381232414:this.H8h(Xa);ma=!0;break;case -1522760979:this.gridView.toggleFormulaView();ma=!0;break;case 886009118:$a=this.t9h();break;case 894341014:this.y9h();ma=!0;break;case 862825906:$a=this.L$e(1970784898,V);break;case 1532790410:$a=this.L$e(1650812936,V);break;case 46555851:$a=this.M9h(V);break;default:ma=!1}ma||($a=sa.a(Xa));return $a}jGh(V){d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")?["OutsideBorders",
"AllBorders","ThickOutsideBorders"].includes(null===V||void 0===V?void 0:V.MenuItemId)&&(La.AFrameworkApplication.Sp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Lxe(new vb.a(this.gridView.ha.qa.activeRange,E.d(this.$.va.na)))):V&&V.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(V.MenuItemId)&&
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Lxe(new vb.a(this.gridView.ha.qa.activeRange,E.d(this.$.va.na)))}Lxe(V){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),za=>{void za.result.JCc(V,"BorderActions")},this.$.la,3)}get copyPasteInfrastructure(){var V;null!==(V=this.h5b)&&void 0!==V?V:this.h5b=this.$.da.Aa(254,!0);this.h5b||v.ULS.sendTraceTag(509682657,0,50,"CopyPasteInfrastructure is null");return this.h5b}WEj(V){var za;
return 1896159024===V&&(null===(za=this.copyPasteInfrastructure)||void 0===za?void 0:za.jNe())&&ja.a.Dxi}oGj(V,za){const Ra=r.a.all(za,ma=>!this.gridView.wb.XM(ma)),Xa=1<za.length&&!!this.gridView.wb.djd(za),$a=r.a.all(za,ma=>!this.gridView.wb.U4(ma));za=!r.a.any(za,ma=>ma.isRow||ma.Rg);return 1===V.method&&6===V.We&&(Ra||Xa)&&$a&&za}fillDownAbsoluteValueAndStartEdit(V,za,Ra){const Xa=V.ha.qa.activeCell,$a=Y.E(Xa,this.gridView.Ap);return V.startEdit(!0,0,za).Qo(()=>{const ma=V.Qb($a),fa=V.Qb(Xa);
if(!ma||!fa)return v.ULS.shipAssertTag(537159507,0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Xa.toString()} and above cell: ${$a.toString()}`),Na.Task.Ra(!1);this.gridView.Vb.text=Ra?ma.cS:ma.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return Na.Task.Ra(!0)})}insertOrDeleteCells(V,za,Ra){const Xa=A.a.create().toString();var $a=Enum.toString(S,V);this.gridView.vh.u0(17,Xa,$a);$a=this.gridView.ha.qa.selectedRanges;var ma=this.bmf,fa=this.Zlf;
if(!this.$.Us(null,!1,void 0,za.We)&&!fa&&!ma&&5!==V&&9!==V)return Na.Task.Ra(!0);2===V?V=fa?10:ma?6:$a[0].height>$a[0].width?18:34:1===V?V=fa?9:ma?5:$a[0].height>$a[0].width?17:33:18===V&&ma?V=34:34===V&&fa&&(V=18);$a=this.UPg($a,V);if((10===V||6===V)&&!this.$.Us($a,!0,1,za.We))return Na.Task.Ra(!0);const eb={};eb.InsertDeleteRangeItems=Array($a.length);eb.SheetName=this.$.na.sheetName;eb.IsTableCommand=Ra;for(Ra=0;Ra<$a.length;Ra++){ma=$a[Ra];fa={};let Qb,pc;V&4?(fa.FirstRow=ma.top-1,fa.LastRow=
R.a.cB,fa.FirstColumn=0,fa.LastColumn=R.a.$x,Qb=ma.bottom-ma.top+1,pc=0,6===V?(ma.Rg||(fa.FirstRow=ma.bottom),Qb=-Qb):gb.b("InsertRowsAbove"),37===V&&(fa.FirstRow=ma.bottom,gb.b("InsertRowsBelow"))):V&8?(fa.FirstRow=0,fa.LastRow=R.a.cB,fa.FirstColumn=ma.left-1,fa.LastColumn=R.a.$x,Qb=0,pc=ma.right-ma.left+1,10===V&&(ma.isRow||(fa.FirstColumn=ma.right),pc=-pc)):V&16?(fa.FirstRow=ma.top-1,fa.LastRow=ma.bottom-1,fa.FirstColumn=ma.left-1,fa.LastColumn=R.a.$x,Qb=0,pc=ma.right-ma.left+1,18===V&&(fa.FirstColumn=
ma.right,pc=-pc)):(fa.FirstRow=ma.top-1,fa.LastRow=R.a.cB,fa.FirstColumn=ma.left-1,fa.LastColumn=ma.right-1,Qb=ma.bottom-ma.top+1,pc=0,34===V&&(fa.FirstRow=ma.bottom,Qb=-Qb));const hb={};hb.InsertDeleteRange=fa;hb.DeltaRow=Qb;hb.DeltaColumn=pc;hb.AdjustedSelectedRange=Y.j(ma);eb.InsertDeleteRangeItems[Ra]=hb}this.gridView.Gg.dM(!1);const ua=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");eb.IsDecoupleRecalc=ua;const xa=this.$.oa.xa.Wb(),tb=()=>new L(eb);return U.a(this.$.userOperationManager,
(Qb,pc,hb)=>{ua&&!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.my();return mb(this.$.oa.xa,eb,ba.b(Qb,(ib,Vb)=>{this.VUi(ib,Vb,V)},()=>{this.gVj(V,eb)}),pc,hb,Xa,xa)},Qb=>new P.a(237,0,Qb,void 0,tb),za,d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}gVj(V,za){const Ra=this.x4h(V);if(Ra&&1===za.InsertDeleteRangeItems.length){var Xa=za.InsertDeleteRangeItems[0];1<Xa.DeltaColumn||1<Xa.DeltaRow||this.Tui(Ra)&&
f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),$a=>{const ma=new vb.a(Y.B(Xa.AdjustedSelectedRange),E.d(this.$.va.na));void $a.result.JCc(ma,Ra)},this.$.la,3)}}Tui(V){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===V||"DeleteRow"===V?(La.AFrameworkApplication.Sp("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",
!1)):"InsertColumn"===V||"InsertRow"===V?(La.AFrameworkApplication.Sp("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):"InsertCellShiftDown"===V||"InsertCellShiftRight"===V?(La.AFrameworkApplication.Sp("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",
!1)):"DeleteCellShiftUp"===V||"DeleteCellShiftLeft"===V?(La.AFrameworkApplication.Sp("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")||La.AFrameworkApplication.Sp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),
!1)}x4h(V){let za;switch(V){case 5:case 37:za="InsertRow";break;case 33:za="InsertCellShiftDown";break;case 9:za="InsertColumn";break;case 17:za="InsertCellShiftRight";break;case 6:za="DeleteRow";break;case 34:za="DeleteCellShiftUp";break;case 10:za="DeleteColumn";break;case 18:za="DeleteCellShiftLeft"}return za}UPg(V,za){return za&32?this.kZa(V,Ra=>Ra.bottom,Ra=>Ra.top,(Ra,Xa)=>{Ra.bottom=Xa},!1,!0):za&16?this.gridView.rtl?this.kZa(V,Ra=>Ra.left,Ra=>Ra.right,(Ra,Xa)=>{Ra.left=Xa},!1,!1):this.kZa(V,
Ra=>Ra.right,Ra=>Ra.left,(Ra,Xa)=>{Ra.right=Xa},!1,!1):za&4?this.kZa(V,Ra=>Ra.bottom,Ra=>Ra.top,(Ra,Xa)=>{Ra.bottom=Xa},!0,!0):za&8?this.gridView.rtl?this.kZa(V,Ra=>Ra.left,Ra=>Ra.right,(Ra,Xa)=>{Ra.left=Xa},!0,!1):this.kZa(V,Ra=>Ra.right,Ra=>Ra.left,(Ra,Xa)=>{Ra.right=Xa},!0,!1):V}kZa(V,za,Ra,Xa,$a,ma){V=Y.d(V);V.sort((fa,eb)=>za(eb)-za(fa));if($a){$a=[];ma=ma?R.a.Vg+1:R.a.Ug+1;for(let fa=0;fa<V.length;fa++){const eb=V[fa];Ra(eb)<ma&&(Xa(eb,Math.min(za(eb),ma-1)),$a.push(eb),ma=Ra(eb))}V=$a}return V}fill(V,
za,Ra,Xa,$a){const ma=this.$;if(!ma.Us([za],!0))return Na.Task.Ra(!0);const fa=Y.v(V,ma),eb=za?Y.v(za,ma):fa,ua=this.$.oa.xa.Wb(),xa=()=>new W(fa,eb,Xa,Ra);return U.a(this.$.userOperationManager,(tb,Qb,pc)=>{this.$.my();var hb=this.$.oa.xa;tb=ba.b(tb,this.FRi);const ib=hb.Na(9,ua);ib.sourceRange=fa;ib.targetRange=eb;ib.fillDirection=Ra;ib.fillType=Xa;return aa.g(hb,"FillRange",ib,tb,Qb,pc,null,0)},tb=>new P.a(155,0,tb,void 0,xa),$a)}V9h(V,za,Ra){const Xa={ValidMembers:32};switch(V){case 1890566896:V=
parseInt(za[M.a.Kc].toString(),10);if(14===V)return Ra=new wa.a(2105621672,Ra.method,Ra.mode,Ra.We,Ra.tabName),za[M.a.Kc]=null,this.$.Ia.Hb(Ra,za),v.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Xa.NumberFormat=V;break;case 1886928607:Xa.NumberFormat=13;break;case -992833457:Xa.NumberFormat=11;break;case 218524921:Xa.NumberFormat=12;break;case 996232352:Xa.NumberFormat=1006;break;default:return v.ULS.shipAssertTag(537159505,
0,!1,"Unexpected number formatting command "+Qa.b().Cj(Ra.command)),!1}v.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Qa.b().Cj(Ra.command)} command, with menu item ${za[M.a.Kc]}.`);this.Lh.formatCells(1890566896,Xa,Ra);this.$.qf();return!0}v9h(V){var za=this.gridView.Qb(this.gridView.ha.qa.activeCell);if(this.vb&&this.gridView.fb){za=this.gridView.li.t4a(za?ab.a(za).Font:null);if(!za)return v.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.qa.activeCell.toString()} is null while editing`),
!1;var Ra=za.FontSize}else if(za)Ra=za.fontSize;else return!1;za=V.command;let Xa=0;if(862890474===za)for(;Xa<Ua.QJa.length-1&&Ua.QJa[Xa]<=Ra;)Xa++;else if(963349338===za)for(Xa=Ua.QJa.length-1;0<Xa&&Ua.QJa[Xa]>=Ra;)Xa--;v.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Ra} to size ${Ua.QJa[Xa]}`);if(Ra===Ua.QJa[Xa])return!0;Ra=Ua.Mxc(2);Ra.Font.FontSize=Ua.QJa[Xa];this.vb&&this.gridView.fb?(this.Uob(V,!1,Ra),this.$.qf()):this.Lh.formatCells(za,
Ra,V);return!0}w$e(V,za,Ra){V=V[V[x.a.IsFreeForm]?x.a.Value:M.a.Pf].toString();if(!Ua.P6i.test(V))return v.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;V=parseFloat(V);if(8>V||72<V)return v.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const Xa=Math.round(2*V)/2,$a=Ua.Mxc(2);$a.Font.FontSize=Xa;this.vb&&this.gridView.fb?(this.Uob(za,
Ra,$a,!0),Xa===V||Ra||this.$.qf()):Ra?this.Lh.Xda(this.gridView,-1077965542,$a,Ra):(this.Lh.formatCells(-1077965542,$a,za),this.m0a());return!0}u$e(V,za,Ra){var Xa=V[M.a.Pf];let $a;this.jl?this.fontDropdownHelper.hBc&&this.fontDropdownHelper.hBc[Xa]?$a=Xa:(v.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Xa}`),$a=ea.HelperMethods.jO[Xa]):$a=ea.HelperMethods.jO[Xa];let ma=0;this.Rl&&(V=V.MenuItemId,V===ya.b?(Xa==this.themesManager.NF.zzd&&
($a=Xa),ma=2):V===ya.a&&(Xa==this.themesManager.NF.kyd&&($a=Xa),ma=1),v.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==ma}`));if(!$a)return!0;Xa=Ua.Mxc(1);Xa.Font.FontName=$a;this.Rl&&(Xa.Font.FontScheme=ma);this.vb&&this.gridView.fb?(this.Uob(za,Ra,Xa),this.$.qf()):Ra?(this.Lh.Xda(this.gridView,-1293291468,Xa,Ra),this.Phc&&(this.WG.wmd+=1)):(this.Lh.formatCells(-1293291468,Xa,za),this.Phc&&this.yei(Xa.Font.FontName),this.m0a());return!0}yei(V){this.WG.zRd+=
1;this.jl&&this.Lh.Jif(V)?this.WG.zAd+=1:this.WG.RBd+=1}fec(V,za,Ra,Xa){let $a=-803000997===V||1688184685===V?"black":za.Color;this.moreColorsHelper&&(-1832800737===V?$a=Ea.a.compare($a,"WindowText",!0)?this.moreColorsHelper.Ibb:"black":Ra||(this.moreColorsHelper.Ibb=$a,this.moreColorsHelper.gda(za,$a,Xa)));V=Ua.Mxc(32);V.Font.FontColor=ca.a.ZG($a,ia.a.lg(za,"IntColor"));this.vb&&this.gridView.fb?this.Uob(Xa,Ra,V,17===Xa.We):Ra?this.Lh.Xda(this.gridView,1970784898,V,Ra):(this.WC&&({themeColor:za}=
this.getThemeColor(za)).returnValue&&(V.Font.ThemeFontColor=za,V.Font.ColorTypeOption=1),this.Lh.formatCells(1970784898,V,Xa),this.m0a());return!0}H8h(V){var za=(new Date).format(748067091===V?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);const Ra=this.gridView.Ql?qa.a(this.gridView.$):this.gridView.Vb;V=Ra.textBox;this.gridView.fb?Ra.insertText(za):(this.gridView.startEdit(!0,0),Ra.text=za,za=za.length,V.wdb(za),V.caretPosition=za)}Q9h(){this.gridView.YM(this.gridView.ha.qa.activeCell)||this.gridView.hxc||
this.gridView.MMa()||this.gridView.ov(this.gridView.ha.qa.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}D8h(){if(!(this.gridView.hxc||this.gridView.MMa()||this.gridView.fb&&n.a.isMac)){const V=this.gridView.ha.qa.P3;this.gridView.qg(Y.v(V,this.$),V,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}f9h(V){this.Dac=E.d(this.$.va.na);if(this.gridView.Q6a)return this.gridView.Gg.dM(!1),!!this.copyPasteInfrastructure;if(!this.copyPasteInfrastructure)return v.ULS.sendTraceTag(537159494,
0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.j2(this.Edd);const za=String.format(G.a.uta,O.a.current.lo(107));this.gridView.Gg.qp(za);V=new wa.a(-911352779,V.method,V.mode,V.We,V.tabName);this.$.Ia.Hb(V,{[G.a.silentClipboardAccessFailures]:!0,[G.a.isFormatPainter]:!0}).continueWith(Ra=>{(6>Ra.status||6===Ra.status&&!Ra.result)&&this.jrb()});this.gridView.Q6a=!0;this.copyPasteInfrastructure.VNg(this.jrb);return!0}dyb(V,za,Ra,Xa){let $a=87208751===
V?"-1":za.Color;this.moreColorsHelper&&(1597684571===V?$a=this.moreColorsHelper.hQa:Ra||(this.moreColorsHelper.hQa=$a===Ua.notSet?Ua.AZd:$a,this.moreColorsHelper.gda(za,$a,Xa)));V={ValidMembers:64};V.FillColor=ca.a.ZG($a,ia.a.lg(za,"IntColor"));Ra?this.Lh.Xda(this.gridView,1650812936,V,!0):(this.WC&&({themeColor:za}=this.getThemeColor(za)).returnValue&&(V.ThemeFillColor=za,V.ColorTypeOption=1),this.Lh.formatCells(1650812936,V,Xa),this.m0a());return!0}y9h(){v.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");
const V=this.$.da.Aa(221);if(V){var za=this.gridView.li;if(za){var Ra,Xa,$a=({hxf:Ra,nYe:Xa}=V.Nii(za.text,za.textBox.caretPosition)).returnValue;$a?(V.re=!1,za.text=$a,za.textBox.selectRange(Ra,Ra+Xa),v.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):v.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else v.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else v.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}e9h(V,za){let Ra=0;var Xa=this.gridView;const $a=ab.a(Xa.Qb(null));this.vb&&Xa.fb&&($a.Font=Xa.li.t4a($a.Font));(Xa=$a.Font)||(Xa={ValidMembers:0});switch(V){case -287251124:Ra|=4;Da.e(Xa,4)?Xa.Bold=!Xa.Bold:Xa.Bold=!0;break;case -1925065947:Ra|=8;Da.e(Xa,8)?Xa.Italic=!Xa.Italic:Xa.Italic=!0;
break;case 1764140053:Ra|=16;Da.e(Xa,16)?Xa.Underline=!Xa.Underline:Xa.Underline=!0;break;case -1685033574:Ra|=64;Da.e(Xa,64)?Xa.DoubleUnderline=!Xa.DoubleUnderline:Xa.DoubleUnderline=!0;break;case -1590502662:Ra|=128,Da.e(Xa,128)?Xa.Strikethrough=!Xa.Strikethrough:Xa.Strikethrough=!0}if(!Ra)return!1;Xa.ValidMembers=Ra;$a.Font=Xa;$a.ValidMembers=16;this.vb&&this.gridView.fb?this.Uob(za,!1,$a):this.Lh.formatCells(V,$a,za);this.$.qf();return!0}k8h(V,za){let Ra=0;const Xa=ab.a(this.gridView.Qb(null));
-571165336===V||1041132226===V||-394785302===V?(Ra|=1,Xa.VerticalAlignment=ia.a.Zp(Ua.tZa,V.toString(),2)):Ua.Epi(V)?(Ra|=2,this.q9h(Xa,V)):-1116189897===V&&(Ra|=8,Xa.Wrap=Xa.ValidMembers&8?!Xa.Wrap:!0);if(!Ra)return!1;Xa.ValidMembers=Ra;this.Lh.formatCells(V,Xa,za);this.$.qf();return!0}q9h(V,za){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==za&&(za=-1150205178===za?-286432209:-1150205178);za=ia.a.Zp(Ua.tZa,za.toString(),
0);V.HorizontalAlignment=za===V.HorizontalAlignment?0:za}qPf(V,za,Ra,Xa){let $a=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&($a=this.mergeCellCommandAction.Dvf(za,Ra))&&oa.h(this.$).vh.UR(this.u9a,Fa.BasicTelemetryCalculator.zQ);return this.kub(V,za,!1,$a,ma=>{this.eWi(ma,Ra,za,$a,Xa)})}handleMergeCellsCommand(V,za){this.u9a=A.a.create().toString();let Ra=null;Ra=this.mergeCellCommandAction.C4e();var Xa=D.a(za.command);const $a=this.mergeCellCommandAction.sni(za.command,
Ra);let ma=0;$a?ma=u.a.Ud():oa.h(this.$).vh.u0(4,this.u9a,Xa+", Scenario = "+Ra.scenario.toString());Xa=V.ha.qa.selectedRanges;v.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Qa.b().Cj(za.command)}, Number of ranges: ${Xa.length}, Ranges: ${Y.i(Xa,",",this.$,!1)}`);Xa=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);V.Gg.dM(!1,Xa);if(10===ia.a.Zp(Ua.Fvf,za.command.toString(),10))return Na.Task.Ra(!1);const fa=
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Xa&&fa)return $a?(this.v9f(Ra,za,!0,!0,ma),Na.Task.Ra(!0)):this.qPf(V,za,Ra,!1);let eb=!1;Xa&&(eb=this.mergeCellCommandAction.Dvf(za,Ra))&&oa.h(this.$).vh.UR(this.u9a,Fa.BasicTelemetryCalculator.zQ);return this.kub(V,za,!1,eb,ua=>{this.fWi(ua,za,eb)})}kub(V,za,Ra,Xa,$a=null){const ma=this.$.oa.xa.Wb(),fa=ia.a.Zp(Ua.Fvf,za.command.toString(),10),eb=Y.r(V.ha.qa.selectedRanges,V.$),ua=()=>new N.a(fa,eb),
xa=tb=>{const Qb=!!tb&&!!tb.RequestTelemetryData;oa.h(this.$).vh.zla(this.u9a,tb.StateId,Qb?tb.RequestTelemetryData.EcsOperationDuration:0,Qb?tb.RequestTelemetryData.EcsRequestDuration:0,Qb?tb.RequestTelemetryData.WfeRequestDuration:0)};V=(tb,Qb,pc)=>{this.$.my();tb=$a?ba.b(tb,$a):tb;tb=ba.b(tb,xa);return aa.d(this.$.oa.xa,fa,eb,Ra,tb,Qb,pc,null,ma)};return Xa?U.a(this.$.userOperationManager,V,tb=>new P.a(156,0,tb,64,ua),za):U.a(this.$.userOperationManager,V,tb=>new P.a(156,0,tb,void 0,ua),za)}v9f(V,
za,Ra,Xa=!1,$a=0){v.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Ra}`);var ma=oa.h(this.$).rtl;ma=Ha.a.ed(3,2,0,ma?634:633,0,514846606,"MergeCellsLoseData");f.TaskExtensions.za(Gb.a(this.$).kj(ma),fa=>{fa=fa.result;if(Xa){const eb=u.a.Ud()-$a;v.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${eb}, and the user action is : ${fa}`)}0===fa?(v.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Ra?
(Xa&&(fa=D.a(za.command),oa.h(this.$).vh.u0(4,this.u9a,fa+", Scenario = "+V.scenario.toString())),this.qPf(oa.h(this.$),za,V,!0)):this.kub(this.gridView,za,!0,!1)):1===fa&&v.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}JBi(V,za,Ra,Xa){za!==V&&v.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${za} and as per server is ${V}. The scenario is:- ${Ra}, The CSE is done:- ${Xa}`)}fWi(V,
za,Ra){Sa.b(V,514846606)&&(v.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),wb.a(this.$).gd.KL(514846606),V=oa.h(this.$).rtl,V=Ha.a.ed(3,2,0,V?634:633,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.za(Gb.a(this.$).kj(V),Xa=>{Xa=Xa.result;0===Xa?(v.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.kub(this.gridView,za,!0,Ra)):1===Xa&&v.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}eWi(V,za,Ra,Xa,$a){let ma=
!1;Sa.b(V,514846606)&&(ma=!0,wb.a(this.$).gd.KL(514846606),Xa&&$a?window.setTimeout(()=>{this.kub(this.gridView,Ra,!0,!0)},0):this.v9f(za,Ra,!1));this.JBi(ma,$a,za.scenario,Xa)}tqb(V){if(this.K_a!==V&&1461300262!==this.K_a){this.LZf(this.K_a);var za=Qa.b().Cj(V);const Ra=Qa.b().Cj(this.K_a);v.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Ra} was restored before caching the style for ${za} command.`)}this.K_a=V;if(this.vb&&this.gridView.fb)this.H_a||(this.H_a=
this.gridView.li.formattedText);else if(!this.iC){this.iC=[];za=this.gridView.K$("GridCommandHandler.CacheFontStyles",this.gridView.ha.qa.selectedRanges);try{for(za.$$rst();za.$$mn();){const Ra=za.$$cu();if(Ra.cell.hasRichText)this.iC.push(ka.PYg(Ra,Ra.cell.formattedText));else switch(V){case 673562736:case -446735083:this.iC.push(ka.$_c(Ra,Ra.backgroundColor));break;case -128950598:case 1688184685:this.iC.push(ka.$_c(Ra,Ra.color));break;case 909774670:this.iC.push(ka.QYg(Ra,Ra.fontSize));break;case 324978188:this.Rl?
this.iC.push(ka.OYg(Ra,Ra.fontName,Ra.gZ)):this.iC.push(ka.$_c(Ra,Ra.fontName))}}}finally{za&&za.dispose()}}}MKj(){return this.vb&&this.gridView.fb?!this.H_a:!this.iC}hmi(V){return!!this.iC&&this.iC.length>V&&!!this.iC[V].formattedText}efd(V){return this.iC[V].style}kQh(V){return this.iC[V].size}jQh(V){return this.iC[V].gZ}LZf(V){if(!this.MKj()){if(this.vb&&this.gridView.fb)this.H_a&&(this.gridView.Vb.formattedText=this.H_a);else{const Ra=this.iC.length;for(let Xa=0;Xa<Ra;Xa++){let $a;var za=this.iC[Xa].SJa.cell.getRange();
$a=this.gridView.Qb(za);if(!$a){v.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${za.NC(!1)}`);continue}let ma;za=$a.sH?this.gridView.vLb($a.range):(ma=new I.a,ma.add($a),ma);for(let fa of za)if(fa.cell.hasRichText&&1457172838!==V)this.hmi(Xa)&&(fa.cell.formattedText=this.iC[Xa].formattedText);else switch(V){case 1457172838:fa.backgroundColor=this.efd(Xa);break;case 2036397036:fa.color=this.efd(Xa);break;case -1904244080:fa.fontSize=
this.kQh(Xa);break;case -1428968098:fa.fontName=this.efd(Xa),this.Rl&&fa.P4f(this.jQh(Xa))}}}this.K_a=1461300262;this.m0a()}}m0a(){this.vb&&this.gridView.fb?this.H_a=null:this.iC=null}w9h(V,za){const Ra={IndentationIncrease:0};if(-1942512156===V)Ra.IndentationIncrease=1;else if(-1920201820===V)Ra.IndentationIncrease=-1;else return!0;Ra.ValidMembers=256;this.Lh.formatCells(V,Ra,za);return!0}Z9h(V,za){var Ra=this.gridView.Qb(null);const Xa=ab.a(Ra);if(0<Ra.indentation&&-1526602249!==V)return!1;Ra=V;
!oa.h(this.$).rtl||-1649235364!==V&&524773427!==V||(Ra=-1649235364===V?524773427:-1649235364);switch(Ra){case -1649235364:Ra=R.a.rotateTextUp45;break;case 524773427:Ra=R.a.ewc;break;case 1886217042:Ra=R.a.rotateTextUp90;break;case 928057943:Ra=R.a.gwc;break;case -1526602249:Ra=R.a.verticalText;break;default:return!1}Xa.ValidMembers=512;const $a=Xa.TextOrientation;Xa.TextOrientation=Ra===$a||$a===R.a.dwc&&Ra===R.a.ewc||$a===R.a.fwc&&Ra===R.a.gwc?0:Ra;this.Lh.formatCells(V,Xa,za);return!0}t9h(){const V=
oa.h(this.$),za=Y.r(V.ha.qa.selectedRanges,this.$),Ra=Y.o(V.ha.qa.activeCell,this.$);v.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return U.a(this.$.userOperationManager,(Xa,$a,ma)=>X.r(this.$.oa.xa,Ra,za,Xa,$a,ma,null),Xa=>new P.a(201,0,Xa),null)}L$e(V,za){let Ra=null;var Xa=oa.h(this.$).ha.qa.selectedRanges;Xa=this.gridView.K$("MoreColors",Xa,1,!0);try{for(Xa.$$rst();Xa.$$mn();){const $a=Xa.$$cu().cell;if(!$a)continue;let ma=Ua.black;if(1970784898===V)ma=
$a.color;else if(1650812936===V){const fa=$a.backgroundColor;ma=Ea.a.compare(fa,Ua.AZd,!0)&&Ea.a.compare(fa,Ua.empty,!0)?$a.backgroundColor:Ua.white}if(!Ra)Ra=ma;else if(Ra!==ma){Ra=Ua.black;break}}}finally{Xa&&Xa.dispose()}this.vb&&this.gridView.fb&&1970784898===V&&this.gridView.li.textBox.Cxe();return this.moreColorsHelper.cDb(V,za,Ra)}M9h(V){const za=z.a.M4a(this.borderFormatManager.a3);return this.moreColorsHelper.cDb(-236759591,V,za)}Uob(V,za,Ra,Xa=!1){za?this.gridView.li.tOf(Ra.Font):(this.ZDi(V),
Xa?window.requestAnimationFrame(()=>{w.FocusManager.instance().kk(C.AFrame.caa);this.gridView.li.wZe(Ra.Font)}):(w.FocusManager.instance().kk(C.AFrame.caa),this.gridView.li.wZe(Ra.Font)),this.m0a())}ZDi(V){const za=D.a(V.command);V=y.a[V.We]+"_"+B.a[V.method];const Ra=this.gridView.mc.fBe.toString(),Xa=new Map;Xa.set("Command",za);Xa.set("Source",V);Xa.set("Ribbon","React");Xa.set("CellTextRuns",Ra);H.Health.instance.recordKpiUsage(Ma.a.AJh,0,Ga.a.p_f,Xa)}kkd(V,za,Ra){V=this.borderFormatManager.kkd(V,
za,Ra);this.moreColorsHelper&&this.moreColorsHelper.gda(za,this.borderFormatManager.a3,Ra);return V}getThemeColor(V){let za;za={};let Ra=!1;if((V.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return v.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:za};let Xa;({themeIndex:V,tBa:Xa,returnValue:Ra}=this.themesManager.getThemeColor(V.Color));Ra&&(za.ThemeColorIndex=V,za.ThemeColorRow=Xa)}return{returnValue:Ra,
themeColor:za}}static get P6i(){return Ua.Xge||(Ua.Xge=RegExp("^[0-9]+[.]?[0-9]*$"))}static get jod(){return Ua.rae||(Ua.rae={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get tZa(){return Ua.ghb||(Ua.ghb={["-394785302"]:0,["-571165336"]:2,
["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get Fvf(){return Ua.lee||(Ua.lee={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static Epi(V){return-1150205178===V||-1142465846===V||-286432209===V||2007171328===V}static Mxc(V){const za={},Ra={};za.ValidMembers=16;za.Font=Ra;Ra.ValidMembers=V;return za}static L2e(V,za){let Ra;Ra=V.top<za.top?3:V.bottom>za.bottom?0:-1;return Ra=V.left<za.left?1:V.right>za.right?2:Ra}}Ua.AZd="transparent";
Ua.notSet="-1";Ua.black="#000000";Ua.empty="";Ua.white="#FFFFFF";Ua.rae=null;Ua.ghb=null;Ua.lee=null;Ua.Xge=null;Ua.QJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(t.a)(Ua,"GridCommandHandler",null,[221]);class lb extends l.a{constructor(V){super(V)}hd(){const V=e.GetServiceTaskFactory.create(this.$.da,111,this.la,this.Xa),za=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa),Ra=e.GetServiceTaskFactory.create(this.$.da,397,this.la,this.Xa),Xa=e.GetServiceTaskFactory.Oa(this.$.da,
502,503,this.Xa);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const $a=e.GetServiceTaskFactory.Oa(this.$.da,296,468,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([V,za,Ra,$a,Xa],this.la),()=>{this.$c([new Ua(this.$,oa.h(this.$),za.result,V.result,$a.result,Ra.result,Xa.result)])},this.la,3)}else{const $a=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([V,za,$a,Ra,Xa],this.la),()=>{this.$c([new Ua(this.$,
oa.h(this.$),za.result,V.result,new h.BorderFormatManager(this.$,za.result,$a.result),Ra.result,Xa.result)])},this.la,3)}}static ka(V){l.a.Ld(80,new lb(V))}}Object(t.a)(lb,"GridCommandHandlerFactory",l.a,[]);a.d(F,"a",function(){return sb});const sb=()=>{c.a.Fa(lb.ka);c.a.Fa(m.ka)}},1197:function(t,F,a){function c(Sa){return Object(A.c)(Sa)?"cache":"client"===Sa.origin||Sa.cached?"client":"server"}function b({x:Sa,y:Da},ea,sa=document){let Ea=-1,ba=null;void 0!==sa.caretPositionFromPoint?(Sa=sa.caretPositionFromPoint(Sa,
Da),null!==Sa&&(Ea=Sa.offset,ba=Sa.offsetNode)):void 0!==sa.caretRangeFromPoint&&(Sa=sa.caretRangeFromPoint(Sa,Da),null!==Sa&&(Ea=Sa.startOffset,ba=Sa.startContainer));return null===ba||-1===Ea?(B.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):ea.contains(ba)?e(ea,ba,Ea):(B.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(Sa,Da,ea){if(Sa===Da)return ea;if(Da.textContent!==Da.parentElement.textContent)for(;null!==
Da.previousSibling;)Da=Da.previousSibling,ea+=Da.textContent.length,"div"===Da.nodeName.toLowerCase()&&(ea+=1);return e(Sa,Da.parentElement,ea)}function f(Sa,Da){return Sa.text===Da.text&&Sa.start===Da.start&&Sa.length===Da.length}function d(Sa,Da,ea){if(Sa.has(Da))return Sa.get(Da);ea=ea();Sa.set(Da,ea);return ea}function h(Sa){return JSON.stringify({text:Sa.text,start:Sa.start,length:Sa.length})}function m(Sa){return Object(A.c)(Sa)?"Undefined text":""===Sa?"Empty text":null}var l=a(9);t=a(0);var v=
a(226),r=a(173),A=a(740),x=a(21),n=a(11),u=a(22),z=a(13),w=a(220),C=a(34),y=a(33),B=a(15),H=a(1115);class I{constructor(Sa){this.$=Sa;this.qIa=this.Usb=null;this.usage={};this.results={};this.performance={};this.Drc=-1;this.uc=(Da,ea)=>{ea.Bf||ea.cqd||this.$.sendBeaconTraceTag(388818255,50,!1,this.JYd())};this.editBox=Object(x.h)(this.$).Vb;Sa.nj(this.uc)}static getInstance(Sa){return I.instance||(I.instance=new I(Sa))}set trigger(Sa){this.Usb=Sa;this.Drc=H.a.tYd}set tOd(Sa){this.qIa=Sa}setResult(Sa,
Da){if(Object(A.c)(this.Usb))B.ULS.sendTraceTag(512258439,0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var ea=Da===this.editBox?"cellEditor":"formulaBar",sa=this.Usb;Da=this.qIa;var Ea=this.Drc;Object(A.c)(this.usage[ea])&&(this.usage[ea]={});Object(A.c)(this.usage[ea][sa])&&(this.usage[ea][sa]={success:0,error:0,unavailable:0});ea=this.usage[ea][sa];switch(Sa.kind){case 1:this.Xdj(Sa.text);ea.success++;this.Usb=this.qIa=null;this.Drc=-1;break;case 2:ea.error++;this.Usb=
null;this.Drc=-1;break;case 3:ea.unavailable++}this.dw(Da,Ea)}}Xdj(Sa){if(!Object(A.c)(this.qIa)){Object(A.c)(this.results[this.qIa.origin])&&(this.results[this.qIa.origin]=[]);var Da=this.results[this.qIa.origin];1E3>Da.length&&Da.push(Sa.length)}}dw(Sa,Da){if(-1!==Da){Sa=c(Sa);this.y5e(`${Sa}_request`).u3(!0,Da);var ea=this.y5e(`${Sa}_overall`);window.requestAnimationFrame(()=>{ea.u3(!0,Da)})}}y5e(Sa){return this.performance[Sa]=this.performance[Sa]||new H.a(R)}JYd(){const Sa={};Object.keys(this.performance).forEach(Da=>
{this.performance[Da].CXe();var ea=this.performance[Da];Sa[Da]={metrics:ea.MV,durations:ea.Utb}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(Sa)}}`}}Object(t.a)(I,"ValuePreviewTelemetry",null,[]);const R=[50,80,100,130,150,170,200];class S{constructor(Sa,Da,ea){this.$=Sa;this.TJa=Da;this.ariaLiveNotifier=ea;this.$fi();this.editBox=Object(x.h)(this.$).Vb;this.QFj=y.a.qH(this.$)}get telemetry(){return I.getInstance(this.$)}get zoomManager(){this.Sme||
(this.Sme=Object(C.a)(this.$));return this.Sme}dispose(){this.hide()}show(Sa,Da,ea){const sa=Object.assign(Object.assign({},Da),{lU:Sa,y2d:ea});this.feb(sa)&&(this.Ona(sa)&&this.hide(),this.LG=sa,this.telemetry.setResult(Da,Sa),this.kI(),ea&&this.Pci())}hide(){if(this.LG){var Sa=this.LG.y2d;this.lnh();Sa&&this.Khj();this.LG=void 0}}feb(Sa){var Da;(Da=!this.LG)||(Da=this.LG,Da=!(Da.lU===Sa.lU&&Da.kind===Sa.kind&&Da.text===Sa.text&&Da.start===Sa.start&&Da.length===Sa.length&&Da.y2d===Sa.y2d));return Da}Ona(Sa){var Da;
if(Da=this.LG)Da=this.LG,Da=!(Da.lU===Sa.lU&&Da.start===Sa.start&&Da.length===Sa.length);return Da}Pci(){this.LG.lU.textBox.formatText(this.LG.start,this.LG.length,{background:"rgba(202,234,216,0.6)"})}Khj(){const Sa=this.LG.lU;Sa.textBox.formatText(0,Sa.text.length,{background:!1});this.QFj&&Sa.GD(null)}kI(){var Sa=this.LG.text;switch(this.LG.kind){case 1:case 2:Sa={isLoaded:!0,value:Sa};break;case 3:Sa={isLoaded:!1,value:null};break;default:return}this.V1j();this.TJa.renderValuePreview(this.xs,
this.dPb,Sa);this.C4i(Sa)}lnh(){this.TJa.dismiss(this.xs)}$fi(){this.xs=document.createElement("div");this.dPb=document.createElement("div");this.dPb.style.position="absolute";this.dPb.style.visibility="hidden";this.$.domElement.appendChild(this.dPb)}V1j(){var Sa=this.LG.lU,Da=this.LG.start;const ea=this.LG.length,sa=u.a.contains(Sa.text.substring(Da,Da+ea),"\n",!0);Sa=excelOnline.utils.getBoundingRectForText(Sa.textBox.Ie,Da,sa?Da:Da+ea,!1);Da=new w.a(this.dPb.style);Da.BB.left=this.bAc(Sa.left);
Da.BB.top=this.bAc(Sa.top);Da.BB.width=this.bAc(Sa.width);Da.BB.height=this.bAc(Sa.height);Da.l2()}bAc(Sa){var Da=this.LG.lU;Da=Object(A.b)(this.zoomManager)&&Da===this.editBox;return n.HelperMethods.sc(Da?this.zoomManager.ki(Sa):Sa)}C4i({isLoaded:Sa,value:Da}){Sa?this.ariaLiveNotifier.readText(String.format(z.a.instance.ob(179),Da)):this.ariaLiveNotifier.readText(z.a.instance.ga(864))}}Object(t.a)(S,"FormulaAssistanceValuePreviewControl",null,[2]);var G=a(117);class D{constructor(Sa){this.cache=
Sa}clearCache(){this.cache=void 0}}Object(t.a)(D,"Cacheable",null,[]);class E extends D{constructor(Sa,Da){super();this.$=Sa;this.callbacks=Da;this.pCf=(ea,sa)=>{const Ea=this.gridView.li;if(!(0<(Ea.fb?Ea.textBox.selection:{index:0,length:0}).length))switch(sa.state){case 0:this.onHoverEnter(ea,sa.event);break;case 1:this.onHoverLeave(ea);break;default:return B.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),sa}};this.oCf=(ea,sa)=>{const Ea=
sa.selection;sa={kind:"selection",text:sa.text,start:Ea.index,length:Ea.length};if(0<Ea.length)this.onSelectionChange(ea,sa);else this.cIf(ea,sa)};this.gridView=Object(x.h)(this.$);this.editBox=this.gridView.mc;this.Aj(this.editBox);this.formulaBar=Object(G.a)(this.$);Object(A.b)(this.formulaBar)?this.Aj(this.formulaBar):Object(G.b)(this.$,ea=>{this.formulaBar=ea;this.Aj(this.formulaBar);B.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return I.getInstance(this.$)}dispose(){this.Sj(this.editBox);
this.Sj(this.formulaBar)}trigger(){const Sa=this.gridView.li,Da=Sa.textBox.selection;this.onSelectionChange(Sa,{kind:"shortcut",text:Sa.text,start:Da.index,length:Da.length})}Aj(Sa){Sa.Lqe(this.pCf);Sa.pMg(this.oCf)}Sj(Sa){null===Sa||void 0===Sa?void 0:Sa.nWf(this.pCf);null===Sa||void 0===Sa?void 0:Sa.ijj(this.oCf)}onHoverEnter(Sa,Da){Da=new Sys.UI.Point(Da.clientX,Da.clientY);Da=b(Da,Sa.textBox.Ie);if(-1!==Da)this.onSelectionChange(Sa,{kind:"hover",text:Sa.text,start:Da,length:0})}onHoverLeave(Sa){this.cIf(Sa)}onSelectionChange(Sa,
Da){this.eFj(Da)&&(this.cache=Da,this.callbacks.pEd(Sa,{index:Da.start,length:Da.length}),this.telemetry.trigger=Da.kind)}cIf(Sa,Da){this.aFj(Da)&&(this.clearCache(),this.callbacks.rca(Sa))}eFj(Sa){return!this.cache||!f(this.cache,Sa)}aFj(Sa){return this.cache&&Sa?"shortcut"!==this.cache.kind||!f(this.cache,Sa):!0}}Object(t.a)(E,"FormulaAssistanceValuePreviewHandler",D,[2]);var M;(function(Sa){Sa[Sa.Failure=0]="Failure";Sa[Sa.Success=1]="Success";Sa[Sa.Error=2]="Error";Sa[Sa.Unavailable=3]="Unavailable"})(M||
(M={}));Object(t.b)("ValuePreviewResultKind",M);var L=a(41),N=a(60);class Y{constructor(Sa,Da){this.$=Sa;this.pluginScheduler=Da;this.vR=new P(h);this.e3f=new P(h);this.oZi=(ea,sa)=>Ea=>{if(Object(A.c)(Ea.Result))sa("No result");else if(Ea=JSON.parse(Ea.Result),Object(A.c)(Ea))sa("Failed to deserialize");else if(1!==Object.keys(Ea).length)sa("Invalid response");else{for(var ba in Ea)var ka=Ea[ba];ba=m(ka);Object(A.b)(ba)?sa(ba):ea(ka)}};this.nZi=ea=>()=>{ea("Request failed")};this.gridView=Object(x.h)(this.$);
if(this.Jvb=y.a.aV(this.$))this.formulaAssistanceManager=Sa.da.Aa(464)}get telemetry(){return I.getInstance(this.$)}clearCache(){this.vR.clear();this.e3f.clear()}request(Sa){return Object(r.a)(this,void 0,void 0,function*(){return d(this.vR,Sa,()=>Object(r.a)(this,void 0,void 0,function*(){const {kind:Da,payload:ea}=yield this.pluginScheduler.getRequester().valuePreview(Sa,this.formulaAssistanceManager?this.formulaAssistanceManager.OHb:0);if(0!==Da)return null;if(Object(A.c)(ea))return{kind:0};this.telemetry.tOd=
{origin:"client"};switch(ea.kind){case 0:return{kind:0};case 1:case 2:return this.e4j(ea);case 3:const sa={text:Sa.text,start:ea.start,length:ea.length};return this.vR.has(sa)?(this.telemetry.tOd={origin:"server",cached:!0},yield this.vR.get(sa)):Object.assign(Object.assign({},ea),{kind:3,next:()=>this.ynj(sa,Sa,ea.text)})}}))})}e4j(Sa){const Da=m(Sa.text);return Object(A.b)(Da)?(B.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${Da}, kind:${M[Sa.kind]}`),
{kind:0}):Sa}ynj(Sa,Da,ea){return Object(r.a)(this,void 0,void 0,function*(){return d(this.e3f,Sa,()=>{const sa=new Promise(Ea=>Object(r.a)(this,void 0,void 0,function*(){try{const ba=yield this.t_h(ea);this.telemetry.tOd={origin:"server"};Ea({kind:1,text:ba,start:Sa.start,length:Sa.length})}catch(ba){B.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${ba}`),Ea({kind:0})}}));sa.then(()=>{this.vR.set(Sa,sa);this.vR.set(Da,sa)}).catch(Ea=>
{B.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Ea}`)});return sa})})}t_h(Sa){return Object(r.a)(this,void 0,void 0,function*(){return new Promise((Da,ea)=>{const sa={Formula:Sa,PartialFormula:Sa,SourceRange:Object(L.v)(this.gridView.ha.qa.activeCell,this.$)};U(this.$.oa.xa,sa,this.oZi(Da,ea),this.nZi(ea),null,null)})})}}Object(t.a)(Y,"FormulaAssistanceValuePreviewRequester",null,[]);const U=(Sa,Da,ea,sa,Ea,ba,ka=null)=>{ka=Sa.Na(1,
ka);ka.getPartialCalcResultsParameters=Da;return Object(N.g)(Sa,"GetPartialCalcResults",ka,ea,sa,Ea,ba,4)};class P{constructor(Sa){this.KYd=Sa;this.map=new Map}has(Sa){Sa=this.KYd(Sa);return this.map.has(Sa)}get(Sa){Sa=this.KYd(Sa);return this.map.get(Sa)}set(Sa,Da){Sa=this.KYd(Sa);this.map.set(Sa,Da);return this}clear(){this.map.clear()}}Object(t.a)(P,"RequestMap",null,[]);class aa{constructor(Sa,Da,ea,sa){this.$=Sa;this.pEd=(Ea,ba)=>Object(r.a)(this,void 0,void 0,function*(){const ka={text:Ea.text,
start:ba.index,length:ba.length};void this.tPf(ka,this.requester.request.bind(this.requester),Ea,0===ka.length)});this.rca=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.Cw=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(x.h)(this.$);this.control=new S(this.$,ea,sa);this.requester=new Y(this.$,Da);this.handler=new E(this.$,{pEd:this.pEd,rca:this.rca});this.Aj()}trigger(){this.handler.trigger()}dispose(){this.Sj();
this.handler.dispose();this.control.dispose()}Aj(){this.gridView.Vb.Jm(this.reset);this.gridView.ha.Jga(this.reset);this.$.ea.lA(this.Cw)}Sj(){this.gridView.Vb.$l(this.reset);this.gridView.ha.Tma(this.reset);this.$.ea.rB(this.Cw)}tPf(Sa,Da,ea,sa){return Object(r.a)(this,void 0,void 0,function*(){const Ea=Object.assign(Object.assign({},Sa),{lU:ea,NTd:sa});this.oIa=Ea;const ba=yield Da(Sa);Object(A.c)(ba)||this.Qsi(Ea)&&void this.G$h(ba)})}G$h(Sa){return Object(r.a)(this,void 0,void 0,function*(){const Da=
this.oIa.text,ea=this.oIa.lU,sa=this.oIa.NTd;switch(Sa.kind){case 0:this.hide();break;case 1:case 2:this.show(ea,Sa,sa);break;case 3:if(!this.xvi(Sa))break;this.show(ea,Sa,sa);void this.tPf({text:Da,start:Sa.start,length:Sa.length},Sa.next,ea,sa);break;default:return Sa}})}show(Sa,Da,ea){this.oIa=void 0;this.Xsi(Da)&&(this.control.show(Sa,Da,ea),this.Psb=Da)}hide(){this.control.hide();this.Psb=this.oIa=void 0}Qsi(Sa){var Da;if(Da=this.oIa)Da=this.oIa,Da=Da.text===Sa.text&&Da.start===Sa.start&&Da.length===
Sa.length&&Da.lU===Sa.lU&&Da.NTd===Sa.NTd;return Da}Xsi(Sa){return Object(A.b)(Sa.text)&&""!==Sa.text}xvi(Sa){return!this.Psb||this.Psb.start!==Sa.start||this.Psb.length!==Sa.length||3===this.Psb.kind}}Object(t.a)(aa,"FormulaAssistanceValuePreview",null,[254,2]);var X=a(50),Z=a(37);class da extends v.a{constructor(Sa){super();this.$=Sa;this.Db()}static ka(Sa){Sa.da.Ha(497,new da(Sa))}create(){let Sa=this.$.da.Aa(496);Sa&&this.nb(Sa);const Da=X.GetServiceTaskFactory.Oa(this.$.da,413,414,this.Xa),ea=
X.GetServiceTaskFactory.Oa(this.$.da,448,449,this.Xa),sa=X.GetServiceTaskFactory.Oa(this.$.da,19,153,this.Xa),Ea=X.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Xa);Z.TaskExtensions.za(Z.TaskExtensions.Fd([Da,ea,sa,Ea],this.la),()=>{Sa=this.$.da.Aa(496);Sa||(Sa=new aa(this.$,Da.result,ea.result,Ea.result),this.$.da.Ha(496,Sa));this.nb(Sa)},this.la,3)}}Object(t.a)(da,"FormulaAssistanceValuePreviewFactory",v.a,[]);var qa=a(709),O=a(188),ca=a(55);class wa{constructor(Sa,Da){this.formulaAssistanceValuePreview=
Da;this.gridView=Object(x.h)(Sa)}Hc(){return!1}executeCommand(Sa,Da){Sa=!1;Da=Da.command;switch(Da){case -46938080:this.formulaAssistanceValuePreview.trigger(),Sa=!0}return Sa?ca.Task.Ra(!0):O.a(Da)}wc(Sa,Da){return-46938080===Da.command}Mc(){return!1}}Object(t.a)(wa,"FormulaAssistanceValuePreviewCommandHandler",null,[221]);class ia extends qa.a{constructor(Sa){super(Sa)}hd(){const Sa=X.GetServiceTaskFactory.Oa(this.$.da,496,497,this.Xa);Z.TaskExtensions.za(Sa,()=>{this.$c([new wa(this.$,Sa.result)])},
this.la)}static ka(Sa){qa.a.Ld(515,new ia(Sa))}}Object(t.a)(ia,"FormulaAssistanceValuePreviewCommandHandlerFactory",qa.a,[]);a.d(F,"a",function(){return Ha});const Ha=()=>{l.a.Fa(Sa=>{da.ka(Sa);ia.ka(Sa)})}},1203:function(t,F,a){t=a(0);var c=a(15),b=a(191),e=a(85),f=a(84),d=a(388),h=a(100),m=a(46);class l{constructor(){this.hda=this.O_e=null}}Object(t.a)(l,"GestureAdapterInfo",null,[]);var v=a(4),r=a(378),A=a(231);class x{constructor(){this.FJc=null}dAi(){if(!this.FJc){var N="hammer.min.js";v.AFrameworkApplication.fa.Ep("IsServerFlavorDebug")&&
(N=v.AFrameworkApplication.fa.pa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");N=v.AFrameworkApplication.WN(String.format("{0}",N),5);N=A.a.create(N,null,null);r.a.uia(N);this.FJc=N.Q8a}return this.FJc}static get instance(){x.La||(x.La=new x);return x.La}}x.La=null;Object(t.a)(x,"HammerJsDependencyLoader",null,[425]);var n=a(14);const u=(N,Y,U=null)=>{if(void 0===Y||null===Y)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let P=
null;switch(N){case n.a.pinch:P=new Hammer.Pinch(U);break;case n.a.pan:P=new Hammer.Pan(U)}P&&(P.manager=Y);return P};var z;(function(N){N[N.none=-1]="none";N[N.pinch=0]="pinch";N[N.pan=1]="pan";N[N.swipe=2]="swipe"})(z||(z={}));Object(t.b)("GestureEvent",z);var w=a(78);class C extends w.a{constructor(N,Y,U,P,aa,X,Z,da){super(N,U,P,X);this.Ohb=Y;this.dga=Z;this.nX=da;this.Uwg=aa}get shiftKey(){return this.dga}get ctrlKey(){return this.nX}get clientPoint(){return this.Ohb}get Qua(){return this.Uwg}static create(N,
Y,U,P,aa,X){if(U.rawEvent)if(X){var Z=U.rawEvent;Z=new Sys.UI.Point(Z.clientX,Z.clientY)}else Z=w.a.wwb(U);else Z=new Sys.UI.Point(U.clientX,U.clientY);return new C(N,Z,Y,U,P,aa,U.shiftKey,U.ctrlKey,X)}}Object(t.a)(C,"GestureEventArgs",w.a,[]);class y{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=
this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(t.a)(y,"GestureManagerData",null,[]);class B{}B.Aqg=2;B.Bqg=4;B.Cqg=8;B.Dqg=8;Object(t.a)(B,"HammerConstants",null,[]);var H=a(95),I=a(210),R=a(30),S=a(80);class G extends m.a{constructor(N,Y){super();this.kqa=d.a.sNh;this.aRc=!!window.PointerEvent;this.Dle=window.hasOwnProperty("ontouchstart");this.eWa=this.dlb=null;this.w8=!1;this.JS=new h.a;this.ylb=
new h.a;this.Vwg=new b.a;this.Jpa=null;this.jVa=this.tLc=this.g6d=this.oIc=this.VOc=this.aie=this.m6d=this.$mb=!1;this.Hkb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.HTc=null;this.Od=H.EventHandlerManager.instance;this.aRc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.dlb=Object(e.a)(this,this.Wpc,"onPointerEvent"),this.eWa=n.a.uNh):this.Dle?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.dlb=Object(e.a)(this,this.Rya,"onTouchEvent"),this.eWa=
n.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.dlb=Object(e.a)(this,this.Hpc,"onMouseEvent"),this.eWa=n.a.tNh);this.rh=Y;this.efa=N;v.AFrameworkApplication.fa&&(this.$mb=v.AFrameworkApplication.fa.pa("UsePointerCaptureIsEnabled"),this.m6d=v.AFrameworkApplication.fa.pa("ClearCacheOnPrimaryPointerIsEnabled"),this.aie=v.AFrameworkApplication.fa.pa("ResetHandledBeforeInputHandlerIsEnabled"),this.VOc=v.AFrameworkApplication.fa.pa("LogCoalescedEventsIsEnabled"),this.oIc=
v.AFrameworkApplication.fa.pa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.g6d=v.AFrameworkApplication.fa.pa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.tLc=v.AFrameworkApplication.fa.pa("HammerJsPerformanceTimersIsEnabled"),this.jVa=this.$mb&&v.AFrameworkApplication.fa.pa("CancelDragFromGestureInputManagerIsEnabled")&&v.AFrameworkApplication.fa.pa("UseGestureInputManagerPointerCacheIsEnabled"))}VVh(){return this.aRc?0:this.Dle?1:2}qn(N){super.qn(N);this.Od.lka(this.eWa,N,0,this.dlb)}nm(N){super.nm(N);
this.Od.BIa(N,this.eWa)}nfj(N,Y,U=null){v.AFrameworkApplication.wic()?x.instance.dAi().continueWith(P=>{this.rNj();if(P.Hf||P.kh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",P.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",P.status);if(this.g6d){P=window.Hammer;if("undefined"===typeof P){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.PAc();return}if("undefined"===typeof P.inputHandler){c.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.PAc();return}}if(!N)throw this.PAc(),Error.argumentNull("source element can not be null");P=I.a.rva(N,this.kqa);if(void 0===P||null===P)P=new h.a,I.a.Gdb(N,this.kqa,P),this.ofj(N);var aa=null;P.hb(z[0])||(aa=Object.assign(new l,{hda:u(z[0],this,null),O_e:Y}),P.add(z[0],aa));if(void 0!==U&&null!==U)for(let X=0;X<U.length;X++)if(P.hb(z[U[X]])){const Z=P.ma(z[U[X]]);aa.hda.recognizeWith(Z.hda)}}this.PAc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}rNj(){this.tLc&&
(this.rh?this.HTc=this.rh.Gc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}PAc(){this.tLc&&(this.HTc?this.HTc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}ofj(N){this.Vwg.add(N);this.Od.lka(this.eWa,N,0,this.dlb)}recognize(N){var Y=Array(N.pointers.length);for(var U=0;U<N.pointers.length;U++)Y[U]=N.pointers[U].target;U=null;for(this.Jpa=this.oYh(Y);void 0!==this.Jpa&&null!==this.Jpa&&
(U=I.a.rva(this.Jpa,this.kqa),void 0===U||null===U);this.Jpa=this.Jpa.parentNode);if(void 0!==U&&null!==U){this.curRecognizer&&this.curRecognizer.state===B.Dqg&&(this.curRecognizer=null);Y=U.keys;for(let P of Y){Y=U.ma(P);void 0!==Y&&null!==Y&&void 0!==Y.hda&&null!==Y.hda&&(void 0===this.curRecognizer||null===this.curRecognizer||Y.hda===this.curRecognizer||Y.hda.canRecognizeWith(this.curRecognizer))&&Y.hda.recognize(N);const aa=Y.hda.state;this.curRecognizer||B.Aqg!==aa&&B.Bqg!==aa&&B.Cqg!==aa||(this.curRecognizer=
Y.hda)}}}emit(N,Y){if("hammer.input"!==N){this.w8=!1;Y=C.create(N,this.Jpa,Y.srcEvent,Y,3,this.aRc);var U=I.a.rva(this.Jpa,this.kqa);if(this.Pri(N))var P=0;else if(this.Gri(N))P=1;else if(this.Nui(N))P=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:U}=U.Fc(z[P]));void 0!==U&&null!==U&&((U=U.O_e,U.lpi())?N.endsWith("start")?this.w8=U.sSi(Y):N.endsWith("end")?(U.qSi(Y),this.w8=!0):N.endsWith("cancel")?(U.pSi(Y),this.w8=!0):N.endsWith("move")&&
(this.w8=U.rSi(Y)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",N))}}get(N){return Object(f.a)(Hammer.Recognizer,N)}oYh(N){if(1>N.length)return null;if(1===N.length)return N[0];var Y=N[0],U=!0;for(let P=1;P<N.length;P++){if(!N[P])return null;if(Y!==N[P]){U=!1;break}}if(U)return Y;Y=this.c0e(N[0]);U=0;for(const P of N){N=this.c0e(P);if(Y.ma(Y.count-1)!==N.ma(N.count-1))return null;for(let aa=Y.count-2,X=N.count-2;aa>=U&&0<=X;aa--,X--)if(Y.ma(aa)!==N.ma(X)){U=aa+1;
break}}return Y.ma(U)}c0e(N){const Y=new b.a;for(;void 0!==N&&null!==N;N=N.parentNode)Y.add(N);return Y}V3e(N){switch(N){case n.a.pf:case n.a.a$:return 1;case n.a.Tf:case n.a.fha:return 2;case n.a.ve:case n.a.SGa:return 4;case n.a.CCc:case n.a.J_c:return 8}return 0}Rya(N,Y,U){N=this.V3e(N);Y=this.UWh(U);Hammer.inputHandler(this,N,Y);this.w8&&U.preventDefault();return this.w8}qaf(){return 1<this.JS.count}O2b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.$mb)for(let N of this.JS)this.mVf(N.key);
else this.JS=new h.a;this.session=null}EJg(N,Y,U){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",N);if(!this.ylb.hb(N)){try{Y.setPointerCapture(N)}catch(P){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",P)}this.ylb.add(N,Y)}this.JS.ia(N,U);this.jVa&&1<this.JS.count&&this.efa&&!this.efa.Jqb&&(this.efa.Jqb=!0)}mVf(N){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",N);if(this.ylb.hb(N)){try{this.ylb.ma(N).releasePointerCapture(N)}catch(Y){c.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",Y)}this.ylb.remove(N)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",N);this.JS.remove(N);this.jVa&&1>=this.JS.count&&this.efa&&this.efa.Jqb&&(this.efa.Jqb=!1)}Wpc(N,Y,U){var P=U.rawEvent.pointerType.toString();const aa=U.rawEvent.pointerId.toString();if("touch"!==P)return!1;N=this.V3e(N);if(1!==N&&!this.JS.hb(aa))return!1;this.m6d&&1===N&&U.rawEvent.isPrimary&&this.JS.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),
this.O2b());this.$mb?this.EJg(aa,Y,U):this.JS.ia(aa,U);this.VOc&&2===N&&(!this.oIc||this.oIc&&"function"===typeof U.rawEvent.getCoalescedEvents)&&(Y=U.rawEvent.getCoalescedEvents())&&this.qaf()&&(this.Hkb=Math.max(this.Hkb,Y.length));this.aie&&(this.w8=!1);P=this.TWh(this.JS,U,P);Hammer.inputHandler(this,N,P);if(4===N||8===N)this.$mb?this.mVf(aa):this.JS.remove(aa),this.JS.count||(this.session=null,this.VOc&&-1!==this.Hkb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",
this.Hkb),this.Hkb=-1));this.w8&&U.preventDefault();return this.w8}Hpc(){return!1}UWh(N){const Y=new y;var U=N.rawEvent;const P=U.touches;U=U.changedTouches;Y.pointers=Array.clone(P);Y.pointers=Array.clone(0<P.length?P:U);Y.changedPointers=Array.clone(U);Y.srcEvent=N;Y.pointerType="touch";return Y}TWh(N,Y,U){const P=new y;P.pointers=S.toArray(N.values);P.changedPointers=[Y];P.pointerType=U;P.srcEvent=Y;return P}Pri(N){return R.a.startsWith(N,n.a.pinch)}Gri(N){return R.a.startsWith(N,n.a.pan)}Nui(N){return R.a.startsWith(N,
n.a.swipe)}}Object(t.a)(G,"GestureInputManager",m.a,[405,406]);var D=a(280),E=a(252);class M{constructor(){this.$a=null;this.$w=!1}get name(){return"Common.App.GestureInputManager"}Ah(N){N.register(G,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").qc().yc(()=>new G(D.a.instance,v.AFrameworkApplication.ra.ED));this.$a=N}init(){this.$w||(this.$a.resolve("Common.App.GestureManager.GestureInputManager"),this.$w=!0)}dispose(){}static main(){E.a.instance.gi(new M)}}Object(t.a)(M,
"GestureInputManagerPackage",null,[4,5]);a.d(F,"a",function(){return L});const L=()=>{Type.registerNamespace("Common.App.GestureManager");M.main()}},1213:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(27),f=a(89),d=a(30),h=a(420),m=a(239);class l{}l.lvh="ewa-dv";l.mvh="ewa-dv-buttonarea";l.Duh="ewa-dlb";l.pDb="list-table";l.listItem="list-item";l.mDb="list-item-selected";l.qDb="list-table-touch";l.kvh="ewa-dpb";l.Nph="dv-prompt-title";l.Mph="dv-prompt-message";Object(t.a)(l,"CssClassNames",null,
[]);var v=a(31),r=a(746),A=a(19),x=a(49),n=a(430),u=a(68),z=a(7),w=a(15),C=a(157),y=a(837),B=a(37),H=a(13),I=a(21),R=a(267),S=a(71);class G extends C.ErrorDialog{constructor(Oa,oa,Ja){super(Oa,G.iQ(oa,Oa,Ja));this.Uc=()=>{this.setFocus()};I.h(this.$).ha.cC(this.Uc);(Oa=Oa.da.Aa(14).h4a(Ja))&&Oa.options&1&&w.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){I.h(this.$).ha.sB(this.Uc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var Oa=
4;break;case 1:Oa=3;break;case 2:Oa=0;break;default:Oa=this.fM}(Oa=this.getButton(Oa))?Oa.get_element().focus():super.setFocus()}Erb(){const Oa=I.h(this.$);Oa.fb&&Oa.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.qWd(1);if(2===this.returnValue||0===this.returnValue){const oa=Oa.Qb(null);if(oa){Oa.Ca.ZU();const Ja=Object(z.a)(new R.a,{Text:oa.originalText});Oa.setCell(Ja,oa.range,0,63,null)}this.$.Zc(-798660877,u.a.zb,8,null)}super.Erb()}Asa(){const Oa=
I.h(this.$);Oa.fb&&Oa.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.qWd(0);super.Asa()}qWd(Oa){const oa=I.h(this.$);B.TaskExtensions.za(oa.startEdit(!1,Oa),()=>{const Ja=oa.Vb.textBox;Ja.text&&Ja.selectRange(0,Ja.text.length)},this.la,11,S.a.current)}static iQ(Oa,oa,Ja){Ja=oa.da.Aa(14).h4a(Ja);Oa.MessageId=-1083021405;Oa.MessageIdName="DataValidationError";Oa.MessageIdHash=d.a.Yu(Oa.MessageIdName);Oa.Severity=Ja?Ja.M$c:1;oa=(null===Ja||void 0===
Ja?0:Ja.iJa)?d.a.yg(Ja.iJa):null;Ja=(null===Ja||void 0===Ja?0:Ja.error)?d.a.yg(Ja.error):String.format("<p>{0}</p><p>{1}</p>",H.a.instance.ga(894),H.a.instance.ga(895));switch(Oa.Severity){case 0:Oa.Appearance=18;break;case 1:Oa.Appearance=12;Ja+=String.format("<p>{0}</p>",H.a.instance.ga(896));break;default:Oa.Appearance=3}Oa.Caption=oa;Oa.Description=Ja;Oa.HelpDescription=H.a.instance.ga(1317);Oa.HelpTopicId=y.a.cKe;return Oa}}Object(t.a)(G,"DataValidationErrorDeprecatedDialog",C.ErrorDialog,[]);
C=a(285);var D=a(1105),E=a(5),M=a(41),L=a(284),N=a(196),Y=a(51),U=a(29),P=a(250),aa=a(1),X=a(11),Z=a(282),da=a(164);class qa extends C.a{constructor(Oa,oa,Ja){super(Oa);this.sU=this.uq=null;this.Hlf=!1;this.LW=this.Km=this.Ibf=this.errorMessage=null;this.dKe=Wb=>{const nc=this.$;var Yb=this.Hlf;this.hide();const pb=I.h(nc);pb.fb&&pb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Wb&&Yb&&B.TaskExtensions.za(pb.startEdit(!1,1),()=>{const Fa=pb.Vb.textBox;Fa.text&&
Fa.selectRange(0,Fa.text.length)},this.la,11,S.a.current);if(1===Wb&&!Yb){if(Yb=pb.Qb(null)){pb.Ca.ZU();const Fa=Object(z.a)(new R.a,{Text:Yb.cell.userInput});pb.setCell(Fa,Yb.range,0,63,null)}nc.Zc(-798660877,u.a.zb,8,null)}2===Wb&&B.TaskExtensions.za(pb.startEdit(!1,0),()=>{const Fa=pb.Vb.textBox;Fa.text&&Fa.selectRange(0,Fa.text.length)},this.la,11,S.a.current)};this.mDd=()=>{X.HelperMethods.GV(this.$.UF,this.error.HelpTopicId,this.$.gS)};this.jUi=()=>{this.Wyb();this.$.Zc(802602464,2,8,this.sU)};
this.HSi=()=>{w.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.ISi=Wb=>{!Wb||P.a(Wb)?w.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Wb=this.e2h(Wb.Result),this.uq.errorInformation=Wb,this.aUa(this.iJa,this.P4a(this.dKe),this.uq))};this.UCd=()=>{this.show(this.ZSb)};this.xQe=Ja;this.sqmManager=da.a(this.$);
this.error=qa.iQ(oa,Oa,Ja);this.qb.Ro=this;this.iJa=(this.Yv=Oa.da.Aa(14).h4a(this.xQe))&&this.Yv.iJa?this.Yv.iJa:H.a.instance.ga(1733);this.Lxj();this.initializeAndShow(this.iJa,this.dKe,this.uq)}get kc(){return"DataValidationErrorDialog"}dispose(){this===this.qb.Ro&&(this.qb.Ro=null);f.a.Ja(this.Km);this.Km=null;super.dispose()}Lxj(){var Oa,oa,Ja;this.Yv&&this.Yv.options&1?(w.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=null!==(Oa=this.Yv.error)&&void 0!==Oa?Oa:H.a.instance.ga(1735),this.Ibf=Y.a.current.lo(119)):(this.errorMessage=null!==(Ja=null===(oa=this.Yv)||void 0===oa?void 0:oa.error)&&void 0!==Ja?Ja:H.a.instance.ga(1734),this.OSh(this.xQe));Oa=this.Yv?this.Yv.M$c:1;this.uq={[qa.it]:this.kc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Ibf};switch(Oa){case 0:this.Ob=1;this.tc(1,"Retry");this.uq.dialogIcon=2;this.Hlf=!0;break;case 1:this.Ob=4;this.uq.dialogIcon=1;this.uq.additionalInformation=
H.a.instance.ga(896);break;default:this.Ob=1,this.uq.dialogIcon=3}this.uq.helpLink={["type"]:"AppLinkProps",[qa.it]:this.error.HelpTopicId,["text"]:H.a.instance.ga(1317),["handler"]:this.mDd};Oa=U.a.XYc([this.error]);this.sU={[E.a.z$b]:!0,[E.a.Ubd]:Oa,[E.a.Vbd]:da.a(this.$).rub(this.error.MessageIdHash),[E.a.sM]:this.kc,["DismissHandler"]:this.UCd};this.uq.giveFeedbackLink={["type"]:"AppLinkProps",[qa.it]:E.a.Ujd,["text"]:H.a.instance.ga(1772),["handler"]:this.jUi}}OSh(Oa){const oa=this.$.oa.xa.Wb();
L.g(this.$.oa.xa,M.q(Oa,this.$),Z.b(this.ISi),Z.a(this.HSi),null,oa)}e2h(Oa){let oa;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");w.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${D.a[Oa.RuleType].toString()}`);switch(Oa.RuleType){case 1:switch(Oa.ConditionType){case 0:return oa=H.a.instance.ob(108),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 1:return oa=H.a.instance.ob(109),
String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 2:return oa=H.a.instance.ob(110),String.format(oa,Oa.LowerBoundary);case 3:return oa=H.a.instance.ob(111),String.format(oa,Oa.LowerBoundary);case 4:return oa=H.a.instance.ob(112),String.format(oa,Oa.LowerBoundary);case 5:return oa=H.a.instance.ob(113),String.format(oa,Oa.UpperBoundary);case 6:return oa=H.a.instance.ob(114),String.format(oa,Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(115),String.format(oa,Oa.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(Oa.ConditionType){case 0:return oa=
H.a.instance.ob(116),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 1:return oa=H.a.instance.ob(117),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 2:return oa=H.a.instance.ob(118),String.format(oa,Oa.LowerBoundary);case 3:return oa=H.a.instance.ob(119),String.format(oa,Oa.LowerBoundary);case 4:return oa=H.a.instance.ob(120),String.format(oa,Oa.LowerBoundary);case 5:return oa=H.a.instance.ob(121),String.format(oa,Oa.UpperBoundary);case 6:return oa=H.a.instance.ob(122),String.format(oa,
Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(123),String.format(oa,Oa.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(Oa.ConditionType){case 0:return oa=H.a.instance.ob(124),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 1:return oa=H.a.instance.ob(125),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 2:return oa=H.a.instance.ob(126),String.format(oa,Oa.LowerBoundary);case 3:return oa=H.a.instance.ob(127),String.format(oa,Oa.LowerBoundary);case 4:return oa=
H.a.instance.ob(128),String.format(oa,Oa.LowerBoundary);case 5:return oa=H.a.instance.ob(129),String.format(oa,Oa.UpperBoundary);case 6:return oa=H.a.instance.ob(130),String.format(oa,Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(131),String.format(oa,Oa.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(Oa.ConditionType){case 0:return oa=H.a.instance.ob(132),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 1:return oa=H.a.instance.ob(133),String.format(oa,Oa.LowerBoundary,
Oa.UpperBoundary);case 2:return oa=H.a.instance.ob(134),String.format(oa,Oa.LowerBoundary);case 3:return oa=H.a.instance.ob(135),String.format(oa,Oa.LowerBoundary);case 4:return oa=H.a.instance.ob(136),String.format(oa,Oa.LowerBoundary);case 5:return oa=H.a.instance.ob(137),String.format(oa,Oa.UpperBoundary);case 6:return oa=H.a.instance.ob(138),String.format(oa,Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(139),String.format(oa,Oa.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(Oa.ConditionType){case 0:return oa=
H.a.instance.ob(140),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 1:return oa=H.a.instance.ob(141),String.format(oa,Oa.LowerBoundary,Oa.UpperBoundary);case 2:return oa=H.a.instance.ob(142),String.format(oa,Oa.LowerBoundary);case 3:return oa=H.a.instance.ob(143),String.format(oa,Oa.LowerBoundary);case 4:return oa=H.a.instance.ob(144),String.format(oa,Oa.LowerBoundary);case 5:return oa=H.a.instance.ob(145),String.format(oa,Oa.UpperBoundary);case 6:return oa=H.a.instance.ob(146),String.format(oa,
Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(147),String.format(oa,Oa.UpperBoundary);default:return"we couldn't get the details"}case 3:return oa=H.a.instance.ob(106),String.format(oa,Oa.LowerBoundary);case 7:return oa=H.a.instance.ob(107),String.format(oa,Oa.LowerBoundary);default:return"we couldn't get the details"}}qWd(Oa){const oa=I.h(this.$);B.TaskExtensions.za(oa.startEdit(!1,Oa),()=>{const Ja=oa.Vb.textBox;Ja.text&&Ja.selectRange(0,Ja.text.length)},this.la,11,S.a.current)}get la(){this.Km=
this.Km||new N.a;return this.Km.token}static iQ(Oa,oa,Ja){oa=oa.da.Aa(14).h4a(Ja);Oa.MessageId=-1083021405;Oa.MessageIdName="DataValidationError";Oa.MessageIdHash=d.a.Yu(Oa.MessageIdName);Oa.Severity=oa?oa.M$c:1;Oa.HelpDescription=H.a.instance.ga(1317);Oa.HelpTopicId=y.a.cKe;return Oa}}Object(t.a)(qa,"DataValidationErrorDialog",C.a,[78,79,2,80]);C=a(930);var O=a(386);class ca extends C.a{constructor(Oa,oa,Ja){super(Oa,oa);this.dataValidationControl=Ja}get rAb(){return Object(h.a)(qa,this.$.qb.$g)}get $J(){return this.dataValidationControl.re}set $J(Oa){this.dataValidationControl.re=
Oa}get U5a(){return!1}get key(){return O.a.v7c}dispose(){this.dataValidationControl=null;super.dispose()}Mh(Oa,oa){this.dataValidationControl.eb=this.eb;const Ja=Oa.keyCode;return 1461300262!==oa||16!==Ja&&17!==Ja&&18!==Ja?super.Mh(Oa,oa):!1}bCd(){this.$J&&(this.dataValidationControl.eb=this.eb,this.dataValidationControl.show(this.dataValidationControl.WM,!0,!0,e.a.cp||3===u.a.zb))}$f(){}Ri(){this.dataValidationControl.show(this.dataValidationControl.WM,!0,!0,e.a.cp||3===u.a.zb)}yId(Oa,oa){return this.dataValidationControl.Mh(oa)}}
Object(t.a)(ca,"DataValidationListAutoCompleteBehavior",C.a,[]);var wa=a(268);C=a(856);var ia=a(12),Ha=a(116),Sa=a(22),Da=a(929);class ea extends C.a{constructor(Oa,oa,Ja,Wb){super(Oa,oa,new Da.a(l.listItem,l.mDb,l.pDb,l.qDb));this.xIa=this.qV=this.Jda=this.ee=this.kmb=null;this.PNa=0;this.eHb=[];this.f_j=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.oDb=Ja;this.htmlSanitizationHelper=Wb}get Ej(){return this.kmb}set Ej(Oa){this.yBa(this.kmb);
if(Oa){this.kmb=Oa;this.oDb.innerText="";this.yBa(this.kmb);const oa=this.eHb[Oa.rowIndex];this.ee=this.qV[oa];this.xIa&&(this.Jda=this.xIa[oa],w.ULS.shipAssertTag(537163286,0,!this.eHb.length||!!this.Jda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.oDb.innerText=this.ee;this.Owc(Oa)}else this.Jda=this.ee=null}get fb(){return I.h(this.$).fb}get editText(){return I.h(this.$).Vb.text}dispose(){super.dispose();this.oDb=this.kmb=null}wea(Oa,oa,Ja,Wb){if(Oa&&
(!Oa||Oa.length)){this.q7(!1);this.xIa=Oa;this.qV=[];for(var nc=0;nc<Oa.length;nc++)this.qV[nc]=Oa[nc]?Oa[nc].Name:null;nc=`<table class='${this.p5}' aria-live='polite'><tbody>`;var Yb="",pb="";Oa=0;var Fa=I.h(this.$).Qb(null);Wb=this.fb?Wb?Wb.text:this.editText:Fa?Fa.originalText:null;Fa=!Wb;var ab=0;this.eHb.length=0;var Gb=[],Ga=[],Ma=[],Qa=Wb?Wb.split(" "):[""];Wb=Wb.trim();for(let Na=0;Na<this.qV.length;Na++){const ya=this.qV[Na];var wb=void 0;const nb=ya.split(" ");wb=wa.a.all(Qa,cb=>wa.a.any(nb,
La=>Sa.a.KF(La,cb)));const vb=!ya,gb=Ma.includes(ya);vb||gb||this.fb&&!wb||(wb=ya?d.a.yg(d.a.U9c(ya)):"",wb=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.pV,wb),Ma.push(ya),this.fb&&Sa.a.KF(ya,Wb)?(Yb+=wb,Gb.push(Na)):(pb+=wb,Ga.push(Na)),!Fa&&Sa.a.equals(Wb,ya,!0)&&(Oa=this.fb?Gb.length-1:ab,Fa=!0),ab++)}this.PNa=ab;this.eHb.push(...Gb);this.eHb.push(...Ga);nc+=Yb+pb+"</tbody></table>";aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(this.Df,nc):this.Df.innerHTML=nc;nc=this.vn=ia.DOMElementExtensions.$j(this.domElement,this.p5);this.Vnb(nc,oa);this.q7(!0);this.Ura(oa,Ja);this.Ej=0<this.PNa?nc.rows[Oa]:null}}NRa(Oa){var oa=!1;this.fb&&Oa&&(oa=!this.PNa,Oa.endEdit(oa,"DataValidationListBox.SetCellContent",0));if(!oa&&(Oa=I.h(this.$),oa=Oa.Qb(null))){let Wb=null;if(this.Jda&&-1!==this.Jda.SheetId&&-1!==this.Jda.Row&&-1!==this.Jda.Column){var Ja={};Ja.SheetName=this.Jda.SheetId.toString();
Ja.FirstRow=this.Jda.Row;Ja.FirstColumn=this.Jda.Column;Wb={ParameterType:6};Wb.SourceRange=Ja}Ja=Object(z.a)(new R.a,{Text:this.ee});Oa.setCell(Ja,oa.range,0,63,Wb)}return!0}Ura(Oa,oa){const Ja=Oa?this.iEb:this.HH;Oa=Oa?this.ulc:this.vlc;0>=this.PNa?this.Df.style.height=X.HelperMethods.sc(Oa):(this.Df.style.height="auto",this.PNa>Ja?(ia.DOMElementExtensions.vI(this.Df,this.f_j?Math.floor(Oa*Ja):Math.floor(this.Df.offsetHeight*Ja/this.PNa)),this.Df.style.overflowY="auto"):(this.Df.style.height="auto",
this.Df.style.overflowY="hidden"));ia.DOMElementExtensions.Hv(this.Df,oa);ia.DOMElementExtensions.Hv(this.vn,oa-(this.PNa>Ja?Ha.a.Bu:0))}}Object(t.a)(ea,"DataValidationListBox",C.a,[]);var sa=a(117),Ea=a(255),ba=a(258),ka=a(1114);const Ca=`<p class='${l.Nph}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,db=`<p class='${l.Mph}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var yb=A.a.WRe,kb=A.a.WRe,mb=A.a.x5g;class W extends m.a{constructor(Oa,oa){super(document.createElement("div"));
this.m2b=this.pQ=this.QQ=!1;this.Oh=this.Ch=null;this.xni=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.yni=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.kpd=this.dsd=this.krd=!1;this.Q6b=[];this.htmlSanitizationHelper=null;this.Eh=()=>{this.w9f(!1)};this.XOa=(Ja,Wb)=>{this.show(this.WM,!this.re,!0,e.a.cp||3===Wb.ub||3===u.a.zb);this.FCd(null,null)};this.FCd=()=>{this.gridView.setFocus()};this.LLa=()=>{this.eb.textBox.XE=
!0};this.zt=()=>{this.Vjg()};this.onContentReady=()=>{this.w9f(this.re)};this.uc=()=>{this.Vx()};this.Oya=()=>{this.NRa()};this.gCf=()=>{this.Vjg()};this.$=Oa;this.gridView=I.h(this.$);this.zI=this.gridView.Vb;this.htmlSanitizationHelper=oa;oa="<div id='dv_reader_description' class='"+v.a.mSe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+l.mvh+" "+A.a.eo+"'></div>\r\n<div id='dv_list_box' class='"+l.Duh+" "+A.a.fo+" "+A.a.eo+"'></div>\r\n<div id='dv_prompt_box' class='"+
l.kvh+" "+A.a.eo+"'></div>";this.domElement.className=l.lvh;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(this.domElement,oa):this.domElement.innerHTML=oa;Ea.d(this.style,this.isGridRtl);this.Df=$get("dv_list_box",this.domElement);this.YV=$get("dv_prompt_box",this.domElement);this.usa=$get("dv_list_button",
this.domElement);this.oDb=$get("dv_reader_description",this.domElement);(oa=sa.a(Oa))&&this.Q6b.push(new ca(Oa,oa,this));this.Q6b.push(new ca(Oa,this.gridView.Vb,this));this.gridView.ha.wG(this.Eh);this.gridView.Uu(this.onContentReady);this.gridView.mc.nMg(this.gCf);this.$.nj(this.uc);oa=this.gridView.pj;oa.insertBefore(this.domElement,oa.firstChild);this.onContentReady(null,null);Oa.da.Ha(14,this)}get aCb(){return!!(this.$.qd&16)}get wvi(){return this.re||this.WM||this.xwa}get re(){return ia.DOMElementExtensions.isVisible(this.Df)}set re(Oa){ia.DOMElementExtensions.setVisible(this.Df,
Oa)}get WM(){return ia.DOMElementExtensions.isVisible(this.YV)}set WM(Oa){ia.DOMElementExtensions.setVisible(this.YV,Oa)}get xwa(){return ia.DOMElementExtensions.isVisible(this.usa)&&!!this.Ch&&ia.DOMElementExtensions.isVisible(this.Ch.domElement)}set xwa(Oa){ia.DOMElementExtensions.setVisible(this.usa,Oa);this.Ch&&ia.DOMElementExtensions.setVisible(this.Ch.domElement,Oa)}get eb(){return this.zI}set eb(Oa){this.zI=Oa}get n5a(){return!!this.activeCell&&this.W8c(this.activeCell.range)}get activeCell(){return this.gridView.Qb(null)}get bbf(){return this.n5a&&
!!this.Yv&&!!(this.Yv.options&2)&&!!this.Yv.prompt}get vyb(){return this.n5a&&!!this.Yv&&!!(this.Yv.options&1)}get isGridRtl(){return this.gridView.rtl}get Yv(){return this.h4a(this.activeCell.range)}get GOa(){const Oa=this.activeCell;return Oa?this.sva(this.gridView,Oa):null}dispose(){this.$&&(this.$Nb(!1),this.gridView.ha.EK(this.Eh),this.gridView.jy(this.onContentReady),this.gridView.mc.hjj(this.gCf),this.$.ol(this.uc));this.rIe(!1);this.sIe(!1);f.a.pc(this.Q6b);this.Q6b=this.usa=this.Df=this.YV=
this.zI=this.gridView=this.$=null;super.dispose()}W8c(Oa){return!!this.h4a(Oa)}psb(Oa,oa){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new qa(this.$,Oa,oa):new G(this.$,Oa,oa)}h4a(Oa){Oa=this.gridView.getRangeInformation(Oa);for(let oa=0;oa<Oa.length;oa++){const Ja=Oa[oa];if(Object(h.a)(n.DataValidationRange,Ja))return Ja}return null}LOh(){if(!this.n5a)return"";const Oa=this.bbf?`${this.Yv.GPf} ${this.Yv.prompt}`:"",oa=this.vyb?H.a.instance.ga(841):
"";return String.format(H.a.instance.ob(17),Oa,oa)}Mh(Oa){let oa=!1;if(this.re||(-569786022===Oa||541421805===Oa)&&this.vyb||1872288872===Oa&&this.WM)switch(Oa){case -569786022:case 541421805:this.show(this.WM,!this.re,!0,e.a.cp||3===u.a.zb);oa=!0;break;case 1872288872:this.re?(this.show(this.WM,!1,!0,!1),oa=!0):this.WM?(this.show(!1,!1,!0,!1),oa=!0):this.eb&&(this.eb.endEdit(!1,"DataValidationControl.HandleKeyDown",0),oa=!0);break;case -798660877:this.Oh.dB(1);oa=!0;break;case 137938150:this.Oh.dB(-1);
oa=!0;break;case 2091832999:this.Oh.dB(this.Oh.HH-1);oa=!0;break;case 742457698:this.Oh.dB(-(this.Oh.HH-1));oa=!0;break;case 125627505:case 267796030:oa=this.NRa()}return oa}show(Oa,oa,Ja,Wb){this.Vx();if(this.aCb&&this.n5a){var nc=this.GOa;if(nc){if(Oa||oa||Ja)this.isVisible=!0;Ea.d(this.style,this.isGridRtl);Ja&&this.vyb&&(this.sIe(!0),this.Mjg(nc,!1));oa&&this.vyb&&this.zSa(Wb,nc);Oa&&this.bbf&&this.AJj(nc);this.wvi||(this.isVisible=!1)}}}sva(Oa,oa){if(!oa||!oa.cell.uk)return null;var Ja=this.gridView.mc.textBox.domElement;
var Wb=0<ia.DOMElementExtensions.getHeight(Ja)&&0<ia.DOMElementExtensions.getWidth(Ja)&&0<=Ja.offsetTop&&0<=Ja.offsetLeft;if(Wb)Ja=ia.DOMElementExtensions.sva(Ja,Oa.pj);else{Ja=Oa.getCellBounds(oa.cell);var nc=ia.DOMElementExtensions.getBoundingClientRect(Oa.pj);Ja=new Sys.UI.Bounds(Ja.x-nc.x,Ja.y-nc.y,Ja.width,Ja.height)}if(Ja)if(Wb)2<Ja.height&&2<Ja.height&&(Ja.x+=1,Ja.y+=1,Ja.height-=2,Ja.width-=2);else if(Wb=I.h(this.$).GJ(oa.cell))Wb=Wb.width+1,nc=Sa.a.equals(ba.a.Bwb(oa.cell,Oa.rtl),"right",
!0),Oa.rtl&&nc&&(Ja.x=Ja.x+Ja.width-Wb),oa.Eba&&Oa.rtl===nc&&(Ja.width=Wb);else return null;return Ja}w9f(Oa){const oa=this.n5a;this.$Nb(oa);oa?this.show(!0,Oa,!0,!1):this.Vx()}NRa(){let Oa=!1;this.re&&(Oa=this.Oh.NRa(this.eb),this.show(this.WM,!1,!0,!1));return Oa}Vx(){this.xni?(this.re&&(this.re=!1),this.xwa&&(this.xwa=!1),this.WM&&(this.WM=!1),this.isVisible&&(this.isVisible=!1)):this.re=this.xwa=this.WM=this.isVisible=!1;this.krd=this.kpd=this.dsd=!1}zSa(Oa,oa){this.vyb&&!this.Yv.xIa?this.xwa&&
this.Ch.disable():(this.rIe(!0),this.Oh.wea(this.Yv.xIa,Oa,this.$Xh(oa),this.eb),this.QBa(oa,!1))}AJj(Oa){this.Yv.prompt&&(this.WM=!0,this.$0j(this.Yv.GPf,this.Yv.prompt),this.gkg(Oa,!1))}Mjg(Oa,oa){const Ja=Oa.y;this.usa.style.top=X.HelperMethods.sc(Ja);Oa=this.isGridRtl?Oa.x-this.usa.offsetWidth+1:Oa.x+Oa.width+1;this.usa.style.left=X.HelperMethods.sc(Oa);oa?this.xwa=this.gridView.dkc(new x.a(Oa,Ja))&&this.kpd:this.kpd=!0}QBa(Oa,oa){const Ja=Oa.y+Oa.height;Oa=this.isGridRtl?Oa.x+Oa.width-this.Df.offsetWidth:
Oa.x;this.Df.style.top=X.HelperMethods.sc(Ja);this.Df.style.left=X.HelperMethods.sc(Oa);oa?this.re=this.gridView.dkc(new x.a(Oa,Ja))&&this.krd:this.krd=!0}gkg(Oa,oa){const Ja=Oa.y+Oa.height+5;var Wb=this.activeCell;Wb=Wb?Wb.width/2:32;Oa=this.isGridRtl?Oa.x-this.YV.offsetWidth+Wb:Oa.x+Oa.width-Wb;this.YV.style.top=X.HelperMethods.sc(Ja);this.YV.style.left=X.HelperMethods.sc(Oa);oa?this.WM=this.gridView.dkc(new x.a(Oa,Ja))&&this.dsd:this.dsd=!0}$0j(Oa,oa){if(oa){var Ja="";Oa&&(Ja+=String.format(Ca,
d.a.yg(Oa)));Ja+=String.format(db,d.a.yg(oa));aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(this.YV,Ja):this.YV.innerHTML=Ja;Oa=ia.DOMElementExtensions.$j(this.YV,"dv-prompt-titletext");if(oa=ia.DOMElementExtensions.$j(this.YV,"dv-prompt-messagetext")){Oa=Oa?parseInt(String(Math.max(Oa.offsetWidth,oa.offsetWidth)),
10):oa.offsetWidth;Oa+=6;ia.DOMElementExtensions.Hv(this.YV,Oa);for(let Wb=0,nc=this.YV.children.length;Wb<nc;Wb++)ia.DOMElementExtensions.Hv(this.YV.children[Wb],Oa)}}}$Xh(Oa){return this.yni?Oa.width+17-2+1:Oa.width+this.usa.clientWidth-2+1}sIe(Oa){this.$&&!this.aCb||!Oa?(this.Bcg(!1),f.a.Ja(this.Ch),this.Ch=null):(this.Ch||(this.Ch=new ka.a(this.usa,yb,r.a.$ha,1,kb,H.a.instance.ga(893),mb,H.a.instance.ga(892),"",-1),this.Bcg(!0)),this.xwa=!0,this.Yv.xIa?this.Ch.isEnabled||this.Ch.enable():this.Ch.disable())}rIe(Oa){this.$&&
!this.aCb||!Oa?(this.gTa(!1),f.a.Ja(this.Oh),this.Oh=null):(this.Oh||(this.Oh=new ea(this.$,this.Df,this.oDb,this.htmlSanitizationHelper),this.gTa(!0)),this.re=!0)}gTa(Oa){this.Oh&&(Oa&&!this.QQ?(this.Oh.s9(this.FCd),this.Oh.z_b(this.LLa),this.Oh.qob(this.Oya),this.QQ=!0):!Oa&&this.QQ&&(this.Oh.rda(this.FCd),this.Oh.Duc(this.LLa),this.Oh.SJb(this.Oya),this.QQ=!1))}$Nb(Oa){Oa&&!this.pQ?(this.gridView.view.Ps(this.zt),this.pQ=!0):!Oa&&this.pQ&&(this.gridView.view.Jq(this.zt),this.pQ=!1)}Bcg(Oa){this.Ch&&
(Oa&&!this.m2b?(this.Ch.aXc(this.XOa),this.Ch.lXc(this.XOa),this.Ch.bob(this.LLa),this.m2b=!0):!Oa&&this.m2b&&(this.Ch.NLd(this.XOa),this.Ch.ZLd(this.XOa),this.Ch.EJb(this.LLa),this.m2b=!1))}Vjg(){if(this.n5a){var Oa=this.GOa;Oa&&(this.Mjg(Oa,!0),this.QBa(Oa,!0),this.gkg(Oa,!0))}}}Object(t.a)(W,"DataValidationControl",m.a,[248,2]);var Q=a(50),va=a(55);class na extends b.a{constructor(Oa){super();this.$=Oa;this.Db()}create(){const Oa=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?Q.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):va.Task.Ra(null);B.TaskExtensions.za(Oa,()=>{this.nb(this.$.da.Aa(14)||new W(this.$,Oa.result))},this.la,3)}}Object(t.a)(na,"DataValidationControlFactory",b.a,[]);a.d(F,"a",function(){return Ba});const Ba=()=>{c.a.Fa(Oa=>{Oa.da.Ha(150,new na(Oa))})}},1239:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(15),f=a(191);const d={selectByArrowKeyCounter:0,
selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},h={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},m={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,
argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},l={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},v={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},r={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,
argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},A={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0,uILocale:void 0,dataLocale:void 0,country:void 0};var x;(function(L){L.RenderDown=
"rd";L.RenderUp="ru";L.Expand="e";L.Collapse="c";L.Drag="d";L.Move="m";L.GiveFeedback="gf";L.InitialModeExpanded="ie";L.InitialModeCollapsed="ic";L.LearnMore="lm"})(x||(x={}));Object(t.b)("argumentAssistanceUsageActions",x);var n=a(59),u=a(1115),z=a(1),w=a(22),C=a(39),y=a(21),B=a(100),H;(function(L){L[L.function=3]="function";L[L.namedRange=100]="namedRange";L[L.tableHeader=101]="tableHeader";L[L.letVariable=102]="letVariable";L[L.richEntity=103]="richEntity";L[L.lambda=104]="lambda";L[L.customFunction=
105]="customFunction";L[L.table=106]="table";L[L.tableSpecialStructRef=107]="tableSpecialStructRef";L[L.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";L[L.rangeRef=109]="rangeRef"})(H||(H={}));Object(t.b)("CompletionItemKind",H);var I=a(33),R=a(857),S=a(966);const G={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,
170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class D{constructor(L){this.$=L;this.BH=null;this.XCb=-1;this.alc=null;this.clc=0;this.hP=Object.assign({},m);this.XG=Object.assign({},l);this.aJ=Object.assign({},d);this.Jpb=Object.assign({},h);this.Iac=Object.assign({},v);this.IR=Object.assign({},A);this.Kpb={};this.E3a=Object.assign(Object.assign({},r),{isReactDialog:I.a.qkf()});this.fpb=[];this.zGa=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");
this.hIa={};this.$f=(N,Y)=>{null!=this.BH&&(1==Math.abs(this.XCb-this.$.ea.se)&&(N=this.$.va.na.sheetId,Y.Hrb&&Y.Yj.equals(this.BH.Yj)&&this.alc===N&&this.BH.e3b!==Y.e3b&&this.clc++),1<=Math.abs(this.XCb-this.$.ea.se)&&(this.BH=null,this.XCb=-1,this.alc=null));z.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&0<Object.keys(this.hIa).length&&(e.ULS.sendTraceTag(509658956,0,50,`FormulaAssistanceTelemetryManager.onEditEnded: current edit's completion items data: ${JSON.stringify(this.hIa)}`),
this.hIa={})};this.uc=(N,Y)=>{Y.Bf||Y.cqd||(this.iBj(),this.sBj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.yab=new B.a;L.nj(this.uc);y.h(this.$).li.Jm(this.$f)}dispose(){this.$&&y.h(this.$).li.$l(this.$f)}BD(L){L.forEach(N=>{this.yab.hb(N)||this.yab.ia(N,new u.a(G[N]));this.yab.ma(N).YSa()})}dw(L,N=!0){L.forEach(Y=>{this.yab.hb(Y)&&this.yab.ma(Y).u3(N)})}z3f(L){this.VI(0===L?"ie":"ic")}Iwj(L){this.VI(L?"ie":"ic")}y3f(){this.hP.argumentAssistanceCardIsInitialModeDefault=
!0}dua(L){window.requestAnimationFrame(()=>{this.dw([L])})}OXf(L){L.forEach(N=>{N=H[N.kind];this.mmg(N);this.Kpb[N].shownCounter++;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.hIa[N].shownCounter++})}NXf(L){L=H[L];this.mmg(L);this.Kpb[L].committedCounter++;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.hIa[L].committedCounter++}VI(L){if(this.zGa){const N=this.fpb.length;0===N||this.fpb[N-1][0]!==L?this.fpb.push([L,
1]):this.fpb[N-1][1]++}else switch(L){case "e":this.hP.argumentAssistanceExpandCounter++;break;case "c":this.hP.argumentAssistanceCollapseCounter++;break;case "d":this.hP.argumentAssistanceDragCounter++;break;case "m":this.hP.argumentAssistanceMoveCounter++;break;case "lm":this.hP.argumentAssistanceLearnMoreCounter++;break;case "ie":this.hP.argumentAssistanceCardInitialMode="Expanded";break;case "ic":this.hP.argumentAssistanceCardInitialMode="Collapsed"}}getJsonForLogging(){return"{"+this.iM("SessionDetails",
this.IR)+","+this.iM("ArgumentAssistanceUsage",this.hP)+","+this.iM("argumentAssistanceOrderedActions",this.fpb)+","+this.iM("FormulaSuggestionsUsage",this.XG)+","+this.iM("FunctionDialogUsage",this.E3a)+","+this.iM("AutocompleteCardInteraction",this.aJ)+","+this.iM("AutocompleteRenderOptimization",this.Jpb)+","+this.iM("AutocompleteUsageByKind",this.Kpb)+","+this.iM("FormulaHighlightsUsage",this.Iac)+","+this.L2h()+"}"}sBj(){this.XG.smartSuggestionKeptCounter=this.XG.smartSuggestionCommittedCounter-
this.clc;for(let L=0;L<this.XG.smartSuggestionKeptCounter;L++)Object(R.a)(S.b)}iBj(){this.IR.argumentAssistanceFlight=this.gva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.IR.autoCompleteUIFlight=this.gva("Microsoft.Office.Excel.","AutoCompleteNewUI");this.IR.smartFormulaBarAutoCompleteFlight=this.gva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.IR.smartFormulaBarAutoCompletePluginFlight=this.gva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");
this.IR.formulaAssistanceRedesignFlight=this.gva("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.IR.NewInsertFunctionDialogFlight=this.gva("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.IR.coloredReferencesFlight=this.gva("Microsoft.Office.Excel.","ColoredReferences");this.IR.parenthesesCouplingFlight=this.gva("Microsoft.Office.Excel.","ParenthesesCoupling");this.IR.smartFormulaSuggestionsFeatureEnabled=I.a.AMa(this.$);this.IR.uILocale=this.$.UTa;this.IR.dataLocale=this.$.dataCultureTag;
this.IR.country=JSON.parse(this.$.ya.SessionStartInfoJson).LocationCountry}L2h(){const L=new f.a;for(let N of this.yab)N.value.CXe(),L.add(`"${N.key}":${n.a.Dc(N.value.MV)}`);return`"PerfMeasurements": {${L.toArray().join(",")}}`}gva(L,N){return w.a.contains(this.$.ya.FlightHolder.FlightId,N,!0)?z.EwaSettings.getBooleanFeatureGate(L+N,!1)?"T":"C":"None"}iM(L,N){return`"${L.toString()}":${C.c(N)}`}mmg(L){this.Kpb[L]||(this.Kpb[L]={shownCounter:0,committedCounter:0});z.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&
!this.hIa[L]&&(this.hIa[L]={shownCounter:0,committedCounter:0})}}Object(t.a)(D,"FormulaAssistanceTelemetryManager",null,[253]);class E extends b.a{constructor(L){super();this.$=L;this.Db()}static ka(L){L.da.Ha(492,new E(L))}create(){var L;this.nb(null!==(L=this.$.da.Aa(491))&&void 0!==L?L:this.$.da.Ha(491,new D(this.$)))}}Object(t.a)(E,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(F,"a",function(){return M});const M=()=>{c.a.Fa(L=>{E.ka(L)})}},1243:function(t,F,a){a.r(F);t=a(0);var c=a(15),
b=a(280),e=a(95),f=a(40),d=a(268),h=a(547),m=a(4),l=a(84),v=a(420),r=a(734),A=a(8),x=a(31),n=a(19),u=a(63),z=a(5),w=a(801),C=a(1068),y=a(855),B=a(13),H=a(33);class I{constructor(Fa,ab,Gb,Ga,Ma,Qa,wb,Na){this.$=ab;this.Va=Gb;this.ql=Ga;this.selectedRanges=Ma;this.grid=Qa;this.ty=Na;this.s4=wb;this.Pga=d.a.all(Ma,ya=>ya.isRow);this.Xra=d.a.all(Ma,ya=>ya.Rg);this.bFb=d.a.all(Ma,ya=>!ya.isRow&&!ya.Rg);ab=Qa.wb.djd(Ma);this.vsb=!!ab;this.HXf=!!ab&&ab.hasActiveFilter;this.menuSection=Gb.Ec();Fa.rc.push(this.menuSection);
this.mba=this.Pga||this.Xra?this.menuSection:Gb.Ec();this.Cta=this.Pga||this.Xra?this.menuSection:Gb.Ec()}ned(){this.ZLh();this.BLh();const Fa=this.ty.Bjc(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(Fa?149:148))}eMh(){let Fa=0;this.vsb?this.s4.um(942362098)?Fa=this.ty.um(this.ql,942362098,this.selectedRanges,this.grid)?161:169:this.HXf&&(Fa=this.ty.um(this.ql,-1113896058,this.selectedRanges,this.grid)?177:181):this.s4.um(-1113896058)&&(Fa=this.Pga?this.ty.um(this.ql,-1113896058,
this.selectedRanges,this.grid)?49:116:this.ty.um(this.ql,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Fa&&this.mba.buttons.push(this.Va.pb(Fa))}dMh(){let Fa;!this.vsb&&this.s4.um(-1113896058)&&(Fa=this.Pga?this.ty.um(this.ql,-1113896058,this.selectedRanges,this.grid)?295:296:this.ty.um(this.ql,-1113896058,this.selectedRanges,this.grid)?297:298,this.mba.buttons.push(this.Va.pb(Fa)))}$Lh(){let Fa=0;this.vsb?this.s4.um(622604322)&&(Fa=this.grid.rtl?this.ty.um(this.ql,622604322,this.selectedRanges,
this.grid)?191:192:this.ty.um(this.ql,622604322,this.selectedRanges,this.grid)?162:170):this.s4.um(1415868706)&&(Fa=this.Xra?this.ty.um(this.ql,1415868706,this.selectedRanges,this.grid)?50:117:this.ty.um(this.ql,1415868706,this.selectedRanges,this.grid)?178:182);0!==Fa&&this.mba.buttons.push(this.Va.pb(Fa))}YLh(){this.s4.um(1035996630)&&(this.ty.um(this.ql,1035996630,this.selectedRanges,this.grid)?(this.mba.buttons.push(this.Va.pb(this.grid.rtl?187:165)),this.mba.buttons.push(this.Va.pb(166))):(this.mba.buttons.push(this.Va.pb(this.grid.rtl?
188:173)),this.mba.buttons.push(this.Va.pb(174))))}ZLh(){const {GridContextMenu:Fa}=a(1243);let ab=null;this.bFb&&(ab=this.Va.Xv("ContextMenu.InsertCells",null,B.a.instance.ga(344),1896159024),ab.menu.rc.push(this.mba));Fa.aMh(this.mba,this.Va,this.$);this.eMh();m.AFrameworkApplication.Sp("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");H.a.ard()&&this.dMh();this.$Lh();this.YLh();ab&&0<this.mba.buttons.length&&this.menuSection.buttons.push(ab)}DLh(){let Fa=0;this.vsb?
this.s4.um(1405456548)?Fa=this.ty.um(this.ql,1405456548,this.selectedRanges,this.grid)?163:171:this.HXf&&(Fa=this.ty.um(this.ql,1554436520,this.selectedRanges,this.grid)?179:183):this.s4.um(1554436520)&&(Fa=this.Pga?this.ty.um(this.ql,1554436520,this.selectedRanges,this.grid)?51:118:this.ty.um(this.ql,1554436520,this.selectedRanges,this.grid)?179:183);0!==Fa&&this.Cta.buttons.push(this.Va.pb(Fa))}CLh(){let Fa=0;this.vsb?this.s4.um(284490184)&&(Fa=this.ty.um(this.ql,284490184,this.selectedRanges,this.grid)?
164:172):this.s4.um(674605324)&&(Fa=this.Xra?this.ty.um(this.ql,674605324,this.selectedRanges,this.grid)?52:119:this.ty.um(this.ql,674605324,this.selectedRanges,this.grid)?180:184);0!==Fa&&this.Cta.buttons.push(this.Va.pb(Fa))}ALh(){this.s4.um(1035996630)&&(this.ty.um(this.ql,1035996630,this.selectedRanges,this.grid)?(this.Cta.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.Cta.buttons.push(this.Va.pb(168))):(this.Cta.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.Cta.buttons.push(this.Va.pb(176))))}BLh(){let Fa=
null;this.bFb&&(Fa=this.Va.Xv("ContextMenu.DeleteCells",null,B.a.instance.ga(408),-1554384558),Fa.menu.rc.push(this.Cta));this.DLh();this.CLh();this.ALh();Fa&&0<this.Cta.buttons.length&&this.menuSection.buttons.push(Fa)}}Object(t.a)(I,"CellsContextMenuGenerator",null,[]);var R=a(784);class S{constructor(Fa){this.ranges=null;this.ranges=Fa}}Object(t.a)(S,"MacroRecorderRangeHyperlinkRemovedPayload",null,[122]);var G=a(525),D=a(24),E=a(103),M=a(68),L=a(77),N=a(41),Y=a(192),U=a(60),P=a(610),aa=a(140),
X=a(37),Z=a(460),da=a(556),qa=a(1),O=a(188),ca=a(21),wa=a(375),ia=a(34),Ha=a(50),Sa=a(216),Da=a(22),ea=a(30),sa=a(1093),Ea=a(926),ba=a(127),ka=a(374),Ca=a(284),db=a(166),yb=a(157),kb=a(347),mb=a(94),W=a(29),Q=a(250),va=a(282),na=a(128),Ba=a(782),Oa=a(783),oa=a(115),Ja=a(39),Wb=a(55),nc;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.once=1]="once";Fa[Fa.twice=2]="twice"})(nc||(nc={}));Object(t.b)("ToggleState",nc);class Yb{constructor(Fa,ab,Gb,Ga){this.PYc=this.wfb=this.yfb=0;this.$=Fa;this.gridView=ca.h(this.$);
this.namedSheetViewPublic=ab;this.Lh=Gb;this.instantaneousSupportInformationManager=Ga;this.PMa=Ba.a.apd()}loh(){var Fa=this.EU();Fa={["CommandValueId"]:Ja.c(Fa)};const ab=new mb.a(-2058042992,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ia.Hb(ab,Fa)}Coh(){const Fa=new mb.a(644342024,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ia.Hb(Fa)}qoh(){const Fa=this.gridView.ha.qa.activeCell,ab=this.$.da.Aa(66).Dg,Gb=this.$.da.Aa(66).hwb(Fa);return ab||Gb?this.soh(ab,Gb,Fa):this.roh(Fa)}soh(Fa,ab,Gb){if(this.f3g(Fa,ab,Gb))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Wb.Task.Ra(!1);if(null!=Fa&&Fa.hasAutoFilter||null!=ab&&ab.vsa.every(Ga=>0!=Ga.length))return this.yfb=nc.none,this.NYc();this.yfb=nc.once;return this.h8b(nc.once)}roh(Fa){var ab=
N.v(this.gridView.ha.qa.ld,this.$);ab=this.gridView.$.va.getItemByName(ab.SheetName);const Gb=N.D(ab.q0);if(this.e3g(Gb,Fa))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Wb.Task.Ra(!1);if(ab.hasAutoFilter){if(Gb&&Gb.contains(this.gridView.ha.qa.activeCell))return this.yfb=nc.none,this.NYc();this.yfb=nc.twice;return this.h8b(nc.twice)}this.yfb=nc.once;return this.h8b(nc.once)}h8b(Fa){const ab=N.v(this.gridView.ha.qa.ld,
this.$);if(!ab)return Wb.Task.Ra(!1);this.wfb||(this.wfb=Date.now());const Gb=new mb.a(368460465,2,this.$.xc,19,null),Ga=this.$.oa.xa.Wb(),Ma=()=>new sa.a(ab),Qa=wb=>{Q.a(wb)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Fa===nc.twice?this.h8b(nc.once):this.NYc())};return ka.a(this.$.userOperationManager,(wb,Na,ya)=>Ca.B(this.$.oa.xa,ab,va.b(wb,
Qa),Na,ya,null,Ga),wb=>new Y.a(516,0,wb,64,Ma),Gb)}f3g(Fa,ab,Gb){return null!=Fa&&db.d(Fa)&&Gb.top===Fa.usedRange.top||null!=ab&&ab.$ja&&Gb.top===ab.top?(this.Ysc(this.$,222),!0):null!=Fa&&db.g(Fa)&&Gb.top===Fa.usedRange.bottom?(this.Ysc(this.$,223),!0):!1}e3g(Fa,ab){if(Fa&&Fa.contains(ab)&&ab.top===Fa.top||!Fa&&this.h2g(ab.top,ab.left))return this.Ysc(this.$,224),!0;Fa=new D.Range(ab.top,ab.left,ab.top+1,ab.left+1,!1,!1);return this.gridView.wb.$wa(Fa)?(this.Ysc(this.$,225),!0):!1}Ysc(Fa,ab){ab=
W.a.ed(1,1,750,ab,0,147079615,"ContextMenuFilterByCellValueError");qa.EwaSettings.kz()?new kb.a(Fa,ab):(Fa=new yb.ErrorDialog(Fa,ab),Fa.initialize(),Fa.kg())}NYc(){this.PYc=Date.now();const Fa=this.j6h();if(!Fa)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Wb.Task.Ra(!1);const ab=this.EU(),Gb={FirstRow:0};Gb.FirstColumn=ab.Column;Gb.SheetName=ab.SheetName;na.b(this.$).rd(ba.a.Fzf,this.sm(),void 0,!0);const Ga=this.m5c(ab,Gb),Ma=
wb=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.yfb,["ApplyFilterTime"]:this.PYc?Date.now()-this.PYc:-1,["ToggleAndApplyFilterTime"]:this.wfb?Date.now()-this.wfb:-1,["FilterByValueType"]:ab.AutoFilterType})}`);this.wfb&&(this.wfb=0);if(Ba.a.ozc(wb)){const Na=Ba.a.obc(wb);this.PMa?Ba.a.JQa(Oa.a.filterByCellValue,Na.MessageIdName,oa.a.HGa,!0,Ba.a.isSessionEndingError(Na.MessageId)):c.ULS.sendTraceTag(527500294,
0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Na.MessageIdName}`)}Q.a(wb)?(wb=W.a.nc(wb.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${wb}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),na.b(this.$).rd(ba.a.lDf,this.sm(),void 0,!0),wb={},wb.FirstRow=this.PUh(),wb.FirstColumn=ab.Column,-1!==wb.FirstRow&&(wb=N.C(wb),this.aS(wb)))},Qa=new Y.a(208,
0,(wb,Na,ya)=>U.a(this.$.oa.xa,Ga,Fa,va.b(wb,Ma),Na,ya,null,null),6,()=>new Ea.a(Fa,Ga));this.namedSheetViewPublic?this.namedSheetViewPublic.ASa().continueWith(wb=>{wb.result&&this.$.userOperationManager.Jc(Qa,null)}):this.$.userOperationManager.Jc(Qa,null);return Wb.Task.Ra(!0)}aS(Fa){H.a.Tka(this.$)&&X.TaskExtensions.za(Ha.GetServiceTaskFactory.Oa(this.$.da,430,431,1),ab=>{ab.result.sea(Fa);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}EU(){var Fa=0,ab=this.gridView.ha.qa.activeCell;var Gb=this.$.da.Aa(66).Dg;const Ga=this.$.da.Aa(66).hwb(ab);if(Gb){var Ma="Table";Fa=Gb.objectId}else Ga?(Ma="Table",Fa=Ga.id):Ma="Sheet";Gb=ab.left;ab={};ab.AutoFilterType=Ma;ab.Column=Gb;ab.Id=Fa;Ma={};this.$.ak(Ma);Ma.FirstRow=0;Ma.FirstColumn=ab.Column;Fa=this.$.ea.isNamedObjectViewMode;ab.NamedObjectView=Fa;ab.SheetName=Fa?Ma.NamedObjectName:Ma.SheetName;ab.ItemListOptions=null;return ab}h2g(Fa,
ab){Fa=D.Range.Pc(Fa,ab);return this.gridView.Ca.Z9(Fa,this.$.na.name)&&(Fa=this.gridView.Ca.HKa(Fa))&&Fa.autoFilterMenu?!0:!1}j6h(){var Fa=null;const ab=this.gridView.Qb(this.gridView.ha.qa.activeCell);if(!ab)return null;const Gb=ab.cell.yAc;let Ga;({category:Ga}=this.instantaneousSupportInformationManager.KBa(Gb,!1));if(1===ab.Fr.type)if(3===Ga){if(!ab.cell.BOa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${Ga}. NumFmt is null. `),null;Fa=(ab.cell.BOa.Start+
ab.cell.BOa.End).trim()}else if(!Ga&&(Da.a.R0a(ab.Fr.value,"E")||Da.a.R0a(ab.originalText,"E"))){Fa=this.Lh.vZe(ab.Fr.value,Gb,1,Number.POSITIVE_INFINITY,ab.cell.Zha);if(!Fa.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${Ga}. Failed to acquire formatted value`),null;Fa=Fa.HA}Fa||(Fa=ab.originalText);return ea.a.XBe(Fa)?["[Blanks]"]:["i"+Fa.trim()]}PUh(){const Fa=this.gridView.ha.qa.activeCell;var ab=this.$.da.Aa(66).Dg;const Gb=this.$.da.Aa(66).hwb(Fa);
if(ab)return ab.usedRange.top;if(null!=Gb)return Gb.top;ab=this.$.va.getItemByName(this.$.na.sheetName);return(ab=N.D(ab.q0))&&ab.contains(Fa)?ab.top:-1}m5c(Fa,ab){const Gb={};Gb.Location=ab;Gb.FieldId=Fa.Id.toString();Gb.DataSourceIndex=-1;Gb.FilterType=Fa.AutoFilterType;Gb.AnchorType=0;Gb.ChartId=null;Gb.AnchorValue1=-1;Gb.AnchorValue2=-1;Gb.Property=Fa.RichProperty;return Gb}}Object(t.a)(Yb,"GridContextMenuFilter",null,[]);a.d(F,"GridContextMenu",function(){return pb});class pb extends r.a{constructor(Fa,
ab,Gb,Ga){super(Fa,"PopulateGridContextMenu",1247109494,-2064931494,pb.T7h,!0,!1,pb.QKb,ab,Gb,!0,Ga);this.Qjc=this.expandCollapse=this.refresh=this.ZY=this.$va=this.UAa=!1;this.fIe=!0;this.grid=ca.h(Fa);this.Omc=!0;if(this.khc=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const Ma=Ha.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Qa=Ha.GetServiceTaskFactory.create(this.$.da,18,this.la,3);X.TaskExtensions.za(X.TaskExtensions.Fd([Ma,Qa],this.la),()=>
{this.$.da.gb(268,wb=>{this.b5a=new Yb(Fa,Ma.result,Qa.result,wb)})},this.la,3)}}get Gw(){return"PopulateGridContextMenu"}get qB(){return z.a.BRf}dispose(){super.dispose();this.grid=null}Hc(Fa,ab){Fa=!this.ysd(Fa,ab);if(!Fa)switch(ab){case -1977666927:Fa=null==this.b5a||this.AEj();break;case 1549396389:Fa=null==this.b5a||!this.omi();break;case 2045563128:case 1803952894:Fa=null==this.b5a||!this.$.isEditMode&&!this.pmi();break;case -425234874:Fa=this.EEj()}return Fa}ysd(Fa,ab){const Gb=this.grid.ha.qa.selectedRanges;
return(new aa.a(this.$.va)).um(Fa,ab,Gb,this.grid)}executeCommand(Fa,ab,Gb){const Ga=ab.command;Fa=null;switch(Ga){case -1396319072:if(ab=this.grid.Qb(null))b.a.instance.U0c(!0),e.EventHandlerManager.instance.xdd(),pb.v1i(ab);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.qa.selectedRanges,ab);break;case 324156914:Fa=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Gb);break;case -1977666927:Fa=this.b5a.loh();break;case 1549396389:Fa=this.b5a.Coh();break;
case 1803952894:Fa=this.b5a.qoh();break;default:Fa=O.a(Ga)}return Fa||X.TaskExtensions.Uaa()}wc(Fa,ab,Gb){Fa=!1;switch(ab.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Fa=!0;break;case 1441131127:Fa=!!Gb}return Fa}CY(Fa=!1){let ab=!1,Gb=!1,Ga=0;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ga=f.a.Ud());const Ma=this.Va.sq(this.menuId);var Qa=this.grid.ha.qa;const wb=Qa.Tg,Na=wb&&Qa.ld.Rg,
ya=wb&&Qa.ld.isRow;Qa=Qa.selectedRanges;const nb=d.a.all(Qa,La=>La.Rg),vb=d.a.all(Qa,La=>La.isRow),gb=N.O(Qa),cb=N.P(Qa);this.Wkf(Na,ya)?(ab=!0,this.HMh(Ma)):this.$.isEditMode?wa.a(this.$)?this.IMh(Ma,Na,ya):(this.ELh(Ma,!(ya||Na||!this.Qjc)),this.bMh(Ma,Qa,Fa),this.RLh(Ma,nb,vb,gb,cb),this.G_e(Ma,wb,Na,ya),this.$Mh(Ma),this.l_e(Ma,Na,ya),this.xMh(Ma,wb,Na,ya,Qa),this.HLh(Ma),this.FLh(Ma,Qa),this.jMh(Ma),this.VMh(Ma,wb),qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.WLh(Ma)):(Gb=!0,wa.a(this.$)?this.B_e(Ma):this.pNh(Ma,wb,Na,ya,Qa));qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Fa=f.a.Ud()-Ga,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Fa}, isPivotMenu: ${ab}, isViewMenu: ${Gb}, firstTimeEntry: ${this.fIe}`));this.fIe=!1;return Ma}wKa(Fa){const ab=[];if(wa.a(this.$))return ab;if(3===Fa){Fa=this.grid.ha.qa;const Ga=Fa.Tg,Ma=Ga&&Fa.ld.Rg,Qa=Ga&&Fa.ld.isRow;
let wb=!1;var Gb=!1;let Na=!1;this.$.isMobileMode&&(Gb=Fa.selectedRanges,wb=N.O(Gb),Gb=N.P(Gb));if(Ga){const ya=ca.f(this.grid);ya&&ya.range.contains(Fa.ld)&&this.dV(ya)&&(Na=!0)}this.$.isEditMode?this.Wkf(Ma,Qa)?ab.push(...[y.a.CMf,y.a.EMf]):Ma||Qa?(ab.push(y.a.clipboard),Qa?ab.push(y.a.Mqj):Ma&&ab.push(y.a.B6g)):(ab.push(...[y.a.edit,y.a.clipboard]),Na?ab.push(y.a.hyperlink):ab.push(y.a.color),Ga&&ab.push(y.a.HUg)):(ab.push(y.a.copy),Na&&ab.push(y.a.openHyperlink),!Qa||this.$.isMobileMode&&Gb?!Ma||
this.$.isMobileMode&&wb||ab.push(y.a.b5j):ab.push(y.a.c5j));ab.push(y.a.K7h)}else 2===Fa&&ab.push(y.a.aBe);return ab}Wkf(Fa,ab){return(this.UAa||this.$va||this.ZY||this.refresh||this.expandCollapse)&&!(Fa||ab)}showGridContextMenu(Fa){this.expandCollapse=this.refresh=this.ZY=this.$va=this.UAa=!1;var ab=this.$,Gb=Z.a(ab).yva(),Ga=this.grid.ha.qa;const Ma=Ga.Tg;var Qa=Ma&&Ga.ld.Rg;Ga=Ma&&Ga.ld.isRow;if(Gb&&!Qa&&!Ga){Qa=da.a(ab);if(null===Qa||void 0===Qa?0:Qa.FTd)this.UAa=Qa=E.f(ab.dg),this.$va=!Qa;Qa=
ab.$b;this.ZY=Gb.supportsBIExplore&&!!w.a(ab)&&Qa.m2(32768);Qa.allowInteractivity&&(ab=this.grid.Qb(null),(null===ab||void 0===ab?0:ab.cell)&&(ab.cell.J0c||ab.cell.I8f)&&(this.expandCollapse=!0),Qa.allowManualDataRefresh&&(this.refresh=!0))}ab=null;Gb=1;Qa=Object(l.a)(h.a,Fa.eventArgs);Fa=Object(l.a)(C.a,Fa.creationParams);Ga=this.SRh();Fa?(ab=Fa.clientPoint,Gb=Fa.inputMethod):Qa&&1!==Qa.ub?(ab=new Sys.UI.Point(Qa.clientPoint.x,Qa.clientPoint.y),Gb=Qa.ub):Ga&&(ab=new Sys.UI.Point(Ga.x+(this.$.isChromeRtl?
0:Ga.width),Ga.y+Ga.height));M.a.zb=Gb;this.Qjc=3===Gb;Fa=x.a.Oub;this.rp(ab,!Qa||Qa.Ea.target.className!==Fa,Gb)}removeHyperlinksFromRange(Fa,ab){if(!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Us(Fa,!0)){var Gb=N.r(Fa,this.$),Ga=this.$.oa.xa.Wb();this.$.userOperationManager.Jc(new Y.a(125,0,(Ma,Qa,wb)=>{this.$.my();return U.b(this.$.oa.xa,Gb,"","",!0,!1,127,Ma,Qa,wb,null,Ga)},void 0,()=>new S(Gb)),ab);this.grid.Gg.dM(!1)}}SRh(){var Fa=
this.grid.Qb(null);if((null===Fa||void 0===Fa?0:Fa.cell.uk)&&this.akf(Fa))return this.grid.getCellBounds(Fa.cell);Fa=this.grid.ha.qa.activeCell;return(Fa=this.W$b(new D.Range(Fa.top,Fa.left,A.a.Vg,Fa.left,!1,!1),2,!0)||this.W$b(new D.Range(1,Fa.left,Fa.top,Fa.left,!1,!1),2,!1)||this.W$b(new D.Range(Fa.top,Fa.right,Fa.top,A.a.Ug,!1,!1),1,!0)||this.W$b(new D.Range(Fa.top,1,Fa.top,Fa.right,!1,!1),1,!1)||null)&&Fa.uk?this.grid.getCellBounds(Fa):Sys.UI.DomElement.getBounds(this.grid.Vva.jc)}akf(Fa){var ab=
this.grid.rtl,Gb=this.$.isChromeRtl;Fa=Fa.cell;var Ga=ca.h(this.$).GJ(Fa);return Ga?(Ga=Ga.topLeft,ab=Ga.x+=ab===Gb?Fa.offsetWidth:0,Gb=Ga.y+=Fa.offsetHeight,this.grid.view.visibleArea.contains(new u.a(ab,Gb,0,0))):!1}W$b(Fa,ab,Gb){Fa=this.grid.Wj("GridContextMenu.FindFirstCellInViewportArea",Fa,ab,Gb);try{for(Fa.$$rst();Fa.$$mn();){const Ga=Fa.$$cu();if(Ga&&this.akf(Ga))return Ga.cell}}finally{Fa&&Fa.dispose()}return null}HMh(Fa){const ab=this.Va,Gb=ab.Ec();this.refresh&&Gb.buttons.push(ab.pb(100));
this.ZY&&Gb.buttons.push(ab.pb(99));this.UAa?Gb.buttons.push(ab.pb(59)):this.$va&&Gb.buttons.push(ab.pb(58));if(this.expandCollapse){let Ga;Ga=ab.Xv("ContextMenu.PivotExpandCollapse",null,B.a.instance.ga(1165),589118293);const Ma=ab.Ec();Ma.buttons.push(ab.pb(243));Ma.buttons.push(ab.pb(244));Ma.buttons.push(ab.pb(245));Ma.buttons.push(ab.pb(246));Ga.menu.rc.push(Ma);Ga&&0<Ma.buttons.length&&Gb.buttons.push(Ga)}Fa.rc.push(Gb)}G_e(Fa,ab,Gb,Ga){if(ab&&!Gb&&!Ga){ab=this.Va.Ec();this.khc&&!this.$.aK&&
this.sed(ab);this.Aed(ab);this.dNh(ab);if(qa.EwaSettings.sa(417)&&ca.h(this.$).ha.qa.XJ()&&ca.h(this.$).ha.qa.b5)switch(qa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:ab.buttons.push(this.Va.pb(237));break;case 2:ab.buttons.push(this.Va.pb(238));break;default:ab.buttons.push(this.Va.pb(236))}Fa.rc.push(ab)}}Aed(Fa){if(this.$.$b.allowSorting&&(!this.$.isMobileMode||(new aa.a(this.$.va)).Pd(2048))){var ab=this.Va.Ec();ab.buttons.push(this.Va.pb(223));
ab.buttons.push(this.Va.pb(224));ab.buttons.push(this.Va.pb(292));ab.buttons.push(this.Va.pb(293));ab.buttons.push(this.Va.pb(294));this.$.isMobileMode||ab.buttons.push(this.Va.pb(225));var Gb=this.Va.Xv("ContextMenu.sort",null,B.a.instance.ga(226),-864298118);Gb.menu.rc.push(ab);Fa.buttons.push(Gb)}}sed(Fa){const ab=this.Va.Xv("ContextMenu.filter",null,B.a.instance.ga(1967),2045563128),Gb=this.Va.Ec();var Ga=this.rWh();const Ma=this.Va.pb(234);Ma.label=Ga;Gb.buttons.push(Ma);Gb.buttons.push(this.Va.pb(235));
Ga=this.Va.Ec();Ga.buttons.push(this.Va.pb(233));ab.menu.rc.push(Gb);ab.menu.rc.push(Ga);Fa.buttons.push(ab)}dNh(Fa){if(ca.h(this.$).ha.qa.XJ()){const ab=this.Va.Ec();ab.buttons.push(this.Va.pb(232));ab.buttons.push(this.Va.pb(285));ab.buttons.push(this.Va.pb(286));const Gb=this.Va.Xv("ContextMenu.table",null,B.a.instance.ga(1966),-697806646);Gb.menu.rc.push(ab);Fa.buttons.push(Gb)}}w_e(Fa,ab,Gb,Ga,Ma){if(ab){const wb=N.K(Ma);var Qa=ca.f(this.grid);if(Qa&&!Gb&&!Ga){Gb=new aa.a(this.$.va);if(Qa.range.contains(wb)&&
this.dV(Qa)){(ab=!Qa.Jka&&!Gb.Nh)&&this.$.isEditMode&&Fa.buttons.push(this.Va.pb(45));Qa.Yaa&&Fa.buttons.push(this.Va.pb(53));ab&&this.$.isEditMode&&Fa.buttons.push(this.Va.pb(47));return}!Qa.Jka&&this.$.isEditMode&&(Qa=Gb.Pd(128),Fa.buttons.push(this.Va.pb(Qa?46:121)))}}this.Ibj(Ma)&&Fa.buttons.push(this.Va.pb(48));(Qa=this.$.va.na)&&Qa.$d&&(Qa=Qa.$d.iz||Qa.$d.cK,!ab||this.$.aK||!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||!R.g(this.$)||this.$.ea.isNamedObjectViewMode||
this.$.isMobileMode||Qa||(ab=N.K(Ma),this.Hbj(ab)?Fa.buttons.push(this.Va.pb(276)):ab.Rg||ab.isRow||Fa.buttons.push(this.Va.pb(275))))}Ibj(Fa){for(const ab of Fa){Fa=this.grid.getRangeInformation(ab);for(let Gb=0;Gb<Fa.length;Gb++)if(Object(v.a)(G.HyperlinkRange,Fa[Gb])){const Ga=this.grid.Qb(Fa[Gb]);if(Ga&&this.dV(Ga)&&!Ga.Jka)return!0}}return!1}Hbj(Fa){if(ca.h(this.$).ha.qa.XJ()){const ab=ca.h(this.$).wb.zi(Fa);if(ab&&ab.usedRange.equals(Fa))return!0}return!1}l_e(Fa,ab,Gb){var Ga,Ma;if(1===ca.h(this.$).ha.Oe&&
!ab&&!Gb){ab=wa.a(this.$);Gb=this.Va;var Qa=Gb.Ec(),wb=this.$.da.Aa(65);(null===(Ga=null===wb||void 0===wb?void 0:wb.Qm)||void 0===Ga?0:Ga.UE)&&!ab&&Qa.buttons.push(Gb.pb(227));wb&&wb.isCommentOperationEnabled(3)&&Qa.buttons.push(Gb.pb(221));(null===(Ma=null===wb||void 0===wb?void 0:wb.Qm)||void 0===Ma?0:Ma.pld)&&!ab&&Qa.buttons.push(Gb.pb(228));(null===wb||void 0===wb?0:wb.hasCommentAtActiveCell)?wb.qC.isResolved||Qa.buttons.push(Gb.pb(159)):wb&&wb.hasCommentAtActiveCell||(wb&&wb.Qm&&wb.Qm.UE?ab||
(Qa.buttons.push(Gb.pb(229)),Qa.buttons.push(Gb.pb(230))):(Qa.buttons.push(Gb.pb(160)),ab||Qa.buttons.push(Gb.pb(226))));Fa.rc.push(Qa)}}$Mh(Fa){if(qa.EwaSettings.sa(127)){const ab=this.Va,Gb=ab.Ec();Gb.buttons.push(ab.pb(250));Fa.rc.push(Gb)}}bMh(Fa,ab,Gb){if(!Gb){Gb=this.$.Ia.bH();var Ga=new aa.a(this.$.va),Ma=new P.a(Gb,ab,this.grid);(new I(Fa,this.$,this.Va,Gb,ab,this.grid,Ma,Ga)).ned()}}RLh(Fa,ab,Gb,Ga,Ma){const Qa=(new aa.a(this.$.va)).Pd(8),wb=this.Va,Na=wb.Ec();ab&&Na.buttons.push(wb.pb(Qa?
152:153));Gb&&Na.buttons.push(wb.pb(Qa?150:151));ab&&(Ga||Na.buttons.push(wb.pb(Qa?109:155)),Na.buttons.push(wb.pb(Qa?111:157)));Gb&&(Ma||Na.buttons.push(wb.pb(Qa?108:154)),Na.buttons.push(wb.pb(Qa?110:156)));Fa.rc.push(Na)}ELh(Fa,ab){const Gb=this.Va,Ga=Gb.Ec();Fa.rc.push(Ga);ab&&Ga.buttons.push(Gb.pb(102));Ga.buttons.push(Gb.pb(42));Ga.buttons.push(Gb.pb(43));ab=this.EMh(Gb);Fa.rc.push(ab)}EMh(Fa){const ab=Fa.Ec();ab.title=B.a.instance.ga(1145);ab.I$f=!1;ab.H$f=!1;ab.Seg=!1;let Gb=5;const Ga=H.a.bud(this.$);
Ga&&(Gb=6);Fa=Fa.xC("PasteOptionsGallery",Gb,"Size24by24",ab.title);ab.buttons.push(Fa);Fa.Zt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"Paste_24",1,n.a.yzh);Fa.Zt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteValues_24",1,n.a.Dzh);Fa.Zt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteFormulas_24",1,n.a.Azh);Fa.Zt("ContextMenu.PasteTranspose",-958589048,
"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteTranspose_24",1,n.a.Czh);Fa.Zt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteFormatting_24",1,n.a.zzh);Ga&&Fa.Zt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteLink_24",1,n.a.Bzh);return ab}pNh(Fa,ab,Gb,Ga,Ma){var Qa;const wb=this.Va;var Na=wb.Ec();Na.buttons.push(wb.pb(43));Fa.rc.push(Na);this.khc&&!this.$.aK&&(Na=this.Va.Ec(),this.sed(Na),
Fa.rc.push(Na));qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.$b.isMobileMode&&this.$.ea.$b.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(Na=this.Va.Ec(),this.Aed(Na),Fa.rc.push(Na),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Na=this.$.da.Aa(65);if(null===(Qa=null===Na||void 0===Na?void 0:Na.Qm)||
void 0===Qa?0:Qa.UE)Qa=this.Va.Ec(),Qa.buttons.push(wb.pb(229)),Fa.rc.push(Qa);Qa=this.Va.Ec();this.w_e(Qa,ab,Gb,Ga,Ma);Fa.rc.push(Qa);m.AFrameworkApplication.isMobileMode&&!L.a(this.$.ya,29)&&(ab=wb.Ec(),ab.buttons.push(wb.pb(272)),Fa.rc.push(ab))}xMh(Fa,ab,Gb,Ga,Ma){const Qa=this.Va.Ec();H.a.Dqd(this.$)?this.LLh(Qa):this.yMh(Qa);this.w_e(Qa,ab,Gb,Ga,Ma);0<Qa.buttons.length&&Fa.rc.push(Qa)}yMh(Fa){Fa.buttons.push(this.Va.pb(135))}LLh(Fa){Fa.buttons.push(this.Va.pb(300))}WLh(Fa){const ab=this.Va.Ec();
ab.buttons.push(this.Va.pb(185));Fa.rc.push(ab)}VMh(Fa,ab){qa.EwaSettings.sa(418)&&ab&&(ab=this.Va.Ec(),ab.buttons.push(this.Va.pb(262)),Fa.rc.push(ab))}jMh(Fa){var ab=this.grid.ha.qa.selectedRanges;if(ab&&ab.length){var Gb=!1;for(var Ga=0;Ga<ab.length;Ga++)if(this.grid.wb.exa(ab[Ga])){Gb=!0;break}if(Gb){Gb=!1;for(Ga=0;Ga<ab.length;Ga++){var Ma=this.grid.wb.H_h(ab[Ga]);if(null!=Ma&&null!=Ma[0]){for(var Qa=0;Qa<Ma.length;Qa++)if(this.grid.wb.exa(Ma[Qa])){Gb=!0;break}if(Gb)break}}Qa=this.Va;Ga=Qa.Ec();
Ma=Qa.Ec();var wb=1===ab.length&&(ab[0].isSingle||this.grid.wb.dNa(ab[0])),Na=!1,ya=!1,nb=!1,vb=!1;for(let gb=0;gb<ab.length&&!(Na&&nb&&ya&&vb);gb++)!Na&&this.grid.wb.lri(ab[gb])&&(Na=!0),!nb&&this.grid.wb.Rjf(ab[gb],!1)&&(nb=!0),!ya&&this.grid.wb.nsd(ab[gb])&&(ya=!0),!vb&&this.grid.wb.Wgf(ab[gb])&&(vb=!0);qa.EwaSettings.sa(102)&&wb&&!this.grid.wb.Yzb(ab[0])&&(vb?Ga.buttons.push(Qa.pb(217)):Ga.buttons.push(Qa.pb(216)));vb=Na;vb=!(new aa.a(this.$.va)).Nh&&vb;nb&&!Gb&&(qa.EwaSettings.sa(123)&&E.l(this.$.dg)&&
(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Ma.buttons.push(Qa.pb(220)):Ma.buttons.push(Qa.pb(vb?220:271)),ya&&Ma.buttons.push(Qa.pb(vb?218:269)),wb&&(this.grid.wb.nsd(ab[0])||this.grid.wb.Yzb(ab[0]))&&Ma.buttons.push(Qa.pb(vb?219:270))),Ma.buttons.push(Qa.pb(vb?215:268)));0<Ma.buttons.length&&(ab=Qa.Xv(Na?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,B.a.instance.ga(1780),798637440),ab.menu.rc.push(Ma),
Ga.buttons.push(ab));0<Ga.buttons.length&&Fa.rc.push(Ga)}}}FLh(Fa,ab){this.grid.wb.eif(ab)&&(ab=this.Va.Ec(),this.grid.ha.qa.Dba()?(ab.buttons.push(this.Va.pb(241)),ab.buttons.push(this.Va.pb(239))):ab.buttons.push(this.Va.pb(240)),Fa.rc.push(ab))}dV(Fa){return Fa.cell.hasHyperlink}B_e(Fa){this.JMh(Fa);var ab=this.Va.Ec();this.Aed(ab);Fa.rc.push(ab);this.khc&&(ab=this.Va.Ec(),this.sed(ab),Fa.rc.push(ab))}IMh(Fa,ab,Gb){this.B_e(Fa);this.l_e(Fa,ab,Gb)}JMh(Fa){if(this.grid.ha.qa.Tg&&!this.grid.ib.gj){var ab=
this.Va,Gb=ab.Ec();ia.a(this.$).fUd()?Gb.buttons.push(ab.pb(265)):Gb.buttons.push(ab.pb(264));Fa.rc.push(Gb)}}static v1i(Fa){const ab=Fa.EKa(pb.Fmd);ab&&ab.vod&pb.Fmd&&Fa.invoke(pb.Fmd,null)}static aMh(Fa,ab,Gb){(Gb=Gb.da.Aa(254))?(Gb.Zqd()&&Gb.hpf()&&Fa.buttons.push(ab.pb(212)),Gb.Zqd()&&Gb.Okc()&&Fa.buttons.push(ab.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}AEj(){const Fa=this.$.da.Aa(66).Dg,ab=this.grid.ha.qa.activeCell;
return null!=Fa&&!Fa.hasActiveFilter||Sa.c(this.$,ab)||!this.qmi(ab)}qmi(Fa){const ab=Fa.left;var Gb=this.qdc();if(null!=Gb&&null!=Gb.M$b&&Gb.M$b.includes(ab-1))return!0;Gb=this.idc();return null!=Gb&&N.D(Gb).contains(Fa)&&null!=Gb.FilteredColumns&&Gb.FilteredColumns.includes(ab-1)?!0:!1}omi(){var Fa=this.$.da.Aa(66).Dg;const ab=this.qdc();if(null!=Fa)return Fa.hasAutoFilter&&Fa.hasActiveFilter;if(null!=ab)return null!=ab.M$b&&0<ab.M$b.length;Fa=this.idc();return null!=Fa&&null!=Fa.FilteredColumns&&
0<Fa.FilteredColumns.length}pmi(){var Fa=this.$.da.Aa(66).Dg;const ab=this.qdc();if(null!=Fa&&Fa.hasAutoFilter||null!=ab&&ab.vsa.every(Gb=>0!=Gb.length))return!0;Fa=N.D(this.idc());return null!=Fa&&Fa.contains(this.grid.ha.qa.activeCell)?!0:!1}qdc(){const Fa=this.$.da.Aa(66);Fa.Mp(this.grid.ha.qa.activeCell);return Fa.hwb(this.grid.ha.qa.activeCell)}idc(){return this.$.va.getItemByName(this.$.na.sheetName).q0}rWh(){var Fa=this.grid.ha.qa.activeCell,ab=0,Gb=!1,Ga=this.$.da.Aa(66),Ma=this.qdc();Ga=
Ga.Dg;null!=Ga?(ab=Ga.usedRange.top,Gb=!0):null!=Ma?(ab=Ma.top,Gb=!0):(Ma=this.idc(),null!=Ma&&N.D(Ma).contains(Fa)&&(ab=Ma.FirstRow+1,Gb=!0));return Gb?(Fa=Fa.left,ab=D.Range.Pc(ab,Fa),ab=this.grid.Qb(ab),Gb="",null!=ab&&(Gb=ab.text),this.KXg(Gb,Fa)):B.a.instance.ga(219)}KXg(Fa,ab){null==Fa||Da.a.lh(Fa.trim())?Fa=String.format(B.a.instance.ob(157),D.Range.vP(ab)):Fa.length>pb.z3d?(Fa=Fa.substring(0,pb.z3d),Fa=String.format(B.a.instance.ob(155),Fa)):Fa=String.format(B.a.instance.ob(156),Fa);return Fa}EEj(){const Fa=
this.grid.ha.qa.selectedRanges;if(!Fa||!Fa.length)return!0;for(let ab=0;ab<Fa.length;ab++)if(!this.grid.wb.$wa(Fa[ab]))return!1;return!0}}pb.QKb="GridContextMenuRootName";pb.T7h=z.a.TFe;pb.Fmd=192;pb.z3d=26;Object(t.a)(pb,"GridContextMenu",r.a,[])},1244:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(89),e=a(1111),f=a(8),d=a(786);class h{}h.oXd="suggested_cells_list_box";Object(t.a)(h,"CssElementIds",null,[]);var m=a(5),l=a(1112);class v{constructor(X,Z){this.ctg=X;this.btg=Z}get V9(){return this.ctg}get JZc(){return this.btg}}
Object(t.a)(v,"CellAutoCompleteItem",null,[278]);var r=a(4),A=a(84),x=a(930),n=a(386),u=a(41),z=a(1),w=a(22),C=a(21);class y extends x.a{constructor(X,Z,da){super(X,Z);this.aSb=null;this.Ikc=0;this.A0=this.G8a=null;this.U5=(qa,O)=>{if(qa=this.cellAutoCompleteControl.items)if(1===qa.length&&this.cellAutoCompleteControl.l1a.length<qa[0].V9.length&&this.cellAutoCompleteControl.cwa&&w.a.KF(qa[0].V9,this.cellAutoCompleteControl.l1a)&&(O.newValue=qa[0].V9),this.eb&&z.EwaSettings.sa(128)){let ca=-1;1<qa.length?
ca=this.cellAutoCompleteControl.ndc(this.eb.text,!0):1===qa.length&&(this.cellAutoCompleteControl.cwa||this.cellAutoCompleteControl.gfc)&&(ca=0);if(0<=ca&&qa.length>ca&&qa[ca].JZc){const wa=u.C(qa[ca].JZc);wa&&C.h(this.$).wb.exa(wa)&&(O.Ugf=!0,O.WAe=qa[ca].JZc)}}};this.KGb=()=>{this.cellAutoCompleteControl.cwa=!1};this.eb.PYa(this.U5);if(this.bAb=z.EwaSettings.cl())this.aSb=da;this.A0=this.ze.ie(this.eb.textBox.domElement);this.A0.ka("mousedown",this.KGb)}get rAb(){return!1}get $J(){return this.cellAutoCompleteControl.re}set $J(X){this.cellAutoCompleteControl.re=
X}get U5a(){return!1}get key(){return n.a.w1c}get cellAutoCompleteControl(){if(this.bAb)return this.aSb;const {CellAutoCompleteControl:X}=a(1244);return this.aSb||(this.aSb=Object(A.a)(X,this.$.da.Aa(1)))}dispose(){this.eb.FJb(this.U5);super.dispose()}tY(X){X&&!this.cellAutoCompleteControl.re||super.tY(X)}Mh(X,Z){this.cellAutoCompleteControl.eb=this.eb;this.Ikc=X.keyCode;if(this.eb.fb){const da=this.eb.text;w.a.equals(this.G8a,da,!1)||(this.G8a=da)}else this.G8a=null;if(237279923===Z)return this.cellAutoCompleteControl.re=
!1;z.EwaSettings.sa(128)&&17===this.Ikc&&this.cellAutoCompleteControl.cwa&&(this.cellAutoCompleteControl.gfc=!0);return super.Mh(X,Z)}bCd(){var X;if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!r.AFrameworkApplication.rg)if(this.cellAutoCompleteControl.eb=this.eb,this.cellAutoCompleteControl.cwa=!1,this.eb.fb){const Z=!w.a.equals(this.G8a,this.eb.text,!0),da=this.eb.aqd;da||!Z&&229!==this.Ikc?da&&(this.cellAutoCompleteControl.re&&(this.cellAutoCompleteControl.re=
!1),null===(X=this.cellAutoCompleteControl.NNa)||void 0===X?void 0:X.cancel()):this.cellAutoCompleteControl.wTg(this.Ikc)}else this.G8a=null}Ri(){}$f(){this.$J=!1;this.cellAutoCompleteControl.set_visible(!1);this.G8a=null;this.cellAutoCompleteControl.cwa=!1;this.cellAutoCompleteControl.gfc=!1;this.cellAutoCompleteControl.NNa&&this.cellAutoCompleteControl.NNa.cancel()}yId(X,Z){return this.cellAutoCompleteControl.Mh(X,Z)}}Object(t.a)(y,"CellAutoCompleteListAutoCompleteBehavior",x.a,[]);var B=a(30);
x=a(1113);var H=a(12),I=a(11),R=a(116);class S extends x.a{constructor(X,Z,da,qa){super(X,Z);this.htmlSanitizationHelper=this.lra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=da;if(this.bAb=z.EwaSettings.cl())this.cellAutoCompleteControl=qa;this.To=[]}get Ej(){return this.lra}set Ej(X){this.yBa(this.Ej);this.lra=X;const Z=this.yBa(this.Ej);this.ee=X?Z.innerText:null;this.Owc(X)}get re(){return super.re}set re(X){super.re=X;X||(this.Ej=null)}get JTa(){return null}get FGa(){return this.bAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}dispose(){super.dispose();this.lra=null}oBc(X){this.q7(!1);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var Z=document.createElement("table");Z.classList.add(this.p5);Z.hTg=m.a.BGa;var da=document.createElement("tbody");for(let qa=0,O=this.To.length;qa<O;qa++){const ca=
document.createElement("tr"),wa=document.createElement("td");wa.classList.add(this.pV);const ia=document.createElement("span");ia.classList.add(S.Y2b);ia.setAttribute(m.a.vYc,X[this.To[qa]].V9);ia.innerText=X[this.To[qa]].V9;wa.appendChild(ia);ca.appendChild(wa);da.appendChild(ca)}Z.appendChild(da);this.htmlSanitizationHelper.HG(this.Df);this.Df.appendChild(Z)}else{Z=`<table class='${this.p5}' aria-live='polite'><tbody>`;for(let qa=0,O=this.To.length;qa<O;qa++)da=B.a.yg(X[this.To[qa]].V9),da=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.pV,S.Y2b,m.a.vYc,da,B.a.U9c(da)),Z+=da;Z+="</tbody></table>";this.Df.innerHTML=Z}this.vn=H.DOMElementExtensions.$j(this.domElement,this.p5);this.q7(!0);this.Ura()}HJa(X,Z){if(X&&X.length){var da=[];if(Z)for(let qa=0,O=X.length;qa<O;qa++)w.a.KF(X[qa].V9,Z)&&da.push(qa);this.To=da;this.oBc(X)}else this.re=!1,this.lra=null}eya(){}S_g(X,Z,da){let qa=Math.min(X,Math.max(200,da));Z&&X<da&&(qa+=R.a.Bu);H.DOMElementExtensions.Hv(this.Df,qa);Z&&(qa-=R.a.Bu);return qa}Ura(){super.Ura();var X=H.DOMElementExtensions.$j(this.get_element(),
this.p5),Z=this.To.length>this.HH,da=C.h(this.$);if(da=da.Qb(da.ha.qa.activeCell))for(X=this.S_g(X.offsetWidth,Z,da.width),Z=this.Df.getElementsByClassName(S.Y2b),da=0;da<Z.length;da++)Z[da].style.maxWidth=I.HelperMethods.sc(X);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(X){if(X=super.onItemClick(X)){const Z=C.h(this.$);Z.Do(!1);Z.focus()}return X}}S.Y2b=d.a.Syh;Object(t.a)(S,"CellAutoCompleteListBox",
x.a,[]);var G=a(24),D=a(65),E=a(117),M=a(162),L=a(44),N=a(35),Y=a(255),U=a(19);a.d(F,"CellAutoCompleteControl",function(){return aa});const P=`<div id='${h.oXd}' class='${d.a.A9b} ${U.a.fo}' ></div>`;class aa extends e.a{constructor(X,Z,da){super(X);this.hDa=null;this.v1c=[];this.C7d=null;this.gfc=this.cwa=!1;this.sde=this.fq=null;this.UNe=()=>{this.pY.HJa(this.items,this.hDa);this.raiseEvent("ACLBUpdated",new l.a(this.items.length));this.show()};this.tableManager=Z;this.domElement.className=d.a.UQe;
z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(Z=document.createElement("div"),Z.classList.add(d.a.A9b),Z.classList.add(U.a.fo),Z.id=h.oXd,this.domElement.appendChild(Z)):this.domElement.innerHTML=P;H.DOMElementExtensions.setVisible(this.domElement,!1);Y.d(this.style,this.$.isChromeRtl);this.Bif=z.EwaSettings.cl();this.VAe=$get(h.oXd,this.domElement);this.pY=new S(this.$,this.VAe,da,
this);this.gTa(!0);this.$.domElement.appendChild(this.domElement);this.ypb(X,E.a(X));this.ypb(X,C.h(X).Vb);this.Bif||this.$.da.Ha(1,this);this.vmi=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}E_b(X){this.addHandler("ACLBUpdated",X)}Guc(X){this.removeHandler("ACLBUpdated",X)}i2(X){this.addHandler("ACLBSelectionChanged",X)}tda(X){this.removeHandler("ACLBSelectionChanged",X)}dNg(X){this.addHandler("ACLBMatchedItem",X)}Ljj(X){this.removeHandler("ACLBMatchedItem",
X)}get au(){return this.pY}get l1a(){return this.hDa}get ee(){return this.pY.ee}get items(){return this.fq}get NNa(){return this.sde}get activeCell(){return C.h(this.$).ha.qa.activeCell}get dataValidationControl(){return this.C7d||(this.C7d=this.$.da.Aa(14))}acg(X){for(let Z=0;Z<X.length;Z++){const da=X.charCodeAt(Z);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?w.a.isLetter(da):w.a.ird(da))return!0}return!1}Rwa(){return!this.items}dispose(){if(this.$){this.gTa(!1);
const X=C.h(this.$);X&&X.view.Jq(this.hpc)}b.a.pc([this.pY,this.NNa]);b.a.pc(this.v1c);this.v1c=this.VAe=this.pY=this.eb=null;super.dispose()}Mh(X,Z){let da=!1;if(this.bFj())switch(Z){case -798660877:if(1===this.items.length&&this.ee)break;this.au.dB(1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.ndc(this.ee),this.ee));da=this.My(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;this.au.dB(-1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,
this.ndc(this.ee),this.ee));da=this.My(!1);break;case 2091832999:this.au.dB(this.HH-1);da=this.My(!1);break;case 742457698:this.au.dB(-(this.HH-1));da=this.My(!1);break;case 125627505:this.eb.textBox.caretPosition=this.eb.text.length;this.re=!1;da=!0;break;case 267796030:this.My(!0);break;default:da=super.Mh(X,Z)}return da}show(){this.items&&this.items.length&&(this.pY.Ej=this.ee?this.au.vn.rows[this.ndc(this.ee)]:null,this.re=0<this.pY.To.length,this.QBa(!0),this.pY.eya())}wTg(X){const Z=!!this.eb&&
!D.f(this.$.na);this.gfc=this.cwa=!1;this.eb&&!this.eb.fb?this.set_visible(!1):Z&&!this.Yih(this.activeCell)&&this.OIj(X)}Yih(X){return!!this.dataValidationControl&&this.dataValidationControl.W8c(X)}My(X){if(!this.eb||!this.re)return!1;const Z=this.hDa;if(this.ee){var da=H.DOMElementExtensions.hZ(H.DOMElementExtensions.$j(this.pY.Ej,S.Y2b),m.a.vYc,"");const qa=da.substring(Z.length,da.length);X?this.eb.text=da:this.eb.insertTextAt(qa,Z.length,this.eb.text.length)}da=C.h(this.$);da.Ql&&(da=da.Vb,da.text=
this.eb.text,da.setCaretPosition(this.eb.textBox.caretPosition));X?this.re=!1:this.eb.textBox.selectRange(Z.length,this.eb.text.length);return!0}ndc(X,Z=!1){if(!this.pY.vn)return-1;const da=this.pY.vn.children[0],qa=da.children.length;let O;for(let ca=0;ca<qa;++ca)if(O=da.children[ca],w.a.equals(O.innerText.trim(),X,Z))return ca;return-1}kIg(X,Z,da,qa,O,ca,wa){const ia=da.originalText.replace(aa.Fxf,String.fromCharCode(32)),Ha=new G.Range(X.top-1,X.left,X.bottom-1,X.right,!1,!1),Sa=wa?wa.Mp(da.range):
null;(!da.sH||da.range.left===X.left)&&1<ia.length&&!qa.hb(ia.toUpperCase())&&w.a.KF(ia,Z)&&!w.a.equals(ia,Z,!0)&&!aa.kYe(Z)&&this.acg(ia)&&(!O&&!Sa||!O&&Sa.equals(wa.Mp(Ha))||O&&da.range.zd(ca)&&da.range.top!==ca.top)&&(X=da.formulaBarText,w.a.equals(X,da.text,!1)||!X)&&(X={},X.FirstRow=da.range.top-1,X.FirstColumn=da.range.left-1,da=new v(ia,X),qa.add(ia.toUpperCase(),da))}OIj(X){this.fq=this.e4h();this.NNa&&this.NNa.cancel();0<this.eb.text.length&&0!==X?this.items&&((1<this.items.length||this.re)&&
this.zph(),8!==X&&127!==X&&46!==X&&(1===this.items.length?this.bnd(!1):this.pY.Ej&&this.My(!1))):this.re=!1}zph(){this.re?this.UNe():this.sde=M.AsyncMethodContext.tq(this.UNe,500,L.a.f2g,this.NNa)}bnd(X){c.ULS.shipAssertTag(537167966,0,!this.Rwa()&&1===this.items.length,"Invalid Items");let Z=this.items[0].V9,da=this.eb.text,qa=Z.substring(da.length,Z.length);if(X&&!qa.length)this.eb.text=Z;else if(!X&&0<qa.length)this.eb.appendText(qa),this.eb.textBox.selectRange(da.length,this.eb.text.length);else return;
this.raiseEvent("ACLBMatchedItem",new l.a(this.items.length,0,Z));this.cwa=!0}e4h(){this.fq=null;const X=new N.a(!1);var Z=this.activeCell;this.hDa=this.eb.text.replace(aa.Fxf,String.fromCharCode(32));const da=this.tableManager.Mp(Z),qa=Z.zd(da);if(aa.kYe(this.hDa)||!this.acg(this.hDa))return this.items;const O=new G.Range(1,Z.left,Z.top-1,Z.left,!1,!1);var ca=new G.Range(Z.top+1,Z.left,f.a.Vg,Z.left,!1,!1);let wa;const ia=C.h(this.$);ca=ia.Wj("CellAutoCompleteControl.GetSuggestedCells",ca);try{const Ha=
ia.Wj("CellAutoCompleteControl.GetSuggestedCells2",O);try{for(const Sa of[Ha,ca])for(;Sa.$$mn();)wa=Sa.$$cu(),this.kIg(Z,this.hDa,wa,X,qa,da,this.tableManager)}finally{Ha&&Ha.dispose()}}finally{ca&&ca.dispose()}this.fq=Array(X.values.length);for(Z=0;Z<this.items.length;Z++)this.items[Z]=X.values[Z];this.items.sort((Ha,Sa)=>Ha.V9.localeCompare(Sa.V9));return this.items}ypb(X,Z){X&&Z&&this.v1c.push(new y(X,Z,this.Bif?this:void 0))}bFj(){return this.vmi?this.l1a&&!this.Rwa()&&this.re?this.get_visible():
!1:this.l1a&&!this.Rwa()&&this.get_visible()&&this.re}static get Fxf(){return aa.cfe||(aa.cfe=new RegExp(String.fromCharCode(160),"g"))}static kYe(X){X=0<X.length?X.charCodeAt(0):-1;return 35===X||61===X||43===X||45===X||64===X}}aa.cfe=null;Object(t.a)(aa,"CellAutoCompleteControl",e.a,[264,265,266,2])},1250:function(t,F,a){t=a(0);var c=a(566),b=a(561),e=a(558),f=a(1021);class d{Gfh(H,I){if(H&&!(1>H.length)&&I){var R=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.adh(H,R.ControlList);
I.push(R)}}adh(H,I){const R=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(I,R);I=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(R.Menu.MenuSectionList,I);this.mfh(H,I.ControlList)}mfh(H,I){for(let R=0;R<H.length;R++){const S=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",R),Command:"336231556",
DisplayName:H[R].userName,LabelText:H[R].userName,ImageBackColor:H[R].color,PersonaId:H[R].email,IsAnonymous:H[R].isAnonymous});Array.add(I,S)}}}Object(t.a)(d,"PresenceContextMenuSectionBuilder",null,[699]);var h=a(85),m=a(4),l=a(178),v=a(560),r=a(109),A=a(136),x=a(89),n=a(83),u=a(108),z=a(25);class w{constructor(H,I,R,S){this.C5d=this.Z0=this.Ji=this.QD=this.X7=null;this.TXb=H;this.KDg=S;this.TXb.gMa&&(this.Ji=new r.a(3,2,5E3,Object(h.a)(this,this.yUg,"authenticationCheckTask"),2),m.AFrameworkApplication.hi.fg(this.Ji),
this.Ag(I,R));this.TXb.$nb(()=>{this.Mzf()});this.TXb.NYa(()=>{this.Nzf()})}get businessBar(){return this.Z0||(this.Z0=n.a.instance.mg("CommonUI.IBusinessBar"))}get Iye(){return this.C5d||(this.C5d=n.a.instance.mg("CommonUI.IBusinessBarEntryFactory"))}Ag(H,I){const R=m.AFrameworkApplication.rb;R.Ne(z.a.authenticationLost,u.a.frame,H,96);R.Ne(z.a.twe,u.a.frame,I,96);R.Nb(z.a.CAe,u.a.frame,l.ActionManager.Q8c);R.Nb(z.a.DAe,u.a.frame,l.ActionManager.Q8c);R.Nb(z.a.vvd,u.a.frame,l.ActionManager.Q8c)}Mzf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
m.AFrameworkApplication.rb.processAction(z.a.authenticationLost,2)}Nzf(){this.IQj();m.AFrameworkApplication.rb.processAction(z.a.twe,2)}yUg(){this.TXb.authenticationCheck()}IQj(){this.QD&&(this.QD.hide(),this.QD.dispose(),this.QD=null);this.X7&&this.businessBar&&(m.AFrameworkApplication.rg||this.businessBar.removeEntry(this.X7),this.X7.dispose(),this.X7=null)}showDialog(H){x.a.Ja(this.QD);this.QD=new A.StandardDialog;this.KDg||(this.QD.pt=!1,this.QD.Ob=0);this.QD.tc(1,CommonUIStrings.l_SignIn);this.QD.QR(CommonUIStrings.l_DefaultDialogTitle,
H,Object(h.a)(this,this.iu,"dialogHandler"))}iu(H){1===H?(v.a.p6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),m.AFrameworkApplication.rb.processAction(z.a.vvd,2)):(this.sUd(),m.AFrameworkApplication.rb.processAction(z.a.DAe,2))}sUd(){this.businessBar&&this.Iye&&(this.X7=this.Iye.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.X7.closeable=!0,this.X7.addButton(CommonUIStrings.l_SignIn,w.QZg,""),this.X7.s$=Object(h.a)(this,
this.TZg,"businessBarEntryCloseHandler"),this.businessBar.dE(this.X7,!1))}TZg(){this.Zmh();m.AFrameworkApplication.rb.processAction(z.a.CAe,2)}Zmh(){this.Ji&&(m.AFrameworkApplication.hi.So(this.Ji),this.Ji=null)}dispose(){this.Ji=this.QD=this.X7=null}static QZg(){v.a.p6();m.AFrameworkApplication.rb.processAction(z.a.vvd,2)}}Object(t.a)(w,"SignOutResponseUI",null,[2]);var C=a(252);class y{get name(){return"Common.App.UI"}Ah(H){H.register(d,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").qc()}init(){}dispose(){x.a.Ja(y.I1);
y.I1=null}static main(){C.a.instance.gi(new y)}}y.I1=null;Object(t.a)(y,"CommonAppUIPackage",null,[4,5]);a.d(F,"a",function(){return B});const B=()=>{Type.registerNamespace("CAUI");y.main()}},1251:function(t,F,a){t=a(0);var c=a(55),b=a(226),e=a(1244),f=a(50),d=a(37),h=a(1),m=a(712);class l extends b.a{constructor(z){super();this.$=z;this.Db()}create(){const z=this.$.da,w=f.GetServiceTaskFactory.create(z,134,this.la,this.Xa),C=f.GetServiceTaskFactory.Oa(z,213,214,this.Xa),y=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):c.Task.Ra(null);d.TaskExtensions.za(d.TaskExtensions.Fd([w,C,y],this.la),()=>{if(h.EwaSettings.cl())this.nb(Object(m.a)(this.$.da,1,()=>{const B=new e.CellAutoCompleteControl(this.$,w.result,y.result);C.result.ka(B);return B}));else{let B=z.Aa(1);B||(B=new e.CellAutoCompleteControl(this.$,w.result,y.result),C.result.ka(B));this.nb(B)}},this.la,3)}static ka(z){z.da.Ha(151,
new l(z))}}Object(t.a)(l,"CellAutoCompleteControlFactory",b.a,[]);var v=a(15),r=a(13);class A{constructor(z,w){this.YZa=null;this.OGf=(C,y)=>{1<y.length&&(C=r.a.instance.ga(856),this.ariaLiveNotifier.RRf(C,y.length))};this.PGf=(C,y)=>{v.ULS.shipAssertTag(537167961,0,0<=y.selectedIndex&&0<=y.length&&y.selectedIndex<y.length,"Invalid ListEventArgs: SelectedIndex/Length");v.ULS.shipAssertTag(537167960,0,!!y.EF,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.Ncj(y.EF,y.selectedIndex+
1,y.length)};this.QGf=(C,y)=>{this.ariaLiveNotifier.cQa(y.EF)};this.ariaLiveNotifier=z;h.EwaSettings.cl()||w.Ha(213,this)}dispose(){this.A_d();this.YZa=null}ka(z){z&&(this.YZa=z,z.E_b(this.OGf),z.i2(this.PGf),z.dNg(this.QGf))}A_d(){this.YZa&&(this.YZa.Guc(this.OGf),this.YZa.tda(this.PGf),this.YZa.Ljj(this.QGf))}}Object(t.a)(A,"CellAutoCompleteReadoutHandler",null,[267,2]);class x extends b.a{constructor(z){super();this.$=z;this.Db()}create(){const z=this.$.da;d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(z,
211,212,this.Xa),w=>{if(h.EwaSettings.cl())this.nb(Object(m.a)(z,213,()=>new A(w.result,z)));else{const C=z.Aa(213)||new A(w.result,z);this.nb(C)}},this.la,3)}static ka(z){z.da.Ha(214,new x(z))}}Object(t.a)(x,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var n=a(9);a.d(F,"a",function(){return u});const u=()=>{n.a.Fa(l.ka);n.a.Fa(x.ka)}},1252:function(t,F,a){var c=a(9);t=a(0);var b=a(237),e=a(226),f=a(50),d=a(37),h=a(1),m=a(15),l=a(89),v=a(4),r=a(81),A=a(8),x=a(24),n=a(65),u=a(41),z=a(140),w=a(48),
C=a(44),y=a(12),B=a(13),H=a(21),I=a(27),R=a(19),S=a(51);class G extends r.a{constructor(Y,U,P,aa){super();this.isMac=I.a.isMac;this.Dwa=!1;this.$=Y;this.ariaLiveNotifier=aa;this.$n=P.R5b(Y,null,U,R.a.NTe,S.a.qe(9),B.a.instance.ga(1737),"PulloutPointerDown")}Mig(Y){this.Dwa!==Y&&(this.hide(),(this.Dwa=Y)?this.$n.Fjg(R.a.EAh,S.a.qe(3)):this.$n.Fjg(R.a.NTe,S.a.qe(9)))}get Zy(){return this.$n.Zy}get buttonWidth(){return this.$n.buttonWidth}dispose(){this.$n.dispose();this.$=null;super.dispose()}domElement(Y){return this.$n.domElement(Y)}getButton(Y){return this.$n.getButton(Y,
!1)}$Pb(Y,U){this.$n.$Pb(Y,U,!1)}SAa(Y,U){const P=H.h(this.$),aa=P.ib.yi(Y);this.$n.$Pb(this.Dwa?B.a.instance.ga(1739):U?B.a.instance.ga(1737):B.a.instance.ga(1738),aa);U=this.isMac?U?B.a.instance.ga(1742):B.a.instance.ga(1743):U?B.a.instance.ga(1740):B.a.instance.ga(1741);var X=P.xg(Y,aa);Y=P.Rf(aa).yn;if(X&&0<=X.x&&0<=X.y){const Z=X.bottomRight.x+this.Zy;X=X.topLeft.y-this.Zy-this.buttonWidth;if(X<Y.topLeft.y+this.Zy){if(P.ib.BBa){this.hide();return}X=Y.topLeft.y+this.Zy}this.rp(Z,X,P.rtl,aa);this.ariaLiveNotifier.cQa(U)}else this.hide()}rp(Y,
U,P,aa){this.$n.rp(Y,U,P,aa,!1)}hide(){this.$n.hide()}}Object(t.a)(G,"PulloutLaunchButton",r.a,[]);var D=a(33),E=a(22);class M extends r.a{constructor(Y,U,P,aa,X){super();this.MXa=this.XPc=this.Twc=this.JFa=this.AR=this.xO=null;this.the=0;this.GDb=this.oAb=this.NGc=!1;this.Xg=()=>{this.uwa&&(this.gridView?1===this.gridView.ha.Oe?(this.gridView.ha.qa.activeCell.equals(this.JFa)||this.bN||this.Vx(),this.tpb.Xp()):this.Vx():m.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.Ri=
()=>{this.Vx()};this.dd=()=>{this.HW()};this.uc=()=>{this.Vx()};this.fd=()=>{this.showCallout()};this.Cya=()=>{if(this.Og.Pk&&this.Og.Pk.length)if(this.e0c)this.Og.IAi||(this.NGc=this.Og.Pk[0].BlockingDataForExpand),this.Og.DUh&&m.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.the=this.Og.W6c&&this.Og.QZe<this.Og.W6c.left-1?this.Og.W6c.left-1-this.Og.QZe:-1,this.showCallout();else if(this.gridView.ha.qa.Tg){var Z=this.gridView.ha.qa.activeCell;
if(Z&&this.AR){var da=this.tableManager.Mp(Z);this.MNc=!!da;const qa=this.gridView.ha.qa.ld;da=this.bN&&this.AR.zd(da);const O=this.dkd&&!this.bN&&qa.equals(this.selectedRange);da||O?(m.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.D$b=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.bN&&this.tableManager.Gja(Z)?m.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.bN?this.wh.SAa(this.AR,this.bN):this.wh.SAa(qa,this.bN):this.wh.SAa(this.AR,this.bN),this.Bvc())):m.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.wj=()=>{this.j7a()&&this.wh.hide();1===this.gridView.ha.Oe&&this.HW()};this.bR=()=>{const Z=this.gridView.ha.Oe;this.gridView.ha.qa.activeCell&&1===Z&&this.HW()};this.zt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.bN){if(this.AR&&
this.JFa){var Z=this.tableManager.Mp(this.JFa);Z&&1<Z.bottom-Z.top&&(--Z.bottom,this.gridView.Aba(Z)&&this.tpb.Xp())}}else this.gridView.ha.qa.Tg&&this.gridView.Aba(this.gridView.ha.qa.ld)&&this.tpb.Xp();else this.AR&&this.JFa&&this.bN&&(Z=this.tableManager.Mp(this.JFa))&&1<Z.bottom-Z.top&&(--Z.bottom,this.gridView.Aba(Z)&&this.tpb.Xp())};this.HW=()=>{if(this.$&&this.gridView){if(this.D$b&&this.bN){const Z=this.gridView.ha.qa.activeCell;this.AR=this.TXe();const da=!!this.Twc&&this.Twc.contains(Z);
if(this.AR&&(Z.equals(this.JFa)||da)){this.wh.SAa(this.AR,this.bN);return}}this.D$b=!1;(this.AR=this.TXe())&&this.Lla&&this.gridView&&this.gridView.Ca.Ur(this.Lla)?(this.e0c=!1,this.kZ()):(this.Og.V0c(),this.Og.M2b());this.D$b||this.wh.hide()}};this.$=Y;this.tableManager=P;this.contextMenuManager=aa;this.wh=new G(Y,this.fd,U,X);this.Og=U.A5c(Y,P);this.D$b=this.e0c=!1;this.dkd=h.EwaSettings.sa(128);this.MNc=!0;this.aEa=!1;this.gridView=H.h(this.$);this.gridView.Vb.xl(this.Ri);this.gridView.Uu(this.bR);
this.$.Lk(this.dd);this.$.nj(this.uc);this.$.bC(this.wj);this.gridView.view.Ps(this.zt);this.gridView.ha.lT(this.Xg);this.tpb=w.a.instance.create(this.HW,250,C.a.b$i);m.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Og.v_b(this.Cya);D.a.pAb()&&(this.oAb=!0);this.HW();Y.da.Ha(261,this)}get jc(){return this.wh.domElement(1)}get Lla(){return this.XPc}get selectedRange(){return this.MXa}get bN(){return this.MNc}get Dwa(){return this.aEa}get NPf(){return this.the}get bDb(){const Y=
this.wh.domElement(this.Dea);return Y?y.DOMElementExtensions.isVisible(Y):!1}get uwa(){return this.$.isEditMode&&h.EwaSettings.sa(128)?!(new z.a(this.$.va)).Nh:!1}get EPg(){return this.NGc}get Dea(){return this.Lla?this.gridView.ib.yi(this.xO):1}dispose(){this.gridView&&(this.gridView.ha.tR(this.Xg),this.gridView.view.Jq(this.zt),this.gridView.Vb&&this.gridView.Vb.nl(this.Ri));if(this.$){const Y=this.$;Y.pl(this.dd);Y.ol(this.uc);Y.xF(this.wj);H.h(Y).jy(this.bR)}this.Og&&this.Og.yuc(this.Cya);l.a.Ja(this.wh);
this.Og=this.$=this.gridView=this.tpb=this.wh=null;super.dispose()}Vx(){this.wh.hide()}Ada(){this.wh?this.wh.getButton(this.Dea).Ecb():m.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}poj(){this.AR=null}gPf(){this.wh&&this.wh.hide()}g6h(){if(!this.dkd||1!==this.selectedRange.width)return null;const Y=this.selectedRange.clone();for(;this.gridView.Aba(Y);){Y.left+=1;Y.right+=1;if(!this.gridView.Rf(this.gridView.ib.yi(Y)).fi.De(Y))break;if(!this.gridView.Ca.Ur(Y))continue;
const U=this.gridView.Wj("PulloutManager.GetValidatedRangeToFill",Y,2);try{if(M.T3j(U))return Y}finally{U&&U.dispose()}}return null}Bvc(){this.Og.Gcb()}showCallout(){this.uwa&&(this.Og.O6a?(this.wh.getButton(this.Dea).PHb(),h.EwaSettings.cl()?d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,8,9,0),Y=>{this.j9f(Y.result)},this.$.la,3):this.j9f(this.contextMenuManager)):(this.e0c=!0,this.kZ()))}j9f(Y){Y.zfd("tableFieldList").r0(null,this.wh.domElement(this.Dea),this.Og,null,!0);this.Bvc()}TXe(){if(!this.uwa||
!this.gridView||this.gridView.ha.Sa.dc||!this.gridView.ha.qa.Tg)return null;var Y=this.gridView.ha.qa.activeCell,U=H.h(this.$).ib.yi(Y);if(!Y)return null;this.JFa=Y.clone();var P=this.tableManager.Mp(Y);this.MNc=!!P;if(this.bN){this.wh.$Pb(B.a.instance.ga(1737),U);this.xO=M.Ylg(P);if(!this.xO)return null;Y=!1;U=({jY:Y}=this.tableManager.FGe(P,this.gridView)).returnValue||Y;this.NGc=Y;if(U)return this.Twc=new x.Range(P.top,P.left,P.bottom,P.right,!1,!1),this.XPc=new x.Range(this.xO.top,this.xO.right+
1,this.xO.top,this.xO.right+1,!1,!1),this.oAb&&(this.aEa=!1,this.wh.Mig(this.aEa)),this.xO}else if(this.dkd){this.MXa=this.gridView.ha.qa.ld.clone();P=this.selectedRange.isSingle&&H.h(this.$).wb.Ghf(this.selectedRange);const aa=H.h(this.$).wb.exa(this.selectedRange);this.oAb&&(this.aEa=P&&!aa);this.wh.$Pb(this.aEa?B.a.instance.ga(1739):B.a.instance.ga(1738),U);P&&!aa&&!this.GDb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&E.a.equals(v.AFrameworkApplication.uiCulture,
"en-us",!0)&&(v.AFrameworkApplication.Sp("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.GDb=!0);this.xO=M.Ylg(this.selectedRange);if(!(this.oAb&&P||aa)||!this.xO||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.Gja(this.selectedRange))return null;this.XPc=this.g6h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.Aba(this.selectedRange):
this.gridView.Aba(this.xO))&&this.Lla)return this.oAb&&this.wh.Mig(this.aEa),this.Twc=this.xO,m.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.Lla?this.Lla.toString():"null"}, RightColumnHeader, ${this.xO?this.xO.toString():"null"}, ActiveCell, ${Y?Y.toString():"null"}`),this.xO}return null}kZ(){this.bN?this.Og.kZ(u.v(this.Lla,this.$),!1,!0):this.aEa?this.Og.X5i():h.EwaSettings.sa(128)&&this.Og.kZ(u.v(this.selectedRange,this.$),!0,!1)}j7a(){return this.$.ea.isNamedObjectViewMode&&
n.f(this.$.na)}static T3j(Y){for(;Y.$$mn();)if(Y.$$cu().text||Y.$$cu().sH||Y.$$cu().Vh||Y.Mm.Waf)return!1;return!0}static Ylg(Y){return Y.right===A.a.Ug?null:new x.Range(Y.top,Y.right,Y.top,Y.right,!1,!1)}}Object(t.a)(M,"PulloutManager",r.a,[250,2]);class L extends e.a{constructor(Y){super();this.$=Y;this.Db()}create(){c.a.Fa(Y=>{const U=f.GetServiceTaskFactory.Oa(Y.da,12,477,this.Xa),P=f.GetServiceTaskFactory.Oa(Y.da,66,134,this.Xa),aa=f.GetServiceTaskFactory.Oa(Y.da,211,212,this.Xa);let X=b.a.Ra(null);
const Z=!h.EwaSettings.cl();Z&&(X=f.GetServiceTaskFactory.Oa(Y.da,8,9,this.Xa));d.TaskExtensions.za(d.TaskExtensions.Fd([U,P,X,aa],Y.la),()=>{Z?this.nb(this.$.da.Aa(261)||new M(this.$,U.result,P.result,X.result,aa.result)):this.nb(this.$.da.Aa(261)||new M(this.$,U.result,P.result,null,aa.result))},Y.la)})}static ka(Y){Y.da.Ha(262,new L(Y))}}Object(t.a)(L,"PulloutManagerFactory",e.a,[]);a.d(F,"a",function(){return N});const N=()=>{c.a.Fa(Y=>{Y.sa(128)&&L.ka(Y)})}},1261:function(t,F,a){t=a(0);var c=
a(191);class b{GPj(x,n){x.set_visible(!1);n.set_visible(!0)}}Object(t.a)(b,"DefaultTabSwitchBehaviour",null,[300]);class e{}e.uQj="TabsContainer";e.cQj="TabTitlesContainer";e.aQj="TabTitle";e.bQj="TabTitleText";e.OXd="TabTitleActive";Object(t.a)(e,"MultitabControlStyles",null,[]);var f=a(85),d=a(46),h=a(86),m=a(88),l=a(57);class v{constructor(x,n,u){this.pk=x;this.zp=n;this.wIc=u;this.tfa=document.createElement("a");l.a.Xxc(this.tfa,this.zp);Sys.UI.DomElement.addCssClass(this.tfa,e.bQj);Sys.UI.DomElement.addCssClass(this.pk,
e.aQj);this.pk.appendChild(this.tfa);this.tfa.tabIndex=0;this.xDc();d.a.addHandler(this.pk,"click",this.wIc);d.a.addHandler(this.pk,"keyup",Object(f.a)(this,this.M$a,"onTitleKeyUp"))}get jc(){return this.pk}get title(){return this.zp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.pk,e.OXd)}set isActive(x){this.setActive(x)}dispose(){d.a.removeHandler(this.pk,"keyup",Object(f.a)(this,this.M$a,"onTitleKeyUp"));d.a.removeHandler(this.pk,"click",this.wIc);this.pk=this.tfa=null}setActive(x){x?
Sys.UI.DomElement.addCssClass(this.pk,e.OXd):Sys.UI.DomElement.removeCssClass(this.pk,e.OXd);this.tfa&&this.tfa.setAttribute(m.a.Q9,x)}M$a(x){x.keyCode!==h.a.Jh&&x.keyCode!==h.a.Hea||this.wIc(x)}xDc(){this.pk.setAttribute(m.a.Cd,m.a.qq);this.tfa.setAttribute(m.a.Vu,this.zp);this.tfa.setAttribute(m.a.Cd,m.a.lpb)}}Object(t.a)(v,"TabTitleControl",null,[2]);var r=a(40);a.d(F,"a",function(){return A});class A{constructor(x,n=null,u=null){this.Imb=this.Qmb=null;this.V0=-1;this.pk=x;this.jga=n||new c.a;
this.JEg=u||new b;this.lFa=new c.a;x=0;for(let z of this.jga)this.Utd(this.V0)||(this.V0=x),n=x++,this.lFa.add(new v(document.createElement("li"),z.title,this.Nch(n)))}get sBc(){return this.jga.count}get activeTab(){return this.V0}set activeTab(x){this.hdg(x)}get jc(){return this.pk}get visible(){return r.a.isVisible(this.pk)}set visible(x){this.pk.style.visibility=x?"visible":"hidden"}bXf(){this.Qmb=document.createElement("ul");this.Qmb.className=e.cQj;this.Imb=document.createElement("div");this.Imb.className=
e.uQj;for(let x=0;x<this.sBc;++x){const n=this.jga.ma(x),u=this.lFa.ma(x);n.set_visible(!1);u.isActive=!1;const z=document.createElement("div");n.render(z);this.Imb.appendChild(z);this.Qmb.appendChild(u.jc)}this.jc.appendChild(this.Qmb);this.jc.appendChild(this.Imb);this.Utd(this.V0)&&(this.lFa.ma(this.V0).isActive=!0,this.jga.ma(this.V0).set_visible(!0))}dispose(){for(let x=0;x<this.sBc;++x)this.jga.ma(x).dispose(),this.lFa.ma(x).dispose();this.lFa=this.jga=this.pk=this.Imb=this.Qmb=null}setFocus(){this.jga.ma(this.V0).setFocus()}Utd(x){return 0<=
x&&x<this.sBc}hdg(x){this.V0!==x&&this.Utd(x)&&(this.JEg.GPj(this.jga.ma(this.V0),this.jga.ma(x)),this.lFa.ma(this.V0).isActive=!1,this.lFa.ma(x).isActive=!0,this.V0=x,this.setFocus())}Nch(x){return()=>{this.hdg(x)}}}Object(t.a)(A,"MultitabControl",null,[286,2])},1274:function(t,F,a){var c=a(9);t=a(0);var b=a(7),e=a(226),f=a(50),d=a(37),h=a(1);class m{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(t.a)(m,"FormulaAssistanceUIContext",null,[]);var l=a(204),v=a(186),r=a(105);class A extends e.a{constructor(n){super();
this.Zsj="formulaAssistance";this.$=n;this.Db()}create(){let n=this.$.da.Aa(448);if(n)this.nb(n);else{var u=h.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?l.c(v.a.resolve(r.e,{Tl:this.Xa})):f.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Xa);d.TaskExtensions.za(u,()=>{d.TaskExtensions.za(l.c(u.result.Hl.loadScript(this.Zsj)),()=>{n=this.$.da.Aa(448);if(!n){const z=Object(b.a)(new m,{isFeedbackAllowed:this.$.isFeedbackEnabled});n=this.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(z));
this.$.QBe(()=>{const w={};w.isFeedbackAllowed=this.$.isFeedbackEnabled;n.updateContext(w)})}this.nb(n)},this.$.la,3)},this.$.la,3)}}static ka(n){n.da.Ha(449,new A(n))}}Object(t.a)(A,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(F,"a",function(){return x});const x=()=>{c.a.Fa(n=>{A.ka(n)})}},1275:function(t,F,a){var c=a(9);t=a(0);var b=a(55),e=a(226),f=a(50),d=a(37),h=a(21),m=a(15),l=a(31),v=a(194),r=a(24),A=a(65),x=a(1),n=a(1109),u=a(11),z=a(159),w=a(14),C=a(180),y=a(227),B=a(152),H=a(64),I=a(90);
class R{constructor(D,E,M){this.ENa=1;this.j9=[];this.active=!1;this.htmlSanitizationHelper=null;this.RAb=!1;this.onPointerDown=L=>{B.a.slim(L.Ea.rawEvent);return!1};this.Dw=()=>{const L=this.gridView.ujd();if(!(0>=L||L===this.ENa||this.gridView.Br)){var N=!1,Y=[],U=[];for(var P=this.j9.length-1;0<=P;P--){var aa=this.j9[P];if(this.tjd(aa)>L||aa.bottom<L)Y.push(aa),this.j9.splice(P,1),N=!0}for(P=this.tableManager.rangeList.length-1;0<=P;P--){aa=this.tableManager.rangeList[P];const X=this.tjd(aa);X<=
L&&aa.bottom>=L&&!(X<=this.ENa&&aa.bottom>=this.ENa)&&aa.$ja&&(U.push(aa),N=!0)}if(N){aa=this.gridView.$qc;for(let X of aa)for(let Z of X)for(let da of Z)this.RAb?this.K3g(da,Y,U):this.L3g(da,Y,U,N)}else m.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.ENa=L}};this.YDf=(L,N)=>{N.isRow||N.NXc(this.Fec)};this.ZDf=(L,N)=>{N.isRow||(this.tableManager.rangeList.length||this.deactivate(),N.wMd(this.Fec))};this.Fec=(L,N)=>{if(this.Pd())this.activate();
else if(L=this.active,this.deactivate(),!L){m.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(N=N.Mn)&&this.yag(N.j4,N)};this.IGf=(L,N)=>{!this.gridView.Br&&(this.Pd()?this.activate():(L=this.active,this.deactivate(),L||m.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),N=N.Mn)&&(L=n.a(N.j4),this.yag(L,N)&&N.ERd(L))};this.Vd=()=>{this.gridView.ib.h4?
this.deactivate():this.activate()};this.tableManager=D;this.gridView=E;this.$=E.$;this.htmlSanitizationHelper=M;D.xXc(this.IGf);E.MMg(this.YDf);E.NMg(this.ZDf);this.$.va.Vf(this.Vd);this.$.yb.Vf(this.Vd);this.Que(L=>{L.NXc(this.Fec)});this.RAb=this.gridView.qba;this.Pd()&&(this.activate(),this.Dw(this,null));this.$.da.Ha(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.kMd(this.IGf),this.gridView.zjj(this.YDf),this.gridView.Ajj(this.ZDf),this.$.va.sg(this.Vd),this.$.yb.sg(this.Vd),
this.Que(D=>{D.wMd(this.Fec)}));this.gridView=this.tableManager=this.j9=null}nCc(D,E,M){if(!A.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.BBa)return!0;const L=M.G8e();var N=L.length;if(L[N-1]<D.left)return!1;var Y=u.HelperMethods.Xu(new v.a(L),0,N,D.left,u.HelperMethods.qz);if(0>Y)return!1;const U=D.HYd;N=Math.min(U.length+Y,N);let P=0;for(;Y<N;Y++){const aa=L[Y];E?(M.updateCellText(Y,U[P]),this.Zoe(D,P,aa)):(M.updateCellText(Y,r.Range.vP(aa)),this.VNe(aa));E&&M.Oyj();P++}M.Um("HeaderSnappingFeature::toggleHeaderSnapping");
D.ZAa=E;return!0}oCc(D,E,M,L){if(!A.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.BBa)return!0;if(!M.length)return!1;var N=L.length;if(L[N-1]<D.left)return!1;var Y=u.HelperMethods.Xu(new v.a(L),0,N,D.left,u.HelperMethods.qz);if(0>Y)return!1;const U=D.HYd,P=!!D.vsa&&0<D.vsa.length,aa=!!D.menuModel&&0<D.menuModel.length;for(let da=Y,qa=0,O=Math.min(U.length+Y,N);da<O;da++,qa++)if(N=M[da]){var X=null;(Y=N.getElementsByClassName(l.a.Zad))&&(X=Y[0]);if(X&&X.innerText){if(Y=N.getElementsByClassName(l.a.zse))for(var Z=
Y.length-1;0<=Z;Z--)N.removeChild(Y[Z]);Y=L[da];E?(X.innerText=U[qa],N.classList.add(l.a.hVe),P&&D.vsa[qa]&&(X=document.createElement("div"),x.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")&&this.htmlSanitizationHelper?(this.htmlSanitizationHelper.Ph(X,D.vsa[qa]),Z=D.vsa[qa].split(H.a.mRg),m.ULS.shipAssertTag(509678873,0,3===Z.length,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain command data for ShowAutoFilterMenu"),
Z=I.a.kf(Z[1]),this.nIg(X.firstChild,Z),z.a.instance.ta(w.a.pf,X.firstChild,this.onPointerDown),C.a.instance.ta(w.a.jp,X.firstChild,this.onPointerDown)):X.innerHTML=D.vsa[qa],aa&&D.menuModel[qa]&&this.Zoe(D,qa,Y),N.appendChild(X.firstChild))):(N.classList.remove(l.a.hVe),X.textContent=r.Range.vP(Y),this.VNe(Y))}}D.ZAa=E;return!0}nIg(D,E){y.a.instance.ta(w.a.click,D,M=>{E&&B.a.hrc(M.Ea.rawEvent,966232027,E,this.$.get_id());return!0})}Zoe(D,E,M){this.$.da.gb(8,L=>{L.L$b.rUi(D,E,M)})}VNe(D){this.$.da.gb(8,
E=>{E.L$b.sUi(D)})}L3g(D,E,M,L){const N=D.qt,Y=n.a(D.j4);let U;for(let P=E.length-1;0<=P;P--)U=E[P],this.oCc(U,!1,Y,N)&&E.splice(P,1);for(E=M.length-1;0<=E;E--)U=M[E],this.oCc(U,!0,Y,N)&&this.j9.push(U);L&&D.ERd(Y)}K3g(D,E,M){if(D.M0g()){for(var L=E.length-1;0<=L;L--)this.nCc(E[L],!1,D)&&E.splice(L,1);for(E=M.length-1;0<=E;E--)L=M[E],this.nCc(L,!0,D)&&this.j9.push(L)}}yag(D,E){const M=this.RAb?E.G8e():E.qt;var L=M[0];const N=M[M.length-1],Y=this.F5h(L,N);let U=!1;for(let P=this.j9.length-1;0<=P;P--){const aa=
this.j9[P];N>=aa.left&&L<=aa.right&&(this.RAb?this.nCc(aa,!1,E):this.oCc(aa,!1,D,M),this.j9.splice(P,1),U=!0)}for(let P=0,aa=Y.length;P<aa;P++)if(L=Y[P],this.RAb?this.nCc(L,!0,E):this.oCc(L,!0,D,M))this.j9.push(Y[P]),U=!0;return U}activate(){this.Pd()&&!this.active&&(this.gridView.view.Ps(this.Dw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Jq(this.Dw),this.active=!1)}Pd(){return A.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.BO&&0<this.tableManager.rangeList.length}Que(D){const E=
this.gridView.$qc;for(let M of E)for(let L of M)for(let N of L)D(N)}F5h(D,E){const M=[];if(!this.active)return M;this.ENa=this.gridView.ujd();for(let L=this.tableManager.rangeList.length-1;0<=L;L--){const N=this.tableManager.rangeList[L];N.bottom>=this.ENa&&this.tjd(N)<=this.ENa&&N.left>=D&&N.right<=E&&N.$ja&&M.push(N)}return M}tjd(D){const E=this.gridView.wb.zi(D);return E&&this.tableManager.Xif(D,E.usedRange.topLeft)?D.top+1:D.top}}Object(t.a)(R,"HeaderSnappingFeature",null,[2]);class S extends e.a{constructor(D){super();
this.$=D;this.Db()}create(){const D=f.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Xa),E=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):b.Task.Ra(null);d.TaskExtensions.za(d.TaskExtensions.Fd([E],this.la),()=>{d.TaskExtensions.za(d.TaskExtensions.Fd([D],this.la),()=>{this.nb(this.$.da.Aa(68)||new R(D.result,
h.h(this.$),E.result))},this.la,11)},this.la,3)}static ka(D){D.da.Ha(67,new S(D))}}Object(t.a)(S,"HeaderSnappingFactory",e.a,[]);a.d(F,"a",function(){return G});const G=()=>{c.a.Fa(S.ka)}},1299:function(t,F,a){var c=a(9);t=a(0);var b=a(15),e=a(892),f=a(27),d=a(202),h=a(226),m=a(230),l=a(1),v=a(52),r=a(55),A=a(204),x=a(33),n=a(186),u=a(105);class z extends h.a{constructor(C){super();this.$=C;this.T5b=null;this.Db()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
e.a.then(this.ufh(),C=>{this.nb(C)})}ufh(){if(this.T5b)return this.T5b;const C=m.a.h1a(v.b(),d.a.none,"LoadResource","x10Scheduler loading");if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.qw){const y=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,y);C.setResult(y);return this.T5b=C.task}(l.EwaSettings.ZJ()?y=>n.a.resolve(u.b,{Tl:this.Xa}).then(B=>setTimeout(()=>y(B),0)):y=>this.$.da.gb(266,y))(()=>{this.eAi(y=>{const B=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
y=A.b(r.Task.Ra(y.Hl));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(y,0),x.a.Cpb(this.$)?excelOnlineCalc.x10.ensureGroupAttached(y,2):0]).then(H=>H.some(I=>0<I)).then(H=>{this.$.da.Ha(413,B);C.setResult(B);l.EwaSettings.isChangeGateEnabled("OfficeVSO:7445021_LogAnyPluginInitialized")&&this.$.da.gb(491,I=>{I.IR.anyPluginInitialized=H})})})});return this.T5b=C.task}eAi(C){l.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void n.a.resolve(u.e,{Tl:this.Xa}).then(y=>
C(y)):this.$.da.gb(283,C)}static ka(C){C.da.Ha(414,new z(C))}}Object(t.a)(z,"PluginSchedulerFactory",h.a,[]);a.d(F,"a",function(){return w});const w=()=>{c.a.Fa(C=>{z.ka(C)})}},1300:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(712),f=a(50),d=a(37),h=a(186),m=a(1),l=a(105);class v extends b.a{constructor(A){super();this.$=A;this.Db()}static ka(A){A.da.Ha(521,new v(A))}create(){const A=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();m.EwaSettings.ZJ()?void h.a.resolve(l.g).then(()=>
{this.nb(A())}):d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,266,265,0),()=>{this.nb(Object(e.a)(this.$.da,520,A))},this.$.la,3)}}Object(t.a)(v,"FormulaAuthoringHelperFactory",b.a,[]);a.d(F,"a",function(){return r});const r=()=>{c.a.Fa(A=>{v.ka(A)})}},1464:function(t,F,a){a.r(F);var c={};a.r(c);a.d(c,"AutoSumCommandHandler",function(){return N});var b=a(1099),e=a(0),f=a(709),d=a(173),h=a(15),m=a(181),l=a(60);const v=(Ob,Mc,Dc,$c,td,Yd)=>{if(Mc){const ae=Ob.textBox;Ob.fb||Ob.startEdit(Mc,
!0);Ob.csd=!0;Ob.text=Dc;ae.caretPosition=td;td<Yd&&($c&&Ob.aBa(),ae.selectRange(0,Yd+1),ae.selectRange(td,Yd))}};var r=a(68);class A{constructor(Ob,Mc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=Ob;this.type=Mc}Q4a(){return this.sharedSheetRange}}Object(e.a)(A,"MacroRecorderAutoSumPayload",null,[122]);var x=a(41),n=a(374),u=a(192),z=a(50),w=a(37),C=a(157),y=a(347),B=a(29),H=a(1),I=a(188),R=a(282),S=a(21),G=a(129),D=a(565),E=a(55),M=a(105),L=a(186);let N=class extends m.a{constructor(Ob){super();
this.SNi=Mc=>{const Dc=S.h(this.$);if(Mc=Mc.Result){let $c=x.D(Mc.NewSelection),td=x.D(Mc.NewActiveCell);if($c&&td)if(!Mc.Committed&&Mc.AutoSumFormula){const Yd=Dc.Qb(td);Yd&&(Dc.ha.updateSelection($c,td,60),$c=td=x.D(Mc.MarkedArea),Dc.wJ=2,v(Dc.mc,Yd,Mc.AutoSumFormula,!!$c,Mc.FormulaMarkStart,Mc.FormulaMarkEnd),$c&&td&&Dc.ha.updateSelection($c,td,0),Dc.mc.csd=!1,w.TaskExtensions.za(z.GetServiceTaskFactory.create(this.$.da,153,this.la,0),ae=>{ae.result.dJa(null)},this.la,3))}else Dc.ha.updateSelection($c,
td,60)}};this.$=Ob}Hc(){return!1}executeCommand(Ob,Mc,Dc){Ob=Mc.command;switch(Ob){case 1220954656:case 505713221:Mc=this.XMe(0,Mc);break;case -1537138325:Mc=this.XMe(parseInt(Dc[r.a.Kc].toString(),10),Mc);break;default:Mc=I.a(Ob)}return Mc}wc(Ob,Mc){if(Ob=1===Ob)switch(Mc.command){case 1220954656:case 505713221:case -1537138325:break;default:Ob=!1}return Ob}Mc(){return!1}XMe(Ob,Mc){const Dc=S.h(this.$);Dc.Gg.dM(!1);if(!S.h(this.$).ha.qa.Tg)return Mc=S.h(this.$).ha.qa.dD,h.ULS.sendTraceTag(537170308,
0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${Ob} due to discontinuous selection. Number of selected ranges is ${Mc}`),this.iza(),E.Task.Ra(!1);const $c=Dc.TE();if(!$c)return null;const td=x.v(Dc.ha.qa.ld,this.$),Yd=x.o(Dc.ha.qa.activeCell,this.$),ae=x.o($c,this.$),je=this.$.oa.xa.Wb(),Ke=()=>new A(td,Ob);return this.$.Us(Dc.ha.qa.selectedRanges,!0)?n.a(this.$.userOperationManager,(Fd,fe,ne)=>{var ce=this.$.oa.xa;Fd=R.b(Fd,this.SNi);const te=ce.Na(9,je);te.selectedRange=td;te.activeCell=
Yd;te.autoSumType=Ob;te.topLeftCell=ae;return l.g(ce,"AutoSum",te,Fd,fe,ne,Ob,0)},Fd=>new u.a(502,0,Fd,64,Ke),Mc):E.Task.Ra(!1)}iza(){D.a(G.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var Ob=B.a.ed(1,1,750,2189,0,371863010,"DiscontinuousSelectionBlocking");H.EwaSettings.kz()?new y.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg())}};N=Object(d.b)([Object(L.d)(M.a),Object(d.c)(0,Object(M.f)())],N);Object(e.a)(N,"AutoSumCommandHandler",m.a,[221]);class Y extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new N(this.$)])}static ka(Ob){f.a.Ld(96,
new Y(Ob))}}Object(e.a)(Y,"AutoSumCommandHandlerFactory",f.a,[]);var U=a(9);String(c);window.___1675790528500_closurehack=c;var P=a(174),aa=a(268),X=a(38),Z=a(323),da=a(1100),qa=a(250),O=a(66);class ca extends X.a{constructor(Ob,Mc,Dc){super();this.cPi=($c,td)=>{if(!qa.a($c)&&td){const Yd=!!$c&&!!$c.RequestTelemetryData;S.h(this.$).vh.zla(td.toString(),$c.StateId,Yd?$c.RequestTelemetryData.EcsOperationDuration:0,Yd?$c.RequestTelemetryData.EcsRequestDuration:0,Yd?$c.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=Ob;this.tableManager=Mc;this.Lh=Dc}PLg(Ob){this.addHandler("ekcvc",Ob)}Kij(Ob){this.removeHandler("ekcvc",Ob)}Hc(){return!1}executeCommand(Ob,Mc){Ob=Mc.command;switch(Ob){case -730106152:Mc=this.lkd(Mc,3);break;case -1228228458:Mc=this.lkd(Mc,4);break;case -848953656:case 2045211913:if(this.asi()){Mc=E.Task.Ra(!0);break}Mc=this.lkd(Mc,1);break;default:Mc=I.a(Ob)}return Mc}wc(Ob,Mc){if(Ob=1===Ob)switch(Mc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:Ob=
!1}return Ob}Mc(){return!1}lkd(Ob,Mc){const Dc=S.h(this.$),$c=Dc.ha.qa.selectedRanges,td=Ob.command,Yd=P.a.create().toString();if(!this.$.Us($c,!0)&&-730106152!==td)return E.Task.Ra(!0);const ae=x.r($c,this.$);this.KIj(td,Dc,$c,Yd);H.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.kaj();const je=this.$.oa.xa.Wb({xla:!0,qka:1}),Ke=()=>new da.a(Mc,ae);return n.a(this.$.userOperationManager,(Fd,fe,ne)=>{this.$.my();return l.d(this.$.oa.xa,Mc,ae,!1,R.b(Fd,
this.cPi),fe,ne,Yd,je)},Fd=>new u.a(508,0,Fd,67,Ke),Ob)}KIj(Ob,Mc,Dc,$c){if(-848953656!==Ob&&2045211913!==Ob&&-730106152!==Ob&&-1228228458!==Ob)h.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${Ob}.`);else if(!aa.a.any(Dc,Yd=>0<Mc.getRangeInformation(Yd).length)){var td=aa.a.any(Dc,Yd=>this.tableManager.rtd(Yd));if(-730106152!==Ob&&-1228228458!==Ob||!td)this.HMj(Mc,Ob,$c,Dc),-730106152!==Ob&&-1228228458!==Ob||this.Lh.Xda(Mc,-730106152,{}),-1228228458!==
Ob&&2045211913!==Ob&&-848953656!==Ob||this.Lh.Y4g(Dc,$c),Mc.vh.UR($c,O.BasicTelemetryCalculator.zQ)}}HMj(Ob,Mc,Dc,$c){let td="";switch(Mc){case -1228228458:td="ClearAll";break;case 2045211913:case -848953656:td="ClearContent";break;case -730106152:td="ClearFormat";break;default:h.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Mc}.`)}Mc=$c.length;$c=x.b($c);Ob.vh.u0(15,Dc,td+(", ranges to clear: "+Mc+", cells to clear: "+$c))}kaj(){this.raiseEvent("ekcvc",
new Z.a)}asi(){if(S.h(this.$).dz){const Ob=this.$.da.Aa(296);return!!Ob&&Ob.kU.YA}return!1}}Object(e.a)(ca,"ClearCommandHandler",X.a,[221,696]);class wa extends f.a{constructor(Ob){super(Ob)}hd(){const Ob=z.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Xa),Mc=z.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa);w.TaskExtensions.za(w.TaskExtensions.Fd([Ob,Mc],this.la),()=>{const Dc=new ca(this.$,Ob.result,Mc.result);this.$c([Dc]);this.$.da.Ha(313,Dc)},this.la,3)}static ka(Ob){f.a.Ld(101,
new wa(Ob))}}Object(e.a)(wa,"ClearCommandHandlerFactory",f.a,[]);var ia=a(1250),Ha=a(1101),Sa=a(1163),Da=a(1103),ea=a(1104),sa=a(1174),Ea=a(89),ba=a(226),ka=a(4),Ca=a(108),db=a(46),yb=a(11),kb=a(85),mb=a(150);class W{}W.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(e.a)(W,"FileUploadDialogHTML",null,[]);var Q=a(156),va=a(25);class na extends mb.a{constructor(Ob){super(!1,!1,na.Iu);this.Rxd=!1;this.iuf=!0;this.rtf=0;this.Ob=1;this.tc(1,CommonUIStrings.l_Send);this.tc(0,CommonUIStrings.l_NoThanks);this.og=W.HTML;this.ktf=Ob;this.pe=na.q_g}kj(Ob,Mc,Dc,$c=!1,td=!0){this.Rxd=$c;this.UHj(Mc);this.rtf=Ob;td&&ka.AFrameworkApplication.AF(Ob)}UHj(Ob){if(na.Iu)this.CJj(Ob);else{var Mc={};Mc[na.m_g]=Ob;Mc[na.s_g]=CommonUIStrings.l_SendFileErrorReportMessage;Mc[na.t_g]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Mc[na.q0c]="";Mc[na.p_g]=CommonUIStrings.l_UserReportLinkText;Mc[na.r2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(kb.a)(this,this.izi,"legacyDialogHandler"),Mc);this.AW(na.y_g)}}CJj(Ob){Ob={["id"]:this.pe,["bodyControls"]:{["reportErrorCheckboxProps"]:this.Rxd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.iuf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:ka.AFrameworkApplication.Ema,["target"]:"_blank"}}},["errorMessage"]:Ob,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(kb.a)(this,this.qJd,"reactDialogHandler"),Ob)}r$a(){if(!na.Iu){var Ob=document.getElementById(na.v_g);Ob&&(Ob.className=na.u_g,Ob.appendChild(Q.createClusteredImage(32,32,na.r_g,null,!0,CommonUIStrings.l_DialogError)));
if(Ob=document.getElementById(na.w_g))Ob.innerText=CommonUIStrings.l_PrivacyStatement,Ob.href=ka.AFrameworkApplication.Ema,db.a.addHandler(Ob,"click",Object(kb.a)(this,this.BXi,"onPrivacyClickHandler"));this.iuf||(Ob=document.getElementById(na.q0c))&&Ob.parentNode&&Ob.parentNode.removeChild(Ob);this.Rxd||(Ob=document.getElementById(na.o_g))&&Ob.parentNode&&Ob.parentNode.removeChild(Ob)}}zD(){na.Iu||(super.zD(),document.getElementById(this.Dh("WACDialogPanel")).style.width=String.format("{0}px",400))}izi(Ob,
Mc){const Dc=Mc[na.q0c]||"";let $c=!0;void 0!==Mc[na.r2b]&&null!==Mc[na.r2b]&&($c=Mc[na.r2b]);this.iu(Ob,Dc,$c)}qJd(Ob,Mc){this.iu(Ob,Mc.text||"",Mc.reportErrorChecked)}iu(Ob,Mc,Dc){this.ktf&&(Dc&&h.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.rtf),this.ktf(Ob,Mc,Dc))}BXi(Ob){ka.AFrameworkApplication.rb.Wd(va.a.pIb,2,Ob)}get nY(){return!1}static get Iu(){return ka.AFrameworkApplication.ra.Qa.sv&&ka.AFrameworkApplication.ra.Qa.Csi}}na.m_g="WACDialogErrorMessage";na.s_g=
"WACDialogErrorReportMessage";na.t_g="WACDialogErrorTextPrompt";na.q0c="WACDialogInput";na.w_g="WACDialogPrivacyText";na.v_g="WACDialogIconPanel";na.r_g="CancelRequest_32x32x32";na.u_g="WACDialogIcon";na.y_g="WACDialogTextPanel";na.r2b="WACDialogSendFileCheckbox";na.o_g="WACDialogSendFileCheckboxContainer";na.p_g="WACDialogSendFileCheckboxText";na.q_g="FileUploadErrorDialog";Object(e.a)(na,"FileUploadErrorDialog",mb.a,[]);class Ba extends X.a{constructor(Ob){super();this.zOf=0;this.QG=null;this.Ehj=
Mc=>{this.Uij(Mc)};this.n6g=(Mc,Dc)=>{if(1===Mc&&this.QG.FileCollectionErrorStateId){Mc=this.$.oa.xa;var $c=this.QG.MessageId,td=this.QG.OriginalEcsServerId,Yd=this.QG.FileCollectionErrorStateId;const ae=Mc.Na(0);ae.errorMessageId=$c;ae.ecsServerId=td;ae.fileCollectionErrorStateId=Yd;ae.userComment=Dc;Mc.G0c("CollectFile",ae,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=Ob}$Lg(Ob){this.addHandler("fileCollectionComplete",Ob)}Uij(Ob){this.removeHandler("fileCollectionComplete",
Ob)}m6g(Ob,Mc,Dc){this.zOf=Mc;this.QG=Ob;this.$Lg(Dc);ka.AFrameworkApplication.Ema=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;Ob=new na(this.n6g);ka.AFrameworkApplication.rb.Nb(va.a.pIb,Ca.a.frame,Ba.Q8i);Ob.kj(0,"",null,!1,!1)}static Q8i(Ob,Mc,Dc,$c,td){db.a.du(td);ka.AFrameworkApplication.Ema&&yb.HelperMethods.gf(ka.AFrameworkApplication.Ema,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(e.a)(Ba,"FileCollectionOperation",X.a,[698,2]);class Oa extends ba.a{constructor(Ob){super();
this.zTb=null;this.$=Ob;this.Db()}get wFh(){return this.zTb||(this.zTb=new Ba(this.$))}create(){w.TaskExtensions.za(z.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(this.wFh)},this.la,3)}dispose(){Ea.a.Ja(this.zTb);this.zTb=null;super.dispose()}static ka(Ob){Ob.da.Ha(125,new Oa(Ob))}}Object(e.a)(Oa,"FileCollectionCommandHandlerFactory",ba.a,[]);var oa=a(1177),Ja=a(1107),Wb=a(1274),nc=a(7),Yb=a(653);class pb{}Object(e.a)(pb,"FreezePanesCommandParameters",null,[]);var Fa=a(8),
ab=a(187),Gb=a(24),Ga=a(390),Ma=a(28),Qa=a(272),wb=a(274),Na=a(116);const ya=(Ob,Mc,Dc,$c,td,Yd,ae=null)=>{ae=Ob.Na(9,ae);ae.freezeSettings=Mc;return l.g(Ob,"FreezeOrUnfreezePanes",ae,Dc,$c,td,Yd,0)};class nb{constructor(Ob){this.freezeOptions=null;this.freezeOptions=Ob}getSheetName(){return this.freezeOptions.SheetName}}Object(e.a)(nb,"MacroRecorderSheetPaneFrozenPayload",null,[122]);var vb=a(45);class gb{constructor(Ob,Mc){this.Lac=this.tId=null;this.dDf=()=>{H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Dvc();if(this.Lac){const Dc=Qa.a(Ma.a.Ya.ue,this.Lac);h.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Dc}`);this.Lac=null}this.KKf()};this.$=Ob;this.gridView=S.h(Ob);this.ZC=Mc.Gsb(this.$.domElement,500,null,null);this.gLa=this.fLa=-1}Hc(Ob,Mc){let Dc=!1;switch(Mc){case 1844679312:Dc=1!==Ob&&!this.gridView.ib.h4}return Dc}executeCommand(Ob,Mc){Ob=this.gridView.ib;const Dc=this.gridView.Kjd();
ka.AFrameworkApplication.ra.Qa.tw&&this.$.SZ&&(1844679312===Mc.command||340334732===Mc.command||-806625837===Mc.command)&&Yb.ShyRibbon.bJ(1,2);switch(Mc.command){case 1844679312:return this.setFreezePanes(Mc,Dc,Ob.gj);case 340334732:return Ob.cac?E.Task.Ra(!1):this.Gyj(Mc,Dc);case -806625837:return Ob.BBa?E.Task.Ra(!1):this.Hyj(Mc,Dc)}return E.Task.Ra(!1)}wc(Ob,Mc){Ob=!1;switch(Mc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:Ob=!0}return Ob}Mc(){return!1}setFreezePanes(Ob,
Mc,Dc){if(Dc)return this.lxc(Ob,!1,0,0,0,0,Mc,null);var $c=this.gridView.ha.qa;Dc=$c.activeCell.clone();$c=$c.activeRange;$c.Rg&&(h.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Dc.top}) and firstUnfreezeCell.Bottom (${Dc.bottom}) to equal topLeftRange.Top (${Mc.top})`),Dc.top=Dc.bottom=Mc.top);$c.isRow&&(h.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Dc.left}) and firstUnfreezeCell.Right (${Dc.right}) to equal topLeftRange.Left (${Mc.left})`),
Dc.left=Dc.right=Mc.left);Dc.top===Mc.top&&Dc.left===Mc.left&&(Dc=Gb.Range.Pc(Dc.top+1,Dc.left));$c=Dc.top-1;const td=Dc.left-1,Yd=$c-(Mc.top-1),ae=td-(Mc.left-1);return this.h4j(Dc,Yd,ae)?this.lxc(Ob,!0,$c,td,Yd,ae,Mc,Dc):(this.$.qf(),this.KKf(),E.Task.Ra(!0))}Gyj(Ob,Mc){return this.lxc(Ob,!0,0,Mc.left,0,1,Mc,null)}Hyj(Ob,Mc){return this.lxc(Ob,!0,Mc.top,0,1,0,Mc,null)}h4j(Ob,Mc,Dc){const $c=this.gridView.xg(Ob),td=this.gridView.view.visibleArea;return!$c||td.topLeft.y>$c.bottomRight.y||td.topLeft.x>
$c.bottomRight.x||td.bottomRight.y<$c.bottomRight.y||td.bottomRight.x<$c.bottomRight.x?(h.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${Ob}, rangeViewportArea=${$c?$c.toString():"null"}, visibleArea=${td.toString()}`),Ob=B.a.ed(1,0,26,1488,0,2105967339,"FreezePaneSelectionNotInViewErr"),H.EwaSettings.kz()?new y.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg()),!1):0>=
Mc&&0>=Dc?(h.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),Ob=S.h(this.$).rtl?1490:1489,Mc=S.h(this.$).rtl?-2131054257:-1953454131,Ob=B.a.ed(1,0,26,Ob,0,Mc,"FreezePaneA1SelectedErr"),H.EwaSettings.kz()?new y.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg()),!1):!0}lxc(Ob,Mc,Dc,$c,td,Yd,ae,je){this.tId=vb.a(this.$).q9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.iT(this.dDf);this.ZC.XSa();
this.gridView.lNj(Mc?"":"UnsetFreezePane");this.dBj(Ob,Mc,this.gridView.ib);const Ke=Object(nc.a)(new pb,{SheetName:this.$.na.name,Freeze:Mc,FrozenRows:td,FrozenColumns:Yd,FirstRow:Dc,FirstColumn:$c});h.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Mc}, FrozenRows=${td}, FrozenColumns=${Yd}, FirstRow=${Dc}, FirstColumn=${$c} `);const Fd=()=>new nb(Ke);this.Lac=Ma.a.Ya.ue;return n.a(this.$.userOperationManager,(fe,ne,ce)=>{if(H.EwaSettings.sa(59)){var te=
window.performance;te.clearMarks();te.mark("FreezePanes request sent")}(te=this.gridView.Ap)?(te=this.xth(Ke,te,ae,je),this.FUj(te)):this.$.my();return ya(this.$.oa.xa,Ke,fe,ne,ce,Mc)},fe=>new u.a(151,0,fe,void 0,Fd),Ob)}xth(Ob,Mc,Dc,$c){h.ULS.shipAssertTag(537159580,1,!!Mc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!Ob.Freeze)return null;const td=wb.a();td.State=1;td.IsEstimated=!0;let Yd=!1,ae=!1;const je=Mc.fQ(Gb.Range.Pc(Dc.top,Dc.left));
let Ke=Ob.FrozenRows;var Fd=Ob.FrozenColumns;1!==Ob.FrozenRows||Ob.FrozenColumns?Ob.FrozenRows||1!==Ob.FrozenColumns?(Fd=Mc.fQ(Gb.Range.Pc(Ob.FirstRow+1,Ob.FirstColumn+1)),Mc=Mc.fQ(Gb.Range.Pc(Dc.top,Dc.left)),td.Width=Fd.oj-je.oj,td.Height=Fd.Dj-je.Dj,0<Ob.FrozenRows&&(td.AbsoluteTop=Fd.Dj,ae=!0),0<Ob.FrozenColumns&&(td.AbsoluteLeft=Fd.oj,Yd=!0),Ke=Fd.MK-Mc.MK,Fd=Fd.fJ-Mc.fJ):(td.Width=Mc.hid(ab.a.Pc(Dc.top,Dc.left)),$c=Gb.Range.Pc(Dc.top,Dc.left+1),td.AbsoluteLeft=je.oj+td.Width,Yd=!0):(td.Height=
Mc.gid(ab.a.Pc(Dc.top,Dc.left)),$c=Gb.Range.Pc(Dc.top+1,Dc.left),td.AbsoluteTop=je.Dj+td.Height,ae=!0);ae&&(td.FirstFrozenRow=Dc.top,td.FirstScrollableRow=$c.top);Yd&&(td.FirstFrozenColumn=Dc.left,td.FirstScrollableColumn=$c.left);td.VisibleRows=Ke;td.VisibleColumns=Fd;return td}FUj(Ob){E.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.VW(Fa.a.oe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Ga.b(this.$.na,Ob,-1,void 0,!0))})}dBj(Ob,
Mc,Dc){if(!H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(Ob.command){case 1844679312:if(Mc||-1===this.fLa&&-1===this.gLa)this.fLa=Dc.mx-Dc.width+this.gridView.scrollLeft,this.gLa=Dc.nx-Dc.height+this.gridView.scrollTop;break;case 340334732:if(Mc||-1===this.fLa)this.fLa=Dc.mx-Dc.width+this.gridView.scrollLeft;break;case -806625837:if(Mc||-1===this.gLa)this.gLa=Dc.nx-Dc.height+this.gridView.scrollTop}}Dvc(){const Ob=this.gridView.ib;0<Ob.width?
this.gridView.scrollLeft=Na.a.a2b(this.gridView.domElement,S.h(this.$).rtl,0):-1!==this.fLa&&(this.gridView.scrollLeft=this.fLa,this.fLa=-1);0<Ob.height?this.gridView.scrollTop=0:-1!==this.gLa&&(this.gridView.scrollTop=this.gLa,this.gLa=-1)}KKf(){this.ZC.cTa();Ea.a.Ja(this.tId);this.tId=null;this.gridView.MN(this.dDf)}}Object(e.a)(gb,"FreezePanesCommandHandler",null,[221]);class cb extends f.a{constructor(Ob){super(Ob)}hd(){w.TaskExtensions.za(z.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa),
Ob=>{this.$c([new gb(this.$,Ob.result)])},this.$.la)}static ka(Ob){Ob.da.Ha(116,new cb(Ob))}}Object(e.a)(cb,"FreezePanesCommandHandlerFactory",f.a,[]);var La=a(1191),ja=a(27),Ua=a(561),lb=a(558),sb=a(30),V=a(1015),za=a(1108);a(315);var Ra=a(13),Xa=a(33);class $a{constructor(Ob,Mc){this.$=Ob;this.fontServiceManager=Mc;this.menuId=this.f0c=this.jO=this.Gua=null;this.rdd=0;this.qIi="+mn-lt";this.rFi="+mj-lt";this.eSi=()=>{this.m4f()};this.xXi=Dc=>{this.$kf=!0;this.$.Sx($c=>{$c.KPa("FontName_New")});
h.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Dc}`)};this.Zli=!!String.fromCodePoint&&!ja.a.rv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.$kf=!1;this.Rl=H.EwaSettings.Rl();this.gridView=S.h(this.$);(this.jl=Xa.a.jl())&&this.fontServiceManager&&(this.fontServiceManager.Nhc?this.m4f():this.fontServiceManager.gre(this.eSi))}get themesManager(){this.ix||(this.ix=this.$.da.Aa(422));return this.ix}m4f(){this.jO=this.fontServiceManager.hBc;this.Gua=
this.fontServiceManager.lJh;this.rdd=2}get hBc(){return this.jO}u_e(Ob,Mc,Dc,$c=null){const td=Object.assign(new Ua.a,{Id:"FontDropdownMenu"});td.MenuSectionList=[];if(this.Rl&&this.themesManager){this.themesManager.B$b($c);if((null==this.themesManager.NF||this.themesManager.xtd)&&!H.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return td;$c=Object.assign(new lb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Ra.a.instance.ga(1334),ControlList:this.L4h(Ob,Mc,Dc)});td.MenuSectionList.push($c)}$c=
Object.assign(new lb.a,{ControlsId:"FontsMenuSectionControl"});if(this.Rl||this.jl)$c.Title=Ra.a.instance.ga(1335);$c.ControlList=this.qVh(Ob,Mc,Dc);td.MenuSectionList.push($c);return td}L4h(Ob,Mc,Dc){var $c;const td=[];var Yd=this.gridView.ha.Sa.dc;Yd=5===(null===($c=null===Yd||void 0===Yd?void 0:Yd.floatingObject)||void 0===$c?void 0:$c.type);let ae,je;this.themesManager.NF?(ae=this.themesManager.NF.zzd,je=this.themesManager.NF.kyd):h.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");($c=this.hJe(je,
1,Yd,Ob,Mc,Dc))&&td.push($c);(Ob=this.hJe(ae,2,Yd,Ob,Mc,Dc))&&td.push(Ob);return td}hJe(Ob,Mc,Dc,$c,td,Yd){var ae=2===Mc?this.qIi:this.rFi;let je;if(Ob)Dc=Dc?ae:sb.a.Xe(Ob),ae=sb.a.Xe(yb.HelperMethods.udc(Ob,Mc)),je=sb.a.Xe(Ob);else{if(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return null;Dc=Dc?ae:void 0;ae=sb.a.Xe(String.fromCodePoint(0));je="msofp"}return Object.assign(new V.a,{MenuItemId:2===Mc?za.b:za.a,CommandValueId:Dc,LabelText:ae,LabelCss:String.format("font-size:12pt;font-family:{0};",
je),Styles:$a.rxb(je),AriaLabel:ae,Alt:ae,Command:$c.toString(),CommandPreviewId:td.toString(),CommandRevertId:Yd.toString(),Disabled:!Ob})}qVh(Ob,Mc,Dc){if(this.f0c)return this.f0c.F7c;let $c;const td=yb.HelperMethods.ZQ(()=>{const Yd=this.Zli&&!this.$kf;let ae=!1;this.Gua||(this.Kef(),ae=!0,H.EwaSettings.isChangeGateEnabled("OfficeVSO:7477088_FontServiceRetryAndLogs")&&h.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));
$c=this.IHe(Ob,Mc,Dc,this.Gua,Yd,ae);$c.ezc&&!ae&&(h.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Kef(),$c=this.IHe(Ob,Mc,Dc,this.Gua,Yd,$c.ezc));this.jl&&!$c.ezc&&(this.f0c=$c);Yd&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.xXi)});10<td&&h.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${td}`);return $c.F7c}IHe(Ob,
Mc,Dc,$c,td,Yd){const ae=[];let je;const Ke=this.jl&&!Yd;je=Ke?"msofpNew":"msofp";for(let te in $c){var Fd=te,fe=$c[te],ne=sb.a.Xe(Fd),ce=void 0;if(Ke)if(ce=this.jO?this.jO[Fd]:null)ce=sb.a.Xe(ce);else return h.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Fd}`),{ezc:!0,F7c:[]};else ce=sb.a.Xe(yb.HelperMethods.jO[Fd]);Fd=sb.a.Xe(Fd);td||(fe=0);ne=Object.assign(new V.a,{MenuItemId:ne,CommandValueId:ne,
LabelText:td&&0<fe?sb.a.Xe(String.fromCodePoint(fe)):ce,LabelCss:String.format("font-size:12pt;font-family:{0};",td&&0<fe?je:Fd),Styles:$a.rxb(td&&0<fe?je:Fd),AriaLabel:ce,Alt:ce,Command:Ob.toString(),CommandPreviewId:Mc.toString(),CommandRevertId:Dc.toString()});ae.push(ne)}return{ezc:Yd,F7c:ae}}Czj(Ob){this.menuId=Ob}Moi(){return 2!==this.rdd&&3!==this.rdd?!1:!0}Kef(){this.Gua={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,
["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,
["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static rxb(Ob){const Mc={};Mc["font-family"]=Ob;Mc["font-size"]="12pt";Ob={};Ob.optionText=Mc;return Ob}}
Object(e.a)($a,"FontDropdownHelper",null,[695]);var ma=a(712);class fa extends ba.a{constructor(Ob){super();this.$=Ob;this.Db()}create(){H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.gb(504,Ob=>{this.nb(Object(ma.a)(this.$.da,502,()=>new $a(this.$,Ob)))}):this.nb(Object(ma.a)(this.$.da,502,()=>new $a(this.$,null)))}static ka(Ob){Ob.da.Ha(503,new fa(Ob))}}Object(e.a)(fa,"FontDropdownHelperFactory",ba.a,[]);var eb=a(1275),ua=a(1110),xa=a(1251),tb=
a(1213),Qb=a(1161),pc=a(1186),hb=a(1299),ib=a(1252),Vb=a(1239);class wc{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,Mc){Ob=!1;Mc=Mc.command;switch(Mc){case 1910465940:Ob=!0}return Ob?E.Task.Ra(!0):I.a(Mc)}wc(Ob,Mc){switch(Mc.command){case 1910465940:return!0;default:return!1}}Mc(){return!1}}Object(e.a)(wc,"NameManagerCommandHandler",null,[221]);class Lc extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new wc(this.$)])}static ka(Ob){f.a.Ld(493,new Lc(Ob))}}Object(e.a)(Lc,"NameManagerCommandHandlerFactory",
f.a,[]);var Fc=a(1197),fd=a(1203),Ta=a(1300),Fb=a(136);class ic extends Fb.StandardDialog{constructor(){super();this.iu=()=>{this.hide()}}showDialog(Ob,Mc){try{this.pe="OfficePyBlockPythonEditDialog",this.Ob=0,this.show({["type"]:"StandardDialogProps",["id"]:this.pe,["headerText"]:Ob,["resultHandler"]:this.iu,["titleText"]:Mc})}catch(Dc){this.$Fc(Ob,Mc)}}$Fc(Ob){const Mc=new mb.a(!1,!1,!1);Mc.Ob=0;Mc.pe="OfficePyBlockPythonEditLegacyDialog";Mc.initializeAndShow(Ob,this.iqg,null)}iqg(){this.hide()}}
Object(e.a)(ic,"OfficePyBlockPythonEditDialog",Fb.StandardDialog,[]);class zb{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,Mc){Ob=!1;Mc=Mc.command;switch(Mc){case 883532127:(new ic).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),Ob=!0}return Ob?E.Task.Ra(!0):I.a(Mc)}wc(Ob,Mc){switch(Mc.command){case 883532127:return H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",
!1);default:return!1}}Mc(){return!1}}Object(e.a)(zb,"OfficePyUXCommandHandler",null,[221]);class Bb extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new zb(this.$)])}static ka(Ob){f.a.Ld(532,new Bb(Ob))}}Object(e.a)(Bb,"OfficePyUXCommandHandlerFactory",f.a,[]);class ec{constructor(Ob,Mc){this.$=Ob;this.properties=Mc}static getInstance(Ob,Mc){return this.La||(this.La=new this(Ob,Mc))}static XAb(){return!!this.La}g9f(){ge.hcc(this.$,this.properties).Izc(2,null)}dispose(){ec.La=null}uz(){this.dispose()}Lya(){}owb(){return{}}}
Object(e.a)(ec,"AlignmentTaskPaneManager",null,[2]);var Qd=a(176),fc=a(1346);class cd{constructor(Ob,Mc){this.$=Mc;this.Ddd=Ob}showTaskPane(Ob,Mc){void Qd.UISurfaces.ej().then(Dc=>{Dc.showTaskPane("FormatCellsTaskPane",this.gu(Ob,Mc));return null})}updateTaskPane(Ob,Mc){void Qd.UISurfaces.ej().then(Dc=>{Dc.updateTaskPane("FormatCellsTaskPane",this.gu(Ob,Mc));return null})}hideTaskPane(){void Qd.UISurfaces.ej().then(Ob=>{Ob.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");
}selectTaskPane(){throw Error("Method not implemented.");}gu(Ob,Mc){Ob={type:"FormatCellsTaskPaneProps",activePage:Ob,callbacks:this.Ddd.owb(),viewModelData:Mc};return Object.assign(new fc.a,{contentProps:Ob,actionButtonProps:0!==Ob.activePage&&{label:"Back",icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(0,null)}},onHide:()=>{this.Ddd.Lya()},onClose:()=>{this.Ddd.uz()},width:320})}}Object(e.a)(cd,"FormatCellsTaskPane",null,[572]);var jd;(function(Ob){Ob[Ob.noFormat=
-1]="noFormat";Ob[Ob.general=0]="general";Ob[Ob.number=1]="number";Ob[Ob.currency=2]="currency";Ob[Ob.accounting=3]="accounting";Ob[Ob.date=4]="date";Ob[Ob.time=5]="time";Ob[Ob.percentage=6]="percentage";Ob[Ob.fraction=7]="fraction";Ob[Ob.scientific=8]="scientific";Ob[Ob.text=9]="text";Ob[Ob.special=10]="special";Ob[Ob.custom=11]="custom";Ob[Ob.maxCategory=12]="maxCategory"})(jd||(jd={}));Object(e.b)("NumberFormatCategory",jd);var nd=a(785),vd=a(1116),wd=a(1313);class Td{constructor(){this.negativeCurrencyTypes=
this.negativeNumberTypes=this.categoryDescriptionStrings=this.categories=null;this.decimalPlaces=this.currentCategory=0;this.isComma=!1}}Object(e.a)(Td,"NumberFormatModel",null,[]);class jc{constructor(){this.alignmentModel=this.numberFormatModel=null}}Object(e.a)(jc,"FormatCellsViewModel",null,[]);class bd{constructor(Ob,Mc){this.R0b=!1;this.Nsb=null;this.categoryDescriptionStrings=[Ra.a.instance.ga(484),Ra.a.instance.ga(485),Ra.a.instance.ga(486),Ra.a.instance.ga(487),Ra.a.instance.ga(488),Ra.a.instance.ga(489),
Ra.a.instance.ga(490),Ra.a.instance.ga(491),Ra.a.instance.ga(492),Ra.a.instance.ga(493),Ra.a.instance.ga(494),Ra.a.instance.Ta(746)];this.Jya=()=>{let Dc=new jc,$c=new Td;$c.categories=this.numberFormatViewModel.gk.Categories;$c.categoryDescriptionStrings=this.categoryDescriptionStrings;$c.negativeNumberTypes=this.numberFormatViewModel.gk.NegativeNumberTypes;$c.negativeCurrencyTypes=this.numberFormatViewModel.gk.NegativeCurrencyTypes;let td=this.numberFormatViewModel.mxb();this.Nsb=td;$c.currentCategory=
td.NumberFormatCategory;$c.decimalPlaces=td.DecimalPlaces;$c.isComma=td.IsComma;Dc.numberFormatModel=$c;ge.hcc(this.$,this.properties).Izc(1,Dc)};this.Iya=()=>{};this.$=Ob;this.properties=Mc}static getInstance(Ob,Mc){return this.La||(this.La=new this(Ob,Mc))}static XAb(){return!!this.La}b$f(Ob){this.properties=Ob;ge.hcc(this.$,this.properties).Izc(1,null);this.cgc(!0)}dispose(){this.iig();bd.La=null}owb(){return{onCategoryChange:Ob=>{this.Nsb.NumberFormatCategory=jd[Ob.toLowerCase()];this.cgc()},
onThousandSeparatorChanged:Ob=>{this.Nsb.IsComma=Ob;this.cgc()},onDecimalPlacesChanged:Ob=>{this.Nsb.DecimalPlaces=Ob;this.cgc()}}}uz(){this.dispose()}Lya(){this.iig()}cgc(Ob){let Mc=null;if(this.activeCell=this.fbc())r.a.Kc in this.properties&&this.properties[r.a.Kc]&&(Mc=parseInt(this.properties[r.a.Kc].toString(),10)),this.numberFormatViewModel?(this.R0b||this.Ntc(),Mc||Ob?this.Gqf(Mc):this.numberFormatViewModel.pub(this.activeCell,this.Nsb)):this.Neh(Mc)}Neh(Ob){const Mc=z.GetServiceTaskFactory.create(this.$.da,
18,this.$.la,0);w.TaskExtensions.za(Mc,()=>{this.numberFormatViewModel=new vd.a(this.$,Mc.result,new wd.a(this.$));this.R0b||this.Ntc();this.numberFormatViewModel.ZNd();this.Gqf(Ob)},this.$.la,3)}Ntc(){this.R0b=!0;this.numberFormatViewModel.XYa(this.Jya);this.numberFormatViewModel.mXc(this.Iya)}Gqf(Ob){Ob=Object(nc.a)(new nd.a,{Caller:3,NumberFormatCategory:null!==Ob&&void 0!==Ob?Ob:-1});this.numberFormatViewModel.pub(this.activeCell,Ob)}fbc(){let Ob;const Mc=S.h(this.$).ha.qa.activeCell;Mc&&(Ob=
x.o(Mc,this.$));return Ob}iig(){this.R0b=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.mcb(this.Jya),this.numberFormatViewModel.bMd(this.Iya))}}Object(e.a)(bd,"NumberFormatTaskPaneManager",null,[2]);class Hd extends X.a{constructor(Ob,Mc){super();this.activePage=0;this.utd=!1;this.EZh=()=>1===this.activePage?ge.nxb(this.$,this.properties).owb():null;this.kOh=()=>2===this.activePage?ge.cwb(this.$,this.properties).owb():null;this.$=Ob;this.properties=Mc;this.Cac=new cd(this,Ob);this.XH()}static getInstance(Ob,
Mc){return this.La||(this.La=new this(Ob,Mc))}Izc(Ob,Mc){this.utd?this.Cac.updateTaskPane(Ob,Mc):(this.Cac.showTaskPane(Ob,Mc),this.utd=!0);this.activePage=Ob}Lya(){bd.XAb&&ge.nxb(this.$,this.properties).Lya();ec.XAb&&ge.cwb(this.$,this.properties).Lya()}uz(){bd.XAb()&&ge.nxb(this.$,this.properties).uz();ec.XAb()&&ge.cwb(this.$,this.properties).uz();this.dispose()}dispose(){this.$=null;this.m_d();this.Cac.hideTaskPane();this.Cac=null;this.utd=!1;this.properties=null;Hd.La=null}XH(){}m_d(){}owb(){return{onItemClick:Ob=>
{switch(Ob){case 1:ge.nxb(this.$,this.properties).b$f(this.properties);break;case 2:ge.cwb(this.$,this.properties).g9f()}},numberFormatCallbacks:this.EZh(),alignmentCallbacks:this.kOh()}}}Object(e.a)(Hd,"FormatCellsTaskPaneManager",X.a,[]);class ge{constructor(){}static hcc(Ob,Mc){return Hd.getInstance(Ob,Mc)}static nxb(Ob,Mc){return bd.getInstance(Ob,Mc)}static cwb(Ob,Mc){return ec.getInstance(Ob,Mc)}}Object(e.a)(ge,"FormatCellsTaskPaneHelper",null,[]);class Mb{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,
Mc,Dc){Ob=!1;Mc=Mc.command;switch(Mc){case 2055979337:ge.hcc(this.$,Dc).Izc(0,null);Ob=!0;break;case -395879625:ge.nxb(this.$,Dc).b$f(Dc);Ob=!0;break;case -2019948858:ge.cwb(this.$,Dc).g9f(),Ob=!0}return Ob?E.Task.Ra(!0):I.a(Mc)}wc(Ob,Mc){switch(Mc.command){case 2055979337:case -395879625:case -2019948858:return!0;default:return!1}}Mc(){return!1}}Object(e.a)(Mb,"FormatCellsCommandHandler",null,[221]);class Kc extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new Mb(this.$)])}static ka(Ob){f.a.Ld(533,
new Kc(Ob))}}Object(e.a)(Kc,"FormatCellsCommandHandlerFactory",f.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(b.a)();(()=>{U.a.Fa(Ob=>{H.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||Y.ka(Ob)})})();U.a.Fa(wa.ka);Object(ia.a)();Object(Ha.a)();Object(Sa.a)();Object(Da.a)();Object(ea.a)();Object(sa.a)();U.a.Fa(Oa.ka);Object(oa.a)();Object(Ja.a)();Object(Wb.a)();(()=>{U.a.Fa(Ob=>{cb.ka(Ob)})})();Object(La.a)();Object(eb.a)();Object(ua.a)();Object(xa.a)();Object(tb.a)();Object(Qb.a)();Object(pc.a)();Object(hb.a)();Object(ib.a)();Object(fd.a)();
Object(Vb.a)();Object(Fc.a)();Object(Ta.a)();(()=>{U.a.Fa(Ob=>{Bb.ka(Ob)})})();(()=>{U.a.Fa(Ob=>{Lc.ka(Ob)})})();(()=>{U.a.Fa(Ob=>{fa.ka(Ob)})})();(()=>{U.a.Fa(Ob=>{Kc.ka(Ob)})})()},734:function(t,F,a){a.d(F,"a",function(){return L});t=a(0);var c=a(7),b=a(15),e=a(561),f=a(89),d=a(558),h=a(377),m=a(583),l=a(566),v=a(111),r=a(268),A=a(83),x=a(420),n=a(1424);F=a(81);var u=a(19),z=a(5),w=a(784),C=a(68),y=a(41),B=a(56),H=a(140),I=a(117),R=a(1),S=a(11),G=a(22),D=a(13),E=a(21),M=a(34);class L extends F.a{constructor(N,
Y,U,P,aa,X,Z,da,qa,O,ca,wa){super();this.Omc=!1;this.iIc=this.WKc=this.contextMenuController=null;this.Aqd=!1;this.awc=this.Etb=null;this.DC=()=>{this.contextMenuController?this.contextMenuController.DC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Zhg()};this.jb=N;this.Avf=aa;this.ZRc=O;this.aNf=X;this.populateOnlyOnce=Z;this.Oai=ca;this.MTf(wa)}get contextMenuRoot(){return this.awc}get $(){return this.jb}get Va(){return this.ZRc}get menuId(){return this.$.Bb+
this.Avf}get Lvb(){this.WKc||(this.WKc=I.a(this.$));return this.WKc}get Rqb(){this.iIc||(this.iIc=E.h(this.$).Vb);return this.iIc}Hc(N,Y){N=!0;switch(Y){case 1651433993:case 1675506831:case 966232027:N=this.Pd(4096)||this.Pd(2048);break;case 2045563128:N=this.Pd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:N=this.Pd(8192)}return!N}Mc(N,Y,U){U.IsShadowMenuOpen||w.i(this.$,w.d);N=!1;Y===this.Gw&&(U.IsShadowMenuOpen||w.i(this.$,w.a),Y=Object(c.a)(new e.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]}),this.zGd(Y,U.IsShadowMenuOpen),U.MenuItems=Y,U.IsShadowMenuOpen||w.i(this.$,w.c),N=!0);N&&this.Omc&&S.HelperMethods.b2b&&!U.IsShadowMenuOpen&&w.k(this.$);return N}zGd(N,Y){(Y=this.CY(Y))?(this.$cf(Y),N.MenuSectionList.push(...Y.lE().MenuSectionList),this.VJg(N)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}CY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}r0(N,Y,U,P,aa){N=Sys.UI.DomElement.getBounds(Y);Y=new Sys.UI.Point(N.x,N.y+N.height);this.$.isChromeRtl&&(Y.x+=N.width);this.rp(Y,aa)}rp(N,Y,U=0){Y&&(N=M.a(this.$).Ija(N));Y=!0;if(this.Oai){let P;3===U?(P=this.wKa(3))&&0<P.length?(Y=!1,this.showFloatie(P,new Sys.UI.Bounds(N.x,N.y,0,0),U)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===U&&
this.$.isEditMode&&((P=this.wKa(2))&&0<P.length?P[0]!==L.EYe?(Y=!1,this.DUd(P,new Sys.UI.Bounds(N.x,N.y,0,0),U)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}Y&&this.showContextMenu(new Sys.UI.Bounds(N.x,N.y,0,0),U)}wKa(){return null}bid(N,
Y=null){let U="";3===N?U="touch":2===N&&(U="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!B.a.pg&&B.a.pg.bK,["IsReactMLR"]:!!B.a.pg&&B.a.pg.gV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:U,["FloatieGroups"]:JSON.stringify(Y)}}showContextMenu(N,Y=0){const U=this.bid(Y);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(U)}`);this.contextMenuController?this.qB!==z.a.rJd&&this.qB!==z.a.sJd||0===
Y?this.contextMenuController.CUd(this.qB,N,C.a.zb):this.contextMenuController.CUd(this.qB,N,Y):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(N,Y,U){const P=this.bid(U,N);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(P)}`);this.contextMenuController?(this.UTf(),this.contextMenuController.Gzc(N,Y,U)):(N=JSON.stringify(N),
b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${N}.`))}DUd(N,Y,U){var P=this.bid(U,N);P=JSON.stringify(P);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${P}`);this.contextMenuController?(this.UTf(),this.contextMenuController.BUd(N,Y,U,this.qB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}MTf(N){this.contextMenuController=
N}dispose(){this.$&&this.$.Ia.Zbb(this);this.jb=null;this.Zhg();this.awc&&(f.a.Ja(this.awc),this.awc=null);super.dispose()}HLh(N){var Y=this.$.da.Aa(204);Y&&(Y=Y.pMh(this.Avf))&&N.rc.push(Y)}Pd(N){return(new H.a(this.$.va)).Pd(N)}$cf(N){for(const Y of N.rc)if(Object(x.a)(273,Y)){N=Y;N.title&&(N.title=L.kf(N.title));for(const U of N.buttons)Object(x.a)(274,U)?(N=U,N.label=L.kf(N.label),N.JR(L.kf(N.alt))):Object(x.a)(275,U)&&this.$cf(U.menu)}}xvf(N,Y=!1){const U=[];for(const P of N)U.push(this.GP(P,
Y));return U}GP(N){const Y=[];for(const U of N.MenuItems)switch(U.Type){case 3:Y.push(this.Dbh(U));break;case 2:Y.push(this.ohh(U));break;case 1:Y.push(this.bdh(U))}return Object(c.a)(new d.a,{ControlList:Y,Title:N.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}ued(N,Y){Y=[this.Etb,N.RibbonCommand.toString(),Y?this.x3e(Y):this.x3e(N.Label),N.Disabled?N.Disabled.toString():"False"];let U=N.CommandData;U=G.a.hashCode(U).toString();
Y.push(U,N.Identifier.toString());Y=Y.join("_");N.IsChecked&&(Y+="_Checked");return Y}qMh(N){const Y=[this.Etb,G.a.hashCode(N.Title).toString()];for(const U of N.MenuItems)Y.push(U.RibbonCommand.toString());return Y.join("_")}t_e(N){var Y=N.Label;Y=G.a.hashCode(Y).toString();Y=[this.Etb,Y];R.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&N.Id&&Y.push(G.a.hashCode(N.Id).toString());Y=Y.join("_");N.IsChecked&&(Y+="_Checked");return Y}Dbh(N){let Y,
U,P;({label:U,HLa:P,vr:Y}=this.Zac(N,!1));const aa=this.ued(N,U);return Object(c.a)(new h.a,{Command:N.Disabled?(-251203935).toString():Y.toString(),ExternalId:aa,Id:aa,Image16by16Class:P,LabelText:U||N.Label,MenuItemId:N.CommandData,CommandValueId:N.CommandData})}ohh(N){let Y,U,P;({label:U,HLa:P,vr:Y}=this.Zac(N,N.IsChecked));const aa=this.ued(N,U);return Object(c.a)(new m.a,{Command:N.Disabled?(-251203935).toString():Y.toString(),ExternalId:aa,Id:aa,Image16by16Class:P,LabelText:U||N.Label,MenuItemId:N.CommandData,
CommandValueId:N.CommandData,IsChecked:N.IsChecked})}bdh(N){let Y;var U;({label:Y,HLa:U}=this.C_e(N));const P=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});P.MenuSectionList.push(...this.xvf(N.SubMenu.Sections,!0));const aa=this.t_e(N);N=Y||N.Label;return Object(c.a)(new l.a,{ExternalId:aa,Id:aa,LabelText:N,PopulateOnlyOnce:!1,Menu:P,Image16by16Class:U,ImageIsVisible:!!U})}C_e(N){let Y,U;({label:N,HLa:Y,vr:U}=this.Zac(N,!0));return{label:N,HLa:Y,vr:U}}Zac(N,Y){let U;switch(N.Identifier){case 26:U=
912804500;Y=u.a.RUe;N=D.a.instance.ga(1948);break;case 3:U=-1902148570;Y=Y?u.a.oaa:null;N=D.a.instance.ga(1908);break;case 4:U=-1902148570;Y=Y?u.a.oaa:null;N=D.a.instance.ga(1909);break;case 5:U=-1902148570;Y=Y?u.a.oaa:null;N=null;break;case 1:U=-1677817820;Y=u.a.M9b;N=D.a.instance.ga(232);break;case 2:U=-1649376918;Y=N.IsChecked?u.a.nua:null;N=D.a.instance.ga(2119);break;case 23:U=1701016594;Y=N.IsChecked?u.a.nua:null;N=D.a.instance.ga(2119);break;case 6:U=-87741481;Y=null;N=D.a.instance.ga(2120);
break;case 7:U=1948650742;Y=u.a.BTe;N=D.a.instance.ga(1946);break;case 8:U=1933713114;Y=u.a.ATe;N=D.a.instance.ga(1947);break;case 14:U=504133448;Y=u.a.nJa;N=D.a.instance.ga(144);break;case 30:U=504133448;Y=u.a.nJa;N=D.a.instance.Ta(744);break;case 32:U=504133448;Y=u.a.nJa;N=D.a.instance.ga(148);break;case 34:U=504133448;Y=u.a.nJa;N=D.a.instance.ga(150);break;case 27:U=1701016594;Y=Y?u.a.O9b:u.a.nJa;N=D.a.instance.ga(144);break;case 15:U=-798968736;Y=u.a.oJa;N=D.a.instance.ga(146);break;case 31:U=
-798968736;Y=u.a.oJa;N=D.a.instance.Ta(745);break;case 33:U=-798968736;Y=u.a.oJa;N=D.a.instance.ga(149);break;case 35:U=-798968736;Y=u.a.oJa;N=D.a.instance.ga(151);break;case 28:U=1701016594;Y=Y?u.a.P9b:u.a.oJa;N=D.a.instance.ga(146);break;case 21:U=-2058042992;Y=u.a.Q2a;N=null;break;case 29:U=1701016594;Y=u.a.Q2a;N=null;break;case 9:U=1701016594;N=Y=null;break;case 11:U=-1494291901;N=Y=null;break;case 25:U=-1045020714;Y=N.IsChecked?u.a.nua:null;N=null;break;case 13:U=1701016594;Y=N.IsChecked?u.a.nua:
null;N=D.a.instance.ga(153);break;case 16:U=1701016594;Y=u.a.F9b;N=D.a.instance.ga(1080);break;case 17:U=1701016594;Y=u.a.P2a;N=null;break;case 18:U=1701016594;Y=u.a.O2a;N=null;break;case 19:U=1701016594;Y=u.a.G9b;N=D.a.instance.ga(1085);break;case 20:U=1701016594;Y=u.a.vad;N=D.a.instance.ga(1086);break;case 24:U=1675506831;N=Y=null;break;case 22:U=N.RibbonCommand;Y=N.IsChecked?u.a.oaa:null;N=null;break;case 36:U=1461300262;Y=null;N=D.a.instance.ga(152);break;case 38:U=N.RibbonCommand;Y=u.a.Lad;N=
D.a.instance.ga(1819);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(N)}`),U=1461300262,N=Y=null}return{label:N,HLa:Y,vr:U}}x3e(N){return G.a.hashCode(N+S.HelperMethods.swj).toString()}VJg(N){if(!this.$.ea.amIAlone){var Y=this.$.da.Aa(25);if(Y&&!v.a.isEmpty(Y.Moa)&&(Y=Y.v6h(),!r.a.lh(Y))){var U=[];A.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").Gfh(Y,U);N.MenuSectionList.push(...U)}}}UTf(){this.Aqd||(this.Lvb&&this.Lvb.C_b(this.DC),
this.Rqb&&this.Rqb.C_b(this.DC),this.Aqd=!!this.Lvb||!!this.Rqb)}Zhg(){this.Lvb&&this.Lvb.Fuc(this.DC);this.Rqb&&this.Rqb.Fuc(this.DC);this.Aqd=!1}static Fpd(N,Y){Y=y.C(Y);N=E.h(N).Ca.HKa(Y);return!(null===N||void 0===N||!N.uk)}static Afd(N,Y,U){Y=y.C(Y);var P=E.h(N).Ca.HKa(Y);Y=E.h(N).getCellBounds(P);const aa=P.KUg;P=P.JUg;let X=Y.x+aa.x;Y=Y.y+aa.y;U&&R.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(E.h(N).rtl||(X+=P),Y-=P);return new Sys.UI.Point(X,Y)}static CDh(N){try{Object(n.a)(N.CommandValueId)}catch(Y){}}static kf(N){const Y=
L.Z1a.parseFromString(N,"text/html");return Y?Y.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),N)}}L.Z1a=new DOMParser;L.EYe="Unsupported";Object(t.a)(L,"ContextMenuBase",F.a,[221,276,2])},784:function(t,F,a){a.d(F,"j",function(){return"ContextMenuPerf.A"});a.d(F,"b",function(){return"ContextMenuPerf.B"});a.d(F,"d",function(){return"ContextMenuPerf.C1"});a.d(F,"a",function(){return"ContextMenuPerf.C2"});a.d(F,"c",function(){return"ContextMenuPerf.D"});a.d(F,
"e",function(){return v});a.d(F,"f",function(){return x});a.d(F,"h",function(){return n});a.d(F,"i",function(){return u});a.d(F,"k",function(){return z});a.d(F,"g",function(){return C});var c=a(15),b=a(322),e=a(8),f=a(63),d=a(24),h=a(11),m=a(21),l=a(1);const v=(y,B)=>{var H=y.Qb(null);if((null===H||void 0===H?0:H.cell.uk)&&r(H,y,B))return y.getCellBounds(H.cell);H=y.ha.qa.activeCell;return(B=A(new d.Range(H.top,H.left,e.a.Vg,H.left,!1,!1),2,!0,y,B)||A(new d.Range(1,H.left,H.top,H.left,!1,!1),2,!1,
y,B)||A(new d.Range(H.top,H.right,H.top,e.a.Ug,!1,!1),1,!0,y,B)||A(new d.Range(H.top,1,H.top,H.right,!1,!1),1,!1,y,B)||null)&&B.uk?y.getCellBounds(B):Sys.UI.DomElement.getBounds(y.Vva.jc)},r=(y,B,H)=>{var I=B.rtl,R=H.isChromeRtl;y=y.cell;return(H=m.h(H).GJ(y))?(H=H.topLeft,I=H.x+=I===R?y.offsetWidth:0,R=H.y+=y.offsetHeight,B.view.visibleArea.contains(new f.a(I,R,0,0))):!1},A=(y,B,H,I,R)=>{y=I.Wj("ContextMenuHelper.FindFirstCellInViewportArea",y,B,H);try{for(y.$$rst();y.$$mn();){const S=y.$$cu();if(S&&
r(S,I,R))return S.cell}}finally{y&&y.dispose()}return null},x=y=>y.wb.U4(y.ha.qa.activeCell),n=y=>{y=m.h(y).ha.qa;return y.Tg&&(y.ld.isRow||y.ld.Rg)},u=(y,B)=>{h.HelperMethods.L_c&&window.performance.mark(B)},z=()=>{if(b.a.bqb){const y=w("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),B=w("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),H=w("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${y}], PrepInfraWork=[${B}], EWAPopulation =[${H}]`)}},
w=(y,B,H)=>{window.performance.measure(y,B,H);B=window.performance.getEntriesByName(y);B.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${y}] returned no measures.`);return B[B.length-1]?B[B.length-1].duration:-1},C=y=>l.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?y.qd&33554432?!0:!1:!0},786:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.UQe="ewa-ac";c.Qth="ewa-ac-param";c.iSe="ewa-function-help-link";c.A9b=
"ewa-lb";c.dSe="ewa-fb-refactor";c.listItem="list-item";c.mDb="list-item-selected";c.qDb="list-table-touch";c.pDb="list-table";c.Syh="ewa-suggested-cell-name";c.A6g="columnName-header";c.fTe="ewa-tt";c.qwh="ewa-function-link-container";c.jSe="ewa-function-udf-name";c.rtl="rtl";Object(t.a)(c,"CssClassNames",null,[])},825:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(843),e=a(739),f=a(5),d=a(68),h=a(51),m=a(205),l=a(35),v=a(1),r=a(13);class A{constructor(N,Y,U,P,aa,X,Z,da){this.rtg=N;this.stg=Y;this.qtg=
U;this.uga=P;this.wEg=aa;this.MAg=X;this.rkb=Z;this.Nzg=da}get Nxe(){return this.rtg}get T1b(){return this.stg}get Mxe(){return this.qtg}get width(){return this.uga}get DOj(){return this.wEg}get nMi(){return this.MAg}get lineHeight(){return this.rkb}get Fzi(){return this.Nzg}static yXg(){return new A("BorderStyleSolidLine",1960,1,"1","",1,8,0)}static uXg(){return new A("BorderStyleDashedLine",1961,3,"1","5,3",1,8,0)}static vXg(){return new A("BorderStyleDottedLine",1962,4,"1","1,1",1,8,0)}static xXg(){return new A("BorderStyleMediumLine",
1963,2,"2","",1,8,0)}static zXg(){return new A("BorderStyleThickLine",1964,5,"3","",1,8,0)}static wXg(){return new A("BorderStyleDoubleLine",1965,6,"1","",2,8,3)}}Object(t.a)(A,"BorderLineStyleProperties",null,[]);class x{constructor(){this.iconName=this.title=this.key=null}}Object(t.a)(x,"BorderLineStyleProps",null,[]);class n{constructor(N){N.eUf()}getBorderLineStyleProps(){const N=a(825).BorderFormatManager.p_a,Y=Array(Object.keys(N).length);let U=0;for(let X in N){var P=X,aa=N[X];Y[U]=new x;Y[U].key=
P;P=aa;Y[U].title=r.a.instance.ga(P.T1b);Y[U].iconName=P.Nxe;U++}return Y}}Object(t.a)(n,"BorderMenuController",null,[304]);var u=a(268),z=a(86),w=a(241),C=a(14),y=a(110),B=a(24),H=a(48),I=a(44),R=a(214),S=a(11),G=a(21),D=a(34),E=a(41);class M{constructor(N,Y){this.hIb=this.ribbonCommandInfo=this.cellFormat=this.Mr=this.Cb=this.ha=null;this.Otc=!1;this.wOf=this.SLa=this.NHd=this.X$d=this.pza=this.Bma=null;this.V1b=this.Uta=this.COf=0;this.borderStyle=this.q_a=this.borderColor=null;this.YA=!1;this.y6b=
this.Uab=null;this.W_=()=>{if(!this.YA||G.h(this.$).dz)this.YA=!1,G.h(this.$).dz=!1,this.Uta=0,G.h(this.$).Gg.qp(f.a.LU),1===this.$.Ia.bH()&&(G.h(this.$).e4(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?E.d(this.NHd):u.a.clone(this.NHd),this.COf,this.$.na?this.$.na.sheetName:null,null,this.wOf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",!0),G.h(this.$).CSa(!0)),this.Gv(),this.x_d(),this.Sj(),this.Otc=!1,this.pza=this.Bma=null,this.Mr&&(this.Mr.cancel(),this.Mr.dispose()),
c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=U=>{try{if(U=this.me(U),G.h(this.$).dz=!0,this.Bma={},this.pza={},this.Uab=null,this.fqb(this.V1b),2===U.ub){const P=G.h(this.$).ha.Wp(U.clientPoint,U.Mb,5,void 0,void 0,!1);P&&(this.y6b=this.SLa=P,this.Zej())}}catch(P){G.h(this.$).dz=!1}return!0};this.Ti=U=>{try{U=this.me(U);const P=G.h(this.$).ha.Wp(U.clientPoint,U.Mb,5,void 0,void 0,!1),aa=G.h(this.$).Ca.Ur(P);if(!this.hIb||aa&&(aa.vQ!==
this.hIb.vQ||aa.uQ!==this.hIb.uQ))if(this.YA=!0,this.hIb=aa,P){let X=new B.Range(this.SLa.top,this.SLa.left,this.SLa.top,this.SLa.left,!0,!1);X.union(P);X=G.h(this.$).ha.J0h(X);this.$1b(P);this.JZf(this.Uab,X);if(this.bottomRightCorner(X.bottom,X.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;const Z=new B.Range(X.top,X.left,X.bottom+1,X.right+1,!0,!1),da=G.h(this.$).K$("DrawBorderBehavior.OnPointerMove",
[Z]);if(this.Bma&&this.pza)for(;da.$$mn();){const qa=da.$$cu(),O=qa.cell.getRange().toString();O in this.Bma&&1!==this.Uta||(this.Bma[O]=qa,this.pza[O]=qa.cell.AM())}this.Uab=Z;this.y6b=X;G.h(this.$).e4([X],0,this.$.na.sheetName,null,X.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.Lh.Xda(G.h(this.$),-1690267012,this.cellFormat,!0,null,[X])}return!0}catch(P){return G.h(this.$).dz=!1}};this.Wg=U=>{U=this.me(U);(U=G.h(this.$).ha.Wp(U.clientPoint,U.Mb,5,void 0,void 0,!1))?this.YA&&(this.$1b(U),
this.SLa.union(U),3===this.Uta?this.fqb(0):this.fqb(this.V1b),G.h(this.$).e4([this.SLa],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.Lh.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Uta?this.fqb(0):this.fqb(this.V1b),G.h(this.$).e4([this.y6b],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",!0),this.Lh.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.YA=!1;this.x_d();this.pza=this.Bma=
null;return!0};this.onKeyDown=U=>{U=this.me(U);if(this.YA||[17,16,18,20].includes(U.Ea.keyCode))return!0;this.W_();return!1};this.onKeyUp=U=>{U=this.me(U);if(U.Ea.keyCode===z.a.XF&&this.YA)return this.YA=!1,this.JZf(this.Uab,this.y6b,!0),this.x_d(),!0;if(this.YA||U.Ea.keyCode===z.a.Noa||U.Ea.keyCode===z.a.fGc||U.Ea.keyCode===z.a.eGc||[17,16,18,20,37,39,38,40,33,34,9,13].includes(U.Ea.keyCode)||U.Ea.keyCode===z.a.X3d||U.Ea.keyCode===z.a.T3d||U.Ea.keyCode===z.a.P3d)return!0;this.W_();return!1};this.aR=
(U,P)=>{G.h(this.$).dz&&!this.Ndi.includes(P.Sd.command)&&(U=JSON.stringify(P.Sd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${U} `),this.W_())};this.$=N;this.Lh=Y}get Ndi(){return this.X$d||(this.X$d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}fHg(N){c.ULS.sendTraceTag(537159517,0,
50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=G.h(this.$).ha;this.Cb=G.h(this.$).Cb;this.ribbonCommandInfo=N;this.NHd=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?E.d(this.ha.qa.selectedRanges):u.a.clone(this.ha.qa.selectedRanges);this.COf=this.ha.qa.es;this.wOf=this.ha.qa.activeCell.clone();this.Cb&&this.Cb.Sld();this.Et();this.Aj()}dispose(){this.W_();this.hIb=this.ribbonCommandInfo=this.cellFormat=null}fqb(N){var {BorderFormatManager:Y}=
a(825);this.cellFormat={};const U={};this.borderColor=this.borderColor||Y.L7c;var P=m.a.ZG(this.borderColor,!1);U.Color=[P,P,P,P];v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.q_a&&(U.ThemeBorderColor=[this.q_a,this.q_a,this.q_a,this.q_a],U.ColorTypeOption=1);P=a(825).BorderFormatManager.p_a;this.borderStyle=this.borderStyle||Y.borderStyleSolidLine;Y=P[this.borderStyle].Mxe;U.LineStyle=[Y,Y,Y,Y];this.cellFormat.BorderFormat=U;this.cellFormat.ValidMembers=128;this.cellFormat.Border=
N}Et(){for(const N of G.h(this.$).xn)w.a.instance.ta(C.a.pointerDown,N.domElement,this.onPointerDown);y.KeyInputManager.instance.ta(C.a.Sb,document.documentElement,this.onKeyDown);y.KeyInputManager.instance.ta(C.a.Kd,document.documentElement,this.onKeyUp)}Zej(){for(const N of G.h(this.$).xn)w.a.instance.ta(C.a.yj,N.domElement,this.Ti),w.a.instance.ta(C.a.Kf,N.domElement,this.Wg);w.a.instance.ta(C.a.Kf,document.documentElement,this.Wg);w.a.instance.ta(C.a.oB,document.documentElement,this.Wg);this.Otc=
!0}Gv(){try{for(const N of G.h(this.$).xn)w.a.instance.Ba(C.a.pointerDown,N.domElement,this.onPointerDown);y.KeyInputManager.instance.Ba(C.a.Sb,document.documentElement,this.onKeyDown);y.KeyInputManager.instance.Ba(C.a.Kd,document.documentElement,this.onKeyUp)}catch(N){G.h(this.$).dz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${N}`)}}x_d(){if(this.Otc)try{this.Otc=!1;for(const N of G.h(this.$).xn)w.a.instance.Ba(C.a.yj,
N.domElement,this.Ti),w.a.instance.Ba(C.a.Kf,N.domElement,this.Wg);w.a.instance.Ba(C.a.Kf,document.documentElement,this.Wg);w.a.instance.Ba(C.a.oB,document.documentElement,this.Wg)}catch(N){G.h(this.$).dz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${N}`)}}Aj(){this.$.va.Vf(this.W_);G.h(this.$).Vb.xl(this.W_);G.h(this.$).gE(this.W_);this.$.Ia.WFa(this.aR)}Sj(){this.$.va.sg(this.W_);G.h(this.$).Vb.nl(this.W_);G.h(this.$).yF(this.W_);
this.$.Ia.Tza(this.aR)}JZf(N,Y,U=!1){if(N&&this.Bma&&this.pza)for(N=G.h(this.$).K$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[N]);N.$$mn();){var P=N.$$cu().cell.getRange();if(U||!Y.contains(P)||1===this.Uta){P=P.toString();const aa=l.a.Fc(this.Bma,P);if(aa){const X=l.a.Fc(this.pza,P);this.setBorders(aa,X);delete this.Bma[P];delete this.pza[P]}}}}setBorders(N,Y){var U=N.cell;const P=U.getRange();U.Ybb();P.right!==this.Uab.right&&(U=new B.Range(P.top,P.left-1,P.bottom,P.left-1,!0,!1),G.h(this.$).Ca.Ur(U).wQa(3));
P.bottom!==this.Uab.bottom&&(U=new B.Range(P.top-1,P.left,P.top-1,P.right,!0,!1),G.h(this.$).Ca.Ur(U).wQa(1));if(null===Y||void 0===Y?0:Y.Borders.length){U={};let Z=0;const da=Array(4),qa=Array(4);for(var aa=0;4>aa;aa++)da[aa]=1,qa[aa]=0;for(var X of Y.Borders)Y=X.BorderPosition,da[Y]=X.BorderLineStyle,aa=new R.a(X.Color.Red,X.Color.Green,X.Color.Blue),qa[Y]=aa.YR(),Z|=S.HelperMethods.$3a(X.BorderPosition);U.LineStyle=da;U.Color=qa;X={};X.BorderFormat=U;X.Border=Z;this.Lh.pAj(N,X,P)}}$1b(N){const Y=
new B.Range(Math.max(1,N.top-1),Math.max(1,N.left-1),N.bottom+1,N.right+1,!1,!1);G.h(this.$).YM(Y)||this.Mr&&this.Mr.ep||(this.Mr=H.a.instance.create(()=>{G.h(this.$).ov(Y,60,"DrawBorderBehavior.BringRangeIntoView")},40,I.a.uph))}bottomRightCorner(N,Y){return 1048576<=N||16384<=Y?!0:!1}me(N){return D.a(this.$).me(N)}}Object(t.a)(M,"DrawBorderBehavior",null,[2]);a.d(F,"BorderFormatManager",function(){return L});class L{constructor(N,Y,U){this.NRb=null;this.uF={};this.DSb=this.ix=null;c.ULS.sendTraceTag(537159566,
0,50,"BorderFormatManager: Request new instance");this.$=N;this.j7d=L.L7c;this.k7d=L.borderStyleSolidLine;this.Lh=Y;this.Va=U;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.kU=new M(this.$,this.Lh);this.WC=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get fIa(){return this.k7d}get a3(){return this.j7d}get ota(){return this.DSb}get themesManager(){this.ix||
(this.ix=this.$.da.Aa(422));return this.ix}S9e(N,Y){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${Y.command.toString()}`);const U={},P={};var aa=m.a.ZG(this.a3,!1);P.Color=[aa,aa,aa,aa];this.WC&&this.ota&&(P.ThemeBorderColor=[this.ota,this.ota,this.ota,this.ota],P.ColorTypeOption=1);N=-600086683===Y.command?"OutsideBorders":N[d.a.Kc];P.LineStyle=l.a.Fc(L.FNf,N);P.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${N}`):
(aa=L.p_a[this.fIa].Mxe,P.LineStyle=[aa,aa,aa,aa],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.fIa}`));aa=l.a.Zp(L.xWg,N,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${N}, the border color selected is ${this.a3}`);U.BorderFormat=P;4!==aa&&8!==aa||!this.$.na.displayRtl||(aa=4===aa?8:4);U.ValidMembers=128;U.Border=aa;this.Lh.formatCells(-1690267012,
U,Y);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${Y.command.toString()}`);return!0}kkd(N,Y,U){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${N.toString()} is being executed, the previous border color is ${this.a3}`);if(this.WC){if((Y.SqmControlId||"").includes("ThemeColorPicker")){let P,aa;({themeIndex:P,tBa:aa}=this.themesManager.getThemeColor(Y.Color)).returnValue?(this.DSb={},this.ota.ThemeColorIndex=P,this.ota.ThemeColorRow=aa):this.DSb=
null}else this.DSb=null;this.kU.q_a=this.ota}this.j7d=-1803452024===N?L.L7c:Y.Color;this.kU.borderColor=this.a3;this.nPe(U);this.$.qf();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${N.toString()} is being executed, the updated border color is ${this.a3}`);return!0}e$h(N){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const Y=this.Va.sq();var U=this.Va.Ec();Y.rc.push(U);const P=this.Va.xC("StyleDashGallery",1,"Size120by20");U.buttons.push(P);U=L.p_a;
for(let aa in U){const X=aa,Z=U[aa],da=r.a.instance.ga(Z.T1b);P.Zt(X,-2118943501,"QueryBorderStyle",Z.T1b,X,X,void 0,void 0,da)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");N.MenuItems=Y.lE();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}v8h(N,Y){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.fIa}`);N=N[d.a.Kc];if(L.Ovi(N))this.k7d=N,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.fIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${N}`),!0;this.kU.borderStyle=this.fIa;this.nPe(Y);this.$.qf();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.fIa}`);return!0}okd(N){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${N.command.toString()}`);this.DVc(N,64,this.a3,109,1);return!0}pkd(N){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${N.command.toString()}`);this.DVc(N,112,this.a3,110,2);return!0}h$e(N){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${N.command.toString()}`);this.DVc(N,112,"white",111,3);return!0}k$h(N){this.Ryj(this.zWg,N,N.MenuItemId?N.MenuItemId:L.borderStyleSolidLine)}Ryj(N,Y,U){U in N?(N=N[U],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${U}`),
this.Tyj(Y,N)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${U}' in BorderLineStyleButtons dictionary`)}v$h(N,Y){const U=N[d.a.Kc];return"DrawBorder"===U?this.okd(Y):"DrawBorderGrid"===U?this.pkd(Y):"EraseBorder"===U?this.h$e(Y):this.S9e(N,Y)}eUf(){this.NRb||this.AXg()}DPh(){return new n(this)}get zWg(){this.eUf();return this.NRb}AXg(){this.NRb={};let N=0;const Y=L.p_a;for(let U in Y){const P=Y[U],aa=P.Nxe;r.a.instance.ga(P.T1b);this.NRb[aa]=aa;this.Rbb(aa,
()=>appChrome.buildBorderStyleIconNew(P.DOj,P.width,P.nMi,P.lineHeight,P.Fzi));N++}}Rbb(N,Y){if(!(N in this.uF)){const U={};Y=Y();U[N]=Y;appChrome.api.registerIconProvider(()=>U);this.uF[N]=!0}return N}Tyj(N,Y){N.MenuItemId&&(N[b.a.On]=N.MenuItemId===this.fIa,N[e.a.Icon]=Y)}DVc(N,Y,U,P,aa){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.q3g(N,aa)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.kU.W_()):(G.h(this.$).dz&&this.kU.W_(),h.a.current&&(P=String.format(f.a.uta,h.a.current.lo(P)),G.h(this.$).Gg.qp(P)),this.kU.V1b=Y,this.kU.borderColor=U,G.h(this.$).dz=!0,this.kU.fHg(N),this.kU.Uta=aa)}nPe(N){if(N)switch(this.kU.Uta){case 2:this.pkd(N);break;default:this.okd(N)}}q3g(N,Y){return this.kU.Uta===Y&&-236759591!==N.command&&-2118943501!==N.command?!0:!1}static get p_a(){return L.v5d||(L.v5d={["BorderStyleSolidLine"]:A.yXg(),["BorderStyleDashedLine"]:A.uXg(),["BorderStyleDottedLine"]:A.vXg(),
["BorderStyleMediumLine"]:A.xXg(),["BorderStyleThickLine"]:A.zXg(),["BorderStyleDoubleLine"]:A.wXg()})}static get xWg(){return L.u5d||(L.u5d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get FNf(){return L.$ge||
(L.$ge={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:L.Yjh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static Ovi(N){return N?N in L.FNf||N in L.p_a:!1}}L.u5d=null;L.v5d=null;L.$ge=null;L.L7c="black";L.borderStyleSolidLine="BorderStyleSolidLine";L.Yjh=[1,1,1,1];Object(t.a)(L,"BorderFormatManager",null,[242])},855:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.edit="Edit";c.clipboard=
"Clipboard";c.copy="Copy";c.color="Color";c.HUg="AutoFill";c.Mqj="RowOperations";c.B6g="ColumnOperations";c.c5j="ViewModeRowOperations";c.b5j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.ZCj="ShapeStyle";c.rIh="FloatingObjectClipboard";c.CMf="PivotTableCopyDelete";c.EMf="PivotTableFieldListActions";c.aBe="CellFloatie";c.VCj="ShapeFloatie";c.contextMenu="ContextMenu";c.K7h="GridContextMenu";c.e5i="PivotTableContextMenu";c.sIh="FloatingObjectContextMenu";c.v2g=
"CellRTEFloatie";c.d7f="ShapeRTEFloatie";Object(t.a)(c,"FloatieGroupIdentifiers",null,[])},856:function(t,F,a){a.d(F,"a",function(){return l});t=a(0);var c=a(89),b=a(227),e=a(14),f=a(241);F=a(239);var d=a(12),h=a(74),m=a(21);class l extends F.a{constructor(v,r,A){super(r);this.wlc=this.QQ=!1;this.vn=this._selectedRowListBox=this.MNa=null;this.wEf=x=>this.onItemClick(x);this.yDd=x=>{h.g(x.Ea);this.raiseEvent(l.Z4a);this.raiseEvent(l.$Qd);return!0};this.onScroll=x=>{h.g(x);this.VId();this.raiseEvent(l.Z4a)};
this.onBlur=x=>{h.g(x);this.VId()};this.onPointerDown=()=>{this.VId();this.raiseEvent(l.Z4a);this.raiseEvent(l.eza);return!1};this.dGb=x=>{const n=x.Ea;if(n.button===Sys.UI.MouseButton.leftButton||n.button===Sys.UI.MouseButton.rightButton||n.type.includes("touch"))this.Ej=this.Bbc(n),this.onPointerDown(x);this.raiseEvent(l.kud);return!1};this.jb=v;this.lDb=A;this.fBa(!0)}s9(v){this.get_events().addHandler(l.Z4a,v)}rda(v){this.get_events().removeHandler(l.Z4a,v)}z_b(v){this.get_events().addHandler(l.Mmd,
v)}Duc(v){this.get_events().removeHandler(l.Mmd,v)}qob(v){this.get_events().addHandler(l.$Qd,v)}SJb(v){this.get_events().removeHandler(l.$Qd,v)}nob(v){this.get_events().addHandler(l.eza,v)}PJb(v){this.get_events().removeHandler(l.eza,v)}kXc(v){this.get_events().addHandler(l.kud,v)}YLd(v){this.get_events().removeHandler(l.kud,v)}get Ej(){return this._selectedRowListBox}set Ej(v){this.yBa(this._selectedRowListBox);v?(this._selectedRowListBox=v,this.yBa(this._selectedRowListBox),this.Owc(v)):this._selectedRowListBox=
null}get pV(){return this.lDb.ListCellClass}get p5(){return this.lDb.ListTableClass}get HH(){return 8}get iEb(){return 5}get vlc(){return 24}get ulc(){return 35}get Df(){return this.domElement}get $(){return this.jb}dispose(){this.q7(!1);this.fBa(!1);c.a.pc([this.MNa]);this.MNa=null;super.dispose()}Bbc(v){return d.DOMElementExtensions.rgd(v.target,"tr",!0)}dB(v){if(v){if(!this.Ej){var r=this.vn;if(!r||!r.rows.length)return;this.Ej=r.rows[0];0<v?v--:v++}r=this.Ej;for(let A=0,x=Math.abs(v);A<x;A++)if(0>
v){if(!r.previousSibling)break;r=r.previousSibling}else{if(!r.nextSibling)break;r=r.nextSibling}r&&(this.Ej=r)}}Vnb(v,r){d.DOMElementExtensions.toggleCssClass(v,this.lDb.ListTableClassInTouch,r)}q7(v){const r=this.vn;r&&(v&&!this.wlc?(b.a.instance.ta(e.a.click,r,this.wEf),b.a.instance.ta(e.a.tk,r,this.yDd),f.a.instance.ta(e.a.pointerDown,r,this.dGb),this.wlc=!0):this.wlc&&(b.a.instance.Ba(e.a.click,r,this.wEf),b.a.instance.Ba(e.a.tk,r,this.yDd),f.a.instance.Ba(e.a.pointerDown,r,this.dGb),this.wlc=
!1))}yBa(v){let r=null;v&&(r=d.DOMElementExtensions.$j(v,this.lDb.ListCellClass))&&r.classList.toggle(this.lDb.ListCellSelectedClass);return r}fBa(v){this.Df&&(v&&!this.QQ?(this.MNa=this.ze.ie(this.Df),this.MNa.ka("scroll",this.onScroll),this.MNa.ka("blur",this.onBlur),f.a.instance.ta(e.a.pointerDown,this.domElement,this.onPointerDown),this.QQ=!0):this.QQ&&(c.a.Ja(this.MNa),this.MNa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.QQ=!1))}onItemClick(v){return this.yDd(v)}Owc(v){if(v){var r=
v.offsetTop,A=this.Df.scrollTop;r<A?this.J1f(!0):r+v.offsetHeight>A+this.Df.clientHeight&&this.J1f(!1)}}J1f(v){this.Df.scrollTop=v?this.Ej.offsetTop:this.Ej.offsetTop+this.Ej.offsetHeight-this.Df.clientHeight}VId(){m.h(this.$).fb&&this.raiseEvent(l.Mmd)}}l.Z4a="GotFocus";l.Mmd="IgnoreBlur";l.$Qd="SetCell";l.eza="PointerDown";l.kud="ItemPointerDown";Object(t.a)(l,"ListBox",F.a,[302,2])},927:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,
f,!0)}}Object(t.a)(b,"IgnoreCaseComparer",null,[338])},928:function(t,F,a){a.d(F,"a",function(){return f});t=a(0);var c=a(24),b=a(11),e=a(177);class f{constructor(d,h){this.Ca=d;this.c3a=h}ULb(d,h,m){const l=h.Border;h=h.BorderFormat;let v=0,r=!1;if(0===l)d.cell.Ybb(),this.nJb(d.cell.getRange());else{for(let A=0;3>=A;A++)f.jEj(d,m,A,l)&&(v|=b.HelperMethods.$3a(A),this.S_d(d.cell.getRange(),A,h),r=!0);b.HelperMethods.DQ(l,16)&&!e.c(d,0,m)&&(v|=2,this.S_d(d.cell.getRange(),0,h),r=!0);b.HelperMethods.DQ(l,
32)&&!e.c(d,2,m)&&(v|=4,this.S_d(d.cell.getRange(),2,h),r=!0);r&&(m=d.cell.Ux.Je,b.HelperMethods.DQ(v,2)&&this.u8f(d,m,0)&&(v&=-3),b.HelperMethods.DQ(v,1)&&this.t8f(d,m,1)&&(v&=-2),b.HelperMethods.DQ(v,4)&&this.u8f(d,m,2)&&(v&=-5),b.HelperMethods.DQ(v,8)&&this.t8f(d,m,3)&&(v&=-9),d.cell.setBorders(h,v,!1))}}eQ(d,h){d=f.W_e(d,h);return d.lz?(d=this.Ca.lja(d))&&d.length?d:null:null}nJb(d){for(let m=0;3>=m;m++){var h=f.W_e(d,m);if(!h.lz)continue;h=this.Ca.lja(h);if(!h||!h.length)continue;const l=f.s5e(m);
for(let v=0;v<h.length;v++)h[v].wQa(l)}}S_d(d,h,m){if(d=this.eQ(d,h)){var l=f.s5e(h),v=b.HelperMethods.$3a(l);for(let r=0;r<d.length;r++){const A=d[r];this.Wli(A,l)&&f.setBorders(A,m,v,h,l)}}}Wli(d,h){const m=d.Ux.Je;var l=d.getRange();l=this.eQ(l,h);let v=!1,r=!1,A=!1,x=!1;l&&(v=f.c7a(l,!0),r=f.c7a(l,!1),x=f.rrd(l),A=1===l.length?!0:!1);switch(h){case 0:return f.ili(d,m,x,r,A);case 1:return f.fli(d,m,x,v,A);case 2:return f.gli(d,m,x,v,A);case 3:return f.hli(d,m,x,r,A)}return!1}u8f(d,h,m){if(!d.cell.XA)return!1;
const l=d.range,v=this.eQ(l,m),r=e.c(d,m,h);let A=!1;h=0===m?l.top<h.top:l.left<h.left;!f.eBb(d.cell)&&v&&1!==v.length&&(A=(0===m?f.c7a(v,!0):f.c7a(v,!1))?!1:!0);return!r&&A||h?!0:!1}t8f(d,h,m){const l=d.cell,v=this.eQ(l.getRange(),m);d=e.c(d,m,h);h=!1;if(v){const A=f.c7a(v,!0);var r=f.c7a(v,!1);const x=A&&!r;r=r&&!A;1!==m||f.fCb(l)?3!==m||f.UAb(l)||f.qEj(l,v,r,x)&&(h=!0):f.pEj(l,v,A,r)&&(h=!0)}return!d&&h||f.eBb(l)?!0:!1}static tXg(d,h,m){const l={};l.LineStyle=Array(4);l.LineStyle[m]=d.LineStyle[h];
l.Color=Array(4);l.Color[m]=d.Color[h];return l}static Lgf(d,h,m,l,v){return b.HelperMethods.DQ(d,v)&&e.c(h,m,l)}static jEj(d,h,m,l){return f.Lgf(l,d,m,h,b.HelperMethods.$3a(m))||f.Lgf(l,d,m,h,64)||112===l}static setBorders(d,h,m,l,v){h=f.tXg(h,l,v);d.setBorders(h,m,!1)}static W_e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,
d.right+1,d.bottom,d.right+1,!1,!1)}return d}static s5e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static c7a(d,h){for(let m=0;m<d.length;m++){const l=d[m];if(l.XA)return h?f.UAb(l):f.fCb(l)}return!1}static eBb(d){const h=d.Ux.Je,m=d.getRange();return d.XA&&(m.top<h.top||m.bottom>h.bottom||m.left<h.left||m.right>h.right)?!0:!1}static rrd(d){for(let h=0;h<d.length;h++)if(f.eBb(d[h]))return!0;return!1}static pEj(d,h,m,l){if(!d.XA){if(!m||f.rrd(h))return!0}else if(f.UAb(d)&&
(1===h.length&&f.LSg(d,h[0])||!m))return!0;return l}static qEj(d,h,m,l){if(!d.XA){if(!m||f.rrd(h))return!0}else if(f.fCb(d)&&(1===h.length&&f.MSg(d,h[0])||!m))return!0;return d.Eba||l}static ili(d,h,m,l,v){const r=d.getRange();return f.UAb(d)?f.eBb(d)||v:h.top===r.top||!l||m}static fli(d,h,m,l,v){const r=d.getRange();return f.UAb(d)?h.bottom===r.bottom&&v:l&&!m||h.bottom===r.bottom}static gli(d,h,m,l,v){const r=d.getRange();return f.fCb(d)?f.eBb(d)||v:h.left===r.left||!l||m}static hli(d,h,m,l,v){const r=
d.getRange();return d.Eba?!1:f.fCb(d)?h.right===r.right&&v:l&&!m||h.right===r.right}static UAb(d){return 0<d.getRange().right-d.getRange().left}static fCb(d){return 0<d.getRange().bottom-d.getRange().top}static MSg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static LSg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(t.a)(f,"BorderModelAccessorHelper",null,[])},930:function(t,F,a){a.d(F,"a",function(){return d});t=a(0);var c=a(89);
F=a(96);var b=a(48),e=a(44),f=a(74);class d extends F.a{constructor(h,m){super(m.textBox.domElement);this.KZc=null;this.PNi=()=>{this.bCd()};this.jCf=(l,v)=>{this.$f(l,v)};this.nCf=(l,v)=>{this.Ri(l,v)};this.jb=h;this.zI=m;m.o2&&(m.o2.add(this),m.xl(this.nCf),m.Jm(this.jCf))}get $(){return this.jb}get eb(){return this.zI}dispose(){const h=this.zI;if(null===h||void 0===h?0:h.o2)h.o2.remove(this),h.nl(this.nCf),h.$l(this.jCf);c.a.Ja(this.KZc);this.zI=null;super.dispose()}Mh(h,m){switch(m){case -1470715894:case -1231471547:this.tY(!1);
break;default:if(this.yId(h,m))return f.g(h),!0;d.fri(m)||this.tY(!1)}return!1}tY(){c.a.Ja(this.KZc);this.KZc=b.a.instance.create(this.PNi,10,e.a.Mzi)}Ri(){this.tY(!1)}static fri(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(t.a)(d,"ListAutoCompleteBehavior",F.a,[292,2])},966:function(t,F,a){function c(d,h,m){return{name:d,dataType:1,value:h,classification:m?m:4}}a.d(F,"a",function(){return b});a.d(F,"c",function(){return e});a.d(F,"b",function(){return f});
t=[{name:"featureNameField",dataType:0,value:"FormulaSmartSuggestions",classification:4},{name:"ver",dataType:0,value:"1.0.0",classification:4}];F={dataCategories:2,samplingPolicy:1,diagnosticLevel:100};const b={eventName:"Office.Excel.FormulaSmartSuggestions.Seen",eventFlags:F,dataFields:[...t,c("isFeatureSeen",!0)]},e={eventName:"Office.Excel.FormulaSmartSuggestions.Tried",eventFlags:F,dataFields:[...t,c("isFeatureTried",!0)]},f={eventName:"Office.Excel.FormulaSmartSuggestions.Succeeded",eventFlags:F,
dataFields:[...t,c("isFeatureSucceeded",!0)]}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/0e0c17889e1f327d5a685da9ccc39207/EwaDSEsNext.kpae.js.map