'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1146:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1147:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1148:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-svg-icon{height:100%;width:100%}")}},1149:function(t,F,a){function c(l,v){this.ID=l;this.type=v}function b(l,v){this.value=l;this.contextId=v}function e(l,v,r,A,x,n,u,z){this.type=l;this.startTime=null==r||void 0==r.value?new b(r,null):r;this.endTime=null==A||void 0==A.value?new b(A,null):A;null!=x&&void 0!=x.value||new b(x,null);null!=n&&void 0!=n.value||new b(n,null);this.operationType=z}function f(l){this.ID=
l}function d(){this.Te=[];this.Mob=[];this.zYc=0;this.duration=this.startTime=null;this.K8b={};this.Myd=this.rzd=this.UZc=-1}function h(l){var v;return(null!=document.body.style.msTransform?v=l.style.msTransform:null!=document.body.style.webkitTransform?v=l.style.webkitTransform:null!=document.body.style.mozTransform?v=l.style.T8j:null!=document.body.style.oTransform?v=l.style.W8j:null!=document.body.style.transform&&(v=l.style.transform),v)?(v=v.replace("rotate(",""),v=v.replace("deg)",""),parseFloat(v)):
0}a.d(F,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),m9j:new b(0,null),w8j:new b(0,null),operationType:0};t=Array(1);t[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,t[0],null,0,1,1),new e(7,2,0,t[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(l,16)}}();d.prototype={Te:null,gRg:5,Mob:null,zYc:0,startTime:null,
duration:null,K8b:null,UZc:-1,rzd:-1,Myd:-1};d.prototype.Start=function(){this.startTime=new Date;this.K8b={}};d.prototype.GetRecentAnimationStats=function(){var l,v=[],r=0;for(l=m.zYc;l<m.gRg;l++)null!=m.Mob[l]&&(v[r]=m.Mob[l],r++);for(l=0;l<m.zYc;l++)null!=m.Mob[l]&&(v[r]=m.Mob[l],r++);return v};d.prototype.GetAnimationSqmStats=function(){var l=[];return l[0]=0>m.UZc?0:m.UZc,l[1]=0>m.rzd?0:m.rzd,l[2]=0>m.Myd?0:m.Myd,l};var m=new d},1150:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);
const b=()=>{c.a.Ai(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1166:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(38);class f extends e.a{constructor(ua){super();ua.da.Ha(376,this)}SOg(ua){this.addHandler("TAF",ua)}klj(ua){this.removeHandler("TAF",ua)}yaj(){this.raiseEvent("TAF")}}Object(t.a)(f,"GridHighlightBehaviorEventManager",e.a,[400,2]);class d extends b.a{constructor(ua){super();this.$=ua;this.Db()}create(){this.nb(this.$.da.Aa(376)||new f(this.$))}static ka(ua){ua.da.Ha(377,new d(ua))}}Object(t.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(50),m=a(37),l=a(27),v=a(81),r=a(15),A=a(241),x=a(14),n=a(159),u=a(5),z=a(117),w=a(12);class C extends Sys.EventArgs{constructor(ua,xa){super();this.start=ua;this.W5a=xa}}Object(t.a)(C,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var y=a(33);class B extends e.a{constructor(ua){super();this.Cmc=[3];this.eqa=void 0;this.gridView=ua;this.ihg=y.a.qH(this.gridView.$);this.RM=y.a.qH(this.gridView.$)}get coloredReferencesManager(){const ua=this.gridView.$.da.Aa(281);ua||r.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return ua}get IA(){if(this.eqa)return this.eqa;const ua=this.gridView.$.da.Aa(464);ua||r.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
ua.IA||r.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.eqa=ua.IA}uNg(ua){this.addHandler("mrek",ua)}KN(ua,xa,tb){for(const Qb of this.gridView.xn)A.a.instance.ta(x.a.yj,Qb.domElement,ua);A.a.instance.ta(x.a.Kf,document.documentElement,xa);this.gridView.mc.R8b(!0);tb&&A.a.instance.ta(x.a.oB,this.gridView.pj,xa)}D_d(ua,xa,tb){for(const Qb of this.gridView.xn)A.a.instance.Ba(x.a.yj,Qb.domElement,ua);A.a.instance.Ba(x.a.Kf,
document.documentElement,xa);this.gridView.mc.R8b(!1);tb&&A.a.instance.Ba(x.a.oB,this.gridView.pj,xa)}tfj(ua,xa){for(const tb of this.gridView.xn)n.a.instance.ta(x.a.Tf,tb.domElement,ua);n.a.instance.ta(x.a.ve,document.documentElement,xa)}ZXj(ua,xa){for(const tb of this.gridView.xn)n.a.instance.Ba(x.a.Tf,tb.domElement,ua);n.a.instance.Ba(x.a.ve,document.documentElement,xa)}wHe(ua,xa,tb,Qb){const pc=document.createElement("div");pc.className=xa;for(const hb of tb)pc.classList.add(hb);ua.appendChild(pc);
A.a.instance.ta(x.a.pointerDown,pc,Qb);return pc}c7e(ua){ua=ua.Mb.parentNode;if(!ua)return r.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;ua=parseInt(ua.getAttribute(u.a.W5a),10);return isNaN(ua)?(r.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Cb.KC(3,1,ua)}nMb(ua,xa,tb=!0){ua=tb&&(this.RM?!!this.IA&&
this.IA.Dqi(ua):!!this.coloredReferencesManager&&this.coloredReferencesManager.Cqi(ua));for(const Qb of xa)w.DOMElementExtensions.setVisible(Qb,ua)}ebc(){return this.gridView.Ql?z.a(this.gridView.$):this.gridView.Vb}wSf(){if(this.RM){var ua=this.ebc();ua&&this.IA?this.ihg?ua.GD(null):this.IA.Ufb(ua,null):(r.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Nj(this.Cmc),this.gridView.Cb.wk(null,
this.Cmc))}else this.gdj()}gdj(){const ua=this.ebc();ua&&this.coloredReferencesManager?this.ihg?ua.GD(null):this.coloredReferencesManager.GD(ua,null):(r.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Nj(this.Cmc),this.gridView.Cb.wk(null,this.Cmc))}DQf(ua,xa){this.raiseEvent("mrek",new C(ua,xa))}}Object(t.a)(B,"BehaviorHelperMethods",e.a,[]);var H=a(89),I=a(40);e=a(96);
class R extends e.a{constructor(ua,xa=null){super(ua,xa)}jZa(){}}Object(t.a)(R,"HighlightFlyweightBehavior",e.a,[]);var S=a(19),G=a(463),D=a(68),E=a(11),M=a(116),L=a(227),N=a(46);e=a(239);var Y=a(8),U=a(72),P=a(1),aa=a(34);class X extends e.a{constructor(ua,xa,tb){super(document.createElement("div"));this.w6b=null;this.HQb=!1;this.onPointerDown=Qb=>{Qb=aa.a(this.$)?aa.a(this.$).me(Qb):Qb;this.HQb=!1;if(3===(D.a.zb=Qb.ub)){const pc=Qb.Ea.rawEvent,hb=pc.srcElement||pc.target;w.DOMElementExtensions.Af(this.domElement,
hb)&&w.DOMElementExtensions.Af(pc.currentTarget,hb)&&(this.HQb=!0,this.w6b=Qb.clientPoint)}return!1};this.Wg=Qb=>{Qb=aa.a(this.$)?aa.a(this.$).me(Qb):Qb;this.raiseEvent("GrPointerUp",Qb);return this.HQb=!1};this.Ti=Qb=>{Qb=aa.a(this.$)?aa.a(this.$).me(Qb):Qb;3===Qb.ub&&this.HQb&&this.bbi(Qb.clientPoint)&&(this.raiseEvent("GrDrag"),this.HQb=!1);return!1};this.fd=Qb=>{aa.a(this.$)&&aa.a(this.$).me(Qb);return!0};this.$=tb;tb=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(tb?
U.a.lVe:U.a.kVe);this.domElement.classList.add(U.a.U9b);ua.appendChild(this.domElement);w.DOMElementExtensions.setVisible(this.domElement,!1);this.hLa=document.createElement("div");this.hLa.classList.add(U.a.T9b);this.hLa.style.borderColor=xa;this.domElement.appendChild(this.hLa);A.a.instance.ta(x.a.pointerDown,this.domElement,this.onPointerDown);A.a.instance.ta(x.a.Kf,this.domElement,this.Wg);n.a.instance.ta(x.a.ve,this.domElement,this.Wg);A.a.instance.ta(x.a.yj,this.domElement,this.Ti);n.a.instance.ta(x.a.Tf,
this.domElement,this.Ti);L.a.instance.ta(x.a.click,this.domElement,this.fd)}Jqe(ua){this.addHandler("GrDrag",ua)}lWf(ua){this.removeHandler("GrDrag",ua)}Iqe(ua){this.addHandler("GrContxt",ua)}kWf(ua){this.removeHandler("GrContxt",ua)}Kqe(ua){this.addHandler("GrPointerUp",ua)}mWf(ua){this.removeHandler("GrPointerUp",ua)}dispose(){N.a.Qma(this.domElement);super.dispose()}$jg(ua){this.domElement.parentNode.removeChild(this.domElement);ua.appendChild(this.domElement)}D3f(){this.domElement.classList.remove(U.a.U9b);
this.hLa.classList.remove(U.a.T9b);this.hLa.classList.add(U.a.mVe)}oig(){this.hLa.classList.remove(U.a.mVe);this.hLa.classList.add(U.a.T9b);this.domElement.classList.add(U.a.U9b)}bbi(ua){return!!this.w6b&&(3<Math.abs(ua.x-this.w6b.x)||3<Math.abs(ua.y-this.w6b.y))}static uwb(ua){return P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(ua=aa.a(ua.$)?aa.a(ua.$).zoom:Y.a.q_,Math.round(9/Math.max(ua,1))):9}}X.vyd=0;Object(t.a)(X,"TouchGrippie",e.a,[]);class Z extends R{constructor(ua,
xa,tb,Qb){super(xa);this.Gtd=this.YYc=this.apb=!1;this.yqb=null;this.tba=this.Btd=!1;this.Dw=()=>{this.apb&&this.Btd?this.Sna():this.l4()};this.RDf=hb=>{3===hb.ub&&(this.Btd=!0,this.Sna());return!1};this.SDf=hb=>{if(3===hb.ub){if(!hb.Mb||this.poi(hb))return!1;this.Btd=!1;this.l4()}return!1};this.Xg=()=>{this.tba&&this.H_d();this.Sna();this.Gtd=!1};this.qr=()=>{this.l4();this.Gtd=!0};this.Nya=(hb,ib)=>{ib.o4===this.o4&&(ib.visible?this.Gtd||this.Sna():this.l4())};this.yJf=()=>{this.TDf(this.vO.domElement,
!1)};this.dAf=()=>{this.TDf(this.YL.domElement,!0)};this.jpc=(hb,ib)=>{this.ha.zza(ib)};this.kpc=(hb,ib)=>{this.ha.zza(G.b(ib))};this.eGb=()=>{3===D.a.zb?this.Sna():this.l4();this.tba&&1===D.a.zb&&this.H_d()};this.zJf=()=>{this.Mwj()};this.oOe=()=>{this.l4()};this.wn=()=>{this.ha.Sa.dc&&this.l4()};this.Szf=()=>{this.l4()};this.KDf=(hb,ib)=>{this.H_d();3===ib.ub?this.Sna():this.l4()};this.gtc=()=>{this.apb&&(this.l4(),this.Sna())};const pc=tb.$;this.Wt=tb;this.ha=tb.ha;this.dba=ua;this.ouj=xa;this.paneType=
Qb;ua=this.domElement.currentStyle;xa="#000000";ua&&(xa=ua.borderTopColor);this.vO=new X(this.xcd(),xa,pc);this.YL=new X(this.xcd(),xa,pc);this.ykf=pc.ea.isNamedObjectViewMode&&1===pc.workbookContext.NovMode;this.vO.Jqe(this.yJf);this.vO.Iqe(this.jpc);this.vO.Kqe(this.kpc);this.YL.Jqe(this.dAf);this.YL.Iqe(this.jpc);this.YL.Kqe(this.kpc);for(const hb of this.gridView.xn)n.a.instance.ta(x.a.pf,hb.domElement,this.SDf),n.a.instance.ta(x.a.ve,hb.domElement,this.RDf);tb.view.Ps(this.Dw);tb.Vb.xl(this.oOe);
tb.Cb.pob(this.Nya);tb.XWc(this.Szf);pc.bC(this.gtc);tb.Uu(this.gtc);this.ha.j2(this.Xg);this.ha.v9(this.qr);tb.gE(this.wn);this.ha.r_b(this.KDf);D.a.Tqe(this.eGb);m.TaskExtensions.za(h.GetServiceTaskFactory.Oa(pc.da,376,377,0),hb=>{hb.result.SOg(this.zJf)},pc.la,3)}get gridView(){return this.Wt}dispose(){H.a.pc([this.vO,this.YL]);this.vO.lWf(this.yJf);this.vO.kWf(this.jpc);this.vO.mWf(this.kpc);this.YL.lWf(this.dAf);this.YL.kWf(this.jpc);this.YL.mWf(this.kpc);for(var ua of this.gridView.xn)n.a.instance.Ba(x.a.pf,
ua.domElement,this.SDf),n.a.instance.Ba(x.a.ve,ua.domElement,this.RDf);this.gridView.view.Jq(this.Dw);this.gridView.Vb.nl(this.oOe);this.gridView.Cb.RJb(this.Nya);this.gridView.KLd(this.Szf);this.gridView.$.xF(this.gtc);this.gridView.jy(this.gtc);this.ha.S_(this.Xg);this.ha.uda(this.qr);this.gridView.yF(this.wn);this.ha.uuc(this.KDf);D.a.uWf(this.eGb);this.tba&&r.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(ua=this.gridView.$.da.Aa(376))&&ua.klj(this.zJf);
super.dispose()}sSa(){if(!this.dba.range||!this.dba.range.equals(this.fdb))return!1;const ua=!this.gridView.MMa();return this.gridView.fb&&ua&&(this.fdb.isRow||this.fdb.Rg)?!1:this.tba?!0:3===D.a.zb}l4(){this.apb&&(this.vO.set_visible(!1),this.YL.set_visible(!1),this.apb=!1)}Sna(){if(this.sSa()){this.K0j();var ua=w.DOMElementExtensions.getBoundingClientRect(this.yqb);ua||r.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.ykf,this.YYc,this.gridView.pj,this.gridView.ib.gj);var xa=w.DOMElementExtensions.getBoundingClientRect(this.ouj),tb=new Sys.UI.Bounds(xa.x-ua.x,xa.y-ua.y,xa.width,xa.height),Qb=this.fdb,pc=Qb.topLeft,hb=Qb.bottomRight,ib=Qb.isRow||Qb.Rg;if(Qb.Rg){var Vb=this.$Gh();Qb=tb.x-2*X.uwb(this.gridView);var wc=Vb;var Lc=tb.x+xa.width}else Qb.isRow?(Qb=Lc=this.ZGh(),wc=tb.y-2*X.uwb(this.gridView),Vb=tb.y+xa.height):(wc=tb.y,Vb=tb.y+xa.height,this.gridView.rtl?(Qb=
tb.x+xa.width,Lc=tb.x):(Qb=tb.x,Lc=tb.x+xa.width));xa=X.vyd+(ib?0:X.uwb(this.gridView));this.vO.style.left=E.HelperMethods.sc(Qb-xa);this.vO.style.top=E.HelperMethods.sc(wc-xa);this.YL.style.left=E.HelperMethods.sc(Lc-xa);this.YL.style.top=E.HelperMethods.sc(Vb-xa);this.vO.set_visible(this.Vif(wc,Qb,pc,ib,ua));this.YL.set_visible(this.Vif(Vb,Lc,hb,ib,ua));this.apb=!0}}Vif(ua,xa,tb,Qb,pc){const hb=w.DOMElementExtensions.getBoundingClientRect(this.gridView.Rf(this.paneType).domElement);pc=new Sys.UI.Bounds(hb.x-
pc.x-3,hb.y-pc.y-3,hb.width+6,hb.height+6);return(this.gridView.ib.yi(tb)===this.paneType||Qb)&&I.a.UM(pc,new Sys.UI.Point(xa,ua))}K0j(){if(this.ykf!==this.YYc){this.yqb=null;const ua=this.xcd();this.vO.$jg(ua);this.YL.$jg(ua)}}$Gh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+X.vyd-X.uwb(this.gridView))/2}ZGh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+X.vyd-X.uwb(this.gridView))/2}NHf(){this.Sna()}poi(ua){return w.DOMElementExtensions.kRa(ua.Mb,
S.a.fo)&&(this.rpi(ua)||this.spi(ua))}spi(ua){if(this.gridView.rtl)ua=ua.clientPoint.x;else{const xa=w.DOMElementExtensions.getBoundingClientRect(ua.Mb);ua=ua.clientPoint.x-(xa.x+xa.width-M.a.Bu)}return 0<ua&&ua<=M.a.Bu}rpi(ua){const xa=w.DOMElementExtensions.getBoundingClientRect(ua.Mb);ua=ua.clientPoint.y-(xa.y+xa.height-M.a.Bu);return 0<ua&&ua<=M.a.Bu}TDf(ua,xa){this.tba&&r.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.e1c(ua,xa,this.tba);
this.l4()}Mwj(){this.tba||(r.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.tba=!0,this.vO.D3f(),this.YL.D3f(),this.gridView.ha.sourceRange=this.gridView.ha.qa.ld,this.Sna())}H_d(){this.tba&&(r.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.tba=!1,this.vO.oig(),this.YL.oig())}xcd(){this.yqb||(this.YYc=!1,this.yqb=this.gridView.pj);return this.yqb}}Object(t.a)(Z,"SelectionTouchGrippiesBehaviorBase",R,[]);class da extends Z{constructor(ua,
xa,tb,Qb){super(ua,xa,tb,Qb)}get o4(){return 19}get fdb(){return this.gridView.ha.qa.activeRange}sSa(){const ua=this.gridView.Uh||this.gridView.fb;return!this.gridView.ha.qa.Tg&&!ua&&super.sSa()}}Object(t.a)(da,"DiscontinuousSelectionTouchGrippiesBehavior",Z,[]);var qa=a(379);class O extends R{constructor(ua){super(ua);const xa=document.createElement("div");xa.className=U.a.oCh;ua.appendChild(xa)}}Object(t.a)(O,"SelectionBorderBehavior",R,[]);class ca{}ca.SBh="ewr-selection-draghandle";ca.XBh="ewr-selection-draghandle-grab";
ca.hCh="ewr-selection-draghandle-top-ie";ca.iCh="ewr-selection-draghandle-top-ie-enhanced";ca.fCh="ewr-selection-draghandle-top";ca.gCh="ewr-selection-draghandle-top-enhanced";ca.VBh="ewr-selection-draghandle-bottom-ie";ca.WBh="ewr-selection-draghandle-bottom-ie-enhanced";ca.TBh="ewr-selection-draghandle-bottom";ca.UBh="ewr-selection-draghandle-bottom-enhanced";ca.$Bh="ewr-selection-draghandle-left-ie";ca.aCh="ewr-selection-draghandle-left-ie-enhanced";ca.YBh="ewr-selection-draghandle-left";ca.ZBh=
"ewr-selection-draghandle-left-enhanced";ca.dCh="ewr-selection-draghandle-right-ie";ca.eCh="ewr-selection-draghandle-right-ie-enhanced";ca.bCh="ewr-selection-draghandle-right";ca.cCh="ewr-selection-draghandle-right-enhanced";ca.jCh="ewr-selection-dragtooltip";ca.kCh="ewr-selection-dragtooltip-updated";ca.vCh="ewr_selection_rearrangeleft";ca.wCh="ewr_selection_rearrangeright";ca.xCh="ewr_selection_rearrangetop";ca.uCh="ewr_selection_rearrangebottom";ca.selecting="selecting";ca.yCh="ewr-selection-resizemarqueehandle";
ca.BCh="ewr-selection-resizemarqueehandle-topleft";ca.CCh="ewr-selection-resizemarqueehandle-topright";ca.zCh="ewr-selection-resizemarqueehandle-bottomleft";ca.ACh="ewr-selection-resizemarqueehandle-bottomright";ca.IBh="ewr-marquee-thick";ca.MBh="ewr-resizemarqueehandle-thick";Object(t.a)(ca,"CssClassNames",null,[]);var wa=a(253),ia=a(21);class Ha extends O{constructor(ua,xa,tb,Qb){super(ua);this.bTa=!1;this.Ane=this.Bne=null;this.Fra=0;this.mr=P.EwaSettings.getBooleanFeatureGate(qa.a.p8b,!1);this.Nni=
P.EwaSettings.getBooleanFeatureGate(qa.a.kph,!1);this.R1d=this.gmd=this.N2=0;this.RV=this.Gb=this.sourceRange=this.Dma=null;this.Wg=pc=>{pc=aa.a(this.$).me(pc);return this.zGf(pc)};this.onPointerDown=pc=>{pc=aa.a(this.$).me(pc);if(2===pc.ub&&pc.Rn===Sys.UI.MouseButton.leftButton&&!this.bTa){var hb=this.Gid(pc);if(!hb)return r.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Gb=hb.clone();this.sourceRange=this.Gb.clone();this.Dma=this.Gb;
if(hb=this.QYh(pc))this.Nm=5,this.R1d=hb.top-this.sourceRange.top,this.gmd=hb.left-this.sourceRange.left,ia.h(this.$).Gg.qp(this.mr?Ha.Ttb:Ha.INe),this.YDd(pc),this.bTa=!0,wa.b(this.$,!0)}return!1};this.Ti=pc=>{pc=aa.a(this.$).me(pc);if(this.mr&&this.ZDd(pc))return!0;if(pc=this.ha.Wp(pc.clientPoint,pc.Mb,5,void 0,void 0,!0)){pc=this.Dqb(pc);if(this.Gb.equals(pc))return!0;this.Gb=pc;if(!this.dS())return r.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.t$b(!0),!1}return!0};this.dd=(pc,hb)=>{hb.$M||(P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.Adb(this.$.isEditMode&&this.jeb()):this.Adb(this.$.isEditMode))};this.HC=[];this.$=xa;this.ha=ia.h(this.$).ha;this.paneType=tb;this.No=Qb;xa=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");xa=this.Nni?xa?[ca.gCh,ca.UBh,ca.ZBh,ca.cCh]:[ca.iCh,ca.WBh,ca.aCh,ca.eCh]:xa?[ca.fCh,ca.TBh,ca.YBh,ca.bCh]:[ca.hCh,ca.VBh,ca.$Bh,ca.dCh];for(const pc of xa)xa=
this.No.wHe(ua,pc,this.mr?[ca.XBh]:[ca.SBh],this.onPointerDown),this.HC.push(xa);this.$.Lk(this.dd);P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.Adb(this.$.isEditMode)}get Cb(){return ia.h(this.$).Cb}get Nm(){return this.ha.selectionType}set Nm(ua){this.ha.selectionType=ua}dispose(){this.HC.forEach(ua=>{A.a.instance.Ba(x.a.pointerDown,ua,this.onPointerDown)});this.HC.length=0;this.Dma=this.sourceRange=this.Gb=null;r.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Fra}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.pl(this.dd),1===this.Fra&&(r.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.dJ(this.Ane,this.Bne,!1)));super.dispose()}zGf(ua){if(5!==this.Nm)return!1;(ua=this.$Oa(ua))||this.t$b(!1);wa.b(this.$,!1);return ua}KN(ua,xa){r.ULS.shipAssertTag(537159377,0,!this.Fra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Fra+=1;this.Ane=ua;this.Bne=xa;this.No.KN(ua,
xa,this.CZd())}Dqb(ua){if(!ua||!this.Gb)return r.ULS.shipAssertTag(537159376,0,!!ua,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),r.ULS.shipAssertTag(537159375,0,!!this.Gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const xa=this.Gb.clone();1!==this.N2&&(xa.left=Math.max(ua.left-this.gmd,1),xa.right=xa.left+this.sourceRange.width-1);2!==this.N2&&(xa.top=Math.max(ua.top-this.R1d,1),xa.bottom=xa.top+this.sourceRange.height-1);return this.Cob(xa)}dJ(ua,
xa,tb=!0,Qb=!0){r.ULS.shipAssertTag(537159374,0,1===this.Fra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Fra;this.mr||ia.h(this.$).Gg.qp(u.a.LU);this.No.D_d(ua,xa,this.CZd());tb&&this.oCe(Qb);this.N2=0;this.bTa=!1}Cob(ua){var xa=ia.h(this.$);let tb=ua;if(xa.ib.h4){if(!xa.Qb(ua.topLeft)){xa=xa.Wj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",xa.cQ,this.Dma.top!==ua.top?1:2);try{xa.Ik=this.Dma.top<ua.top||this.Dma.left<ua.left,xa.vv(ua.topLeft),
tb=xa.$$cu().range}finally{xa&&xa.dispose()}}tb.right=tb.left+ua.width-1;tb.bottom=tb.top+ua.height-1}return this.Dma=tb}Adb(ua){this.HC.forEach(xa=>{w.DOMElementExtensions.setVisible(xa,ua)})}QYh(ua){const xa=ua.Mb;ua=ua.clientPoint;if(!xa||!ua)return r.ULS.shipAssertTag(537159373,0,!!xa,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),r.ULS.shipAssertTag(537159372,0,!!ua,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;ua.y+=xa===this.HC[Ha.s8b]?
2:xa===this.HC[Ha.LNe]?-2:0;ua.x+=xa===this.HC[Ha.NNe]?2:xa===this.HC[Ha.r8b]?-2:0;return this.ha.Wp(ua,xa,5,void 0,void 0,!0)}}Ha.INe="move";Ha.Q4c="copy";Ha.Ttb="grabbing";Ha.s8b=0;Ha.LNe=1;Ha.NNe=2;Ha.r8b=3;Object(t.a)(Ha,"DragSelectionClickBehaviorBase",O,[]);class Sa extends Ha{constructor(ua,xa,tb,Qb,pc,hb){super(ua,xa,tb,pc);this.eb=this.CF=null;this.G$e=()=>{this.t$b(!0)};P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Adb(this.jeb()&&this.$.isEditMode);
this.gridView=ia.h(this.$);this.iF=Qb;this.coloredReferencesManager=this.$.da.Aa(281);r.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.RM=y.a.qH(this.$))ua=this.$.da.Aa(464),r.ULS.shipAssertTag(512312961,0,!!ua,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.IA=ua.IA;
for(const ib of this.HC)A.a.instance.ta(x.a.SV,ib,this.iF.Ycf),A.a.instance.ta(x.a.oB,ib,this.iF.Zcf);this.jZa(hb)}jZa(ua){this.No.nMb(ua,this.HC);this.iF.cAa()}YDd(ua){r.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.OLa=!0;this.eb.nE(!1);this.Nm=5;this.iF.PNe(ua.Mb);this.eb.textBox.removeSelection();this.eb.C_b(this.G$e);this.KN(this.Ti,this.Wg);this.N2=this.sourceRange.isRow?1:this.sourceRange.Rg?2:0}$Oa(){const ua=
this.DW();this.Nm=-1;this.dJ(this.Ti,this.Wg);return ua}oCe(){this.gridView.OLa=!1;this.iF.QNe(this.HC[0]);this.eb.textBox.setCaretPositionToEnd();this.eb.Fuc(this.G$e);this.No.wSf()}t$b(ua){r.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");ua&&this.dJ(this.Ti,this.Wg)}Gid(ua){this.eb=this.No.ebc();this.CF=this.No.c7e(ua);return this.eb&&this.CF&&this.CF.range?this.CF.range:(r.ULS.shipAssertTag(537159388,
0,!!this.eb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),r.ULS.shipAssertTag(537159387,0,!!this.CF,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),r.ULS.shipAssertTag(537159386,0,!!this.CF.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}DW(){return this.CF?this.RM?this.IA.CEb(this.eb,this.CF,this.Gb):this.coloredReferencesManager.CEb(this.eb,this.CF,this.Gb):(r.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}dS(){return this.DW()}CZd(){return!0}ZDd(){return!1}jeb(){return!0}}Object(t.a)(Sa,"DragMarqueeClickBehavior",Ha,[]);var Da=a(86),ea=a(110),sa=a(174),Ea=a(83),ba=a(420),ka=a(724),Ca=a(228),db=a(29),yb=a(45);class kb extends Ha{constructor(ua,xa,tb,Qb,pc){super(ua,xa,tb,pc);this.fr=null;this.Rg=this.isRow=!1;this.Xg=()=>{this.domElement.classList.remove(ca.selecting)};this.qr=()=>{this.domElement.classList.add(ca.selecting)};this.Uc=()=>{if(this.$.isEditMode){const hb=this.jeb();this.Adb(hb)}};
this.tableManager=Qb;P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Adb(this.jeb()&&this.$.isEditMode);this.dm={};this.cz=!1;this.ha.v9(this.qr);this.ha.j2(this.Xg);this.ha.NL(this.Uc);this.B1d=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.uda(this.qr),this.ha.S_(this.Xg),this.ha.sR(this.Uc),P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.Suc(this.K$a));if(this.dm)for(let ua=
1;4>=ua;ua++)w.DOMElementExtensions.vf(this.dm[ua.toString()]);this.dm=this.fr=null;super.dispose()}oCe(ua){ua&&(this.mr&&ia.h(this.$).Gg.qp(u.a.LU),ea.KeyInputManager.instance.Ba(x.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.cz=!1);for(ua=1;4>=ua;ua++){const xa=this.dm[ua.toString()];xa&&xa.parentNode.removeChild(xa);this.dm[ua.toString()]=null}this.fr=null}Gid(){return this.ha.qa.ld}DW(){this.ha.updateSelection(this.Gb,this.Gb.topLeft,0);return!0}dS(ua=!1){this.Cb.wk(this.Gb,this.Maa());
this.Cb.Nq(this.Maa());this.kI(ua);return!0}Goa(ua=!1){this.Cb.wk(this.Gb,this.fr);this.Cb.Nq(this.fr);this.kI(ua)}t$b(){r.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}CZd(){return!1}a7(ua,xa,tb,Qb,pc=!1){var hb=w.DOMElementExtensions.getBoundingClientRect(xa);let ib=xa===this.HC[Ha.s8b]||xa===this.HC[Ha.LNe];if(this.mr){var Vb=xa===this.HC[Ha.NNe]||xa===this.HC[Ha.r8b];this.isRow&&Vb||this.Rg&&ib?
Vb="100px":(ib=this.isRow||ib,Vb=(ib?pc?kb.tTj:kb.yTj:pc?kb.sTj:kb.vTj)+"px");xa=ib?xa===this.HC[Ha.s8b]?"top":"bottom":xa===this.HC[Ha.r8b]?"right":"left";ua=100*(ib?ua.x-hb.x:ua.y-hb.y)/(ib?hb.width:hb.height);for(hb=1;4>=hb;hb++){Qb=document.createElement("div");var wc=document.createElement("div");const Lc=document.createElement("div");Qb.appendChild(wc);Qb.appendChild(Lc);pc&&(wc=document.createElement("div"),Qb.appendChild(wc),Lc.style.fontWeight="bold");Qb.className=ca.kCh;this.dm[hb.toString()]=
Qb;this.Cb.KC(tb,hb).hg.appendChild(Qb);Qb=this.dm[hb.toString()];Qb.style[xa]=Vb;Qb.style[ib?"left":"top"]=ua+"%"}}else for(pc=(ib?-kb.xTj:-kb.uTj)+"px",Vb=ib?xa===this.HC[Ha.s8b]?"top":"bottom":xa===this.HC[Ha.r8b]||Qb?"right":"left",xa=100*(ib?Qb?0:ua.x-hb.x:ua.y-hb.y)/(ib?hb.width:hb.height),ua=1;4>=ua;ua++)hb=document.createElement("div"),hb.className=ca.jCh,this.dm[ua.toString()]=hb,this.Cb.KC(tb,ua).hg.appendChild(hb),hb=this.dm[ua.toString()],hb.style[Vb]=pc,hb.style[ib?"left":"top"]=xa+"%"}Sjg(ua,
xa,tb){const Qb=ia.h(this.$),pc=Qb.xg(ua);var hb=Qb.Rf(this.paneType);tb=ka.a.Gu(hb.view.ii,this.domElement.parentNode,tb,Qb.rtl);hb=!1;let ib=2;xa&&tb.y-pc.topLeft.y>pc.height/2?(hb=!0,ib=1):!xa&&tb.x-pc.topLeft.x>pc.width/2&&(hb=!0);if(hb){xa=Qb.Wj("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Qb.cQ,ib);try{xa.vv(ua),xa.$$mn(),xa.$$cu()}finally{xa&&xa.dispose()}}}brb(ua){this.Cb.Nj(this.fr);this.dJ(this.hma,this.ima,void 0,ua)}IT(ua){this.Cb.Nj(this.Maa());this.dJ(this.Ti,this.Wg,
void 0,ua)}Hwb(){return this.mr?48:6}Maa(){return this.mr?kb.lph:kb.oph}A6a(ua){return ua.Ea.keyCode===Da.a.Noa||l.a.isMac&&ua.Ea.keyCode===Da.a.rUa}Ozb(ua){ua=ia.h(this.$).getRangeInformation(ua);for(let xa=0,tb=ua.length;xa<tb;++xa)if(Object(ba.a)(Ca.PivotTableRange,ua[xa]))return ua=db.a.ed(1,0,900,899,0,2105176604,"InsDelCellsPivotTable"),yb.a(this.$).Jt([ua]),!0;return!1}}kb.uTj=50;kb.xTj=25;kb.vTj=-85;kb.yTj=-40;kb.sTj=-120;kb.tTj=-50;kb.oph=[6];kb.lph=[48];Object(t.a)(kb,"DragSelectionClickBehaviorTemporary",
Ha,[]);var mb=a(24),W=a(796),Q=a(41),va=a(192),na=a(113),Ba=a(282),Oa=a(60);const oa=(ua,xa,tb,Qb,pc,hb,ib,Vb=null)=>{Vb=ua.Na(41,Vb);Vb.sourceRange=xa;Vb.destinationRange=tb;return Oa.g(ua,"RearrangeRowColumn",Vb,Qb,pc,hb,ib,0)},Ja=(ua,xa,tb,Qb,pc,hb,ib=null)=>{ib=ua.Na(1,ib);ib.moveRange=xa;return Oa.g(ua,"MoveLineItems",ib,tb,Qb,pc,hb,0)};class Wb{constructor(ua,xa){this.destinationRange=this.sourceRange=null;this.sourceRange=ua;this.destinationRange=xa}}Object(t.a)(Wb,"MacroRecorderTableRowColumnRearrangedPayload",
null,[122]);var nc=a(13);class Yb extends kb{constructor(ua,xa,tb,Qb,pc){super(ua,xa,tb,Qb,pc);this.Zda=null;this.MQ=this.NQ=!1;this.Cof=0;this.NAa=this.Sta=null;this.oJ=0;this.t8b=nc.a.instance.ga(2266);this.RNe=nc.a.instance.ga(2267);this.Vyc=nc.a.instance.ga(2268);this.D7f=nc.a.instance.ga(2269);this.onKeyDown=hb=>{if(this.mr){if(this.A6a(hb)||hb.Ea.keyCode===Da.a.sUa)return this.IMa||(ea.KeyInputManager.instance.ta(x.a.Kd,this.domElement.ownerDocument.body,this.onKeyUp),this.IMa=!0),!this.JZ&&
this.A6a(hb)&&(ia.h(this.$).Gg.qp(Ha.Q4c),this.JZ=!0),this.KZ||hb.Ea.keyCode!==Da.a.sUa||(ia.h(this.$).Gg.qp(Ha.Ttb),this.KZ=!0,2===this.oJ?(this.IT(!1),this.N2=0,this.fr=this.MQ?[11]:[12],this.NQ=this.MQ,this.CKd(),this.Goa()):3===this.oJ?(this.arb(!1),this.N2=this.isRow?1:2,this.Mma(),this.dS()):1===this.oJ&&(this.brb(!1),this.Mma(),this.dS())),!0}else if(!this.JZ&&(hb.Ea.keyCode===Da.a.Noa||l.a.isMac&&hb.Ea.keyCode===Da.a.rUa))return ea.KeyInputManager.instance.ta(x.a.Kd,this.domElement.ownerDocument.body,
this.onKeyUp),ia.h(this.$).Gg.qp(Ha.Q4c),this.JZ=!0;return!1};this.onKeyUp=hb=>{if(this.mr){if(this.A6a(hb)||hb.Ea.keyCode===Da.a.sUa)return this.Cof=this.A6a(hb)?0:1,this.cz&&ia.h(this.$).Gg.qp(Ha.Ttb),hb.Ea.keyCode===Da.a.sUa&&(2===this.oJ?(this.arb(!1),this.N2=0,this.Mma(!0),this.dS(!0)):3===this.oJ?(this.IT(!1),this.N2=this.isRow?1:2,this.fr=this.isRow?[11]:[12],this.CKd(!0),this.Goa(!0)):1===this.oJ&&(this.IT(!1),this.fr=this.MQ?[11]:[12],this.bJb(!0),this.Goa(!0))),this.hDc(this.Cof),!0}else if(hb.Ea.keyCode===
Da.a.Noa||l.a.isMac&&hb.Ea.keyCode===Da.a.rUa)return this.hDc(),this.cz&&ia.h(this.$).Gg.qp(Ha.INe),!0;return!1};this.ima=hb=>{hb=aa.a(this.$).me(hb);5===this.Nm?this.zGf(hb):(this.cz=!1,this.Cb.Nj(this.fr),!this.$.Us([this.Gb],!1)||this.ddj()||this.vkf()||(this.ha.sourceRange=this.sourceRange.clone(),this.mr?this.t9i():this.dWe(),this.Fba()?this.Gb.top>this.sourceRange.top&&(hb=this.Gb.height,this.Gb.top-=hb,this.Gb.bottom-=hb):this.Gb.left>this.sourceRange.left&&(hb=this.Gb.width,this.Gb.left-=
hb,this.Gb.right-=hb),this.DW()),this.vwd());this.dJ(this.hma,this.ima);this.tableRange=null;this.Nm=-1;this.mr&&(this.Zda=null,this.oJ=0);return!0};this.vGb=()=>{this.cz=!1;this.oJ=0;this.Cb.Nj(this.fr);if(!this.$.Us([this.Gb],!1))return this.dJ(this.uGb,this.vGb),this.Nm=-1,!0;if(!(this.ha.qa.ld.equals(this.Gb)||this.Ozb(this.Gb)||this.Ozb(this.sourceRange)||this.vkf()||(this.DW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Zc(-694765314,2,30,{[u.a.TIa]:this.JZ,[u.a.d9c]:!0,[u.a.e9c]:this.NQ,
[u.a.eaa]:this.ha.sourceRange,[u.a.daa]:this.ha.qa.ld,[u.a.Qtb]:this.KZ}),this.JZ))){if(this.Gb.top>this.sourceRange.top&&(this.isRow||this.Gb.left===this.sourceRange.left&&this.NQ)){var hb=this.Gb.height;this.Gb.top-=hb;this.Gb.bottom-=hb}else this.Gb.left>this.sourceRange.left&&(this.Rg||this.Gb.top===this.sourceRange.top&&!this.NQ)&&(hb=this.Gb.width,this.Gb.left-=hb,this.Gb.right-=hb);this.DW()}this.dJ(this.uGb,this.vGb);this.Zda=this.tableRange=null;this.Nm=-1;this.NQ=!1;this.vwd();return!0};
this.hma=hb=>{const ib=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ib&&(hb=aa.a(this.$).me(hb));var Vb=hb.clientPoint;ib||(hb=aa.a(this.$).me(hb));this.mr&&(this.RV=hb);if(hb=this.ha.Wp(Vb,hb.Mb,5,void 0,void 0,!0)){if(this.tableRange.contains(hb.topLeft)){if(this.Sjg(hb,this.Fba(),Vb),this.Gb=this.bHa(hb),this.ha.sourceRange=this.Gb,this.Cb.wk(this.Gb,this.fr),this.Cb.Nq(this.fr),this.Cb.Nj(this.Maa()),6!==this.Nm){for(Vb=1;4>=Vb;Vb++)hb=this.dm[Vb.toString()],
hb.parentNode.removeChild(hb),this.Cb.KC(this.Fba()?11:12,Vb).hg.appendChild(hb);this.Nm=6}}else if(this.Gb=this.Dqb(hb),this.mr)this.g$e(!1);else if(this.Cb.wk(this.Gb,this.Maa()),this.Cb.Nq(this.Maa()),this.Cb.Nj(this.fr),5!==this.Nm){for(Vb=1;4>=Vb;Vb++)hb=this.dm[Vb.toString()],hb.parentNode.removeChild(hb),this.Cb.KC(this.Hwb(),Vb).hg.appendChild(hb);this.Nm=5}this.kI()}return!0};this.uGb=hb=>{var ib=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ib&&(hb=
aa.a(this.$).me(hb));var Vb=hb.clientPoint;ib||(hb=aa.a(this.$).me(hb));this.RV=hb;if(ib=this.ha.Wp(Vb,hb.Mb,5,void 0,void 0,!0)){if(this.Naf(ib))return this.Gb=this.Dqb(ib),this.f$e(!1),!0;var wc=ia.h(this.$),Lc=wc.xg(ib),Fc=wc.Rf(this.paneType);Vb=ka.a.Gu(Fc.view.ii,this.domElement.parentNode,Vb,wc.rtl);Fc=!1;let fd=2;this.NQ=!1;if(this.isRow||this.Rg){this.isRow&&Vb.y-Lc.topLeft.y>Lc.height/2?(Fc=!0,fd=1):this.Rg&&Vb.x-Lc.topLeft.x>Lc.width/2&&(Fc=!0);if(Fc){hb=wc.Wj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
wc.cQ,fd);try{hb.vv(ib),hb.$$mn(),ib=hb.$$cu().range}finally{hb&&hb.dispose()}}this.Gb=this.Dqb(ib)}else{Vb.x-Lc.topLeft.x===Lc.width?(this.NQ=!1,Fc=!0):Vb.y-Lc.topLeft.y>Lc.height/2&&(this.NQ=Fc=!0,fd=1);this.Zda&&(this.NQ=this.MQ);if(Fc){wc=wc.Wj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",wc.cQ,fd);try{wc.vv(ib),wc.$$mn(),ib=wc.$$cu().range}finally{wc&&wc.dispose()}}this.Cb.Nj(this.fr);this.fr=this.NQ?[11]:[12];for(wc=1;4>=wc;wc++)(Lc=this.dm[wc.toString()])&&Lc.parentNode.removeChild(Lc),
this.dm[wc.toString()]=null;this.a7(hb.clientPoint,hb.Mb,this.NQ?11:12,!0);this.Gb=this.bHa(ib)}this.ha.sourceRange=this.Gb;this.Cb.wk(this.Gb,this.fr);this.Cb.Nq(this.fr);this.Cb.Nj(this.Maa());if(6!==this.Nm){for(hb=1;4>=hb;hb++)ib=this.dm[hb.toString()],ib.parentNode.removeChild(ib),this.Cb.KC(this.isRow||this.NQ?11:12,hb).hg.appendChild(ib);this.Nm=6}this.kI()}return!0};this.K$a=()=>{this.mr?this.cz&&5<=this.Nm&&(this.tableRange?this.KZ?this.IT(!0):this.brb(!0):this.KZ?this.isRow||this.Rg?this.IT(!0):
this.arb(!0):this.isRow||this.Rg?this.arb(!0):this.IT(!0)):this.cz&&5<=this.Nm&&(this.tableRange?(this.Cb.Nj(this.fr),this.dJ(this.hma,this.ima)):(this.Cb.Nj(this.Maa()),this.dJ(this.Ti,this.Wg)))};this.tableRange=null;this.IMa=this.JZ=this.KZ=!1;this.ha.CXc(this.K$a)}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.Suc(this.K$a);this.JZ&&this.hDc();this.mr&&this.KZ&&this.hDc(1);super.dispose()}YDd(ua){this.mr&&(this.RV=ua,this.Zda=
null,this.MQ=this.isRow=this.Rg=this.NQ=!1,ea.KeyInputManager.instance.ta(x.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown));this.cz=!0;this.tableRange=this.r0g(this.tableManager.Mp(this.sourceRange.topLeft));ia.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.mr?(this.Zda=this.tableRange,this.oJ=1,this.fr=(this.MQ=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Nm=6,this.KN(this.hma,this.ima),this.Sta=this.t8b,
this.NAa=this.Vyc,this.a7(ua.clientPoint,ua.Mb,this.MQ?11:12,!0,!0),this.Goa(!0)):(this.fr=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Nm=6,this.KN(this.hma,this.ima),this.a7(ua.clientPoint,ua.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.mr?(this.isRow=this.sourceRange.isRow,this.Rg=this.sourceRange.Rg,this.isRow||this.Rg?(this.oJ=3,this.N2=this.isRow?1:2,this.Nm=6,this.fr=this.isRow?[11]:[12],this.KN(this.uGb,this.vGb),
this.Sta=this.t8b,this.NAa=this.Vyc,this.a7(ua.clientPoint,ua.Mb,this.isRow?11:12,!0,!0),this.Goa(!0)):(this.oJ=2,this.N2=0,this.KN(this.Ti,this.Wg),this.Sta=this.RNe,this.NAa=this.D7f,this.a7(ua.clientPoint,ua.Mb,this.Hwb(),!1,!0),this.dS(!0))):(this.KN(this.Ti,this.Wg),ea.KeyInputManager.instance.ta(x.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.N2=this.sourceRange.isRow?1:this.sourceRange.Rg?2:0,this.a7(ua.clientPoint,ua.Mb,this.Hwb(),!1),this.dS()))}$Oa(){this.cz=!1;this.mr&&(this.oJ=
0);this.Cb.Nj(this.Maa());if(!this.$.Us([this.Gb],!1))return this.dJ(this.Ti,this.Wg),this.Nm=-1,!0;if(this.ha.qa.ld.equals(this.Gb)||this.Ozb(this.Gb)||this.Ozb(this.sourceRange))this.Nm=-1;else{this.DW();this.ha.sourceRange=this.sourceRange.clone();const ua=this.ha.sourceRange,xa=this.ha.qa.ld;this.mr?this.$.Zc(-694765314,2,30,{[u.a.TIa]:this.JZ,[u.a.eaa]:ua,[u.a.daa]:xa,[u.a.Qtb]:this.KZ}):this.$.Zc(-694765314,2,30,{[u.a.TIa]:this.JZ,[u.a.eaa]:ua,[u.a.daa]:xa})}!this.mr&&this.tableRange||this.dJ(this.Ti,
this.Wg);this.vwd();return!0}ZDd(ua){const xa=this.ha.Wp(ua.clientPoint,ua.Mb,5,void 0,void 0,!0);this.RV=ua;return this.Naf(xa)?(this.Gb=this.bHa(xa),this.f$e(!0),!0):this.Gai(xa)?(this.Gb=this.Dqb(xa),this.g$e(!0),!0):!1}kI(ua=!1){const xa=this.Gb.toString();if(this.mr)for(var tb=1;4>=tb;tb++)if(this.B1d){const Qb=this.dm[tb.toString()];Qb&&Qb.childNodes&&0<Qb.childNodes.length&&(Qb.childNodes[0].innerText=xa,Qb.childNodes[1].innerText=this.Sta,ua&&(Qb.childNodes[2].innerText=this.NAa))}else this.dm[tb.toString()].childNodes[0].innerText=
xa,this.dm[tb.toString()].childNodes[1].innerText=this.Sta,ua&&(this.dm[tb.toString()].childNodes[2].innerText=this.NAa);else for(ua=1;4>=ua;ua++)if(this.B1d){if(tb=this.dm[ua.toString()])tb.innerText=xa}else this.dm[ua.toString()].innerText=xa}Naf(ua){return!!this.Zda&&1!==this.oJ&&!!ua&&this.Zda.contains(ua.topLeft)}Gai(ua){return!!this.Zda&&1===this.oJ&&!!ua&&!this.Zda.contains(ua.topLeft)}f$e(ua){this.tableRange=this.Zda;this.oJ=1;const xa=!this.KZ;ua?(this.IT(!1),this.fr=this.MQ?[11]:[12],this.bJb(xa),
this.Goa(xa)):(this.arb(!1),this.Mma(xa),this.dS(xa))}g$e(ua){this.tableRange=null;this.oJ=2;const xa=!this.KZ;ua?(this.IT(!1),this.fr=this.MQ?[11]:[12],this.NQ=this.MQ,this.CKd(xa),this.Goa(xa)):(this.brb(!1),this.Mma(xa),this.dS(xa))}jeb(){if(!ia.h(this.$).ha.qa.Tg)return!1;const ua=ia.h(this.$).getRangeInformation(this.ha.qa.ld);for(const xa of ua)if(Object(ba.a)(Ca.PivotTableRange,xa))return!1;return!0}r0g(ua){if(ua&&ua.contains(this.sourceRange)&&!ua.equals(this.sourceRange)){if(ua.$ja&&this.sourceRange.bottom===
this.sourceRange.top&&this.sourceRange.top===ua.top){const xa=new mb.Range(this.sourceRange.top,this.sourceRange.left,ua.bottom,this.sourceRange.right,!1,!1);if(!xa.equals(ua))return this.sourceRange=xa,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),ua}this.mr?this.MQ=ua.left===this.sourceRange.left&&ua.right===this.sourceRange.right:this.isRow=ua.left===this.sourceRange.left&&ua.right===this.sourceRange.right;if(ua.top===this.sourceRange.top&&ua.bottom===this.sourceRange.bottom||
this.Fba())return ua}return null}bHa(ua){const xa=ua.clone();this.Fba()?xa.left=Math.max(ua.left-this.gmd,1):xa.top=Math.max(ua.top-this.R1d,1);xa.right=xa.left+this.sourceRange.width-1;xa.bottom=xa.top+this.sourceRange.height-1;return this.Cob(xa)}vkf(){const ua=this.Gb.topLeft.zd(this.sourceRange);return ua||this.mr&&!this.tableRange?ua:this.Fba()?this.Gb.top===this.sourceRange.bottom+1:this.Gb.left===this.sourceRange.right+1}ddj(){if(this.Fba()&&this.Gb.left!==this.tableRange.left||!this.Fba()&&
this.Gb.top!==this.tableRange.top){const ua=db.a.ed(1,1,0,916,0,2065438552,"RearrangeInvalidDest");yb.a(this.$).Jt([ua]);return!0}return!1}t9i(){const ua=this.$.Jb.Gc("UserAction","RearrangeRowColumnClientSide"),xa={["CopyPasteTargetType"]:1,["OperationId"]:sa.a.create().toString(),["Stopwatch"]:ua,["DragDropIsShiftKeyDown"]:this.KZ,["EncounteredDeploymentErrors"]:!1},tb=this.JZ?2:1,Qb=this.$.da.Aa(254);(new Promise((pc,hb)=>{this.dWe(ib=>{ib.Errors&&0<ib.Errors.length?hb(new W.a(22,ib.Errors)):pc(!0)},
ib=>{ib=na.a.Pe(ib.data);hb(new W.a(22,ib))})})).then(()=>{r.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Qb&&Qb.rDi(xa,tb,this.sourceRange,this.Gb);return Promise.resolve(!0)},pc=>{r.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${pc?copyPasteInfra.getStringifiedError(pc):"null"}, copyPasteTargetType="${1}"`);return Qb?Qb.UXi(pc,xa,tb,this.sourceRange,this.Gb):
Promise.reject(pc)})}dWe(ua=null,xa=null){const tb={};this.Fba()?(tb.FirstRow=this.Gb.top-1,tb.FirstColumn=0,tb.DeltaColumn=0,tb.DeltaRow=this.Gb.bottom-this.Gb.top+1):(tb.FirstRow=0,tb.FirstColumn=this.Gb.left-1,tb.DeltaColumn=this.Gb.right-this.Gb.left+1,tb.DeltaRow=0);tb.LastRow=Y.a.cB;tb.LastColumn=Y.a.$x;tb.SheetName=this.$.va.na?this.$.va.na.name:this.$.yb.getItemByName(this.$.yb.na.name).sheetName;const Qb=Q.v(this.sourceRange,this.$);this.$.userOperationManager.Jc(new va.a(514,0,(pc,hb,ib)=>
oa(this.$.oa.xa,Qb,tb,ua?Ba.b(pc,ua):pc,xa?Ba.a(hb,xa):hb,ib,null),64,()=>new Wb(Qb,tb)),null)}hDc(ua=0){0===ua?this.JZ=!1:1===ua&&(this.KZ=!1);this.mr&&(this.JZ||this.KZ)||(ea.KeyInputManager.instance.Ba(x.a.Kd,this.domElement.ownerDocument.body,this.onKeyUp),this.IMa=!1)}Mma(ua=!1){this.Nm=5;this.KN(this.Ti,this.Wg);this.Sta=this.RNe;this.NAa=this.D7f;this.a7(this.RV.clientPoint,this.RV.Mb,this.Hwb(),!1,ua)}CKd(ua=!1){this.Nm=6;this.KN(this.uGb,this.vGb);this.Sta=this.t8b;this.NAa=this.Vyc;this.a7(this.RV.clientPoint,
this.RV.Mb,this.isRow||this.MQ?11:12,!0,ua)}bJb(ua=!1){this.Nm=6;this.KN(this.hma,this.ima);this.Sta=this.t8b;this.NAa=this.Vyc;this.a7(this.RV.clientPoint,this.RV.Mb,this.Fba()?11:12,!0,ua)}Fba(){return!this.mr&&this.isRow||this.mr&&this.MQ}arb(ua){this.Cb.Nj(this.fr);this.dJ(this.uGb,this.vGb,void 0,ua)}vwd(){const ua=Ea.a.instance.Tb("Common.ISystemInitiatedFeedback");ua&&ua.execute(xa=>{xa.logActivity("DragDrop",null)})}}Object(t.a)(Yb,"DragSelectionClickBehaviorCellRangeAndTable",kb,[]);var pb=
a(320),Fa=a(140);class ab extends kb{constructor(ua,xa,tb,Qb,pc){super(ua,xa,tb,Qb,pc);this.K$a=()=>{this.cz&&this.brb(!0);5===this.Nm&&this.IT(!0)};this.ima=hb=>{aa.a(this.$).me(hb);this.cz=!1;this.Cb.Nj(this.fr);this.ha.sourceRange=this.sourceRange.clone();this.pmf?this.$.Zc(927125067,D.a.zb,30,null):this.Bwa?(this.DW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Zc(-694765314,2,30,{[u.a.TIa]:!0,[u.a.eaa]:this.ha.sourceRange,[u.a.daa]:this.ha.qa.ld,[u.a.Qtb]:!1}),r.ULS.sendTraceTag(509617280,
0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),ia.h(this.$).Gg.qp(u.a.LU),this.Bwa=!1):this.k9i();this.dJ(this.hma,this.ima);this.Nm=-1;return!0};this.hma=hb=>{hb=aa.a(this.$).me(hb);const ib=hb.clientPoint;this.RV=hb;let Vb=this.ha.Wp(ib,hb.Mb,5,void 0,void 0,!0);if(Vb){if(!this.jsd(Vb))return this.K8h(hb),!0;this.Sjg(Vb,this.isRow,ib);if(this.isRow||this.Rg)this.Gb=this.bHa(Vb);this.ha.sourceRange=this.Gb;this.Cb.wk(this.Gb,this.fr);this.Cb.Nq(this.fr);this.Cb.Nj(this.Maa());
this.kI()}return!0};this.onKeyDown=hb=>this.A6a(hb)?(this.IMa||(ea.KeyInputManager.instance.ta(x.a.Kd,this.domElement.ownerDocument.body,this.onKeyUp),this.IMa=!0),this.Bwa||(ia.h(this.$).Gg.qp(Ha.Q4c),this.Bwa=!0),!0):!1;this.onKeyUp=hb=>{this.A6a(hb)&&(ea.KeyInputManager.instance.Ba(x.a.Kd,this.domElement.ownerDocument.body,this.onKeyUp),this.IMa=!1,this.cz?ia.h(this.$).Gg.qp(Ha.Ttb):ia.h(this.$).Gg.qp(u.a.LU),this.Bwa=!1);return!0};this.BFf=hb=>{hb.Errors&&0<hb.Errors.length?(r.ULS.sendTraceTag(521410185,
0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${db.a.nc(hb.Errors)}]`),this.Gb.left=this.sourceRange.left,this.Gb.right=this.sourceRange.right,this.Gb.top=this.sourceRange.top,this.Gb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Gb.top&&this.sourceRange.bottom>=this.Gb.top-1?(this.Gb.top=this.sourceRange.top,this.Gb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Gb.top||(this.Gb.top-=this.sourceRange.height),this.Gb.bottom=this.Gb.top+
this.sourceRange.height-1):this.sourceRange.left<=this.Gb.left&&this.sourceRange.right>=this.Gb.left-1?(this.Gb.left=this.sourceRange.left,this.Gb.right=this.sourceRange.right):(this.sourceRange.left>this.Gb.left||(this.Gb.left-=this.sourceRange.width),this.Gb.right=this.Gb.left+this.sourceRange.width-1);this.DW();this.Nm=-1};this.AFf=hb=>{hb=na.a.Pe(hb.data);r.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${db.a.nc(hb)}]`)};this.ha.CXc(this.K$a);
this.Bwa=this.IMa=!1}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.Suc(this.K$a);super.dispose()}YDd(ua){this.RV=ua;this.isRow=this.Rg=!1;this.cz=!0;ea.KeyInputManager.instance.ta(x.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown);this.fc=this.tableManager.Gja(this.sourceRange);this.mhf=this.usi(this.Gb);this.fc||r.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",
this.sourceRange);this.pmf=(new Fa.a(this.$.va)).Nh;ia.h(this.$);ia.h(this.$).Gg.qp(Ha.Ttb);this.jsd(this.Gb)?(this.isRow=this.iti(),this.Rg=this.Rmi(),this.isRow||this.Rg?(this.n7a=!1,this.bJb(ua),this.Gb=this.bHa(this.Gb),this.Goa()):(this.n7a=!0,this.Mma(ua),this.dS())):(this.n7a=!0,this.Mma(ua),this.dS())}$Oa(){return this.pmf?(this.$.Zc(927125067,D.a.zb,30,null),this.IT(!0),this.n7a=!1,this.Nm=-1,!0):this.Bwa||P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",!1)&&
this.mhf?(this.DW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Zc(-694765314,2,30,{[u.a.TIa]:this.Bwa,[u.a.eaa]:this.ha.sourceRange,[u.a.daa]:this.ha.qa.ld,[u.a.Qtb]:!1}),r.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.Bwa}"`),ia.h(this.$).Gg.qp(u.a.LU),this.IT(!0),this.cz=this.n7a=!1,this.Nm=-1,this.mhf=!1,!0):5===this.Nm?(this.IT(!0),this.n7a=!1,this.YHj(),this.Nm=-1,!0):!1}ZDd(ua){const xa=this.ha.Wp(ua.clientPoint,
ua.Mb,5,void 0,void 0,!0);this.RV=ua;return this.n7a?!1:this.jsd(xa)?(this.L8h(ua),!0):!1}kI(){let ua=new mb.Range(this.Gb.top,this.Gb.left,this.Gb.bottom,this.Gb.right,!1,!0);6===this.Nm&&(this.isRow?(--ua.top,ua.bottom=ua.top+this.Gb.height-1):(--ua.left,ua.right=ua.left+this.Gb.width-1));for(let xa=1;4>=xa;xa++)if(this.B1d){const tb=this.dm[xa.toString()];tb&&tb.childNodes&&0<tb.childNodes.length&&(tb.childNodes[0].innerText=ua.toString())}else this.dm[xa.toString()].childNodes[0].innerText=ua.toString()}jeb(){if(!ia.h(this.$).ha.qa.Tg)return!1;
var ua=ia.h(this.$).getRangeInformation(this.ha.qa.ld);for(var xa of ua)if(Object(ba.a)(Ca.PivotTableRange,xa)&&(ua=this.tableManager.Gja(xa)))return xa=!ua.isOlap||!ua.nNa(!0),r.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",ua),ua.isActionable&&xa;return!1}bHa(ua){ua=ua.clone();this.isRow?(ua.left=this.sourceRange.left,ua.right=this.fc.right,ua.bottom=ua.top+this.sourceRange.height-1):this.Rg?(ua.top=this.sourceRange.top,
ua.bottom=this.fc.NK.bottom,ua.right=ua.left+this.sourceRange.width-1):r.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Cob(ua)}k9i(){const ua={},xa=Q.v(this.sourceRange,this.$);ia.h(this.$).getRangeInformation(this.Gb);if(this.isRow){xa.FirstColumn=ua.FirstColumn=this.Gb.left-1;xa.LastColumn=ua.LastColumn=this.Gb.right-1;if(this.sourceRange.top<=this.Gb.top&&this.sourceRange.bottom>=this.Gb.top-1){r.ULS.sendTraceTag(520176345,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Gb.top?ua.LastRow=ua.FirstRow=this.Gb.top-1:(ua.FirstRow=this.Gb.top-this.sourceRange.height-1,ua.LastRow=ua.FirstRow+this.sourceRange.height-1)}else{ua.FirstRow=this.Gb.top;ua.LastRow=this.Gb.bottom-1;if(this.sourceRange.left<=this.Gb.left&&this.sourceRange.right>=this.Gb.left-1){r.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}ua.LastColumn=
this.sourceRange.left>this.Gb.left?ua.FirstColumn=this.Gb.left-1:ua.FirstColumn=this.Gb.left-this.sourceRange.width-1}const tb={};tb.SheetName=this.$.va.na?this.$.va.na.name:this.$.yb.getItemByName(this.$.yb.na.name).sheetName;tb.Ranges=Array(2);tb.Ranges[0]=xa;tb.Ranges[1]=ua;this.MDh(tb)}MDh(ua){this.$.userOperationManager.Jc(new va.a(265,0,(xa,tb,Qb)=>Ja(this.$.oa.xa,ua,this.BFf?Ba.b(xa,this.BFf):xa,this.AFf?Ba.a(tb,this.AFf):tb,Qb,null),64),null)}jsd(ua){return null!==this.fc&&(null===this.fc.NK||
ua.left>=this.fc.NK.left)&&(null===this.fc.gJ||ua.right<=this.fc.gJ.right)&&(null===this.fc.top||ua.top>=this.fc.top)&&(null===this.fc.NK||ua.bottom<=this.fc.NK.bottom)}usi(ua){return null!==this.fc&&this.fc.left>=ua.left&&this.fc.right<=ua.right&&this.fc.top>=ua.top&&this.fc.bottom<=ua.bottom}iti(){return null!==this.fc&&null!==this.fc.NK&&this.fc.NK.top<=this.Gb.top&&this.fc.NK.left<=this.Gb.left&&this.fc.NK.right>=this.Gb.left}Rmi(){return null!==this.fc&&null!==this.fc.gJ&&this.fc.gJ.top===this.Gb.top&&
this.fc.gJ.left<=this.Gb.left&&this.fc.gJ.right>=this.Gb.right}bJb(ua){this.Nm=6;this.fr=this.isRow?[11]:[12];this.KN(this.hma,this.ima);this.a7(ua.clientPoint,ua.Mb,this.isRow?11:12,!0,!1)}Mma(ua){this.Nm=5;this.KN(this.Ti,this.Wg);this.a7(ua.clientPoint,ua.Mb,this.Hwb(),!1,!1)}L8h(ua){this.IT(!1);this.bJb(ua);this.Gb=this.bHa(this.Gb);this.Goa()}K8h(ua){this.brb(!1);this.Mma(ua);this.dS()}YHj(){if(!this.Ozb(this.Gb)){var ua=db.a.ed(1,0,902,901,0,2069074184,"PivotTableInvalidMove");ua.HelpTopicId=
pb.a.LLj;ua.HelpDescription=nc.a.instance.ga(911);yb.a(this.$).Jt([ua])}}}Object(t.a)(ab,"DragSelectionClickBehaviorPivotTableRange",kb,[]);var Gb=a(375);class Ga extends O{constructor(ua,xa){super(ua);this.Xg=()=>{this.domElement.classList.remove(ca.selecting);Gb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.qr=()=>{this.domElement.classList.add(ca.selecting)};this.onPointerDown=tb=>{2===tb.ub&&tb.Rn===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=
this.gridView.ha.qa.ld,Gb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.vca=()=>{this.gridView.$.Zc(1983983164,2,30,null);return!0};this.dd=()=>{w.DOMElementExtensions.setVisible(this.waa,this.gridView.$.isEditMode)};this.h6=()=>{w.DOMElementExtensions.setVisible(this.waa,!1)};this.g6=()=>{w.DOMElementExtensions.setVisible(this.waa,!0)};this.MDf=()=>{w.DOMElementExtensions.setVisible(this.waa,!1)};this.LDf=()=>{w.DOMElementExtensions.setVisible(this.waa,!0)};this.NFb=
(tb,Qb)=>{w.DOMElementExtensions.setVisible(this.waa,!Qb.Dne)};this.gridView=xa;xa=document.createElement("div");xa.className=U.a.nCh;this.waa=xa;this.dd(null,null);ua.appendChild(xa);A.a.instance.ta(x.a.pointerDown,this.waa,this.onPointerDown);L.a.instance.ta(x.a.tk,this.waa,this.vca);this.gridView.ha.v9(this.qr);this.gridView.ha.j2(this.Xg);this.gridView.$.Lk(this.dd);this.gridView.$.qb.X_b(this.h6);this.gridView.$.qb.W_b(this.g6);this.gridView.kqe(this.NFb);this.gridView.mc.xl(this.MDf);this.gridView.mc.Jm(this.LDf)}dispose(){A.a.instance.Ba(x.a.pointerDown,
this.waa,this.onPointerDown);L.a.instance.Ba(x.a.tk,this.waa,this.vca);this.gridView.$&&(this.gridView.ha.uda(this.qr),this.gridView.ha.S_(this.Xg),this.gridView.$.pl(this.dd),this.gridView.$.qb.Wuc(this.h6),this.gridView.$.qb.Vuc(this.g6),this.gridView.SVf(this.NFb),this.gridView.mc.nl(this.MDf),this.gridView.mc.$l(this.LDf));super.dispose()}}Object(t.a)(Ga,"FillHandleClickBehavior",O,[]);class Ma extends R{constructor(ua,xa){super(ua);this.kZi=tb=>{const Qb=E.HelperMethods.ko(tb);var pc=this.Jva.W1d(tb.clientPoint);
if(!pc)return!1;var hb=pc.fe,ib=this.Jva.Ca.Twb(hb.hashCode).$ua(pc.wI);if(!ib)return!1;tb=hb.aj.domElement;pc=E.HelperMethods.lpe(E.HelperMethods.pxb(hb.domElement,tb),pc.wI);hb=0;ib=this.Jva.Qb(ib.getRange());for(let wc=0,Lc=Ma.bBe.length;wc<Lc;++wc){const Fc=Ma.bBe[wc];if((128===Fc||64===Fc)&&this.Jva.$.isEditMode)continue;var Vb=ib.EKa(Fc);if(!Vb||!Vb.h6a||"none"===Vb.h6a.style.display)continue;Vb=Vb.h6a;const fd=E.HelperMethods.pxb(Vb,tb);Vb=new Sys.UI.Bounds(fd.x,fd.y,Vb.offsetWidth,Vb.offsetHeight);
if(I.a.UM(Vb,pc)){hb=Fc;break}}return 0!==hb?(ib.invoke(hb,Qb),!0):!1};this.pxg=xa;L.a.instance.ta(x.a.click,ua,this.kZi)}get Jva(){return this.pxg}}Ma.bBe=[1,2,32,256,128,64];Object(t.a)(Ma,"IPadSelectionClickThroughBehavior",R,[]);var Qa=a(22);class wb{constructor(ua){this.Ycf=xa=>{this.KDc(xa.Mb,1);return!0};this.Zcf=xa=>{this.KDc(xa.Mb,-1);return!0};this.Xg=()=>{this.Xqd=!1};this.qr=()=>{this.Xqd=!0};this.gridView=ua;this.E5a=0;this.Xqd=this.dic=!1;this.k5=Number.NaN;this.gridView.ha.v9(this.qr);
this.gridView.ha.j2(this.Xg);this.gridView.ha.CXc(this.Xg)}dispose(){this.gridView.ha.uda(this.qr);this.gridView.ha.S_(this.Xg);this.gridView.ha.Suc(this.Xg)}cAa(){this.E5a=0;this.dic=!1;this.k5=Number.NaN}PNe(ua){this.dic=!0;this.KDc(ua,1)}QNe(ua){this.dic=!1;this.KDc(ua,-1)}KDc(ua,xa){if(ua)if(ua.parentNode)if(this.Xqd)isNaN(this.k5)||(this.YDc(this.k5,!1),this.k5=Number.NaN);else if(ua=parseInt(ua.parentNode.getAttribute(u.a.W5a),10),isNaN(ua))r.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");
else{if(!isNaN(this.k5)&&ua!==this.k5){if(this.dic)return;this.YDc(this.k5,!1)}if(isNaN(this.k5)||ua!==this.k5)this.k5=ua,this.E5a=0;!this.E5a&&0<xa&&this.YDc(ua,!0);this.E5a=Math.max(this.E5a+xa,0);!this.E5a&&0>xa&&(this.YDc(ua,!1),this.k5=Number.NaN)}else r.ULS.shipAssertTag(537159367,0,!!ua.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else r.ULS.shipAssertTag(537159368,0,!!ua,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}YDc(ua,xa){for(let Qb=
1;4>=Qb;Qb++){var tb=this.gridView.Cb.KC(3,Qb,ua).hg;w.DOMElementExtensions.toggleCssClass(tb,ca.IBh,xa);for(tb=tb.firstChild;tb;tb=tb.nextSibling)Qa.a.contains(tb.className,"resizemarqueehandle",!0)&&w.DOMElementExtensions.toggleCssClass(tb,ca.MBh,xa)}}}Object(t.a)(wb,"MarqueeHoveringManager",null,[]);var Na=a(180),ya=a(84),nb=a(839),vb=a(1260);class gb extends R{constructor(ua,xa){super(ua);this.Vpc=()=>{if(!this.mw)return r.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.mw.obj(this.bba);this.mw.bsh(this.cba);if(3===this.mw.model.state)return!0;this.mw.Vcf(!0);return!0};this.Cca=()=>{if(!this.mw)return!1;this.mw.raj();this.mw.SNd(this.cba,!1);if(3===this.mw.model.state)return!0;this.mw.Vcf(!1);return!0};this.onPointerDown=tb=>this.mw?2===tb.ub&&tb.Rn===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.kGb=()=>{if(!this.mw)return!1;this.mw.SNd(this.cba,!0);this.mw.S1a();return!0};this.onDoubleClick=tb=>{if(tb.Ea)return tb.Ea.stopPropagation(),!0;r.ULS.sendTraceTag(537159363,
0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.mw=Object(ya.a)(vb.a,xa.metadata);this.cba=document.createElement("div");this.cba.id=`${ua.id}-${u.a.SAe}`;this.cba.className=nb.a.Y1g;this.bba=document.createElement("div");this.bba.id=`${ua.id}-${u.a.q1c}`;this.bba.className=nb.a.q1c;this.rQ=document.createElement("div");this.rQ.appendChild(this.bba);this.rQ.className=nb.a.X1g;this.cba.appendChild(this.rQ);ua.appendChild(this.cba);r.ULS.sendTraceTag(537159365,
0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");A.a.instance.ta(x.a.SV,this.rQ,this.Vpc);A.a.instance.ta(x.a.oB,this.rQ,this.Cca);A.a.instance.ta(x.a.pointerDown,this.rQ,this.onPointerDown);Na.a.instance.ta(x.a.click,this.rQ,this.kGb);Na.a.instance.ta(x.a.tk,this.rQ,this.onDoubleClick);w.DOMElementExtensions.setVisible(this.rQ,xa.isVisible)}dispose(){A.a.instance.Ba(x.a.SV,this.rQ,this.Vpc);A.a.instance.Ba(x.a.oB,this.rQ,
this.Cca);A.a.instance.Ba(x.a.pointerDown,this.rQ,this.onPointerDown);Na.a.instance.Ba(x.a.click,this.rQ,this.kGb);Na.a.instance.Ba(x.a.tk,this.rQ,this.onDoubleClick);w.DOMElementExtensions.vf(this.bba);this.bba=null;w.DOMElementExtensions.vf(this.cba);this.mw=this.cba=null;super.dispose()}jZa(ua){this.mw=Object(ya.a)(vb.a,ua.metadata);ua.isVisible!==ua.xxa&&(this.mw.UBj(ua.isVisible?1:0),w.DOMElementExtensions.setVisible(this.cba,ua.isVisible))}}Object(t.a)(gb,"RangeCatchUpActivityHighlightBehavior",
R,[]);class cb extends Z{constructor(ua,xa,tb,Qb){super(ua,xa,tb,Qb)}get o4(){return 16}get fdb(){return this.gridView.ha.rangePicker.Led(!1)}sSa(){return(this.gridView.inRangePicker||this.gridView.Uh)&&super.sSa()}}Object(t.a)(cb,"RangePickerTouchGrippiesBehavior",Z,[]);class La extends R{constructor(ua,xa){super(ua);const tb=document.createElement("div"),Qb=document.createElement("div");tb.className=xa?ca.vCh:ca.xCh;Qb.className=xa?ca.wCh:ca.uCh;ua.appendChild(tb);ua.appendChild(Qb)}}Object(t.a)(La,
"RearrangeHighlightBehavior",R,[]);var ja;(function(ua){ua[ua.topLeft=0]="topLeft";ua[ua.topRight=1]="topRight";ua[ua.bottomLeft=2]="bottomLeft";ua[ua.bottomRight=3]="bottomRight";ua[ua.error=4]="error"})(ja||(ja={}));Object(t.b)("Corner",ja);class Ua extends R{constructor(ua,xa,tb,Qb,pc){super(ua);this.eb=this.CF=null;this.b3=0;this.Gb=this.sourceRange=null;this.bTa=!1;this.onPointerDown=hb=>{hb=aa.a(this.$).me(hb);if(this.c8f(hb)&&!this.bTa){this.ssf();this.eb=this.No.ebc();this.CF=this.No.c7e(hb);
if(!this.eb||!this.CF||!this.CF.range)return r.ULS.shipAssertTag(537159361,0,!!this.eb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),r.ULS.shipAssertTag(537159360,0,!!this.CF,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),r.ULS.shipAssertTag(537159331,0,!!this.CF.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Gb=this.CF.range.clone();this.sourceRange=this.Gb.clone();this.b3=this.S2e(hb);if(4===this.b3)return r.ULS.shipAssertTag(537159330,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const ib=this.K4e(hb,!0);if(!ib)return r.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.kIe(ib))return r.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.OLa=!0;this.eb.nE(!1);this.iF.PNe(hb.Mb);this.No.DQf(!0,this.dba.KT);this.eb.textBox.removeSelection();
this.eb.C_b(this.H$e);this.aUf();this.bTa=!0;wa.b(this.$,!0)}return!0};this.Ti=hb=>{hb=aa.a(this.$).me(hb);hb=this.K4e(hb,!1);if(!hb)return!0;hb=this.kIe(hb);if(!hb)return r.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.Y$b(!0),!1;if(this.Gb.equals(hb))return!0;this.Gb=hb;hb=this.dS();hb||(r.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Y$b(!0));return hb};this.Wg=hb=>{aa.a(this.$).me(hb);
hb=this.DW();r.ULS.shipAssertTag(537159325,0,hb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Y$b(!hb);return hb};this.H$e=()=>{this.Y$b(!0)};this.gridView=xa;this.$=xa.$;this.KK=[];this.ha=this.gridView.ha;this.iF=tb;this.No=Qb;this.dba=pc;this.coloredReferencesManager=this.$.da.Aa(281);r.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
if(this.RM=y.a.qH(this.$))xa=this.$.da.Aa(464),r.ULS.shipAssertTag(510255176,0,!!xa,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.IA=xa.IA;for(const hb of this.rZf())xa=this.No.wHe(ua,hb,this.Zre(),this.onPointerDown),this.KK.push(xa);for(const hb of this.KK)A.a.instance.ta(x.a.SV,hb,this.iF.Ycf),A.a.instance.ta(x.a.oB,hb,this.iF.Zcf);this.jZa(pc)}dispose(){this.KK.forEach(ua=>{A.a.instance.Ba(x.a.pointerDown,ua,
this.onPointerDown)});this.KK.length=0;super.dispose()}jZa(ua){this.dba=ua;this.hse(ua);this.No.nMb(ua,this.KK,this.bUd());this.iF.cAa()}K4e(ua,xa){const tb=ua.Mb;ua=ua.clientPoint;if(!tb||!ua)return r.ULS.shipAssertTag(537159324,0,!!tb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),r.ULS.shipAssertTag(537159323,0,!!ua,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;xa&&(ua=this.pwf(ua));xa=this.ha.Wp(ua,tb,0,!0,!1,!0);xa||(ua=this.pwf(ua),xa=this.ha.Wp(ua,
tb,0,!0,!1,!0));return xa}pwf(ua){ua.y+=0===this.b3||1===this.b3?2:-2;ua.x+=0===this.b3||2===this.b3?2:-2;return ua}kIe(ua){if(!ua||!this.sourceRange)return r.ULS.shipAssertTag(537159322,0,!!ua,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),r.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.b3)return new mb.Range(ua.top,ua.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.b3)return new mb.Range(ua.top,
this.sourceRange.left,this.sourceRange.bottom,ua.right,!0,!1);if(2===this.b3)return new mb.Range(this.sourceRange.top,ua.left,ua.bottom,this.sourceRange.right,!0,!1);if(3===this.b3)return new mb.Range(this.sourceRange.top,this.sourceRange.left,ua.bottom,ua.right,!0,!1);r.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${ja[this.b3]}`);return null}DW(){return this.RM?this.IA.CEb(this.eb,this.CF,this.Gb):this.coloredReferencesManager.CEb(this.eb,
this.CF,this.Gb)}dS(){return this.DW()}Y$b(ua){ua&&r.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.iF.QNe(this.KK[0]);this.No.DQf(!1,this.dba.KT);this.eb.textBox.setCaretPositionToEnd();this.eb.Fuc(this.H$e);this.hig();this.bTa=this.gridView.OLa=!1;wa.b(this.$,!1);this.No.wSf()}}Object(t.a)(Ua,"ResizeMarqueeBehaviorBase",R,[]);class lb extends Ua{constructor(ua,xa,tb,Qb,pc){super(ua,
xa,tb,Qb,pc)}rZf(){return[ca.BCh,ca.CCh,ca.zCh,ca.ACh]}Zre(){return[ca.yCh]}S2e(ua){ua=ua.Mb;if(ua===this.KK[0])return 0;if(ua===this.KK[1])return 1;if(ua===this.KK[2])return 2;if(ua===this.KK[3])return 3;r.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}aUf(){this.No.KN(this.Ti,this.Wg,!0)}hig(){this.No.D_d(this.Ti,this.Wg,!0)}c8f(ua){return 2===(D.a.zb=ua.ub)&&ua.Rn===Sys.UI.MouseButton.leftButton}bUd(){return!0}ssf(){r.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}hse(ua){for(const xa of this.KK)xa.style.backgroundColor=ua.hg.style.borderColor}}Object(t.a)(lb,"ResizeMarqueeMouseBehavior",Ua,[]);class sb extends Ua{constructor(ua,xa,tb,Qb,pc){super(ua,xa,tb,Qb,pc);this.eGb=()=>{const hb=3===D.a.zb;this.Qud&&!hb?this.No.nMb(this.dba,this.KK,!1):!this.Qud&&hb&&this.No.nMb(this.dba,this.KK,!0);this.Qud=hb};this.pYi=(hb,ib)=>{ib.W5a===this.dba.KT&&this.No.nMb(this.dba,
this.KK,!ib.start&&this.bUd())};D.a.Tqe(this.eGb);this.Qud=3===D.a.zb;this.No.uNg(this.pYi)}dispose(){D.a.uWf(this.eGb);super.dispose()}rZf(){return[U.a.BBh,U.a.ABh]}Zre(){const ua=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[ua?U.a.lVe:U.a.kVe,U.a.U9b,ua?U.a.zBh:U.a.T9b]}S2e(ua){ua=ua.Mb;if(ua===this.KK[0])return 0;if(ua===this.KK[1])return 3;r.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}aUf(){l.a.qw?
this.No.KN(this.Ti,this.Wg,!1):this.No.tfj(this.Ti,this.Wg)}hig(){l.a.qw?this.No.D_d(this.Ti,this.Wg,!1):this.No.ZXj(this.Ti,this.Wg)}c8f(ua){return 3===(D.a.zb=ua.ub)}bUd(){return 3===D.a.zb}ssf(){r.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}hse(){}}Object(t.a)(sb,"ResizeMarqueeTouchBehavior",Ua,[]);class V extends R{constructor(ua,xa){super(ua);V.nsb(ua,S.a.RBh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.horizontal);
V.nsb(ua,S.a.QBh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.vertical);V.nsb(ua,S.a.NBh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.horizontal);V.nsb(ua,S.a.PBh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.vertical);V.nsb(ua,U.a.OBh)}static nsb(ua,xa,tb){const Qb=document.createElement("div");Qb.className=xa;tb&&(Qb.style.backgroundImage=`url("${tb}")`);ua.appendChild(Qb)}}Object(t.a)(V,"SelectionCutCopyBehavior",R,[]);class za extends R{constructor(ua){super(ua);appChrome.renderSpinner(ua)}}Object(t.a)(za,
"SelectionPasteBehavior",R,[]);class Ra extends R{constructor(ua,xa){super(ua);Ra.Dsb(ua,S.a.tCh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.horizontal);Ra.Dsb(ua,S.a.sCh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.vertical);Ra.Dsb(ua,S.a.pCh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.horizontal);Ra.Dsb(ua,S.a.rCh+" "+U.a.oua,null===xa||void 0===xa?void 0:xa.vertical);Ra.Dsb(ua,U.a.qCh)}static Dsb(ua,xa,tb){const Qb=document.createElement("div");Qb.className=xa;tb&&(Qb.style.backgroundImage=`url("${tb}")`);
ua.appendChild(Qb)}}Object(t.a)(Ra,"SelectionRangePickerBehavior",R,[]);class Xa extends Z{constructor(ua,xa,tb,Qb){super(ua,xa,tb,Qb)}get o4(){return 0}get fdb(){return this.gridView.ha.qa.ld}sSa(){const ua=this.gridView.Uh||this.gridView.fb;return this.gridView.ha.qa.Tg&&!ua&&super.sSa()}}Object(t.a)(Xa,"SelectionTouchGrippiesBehavior",Z,[]);var $a=a(51);class ma extends v.a{constructor(ua,xa){super();this.ypb=(tb,Qb)=>{tb=Qb.o4;const pc=this.gridView;Qb=Qb.Oci;const hb=Qb.hg,ib=Qb.Y9;l.a.Hg&&ib.push(new Ma(hb,
pc));switch(tb){case 24:Qb.Y9.push(new gb(hb,Qb));break;case 0:Qb.Y9.push(new Ga(hb,pc));l.a.cp||(ib.push(new Yb(hb,this.gridView.$,Qb.paneType,this.tableManager,this.No)),P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&ib.push(new ab(hb,this.gridView.$,Qb.paneType,this.tableManager,this.No)));ib.push(new Xa(Qb,hb,pc,Qb.paneType));break;case 3:ib.push(new O(hb));l.a.cp||(ib.push(new Sa(hb,this.gridView.$,Qb.paneType,this.iF,this.No,Qb)),ib.push(new lb(hb,
this.gridView,this.iF,this.No,Qb)),ib.push(new sb(hb,this.gridView,this.iF,this.No,Qb)));break;case 4:case 5:ib.push(new V(hb,this.ute));break;case 30:ib.push(new za(hb));break;case 16:ib.push(new Ra(hb,this.ute));ib.push(new cb(Qb,hb,pc,Qb.paneType));break;case 11:case 12:ib.push(new La(hb,11===tb));break;case 17:ib.push(new O(hb));break;case 19:ib.push(new O(hb)),ib.push(new da(Qb,hb,pc,Qb.paneType))}Qb.H1b=!0};this.$=ua;this.gridView=ia.h(ua);this.tableManager=xa;this.iF=new wb(this.gridView);
this.No=new B(this.gridView);this.gridView.Cb&&(this.gridView.Cb.QMg(this.ypb),this.gridView.Cb.update(!1));ua.da.Ha(64,this)}get ute(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.tte&&(this.tte={vertical:$a.a.current.lo(104),horizontal:$a.a.current.lo(105)});return this.tte}dispose(){this.gridView.Cb.Cjj(this.ypb);this.iF&&(this.iF.dispose(),this.iF=null);super.dispose()}}Object(t.a)(ma,"GridHighlightsBehaviorManager",v.a,[]);class fa extends b.a{constructor(ua){super();
this.$=ua;this.Db()}create(){m.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Xa),ua=>{this.nb(this.$.da.Aa(64)||new ma(this.$,ua.result))},this.la,3)}static ka(ua){ua.da.Ha(149,new fa(ua))}}Object(t.a)(fa,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(F,"a",function(){return eb});const eb=()=>{c.a.Fa(fa.ka);c.a.Fa(d.ka)}},1173:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=a(50),f=a(37),d=a(188),h=a(55);class m{constructor(xa){this.Aph=xa}Hc(){return!1}executeCommand(xa,
tb){xa=tb.command;tb=null;switch(xa){case 1243860697:this.Aph.dTj();break;default:tb=d.a(xa)}return tb||h.Task.Ra(!0)}wc(xa,tb){return 1243860697===tb.command}Mc(){return!1}}Object(t.a)(m,"SheetDropdownMenuCommandHandler",null,[221]);class l extends b.a{constructor(xa){super(xa)}hd(){this.$.Sx(xa=>{xa.Pfc().then(()=>{f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,32,33,this.Xa),tb=>{this.$c([new m(tb.result.BDj)])},this.$.la)})})}static ka(xa){b.a.Ld(392,new l(xa))}}Object(t.a)(l,"SheetDropdownMenuCommandHandlerFactory",
b.a,[]);var v=a(226),r=a(5),A=a(77),x=a(33),n=a(1),u=a(15),z=a(27),w=a(180),C=a(14),y=a(89),B=a(46),H=a(241),I=a(159),R=a(110),S=a(40),G=a(420),D=a(84),E=a(13),M=a(35);class L{constructor(){this.qMe=new M.a(!0);this.OJc=0}get x8c(){return this.OJc}get navigationButtonsDisabled(){return!!(this.x8c&1)}get operationButtonsDisabled(){return!!(this.x8c&2)}iSg(xa,tb){this.qMe.add(xa,tb);this.fS()}fS(){this.OJc=0;M.a.forEach(this.qMe.tu,xa=>{this.OJc=this.x8c|xa.value})}}Object(t.a)(L,"SheetTabBarDisabledStateManager",
null,[]);var N=a(239),Y=a(31);class U{}U.Myh="ewa-stb-uir";U.QSe="ewa-stb-drag";U.wyh="ewa-stb-navarea";U.xyh="ewa-stb-navarea-dimensions";U.zyh="ewa-stb-navbutton";U.VT="cui-disabled";U.yyh="ewa-stb-navareaextra";U.$ha="cui-img-container";U.qyh="ewa-stb-contentarea";U.RSe="ewa-stb-left-scrollable";U.bTe="ewa-stb-right-scrollable";U.Kyh="ewa-stb-tabarea";U.Jyh="ewa-stb-sheettabmoveindicator";U.dTe="ewa-stb-tabs";U.QPj="tab-active";U.YPj="tab-inactive";U.XPj="tab-hover";U.Lyh="ewa-stb-tabs-ghost";
U.SPj="tab-anchor-text";U.dark="dark";U.light="light";U.RPj="tab-active-text";U.VPj="tab-content-container";U.$Pj="tab-text";U.Cyh="ewa-stb-nsv-inactive";U.Dyh="ewa-stb-nsv-inactive-svg";U.Ayh="ewa-stb-nsv-active";U.Byh="ewa-stb-nsv-active-svg";U.kxh="ewa_nsv_margin";U.ryh="ewa-stb-disable-scrollbar";U.dzi="leave-size-fixed-on-tab-hover-old";U.czi="leave-size-fixed-on-tab-hover";U.VSe="ewa-stb-locked-sheet";U.WSe="ewa-stb-locked-sheet-svg-16px";U.syh="ewa-stb-dropdown-menu-button";U.Rth="ewa-active-sheet-menu-item";
Object(t.a)(U,"CssClassNames",null,[]);var P=a(746),aa=a(19),X=a(264),Z=a(103),da=a(192),qa=a(251),O=a(44),ca=a(287),wa=a(51),ia=a(12),Ha=a(74),Sa=a(319),Da=a(11),ea=a(101),sa=a(349),Ea=a(21),ba=a(182),ka=a(375),Ca=a(371),db=a(45),yb=a(227),kb=a(86);class mb extends N.a{constructor(xa,tb,Qb=!1){super(xa);this.Mab=this.wsa=null;this.$=tb;this.rX=Qb}get disabled(){return this.rX}dispose(){this.Mab=this.wsa=this.$=null;super.dispose()}$R(xa){this.rX=xa;this.domElement.setAttribute(r.a.gsa,xa.toString());
ia.DOMElementExtensions.toggleCssClass(this.domElement,P.a.VT,xa)}}Object(t.a)(mb,"SheetBarButton",N.a,[]);var W=a(727);class Q extends mb{constructor(xa,tb,Qb,pc=!1){super(document.createElement("a"),tb,pc);this.fd=hb=>{this.disabled||this.$.Zc(-1935155518,hb.ub,30,null);return!0};this.mGb=hb=>{hb="mouseover"===hb.type||"focus"===hb.type;const ib=ka.a(this.$)?this.Mab:this.wsa;Da.HelperMethods.SYd(ib,this.kha,this.kha+r.a.rfc,hb&&!Ea.h(this.$).inRangePicker)};this.Ri=()=>{this.$R(!0)};this.$f=()=>
{this.$R(!1)};this.kha=n.EwaSettings.sa(437)?aa.a.uad:aa.a.MTe;this.wsa=Qb.pb(this.domElement,E.a.instance.ga(508),0,this.kha,E.a.instance.ga(509),W.a.K3c,pc);xa.appendChild(this.domElement);this.Cc.ka("contextmenu",hb=>{Ha.g(hb)});n.EwaSettings.sa(437)||(this.Cc.ka("mouseover",this.mGb),this.Cc.ka("mouseout",this.mGb));yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.cla=R.KeyInputManager.instance.Dt(this.domElement,this.fd,kb.a.Jh,kb.a.XW);Ea.h(this.$).mc.xl(this.Ri);Ea.h(this.$).mc.Jm(this.$f)}dispose(){yb.a.instance.Ba(C.a.click,
this.domElement,this.fd);R.KeyInputManager.instance.Uw(this.domElement,this.cla);Ea.h(this.$)&&Ea.h(this.$).mc&&(Ea.h(this.$).mc.nl(this.Ri),Ea.h(this.$).mc.$l(this.$f));super.dispose()}$R(xa){const tb=Q.a8f(this.$);super.$R(xa||tb)}static a8f(xa){return!xa.isEditMode||!xa.va.count}}Object(t.a)(Q,"InsertSheetButton",mb,[]);class va extends mb{constructor(xa,tb,Qb){super(document.createElement("a"),tb);this.fd=pc=>{this.$.Zc(-684145703,pc.ub,0,null);return!0};this.mGb=pc=>{Da.HelperMethods.SYd(this.Qye,
this.kha,this.kha+r.a.rfc,("mouseover"===pc.type||"focus"===pc.type)&&!Ea.h(this.$).inRangePicker)};this.$=tb;this.kha=n.EwaSettings.sa(437)?aa.a.uad:aa.a.MTe;this.Qye=Qb.pb(this.domElement,E.a.instance.ga(510),0,this.kha,E.a.instance.ga(511),W.a.K3c);xa.appendChild(this.domElement);this.Cc.ka("contextmenu",pc=>{Ha.g(pc)});this.Cc.ka("mouseover",this.mGb);this.Cc.ka("mouseout",this.mGb);yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.cla=R.KeyInputManager.instance.Dt(this.domElement,this.fd,
kb.a.Jh,kb.a.XW)}dispose(){yb.a.instance.Ba(C.a.click,this.domElement,this.fd);R.KeyInputManager.instance.Uw(this.domElement,this.cla);this.Qye=null;super.dispose()}}Object(t.a)(va,"InsertTemplateButton",mb,[]);class na{constructor(xa,tb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=xa;this.newSheetIndex=tb}getSheetName(){return this.sheetName}}Object(t.a)(na,"MacroRecorderSheetReorderedPayload",null,[122]);var Ba=a(94);class Oa extends N.a{constructor(xa,tb){super(document.createElement("div"));
this.fR=()=>{u.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.tXf(!1,"OnSheetsChanged")};this.VQi=()=>{this.Aj()};this.UQi=()=>{this.Sj()};this.$=xa;this.yQj=tb;this.uU=!1;this.ZOb=0}dispose(){this.Sj();super.dispose()}dTj(){this.tXf(!0,"TogglerSheetDropdownMenu")}tXf(xa,tb){u.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${tb}, toggle: ${xa}, toggleStateId: ${this.ZOb}`);xa&&(this.ZOb+=1);const Qb=this.$.Jb.Gc("UserAction",
`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${tb}, toggle: ${xa}, toggleStateId: ${this.ZOb}, sheetCount: ${this.$.va.count}`);xa=this.Hgh();appChrome.renderSheetDropdownMenu(this.domElement,this.yQj,xa,this.ZOb,this.VQi,this.UQi,()=>{Qb.stop()},ka.a(this.$))}Hgh(){const xa=this.$.va,tb=[];for(let pc=0;pc<xa.count;pc++){var Qb=Object(D.a)(ea.a,xa.getItem(pc));0===Qb.yB&&(Qb=this.Ggh(Qb),tb.push(Qb))}return tb}Ggh(xa){const tb={};tb.key=xa.name;tb.text=xa.name;tb.onClick=this.Igh(xa);xa.active&&
(tb.className=ka.a(this.$)?"ewa-active-sheet-menu-item-present-mode":U.Rth);return tb}Igh(xa){return()=>{const tb=new Ba.a(-1876836819,0,this.$.xc,30,null);this.$.Ia.Hb(tb,{[r.a.kTd]:xa.name})}}Aj(){if(!this.uU){const xa=this.$.va;xa.Vf(this.fR);xa.$Wc(this.fR);xa.cY(this.fR);xa.Kga(this.fR);xa.ZFa(this.fR);xa.Qqe(this.fR);xa.TYa(this.fR);this.uU=!0}}Sj(){if(this.uU){const xa=this.$.va;xa.sg(this.fR);xa.MLd(this.fR);xa.G6(this.fR);xa.Wma(this.fR);xa.DQa(this.fR);xa.sWf(this.fR);xa.JJb(this.fR);this.uU=
!1}}}Object(t.a)(Oa,"SheetDropdownMenu",N.a,[451,2]);var oa=a(353);class Ja extends mb{constructor(xa,tb,Qb){super(document.createElement("a"),xa,!0);this.Jf=()=>{this.$R(!1);this.$.ea.Bn(this.Jf)};this.fd=pc=>{this.jfg(pc.ub);return!0};this.onKeyDown=pc=>13===pc.Ea.keyCode||32===pc.Ea.keyCode?(this.jfg(pc.ub),!0):!1;this.wsa=tb.pb(this.domElement,E.a.instance.ga(512),0,aa.a.pyh,E.a.instance.ga(512),W.a.h8h,this.disabled);this.domElement.classList.add(U.syh);Qb.appendChild(this.domElement);this.Drh();
this.afj()}dispose(){this.UXj();super.dispose()}$R(xa){super.$R(xa||!this.$.ea.zka)}Drh(){const xa=this.$.ea;xa.Zf?this.$R(!1):xa.Dk(this.Jf)}jfg(xa){this.disabled||(u.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${oa.a[xa]}`),this.$.Ia.Hb(new Ba.a(1243860697,xa,this.$.xc,30,null)))}afj(){yb.a.instance.ta(C.a.click,this.domElement,this.fd);R.KeyInputManager.instance.ta(C.a.Sb,this.domElement,this.onKeyDown)}UXj(){yb.a.instance.Ba(C.a.click,this.domElement,this.fd);
R.KeyInputManager.instance.Ba(C.a.Sb,this.domElement,this.onKeyDown)}}Object(t.a)(Ja,"SheetDropdownMenuAnchor",mb,[]);var Wb=a(60);const nc=(xa,tb,Qb,pc,hb,ib,Vb,wc=null)=>{wc=xa.Na(9,wc);wc.sheetName=tb;wc.newSheetIndex=Qb;return Wb.g(xa,"ReorderSheets",wc,pc,hb,ib,Vb,0)};var Yb=a(176),pb=a(134),Fa=a(191),ab=a(127),Gb=a(56),Ga=a(214),Ma=a(205),Qa=a(169),wb=a(128);class Na{constructor(xa,tb,Qb){this.vm=tb;this.uw=Qb;this.sheet=xa;this.altText=E.a.instance.ga(1991)}xH(){return this.sheet.active}Rqd(){return this.sheet.isLockPausedInSession}Isa(){return this.vm?
aa.a.USe:this.xH()?aa.a.TSe:aa.a.SSe}hoa(){return this.sheet.Nh?W.a.IPf:W.a.HXj}BXd(){return 16}wha(){return null}Jsa(){return this.vm?this.uw?U.WSe:U.VSe:null}bZd(){return null}xs(){return null}Wmd(){return 0}GYc(){return!0}}Object(t.a)(Na,"LockPausedSheetIconDataSource",null,[459]);class ya{constructor(xa,tb,Qb){this.vm=tb;this.uw=Qb;this.sheet=xa;this.altText=E.a.instance.ga(1990)}xH(){return this.sheet.active}Rqd(){return this.sheet.Nh}Isa(){return this.vm?aa.a.USe:this.xH()?aa.a.TSe:aa.a.SSe}hoa(){return W.a.IPf}BXd(){return 16}wha(){return null}Jsa(){return this.vm?
this.uw?U.WSe:U.VSe:null}bZd(){return null}xs(){return null}Wmd(){return 0}GYc(){return!0}}Object(t.a)(ya,"LockedSheetIconDataSource",null,[459]);class nb{constructor(xa,tb,Qb,pc){this.sheet=xa;this.altText=E.a.instance.ga(1905);this.rTj=tb;this.Y8f=Qb;this.uw=pc}xH(){return this.sheet.active}Rqd(){return this.sheet.$d.iz}wha(){return this.uw?this.xH()?U.Byh:U.Dyh:this.xH()?U.Ayh:U.Cyh}Isa(){return!this.xH()&&this.Y8f()?aa.a.oAh:aa.a.nAh}hoa(){return!this.xH()&&this.Y8f()?W.a.LDj:W.a.KDj}BXd(){return 14}Jsa(){return U.kxh}bZd(){return this.sheet.$d.znb}xs(){return this.rTj}Wmd(){return 8}GYc(){return!1}}
Object(t.a)(nb,"NamedSeetViewSheetIconDataSource",null,[459]);var vb=a(160),gb=a(132);class cb{constructor(xa,tb){this.zqa=this.k1=this.jBa=this.Bl=null;this.blf=!1;this.wTc=this.hoa=this.Jsa=this.wha=this.Isa=null;this.uN=()=>{this.dataSource.xH()&&f.TaskExtensions.za(this.uDb,()=>{dialogControls.renderToolTip(this.dataSource.xs(),"SheetIconTooltip",this.dataSource.bZd(),this.nI,10,!1,!1,1)},this.$.la,3)};this.tN=()=>{this.dataSource.xH()&&this.clearToolTip()};this.$=xa;this.dataSource=tb;this.uw=
x.a.Bsd()}get Cc(){return this.k1||(this.k1=gb.a.instance.ie(this.nI))}get uDb(){if(this.zqa)return this.zqa;const xa=new vb.a;this.$.Sx(tb=>{f.TaskExtensions.za(tb.$vd(),()=>{xa.setResult(!0)},this.$.la,3)});return this.zqa=xa.task}get nI(){return this.wTc}Djg(){if(this.nI&&(this.Bl||this.jBa)){if(this.uw){var xa=this.dataSource.hoa();this.hoa!==xa&&(this.jBa&&this.jBa.parentNode.removeChild(this.jBa),this.dff(),this.hoa=xa)}else xa=this.dataSource.Isa(),this.Isa!==xa&&(this.QMd(this.Bl,this.Isa,
xa),this.Isa=xa);xa=this.dataSource.wha();this.wha!==xa&&(this.uw?this.Wlj(this.jBa,this.wha,xa):this.QMd(this.Bl,this.wha,xa),this.wha=xa);xa=this.dataSource.Jsa();this.Jsa!==xa&&(this.QMd(this.nI,this.Jsa,xa),this.Jsa=xa);this.dataSource.xs()&&!this.dataSource.xH()&&this.clearToolTip()}}yIj(xa,tb,Qb){this.Zhi(xa,tb,Qb);ia.DOMElementExtensions.setVisible(this.nI,this.dataSource.Rqd())}clearToolTip(){f.TaskExtensions.za(this.uDb,()=>{dialogControls.clearToolTip(this.dataSource.xs())},this.$.la,3)}Zhi(xa,
tb,Qb){this.nI&&this.blf!==xa&&(this.nI.parentNode.removeChild(this.nI),this.Jsa=this.wha=this.hoa=this.Isa=this.wTc=null,this.dataSource.xs()&&(this.Cc.detach("mouseover",!0),this.Cc.detach("mouseout",!0)));this.nI||(this.wTc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.nI,P.a.$ha),Sys.UI.DomElement.addCssClass(this.nI,aa.a.Or),n.EwaSettings.sa(437)?xa===this.dataSource.GYc()?tb.appendChild(this.nI):tb.insertBefore(this.nI,Qb):xa?tb.insertBefore(this.nI,Qb):tb.appendChild(this.nI),
this.uw?this.dff():(this.Bl=document.createElement("img"),this.Bl.tabIndex=-1,this.Bl.alt=this.dataSource.altText,this.nI.appendChild(this.Bl),this.Bl.src=wa.a.qe(this.dataSource.Wmd())),this.dataSource.xs()&&(this.Cc.ka("mouseover",this.uN,!0),this.Cc.ka("mouseout",this.tN,!0)),this.blf=xa)}Wlj(xa,tb,Qb){xa&&(Sys.UI.DomElement.removeCssClass(xa,tb),Sys.UI.DomElement.addCssClass(xa,Qb))}QMd(xa,tb,Qb){tb&&Sys.UI.DomElement.removeCssClass(xa,tb);Qb&&Sys.UI.DomElement.addCssClass(xa,Qb)}dispose(){y.a.Ja(this.k1)}dff(){const xa=
this.$.da.Aa(388);xa?(this.jBa=xa.Kja(this.dataSource.hoa(),this.dataSource.BXd()))?this.nI.appendChild(this.jBa):u.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.hoa()} was not found.`):u.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(t.a)(cb,"SheetIcon",null,[2]);var La=a(354),ja=a(96),Ua=a(158);class lb extends ja.a{constructor(xa,tb){super(xa.domElement);this.onKeyDown=Qb=>
{121===Qb.keyCode&&Qb.shiftKey&&!this.Mna.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Mna.anchor),Ha.g(Qb))};this.vca=Qb=>{if(!this.$.isEditMode||this.Mna.disabled)return!0;this.rename(!1,Qb.ub);return!0};this.Xl=Qb=>this.Mna.disabled?!0:this.showContextMenu(Qb.clientPoint,Qb.ub,Qb.Mb);this.Nje=xa;this.$=tb;yb.a.instance.ta(C.a.tk,xa.domElement,this.vca);La.a.instance.ta(xa.domElement,this.Xl);this.Cc.ka("keydown",this.onKeyDown)}get Mna(){return this.Nje}dispose(){this.Mna&&(yb.a.instance.Ba(C.a.tk,
this.Mna.domElement,this.vca),La.a.instance.Ba(this.Mna.domElement,this.Xl),this.Nje=null);this.$=null;super.dispose()}showContextMenu(xa,tb,Qb){this.Mna.activate(tb,x.a.ptd());tb=new Ba.a(-1075099431,tb,this.$.xc,30,null);let pc;return!Ua.a(pc=this.$.Ia.Hb(tb,{[r.a.y7f]:xa,[lb.CDj]:this.Mna.sheet,[r.a.z7f]:Qb}))&&(6!==pc.status||pc.result)}rename(xa,tb){this.$.Zc(817296323,tb,xa?19:0,null)}}lb.CDj="Sheet";Object(t.a)(lb,"SheetOpsSheetClickHelper",ja.a,[]);var sb=a(39),V=a(61);class za extends mb{constructor(xa,
tb,Qb,pc,hb,ib,Vb){super(document.createElement("li"),xa);this.j3c=this.i3c=this.x7f=this.w7f=0;this.O6c=.5;this.uU=this.iTd=!1;this.color=this.AJc=this.vE=this.OEb=this.rO=null;this.Tic=this.Ojf=!1;this.B6b="#BEBBB8";this.YGc=null;this.onKeyDown=wc=>13!==wc.Ea.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.sz=wc=>32!==wc.Ea.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.uN=()=>{this.disabled||(this.MR.JZi(this),this.MR.fF||this.Ena(!0,void 0,"OnMouseOver"))};this.tN=()=>{this.disabled||
this.Ena(!1,void 0,"OnMouseOut")};this.lGb=()=>{this.MR.fF||(this.YMj(),Object(V.c)(this.sheet.sheetProcessedData)||Ea.h(this.$).Zza(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.Z5=()=>{this.zPe(!1);return!1};this.fd=wc=>{if(this.disabled)return!0;const Lc=Ea.h(this.$);this.sheet.active||3!==wc.ub?this.vm?this.activateSheet(wc.ub):x.a.ptd()&&Lc.focus():(!x.a.lNa(this.$)&&!this.iCb||Lc.fb||Lc.Uh||Lc.ztb(),this.activateSheet(wc.ub));return 3!==wc.ub};this.onPointerDown=wc=>{if(this.disabled)return!0;
this.zPe(!0);Ea.h(this.$).inRangePicker&&u.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Lc=3===wc.ub;if(2===wc.ub||Lc&&this.axa)this.vm?(this.Ena(!0,!Lc,"OnPointerDown"),Lc=h.Task.delay(Lc?this.x7f:this.w7f).Qo(()=>!0)):Lc=this.activateSheet(wc.ub),this.DBb&&(this.Tic=!0,this.MR.gvc=f.TaskExtensions.za(Lc,()=>{this.Tic&&this.MR.LZi(this,wc)},this.la,11));return!1};this.Wg=wc=>{if(this.disabled||
!this.DBb&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;const Lc=this.MR.fF&&!x.a.hkf();this.Tic=!1;this.vm&&this.Ena(2===wc.ub,void 0,"OnPointerUp");this.MR.gvc&&(f.TaskExtensions.za(this.MR.gvc,()=>{this.MR.KZi(this)},this.la,11),this.MR.gvc=null);return Lc};this.yN=()=>{this.Tic=!1;this.iTd||this.Ena(!1,void 0,"OnTouchMove");return!1};this.ZCe=new lb(this,xa);this.vm=ib;this.uw=Vb;this.iCb=x.a.iCb(xa);this.Opd=n.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&
!this.uw;this.vm?(this.w7f=xa.ya.SheetDragReorderDelayInMilliseconds,this.x7f=xa.ya.SheetDragReorderDelayInMillisecondsForTouch,this.i3c=18,this.j3c=20):(this.i3c=19,this.j3c=22);this.$=xa;this.DXb=pc;this.MR=hb;this.DBb=hb.Pse();this.Rgh();this.Lah();this.xmd=xa.Jb.zg("UserAction",this.name);this.Qqd=!1;ia.DOMElementExtensions.It(this.domElement,r.a.qq,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.vE);this.Kna=new Fa.a;xa=new ya(this.sheet,this.vm,this.uw);this.Kna.add(new cb(this.$,
xa));this.$.ea.FMb&&(xa=new Na(this.sheet,this.vm,this.uw),this.Kna.add(new cb(this.$,xa)));this.Opd||(xa=new nb(this.sheet,this.MR.Oyc,()=>this.color?za.lUd(this.color):!1,this.uw),this.OEb=new cb(this.$,xa),this.Kna.add(this.OEb));this.axa=this.MR.axa;this.vgb();this.sgj();this.Xxe=new ca.a(this.domElement,1);tb.insertBefore(this.domElement,Qb);ka.a(this.$)&&this.wkg(!0)}get kkh(){return this.AJc||(this.AJc=Ma.a.Uo("#F5F5F5"))}get name(){return this.rO.innerText}set name(xa){this.rO&&(this.rO.innerText=
xa,this.xDc(),this.xkg())}get sheet(){return this.DXb}get anchor(){return this.YGc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(xa){this.anchor.tabIndex=xa}oVh(){return ia.DOMElementExtensions.Ff(this.anchor)?this.anchor:null}dispose(){if(this.uU){H.a.instance.Ba(C.a.pointerDown,this.domElement,this.onPointerDown);R.KeyInputManager.instance.Ba(C.a.Sb,this.domElement,this.onKeyDown);R.KeyInputManager.instance.Ba(C.a.fp,this.domElement,this.sz);yb.a.instance.Ba(C.a.click,this.domElement,
this.fd);H.a.instance.Ba(C.a.SV,this.domElement,this.lGb);H.a.instance.Ba(C.a.oB,this.domElement,this.Z5);if(this.DBb||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))H.a.instance.Ba(C.a.Kf,this.domElement,this.Wg),this.axa&&(I.a.instance.Ba(C.a.ve,this.domElement,this.Wg),I.a.instance.Ba(C.a.Tf,this.domElement,this.yN));this.uU=!1;this.B6b="#BEBBB8"}y.a.pc([this.ZCe,this.Xxe]);this.rO=this.vE=this.YGc=this.MR=this.Xxe=this.ZCe=null;if(this.Kna){for(let xa of this.Kna)xa.dispose();
this.Kna=null}this.color=this.DXb=null;super.dispose()}$R(xa){xa&&this.Ena(!1,!1);super.$R(xa)}Y9f(xa){if(Gb.a.pg.GQ){this.wMe();var tb=e.GetServiceTaskFactory.Oa(this.$.da,322,323,1);f.TaskExtensions.za(tb,Qb=>{Yb.UISurfaces.eH().then(pc=>{const hb=Qb.result;hb.Kzj(pc);hb.show(xa);return null},pc=>{u.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${pc}`);return null})},this.la,3)}}ppe(){if(this.sheet.active&&this.$.Yq){var xa=this.$.Yq,
tb=Ea.h(this.$),Qb=tb.sj;if(this.sheet.$d.iz){if(!this.OEb){const pc=new nb(this.sheet,this.MR.Oyc,()=>this.color?za.lUd(this.color):!1,this.uw);this.OEb=new cb(this.$,pc);this.Kna.add(this.OEb)}Qb&&tb.kgb(1);xa.classList.add(aa.a.pVe);xa=za.M4e(r.a.Twf);tb=za.M4e(r.a.bAd);"true"===xa&&"true"===tb?this.$.ea.cUd&&this.$.ea.YMb&&(this.sheet.$d.cK?(xa=1,pb.a.Av(r.a.bAd,"false",pb.a.h_),this.$.ea.YMb=!1):xa=0,pb.a.Av(r.a.Twf,"false",pb.a.h_),this.$.ea.cUd=!1,this.Y9f(xa)):this.sheet.$d.cK&&"true"===tb&&
this.$.ea.YMb&&(pb.a.Av(r.a.bAd,"false",pb.a.h_),this.$.ea.YMb=!1,this.Y9f(2))}else this.wMe(),Qb&&tb.kgb(0),xa.classList.remove(aa.a.pVe)}}wMe(){const xa=this.$.da.Aa(322);xa&&xa.dismiss()}vgb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.m7a()?U.QPj:U.YPj;n.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.rO.parentNode.classList.add(U.czi):this.rO.parentNode.classList.add(U.dzi);this.xkg();this.Opd&&this.ppe();this.zIj();this.Fkg();this.xDc();
this.Opd||this.ppe()}IZi(){this.iTd=!0;this.Ena(!0,!0,"OnSheetReorderStarted")}HZi(){this.iTd=!1;this.Ena(!1,void 0,"OnSheetReorderEnded")}activate(xa=0,tb=!1){this.u3b()||(this.sheet.activate(),tb&&Ea.h(this.$).focus(),xa={["InputMethod"]:oa.a[xa],["AppMode"]:this.$.xc,["Location"]:"canvas"},wb.b(this.$).rd(ab.a.yDj,xa))}wkg(xa){this.B6b=xa?"#797775":"#BEBBB8";this.O6c=xa?-.5:.5;this.AJc=xa?Ma.a.Uo("#3B3A39"):Ma.a.Uo("#F5F5F5");this.Fkg()}Bwj(xa){this.DBb=xa}DCd(xa){xa.$3c();this.lBe(xa)}lBe(xa){xa.I0a();
this.sheet.activate()}qHg(xa){xa=new Ba.a(-1876836819,xa,this.$.xc,30,null);return this.$.Ia.Hb(xa,{[r.a.kTd]:this.sheet.name})}xkg(){this.rO.parentNode.setAttribute("sheet-title",this.rO.innerText)}xDc(){const xa=this.MOh();this.anchor.setAttribute(r.a.Vu,xa);this.anchor.setAttribute(r.a.Q9,this.sheet.active.toString())}MOh(){const xa=this.sheet.$d.iz,tb=this.sheet.$d.znb,Qb=this.sheet.Nh,pc=this.sheet.isLockPausedInSession;return xa&&Qb?String.format(E.a.instance.ob(20),this.name,tb):xa&&pc?String.format(E.a.instance.ob(22),
this.name,tb):xa?String.format(E.a.instance.ob(19),this.name,tb):Qb?String.format(E.a.instance.ob(18),this.name):pc?String.format(E.a.instance.ob(21),this.name):this.name}activateSheet(xa=0){if(x.a.ptd()){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.u3b())return h.Task.Ra(!1);Qa.a.current.ER="ActivateSheet";this.sheet.activate();return h.Task.Ra(!0)}return this.qHg(xa)}Fkg(){const xa=this.sheet.tabColor;this.color=xa?Ma.a.Uo(xa):this.kkh;this.Ojf=
za.lUd(this.color);this.Ena(!1,void 0,"UpdateTabColor")}Ena(xa,tb=!1,Qb=null){if(this.sheet){Qb=this.sheet.active;var pc=this.m7a(),hb=!!this.sheet.tabColor,ib=Ma.a.PF(Qb||pc?Ga.a.white:this.color);this.vE.style.background="";Qb||pc?(hb?n.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.yLa?this.BBj():this.vm?this.ABj():this.zBj():this.vm||(this.vE.style.backgroundColor=ib),this.vE.style.height=this.i3c.toString()+"px"):(this.vE.style.filter="",this.vE.style.backgroundColor=
ib,this.vE.style.height=this.j3c.toString()+"px");this.rO.className=Qb?U.RPj:pc?U.dark:this.Ojf?U.light:U.dark;for(let Vb of this.Kna)Vb.Djg();this.vm&&(xa&&!hb&&(this.vE.style.backgroundColor="#E1DFDD"),ia.DOMElementExtensions.toggleCssClass(this.domElement,U.XPj,xa),tb?(hb||(this.vE.style.backgroundColor=this.B6b),this.domElement.style.backgroundColor=this.B6b):(hb||(this.vE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.rO.style.fontWeight=Qb||pc||!this.vm&&xa?this.vm?
"600":"bold":""}else u.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Qb}`)}ABj(){const xa=this.vE.style,tb=Ma.a.PF(za.A1c(this.color,this.O6c));xa.background=tb}zBj(){const xa=this.vE.style,tb=Ma.a.PF(za.A1c(this.color,1)),Qb=Ma.a.PF(za.A1c(this.color,this.O6c));xa.background=`$linear-gradient(${tb}, ${Qb})`}BBj(){this.vE.style.background="transparent"}Lah(){this.YGc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=U.SPj;ia.DOMElementExtensions.It(this.anchor,r.a.lpb,null,null);this.tabIndex=-1}Rgh(){this.vE=document.createElement("span");this.vE.className=U.VPj;this.rO=document.createElement("span");this.rO.className=U.$Pj;this.rO.dir=this.sheet.rtlName?"rtl":"ltr";this.vE.appendChild(this.rO)}zIj(){const xa=this.$.TI;for(let tb of this.Kna)tb.yIj(xa,this.vE,this.rO)}m7a(){return Ea.h(this.$).m7a(this.sheet)}YMj(){this.xmd.start();this.Qqd=!0}zPe(xa){this.Qqd&&
(this.xmd.stop(),u.ULS.sendTraceTag(537153686,0,50,sb.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.xmd.Bc,["Has been clicked"]:xa})),this.Qqd=!1)}sgj(){H.a.instance.ta(C.a.pointerDown,this.domElement,this.onPointerDown);R.KeyInputManager.instance.ta(C.a.Sb,this.domElement,this.onKeyDown);R.KeyInputManager.instance.ta(C.a.fp,this.domElement,this.sz);this.Cc.ka("mouseover",this.uN);this.Cc.ka("mouseout",this.tN);H.a.instance.ta(C.a.SV,this.domElement,
this.lGb);H.a.instance.ta(C.a.oB,this.domElement,this.Z5);if(this.DBb||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))H.a.instance.ta(C.a.Kf,this.domElement,this.Wg),this.axa&&(I.a.instance.ta(C.a.ve,this.domElement,this.Wg),I.a.instance.ta(C.a.Tf,this.domElement,this.yN));yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.uU=!0}u3b(){const xa=this.$.da.Aa(65);return xa&&xa.Aka()?(xa.xwc(),this.lBe(xa),!0):!1}static M4e(xa){let tb=pb.a.get(xa);tb||(pb.a.Av(xa,
"true",pb.a.h_),tb=pb.a.get(xa));return tb}static A1c(xa,tb){if(1<tb||-1>tb)return xa;let Qb=xa.r,pc=xa.g;xa=xa.b;0<tb?(Qb=Qb*(1-tb)+255*tb,pc=pc*(1-tb)+255*tb,xa=xa*(1-tb)+255*tb):(Qb*=1+tb,pc*=1+tb,xa*=1+tb);return Ga.a.Pvb(Math.round(Qb),Math.round(pc),Math.round(xa))}static lUd(xa){return 128>=(222*xa.r+707*xa.g+71*xa.b)/1E3}}Object(t.a)(za,"SheetTabButton",mb,[]);class Ra extends mb{constructor(xa,tb,Qb){super(document.createElement("a"),tb);this.kha=n.EwaSettings.sa(437)?aa.a.uad:aa.a.Izh;Qb.pb(this.domElement,
E.a.instance.ga(712),0,this.kha,E.a.instance.ga(712),W.a.K3c,!0);xa.appendChild(this.domElement);this.Cc.ka("contextmenu",pc=>{Ha.g(pc)})}}Object(t.a)(Ra,"WorkbookProtectionButton",mb,[]);var Xa=a(52),$a=a(42),ma=a(58);class fa extends N.a{constructor(xa,tb,Qb=null,pc=null){super(tb);this.sheetTabActivatePreviousHidden=E.a.instance.ga(721);this.sheetTabActivateNextHidden=E.a.instance.ga(723);this.svgIconProvider=null;this.oh=[];this.rK=Array(6);this.lAd=Array(6);this.kSa=this.Kzb=this.kH=this.Ryc=
this.Vdb=this.Tyc=this.pTd=this.Vk=null;this.isRtl=!1;this.eK=this.gv=0;this.m8b=this.fvc=!1;this.Prc=this.lna=0;this.oM=this.n3=this.gaa=this.v8b=null;this.Mdc=this.PC=0;this.mOb=null;this.DCb=-1;this.FY=null;this.Pqc=0;this.DAc=-1;this.Fma=0;this.Hta=new L;this.CNc=!1;this.gvc=this.Uyc=this.HMb=this.Kje=this.l_=null;this.Pbe=!1;this.snd=null;this.Fzd=!1;this.htmlSanitizationHelper=this.Jje=null;this.jD=(hb,ib)=>{this.zIf(ib.item)};this.Qya=(hb,ib)=>{hb=this.$.va.na.index;for(let Vb=0,wc=this.oh.length;Vb<
wc;Vb++){const Lc=this.mQ(Vb);if(Lc.name===ib.oldName){Lc.name=ib.newName;this.P_();Vb===hb&&this.c0(6);break}}};this.DIf=(hb,ib)=>{(hb=this.i3a(ib.item))&&hb.vgb()};this.EIf=(hb,ib)=>{ib.visible?(this.bSa(!1),this.AIf(ib.item)):this.zIf(ib.item)};this.oN=hb=>{this.fF?(this.FY=hb,this.IPb()):(this.FY&&(this.Prc+=this.FY.clientPoint.x-hb.clientPoint.x),this.FY=hb,Math.abs(this.Prc)>=this.sph&&this.IPb());return!0};this.yN=hb=>{hb.Ea.preventDefault();return!1};this.Q1f=hb=>{this.M1f(hb,!0)};this.P1f=
hb=>{this.M1f(hb,!1)};this.W5=hb=>{if(this.fF&&(this.hz||this.qmf(hb)))if(this.m8b=this.iif(hb),this.hz){let ib;hb=(ib=this.mQ(this.PC+1))?ib.sheet:null;this.reorderSheets(hb,this.PC+1===this.nTd,!0)}else hb=this.Fzd?null:this.snd,this.reorderSheets(hb,this.Fzd,!0);this.QP();return!0};this.ij=(hb,ib)=>{ib.sF&&this.Q0d(ib.sF);this.Vxc(!1);this.P_();ib.na&&(this.Q0d(ib.na),this.c0(6),this.ea.nma())};this.hzf=(hb,ib)=>{this.pEc(ib.item)};this.izf=(hb,ib)=>{this.pEc(ib.item)};this.jzf=(hb,ib)=>{this.pEc(ib.item)};
this.VOa=(hb,ib)=>{this.pEc(ib.item)};this.wya=()=>{this.y2c()};this.dd=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.y2c();this.w6c();n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(ma.d(this.$)||ma.e(this.$))&&($a.PageLoadTrackingInfo.instance.uR(r.a.LAa,["sheetTabBar"]),$a.PageLoadTrackingInfo.instance.kW(r.a.LAa,["sheetTabBar"]));this.d6c();this.P_();this.bSa(!0);this.c0(6)};this.wj=()=>{this.isVisible&&(this.P_(),this.c0(6))};this.tf=()=>{Object(G.a)(Q,
this.kH)===Z.k(this.$.dg)&&this.d6c();for(const hb of this.oh)hb.Bwj(!Z.k(this.$.dg))};this.CIf=(hb,ib)=>{this.Nlj(ib.item,ib.isUserOperation)};this.CGb=(hb,ib)=>{this.AIf(ib.item)};this.onKeyDown=hb=>{switch(hb.keyCode){case 9:var ib=this.domElement.querySelectorAll(ia.DOMElementExtensions.kr);const Vb=ia.DOMElementExtensions.rm(ib);ib=ia.DOMElementExtensions.LA(ib);ia.DOMElementExtensions.CAa(hb,Vb,ib);break;case 39:case 37:ia.DOMElementExtensions.O4f(hb,this.domElement.querySelectorAll(ia.DOMElementExtensions.kr),
39===hb.keyCode?!this.isRtl:this.isRtl)}u.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${hb.keyCode}`)};this.onScroll=()=>{this.Vk.scrollLeft!==this.lna&&this.CRj()};this.wN=hb=>{if(hb.ctrlKey||hb.O2)return!1;this.Vk.scrollLeft+=Math.floor(30*hb.oCa);if(this.hz&&this.fF){const ib=this.m3e("OnMouseWheel");ib&&this.EXd(0<hb.oCa,ib.x+ib.width/2)}return!0};this.nF=(hb,ib)=>{if(this.Hta)this.V$e("PartialInteractivity",ib.HL?3:0);else{this.QP(!1);this.TRd(ib.HL);for(const Vb of this.Owe)Vb&&
Vb.$R(ib.HL);for(const Vb of this.oh)Vb&&Vb.$R(ib.HL)}};this.NFb=(hb,ib)=>{hb=0;ib.Dne&&(hb=2|(ib.DDj?1:0));this.V$e("ComponentRangePicker",hb)};this.$=xa;this.ea=this.$.ea;this.D8b=(this.hz=x.a.hkf())&&!n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.vm=n.EwaSettings.sa(437);this.uw=x.a.Bsd();this.nmf=this.vm&&!this.$.rw;this.hz&&(this.Pbe=this.vm&&!z.a.qw);this.Upi=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",
!1);this.VJi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.UJi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;this.sph=this.$.ya.SheetTabDragStartPixelThreshold;this.HPa=this.IPa=-1;this.x4c=!1;this.htmlSanitizationHelper=pc;this.uw&&(this.svgIconProvider=Qb);this.hC=new ca.a(this.domElement,3);this.vm&&this.domElement.classList.add(U.Myh);this.Aeh();this.ach();this.Beh();n.EwaSettings.VM()&&document.getElementById(r.a.Zaa)||this.Ffh();this.Vxc(!0);this.dd(null,null);xa=this.$.va;xa.Vf(this.ij);
xa.$Wc(this.wya);xa.cY(this.jD);xa.Kga(this.CGb);xa.ZFa(this.Qya);xa.Qqe(this.CIf);xa.TYa(this.EIf);xa.bNg(this.DIf);xa.jXc(this.hzf);xa.Nqe(this.izf);xa.Oqe(this.jzf);xa.Pqe(this.VOa);this.$.Lk(this.dd);this.$.bC(this.wj);X.a(this.$).Xh(this);this.$.da.Ha(32,this);n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.$t(this.tf);this.Syc=this.ze.ie(this.domElement);this.Syc.ka("keydown",this.onKeyDown);db.a(this.$).ap()&&this.nF(null,new Ca.a(!0));db.a(this.$).Sf.u9(this.nF);
Ea.h(this.$).kqe(this.NFb);this.Syc.ka("mousedown",hb=>{hb.preventDefault()});w.a.instance.ta(C.a.bD,this.domElement,this.wN);this.oTd=this.ze.ie(this.Vk);this.oTd.ka("scroll",this.onScroll);this.CRj=Sa.a(()=>{this.P_()},200,this.$.la,O.a.IDj,!0);this.$.QA(r.a.EKj);this.nmf&&(this.Jje=new Oa(this.$,this.kSa.domElement));n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&$a.PageLoadTrackingInfo.instance.U_(r.a.LAa,["sheetTabBar"])}get jc(){return this.domElement}get Ff(){return this.isVisible}get Yd(){return qa.a.mTd}get fF(){return this.CNc}get nTd(){return this.oh.length}get Oyc(){return this.Kje}get axa(){return this.Pbe}get navigationButtonsDisabled(){return!!this.Hta&&
this.Hta.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.Hta&&this.Hta.operationButtonsDisabled}get kAd(){return this.vm?this.$.TI?[aa.a.E9b,aa.a.ZSe,aa.a.aTe,aa.a.D9b,aa.a.lua,aa.a.lua]:[aa.a.D9b,aa.a.aTe,aa.a.ZSe,aa.a.E9b,aa.a.lua,aa.a.lua]:this.$.TI?[aa.a.E9b,aa.a.YSe,aa.a.$Se,aa.a.D9b,aa.a.lua,aa.a.lua]:[aa.a.D9b,aa.a.$Se,aa.a.YSe,aa.a.E9b,aa.a.lua,aa.a.lua]}get mAd(){return this.$.TI?[null,W.a.SEe,W.a.QEe]:[null,W.a.QEe,W.a.SEe]}get fOf(){return this.$.TI?[null,W.a.TEe,
W.a.REe]:[null,W.a.REe,W.a.TEe]}get gDb(){if(this.isRtl){if(z.a.gF)return 0;if(z.a.Cf)return-1*(this.Vk.scrollWidth-this.Vk.clientWidth);if(z.a.qw)return this.Vk.scrollWidth-this.Vk.clientWidth;u.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get MKb(){if(this.isRtl){if(z.a.gF)return this.Vk.scrollWidth-this.Vk.clientWidth;if(z.a.Cf||z.a.qw)return 0;u.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Vk.scrollWidth-
this.Vk.clientWidth}get Owe(){return this.Hta?[this.kH,this.Kzb]:[this.kH,this.Kzb,this.kSa]}get ZPj(){return this.oh.concat(this.kSa)}get BDj(){return this.Jje}pb(xa,tb,Qb,pc,hb,ib,Vb=!1){xa.removeAttribute("Href");xa.setAttribute(r.a.Cd,r.a.Qs);xa.className=U.zyh;xa.title=tb;xa.tabIndex=0;this.uw&&ib?Qb=this.svgIconProvider.lba(ib,12,12,xa,24,24):(tb=document.createElement("span"),tb.className=this.vm?aa.a.w5g:aa.a.Or,tb.classList.add(P.a.$ha),tb.tabIndex=-1,xa.appendChild(tb),ib=document.createElement("img"),
ib.src=wa.a.qe(Qb),ib.className=pc,ib.alt=hb,ib.tabIndex=-1,tb.appendChild(ib),Qb=ib);Vb&&xa.classList.add(P.a.VT);return Qb}dispose(){if(this.$){var xa=this.$.va;xa.sg(this.ij);xa.MLd(this.wya);xa.G6(this.jD);xa.Wma(this.CGb);xa.DQa(this.Qya);xa.sWf(this.CIf);xa.JJb(this.EIf);xa.Jjj(this.DIf);xa.XLd(this.hzf);xa.pWf(this.izf);xa.qWf(this.jzf);xa.rWf(this.VOa);this.$.pl(this.dd);this.$.xF(this.wj);db.a(this.$)&&db.a(this.$).Sf.sda(this.nF);this.Hta&&Ea.h(this.$).SVf(this.NFb);w.a.instance.Ba(C.a.bD,
this.domElement,this.wN)}y.a.pc(this.lAd);this.lAd=null;if(this.rK)for(xa=0;xa<this.rK.length;xa++){const tb=ia.DOMElementExtensions.JJ(this.rK[xa],this.domElement,!1,"a");tb&&B.a.Qma(tb)}y.a.Ja(this.hC);y.a.Ja(this.Syc);y.a.Ja(this.oTd);this.oTd=this.Syc=this.Kzb=this.kH=this.hC=null;this.$&&this.hz&&this.QP(!1);this.gaa=null;this.kRd(null,"Dispose");this.mOb=this.oM=this.v8b=null;this.y2c();this.Vdb=this.Tyc=this.pTd=this.Vk=this.rK=this.$=this.ea=null;super.dispose()}ag(xa,tb){if(!tb){u.ULS.shipAssertTag(537153760,
0,0<this.oh.length,"There is no sheet tab button.");if(!this.oh.length)return!1;xa=null;for(const Qb of this.oh)if(xa=Qb.oVh())break;if(!xa)return u.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ia.DOMElementExtensions.setFocus(xa)}return!tb}sh(xa){return ia.DOMElementExtensions.Af(this.jc,xa)}rj(){}dk(){}reorderSheets(xa,tb,Qb){if(this.l_&&this.l_!==xa){const pc=this.l_.index;this.Mlj(this.l_,xa,tb);xa=xa?xa.index-1:tb?this.$.va.count-1:0;pc!==xa&&(this.yDi(pc,xa,Qb),
this.hsh(this.l_.name,xa))}}u6h(xa){xa=this.Oia(xa);return-1!==xa&&this.gv<=xa&&xa<=this.eK?this.oh[xa].domElement:null}r1j(xa){if(this.uw){for(var tb=0;tb<this.rK.length;tb++){const Qb=this.rK[tb];if(Qb&&this.svgIconProvider){const pc=Qb.parentNode;this.vVf(Qb);pc&&(this.rK[tb]=this.svgIconProvider.lba(xa?this.fOf[tb]:this.mAd[tb],12,12,pc,24,24))}}for(tb=0;tb<this.oh.length;tb++)this.oh[tb].wkg(xa);this.kSa&&this.kSa.wsa&&this.vkg(W.a.i8h,this.kSa,xa);this.kH&&this.kH.wsa&&this.vkg(W.a.B7g,this.kH,
xa)}}vkg(xa,tb,Qb){tb.Mab||(tb.Mab=this.svgIconProvider.lba(xa,12,12,tb.wsa.parentNode,24,24));tb.Mab&&(ia.DOMElementExtensions.setVisible(tb.wsa,!Qb),ia.DOMElementExtensions.setVisible(tb.Mab,Qb))}LZi(xa,tb){var Qb=Ea.h(this.$);const pc=Qb.inRangePicker,hb=Da.HelperMethods.ko(tb);if(Qb.fb&&!pc){const ib=Qb.Ql?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Vb=void 0;n.EwaSettings.o7a&&(Vb=[Object(ba.a)(Qb.mc.textBox.qBa)]);ba.b(this.$).FBa(hb.rawEvent,ib,Vb);Qb.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}Qb=this.axa&&3===tb.ub;!(2===tb.ub&&hb.button===Sys.UI.MouseButton.leftButton||Qb)||pc||this.fF||db.a(this.$).ap()||(Qb&&xa.IZi(),this.DCb=tb.clientPoint.x,this.FY=tb,this.EVg(xa))}JZi(xa){!this.hz&&this.fF&&this.$Ud(xa.sheet,!1)}KZi(xa){this.hz||(this.fF&&this.reorderSheets(xa.sheet,!1,!0),this.QP());this.P_()}Pse(){return this.$.isEditMode&&!Z.k(this.$.dg)}P_(){const xa=Da.HelperMethods.ZQ(()=>{this.m_j();this.vm&&this.cBj();this.TRd()});u.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${xa}`)}cBj(){const xa=this.eK===this.oh.length-1;ia.DOMElementExtensions.toggleCssClass(this.Vdb,this.$.TI?U.bTe:U.RSe,!!this.gv);ia.DOMElementExtensions.toggleCssClass(this.Vdb,this.$.TI?U.RSe:U.bTe,!xa)}TRd(xa=!1){const tb=!this.gv,Qb=this.eK===this.oh.length-1;this.v5f(4,this.sheetTabActivatePreviousHidden,!tb);this.v5f(5,this.sheetTabActivateNextHidden,!Qb);this.iyc(0,tb||xa);this.iyc(1,tb||xa);this.iyc(2,Qb||xa);this.iyc(3,
Qb||xa)}v5f(xa,tb,Qb){if(xa=this.rK[xa]){ia.DOMElementExtensions.setVisible(xa,Qb);var pc=this.R4e(xa);pc.title="img"===xa.nodeName?xa.alt=0<this.oh.length&&Qb?tb:"":xa.title=0<this.oh.length&&Qb?tb:"";pc.tabIndex=Qb?0:-1}}R4e(xa){return this.uw?xa.parentNode:xa.parentNode.parentNode}iyc(xa,tb){if(xa=this.rK[xa])xa=this.R4e(xa),void 0!==xa&&null!==xa&&(!this.oh.length||tb?(xa.classList.add(P.a.VT),xa.setAttribute(r.a.gsa,"true")):(xa.classList.remove(P.a.VT),xa.setAttribute(r.a.gsa,"false")))}bSa(xa){const tb=
this.$.TI?this.oh.length-1:0;let Qb=this.u7e(this.$.TI?0:this.oh.length-1);Qb&&(Qb.borderRightWidth=xa?"1px":"0");this.gv!==this.eK&&(Qb=this.u7e(tb))&&(Qb.borderRightWidth="0")}Dpe(xa,tb){this.oh||(this.oh=[]);-1===tb?this.oh.push(xa):this.oh.splice(tb,0,xa)}V5b(xa,tb){let Qb=-1,pc=null;tb||(Qb=this.tZh(xa.index),-1!==Qb&&(pc=this.TKa(Qb)));xa=new za(this.$,this.Vk,pc,xa,this,this.vm,this.uw);this.Dpe(xa,Qb);ia.DOMElementExtensions.setVisible(xa.domElement,!0)}$Ud(xa,tb){var Qb=this.i3a(xa);if(Qb){this.snd=
xa;this.Fzd=tb;xa=Qb.domElement;Qb=this.isRtl?xa.offsetLeft+(this.Vk.scrollWidth-this.Vk.clientWidth-this.Vk.scrollLeft):xa.offsetLeft-this.Vk.scrollLeft;if(!this.isRtl&&tb||this.isRtl&&!tb)Qb+=xa.offsetWidth;this.Ryc.style.left=Da.HelperMethods.sc(Qb-4);ia.DOMElementExtensions.setVisible(this.Ryc,!0)}}kcf(){ia.DOMElementExtensions.setVisible(this.Ryc,!1)}c0(xa){const tb=Da.HelperMethods.ZQ(()=>{switch(xa){case 0:this.Nwc(0);break;case 1:this.Nwc(this.gv-1);break;case 2:this.Nwc(this.gv+1);break;
case 3:this.scrollIntoView(this.oh.length-1);break;case 4:this.gv&&1<=this.oh.length&&(this.pne(this.gv-1),this.IPd());break;case 5:this.eK!==this.oh.length-1&&1<=this.oh.length&&(this.pne(this.eK+1),this.IPd());break;case 6:this.IPd()}});this.D8b&&this.fF&&this.IPb();u.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${xa}, duration = ${tb}`)}pne(xa){(xa=this.mQ(xa))&&xa.activate()}yHh(xa){if(0===xa.yB){const tb=this.$.va;let Qb=0;for(let pc=0,hb=tb.count;pc<hb;pc++){const ib=
Object(D.a)(ea.a,tb.getItem(pc));if(ib===xa)return Qb;0===ib.yB&&Qb++}}return-1}lHh(xa){const tb=this.$.va;for(let Qb=xa.index+1,pc=tb.count;Qb<pc;Qb++)if(xa=Object(D.a)(ea.a,tb.getItem(Qb)),0===xa.yB)return xa;return null}Oia(xa){for(let tb=0;tb<this.oh.length;tb++){const Qb=this.mQ(tb);if(!Qb)u.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${tb}] is null even though index is not out of bounds!`);else if(Qb.sheet===xa)return tb}return-1}i3a(xa){xa=
this.Oia(xa);return this.mQ(xa)}yDi(xa,tb,Qb){const pc={};pc.a=this.$.ya.UserSessionId;pc.b=Qb;pc.c=this.m8b;pc.d=xa;pc.e=tb;pc.f=this.$.va.count;Xa.b().Te(2,pc,Qb)}Mlj(xa,tb,Qb){const pc=Object(D.a)(sa.a,this.$.va);tb?(tb=tb.index,tb=xa.index<tb?tb-1:tb):tb=Qb?pc.count-1:0;pc.reorderSheet(xa,tb,!0)}T4f(xa){Ea.h(this.$).Gg.qp(xa)}EVg(xa){if(!this.fvc){const tb=this.domElement.ownerDocument.body;this.hz?(H.a.instance.ta(C.a.yj,document.documentElement,this.oN),this.axa&&(I.a.instance.ta(C.a.Tf,document.documentElement,
this.oN),I.a.instance.ta(C.a.Tf,this.domElement,this.yN))):(H.a.instance.ta(C.a.yj,tb,this.oN),I.a.instance.ta(C.a.Tf,tb,this.oN));H.a.instance.ta(C.a.Kf,document.documentElement,this.W5);I.a.instance.ta(C.a.ve,tb,this.W5);this.fvc=!0}this.l_=xa.sheet;this.m8b=!1;this.hz?(this.oM=null,this.v8b=xa,this.gaa=xa.domElement,this.kRd(ia.DOMElementExtensions.getBoundingClientRect(this.gaa),"BeginSheetTabButtonDrag")):(u.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(U.QSe),this.domElement.style.cursor="",this.T4f("pointer"))}QP(xa=!0){if(this.fvc){this.T4f(r.a.LU);const tb=this.domElement.ownerDocument.body;this.hz?(H.a.instance.Ba(C.a.yj,document.documentElement,this.oN),this.axa&&(I.a.instance.Ba(C.a.Tf,document.documentElement,this.oN),I.a.instance.Ba(C.a.Tf,this.domElement,this.yN))):(H.a.instance.Ba(C.a.yj,tb,this.oN),I.a.instance.Ba(C.a.Tf,tb,this.oN));H.a.instance.Ba(C.a.Kf,document.documentElement,this.W5);I.a.instance.Ba(C.a.ve,
tb,this.W5);this.CNc=this.fvc=!1}this.Prc=0;this.m8b=!1;this.snd=this.l_=null;this.hz?(this.gaa&&(this.gaa.style.visibility="visible",this.gaa=null),this.v8b=null,this.kRd(null,"EndSheetTabButtonDrag"),this.oM&&(this.oM.parentNode&&this.oM.parentNode.removeChild(this.oM),this.oM=null),this.Znj(xa)):(this.domElement.classList.remove(U.QSe),this.kcf())}Znj(xa){this.SWd(xa);this.PC=this.DCb=-1}hsh(xa,tb){const Qb=this.$.oa,pc=Qb?Qb.xa:null;this.$.userOperationManager.Jc(new da.a(557,0,(hb,ib,Vb)=>nc(pc,
xa,tb,hb,ib,Vb,null),64,()=>new na(xa,tb)),null)}mQ(xa){return 0<=xa&&xa<this.oh.length?this.oh[xa]:null}t7e(xa){return(xa=this.mQ(xa))?xa.sheet:null}TKa(xa){return(xa=this.mQ(xa))?xa.domElement:null}u7e(xa){return(xa=this.TKa(xa))?xa.style:null}tZh(xa){const tb=this.$.va;xa+=1;let Qb=-1;const pc=this.oh?this.oh.length:0;for(;xa<tb.count;){const hb=Object(D.a)(ea.a,tb.getItem(xa));if(0===hb.yB){for(Qb=0;Qb<pc&&this.t7e(Qb)!==hb;Qb++);break}xa++}return-1===Qb||Qb===pc?-1:Qb}zIf(xa){var tb=this.i3a(xa);
tb&&(this.hz&&this.fF&&(u.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.QP()),this.Vk.removeChild(tb.domElement),tb=Array.indexOf(this.oh,tb),this.oh.splice(tb,1),this.P_(),(!this.isRtl&&tb===this.oh.length||this.isRtl&&!tb)&&this.bSa(!0),this.D8b&&this.fF?xa===this.l_?(this.QP(),this.c0(6)):this.IPb():
this.c0(6))}AIf(xa){const tb=Object(D.a)(ea.a,xa);this.hz&&this.fF&&(u.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.QP());if(0===tb.yB){this.bSa(!1);var Qb=this.Oia(xa);-1===Qb&&(u.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.V5b(tb,!1),Qb=this.Oia(xa));this.daf(Qb,!0)}}Nlj(xa,tb){const Qb=this.i3a(xa);Qb&&(this.hz&&this.fF&&!tb&&(u.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.QP()),xa=this.MPj(xa,Qb),!n.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.hz&&xa&&tb&&xa.HZi())}MPj(xa,
tb){var Qb=Array.indexOf(this.oh,tb);const pc=this.yHh(Object(D.a)(ea.a,xa));if(-1===pc||-1===Qb)return null;Qb!==pc||this.hz?(this.bSa(!1),{$Hh:this.gv,eyi:this.eK}=fa.Jlj(Qb,pc,this.gv,this.eK),tb&&tb.domElement.parentNode===this.Vk&&(this.Vk.removeChild(tb.domElement),this.oh.splice(Qb,1)),tb=this.lHh(xa),Qb=this.Oia(tb),tb=new za(this.$,this.Vk,this.TKa(Qb),Object(D.a)(ea.a,xa),this,this.vm,this.uw),this.Dpe(tb,Qb),Qb=this.Oia(xa),this.daf(Qb,!1,!this.vm)):tb=null;return tb}Wsh(){const xa=this.oh?
this.oh.length:0,tb=this.gv,Qb=this.eK;for(let pc=0;pc<xa;pc++){const hb=this.mQ(pc),ib=pc>=tb;hb&&(hb.tabIndex=ib&&pc<=Qb?0:-1)}}XYj(){const xa=this.oh?this.oh.length:0;for(let tb=0;tb<xa;tb++){const Qb=this.mQ(tb);Qb&&Qb.vgb()}}daf(xa,tb,Qb=!0){tb&&xa<=this.gv&&this.gv++;this.Wsh();this.bSa(!0);this.P_();this.D8b&&this.fF?this.IPb():Qb&&this.c0(6)}Vxc(xa){const tb=this.$.TI;if(xa||this.isRtl!==tb)this.isRtl=tb,this.domElement.classList.remove(this.isRtl?aa.a.XSe:aa.a.cTe),this.domElement.classList.add(this.isRtl?
aa.a.cTe:aa.a.XSe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.XYj();xa||this.bSa(!0);for(xa=0;xa<this.rK.length;xa++)0!==xa&&3!==xa&&(!this.vm||4!==xa&&5!==xa)&&this.w5f(xa)}Aeh(){const xa=this.pTd=document.createElement("div");xa.className=U.wyh;this.vm&&xa.classList.add(U.xyh);this.domElement.appendChild(xa);this.P5b(xa,1,716,715);this.P5b(xa,2,718,717);this.nmf&&(this.kSa=new Ja(this.$,this,xa));this.vm||this.P5b(xa,4,722,721)}Beh(){const xa=this.Tyc=document.createElement("div");xa.className=
U.yyh;this.domElement.appendChild(xa);this.vm||this.P5b(xa,5,724,723);this.d6c()}Ffh(){const xa=document.getElementById(r.a.zDj),tb=document.getElementById(r.a.ADj);xa&&!tb&&u.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${xa.parentNode.id}. progressBar div has child: ${!!xa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(r.a.fTd)}`);const Qb=x.a.tmf(this.$);if(Qb&&xa&&tb)this.domElement.appendChild(xa),
this.HMb=xa.firstChild,this.Uyc=document.getElementById(r.a.fTd),tb.style.visibility="visible";else{const pc=document.createElement("div"),hb=document.createElement("div");pc.className=aa.a.Hyh;hb.className=aa.a.Fyh;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(hb.id=r.a.Sdb);hb.style.display="none";const ib=document.createElement("div");ib.className=aa.a.Iyh;const Vb=document.createElement("div");Vb.className=aa.a.Gyh;const wc=document.createElement("div");wc.className=
aa.a.Eyh;hb.appendChild(ib);hb.appendChild(Vb);hb.appendChild(wc);pc.appendChild(hb);this.domElement.appendChild(pc);this.HMb=hb;this.Uyc=Vb;u.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Qb,xa,tb)}}w5f(xa){var tb=this.rK[xa];if(tb)if(this.uw){const Qb=tb.parentNode;this.vVf(tb);tb=ka.a(this.$)?this.fOf[xa]:this.mAd[xa];this.rK[xa]=
this.svgIconProvider.lba(tb,12,12,Qb,24,24)}else tb.className=this.kAd[xa]}vVf(xa){(null===xa||void 0===xa?0:xa.parentNode)&&xa.parentNode.removeChild(xa)}ach(){const xa=this.Vdb=document.createElement("div");xa.className=U.qyh;this.domElement.appendChild(xa);this.Jgh(xa)}Jgh(xa){const tb=document.createElement("div");tb.className=U.Kyh;tb.classList.add(U.ryh);this.$.printingEnabled||tb.classList.add(Y.a.jVe);xa.appendChild(tb);this.Vk=document.createElement("ul");ia.DOMElementExtensions.It(this.Vk,
r.a.kZc,null,null);this.Vk.className=Y.a.dTe;tb.appendChild(this.Vk);this.teh();this.Kje=document.createElement("div");this.Oyc.id="SheetIconTooltipContainer";tb.appendChild(this.Oyc)}teh(){const xa=document.createElement("div");var tb="<div class='"+aa.a.z5g+"'>{0}</div>";const Qb=wa.a.pfd(aa.a.Hzh,0,"55_16_N","");tb=String.format(tb,Qb);n.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(xa,tb):xa.innerHTML=tb;xa.className=U.Jyh;ia.DOMElementExtensions.setVisible(xa,!1);this.Ryc=xa;this.Vk.appendChild(xa)}w6c(){const xa=this.$.va;for(let tb=0,Qb=xa.count;tb<Qb;tb++){const pc=Object(D.a)(ea.a,xa.getItem(tb));0===pc.yB&&(this.V5b(pc,!0),pc.active&&pc.activate())}}y2c(){y.a.pc(this.oh);this.oh=[];this.eK=this.gv=0}P5b(xa,tb,Qb,pc){const hb=document.createElement("a");xa.appendChild(hb);xa=this.mAd[tb];this.rK[tb]=this.pb(hb,
E.a.instance.ga(pc),0,this.kAd[tb],E.a.instance.ga(Qb),xa);if(5===tb||4===tb)ia.DOMElementExtensions.JJ(this.rK[tb],hb,!1,"span").style.marginTop="10px";this.w5f(tb);Qb=this.lAd[tb]=this.ze.ie(hb);H.a.instance.ta(C.a.pointerDown,hb,Vb=>Vb.ctrlKey&&this.mQi(tb)?!0:this.JFf(tb));H.a.instance.ta(C.a.Kf,hb,()=>this.KFf());I.a.instance.ta(C.a.ve,hb,()=>this.KFf());H.a.instance.ta(C.a.pointerOut,hb,()=>this.q2c());R.KeyInputManager.instance.ta(C.a.Sb,hb,Vb=>13!==Vb.Ea.keyCode&&32!==Vb.Ea.keyCode||this.x4c?
!1:(this.x4c=!0,this.JFf(tb)));R.KeyInputManager.instance.ta(C.a.Kd,hb,Vb=>13===Vb.Ea.keyCode||32===Vb.Ea.keyCode?(this.x4c=!1,this.q2c()):!1);const ib=this.Pse();pc=Vb=>{"mouseup"===Vb.type&&this.hz&&this.fF||Ha.g(Vb);hb.classList.contains(P.a.VT)||(ib?this.tWi(Vb,tb):this.vm||this.LFf(Vb,tb))};Qb.ka("mouseover",pc);Qb.ka("mouseout",pc);Qb.ka("focus",pc);Qb.ka("blur",pc);ib&&Qb.ka("mouseup",pc)}iif(xa){let tb=!1;const Qb=this.$.rf;Qb&&(tb=S.a.UM(ia.DOMElementExtensions.getBoundingClientRect(Qb),
xa.clientPoint));return tb}qmf(xa){return S.a.UM(ia.DOMElementExtensions.getBoundingClientRect(this.domElement),xa.clientPoint)||this.iif(xa)}uHh(xa){let tb=null;const Qb=xa.clientPoint;let pc=this.gv;if(this.qmf(xa))for(pc=this.gv;pc<=this.eK;pc++)if(tb=this.mQ(pc))if(xa=ia.DOMElementExtensions.getBoundingClientRect(tb.domElement),!this.isRtl&&Qb.x<xa.x+xa.width||this.isRtl&&Qb.x>xa.x)break;return{returnValue:tb,nHj:pc>this.eK}}IPb(){if(this.hz){if(!this.oM){u.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.oM=this.gaa.cloneNode(!0);if(!this.n0f(this.oM,this.gaa,!0,"UpdateDragAndDropState"))return;this.gaa.style.visibility="hidden";this.oM.classList.add(U.Lyh);this.oM.style.borderRightWidth="";this.Mdc=this.FY.clientPoint.x-this.n3.width/2;this.oM.style.left=this.Mdc+"px";this.PC=this.Oia(this.l_);0>this.PC&&u.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.D8b&&(this.PC=this.Oia(this.l_));var xa=ia.DOMElementExtensions.getBoundingClientRect(this.Vk),
tb=xa.x;xa=xa.x+xa.width;let Qb=this.FY.clientPoint.x-this.n3.width/2;Qb=Math.min(Qb,xa-this.n3.width);Qb=Math.max(Qb,tb);this.oM.style.transform="translateX("+Math.abs(Qb-this.Mdc)*(this.Mdc<Qb?1:-1)+"px)";const pc=this.FY.clientPoint.x>this.DCb;let hb=this.FY.clientPoint.x;Qb>=xa-this.n3.width?(hb=xa-this.n3.width/2,this.FPd()||this.Fma||(u.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Pqc=
this.Vk.scrollLeft,this.Fma=window.requestAnimationFrame(this.Q1f))):Qb<=tb?(hb=tb+this.n3.width/2,this.EPd()||this.Fma||(u.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Pqc=this.Vk.scrollLeft,this.Fma=window.requestAnimationFrame(this.P1f))):this.Fma&&(u.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.SWd());
this.FY.clientPoint.x!==this.DCb&&(this.EXd(pc,hb),this.DCb=this.FY.clientPoint.x)}else(xa=({nHj:tb}=this.uHh(this.FY)).returnValue)?this.$Ud(xa.sheet,tb):this.kcf();this.CNc=!0}EXd(xa,tb){let Qb;for(;({R2b:Qb}=this.tph(tb,xa)).returnValue;)this.mOb=Qb,this.bRg(xa)}bRg(xa){if(this.mOb){var tb=(xa?1:-1)*this.n3.width;if(xa&&!this.$.TI||!xa&&this.$.TI){var Qb=this.gaa;var pc=this.PC+1;var hb=!0}else Qb=(pc=this.mQ(this.PC+1))?pc.domElement:null,pc=this.PC-1,hb=!1;if(this.n0f(this.mOb,Qb,hb,"AnimateSheetSwap")){u.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.PC} and other sheet-index ${pc}. amount of sheets in the bar: ${this.nTd} isMovingRight: ${xa}`);0<=this.PC&&this.PC<this.oh.length&&0<=pc&&pc<this.oh.length?(xa=this.oh[pc],this.oh[pc]=this.oh[this.PC],this.oh[this.PC]=xa):(u.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.oh.length}, ghostIndex: ${this.PC}, swappedSheetIndex: ${pc}`),this.QP());this.PC=
pc;var ib=this.mOb;ib.style.transform="translateX("+tb+"px)";window.requestAnimationFrame(()=>{ib.style.transform="translateX(0px)"})}}}n0f(xa,tb,Qb,pc){const hb=ib=>ib?`Node ID: ${ib.id} , Node class: ${ib.className}, Node name: ${ib.nodeName},`:null;try{return this.Vk.insertBefore(xa,tb),!0}catch(ib){return xa=this.i3a(this.l_),u.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
xa?xa!==this.v8b?"Changed":"NoChange":"Removed",pc,hb(tb),hb(tb.parentNode),hb(this.Vk),Qb,this.PC,this.nTd,ib),this.QP(),!1}}tph(xa,tb){var Qb=this.$.TI===tb?this.mQ(this.PC-1):this.mQ(this.PC+1);if(!Qb)return{returnValue:!1,R2b:null};Qb=Qb.domElement;const pc=ia.DOMElementExtensions.getBoundingClientRect(Qb);return this.n3?tb?{returnValue:xa+this.n3.width/2>=pc.x+.5*pc.width,R2b:Qb}:{returnValue:xa-this.n3.width/2<=pc.x+.5*pc.width,R2b:Qb}:(u.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.QP(),{returnValue:!1,R2b:Qb})}M1f(xa,tb){let Qb;Qb=tb?this.Q1f:this.P1f;if(-1===this.DAc)this.DAc=xa,this.Fma=window.requestAnimationFrame(Qb);else{xa=Math.floor((xa-this.DAc)/1E3*300);var pc=this.MKb>this.gDb?1:-1;this.scrollLeft(Math.abs(this.Vk.scrollLeft-(tb?this.Pqc+xa*pc:this.Pqc-xa*pc))*(tb?-1:1));if(xa=this.m3e("ScrollStep"))this.EXd(tb,xa.x+xa.width/2),tb&&!this.FPd()||!tb&&!this.EPd()?this.Fma=window.requestAnimationFrame(Qb):(u.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.SWd())}}FPd(){const xa=this.MKb>this.gDb;return xa&&this.lna>=this.MKb||!xa&&this.lna<=this.MKb}EPd(){const xa=this.MKb>this.gDb;return xa&&this.lna<=this.gDb||!xa&&this.lna>=this.gDb}SWd(xa=!0){this.Vk&&(this.lna=this.Vk.scrollLeft);window.cancelAnimationFrame(this.Fma);this.Fma=0;this.DAc=-1;xa&&this.P_()}kRd(xa,tb){xa||u.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${tb}`);this.n3=xa}mQi(xa){return 2===xa?(this.c0(3),
!0):1===xa?(this.c0(0),!0):!1}JFf(xa){u.ULS.shipAssertTag(537153732,0,-1===this.IPa&&-1===this.HPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.IPa&&(window.clearTimeout(this.IPa),this.IPa=-1);-1!==this.HPa&&(window.clearInterval(this.HPa),this.HPa=-1);this.c0(xa);this.IPa=window.setTimeout(()=>{this.oNj(xa)},this.VJi);return!0}oNj(xa){this.HPa=window.setInterval(()=>{this.c0(xa)},this.UJi)}KFf(){this.q2c();
return!this.hz||!this.fF}q2c(){window.clearTimeout(this.IPa);window.clearInterval(this.HPa);this.HPa=this.IPa=-1;return!0}LFf(xa,tb){const Qb=this.kAd[tb];Da.HelperMethods.SYd(this.rK[tb],Qb,Qb+r.a.rfc,"mouseover"===xa.type||"focus"===xa.type)}tWi(xa,tb){const Qb=this.bic(tb),pc=5===tb;if("mouseup"===xa.type){if(pc||4===tb)Qb||this.reorderSheets(null,pc,!1),this.QP()}else!this.hz&&this.fF?(Qb||this.$Ud(this.t7e(pc?this.eK:this.gv),pc),this.c0(pc?2:1)):this.vm||this.LFf(xa,tb)}bic(xa){return!!ia.DOMElementExtensions.rgd(this.rK[xa],
"a").title}pEc(xa){this.Q0d(xa);this.P_()}Q0d(xa){(xa=this.i3a(xa))&&xa.vgb()}IPd(){var xa=this.$.va;if(xa.na&&(!ma.e(this.$)||xa.count))if(xa=this.Oia(xa.na),-1===xa)u.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var tb=this.TKa(xa);xa<this.gv?this.Nwc(xa):xa>this.gv&&!this.qtd(tb)&&this.scrollIntoView(xa)}}m_j(){this.gv=0;this.eK=this.oh.length-1;let xa=!1;for(let tb=0;tb<this.oh.length;tb++){const Qb=this.mQ(tb);if(!Qb)break;
const pc=this.qtd(Qb.domElement);Qb.tabIndex=pc?0:-1;if(!xa&&pc)this.gv=tb,xa=!0;else if(xa&&!pc){this.eK=tb-1;break}}}Nwc(xa){this.$.va.count&&(this.oh.length||this.w6c(),this.H3f(this.TKa(Math.max(0,Math.min(xa,this.oh.length-1)))),this.P_())}scrollIntoView(xa){u.ULS.shipAssertTag(537153697,0,xa>=this.gv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.va.count){this.oh.length||this.w6c();var tb=this.TKa(Math.max(0,Math.min(xa,
this.oh.length-1))),Qb=this.TKa(this.gv);if(!this.qtd(tb)){tb=ia.DOMElementExtensions.getBoundingClientRect(tb);var pc=ia.DOMElementExtensions.getBoundingClientRect(this.Vdb);tb=this.isRtl?pc.x-tb.x:tb.x+tb.width-(pc.x+pc.width);for(pc=0;Qb&&pc<tb;){const hb=ia.DOMElementExtensions.getBoundingClientRect(Qb);pc+=hb.width;Qb=Qb.nextSibling}Qb?this.H3f(Qb):u.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.gv}, lastVisibleSheetTabIndex = ${this.eK}, scroll to index: ${xa}`)}this.P_()}}H3f(xa){const tb=
ia.DOMElementExtensions.getBoundingClientRect(this.Vk);xa=ia.DOMElementExtensions.getBoundingClientRect(xa);this.isRtl?this.scrollLeft(Math.floor(tb.x+tb.width-(xa.x+xa.width+.5))):this.scrollLeft(Math.ceil(tb.x-xa.x-.5))}scrollLeft(xa){(0>xa&&this.FPd()||0<xa&&this.EPd())&&u.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const tb=this.Vk.scrollLeft;if(this.isRtl){if(z.a.gF||z.a.Cf){this.Vk.scrollLeft=this.lna=tb-xa;
return}if(z.a.rH){this.Vk.scrollLeft=this.lna=tb+xa;return}u.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Vk.scrollLeft=this.lna=tb-xa}qtd(xa){xa=ia.DOMElementExtensions.getBoundingClientRect(xa);const tb=ia.DOMElementExtensions.getBoundingClientRect(this.Vdb);return xa&&tb?xa.x>=tb.x-1&&xa.x+xa.width<=tb.x+tb.width+1:(u.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Veh(){const xa=
this.Tyc;if(Q.a8f(this.$))this.vm?(y.a.Ja(this.kH),this.kH=new Q(xa,this.$,this,!0)):(y.a.Ja(this.kH),this.kH=null);else if(!this.kH||this.vm)y.a.Ja(this.kH),Z.k(this.$.dg)?this.kH=new Ra(xa,this.$,this):this.kH=new Q(xa,this.$,this)}qIe(xa,tb){var Qb=this.$.va;if(!this.$.isEditMode||!Qb.count)y.a.Ja(tb),tb=null;else if(!tb)if(Qb=this.vm?this.pTd:this.Tyc,Z.k(this.$.dg))tb=new Ra(Qb,this.$,this);else switch(xa){case 0:tb=new Q(Qb,this.$,this);break;case 1:tb=new va(Qb,this.$,this);break;default:u.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return tb}d6c(){this.Upi?(this.kH=this.qIe(0,this.kH),this.Kzb=this.qIe(1,this.Kzb)):this.Veh()}m3e(xa){const tb=ia.DOMElementExtensions.getBoundingClientRect(this.oM);tb||(u.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${xa}: GetBoundingClientRect returned null for the dragged sheet.`),this.QP());return tb}V$e(xa,
tb){this.Hta.iSg(xa,tb);this.QP(!1);this.TRd(this.navigationButtonsDisabled);for(const Qb of this.ZPj)Qb&&Qb.$R(this.navigationButtonsDisabled);for(const Qb of this.Owe)Qb&&Qb.$R(this.operationButtonsDisabled)}static Jlj(xa,tb,Qb,pc){xa<Qb?(tb>Qb&&Qb--,tb>pc&&pc--):xa>pc?(tb<Qb&&Qb++,tb<pc&&pc++):tb<Qb&&Qb++;return{$Hh:Qb,eyi:pc}}}Object(t.a)(fa,"SheetTabBarControl",N.a,[428,2,28]);class eb extends v.a{constructor(xa){super();this.$=xa;this.Db()}create(){const xa=this.$.Bb;if(A.a(this.$.ya,1))$a.PageLoadTrackingInfo.instance.wda(r.a.LAa,
["sheetTabBar"]);else{var tb=document.getElementById(xa+r.a.D7c);if(tb){n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&$a.PageLoadTrackingInfo.instance.xAa(r.a.LAa);var Qb=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")?e.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):h.Task.Ra(null),pc=x.a.Bsd()?e.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Xa):
h.Task.Ra(null);f.TaskExtensions.za(f.TaskExtensions.Fd([pc,Qb],this.$.la),()=>{this.nb(this.$.da.Aa(32)||new fa(this.$,tb,pc.result,Qb.result))},this.$.la,3)}else $a.PageLoadTrackingInfo.instance.wda(r.a.LAa,["sheetTabBar"])}}static ka(xa){xa.da.Ha(33,new eb(xa))}}Object(t.a)(eb,"SheetTabBarFactory",v.a,[]);a.d(F,"a",function(){return ua});const ua=()=>{c.a.Fa(xa=>{eb.ka(xa);l.ka(xa)})}},1179:function(t,F,a){var c=a(9),b=a(1);t=a(0);var e=a(226),f=a(15),d=a(31),h=a(5),m=a(12),l=a(22),v=a(13),r=a(258),
A=a(21),x=a(30);class n{constructor(ba){this.rwc=ba||""}static get iPe(){return n.M8d||(n.M8d=new n(""))}static get qxd(){return n.Ode||(n.Ode=n.Xdd(2).rwc)}static C3a(ba){ba=x.a.yg(ba||"");return new n(ba)}static Nac(ba){return n.C3a(v.a.instance.ga(ba))}static Xdd(ba){return new n(v.a.instance.Ta(ba))}static AKh(ba,...ka){return n.zKh(v.a.instance.ob(ba),...ka)}static zKh(ba,...ka){const Ca=ka.length,db=Array(Ca);for(let yb=0;yb<Ca;yb++)db[yb]=(ka[yb]||n.iPe).rwc;return new n(String.format(ba,db))}}
n.M8d=null;n.Ode=null;Object(t.a)(n,"SafeHtml",null,[420]);const u=(ba,ka)=>{ka&&(ba.append(ka),ba.append(n.qxd))};var z=a(52);class w{constructor(ba,ka,Ca,db=null){this.WAf=(yb,kb)=>{this.ORf(kb.Sd.command)};this.krf=()=>{if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&!this.$.ea.Xb){var yb={};yb.a=this.$.ya.UserSessionId;yb.b=this.E5i;yb.c=this.pQg;yb.d=this.HTj;z.b().Llc(60,yb)}};this.$=ba;this.htmlSanitizationHelper=db;this.Rea=document.createElement("div");
this.Rea.setAttribute(h.a.n2,h.a.Uj);this.Rea.className=d.a.nad;ka.insertBefore(this.Rea,Ca);this.$fa=document.createElement("div");this.$fa.setAttribute(h.a.n2,h.a.Uj);this.$fa.className=d.a.nad;ka.insertBefore(this.$fa,this.Rea);this.aAg=v.a.instance.Ta(2);this.q2=document.createElement("div");this.q2.setAttribute(h.a.Cd,h.a.fsa);this.q2.setAttribute(h.a.hsa,h.a.gpb);this.q2.className=d.a.nad;ka.insertBefore(this.q2,this.$fa);this.Cle=this.E4d=this.Uge=0;this.register();this.$.da.Ha(211,this)}get Jxa(){return this.aAg}get isActive(){return!0}get activeCell(){return A.h(this.$).Qb(null)}get lsd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}get E5i(){return this.Uge}get pQg(){return this.E4d}get HTj(){return this.Cle}dispose(){this.$&&this.unregister();m.DOMElementExtensions.vf(this.q2);m.DOMElementExtensions.vf(this.Rea);m.DOMElementExtensions.vf(this.$fa);this.$fa=this.Rea=this.q2=this.$=null}setEnabled(ba){this.s4f(this.$fa,ba)}Vxj(){this.s4f(this.Rea,!0)}readText(ba){this.LIb(n.C3a(ba),!0)}cQa(ba){this.LIb(n.C3a(ba),!1)}RRf(ba,ka){if(1>
ka||!ba)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ca=new Sys.StringBuilder;ba=String.format(v.a.instance.ob(34),ka,ba);u(Ca,ba);u(Ca,v.a.instance.ga(855));this.LIb(n.C3a(Ca.toString()),!1)}}Ncj(ba,ka,Ca){if(1>Ca||1>ka||ka>Ca||!ba)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var db=new Sys.StringBuilder;u(db,ba);db.append(String.format(v.a.instance.ob(55),ka,Ca));this.LIb(n.C3a(db.toString()),!1)}}ORf(ba){ba=this.Q1h(ba);this.LIb(ba,
!1)}LIb(ba,ka){if(ba=ba?ba.rwc:null)ka=ka?this.$fa:this.Rea,l.a.equals(ka.innerHTML,ba,!1)&&(ba+=n.qxd),this.Nfg(ka),this.lsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(ka,ba):ka.innerHTML=ba}Abb(ba,ka){this.q2.getAttribute(h.a.hsa)!==ka&&this.q2.setAttribute(h.a.hsa,ka);ba=ba?n.C3a(ba).rwc:"";this.Nfg(this.q2);this.lsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(this.q2,ba):this.q2.innerHTML=ba}Ocj(ba,ka,Ca,db){const yb=v.a.instance.ob(54);f.ULS.shipAssertTag(537153949,
0,!(void 0===ba||null===ba));f.ULS.shipAssertTag(537153948,0,!(void 0===ka||null===ka));f.ULS.shipAssertTag(537153947,0,!(void 0===Ca||null===Ca));f.ULS.shipAssertTag(537153946,0,!(void 0===db||null===db));f.ULS.shipAssertTag(537153945,0,!(void 0===yb||null===yb));ba=String.format(yb,ba||"",ka||"",Ca||"",db||"");this.Abb(ba,h.a.BGa)}aZj(ba){var ka=this.$fa.style;ba?(ba=r.a.i2b(ba.cell,ka),ka=ba.BB,ka.top=ka.left=ka.bottom=ka.right=null,ba.l2()):ka.cssText=""}Q1h(ba){switch(ba){case -1985798686:return n.Nac(12);
case -911352779:return n.Nac(11);case 237279923:return n.Nac(13);case -1502853784:return n.Xdd(81);case -111689794:return n.Xdd(78);case -287251124:return this.vid(1331,ka=>ka.bold);case -1925065947:return this.vid(1332,ka=>ka.italic);case 1764140053:return this.vid(1333,ka=>ka.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&
this.$.Ia.WFa(this.WAf),this.$.ea&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&this.$.ea.lA(this.krf))}unregister(){this.$&&(this.$.Ia.Tza(this.WAf),b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&this.$.ea.rB(this.krf))}s4f(ba,ka){const Ca=ba===this.Rea;ka?(ba.setAttribute(h.a.hsa,h.a.BGa),Ca&&ba.setAttribute(h.a.Cd,h.a.fsa),ba.setAttribute(h.a.n2,h.a.pq),ba.removeAttribute(h.a.n2),this.lsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(ba,
ba.innerHTML+" "):ba.innerHTML+=" "):(ba.removeAttribute(h.a.hsa),Ca&&ba.removeAttribute(h.a.Cd),ba.setAttribute(h.a.n2,h.a.Uj))}vid(ba,ka){const Ca=this.activeCell;if(!Ca)return null;const db=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),yb=[7,8];ka=ka(Ca)?!0:!1;return n.AKh(db?yb[+ka]:yb[+!ka],n.Nac(ba))}Nfg(ba){b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&("polite"===ba.hTg&&this.Uge++,"alert"===ba.role&&this.E4d++,
this.Cle++)}}Object(t.a)(w,"AriaLiveNotifier",null,[402,377,2]);var C=a(50),y=a(37);class B extends e.a{constructor(ba){super();this.$=ba;this.Db()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const ba=C.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);y.TaskExtensions.za(y.TaskExtensions.Fd([ba],this.$.la),()=>{this.nb(this.$.da.Aa(211)||new w(this.$,this.$.eu,
this.$.rf,ba.result))},this.la,3)}else this.nb(this.$.da.Aa(211)||new w(this.$,this.$.eu,this.$.rf))}static ka(ba){ba.da.Ha(212,new B(ba))}}Object(t.a)(B,"AriaLiveNotifierFactory",e.a,[]);var H=a(27),I=a(217),R=a(133),S=a(64);class G{constructor(ba,ka){this.O_=this.dW=this.IN=null;this.aja=ka;this.Wfh(ba);this.G7i();b.EwaSettings.vb()&&ba.da.Ha(244,this)}get isActive(){return!!this.aja&&document.activeElement===this.aja}readText(ba){ba=String.format(v.a.instance.ob(30),ba);this.IN.setAttribute(h.a.Vu,
ba);this.dW.setAttribute(h.a.Vu,ba);this.JPj()}dispose(){this.O_&&this.O_.parentNode&&this.O_.parentNode.removeChild(this.O_);this.dW=this.IN=this.O_=this.aja=null}Wfh(ba){var ka=ba.Bb+"readoutElementWrapper";const Ca=ba.Bb+"readoutElement1",db=ba.Bb+"readoutElement2";this.O_=document.getElementById(ka);this.O_||(this.O_=document.createElement(I.a.div),this.O_.id=ka,this.IN=document.createElement(I.a.label),this.IN.id=Ca,this.IN.setAttribute(R.a.contentEditable,S.a.yQb),this.IN.setAttribute(h.a.Cd,
h.a.LZa),this.dW=document.createElement(I.a.label),this.dW.id=db,this.dW.setAttribute(R.a.contentEditable,S.a.yQb),this.dW.setAttribute(h.a.Cd,h.a.LZa),this.IN.style.width="0px",this.IN.style.height="0px",this.dW.style.width="0px",this.dW.style.height="0px",this.IN.tabIndex=-1,this.dW.tabIndex=-1,this.O_.appendChild(this.IN),this.O_.appendChild(this.dW),ba=ba.Bb+h.a.S4b,ka=document.getElementById(ba),f.ULS.shipAssertTag(537153942,3,!!ka,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${ba}`),
ka&&ka.appendChild(this.O_))}G7i(){this.aja&&this.IN&&this.dW&&(this.aja.setAttribute(h.a.gY,this.IN.id),this.aja.setAttribute(h.a.b1b,`${this.IN.id} ${this.dW.id}`))}JPj(){if(this.isActive){let ba="";m.DOMElementExtensions.hasAttribute(this.aja,h.a.gY)&&(ba=this.aja.getAttribute(h.a.gY).toString());this.aja.setAttribute(h.a.gY,ba===this.IN.id?this.dW.id:this.IN.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static P6a(){if(null==G.Bvb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!H.a.YMa)G.Bvb=!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(G.Bvb=!1,H.a.rH||H.a.Cf)G.Bvb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return G.Bvb}static ka(ba){G.P6a()&&ba.da.Ha(244,new G(ba,A.h(ba).mc.textBox.Ie))}}G.Bvb=null;Object(t.a)(G,"FocusBasedReadout",null,[377,2]);class D extends e.a{constructor(ba){super();
this.$=ba;this.Db()}create(){G.P6a()?A.h(this.$).mc.textBox.oP(()=>{const ba=this.$.da.Aa(244)||new G(this.$,A.h(this.$).mc.textBox.Ie);this.nb(ba)}):this.nb(null)}static ka(ba){ba.da.Ha(315,new D(ba))}}Object(t.a)(D,"FocusBasedReadoutFactory",e.a,[]);var E=a(7),M=a(89),L=a(84);const N=ba=>{switch(ba){case 1:return 1454;case 2:return 1455;case 3:return 1456;case 4:return 1457;case 5:return 1458;case 6:return 1459;case 7:return 1460;case 8:return 1461;case 9:return 1462;case 10:return 1463;case 11:return 1464;
case 12:return 1465;case 13:return 1466;case 14:return 1467;case 15:return 1468;case 16:return 1469;case 17:return 1470;case 18:return 1471;case 19:return 1472;case 20:return 1473;case 21:return 1474;case 22:return 1477;case 23:return 1475;case 24:return 1476;case 25:return 1478;case 26:return 1479;case 27:return 1480;case 28:return 1481;default:return 1482}};var Y=a(24),U=a(41),P=a(216),aa=a(48),X=a(44),Z=a(124);class da{static get Dbj(){return da.zhe||(da.zhe=RegExp("([A-Z]+)","g"))}static get Cbj(){return da.yhe||
(da.yhe=RegExp("([A-Z])","g"))}static get F3g(){return da.h6d||(da.h6d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static fid(ba){return da.j6e(ba.toString())}static j6e(ba){return da.F3g.test(ba)?ba.replace(da.Dbj,"$1 ").replace(da.Cbj,' "$1"').trim():ba}static fmj(ba){const ka=ba.lastIndexOf("!");return ba.substring(0,-1<ka?ka+1:0)+da.j6e(ba.substring(-1<ka?ka+1:0,ba.length))}}da.zhe=null;da.yhe=null;da.h6d=null;Object(t.a)(da,
"RangeAriaExtensions",null,[]);class qa{constructor(){this.activeItemName=null;this.$lf=!1;this.tableName=null;this.y0a=0;this.uBc=!1}}Object(t.a)(qa,"SelectionReadoutState",null,[]);a(65);var O=a(68);class ca{constructor(ba,ka,Ca,db,yb){this.gridReadoutNotifier=null;this.ubb=!1;this.zsa=this.spb=null;this.eda=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
A.h(this.$).fb||this.h1b.Xp()};this.gNi=()=>{if(!A.h(this.$).ha.Sa.Krd){var kb,mb=({activeCell:kb}=this.INh()).returnValue;this.readText(mb,kb)}};this.kp=()=>{const kb=this.activeCell;this.readText("Editing",kb);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||kb&&kb.zec&&!A.h(this.$).Baf||this.h1b.cancel()};this.Uc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.eda(),this.ubb&&A.h(this.$).inRangePicker&&1===O.a.zb&&(null===this.spb?this.spb=aa.a.instance.create(this.HJd,ca.HVc,"readSelectedRanges"):this.spb.Xp()))};this.$=ka;this.ariaLiveNotifier=ba;this.sparklineManager=db;this.tableManager=Ca;this.qD=new qa;this.P6a=G.P6a();this.ubb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.P6a&&(b.EwaSettings.vb()?this.gridReadoutNotifier=yb:this.gridReadoutNotifier=ka.da.Aa(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),ca.HVc=b.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.IncreaseActiveCellCallbackDelayForBraille",1200));this.h1b=aa.a.instance.create(this.gNi,ca.HVc,X.a.yuj,!1);this.Aj()}get activeCell(){return A.h(this.$).Qb(null)}dispose(){this.$&&this.Sj();M.a.Ja(this.h1b);this.sparklineManager=this.$=this.h1b=null}R0e(ba,ka,Ca=!0){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&this.$.qb.tv&&
null!==this.$.qb.$g&&null!==this.$.qb.$g.kc&&"FindAndReplaceDialog"===this.$.qb.$g.kc||!ba)return"";var db=this.$.da;const yb=new Sys.StringBuilder;this.XRg(yb,ba,ka);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var kb=this.tableManager.Gja(ba.range);(null===kb||void 0===kb?0:kb.xUd)&&this.Qte(yb,kb);kb=this.tableManager.Mp(ba.range);(null===kb||void 0===kb?0:kb.$ja)&&this.Qte(yb,kb)}kb=ba.Yaa?this.L3e(ba):ba.text;u(yb,kb);kb=this.$.activeItemName;this.qD.activeItemName!==
kb&&(u(yb,kb),this.qD.activeItemName=kb);kb=1===ka.length?U.K(ka).isSingle?"":v.a.instance.ga(851):String.format(v.a.instance.ob(31),ka.length);u(yb,kb);for(var mb of ka)u(yb,da.fid(mb)),1===ka.length&&ca.vvi(mb)&&(kb=A.h(this.$).Ca.Ur(mb.bottomRight),void 0!==kb&&null!==kb&&kb.text&&(kb=kb.Yaa?this.K3e(kb,kb.text):kb.text,u(yb,kb)));mb=ba.cell;mb=this.j_h(mb.Nqj,mb.C6g);u(yb,mb);this.GRg(yb,ba);Ca&&(ba.s7a?u(yb,v.a.instance.ga(839)):ba.Zwa&&u(yb,v.a.instance.ga(840)));if(ba.hasAutoFilter||ba.i4)this.YRg(yb,
ba.hasAutoFilter?ba.cell.autoFilterType:ba.cell.b5i),Ca&&u(yb,v.a.instance.ga(842));P.c(this.$,ba.range)&&u(yb,v.a.instance.ga(846));this.DRg(yb,ba);Ca=(Ca=db.Aa(14))?Ca.LOh():"";u(yb,Ca);ba.OA&&(Ca=A.h(this.$).Ca.Ur(ba.range),Ca=!!Ca&&Ca.hasIgnorableError,ca.YDj(ba)?ca.ERg(yb,ba):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Ca?u(yb,v.a.instance.ga(844)):u(yb,v.a.instance.ga(843)));ba.JM&&(u(yb,v.a.instance.ga(845)),ba.ryb&&u(yb,String.format(v.a.instance.ob(16),
ba.Zih)),u(yb,ba.iconName));ba.hasRichValueIcon&&(mb=this.$.da.Aa(271),Ca="",mb&&ba.cell.lqf&&(mb=mb.iU(ba.cell.lqf))&&mb.DomainId.Id!==ca.d6j&&(Ca=mb.Name),ba.cell.uli?(u(yb,String.format(v.a.instance.ob(187),Ca)),u(yb,v.a.instance.ga(1809))):(u(yb,String.format(v.a.instance.ob(185),Ca)),u(yb,v.a.instance.ga(1808))));this.Rai(ba)&&u(yb,ca.IVh(ba));(db=db.Aa(231))&&u(yb,db.X3e(ka,!0));1===ka.length&&ka[0].isSingle&&ca.XDj(ba,ka[0],this.$)&&(ka=this.$.da.Aa(271))&&u(yb,ka.WOh());ba.bPb&&ba.cPb&&u(yb,
ba.cPb);(ka=ba.cell.r2g)&&u(yb,ka);ba.LMa&&ba.KHb&&(ba=ba.iGd)&&(u(yb,v.a.instance.ga(1982)),u(yb,ba));return yb.toString()}eze(ba){this.zsa=this.qD;this.qD=Object(E.a)(new qa,{activeItemName:this.zsa.activeItemName,uBc:ba?this.zsa.uBc:!1,tableName:ba?this.zsa.tableName:"",y0a:ba?this.zsa.y0a:-1})}KZf(){this.zsa&&(this.qD=this.zsa,this.zsa=null)}j_h(ba,ka){return 2===ba||2===ka?v.a.instance.ga(873):1===ba||1===ka?v.a.instance.ga(874):""}L3e(ba){return this.K3e(ba.cell,ba.text)}XRg(ba,ka,Ca){if(Ca&&
1===Ca.length&&Ca[0].isSingle){Ca="";var db=this.tableManager.Gja(ka.range);if(db){Ca=db.pivotTableName;this.HYc(ba,Ca);var yb=db.Dhc?v.a.instance.ga(834):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(yb+=(db.altText?db.altText+" . ":"")+(db.altTextSummary?db.altTextSummary:""));this.Ste(ba,!0,Ca,yb);u(ba,this.tableManager.gti(db,ka.range)?v.a.instance.ga(836):"");u(ba,this.tableManager.Qmi(db,ka.range)?v.a.instance.ga(835):"")}else if(db=this.tableManager.Mp(ka.range)){Ca=
(yb=A.h(this.$).wb.zi(ka.range))?yb.name:"";this.HYc(ba,Ca);let kb="";yb&&(kb=(yb.pTa?yb.pTa+" . ":"")+(yb.qTa?yb.qTa:""));this.Ste(ba,!1,Ca,kb);u(ba,this.tableManager.Xif(db,ka.range)?v.a.instance.ga(835):"")}else this.HYc(ba,Ca),this.qD.tableName="",this.qD.y0a=-1}}HYc(ba,ka){ka!==this.qD.tableName&&this.qD.tableName&&(ba.append(v.a.instance.ga(this.qD.uBc?833:832)),u(ba," "+this.qD.tableName))}Ste(ba,ka,Ca,db){Ca!==this.qD.tableName&&(ba.append(v.a.instance.ga(ka?831:830)),u(ba," "+Ca),u(ba,db),
this.qD.tableName=Ca,this.qD.uBc=ka,this.qD.y0a=-1)}Qte(ba,ka){const Ca=A.h(this.$).ha.qa.activeCell;if(Ca.top!==ka.top&&Ca.left!==this.qD.y0a){ba.append(v.a.instance.ga(835));ka=new Y.Range(ka.top,Ca.left,ka.top,Ca.left,!0,!0);u(ba,da.fid(ka));if(ka=A.h(this.$).Qb(ka))ka=ka.Yaa?this.L3e(ka):ka.text,u(ba,ka);this.qD.y0a=Ca.left}}K3e(ba,ka){const Ca=ba.H5a;return ba.Rva?String.format(v.a.instance.ob(14),ka,Ca):String.format(v.a.instance.ob(13),ka,da.fmj(Ca))}Aj(){f.ULS.shipAssertTag(537153930,0,!!this.$,
"Can't register to ewaControl's events");if(this.$){var ba=A.h(this.$);f.ULS.shipAssertTag(537153929,0,!!ba,"Can't register to grid's events");ba&&(ba.Vb.xl(this.kp),ba.Ca.Rv(this.eda),ba.gE(this.eda),this.ubb&&ba.Vb.Jm(this.$f.bind(this)),ba=ba.ha,f.ULS.shipAssertTag(537153928,0,!!ba,"Can't register to selectionManager's events"),ba&&(ba.cC(this.Uc),ba.wG(this.eda),ba.Sa.h2(this.eda),this.ubb&&(this.HJd=this.HJd.bind(this))))}}Sj(){if(this.$){var ba=A.h(this.$);ba&&(ba.Vb.nl(this.kp),ba.Ca.Mw(this.eda),
ba.yF(this.eda),this.ubb&&ba.Vb.$l(this.$f),ba=ba.ha)&&(ba.sB(this.eda),ba.EK(this.eda),ba.Sa.Vma(this.eda))}}readText(ba,ka){this.P6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(ba):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(ba),this.ubb&&!ka||this.ariaLiveNotifier.aZj(ka))}$f(){this.spb&&this.spb.cancel()}HJd(){this.readText(this.C2h())}C2h(){let ba=
"";A.h(this.$).ha.rangePicker.yK.forEach(()=>{ba+=void 0});return ba+=" selected"}INh(){let ba;ba=null;var ka=A.h(this.$).ha;if(1!==ka.Oe&&!ka.Sa.dc)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ka.Oe} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:ba};switch(ka.Oe){case 2:return{returnValue:this.NQh(ka),activeCell:ba};case 64:var Ca=ka.Sa.dc.floatingObject,db="";if(ka=ka.Sa.dc.As||ka.Sa.dc.Hd)db=(db=ka.firstChild)?m.DOMElementExtensions.getTextContent(db):
"";return{returnValue:String.format(v.a.instance.ob(53),ca.cbc(Ca.altText,Ca.altTextDescription,Ca.name),db,Ca.altTextDescription),activeCell:ba};case 4:return{returnValue:ca.PQg(ka.Sa.dc.floatingObject),activeCell:ba};case 512:return{returnValue:Z.a.q2e(ka.Sa.dc.floatingObject.q9c),activeCell:ba};case 8:return Ca=(Ca=ka.Sa.dc.floatingObject)?Ca.name:"",{returnValue:String.format(v.a.instance.ob(51),Ca),activeCell:ba};case 1:return ba=this.activeCell,{returnValue:this.R0e(ba,ka.qa.selectedRanges),
activeCell:ba}}return{returnValue:"",activeCell:ba}}NQh(ba){const ka=new Sys.StringBuilder;ka.append(ca.X2g(ba));const Ca=this.$.da.Aa(231);Ca&&u(ka,Ca.X3e(ba.Sa.dc.floatingObject,!1));return ka.toString()}Rai(ba){ba=ba.Xgf();let ka=!1;this.qD.$lf!==ba&&(this.qD.$lf=ba,ka=!0);return ka}GRg(ba,ka){if(ka.Byb)if(ka=this.sparklineManager.z3h(ka)){var Ca=v.a.instance,db=Ca.ga;a:switch(ka.type){case 0:var yb=827;break a;case 1:yb=828;break a;default:yb=829}Ca=db.call(Ca,yb);u(ba,String.format(v.a.instance.ob(25),
Ca));ka=String.format(v.a.instance.ob(24),da.fid(ka.bMj));u(ba,ka)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),u(ba,String.format(v.a.instance.ob(25),""))}YRg(ba,ka){switch(ka){case 1:case 11:u(ba,v.a.instance.ga(847));break;case 6:u(ba,v.a.instance.ga(847));u(ba,v.a.instance.ga(849));break;case 7:u(ba,v.a.instance.ga(847));u(ba,v.a.instance.ga(850));break;case 2:u(ba,v.a.instance.ga(848));u(ba,v.a.instance.ga(849));break;case 3:u(ba,v.a.instance.ga(848));
u(ba,v.a.instance.ga(850));break;default:u(ba,v.a.instance.ga(848))}}DRg(ba,ka){var Ca;const db=this.$.da.Aa(65);ka=db?db.mKa(ka.range):null;let yb="";const kb=Object(L.a)(396,ka);if(ka)yb=!ka.X6a&&kb&&kb.Vui?String.format(v.a.instance.ob(29),kb.AQj):String.format(v.a.instance.ob(23),ka.author);else if(null===(Ca=null===db||void 0===db?void 0:db.Qm)||void 0===Ca?0:Ca.UE)yb=String.format(v.a.instance.ob(28),db.Qm.kN.author);u(ba,yb)}static PQg(ba){return String.format(v.a.instance.ob(52),ca.cbc(ba.altText,
ba.altTextDescription,ba.name),ba.altTextDescription)}static IVh(ba){return v.a.instance.ga(ba.Xgf()?837:838)}static cbc(ba,ka,Ca){return ba||ka?ba:Ca}static X2g(ba){var ka=ba.Sa.dc;ba=ka.floatingObject;const Ca=ba.Wc,db=Ca.ChartTitle,yb=ba.altText,kb=ba.altTextDescription,mb=!!(Ca.Attributes&4);return(ka=ka.getSelectionDescription())?ka:Ca.DataRangeForDisplay?String.format(v.a.instance.ob(mb?49:47),ca.cbc(yb,kb,ba.name),kb,db,v.a.instance.ga(N(Ca.ChartCategory)),Ca.DataRangeForDisplay):String.format(v.a.instance.ob(mb?
50:48),ca.cbc(yb,kb,ba.name),kb,db,v.a.instance.ga(N(Ca.ChartCategory)))}static YDj(ba){return b.EwaSettings.sa(101)&&(ba.I6a||ba.Chc)}static ERg(ba,ka){if(!ka.$na)f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ka.I6a)ka=ka.$na.topLeft.toString(),u(ba,String.format(v.a.instance.ob(26),ka));else if(ka.Chc){var Ca=ka.$na.ZR();ka=(Ca.LastColumn-Ca.FirstColumn+1).toString();
Ca=(Ca.LastRow-Ca.FirstRow+1).toString();u(ba,String.format(v.a.instance.ob(27),ka,Ca))}}static XDj(ba,ka,Ca){return ba.OA||!b.EwaSettings.sa(131)?!1:(ba=Ca.da.Aa(271))?ba.$gc(ka):!1}static vvi(ba){return ba.top===ba.bottom&&ba.left+1===ba.right||ba.top+1===ba.bottom&&ba.left===ba.right}}ca.d6j=268435712;ca.HVc=500;Object(t.a)(ca,"SelectionReadoutHandler",null,[397,2]);var wa=a(55),ia=a(712);class Ha extends e.a{constructor(ba){super();this.$=ba;this.Db()}create(){const ba=this.$.da,ka=C.GetServiceTaskFactory.Oa(ba,
211,212,this.Xa),Ca=C.GetServiceTaskFactory.Oa(ba,66,134,this.Xa),db=C.GetServiceTaskFactory.Oa(ba,240,239,this.Xa);let yb=wa.Task.Ra(null);b.EwaSettings.vb()&&(yb=C.GetServiceTaskFactory.Oa(ba,244,315,this.Xa));y.TaskExtensions.za(y.TaskExtensions.Fd([ka,Ca,db,yb],this.la),()=>{const kb=Object(ia.a)(this.$.da,226,()=>new ca(ka.result,this.$,Ca.result,db.result,yb.result));this.nb(kb)},this.$.la,3)}static ka(ba){ba.da.Ha(227,new Ha(ba))}}Object(t.a)(Ha,"SelectionReadoutHandlerFactory",e.a,[]);class Sa{constructor(ba,
ka){this.$=ka;this.ariaLiveNotifier=ba}$Rf(){const ba=this.NOh();this.ariaLiveNotifier.Abb(ba,h.a.gpb)}NOh(){const ba=new Sys.StringBuilder;this.$.workbookContext&&u(ba,this.$.workbookContext.WorkbookFileName);u(ba,v.a.instance.ga(853));u(ba,this.POh());u(ba,this.OOh());u(ba,v.a.instance.ga(854));return ba.toString()}POh(){return this.$.isEditMode?v.a.instance.ga(858):v.a.instance.ga(859)}OOh(){var ba=this.o5j();const ka=this.$.va.na;ba=1!==ba?String.format(v.a.instance.ob(32),ba):v.a.instance.ga(852);
ba=new Sys.StringBuilder(ba);ka&&ka.sheetName&&(ba.append(n.qxd),ba.append(String.format(v.a.instance.ob(33),ka.sheetName)));return ba.toString()}o5j(){let ba=0;for(const ka of this.$.va.items)ka.visible&&ba++;return ba}}Object(t.a)(Sa,"WorkbookReadout",null,[]);class Da{constructor(ba,ka,Ca){this.GEf=()=>{this.G2d.$Rf();this.ariaLiveNotifier.setEnabled(!0)};this.$=ka;this.ariaLiveNotifier=ba;this.G2d=new Sa(ba,ka);this.qac=Ca.Khd(this.$);this.qac.iNg(this.GEf)}dispose(){this.qac&&this.qac.Qjj(this.GEf);
this.qac=this.ariaLiveNotifier=this.$=null}}Object(t.a)(Da,"EmbeddedWorkbookReadoutHandler",null,[2]);class ea{constructor(ba,ka){this.DV=()=>{this.Ed||this.qte()};this.Ed=!1;this.HY=ka.EY;this.ariaLiveNotifier=ba;this.G2d=new Sa(ba,ka);this.HY&&this.HY.AQ?this.qte():this.Aj()}dispose(){this.Sj();this.ariaLiveNotifier=this.HY=null;this.Ed=!0}Aj(){if(this.HY){this.HY.Uu(this.DV);this.HY.Ca.Rv(this.DV);this.HY.gE(this.DV);var ba=Object(L.a)(204,this.HY);ba&&(ba.Vb.xl(this.DV),ba.ha.cC(this.DV),ba.ha.wG(this.DV),
ba.ha.Sa.h2(this.DV))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Sj(){if(this.HY){this.HY.Ca.Mw(this.DV);this.HY.yF(this.DV);const ba=Object(L.a)(204,this.HY);ba&&(ba.Vb.nl(this.DV),ba.ha.sB(this.DV),ba.ha.EK(this.DV),ba.ha.Sa.Vma(this.DV))}}qte(){this.G2d.$Rf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Vxj();this.dispose()}}Object(t.a)(ea,"WorkbookReadoutHandler",null,[2]);class sa extends e.a{constructor(ba){super();
this.$=ba;this.Db()}create(){const ba=C.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Xa);if(this.$.aK){const ka=C.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa);y.TaskExtensions.za(y.TaskExtensions.Fd([ba,ka],this.$.la),()=>{const Ca=Object(ia.a)(this.$.da,228,()=>new Da(ba.result,this.$,ka.result));this.nb(Ca)},this.$.la,3)}else y.TaskExtensions.za(ba,ka=>{const Ca=Object(ia.a)(this.$.da,228,()=>new ea(ka.result,this.$));this.nb(Ca)},this.$.la,3)}static ka(ba){ba.da.Ha(229,new sa(ba))}}Object(t.a)(sa,
"WorkbookReadoutHandlerFactory",e.a,[]);a.d(F,"a",function(){return Ea});const Ea=()=>{c.a.Fa(ba=>{B.ka(ba);b.EwaSettings.vb()?D.ka(ba):G.ka(ba);Ha.ka(ba);sa.ka(ba)})}},1182:function(t,F,a){var c=a(9);t=a(0);var b=a(709),e=a(50),f=a(37),d=a(15),h=a(4),m=a(31),l=a(5),v=a(24),r=a(68),A=a(59);class x{constructor(oa,Ja){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=oa;this.sortType=Ja}EU(){return this.autoFilterOptions}}Object(t.a)(x,"MacroRecorderRangeColumnSortedOrFilteredPayload",
null,[122]);class n{constructor(oa){this.autoFilterOptions=null;this.autoFilterOptions=oa}EU(){return this.autoFilterOptions}}Object(t.a)(n,"MacroRecorderRangeItemFilteredPayload",null,[122]);var u=a(1152),z=a(41),w=a(374),C=a(192),y=a(60),B=a(166),H=a(216),I=a(48),R=a(44),S=a(12),G=a(250),D=a(1),E=a(188),M=a(22),L=a(282),N=a(21);class Y{constructor(oa,Ja){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=oa;this.tableRange=z.l(oa.Ranges[0],oa.SheetName);this.styleIndex=Ja}}
Object(t.a)(Y,"MacroRecorderTableStyleAppliedPayload",null,[122]);class U extends Y{constructor(oa,Ja,Wb,nc){super(oa,Wb);this.isCreation=this.hasHeaders=!1;this.hasHeaders=Ja;this.isCreation=nc}}Object(t.a)(U,"MacroRecorderRangeFormatedAsTablePayload",Y,[]);class P{constructor(oa,Ja,Wb){this.description=this.title=this.tableRange=null;this.tableRange=oa;this.title=Ja;this.description=Wb}Mp(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(t.a)(P,
"MacroRecorderTableAltTextEditedPayload",null,[122]);class aa{constructor(oa,Ja){this.newName=this.oldName=null;this.oldName=oa;this.newName=Ja}}Object(t.a)(aa,"MacroRecorderTableRenamedPayload",null,[122]);class X{constructor(oa){this.originalRange=null;this.originalRange=oa}}Object(t.a)(X,"MacroRecorderTableResizedPayload",null,[122]);class Z{constructor(oa,Ja,Wb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=oa;this.optionType=Ja;this.isPivotTable=Wb}}Object(t.a)(Z,
"MacroRecorderTableStyleOptionToggledPayload",null,[122]);var da=a(29),qa=a(45);class O{constructor(oa){this.tableName=null;this.tableName=oa}}Object(t.a)(O,"MacroRecorderTableConvertedToRangePayload",null,[122]);var ca=a(821);class wa{constructor(oa,Ja,Wb){this.isQueryTable=!1;this.sharedSheetRange=Ja;this.$=oa;this.Qh=this.$.Jb.zg("UserAction","ConvertToRangeManager");this.tableName=Wb}zab(){this.Qh.start();const oa=this.$.oa.xa.Wb();return ca.i(this.$.oa.xa,this.sharedSheetRange,Ja=>{this.showDialog(Ja)},
null,null,null,oa)}showDialog(oa){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.Qh.Bc} milliseconds`);oa&&!G.a(oa)&&((this.isQueryTable=oa.Result)?(oa=da.a.ed(3,2,0,737,0,-66108047,"ConvertToRange"),f.TaskExtensions.za(qa.a(this.$).kj(oa),Ja=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.Qh.Bc} milliseconds`);0===Ja.result&&this.O$g()},this.$.la,11)):this.P$g());this.Qh.stop();
d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.Qh.Bc} milliseconds`)}gye(){const oa={};oa.IsQueryTable=this.isQueryTable;oa.Range=this.sharedSheetRange;return oa}O$g(){const oa=this.$.oa.xa;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.igf(194,(Ja,Wb,nc)=>ca.d(oa,this.gye(),Ja,Wb,nc,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}P$g(){const oa=this.$.oa.xa;
d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.igf(193,(Ja,Wb,nc)=>ca.c(oa,this.gye(),Ja,Wb,nc,null),()=>new O(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}igf(oa,Ja,Wb=null){w.a(this.$.userOperationManager,Ja,nc=>new C.a(oa,0,nc,void 0,Wb),null)}}Object(t.a)(wa,"ConvertToRangeManager",null,[]);var ia=a(1151),Ha=a(965),Sa=a(13);class Da extends Ha.a{constructor(oa,Ja){super(oa);this.tOb=Ja}get kc(){return"FormatAsTableDialog"}get GB(){return 215}get el(){return Sa.a.instance.ga(731)}Vj(){const oa=
z.s(this.H$.TableRange);return()=>new U(oa,this.hasHeaders,this.tOb,!0)}DG(){const oa=z.s(this.H$.TableRange),Ja=this.H$.HasTotalRow;return(Wb,nc,Yb)=>ca.h(this.$.oa.xa,oa,this.hasHeaders,!1,Ja,this.tOb,Wb,nc,Yb,null)}}Object(t.a)(Da,"FormatAsTableReactDialog",Ha.a,[]);Ha=a(285);var ea=a(90);class sa extends Ha.a{constructor(oa){super(oa);this.oQj=(Ja,Wb)=>{1===Ja&&this.$Uj(z.D(this.MLf(Wb[sa.hRf])))};this.axb=Ja=>{Ja=this.dhd(Ja);return this.ped(Ja)};this.gridView=N.h(oa);this.qa=this.gridView.ha.qa;
this.Qqc=this.gridView.wb.zi(this.qa.activeCell).usedRange;oa=this.EM(this.Qqc.toString());this.initializeAndShow(Sa.a.instance.ga(732),this.oQj,oa)}get kc(){return"ResizeTableDialog"}MLf(oa){oa=oa.startsWith("=")?oa.substring(1,oa.length):oa;if(({sheetName:oa,range:Ja}=z.Y(oa,this.$.va)).returnValue&&Ja){var Ja=z.v(Ja,this.$);Ja.SheetName=M.a.equals(oa,"",!0)?this.$.na.name:oa;return Ja}return null}EM(oa){return{[sa.TU]:"ResizeTableDialog",[sa.hRf]:oa,["getInputErrorIfInvalid"]:this.axb}}dhd(oa){oa=
this.MLf(oa);if(!oa)return 1;const Ja=z.D(oa);return M.a.equals(oa.SheetName,this.$.na.sheetName,!0)&&this.Qqc.top===Ja.top&&this.Qqc.zd(Ja)?0:2}ped(oa){let Ja="";switch(oa){case 1:Ja=Sa.a.instance.ga(75);break;case 2:Ja=ea.a.kf(Sa.a.instance.ga(74))}return Ja}$Uj(oa){this.$.Zc(-1400250766,r.a.zb,8,{["ResizeTableRange"]:oa,["OriginalTableRange"]:this.Qqc})}}sa.TU="id";sa.hRf="range";Object(t.a)(sa,"ResizeTableDialog",Ha.a,[]);class Ea extends Ha.a{constructor(oa){super(oa);oa=N.h(this.$);oa=oa.wb.zi(oa.ha.qa.activeCell);
M.a.lh(oa.pTa)?this.gFd="":this.gFd=oa.pTa;M.a.lh(oa.qTa)?this.fFd="":this.fFd=oa.qTa;oa=this.EM(this.gFd,this.fFd);this.initializeAndShow(Sa.a.instance.ga(741),this.dQj,oa)}get kc(){return"TableAltTextDialog"}dQj(oa,Ja){1===oa&&(oa=Ja[Ea.GSj],Ja=Ja[Ea.ilh],oa===this.gFd&&Ja===this.fFd||this.$.Zc(868579142,r.a.zb,8,{["Title"]:oa,["Description"]:Ja}))}EM(oa,Ja){return{["id"]:"AltTextDialog",["title"]:oa,["description"]:Ja}}}Ea.TU="id";Ea.GSj="title";Ea.ilh="description";Object(t.a)(Ea,"TableAltTextDialog",
Ha.a,[]);var ba=a(782),ka=a(783),Ca=a(115),db=a(73),yb=a(55),kb=a(33),mb=a(145),W=a(103),Q=a(186),va=a(105);class na{constructor(oa,Ja,Wb,nc){this.menuId=null;this.BRa=-1;this.hQi=Yb=>{if(!G.a(Yb)){const Fa=N.h(this.$);var pb=new v.Range(1,1,1,1,!0,!1);pb=z.v(pb,this.$);null!=Yb.Result&&(mb.a("CreateSampleTable.NewSheet"),pb.SheetName=Yb.Result.toString());Fa.qg(pb,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.gJf=()=>{this.lda()};this.c0i=Yb=>{if(!(this.qa.bMa()||(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
G.a(Yb)||this.tMa())&&G.a(Yb)&&this.tMa())){Yb=this.qa.activeCell;var pb=this.qa.activeRange;const Fa=this.tableManager.Dg.usedRange;2===this.BRa&&B.g(this.tableManager.Dg)&&Yb.bottom===Fa.bottom&&(pb=pb.c5?new v.Range(pb.top-1,pb.left,pb.bottom-1,pb.right,!1,!0):new v.Range(pb.top,pb.left,pb.bottom-1,pb.right,!1,!0),Yb=pb.contains(Yb)?Yb:v.Range.Pc(pb.bottom,Yb.left),N.h(this.$).ha.updateSelection(pb,Yb,0,3))}};this.v_i=Yb=>{G.a(Yb)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.qf()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.u_i=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.qf()};this.w_i=(Yb,pb)=>{pb&&this.aS(pb);G.b(Yb,-569193796)&&(db.a(this.$).gd.KL(-569193796),this.Syi(Yb.Errors[0]))};this.$=oa;this.tableManager=Ja;this.namedSheetViewPublic=Wb;this.frame=this.$.frame;this.ha=N.h(this.$).ha;this.qa=this.ha.qa;this.UA=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.VA=kb.a.VA(this.$);this.tableStyleManager=nc;this.tableStyleManager.pOg(this.gJf)}Hc(oa,Ja){switch(Ja){case -544558380:return!(this.tableManager&&this.qa.XJ()&&!this.tMa()&&B.d(this.tableManager.Dg));case 1544516694:return!(this.tableManager&&(this.qa.XJ()?!this.tMa():this.qa.bMa()));case -697806646:case 323142015:return!this.qa.XJ();case 341449783:case 2128797448:return D.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.qa.XJ()?!this.tMa():
this.qa.bMa())):!(this.tableManager&&this.tableManager.rtd(this.qa.activeCell));case -123538519:return!(this.qa.XJ()&&this.tableStyleManager&&this.tableStyleManager.std());case 756677940:return!(D.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.Ski());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.Tki());case 844144422:return!this.qa.XJ();case -723113214:return!this.qa.XJ();case 1371713064:case 875133075:return!kb.a.VA(this.$)||W.k(this.$.dg)}return!1}executeCommand(oa,
Ja,Wb){var nc;oa=f.TaskExtensions.Tj();const Yb=this.$.oa.xa;let pb=null,Fa=1;const ab=Ja.command,Gb=this.$.oa.xa.Wb();let Ga=null;if(this.VA)switch(ab){case -2058042992:case 504133448:case -798968736:case 477776686:H.d(this.$,Wb.TopCellAddress,ab,null);break;case -1400250766:H.d(this.$,Wb.OriginalTableRange,ab,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const Qa=N.h(this.$);H.d(this.$,Qa.ha.qa.activeCell,ab,
null)}switch(ab){case -2058042992:const Qa=A.a.Wh(Wb[r.a.Pf]);D.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!Qa.CriteriaType&&(Qa.CriteriaType=0);na.E3f(this.$,Qa);pb=(fa,eb,ua)=>ca.a(Yb,Qa,null,null,!1,!1,!1,ba.a.S4a(Ca.a.HGa,ka.a.clearAutoFilter,fa),eb,ua,null);Fa=176;Ga=()=>new n(Qa);break;case 504133448:case -798968736:case 477776686:const wb=A.a.Wh(Wb[r.a.Pf]),Na=Wb.TopCellAddress;na.E3f(this.$,wb);const ya=504133448===Ja.command?1:-798968736===
Ja.command?2:3;if(Na){Wb=this.tableManager.Mp(Na);if(!Wb){var Ma=this.$.va.na;(null===(nc=z.D(Ma.q0))||void 0===nc?0:nc.contains(Na))?Wb=z.D(Ma.q0):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Wb&&!this.$.$Yc([Wb],!0,1))break}else if(Wb&&!this.$.Us([Wb],!0,1))break}pb=(fa,eb,ua)=>y.H(Yb,wb,ya,L.b(fa,this.w_i),eb,ua,Na,Gb);Fa=177;Ga=()=>new x(wb,ya);break;case 341449783:case 2128797448:this.BRa=
341449783===ab?0:2;({lCa:pb,operationName:Fa,Vj:Ga}=this.toggleTableStyleOption(Yb,Gb));break;case -712419744:this.UA?this.Tff(Wb[l.a.event]):this.Tff(null);break;case 875133075:case 1371713064:let nb=z.r(this.qa.selectedRanges,this.$);if(!nb)break;const vb=this.m2h(Wb);pb=(fa,eb,ua)=>ca.e(Yb,nb,vb,L.b(fa,this.hQi),eb,ua,null,Gb);nc="TestHost"===this.$.ya.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.ya.HostName||nc,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
Fa=1025;break;case 1868184698:if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({jAb:nc,lCa:pb,Vj:Ga}=this.zgg(null,Gb),nc)){Fa=206;break}new ia.a(this.$);break;case 844144422:new sa(this.$);break;case 1544516694:case -544558380:if(nc=Wb[r.a.Kc])this.BRa=this.u4h(nc),-1!==this.BRa&&({lCa:pb,operationName:Fa,Vj:Ga}=this.toggleTableStyleOption(Yb,Gb));break;case 756677940:if(this.tMa()&&this.clf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const gb=Wb.Text,cb=this.DXh();if(cb){pb=(eb,ua,xa)=>ca.j(Yb,gb,cb,L.b(eb,this.v_i),L.a(ua,this.u_i),xa,Gb);Fa=217;let fa=null;this.tableManager.Dg?fa=this.tableManager.Dg.name:this.tableManager.OHd?fa=this.tableManager.OHd.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");fa&&(Ga=()=>new aa(fa,gb))}else return d.ULS.sendTraceTag(537151175,
0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),yb.Task.Ra(!1);break;case 323142015:if(this.tMa())break;return(new wa(this.$,this.Jed(),this.tableManager.Dg.name)).zab();case -1400250766:Fa=211;pb=this.Noj(Wb,Yb,Gb);const La=z.m(Wb.OriginalTableRange,this.$.va.na);Ga=()=>new X(La);break;case 1872288872:this.tableManager.jaj();break;case -123538519:const ja=this.t4h(Wb);nc=M.a.contains(Wb[r.a.Kc],l.a.fIb,!0)||M.a.contains(Wb[l.a.HF],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${nc} with style index ${ja.toString()}`);let Ua=this.g7e();Ua&&(pb=(fa,eb,ua)=>ca.b(Yb,Ua,ja,fa,eb,ua,null,Gb),Ga=()=>new Y(Ua,ja),Fa=212);break;case 753331043:nc=Wb[r.a.Kc];if(!nc)break;const lb=Number.parseInvariant(nc);if(this.qa.XJ()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${lb}`);let fa=this.g7e();fa&&(pb=(eb,
ua,xa)=>ca.h(Yb,fa,!1,!1,!1,lb,eb,ua,xa,null,Gb),Ga=()=>new U(fa,!1,lb,!1),Fa=215);break}if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({jAb:Wb,lCa:pb,Vj:Ga}=this.zgg(lb,Gb),Wb)){Fa=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${lb}`);new Da(this.$,Number.parseInvariant(nc));break;case 71074531:const sb=Wb.HasHeader,V=Wb.TableRange;if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:7553123_formattablefromrange")){const fa=
null!==(Ma=Wb.StyleIndex)&&void 0!==Ma?Ma:22;let eb=z.s(V);pb=(ua,xa,tb)=>ca.h(Yb,eb,sb,!1,!1,fa,ua,xa,tb,null,Gb);Ga=()=>new U(eb,sb,fa,!0)}else pb=(fa,eb,ua)=>ca.f(Yb,V,sb,!1,!1,fa,eb,ua,null),Ga=()=>new u.a(sb,V);Fa=206;break;case -723113214:new Ea(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Fa=1022;const za=Wb.Title,Ra=Wb.Description,Xa=this.Jed();pb=(fa,eb,ua)=>ca.g(Yb,za,Ra,Xa,fa,eb,ua,null);let $a,ma;this.tableManager.Dg&&($a=M.a.lh(this.tableManager.Dg.pTa)?
"":this.tableManager.Dg.pTa,ma=M.a.lh(this.tableManager.Dg.qTa)?"":this.tableManager.Dg.qTa);Ga=za==$a?()=>new P(Xa,void 0,Ra):Ra==ma?()=>new P(Xa,za,void 0):()=>new P(Xa,za,Ra);break;default:return E.a(ab)}if(pb){const Qa=wb=>new C.a(Fa,0,wb,void 0,Ga);oa=!this.namedSheetViewPublic||-2058042992!==ab&&504133448!==ab&&-798968736!==ab&&477776686!==ab?w.a(this.$.userOperationManager,pb,Qa,Ja):this.namedSheetViewPublic.ASa().continueWith(wb=>{wb.result&&w.a(this.$.userOperationManager,pb,Qa,Ja)})}return oa}toggleTableStyleOption(oa,
Ja){const Wb=this.qa.bMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Wb?"PivotTable":"table"} style option ${this.BRa} was toggled.`);const nc=this.Jed();return{lCa:(Yb,pb,Fa)=>ca.l(oa,nc,this.BRa,L.b(Yb,this.c0i),pb,Fa,null,Ja),operationName:196,Vj:()=>new Z(nc,this.BRa,Wb)}}Noj(oa,Ja,Wb){const nc=oa.OriginalTableRange,Yb=z.m(oa.ResizeTableRange,this.$.va.na),pb=()=>{this.tableManager.tdg(nc)},Fa=ab=>{ab.Errors&&this.tableManager.tdg(nc)};return(ab,Gb,Ga)=>ca.k(Ja,Yb,
L.b(ab,Fa),L.a(Gb,pb),Ga,null,Wb)}t4h(oa){var Ja=-1;oa[r.a.Kc]&&(Ja=oa[r.a.Kc],Ja=M.a.contains(Ja,l.a.fIb,!0)?this.tableStyleManager.$wb(Ja):Number.parseInvariant(oa[r.a.Kc]));return Ja}m2h(oa){return(oa=oa[r.a.Kc])?Number.parseInvariant(oa):0}wc(oa,Ja){oa=!1;switch(Ja.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:oa=
!0;break;case 756677940:oa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename");break;case 875133075:case 1371713064:oa=kb.a.VA(this.$)}return oa}Mc(oa,Ja,Wb){oa=!1;switch(Ja){case "PopulateTableMoreStylesMenu":this.menuId=Wb.MenuId;this.tableStyleManager.std()||this.tableStyleManager.T4a("formatAsTableMenu");oa=this.tableStyleManager.jNf(Ja,Wb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Wb.MenuId,this.tableStyleManager.std()||this.tableStyleManager.T4a("accessibilityTab"),
oa=this.tableStyleManager.jNf(Ja,Wb)}return oa}dispose(){this.tableStyleManager.Jkj(this.gJf)}lda(){(M.a.contains(this.menuId,"Format",!0)||M.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Vw(this.menuId)}Jed(){return z.v(this.qa.activeCell,this.$)}DXh(){const oa=this.tableManager.Iud;return oa?z.v(oa,this.$):null}Tff(oa){if(this.tableManager){var Ja=N.h(this.$),Wb=this.qa.activeCell,nc=this.tableManager.Mp(Wb),Yb=null;if(!nc||nc.ZAa)for(let pb of Ja.Hha)for(let Fa of pb)Ja=Fa.qt,
Wb.left>=Ja[0]&&Wb.left<=Ja[Ja.length-1]&&(Yb=(Ja=Fa.Vr(Wb).JJ())?S.DOMElementExtensions.$j(Ja,m.a.zse):null);else{const pb=Ja.Qb(v.Range.Pc(nc.top,Wb.left));if(this.UA){I.a.instance.create(()=>{pb.invoke(8,oa)},0,R.a.ndg,!0,!0);return}Yb=pb.EKa(56).h6a}Yb&&I.a.instance.create(()=>{S.DOMElementExtensions.vgc(Yb,null)},0,R.a.ndg,!0,!0)}}u4h(oa){oa=Number.parseInvariant(oa);return-1<oa&&8>=oa?oa:-1}tMa(){return!this.tableManager.Dg}clf(){return this.tableManager.OHd?!1:(d.ULS.sendTraceTag(537151173,
0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}Tki(){const oa=this.qa.XJ(),Ja=this.qa.Tg&&!N.h(this.$).wb.V4(this.qa.ld);return oa||Ja}Ski(){return this.qa.XJ()||!this.clf()}y4h(oa){const Ja=[];for(const Wb of oa)if(oa=H.b(this.$,Wb),null===oa||void 0===oa?0:oa.length)for(const nc of oa)nc.usedRange&&!Ja.includes(nc.usedRange)&&Ja.push(nc.usedRange);return Ja}g7e(){const oa=this.qa.selectedRanges;let Ja=[];if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Ja=
this.y4h(oa);else for(const Wb of oa)N.h(this.$).wb.V4(Wb)&&Ja.push(Wb);return Ja&&Ja.length?z.r(Ja,this.$):null}aS(oa){kb.a.Tka(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Ja=>{Ja.result.sea(oa);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}Syi(oa){D.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")?void Q.a.resolve(va.n,{Tl:0}).then(Ja=>{Ja.ZIe(this.$,
oa)}):f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,446,447,0),Ja=>{Ja.result.ZIe(this.$,oa)},this.$.la,3)}static E3f(oa,Ja){Ja.SheetName=oa.na.name;Ja.NamedObjectView=oa.ea.isNamedObjectViewMode}zgg(oa,Ja){let Wb,nc;if(!this.qa.Tg||1!=this.qa.ld.Ny)return{jAb:!1,lCa:Wb,Vj:nc};let Yb=z.v(this.qa.ld,this.$);Yb.LastColumn=Yb.FirstColumn+3-1;Yb.LastRow=Yb.FirstRow+4-1;const pb=z.D(Yb),Fa=N.h(this.$);if(!pb.lz||!Fa.wb.$wa(pb))return{jAb:!1,lCa:Wb,Vj:nc};h.AFrameworkApplication.Sp("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");
if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{jAb:!1,lCa:Wb,Vj:nc};if(null==oa)Wb=(ab,Gb,Ga)=>ca.f(this.$.oa.xa,Yb,!1,!1,!1,ab,Gb,Ga,Ja),nc=()=>new u.a(!1,Yb);else{const ab=z.s(Yb);Wb=(Gb,Ga,Ma)=>ca.h(this.$.oa.xa,ab,!1,!1,!1,oa,Gb,Ga,Ma,Ja);nc=()=>new U(ab,!1,oa,!0)}return{jAb:!0,lCa:Wb,Vj:nc}}}Object(t.a)(na,"TableCommandHandler",null,[221]);class Ba extends b.a{constructor(oa){super(oa)}dispose(){super.dispose()}hd(){const oa=e.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.Xa),Ja=e.GetServiceTaskFactory.create(this.$.da,330,this.la,this.Xa),Wb=e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Xa);if(kb.a.VA(this.$)){const nc=e.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Xa);f.TaskExtensions.za(yb.Task.ZF(oa,Wb,Ja,nc),()=>{this.$c([new na(this.$,oa.result,Wb.result,Ja.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}else f.TaskExtensions.za(yb.Task.ZF(oa,Wb,Ja),()=>{this.$c([new na(this.$,
oa.result,Wb.result,Ja.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(oa){b.a.Ld(86,new Ba(oa))}}Object(t.a)(Ba,"TableCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return Oa});const Oa=()=>{c.a.Fa(oa=>{Ba.ka(oa)})}},1187:function(t,F,a){t=a(0);var c=a(85),b=a(551),e=a(15);class f{constructor(){this.xGc={}}hHg(Ha){this.xGc[Ha.id.toString()]=Ha}qLi(Ha){const Sa=this.xGc;for(let Da in Sa)Sa[Da].notify(Ha,!1);this.xGc={}}q$i(Ha,Sa){Sa&&
this.hHg(Sa);return this.pHf(Ha,Sa)}O9c(Ha){this.qLi(Ha)}ePe(Ha,Sa){Ha.notify(Sa,!0)}}Object(t.a)(f,"AEventEmitter",null,[394]);var d;(function(Ha){Ha[Ha.notStarted=0]="notStarted";Ha[Ha.waiting=1]="waiting";Ha[Ha.shouldRetry=2]="shouldRetry";Ha[Ha.complete=3]="complete"})(d||(d={}));Object(t.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ha){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ha]},
"ResultType",this.G6e());this._state=Ha}}Object(t.a)(h,"AEventResult",null,[436]);class m extends h{constructor(){super();this.ITc=this.wlb=null;this.state=0;this.FMc=this.uae=!1}get hR(){return this.wlb}get eoa(){return this.ITc}get lji(){return this.uae}G6e(){return"GetMoreInfo Result"}}Object(t.a)(m,"GetMoreInfoResult",h,[456,436]);var l=a(4),v=a(79),r=a(40),A=a(699),x=a(376),n=a(167),u=a(652),z=a(575),w=a(108),C=a(25);class y{constructor(Ha,Sa,Da,ea,sa,Ea,ba,ka){this.Ma=Ha;this.ph=Sa;this.Hsg=
Da;this.X0=ea;this.he=sa;this.kLc=Ea;this.uxg=ba;this.iYb=ka}Qej(){this.K9a.Nb(C.a.openUrlInNewTab,w.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.K9a.Nb(C.a.pPa,w.a.frame,Object(c.a)(this,this.pPa,"openDocumentUrl"));l.AFrameworkApplication.nM?this.Trf():this.K9a.Ne(C.a.l8b,w.a.frame,Object(c.a)(this,this.l8b,"documentLoaded"),96)}openUrlInNewTab(Ha,Sa,Da,ea,sa){sa&&sa.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:sa.SourceControlId,["AppType"]:z.a[this.kca]}),
r.a.gf(sa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}pPa(Ha,Sa,Da,ea,sa){if(sa&&sa.MenuItemId){const Ea=l.AFrameworkApplication.fa.pa("WacInTabOpenMRUIsEnabledForUiHost"),ba=l.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures");e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ea,ba);if(Ea&&ba){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:sa.SourceControlId,["AppType"]:z.a[this.kca]});
Ha=sa.MenuItemId.toString();const ka={};ka[x.a.fQa]="1";ka[x.a.documentUrl]=Ha;ka[x.a.reason]=u.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.nQ().execute(Ca=>{Ca.jj(n.a.PY,ka)})}else this.openUrlInNewTab(Ha,Sa,Da,ea,sa)}return 32}l8b(){this.Trf();return 32}WNa(Ha,Sa,Da=""){if(Sa&&Sa.aF){const ea=A.a[Sa.status];Sa=Sa.aF.getTime();const sa=this.gw()-Sa;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",
{["Caller"]:Ha,["RequestStatus"]:ea,["ElapsedMs"]:sa,["StartTime"]:Sa,["Notes"]:Da})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ha})}Trf(){var Ha=l.AFrameworkApplication.fa.pa("QPGVCI"),Sa=v.a.Rx(document.URL,"wdNewAndOpenCt",Ha);if(Sa){Sa=parseInt(Sa);var Da=v.a.Rx(document.URL,"wdPreviousSession",Ha);Ha=v.a.Rx(document.URL,"wdPreviousCorrelation",Ha);var ea=l.AFrameworkApplication.fa.pa("NAOPLP");if(l.AFrameworkApplication.nM){var sa=
l.AFrameworkApplication.nM.getTime();!Sa||Sa>sa?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Sa,["DocumentLoadedTime"]:sa,["SessionId"]:Da,["Correlation"]:Ha}):e.ULS.sendTraceTag(5849683,202,ea?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:sa-Sa,["ClickTimestamp"]:Sa,["SessionId"]:Da,["Correlation"]:Ha})}else e.ULS.sendTraceTag(5849681,202,ea?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:Sa,["SessionId"]:Da,["Correlation"]:Ha})}}get K9a(){return this.Ma.value}get UEb(){return this.ph.value}get gxf(){return this.Hsg.value}get kca(){return this.X0.value}get Dnc(){return this.he.value}get gw(){return this.kLc}get o_(){return this.uxg.value}get supportsGetMoreInfoForPersonalStorage(){return this.iYb.value}static get instance(){return y.La||(y.La=y.yM())}static yM(){return new y(new b.a(()=>l.AFrameworkApplication.rb),new b.a(()=>l.AFrameworkApplication.Bd),new b.a(()=>
l.AFrameworkApplication.ra),new b.a(()=>l.AFrameworkApplication.ra.Qa.Oj),new b.a(()=>l.AFrameworkApplication.hi),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.ra.Qa.o_),new b.a(()=>l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}y.La=null;Object(t.a)(y,"NewAndOpenCommonHelpers",null,[393]);var B=a(109);class H{constructor(Ha,Sa,Da){this.uXb=this.Ji=null;this.VRc=0;this.mDg=Ha;this.he=Sa;this.R7d=Da}$Pg(){this.VRc=this.Pcb+1}WNd(Ha){this.Ji&&(this.he.So(this.Ji),this.Ji=
null);Ha&&(this.VRc=0)}iNj(Ha){const Sa=this.xSj;0<=Sa?(this.$Pg(),this.WNd(!1),this.Ji=new B.a(4,1,Sa,Ha,107),this.he.fg(this.Ji)):(this.WNd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.R7d}))}get Pcb(){return this.VRc}get xSj(){return this.Pcb>=this.f3f.length?-1:this.f3f[this.Pcb]}get f3f(){if(!this.uXb){const Ha=(this.mDg.value||"0").split(",");this.uXb=[];for(let Sa=0;Sa<Ha.length;Sa++){const Da=parseInt(Ha[Sa]);isNaN(Da)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.R7d,["Entry"]:Ha[Sa]}):Array.add(this.uXb,Da)}}return this.uXb}}Object(t.a)(H,"RetryHelper",null,[]);var I=a(39),R=a(30);class S extends f{constructor(Ha,Sa){super();this.z1=Ha;this.Xlb=new H(Sa,this.xEb.Dnc,"GetMoreInfo");this.Jo=new m}xFi(){this.lyd("Document opened")}jeh(Ha){return()=>{this.lyd(Ha,!0)}}pHf(Ha,Sa=null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ha});3===this.Jo.state?(Sa&&this.ePe(Sa,this.Jo),e.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ha})):this.lyd(Ha);return this.Jo}lyd(Ha,Sa=!1){this.Xlb.WNd(!Sa);1===this.Jo.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ha,["RetryIndex"]:this.Xlb.Pcb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:Ha,["RetryIndex"]:this.Xlb.Pcb}),this.Jo.state=1,Sa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.xEb.o_,l.AFrameworkApplication.ti),
this.xEb.UEb.Gga(Sa,1,null,null,[S.Ige,S.Gke],!1,5,this.mdh(),this.ldh(Ha),null))}mdh(){return Ha=>{var Sa=!1;let Da=!1;var ea=!1,sa;l.AFrameworkApplication.fa.pa("GetMoreInfoDataFromResponseBody")&&(Ha.data.de?({ht:sa}=I.d(Ha.data.de)).returnValue?sa?(ea=!0,this.Jo.ITc=sa.StorageServiceDisplayName,this.Jo.wlb=S.ynf(sa.PersonalFileStorageUrl)?sa.PersonalFileStorageUrl:"",""===this.Jo.hR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Wa("FileSource")&&(this.Jo.wlb=v.a.nda(l.AFrameworkApplication.breadcrumbFolderUrl)),
Sa=""===this.Jo.hR&&""!==this.Jo.eoa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));ea||((sa=Ha.data.responseHeaders)?
(this.Jo.ITc=(sa[S.Gke]||"").toString(),Sa=(sa[S.Ige]||"").toString(),this.Jo.wlb=S.ynf(Sa)?Sa:"",""===this.Jo.hR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Wa("FileSource")?(this.Jo.wlb=v.a.nda(l.AFrameworkApplication.breadcrumbFolderUrl),Sa=""===this.Jo.hR&&""!==this.Jo.eoa):Sa=""===Sa&&""!==this.Jo.eoa):(e.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Da=!0));ea=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Xlb.Pcb,Da,Sa,ea);this.xEb.WNa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ha.data,ea);this.x3f(3,Sa,Da)}}ldh(Ha){return Sa=>{this.xEb.WNa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Sa.data,"Failure");this.x3f(2);this.Xlb.iNj(this.jeh(Ha))}}x3f(Ha,Sa=!1,Da=!1){this.Jo.state=Ha;this.Jo.uae=Sa;this.Jo.FMc=Da;this.O9c(this.Jo)}get xEb(){return this.z1.value}static get instance(){return S.La||(S.La=S.yM())}static yM(){return new S(new b.a(()=>y.instance),new b.a(()=>
l.AFrameworkApplication.OYh))}static ynf(Ha){if(!Ha)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(R.a.Yk(Ha).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}S.Ige="PersonalFileStorageUrl";S.Gke="StorageServiceDisplayName";S.La=null;Object(t.a)(S,"GetMoreInfoActor",f,[]);var G=a(104),D=a(98);class E{constructor(Ha,Sa,Da,ea,sa){this.ayg=6E4;this.Rdf="inactive";this.sne=
"active";this.FS=!0;this.he=Ha;this.axg=Sa;this.kLc=Da;this.yYb=ea;this.Za=new D.a;sa&&this.$Mj();this.xce=this.g4e()}hoe(Ha){this.Za.addHandler(this.sne,Ha)}DJg(Ha){this.Za.addHandler(this.Rdf,Ha)}$Mj(){const Ha=new B.a(5,2,this.ayg,Object(c.a)(this,this.qei,"inactiveLoop"),108);this.rei.fg(Ha)}qei(){const Ha=this.g4e(),Sa=this.gw()-Ha;Sa>this.hCc&&this.FS&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Sa}),this.FS=!1,this.Za.raiseEvent(this.Rdf));Ha-this.xce>
this.hCc&&(this.FS=!0,this.Za.raiseEvent(this.sne));this.xce=Ha}get rei(){return this.he.value}get g4e(){return this.axg}get gw(){return this.kLc}get hCc(){return this.yYb.value}static get instance(){return E.La||(E.La=E.yM())}static yM(){return new E(new b.a(()=>G.a.instance),()=>l.AFrameworkApplication.lvd.getTime(),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.hCc),!0)}}E.La=null;Object(t.a)(E,"InactivityManager",null,[]);var M=a(84),L=a(925);class N extends h{constructor(){super();
this.Iee=this.Kee=this.Jee=null;this.state=this.zle=0;this.FMc=!1}get Ozd(){return this.Jee}get twf(){return this.Kee}get Nzd(){return this.Iee}get DSj(){return this.zle}G6e(){return"MruActor Result"}}Object(t.a)(N,"MruResult",h,[435,436]);var Y=a(242);class U{constructor(Ha,Sa,Da){this.task=null;this.Vfc=Ha;this.hHi=Sa;this.taskManager=Da;this.retryCount=this.Nzb=0;this.fRc=this.JCb=null}Nri(Ha,Sa){return Ha===Y.a.udd||20===Sa||18===Sa||3===Sa}Zsi(Ha){return 3===Ha||5===Ha||6===Ha||7===Ha||9===Ha||
10===Ha||11===Ha||12===Ha||13===Ha||14===Ha||15===Ha||16===Ha||23===Ha||26===Ha||27===Ha||28===Ha}get Dsc(){return this.fRc}reset(){this.Nzb=this.retryCount=0;this.fRc=this.JCb=null;this.task&&(this.taskManager.So(this.task),this.task=null)}uii(Ha,Sa,Da,ea){this.fRc=String.format("{0}_{1}",Da,ea);if(this.retryCount>=this.hHi)return e.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Nri(Da,ea))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.Zsi(ea)&&1<=this.Nzb)return this.JCb=Da,!1;Sa=Math.max(Sa,this.Vfc*Math.pow(2,this.Nzb));if(26===ea)Sa=Math.max(Sa,3E4);else if(27===ea||28===ea)Sa=Math.max(Sa,6E4);9===ea||412===Da&&(null==this.JCb||412!==this.JCb)?Sa=500:this.Nzb+=1;this.JCb=Da;this.retryCount+=1;this.task&&this.taskManager.So(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Sa);this.task=new B.a(2,1,Sa,Ha,107);this.taskManager.fg(this.task);return!0}}Object(t.a)(U,"RetryManager",null,
[]);var P=a(99),aa=a(138),X=a(146);class Z{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(Z,"WriteOptions",null,[]);var da=a(557),qa=a(193);class O extends f{constructor(Ha,Sa,Da,ea,sa,Ea,ba){super();this.z1=Ha;this.Uzg=Sa;this.ara=new U(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.kD.Dnc);this.Ara=new U(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.kD.Dnc);this.kCg=Da;this.Nme=ea;this.zGg={};this.IS=new N;this.Xwg=sa;this.EVb="";this.Lv=Ea;this.P8d=ba}get EFc(){return this.zGg}Jgj(){this.kD.K9a.Nb(C.a.renameMostRecentlyUsedFileEntry,w.a.frame,Object(c.a)(this,this.ylj,"renameMruEntry"))}ylj(){return this.N2d("Rename")}HFi(){this.xuf("File Opened")}IFi(){this.xuf("IntervalUpdate")}xuf(Ha){e.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ha});this.N2d(Ha)}T3(Ha){(Ha=R.a.T3(Ha))&&Ha.startsWith(".")&&(Ha=Ha.substring(1,Ha.length));return Ha}j0e(){switch(this.kD.kca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}d6h(Ha){var Sa=this.Xwg();if(!Sa)return null;const Da=new Z;Da.documentUrl=this.P8d.value?encodeURI(Sa):Sa;Da.mruItemId=this.EVb;Da.app=this.j0e();if(Sa=this.Lv())Da.folderName=Sa.breadcrumbFolderName,
Sa=Sa.en,Da.documentName=R.a.Kp(Sa),Da.documentExt=this.T3(Sa);Ha&&(Da.documentName?Da.documentName.length?255<=Da.documentName.length?Ha.set("DocumentNameLength","Long"):2084<=Da.documentName.length&&Ha.set("DocumentNameLength","VeryLong"):Ha.set("DocumentNameLength","0"):Ha.set("DocumentNameLength","Null"));return JSON.stringify(Da)}N2d(Ha,Sa=!1){if(4===this.kD.kca&&!l.AFrameworkApplication.Mta)return 2;var Da=aa.a.Pr();Da&&(Da.set("Trigger",Ha),Da.set("IsRetry",Sa?"true":"false"),Da.set("MruIdSent",
this.EVb?"true":"false"),Da.set("URLEncoded",this.P8d.value?"true":"false"));P.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Da);Ha=this.d6h(Da);if(!Ha)return Sa=!l.AFrameworkApplication.webEditingEnabled,Da&&(Da.set("WebEditingIsEnabled",l.AFrameworkApplication.webEditingEnabled?"true":"false"),Da.set("ProtectedFile",l.AFrameworkApplication.Nsc?"true":"false")),P.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Sa,!1,Object.assign(new qa.a,{extendedProperties:Da})),2;this.Ara&&
!Sa&&this.Ara.reset();Da=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.kD.o_,this.localeName);this.Nme?this.EFc["X-FileId"]=l.AFrameworkApplication.ti:Da+=String.format("&{0}",l.AFrameworkApplication.ti);l.AFrameworkApplication.Rb&&(this.EFc["X-Office-AudienceGroup"]=Object(M.a)(String,l.AFrameworkApplication.Rb.AudienceGroup)||"");this.EFc["X-Timeout"]=15E3;return this.kD.UEb.Im(Da,2,Ha,this.EFc,!0,5,Object(c.a)(this,this.O6j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.Thh,
"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}O6j(Ha){this.M$e(Ha.data)}M$e(Ha){const Sa=aa.a.Pr();this.Ara&&(Sa&&this.Ara.Dsc&&(Sa.set("LastError",this.Ara.Dsc),Sa.set("NumRetries",this.Ara.retryCount.toString())),this.Ara.reset());const Da=L.c(Ha.de);Da&&Da.diagnostics_data&&(this.EVb=Da.diagnostics_data.mru_id);Ha=+Ha.R2-+Ha.aF;Sa&&Sa.set("RequestDuration",Ha.toString());P.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new qa.a,{extendedProperties:Sa}))}Thh(Ha){if(Ha.data.httpStatus===
Y.a.Hsb)this.M$e(Ha.data);else{var Sa=Ha.data.httpStatus===Y.a.aIb,Da=aa.a.Pr();this.Y$e(this.Ara,Ha,this.Ghh(),Da);Da&&(Da.set("StatusCode",Ha.data.httpStatus.toString()),Sa||this.pWc(Ha.data,Da));P.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ha.data.httpStatus),Sa,!1,Object.assign(new qa.a,{extendedProperties:Da}))}}Ghh(){return()=>{this.N2d("Retry",!0)}}UYh(){this.xmc("Polling")}TYh(){this.xmc("Retry",!0)}zFi(){this.xmc("Open")}yFi(){this.xmc("Activity")}xmc(Ha,
Sa=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ha});const Da=aa.a.Pr();Da&&(Da.set("Trigger",Ha),Da.set("IsRetry",Sa?"true":"false"));P.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Da);this.ara&&!Sa&&this.ara.reset();this.ndh(Object(c.a)(this,this.WYh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.SYh,"getMruFromServerFailureCallback"))}pWc(Ha,Sa){Ha&&Ha.responseHeaders&&(Ha=Ha.responseHeaders["X-CorrelationId"])&&Sa.set("ServerCorrelationId",
Ha)}lCi(Ha,Sa){Ha&&(Sa&&Sa.set("RequestDuration",(+Ha.R2-+Ha.aF).toString()),P.Health.instance.recordKpiSuccess("GetMru",Object.assign(new qa.a,{extendedProperties:Sa})))}WYh(Ha){this.XYh(Ha)}XYh(Ha){var Sa="";let Da=null,ea=null,sa=null;const Ea=L.c(Ha.data.de);Ea&&(Da=Ea.places?Ea.places.items:[],ea=Ea.documents?Ea.documents.items:[],(sa=L.a(Ea,!1))&&(Sa=I.c(sa)));l.AFrameworkApplication.ra&&l.AFrameworkApplication.ra.Qa.RZ&&X.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Sa,
!0));Sa=aa.a.Pr();this.ara&&(Sa&&this.ara.Dsc&&(Sa.set("LastError",this.ara.Dsc),Sa.set("NumRetries",this.ara.retryCount.toString())),this.ara.reset());sa||Da||ea?(this.kD.WNa("MruActor.GetMruV2FromServerSuccessCallback",Ha.data,"Success"),this.dEc(3,sa,Da,ea),this.lCi(Ha.data,Sa)):(this.kD.WNa("MruActor.GetMruV2FromServerSuccessCallback",Ha.data,"Failure: Invalid JSON"),Sa&&this.pWc(Ha.data,Sa),P.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new qa.a,{extendedProperties:Sa})),
this.dEc(3,null,null,null,!0));this.O9c(this.IS)}Y$e(Ha,Sa,Da,ea){let sa=0,Ea=0;const ba=L.c(Sa.data.de);ba&&(null!=ba.response_code&&(sa=ba.response_code,ea&&ea.set("MruResponseCode",sa.toString()),9===sa&&(this.EVb="")),ba.error_data&&null!=ba.error_data.retry_after_ms&&(Ea=ba.error_data.retry_after_ms,ea&&ea.set("ExpectedRetryAfter",Ea.toString())));Ha&&(Sa=Ha.uii(Da,Ea,Sa.data.httpStatus,sa),ea&&(ea.set("CurrentRetryCount",Ha.retryCount.toString()),ea.set("RetryScheduled",Sa?"true":"false")))}SYh(Ha){this.VYh(Ha)}VYh(Ha){const Sa=
Ha.data.httpStatus===Y.a.aIb,Da=aa.a.Pr();Da&&(Da.set("StatusCode",Ha.data.httpStatus.toString()),Sa||this.pWc(Ha.data,Da));this.kD.WNa("MruActor.GetMruFromServerFailureCallback",Ha.data,"Failure");this.dEc(2);this.Y$e(this.ara,Ha,Object(c.a)(this,this.TYh,"getMruFromServerRetryTask"),Da);P.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Ha.data.httpStatus),Sa,!1,Object.assign(new qa.a,{extendedProperties:Da}));this.O9c(this.IS);l.AFrameworkApplication.ra&&l.AFrameworkApplication.ra.Qa.RZ&&
X.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}dEc(Ha,Sa=null,Da=null,ea=null,sa=!1){if(3!==this.IS.state||3===Ha)this.IS.Jee=Sa,this.IS.Kee=Da,this.IS.Iee=ea,this.IS.state=Ha,this.IS.FMc=sa,this.IS.zle=this.kD.gw()}pHf(Ha,Sa){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ha,["ResultState"]:this.IS.state});Sa&&3===this.IS.state&&this.ePe(Sa,this.IS);return this.IS}ndh(Ha,Sa){this.dEc(1);
let Da;const ea={};Da=String.format(this.kD.o_+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.j0e(),this.localeName);this.kCg.value||(Da+="&entity=docs");l.AFrameworkApplication.Rb&&(ea["X-Office-AudienceGroup"]=Object(M.a)(String,l.AFrameworkApplication.Rb.AudienceGroup)||"");this.Nme?ea["X-FileId"]=l.AFrameworkApplication.ti:Da+=String.format("&{0}",l.AFrameworkApplication.ti);this.kD.UEb.Im(Da,1,null,ea,!0,5,Ha,Sa,null)}get kD(){return this.z1.value}get localeName(){return this.Uzg.value}static get instance(){return O.La||
(O.La=O.yM())}static yM(){return new O(new b.a(()=>y.instance),new b.a(()=>da.a.IJ(l.AFrameworkApplication.lcid).name),new b.a(()=>l.AFrameworkApplication.ra.Qa.sv),l.AFrameworkApplication.fa.pa("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.ra.Qa.yx,()=>l.AFrameworkApplication.om,new b.a(()=>l.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled")))}}O.La=null;Object(t.a)(O,"MruActor",f,[]);class ca{constructor(){this.Ymb=this.Ihe=this.$a=null;this.Fm=!1}get name(){return"Common.App.NewAndOpen.Core"}Ah(Ha){this.$a=
Ha;Ha.register(393,"Common.INewAndOpenCommonHelpers").qc().yc(()=>y.instance);Ha.register(394,"Common.IEventEmitter<Common.IGetMoreInfoResult>").qc().yc(()=>S.instance);Ha.register(394,"Common.IEventEmitter<Common.IMruResult>").qc().yc(()=>O.instance)}init(){l.AFrameworkApplication.fa.ru(()=>{this.zzb()})}zzb(){this.$a.resolve("Common.INewAndOpenCommonHelpers");this.$a.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.$a.resolve("Common.IEventEmitter<Common.IMruResult>");var Ha=!1;y.instance.Qej();
l.AFrameworkApplication.Ila&&(Ha=!0);l.AFrameworkApplication.QRf&&(O.instance.zFi(),0<l.AFrameworkApplication.uwf&&this.Moe(),this.SCj(),Ha=!0);l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ha&&S.instance.xFi();l.AFrameworkApplication.p0j&&(Ha=O.instance,Ha.Jgj(),Ha.HFi(),G.a.instance.fg(this.q0j))}SCj(){E.instance.hoe(Object(c.a)(O.instance,O.instance.yFi,"makeGetMruRequestActivityTrigger"));E.instance.hoe(Object(c.a)(this,this.Moe,"addGetMruFromServerTask"));E.instance.DJg(Object(c.a)(this,
this.Okh,"deleteGetMruFromServerTask"))}Okh(){G.a.instance.So(this.vwf)}Moe(){G.a.instance.fg(this.vwf)}get vwf(){return this.Ihe||(this.Ihe=new B.a(5,2,l.AFrameworkApplication.uwf,Object(c.a)(O.instance,O.instance.UYh,"getMruFromServerTask"),109))}get q0j(){return this.Ymb||(this.Ymb=new B.a(2,2,6E4*l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(O.instance,O.instance.IFi,"makeUpdateMruTask"),197))}dispose(){this.Fm||(this.Fm=
!0,this.Ymb&&(G.a.instance.So(this.Ymb),this.Ymb=null))}}Object(t.a)(ca,"CorePackageManager",null,[4,5,2]);var wa=a(252);a.d(F,"a",function(){return ia});const ia=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");wa.a.instance.gi(new ca)}},1192:function(t,F,a){t=a(0);var c=a(4),b=a(226),e=a(15),f=a(85),d=a(54),h=a(201);class m{constructor(){this.xje=this.NSc=!1;const oa=c.AFrameworkApplication.qk;0>=oa||(this.qk=oa,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.qk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.eha}),h.a.instance.FXc(Object(f.a)(this,this.fPa,"onSessionExpiredDetected")),h.a.instance.DXc(Object(f.a)(this,this.lIf,"onSessionExpiringDetected")))}fPa(){h.a.instance.rMd(Object(f.a)(this,this.fPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Q$h()}lIf(){h.a.instance.qMd(Object(f.a)(this,this.lIf,"onSessionExpiringDetected"));this.xje||this.NSc||
(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.xje=!0,this.MJj())}Q$h(){this.NSc||(c.AFrameworkApplication.AF(d.a.yxc),this.NSc=!0,this.LJj())}}Object(t.a)(m,"ASessionExpirationManager",null,[]);var l=a(89),v=a(38),r=a(29),A=a(13),x=a(45),n=a(254),u=a(6),z=a(82),w=a(257),C=a(73);class y extends m{constructor(oa){super();this.Pa=new v.a;this.SG=this.Rmb=!1;this.$=oa}mre(oa){this.Pa.addHandler("SessionExpired",oa)}lob(oa){this.Pa.addHandler("TokenRefreshed",
oa)}Luc(oa){this.Pa.removeHandler("TokenRefreshed",oa)}get accessTokenExpiringMessage(){const oa=(new Date(this.qk)).format(this.$.ya.ShortTimeFormat);return String.format(A.a.instance.ob(78),oa)}get tokenExpired(){return this.Rmb}get $db(){return!1}get Iba(){return!1}get tKd(){return!1}get i5(){return!1}Bec(){return h.a.instance.KQ(c.AFrameworkApplication.qk)}dispose(){l.a.Ja(this.Pa);this.$=null}MJj(){this.$.isEditMode&&this.aec(!1)}LJj(){this.Rmb=!0;this.aec(!0);this.Pa.raiseEvent("SessionExpired")}aec(oa){e.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${oa}, GotDeploymentOrTimedOutError ${this.$.ea.tZ}`);const Ja=this.$.qb.Ro;oa&&Ja&&Ja.isVisible&&1299163859===Ja.error.MessageId&&this.$.qb.Ro.dv();const Wb=this.ed(oa);x.a(this.$).tr(new n.a(u.a.ew,5,()=>{const nc=C.a(this.$),Yb=nc.gd.activityState;Yb[z.a.X1]=this.$.hqb(this.$.isEditMode);Yb[z.a.JL]=z.a.H9a;Yb[w.a.Bp]=u.a.accessTokenExpiringWarning;nc.gd.Wq([Wb])}))}ed(oa){return oa?r.a.TIe():this.Dgh()}Dgh(){const oa=
r.a.ed(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");oa.Description=this.accessTokenExpiringMessage;return oa}}Object(t.a)(y,"EwaAccessTokenExpirationManager",m,[593,594,2]);var B=a(7),H=a(174),I=a(79),R=a(649),S=a(28);class G{constructor(oa,Ja){this.YIb=!1;this.correlationID=oa;this.G6c=Ja;this.tCc=!1;this.creationTime=S.a.Ya.Ub}}Object(t.a)(G,"RefreshAccessTokenContext",null,[]);var D=a(59),E=a(60),M=a(162),L=a(44),N=a(112),Y=a(120),U=a(1),P=a(22),aa=a(147),X=a(36),Z=a(119);class da{}Object(t.a)(da,
"Error",null,[]);class qa{}Object(t.a)(qa,"NamedResult",null,[]);class O extends qa{}Object(t.a)(O,"ErrorInfo",qa,[]);class ca{constructor(oa,Ja){this.BYb=oa;this.iG=Ja}get tokens(){return this.BYb}get errors(){return this.iG}}Object(t.a)(ca,"TokenRefreshArgs",null,[512]);class wa{constructor(oa,Ja){this.documentVisibilityObserver=null;this.Pa=new v.a;this.tx=null;this.Teb=this.Plb=!1;this.Gtc=null;this.eJb=!1;this.lxd=!0;this.Jce=this.fce=this.SG=this.Rmb=!1;this.uS=null;this.N$e=()=>{if(this.$.ea.Xb)this.laf(!1);
else if(this.lxd){this.lxd=!1;const Wb=C.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Wb.Rh?Wb.Rh.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Meg()}]`)}};this.Rc=(Wb,nc)=>{this.context&&(Wb=this.$.ea,nc.lH&&this.context.YIb&&!this.context.tCc?(this.context.tCc=!0,nc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},nc.IsUserActive=
Wb.Ae.nr,nc.RefreshAccessTokenCorrelationID=this.context.correlationID,nc=D.a.Dc(nc),e.ULS.sendTraceTag(537170708,0,50,nc)):!this.Plb||Wb.Xb||this.context.G6c||(nc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.tx&&(this.tx.cancel(),nc.Aborted=!0,nc.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Teb=!1),nc.TimeUntilTokenExpirationInMin=this.Meg(),nc.RefreshAccessTokenCorrelationID=this.context.correlationID,nc=D.a.Dc(nc),e.ULS.sendTraceTag(572019856,
0,50,nc)))};this.Kya=()=>{if(this.context&&this.context.YIb&&!this.context.tCc){var Wb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Wb.CreatedForExpired=this.context.G6c;Wb.RefreshAccessTokenCorrelationID=this.context.correlationID;Wb.OpenWorkbookErrors=r.a.nc(this.$.ea.pF);Wb.ExecutionContextErrors=r.a.nc(C.a(this.$).gd.errors);Wb.accesstokenTTL=c.AFrameworkApplication.qk;Wb=D.a.Dc(Wb);e.ULS.sendTraceTag(537170707,0,15,Wb)}};this.kaf=()=>{this.Teb=!1;this.laf(!0)};this.JEd=
()=>{this.eJb&&(this.$.ea.Ae.Wza(this.JEd),this.eJb=!1);this.obg()};this.$=oa;this.WYd=Ja;this.qKd=oa.Jb.zg("WebServiceCall","refreshToken");h.a.instance.FXc(this.kaf);h.a.instance.DXc(this.N$e);Ja=this.$.ea;Ja.Jj(this.Rc);Ja.J_b(this.Kya);this.kIi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.E7f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.gTf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Kkg(oa.ea.oLf,c.AFrameworkApplication.qk);oa=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.qk,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.eha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.C2d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.E2d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${oa}`);this.$.da.gb(291,Wb=>{this.documentVisibilityObserver=Wb})}mre(oa){this.Pa.addHandler("SessionExpired",oa)}lob(oa){this.Pa.addHandler("TokenRefreshed",oa)}Luc(oa){this.Pa.removeHandler("TokenRefreshed",oa)}get tokenExpired(){return this.Rmb}get Iba(){return this.fce}get i5(){return this.Jce}get context(){return this.uS}get $db(){return this.i5?
!1:this.$.ea.Ae.nr?1>Z.a.L5:6>Z.a.N5}get tKd(){return this.Plb}Bec(){return h.a.instance.KQ(c.AFrameworkApplication.qk)}dispose(){h.a.instance.rMd(this.kaf);h.a.instance.qMd(this.N$e);const oa=this.$.ea;oa&&(oa.ik(this.Rc),oa.Nuc(this.Kya));l.a.Ja(this.Pa);this.documentVisibilityObserver=this.$=null}Meg(){return this.Bec()?0:(c.AFrameworkApplication.qk-(new Date).getTime())/6E4}Kkg(oa,Ja){if(0<Ja&&!this.Bec()){const Wb=c.AFrameworkApplication.fa.vd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.UX),
nc=(Ja-oa.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=nc,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Ja}] creationTime [${oa.getTime()}] tokenLifetimeInMin [${nc}]`);nc<this.kIi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.E7f}] tokenLifetimeInMin [${nc}]`),c.AFrameworkApplication.UX=this.E7f):
c.AFrameworkApplication.UX!==Wb&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Wb}] tokenLifetimeInMin [${nc}]`),c.AFrameworkApplication.UX=Wb)}}Uah(oa){return!this.context||this.context.YIb||this.context.G6c!==oa?(oa=new G(H.a.create().toString(),oa),this.context&&!this.context.tCc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${oa.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.YIb}] `),
this.uS=oa,!0):!1}$nj(oa){oa&&this.SG&&!this.Iba&&this.$.ea.Ae.nr&&!this.i5&&(this.SG=!1)}laf(oa){this.$nj(oa);if(!(this.Plb||this.Teb&&!oa||this.SG)&&this.$db){this.Plb=!0;var Ja=this.context?this.context.creationTime:null,Wb=this.Uah(oa);this.lxd=!0;var nc=this.$.ea,Yb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Yb.newContextCreated=Wb;Yb.IsUserActive=nc.Ae.nr;Yb.IsSessionActive=nc.Xb;Yb.ContainsChangesWorkbookOperations=this.$.userOperationManager.NHa();Yb.isSessionExpired=
oa;Yb.stopRefreshRetriesUntilTokenExpired=this.Teb;Yb.FailedToRefreshExpiredToken=this.SG;Yb.numOfFailuresWhileUserIsActive=Z.a.L5;Yb.numOfFailuresWhileUserIsInActive=Z.a.N5;Yb.numOfFailuresWhileOffline=Z.a.oya;Yb.RefreshAccessTokenCorrelationID=this.context.correlationID;Wb&&Ja&&(Yb.TimeInMinFromPreviosContextCreation=Math.round(Y.b(S.a.Ya,Ja)/60));Ja=D.a.Dc(Yb);e.ULS.sendTraceTag(40416199,0,50,Ja);this.qKd.start();this.fce=nc.Ae.nr;this.tx=new R.a;this.Ezi(oa);var pb=this.WYd.Bej(!oa,this.tx?this.tx.token:
null);pb.continueWith(()=>{this.E4g();const Fa=this.WYd.D9i(pb);this.qKd.stop();const ab=this.Bec();if(!Fa||U.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&ab){const Gb=pb.result.errors;Fa&&ab&&this.NIg(Gb);this.w$h(Gb,oa)}else this.Teb=!1,this.y$h(pb.result.tokens,oa);this.Plb=!1},8)}}NIg(oa){const Ja=[Object(B.a)(new da,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];oa.add(Object(B.a)(new O,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:Ja}))}Ezi(oa){oa&&(this.$.ea.Ae.nr?this.obg():(this.$.ea.Ae.w9(this.JEd),this.eJb=!0))}obg(){this.Gtc=M.AsyncMethodContext.tq(()=>{this.Aej()},1E3*this.gTf,L.a.iej,this.Gtc)}E4g(){this.Gtc&&this.Gtc.cancel();this.eJb&&(this.$.ea.Ae.Wza(this.JEd),this.eJb=!1);this.tx=null}Aej(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.gTf}]`);this.tx.cancel()}w$h(oa,Ja){this.Teb=!0;Ja&&(this.SG||(this.Rmb=this.SG=
!0),this.WYd.qBb(oa)&&(this.Jce=!0));const Wb=!Ja||this.$db&&!Z.a.kzc?40380379:39982555;Ja=this.uHe(Ja);Ja.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Ja.FailedToRefreshExpiredToken=this.SG;Ja.LastErrorIsPermanent=this.i5;if(0<oa.count){var nc=oa.ma(0);Ja.errorName=nc.Name;0<nc.Errors.length&&(Ja.ErrorId=nc.Errors[0].Id,nc=nc.Errors[0].Details,Ja.ErrorDetails=this.Qoh(nc.toString())?"PiiScrubbed":nc)}Ja=D.a.Dc(Ja);e.ULS.sendTraceTag(Wb,0,15,Ja);this.Pa.raiseEvent("TokenRefreshed",
new ca(null,oa))}Qoh(oa){return P.a.contains(oa,"makes the internet safe for businesses",!0)}uHe(oa){const Ja={},Wb=this.$.ea;Ja.Name="";Ja.IsUserActive=Wb.Ae.nr;Ja.IsSessionActive=Wb.Xb;Ja.GotDeploymentOrTimedOutError=Wb.tZ;Ja.TimeInSecFromLastStatefulSuccessfulRequest=Wb.QW;Ja.TimeFromLastUserActivityInMs=Wb.Ae.qfb;Ja.calledFromSessionExpiredFlow=oa;Ja.RefreshTokenDurationInMS=this.qKd.Bc;Ja.numOfFailuresWhileUserIsActive=Z.a.L5;Ja.numOfFailuresWhileUserIsInActive=Z.a.N5;Ja.numOfFailuresWhileOffline=
Z.a.oya;Ja.RefreshAccessTokenCorrelationID=this.context.correlationID;Ja.accessTokenTTL=c.AFrameworkApplication.qk;Ja.ContainsChangesWorkbookOperations=this.$.userOperationManager.NHa();Ja.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Vh.toString():"Unknown";Ja.TimeFromFirstOpenInHr=Math.floor(Y.b(S.a.Ya,N.toUtc(Wb.oLf))/3600);return Ja}y$h(oa,Ja){this.SG=!1;this.U1j();this.Kkg(new Date,c.AFrameworkApplication.qk);const Wb=this.$.ea,nc=!Ja&&Wb.Ae.nr,Yb=!this.$.isEditMode&&
Wb.Ebb;Ja=this.uHe(Ja);Ja.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Ja.shouldTriggerSilentReloadAfterExpiring=nc;Ja.WopiTokenTaskItemPriority=c.AFrameworkApplication.E2d;Ja.isDirtyViewSession=Yb;Ja=D.a.Dc(Ja);e.ULS.sendTraceTag(39982556,0,15,Ja);this.Pa.raiseEvent("TokenRefreshed",new ca(oa,null));Yb?Wb.Ae.nr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
Wb.Add()):Wb.Ae.nr?nc&&(oa=C.a(this.$).gd.activityState,oa[Z.a.Lfb]=!0,oa[aa.a.YX]=!0,oa[X.a.Jr]=this.$.isEditMode,x.a(this.$).tr(new n.a(u.a.xna,2,null))):Wb.Xb&&E.j(this.$.oa.xa,!0,!1,!1,null,null,null,null,null)}U1j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=I.a.fT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.bP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=I.a.fT(this.$.ea.workbookContext.WorkbookUri,
c.AFrameworkApplication.VX,c.AFrameworkApplication.qk.toString()),this.$.ea.Fqc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.qk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
I.a.fT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.bP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=I.a.fT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.VX,c.AFrameworkApplication.qk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=I.a.fT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.bP,c.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=I.a.fT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.VX,c.AFrameworkApplication.qk.toString()));this.context.YIb=!0}}Object(t.a)(wa,"EwaAccessTokenExpirationRefreshManager",null,[593,594,2]);var ia=a(191),Ha=a(160),Sa=a(84),Da=a(420);class ea{}ea.FZb="ActivityDuration";ea.error="Error";ea.O$c="Errors";ea.failed="Failed";ea.MHh="FirstActivity";ea.initialized="Initialized";ea.Qxi="LastActivity";ea.UZf="RetryOverride";ea.znj="RequestGroups";ea.requests="Requests";
ea.GZf="Responses";ea.zxc="SessionDuration";ea.status="Status";ea.success="Success";ea.successful="Successful";ea.tokens="Tokens";Object(t.a)(ea,"SessionExpirationStrings",null,[]);var sa=a(109);class Ea{constructor(oa){this.Ho={};this.iX={};this.HBg={};this.Nrf=15;this.ace=!1;this.qDg=new Date;this.XUb=new Date;this.he=oa;this.oYb=new sa.a(2,2,6E4*this.Nrf,Object(f.a)(this,this.Lng,"writeMeasures"),135,"SL",!1);this.he.fg(this.oYb);this.uhi()}Lng(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.Dc({["Aggregate"]:this.iX,
["Current"]:this.Ho}))}uhi(){this.iX[ea.znj]=0;this.iX[ea.requests]=0;this.iX[ea.GZf]=0;this.iX[ea.status]=ea.initialized;this.iX[ea.MHh]=new Date;this.iX[ea.zxc]=0;this.iX[ea.FZb]=0;this.iX[ea.zxc]=0;this.Ho[ea.zxc]=0;this.iX[ea.FZb]=0;this.Ho[ea.FZb]=0}nnd(oa,Ja){var Wb=oa[Ja];Wb=Wb?Wb:0;Wb++;oa[Ja]=Wb;this.JRd(oa)}JRd(oa){const Ja=new Date;oa[ea.FZb]=+Ja-+this.XUb;this.XUb=Ja;oa[ea.zxc]=+this.XUb-+this.qDg;oa[ea.Qxi]=this.XUb}n0(oa,Ja){this.Ho[oa]=Ja;this.JRd(this.Ho)}gRd(oa,Ja){this.Ho[oa]=Ja;
this.JRd(this.Ho)}incrementCounter(oa){this.nnd(this.Ho,oa);this.nnd(this.iX,oa);this.nnd(this.HBg,oa)}flush(){this.ace||(this.iX[ea.status]=this.Ho[ea.status],this.Lng(this.oYb),this.he.bna(this.oYb,6E4*this.Nrf))}stop(){e.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.ace=!0;this.he.So(this.oYb)}}Object(t.a)(Ea,"SessionLogger",null,[577]);var ba=a(99),ka=a(650),Ca=a(30),db=a(376),yb=a(167),kb=a(956),mb=a(193),W=a(148);class Q{constructor(oa,Ja,Wb,
nc=null,Yb=!1,pb=null,Fa=!1,ab=!1){this.Y8=0;this.N1=this.Ji=null;this.BYb=new ia.a;this.iG=new ia.a;this.Ck=null;this.BWa=!1;this.Tmb=this.Umb=null;this.he=oa;this.Zge=Ja;this.Zge.execute(Gb=>{Gb.Dl(yb.a.smd,Object(f.a)(this,this.wUi,"onHostResponseReceived"))});this.qG=Wb;this.Ale=new kb.a("WebServiceCall","TokenRefresh");this.nk=nc||new Ea(oa);this.lDg=Yb;this.VS=pb?pb:ka.SessionStatusManager.instance;this.O8d=Fa;this.qTb=ab}wUi(oa){if(oa.MessageId!==yb.a.smd)W.a(39408099,306,15,"Unexpected message.");
else{var Ja=new ia.a,Wb=new ia.a;this.nk.incrementCounter(ea.GZf);var nc=oa.Values[db.a.m3f];if(!nc||0>=nc.length)W.a(40122317,306,15,"Found no tokens in the dictionary"),nc=oa.Values;W.a(40122318,306,100,"The Tokens array contains {0} tokens",nc.length);this.nk.n0("Correlation",oa.CorrelationId);var Yb="";for(let ab=0;ab<nc.length;ab++){this.nk.gRd(ea.tokens,nc.length);var pb=nc[ab],Fa=pb;if(!Fa||!Fa.Name)continue;this.nk.incrementCounter(Fa.Name);const Gb=pb;if(Gb&&Gb.Value)W.a(39408128,306,100,
"Received token with name: {0}",Gb.Name),Ja.add(Gb),this.BYb.add(Gb),this.qTb||this.nk.n0(ea.status,ea.success),this.O8d&&this.VS&&this.VS.zoj();else if(pb=this.v2h(pb),W.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Fa.Name,JSON.stringify(pb),this.N1),Wb.add(pb),this.qTb||(this.iG.add(pb),Yb=JSON.stringify(pb),this.nk.n0(ea.error,JSON.stringify(pb)),this.nk.n0(ea.status,ea.failed)),this.O8d)for(const Ga of pb.Errors)Fa=this.iUh(Ga),this.VS&&this.VS.$Kg(Fa)}this.qTb?
(0<Wb.count?this.Tmb?this.Tmb(new ca(Ja,Wb)):W.a(512267295,306,15,"Received errors but the promise has completed"):this.Umb?this.Umb(new ca(Ja,Wb)):W.a(512267294,306,15,"Received valid tokens but the promise has completed"),W.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ja.count,Wb.count,oa.CorrelationId,this.N1)):(0<Wb.count&&""!==Yb?(nc=Object.assign(new mb.a,{extendedProperties:new Map}),nc.extendedProperties.set("Errors",Yb),nc.extendedProperties.set("RetryCount",
this.Y8.toString()),nc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),nc.extendedProperties.set("IsTokenExpiring",this.BWa.toString()),ba.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,nc)):ba.Health.instance.recordKpiSuccess("WACTokenRefresh",null),W.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ja.count,Wb.count,oa.CorrelationId,this.N1),0<Wb.count&&!this.qBb(Wb)?(oa=this.qG.H6e(Wb),
oa!==this.qG.Qcb&&(this.nk.gRd(ea.UZf,oa),this.he.bna(this.Ji,oa))):(this.nk.flush(),this.Ji&&(W.a(39408131,306,100,"Deleting task {0} from task manager",this.Ji.name),this.he.So(this.Ji)),this.Ck&&!this.Ck.task.isCompleted?this.Ck.setResult(new ca(Ja,Wb)):W.a(512267293,306,15,"Received results but the task has completed")))}}v2h(oa){if(!oa)return null;const Ja=Object.assign(new O,{Name:oa.Name,Errors:[]});for(const Wb of oa.Errors)oa=new da,oa.Id=Wb.Id,oa.Details=Ca.a.Did(Wb.Details,500),Ja.Errors.push(oa);
return Ja}requestTokensOnce(){this.PYf()}PYf(){c.AFrameworkApplication.ola("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Y8>=this.qG.evf?(W.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.N1),this.AHe(this.Ck,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(ba.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.x2f())}x2f(){const oa={};oa[db.a.m3f]=this.qG.tokens;
const Ja=H.a.create().toString();W.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.qG.tokens),this.Y8+1,Ja,this.N1);this.Zge.execute(Wb=>{Wb.jj(yb.a.Fte,oa,Ja)});this.Y8++;this.nk.incrementCounter(ea.requests)}AHe(oa,Ja,Wb){const nc=new ia.a;for(let Yb=0;Yb<this.qG.tokens.length;Yb++){const pb=Object.assign(new O,{Name:this.qG.tokens[Yb],Errors:[Object.assign(new da,{Id:Ja,Details:Wb})]});nc.add(pb);this.iG.add(pb)}this.he.So(this.Ji);this.nk.n0(ea.O$c,
JSON.stringify(this.iG));this.nk.n0(ea.status,ea.failed);oa&&!oa.task.isCompleted&&oa.setResult(new ca(new ia.a,this.iG))}Bej(oa,Ja=null){c.AFrameworkApplication.ola("258ec738;j5j99381");c.AFrameworkApplication.ola("85gid169;g470d326");this.Ale.start();this.BWa=oa;this.N1=H.a.create().toString();W.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.N1,this.BWa);this.Y8=0;this.iG.clear();this.BYb.clear();const Wb=new Ha.a;this.Ck=Wb;Ja&&Ja.R(()=>{const nc=!!Wb&&!Wb.task.isCompleted;
W.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.N1,this.BWa,nc);nc&&this.AHe(Wb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.qTb?this.QYf(this.qG.evf).then(nc=>{this.Ck&&!this.Ck.task.isCompleted&&this.Ck.setResult(nc);this.Tmb=this.Umb=null;this.nk.n0(ea.O$c,JSON.stringify(this.iG));this.nk.n0(ea.status,ea.success);this.nk.flush()}).catch(nc=>{this.Ck&&!this.Ck.task.isCompleted&&this.Ck.setResult(Object(Sa.a)(512,
nc));this.Tmb=this.Umb=null;this.nk.n0(ea.O$c,JSON.stringify(this.iG));this.nk.n0(ea.status,ea.failed);this.nk.flush()}):(this.Ji=new sa.a(this.qG.priority,2,this.qG.Qcb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,yb.a.Fte,!0),this.lDg&&this.PYf(),this.he.fg(this.Ji));return this.Ck.task}QYf(oa){const Ja=this,Wb=new Promise((ab,Gb)=>{Ja.Umb=ab;Ja.Tmb=Gb;ba.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);Ja.x2f()}),nc=this,Yb=new Promise((ab,Gb)=>{window.setTimeout(()=>
{Gb(nc.FHe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},nc.qG.Qcb)});let pb=oa;const Fa=this;return new Promise((ab,Gb)=>{pb--;Promise.race([Wb,Yb]).then(Ga=>{ba.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ab(Ga)}).catch(Ga=>{var Ma=Fa.qG.Qcb;if(Object(Da.a)(512,Ga)&&(Ga=Object(Sa.a)(512,Ga),0<Ga.errors.count)){Fa.VBi(Ga.errors);Fa.Wq(Ga.errors);if(Fa.qBb(Ga.errors)){Gb(Ga);return}const Qa=Fa.qG.H6e(Ga.errors);Qa!==Fa.qG.Qcb?(Fa.nk.gRd(ea.UZf,
Qa),Ma=Qa):Fa.pvi(Ga.errors)&&(Ma=0)}pb?window.setTimeout(()=>{Fa.QYf(pb).then(ab).catch(Gb)},Ma):(Ma=Fa.FHe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Fa.Wq(Ma.errors),Gb(Ma),W.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Fa.N1))})})}Wq(oa){for(let Ja of oa)this.iG.add(Ja)}pvi(oa){if(!oa.count)return!1;oa=oa.ma(oa.count-1);return oa.Errors.length?"TIMEOUT"==oa.Errors[0].Id:!1}FHe(oa,Ja){const Wb=
new ia.a;for(let nc=0;nc<this.qG.tokens.length;nc++){const Yb=this.Kch(this.qG.tokens[nc],oa,Ja);Wb.add(Yb)}return new ca(new ia.a,Wb)}Kch(oa,Ja,Wb){return Object.assign(new O,{Name:oa,Errors:[Object.assign(new da,{Id:Ja,Details:Wb})]})}VBi(oa){if(oa.count){oa=oa.ma(oa.count-1);oa=JSON.stringify(oa);var Ja=Object.assign(new mb.a,{extendedProperties:new Map});Ja.extendedProperties.set("Errors",oa);Ja.extendedProperties.set("RetryCount",this.Y8.toString());Ja.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());Ja.extendedProperties.set("IsTokenExpiring",this.BWa.toString());ba.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ja);this.nk.n0(ea.error,oa);this.nk.n0(ea.status,ea.failed)}}D9i(oa){this.Ale.stop();const Ja=this.Lai(oa.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!Ja,this.N1,this.BWa,this.Y8,this.iG.count,0<oa.result.errors.count?oa.result.errors.ma(0).Name:"",0<oa.result.errors.count&&0<oa.result.errors.ma(0).Errors.length?oa.result.errors.ma(0).Errors[0].Id:"",0<oa.result.errors.count&&0<oa.result.errors.ma(0).Errors.length?oa.result.errors.ma(0).Errors[0].Details:"");return Ja?!1:this.C9i(oa.result.tokens)}qBb(oa){return this.qG.qBb(oa)}C9i(oa){for(let Ja=0;Ja<oa.count;Ja++){const Wb=oa.ma(Ja);if(Wb.Name===db.a.accessToken){const nc=(new Date).getTime();
Wb.Expiry>c.AFrameworkApplication.qk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Wb.Expiry,["NowGetTime"]:nc,["BootTime"]:c.AFrameworkApplication.eha},"PreviousAccessTokenTtl",c.AFrameworkApplication.qk),c.AFrameworkApplication.accessToken=Wb.Value,c.AFrameworkApplication.qk=Math.floor(Wb.Expiry),c.AFrameworkApplication.D2d=nc,c.AFrameworkApplication.qYa=Math.floor(Wb.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Wb.Expiry,["NowGetTime"]:nc,["BootTime"]:c.AFrameworkApplication.eha},"PreviousAccessTokenTtl",c.AFrameworkApplication.qk)}}return!0}Lai(oa){let Ja=!1;for(let Wb=0;Wb<oa.count;Wb++){Ja=!0;const nc=oa.ma(Wb);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",nc.Name,JSON.stringify(nc.Errors),this.N1)}return Ja}iUh(oa){let Ja=d.a.yxc;oa=parseInt(oa.Id);if(isNaN(oa))Ja=d.a.h6j;else{switch(oa){case 401:Ja=d.a.k6j;break;case 403:Ja=d.a.f6j;
break;case 500:Ja=d.a.g6j;break;case 503:Ja=d.a.j6j}Ja===d.a.yxc&&(Ja=500<oa?d.a.i6j:d.a.e6j)}return Ja}}Object(t.a)(Q,"TokenRefreshManager",null,[513]);class va{constructor(){this.Qcb=c.AFrameworkApplication.n6j;this.evf=c.AFrameworkApplication.l6j;this.tokens=c.AFrameworkApplication.l7h();this.priority=c.AFrameworkApplication.E2d;this.hie=this.BAj();this.gVc=c.AFrameworkApplication.k7h()}qBb(oa){oa=JSON.stringify(oa);if(this.gVc&&0<this.gVc.length)for(const Ja of this.gVc)if(0<Ja.length&&0<=oa.indexOf(Ja))return!0;
return!1}H6e(oa){try{if(oa)for(let Ja of oa)if(Ja.Errors)for(const Wb of Ja.Errors)if(Wb.Id in this.hie)return Number.parseInvariant(this.hie[Wb.Id].toString())}catch(Ja){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ja.toString())}return this.Qcb}BAj(){const oa={};try{if(!c.AFrameworkApplication.Ldc()||0>=c.AFrameworkApplication.Ldc().length||""===c.AFrameworkApplication.Ldc()[0])return oa;for(const Ja of c.AFrameworkApplication.Ldc())0<Ja.length&&
(oa[Ja]=c.AFrameworkApplication.m6j)}catch(Ja){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Ja.toString())}return oa}}Object(t.a)(va,"TokenRefreshPolicy",null,[511]);class na extends b.a{constructor(oa){super();this.$=oa;this.Db()}create(){c.AFrameworkApplication.fN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.pa("RefreshAccessTokenSilently")?this.nb(this.Pch()):
this.nb(this.$.da.Aa(38)||this.$.da.Ha(38,new y(this.$)))}Pch(){var oa=this.$.da.Aa(38);if(oa)return oa;oa=new Q(c.AFrameworkApplication.hi,c.AFrameworkApplication.nQ(),new va);return this.$.da.Ha(38,new wa(this.$,oa))}static ka(oa){oa.da.Ha(39,new na(oa))}}Object(t.a)(na,"AccessTokenExpirationManagerFactory",b.a,[]);var Ba=a(9);a.d(F,"a",function(){return Oa});const Oa=()=>{Ba.a.Fa(na.ka)}},1224:function(t,F,a){t=a(0);var c=a(85),b=a(150);class e extends b.a{constructor(C){super(!1,!1,!0);this.lRb=
C}start(){const C={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.lRb.zmd}};this.initializeAndShow("",Object(c.a)(this,this.xpj,"resultHandler"),C)}xpj(C,y){1===C&&(this.lRb.zmd=y.tooltipPersistenceEnabled)}}Object(t.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(108),d=a(25);class h{constructor(C,y){this.Ma=C;this.lRb=y}Ag(){this.Ma.Nb(d.a.jHj,f.a.frame,Object(c.a)(this,this.kHj,"showAccessibilitySettingsDialogHandler"))}kHj(){(new e(this.lRb)).start();
return 32}}Object(t.a)(h,"AccessibilitySettingsDialogActor",null,[407]);var m=a(160),l=a(4);const v=C=>{const y=new m.a;l.AFrameworkApplication.Bd.Im(r(C),1,null,null,!0,2,B=>{200===B.data.httpStatus?y.setResult("true"===B.data.de.toLowerCase()):y.setResult(!1)},()=>{y.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return y.task},r=C=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",C,l.AFrameworkApplication.ti);
var A=a(146);class x{constructor(){this.lWa=null}get zmd(){return!!this.lWa}set zmd(C){C!==this.lWa&&(this.lWa=C,A.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(C),this.Nlf()&&l.AFrameworkApplication.Bd.Im(r("saveHoverableRibbonTooltipIsEnabled"),2,C.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}jAi(){const C=new m.a;if(this.lWa)C.setResult(this.lWa);else if(this.Nlf()){const y=v("getHoverableRibbonTooltipIsEnabled");y.continueWith(()=>
{this.lWa=y.result;A.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(y.result);C.setResult(y.result)},8)}else C.setResult(!1)}Nlf(){const C=l.AFrameworkApplication.fa.pa("IsRoamingServiceEnabled"),y=l.AFrameworkApplication.fa.pa("IsAnonymousUser");return C&&!y}}Object(t.a)(x,"AccessibilitySettingsInfo",null,[404]);var n=a(252),u=a(148);class z{constructor(){this.$a=null}get name(){return"Common.App.AccessibilitySettings"}Ah(C){this.$a=C;this.$a.register(x,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").yc(()=>
new x).qc();this.$a.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").yc(()=>new h(l.AFrameworkApplication.rb,this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).qc()}init(){const C=this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),y=this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");C&&y?(y.Ag(),C.jAi()):u.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){n.a.instance.gi(new z)}}Object(t.a)(z,"AccessibilitySettingsPackage",null,[4,5]);a.d(F,"a",function(){return w});const w=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");z.main()}},1225:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(15),f=a(89),d=a(27),h=a(420),m=a(478),l=a(521),v=a(168),r=a(228),A=a(24),x=a(65),n=a(41),u=a(166),
z=a(216),w=a(48),C=a(44),y=a(12),B=a(74),H=a(132),I=a(1),R=a(11),S=a(21),G=a(345),D=a(241),E=a(14),M=a(159),L=a(96),N=a(5),Y=a(253),U=a(68),P=a(45),aa=a(34);class X extends L.a{constructor(Ca,db,yb,kb){super(Ca);this.udg=[6];this.pdg=[26];this.Mr=null;this.fBb=this.Tjc=!1;this.fs=this.Xaa=null;this.onPointerDown=mb=>{if(1!==this.$.Ia.bH())return!0;mb=aa.a(this.$).me(mb);if(this.YA)return!0;var W=P.a(this.$).Uqd||P.a(this.$).ap();if(this.Ssd||W)return this.Dcb(),!0;this.fs=this.Vm;this.hLd();this.$ld();
W=2===mb.ub&&mb.Rn===Sys.UI.MouseButton.leftButton;const Q=3===mb.ub;if(W||Q)mb=this.ha.Wp(mb.clientPoint,mb.Mb,5,void 0,void 0,!0),mb||(mb=this.fs),this.fBb=W,this.Tjc=Q,this.fs=this.H8e(mb),this.$ld(),W?this.Kfj():Q&&this.Agj(),Y.b(this.$,!0);return!0};this.Ti=mb=>{mb=aa.a(this.$).me(mb);if(!this.YA)return!1;let W=this.fBb?this.ha.Wp(mb.clientPoint,mb.Mb,5,void 0,void 0,!0):this.ha.Wp(mb.clientPoint,mb.Mb,5,!0,!1,!0);W||(W=this.ha.Xob(mb.clientPoint,mb.Mb,5));W&&(mb=this.H8e(this.Cob(W)),this.$1b(mb.bottomRight),
this.fs.equals(mb)||(this.fs=mb,this.sJb(!1),this.hLd(!1),this.$ld(!1),this.Hci(),this.Cb.update(!1)),this.UZj(this.fs));return!0};this.Wg=mb=>{aa.a(this.$).me(mb);if(!this.YA)return!1;this.resizeTable();this.Dcb();return!0};this.NGb=mb=>{aa.a(this.$).me(mb);if(!this.YA)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Dcb();return!0};this.Cca=mb=>{aa.a(this.$).me(mb);this.Dcb();return!0};this.mAf=
()=>{this.YA&&this.Dcb()};this.gridView=db;this.$=db.$;this.tableManager=kb;this.ha=db.ha;this.Cb=db.Cb;this.parentElement=Ca;this.tZg();d.a.cp||d.a.xba||D.a.instance.ta(E.a.pointerDown,this.Xaa,this.onPointerDown);this.Vm=yb;this.NNc=this.Ssd=!1;this.tableManager.KLg(this.mAf)}get YA(){return this.fBb||this.Tjc}get Lmf(){return this.NNc}dispose(){this.Dcb();this.tableManager.Fij(this.mAf);this.Lmf||d.a.cp||d.a.xba||D.a.instance.Ba(E.a.pointerDown,this.Xaa,this.onPointerDown);if(this.YA){Y.b(this.$,
!1);try{this.Gv()}catch(Ca){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ca}`)}}this.parentElement&&this.parentElement.contains(this.Xaa)&&this.parentElement.removeChild(this.Xaa);this.Xaa=this.parentElement=null;super.dispose()}H8e(Ca){const db=Ca.bottom-this.Vm.topLeft.bottom-1;return 0<=Ca.right-this.Vm.topLeft.right+1&&0<=db&&Ca.bottom>=this.Vm.top&&Ca.right>=this.Vm.left?new A.Range(this.Vm.top,this.Vm.left,Ca.bottom,Ca.right,
!1,!1):this.fs}$ld(Ca=!0){this.byc([this.fs],6,Ca);this.Cb.Nq(this.udg)}sJb(Ca=!0){this.Cb.Nj(this.udg);this.byc([null],6,Ca)}hLd(Ca=!0){this.Cb.Nj(this.pdg);this.byc([null],26,Ca)}Hci(){const Ca=this.nQj();0<Ca.length&&(this.byc(Ca,26,!1),this.Cb.Nq(this.pdg))}nQj(){const Ca=[];this.Vm.contains(this.fs)&&(this.Vm.right!==this.fs.right&&Ca.push(new A.Range(this.Vm.top,this.fs.right+1,this.fs.bottom,this.Vm.right,!1,!1)),this.Vm.bottom!==this.fs.bottom&&Ca.push(new A.Range(this.fs.bottom+1,this.Vm.left,
this.Vm.bottom,this.Vm.right,!1,!1)));return Ca}resizeTable(){if(!this.fs.equals(this.Vm)){const Ca=new A.Range(this.Vm.top,this.Vm.left,this.fs.bottom,this.fs.right,!1,!1);this.fVj(Ca);this.Ssd=!0}}onKeyDown(Ca){aa.a(this.$).me(Ca);return!0}o$a(){this.Lmf&&(d.a.cp||d.a.xba||(D.a.instance.ta(E.a.pointerDown,this.Xaa,this.onPointerDown),this.Xaa.classList.remove("ewr-table-resize-default-cursor"),this.NNc=this.Xaa.disabled=!1),this.NNc=!1)}tZg(){const Ca=document.createElement("div");Ca.className=
"ewr-table-resize-handle";const db=document.createElement("div");db.className="ewr-table-resize-fillhandle-higher";const yb=document.createElement("div");yb.className="ewr-table-resize-fillhandle-broader";Ca.appendChild(db);Ca.appendChild(yb);this.Xaa=Ca;this.parentElement.appendChild(this.Xaa)}$1b(Ca){let db=60;const yb=this.fs.contains(Ca);let kb=Ca.top,mb=Ca.bottom,W=Ca.left,Q=Ca.right,va=null;if(yb){if(this.gridView.YM(this.Vm.topLeft)&&!this.Vm.ZAa)return;Ca.bottom<this.fs.bottom?(kb=Math.max(1,
mb-2,this.Vm.top),db=16):(W=Math.max(1,Q-2,this.Vm.left),db=4);mb=kb;Q=W;va=new A.Range(kb,W,kb,W,!1,!1)}else Ca.right>=this.Vm.right?(Q+=2,db=8):Ca.bottom>=this.Vm.bottom&&(mb+=2,db=32),kb=mb,W=Q,va=new A.Range(mb,Q,mb,Q,!1,!1),db=16;this.gridView.YM(va)||(this.Mr?this.Mr.ep||(this.Mr=w.a.instance.create(()=>{this.gridView.ov(va,db,"TableResizeBehavior.BringRangeIntoView")},40,C.a.sdg)):this.Mr=w.a.instance.create(()=>{this.gridView.ov(va,db,"TableResizeBehavior.BringRangeIntoView")},40,C.a.sdg))}Cob(Ca){let db=
Ca;if(this.gridView.ib.h4){if(!this.gridView.Qb(Ca.topLeft)){const yb=this.gridView.Wj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.cQ,this.fs.top!==Ca.top?1:2);try{yb.Ik=this.fs.top<Ca.top||this.fs.left<Ca.left,yb.vv(Ca.topLeft),db=yb.$$cu().range}finally{yb&&yb.dispose()}}db.right=db.left+Ca.width-1;db.bottom=db.top+Ca.height-1}return db}byc(Ca,db,yb=!0){const kb=[];for(const mb of Ca)kb.push(new G.a(mb,x.d(this.$.na)));this.Cb.xB(kb,[db],!0,void 0,yb)}Kfj(){D.a.instance.ta(E.a.yj,
document.documentElement,this.Ti);for(const Ca of this.gridView.xn)D.a.instance.ta(E.a.yj,Ca.domElement,this.Ti);D.a.instance.ta(E.a.Kf,document.documentElement,this.Wg);this.jMe()}Agj(){M.a.instance.ta(E.a.Tf,document.documentElement,this.Ti);for(const Ca of this.gridView.xn)M.a.instance.ta(E.a.Tf,Ca.domElement,this.Ti);M.a.instance.ta(E.a.ve,document.documentElement,this.NGb);this.jMe()}Gv(){this.fBb&&this.cYj();this.Tjc&&this.pYj()}cYj(){D.a.instance.Ba(E.a.yj,document.documentElement,this.Ti);
for(const Ca of this.gridView.xn)D.a.instance.Ba(E.a.yj,Ca.domElement,this.Ti);D.a.instance.Ba(E.a.Kf,document.documentElement,this.Wg);this.eTf()}pYj(){M.a.instance.Ba(E.a.Tf,document.documentElement,this.Ti);for(const Ca of this.gridView.xn)M.a.instance.Ba(E.a.Tf,Ca.domElement,this.Ti);M.a.instance.Ba(E.a.ve,document.documentElement,this.NGb);this.eTf()}jMe(){this.gridView.mc.R8b(!0)}eTf(){this.gridView.mc.R8b(!1)}fVj(Ca){this.$.Zc(-1400250766,U.a.zb,30,{["ResizeTableRange"]:Ca,["OriginalTableRange"]:this.Vm})}UZj(Ca){if(!this.Vm.contains(Ca)){Ca=
this.mQj();for(const db of Ca)if(this.tableManager.rtd(db)){this.gridView.Gg.qp(N.a.eLi);return}}this.gridView.rtl?this.gridView.Gg.qp(N.a.mKi):this.gridView.Gg.qp(N.a.pMi)}Dcb(){if(this.YA){Y.b(this.$,!1);try{this.Gv()}catch(Ca){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ca}`)}}this.Mr&&(this.Mr.cancel(),this.Mr.dispose());this.Tjc=this.fBb=!1;this.sJb();this.hLd();Y.b(this.$,!1);this.gridView.Gg.qp(N.a.LU)}mQj(){const Ca=[];
this.Vm.right!==this.fs.right&&Ca.push(new A.Range(this.Vm.top,this.Vm.right+1,this.fs.bottom,this.fs.right,!1,!1));this.Vm.bottom!==this.fs.bottom&&Ca.push(new A.Range(this.Vm.bottom+1,this.Vm.left,this.fs.bottom,this.Vm.right,!1,!1));return Ca}static createInstance(Ca,db,yb,kb){if(!db)return null;const mb=Ca.Cb;mb.xB(yb,[27],!0);mb.Nq(X.fQj);yb=mb.KC(27,Ca.ib.yi(db.bottomRight),X.zTh(db,yb)).hg;return new X(yb,Ca,db,kb)}static zTh(Ca,db){var yb;for(let kb=0;kb<db.length;kb++)if((null===(yb=db[kb])||
void 0===yb?0:yb.range)&&db[kb].range.equals(Ca))return kb;return 0}}X.fQj=[27];Object(t.a)(X,"TableResizeBehavior",L.a,[]);var Z=a(7);L=a(239);class da{}da.Xyh="ewa-ttrd-buttonarea";Object(t.a)(da,"CssClassNames",null,[]);var qa=a(49),O=a(127),ca=a(94),wa=a(22),ia=a(13),Ha=a(258),Sa=a(128),Da=a(267);class ea extends L.a{constructor(Ca){super(document.createElement("div"));this.KVc=this.$pd=this.HLf=this.pQ=!1;this.yLb=null;this.Eh=()=>{z.c(this.$,this.gridView.ha.qa.activeCell)?(this.cMa=!0,this.jsb(!1)):
(this.LZ=this.cMa=!1,this.tig())};this.zt=()=>{this.cMa?this.jsb(!0):this.LZ=!1};this.qAf=()=>{this.KVc=!0;this.cMa&&(this.LZ=!1)};this.onContentReady=()=>{this.$.isEditMode?z.c(this.$,this.gridView.ha.qa.activeCell)&&(this.cMa=!0,this.jsb(!1)):this.LZ=!1};this.vya=()=>{this.KVc=!1;this.cMa?this.jsb(!1):this.LZ=!1};this.nf=(db,yb)=>{this.cMa&&(db=this.gridView.jab(yb.Yc.block.ae.BlockCachePosition.PaneType).HB(yb.Yc.hash))&&(db.wMd(this.sbf),db.NXc(this.sbf))};this.sbf=()=>{this.pXf()};this.$=Ca;
this.gridView=S.h(this.$);this.parentElement=this.domElement;this.parentElement.className=da.Xyh;this.cLa=this.gridView.pj;this.cMa=!0;this.chi();this.QTg();this.jsb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get LZ(){return this.$pd}set LZ(Ca){this.$pd!==Ca&&(this.$pd=this.isVisible=Ca)}get aCb(){return!!(this.$.qd&16)}get qqi(){const Ca=this.gridView.ha.qa.activeCell;return Ca.right===Ca.maxColumns}get unb(){const Ca=this.gridView.Qb(null);return Ca&&
this.gridView.Aba(Ca.range)?this.sva(Ca):(Ca&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Clh();this.$=this.gridView=this.parentElement=this.cLa=null;super.dispose()}rRh(Ca){const db=this.p5h(this.gridView.Qb(null).range);return db?`=SUBTOTAL(${Ca},${db})`:null}p5h(Ca){var db=S.h(this.$).wb.zi(Ca);if(!db)return null;db=u.a(db,!1);db.right=db.left=Ca.left;return db.toString()}chi(){ea.PL={};ea.PL["100"]=
ia.a.instance.ga(1103);ea.PL["101"]=ia.a.instance.ga(1106);ea.PL["102"]=ia.a.instance.ga(1105);ea.PL["103"]=ia.a.instance.ga(1110);ea.PL["104"]=ia.a.instance.ga(1107);ea.PL["105"]=ia.a.instance.ga(1108);ea.PL["109"]=ia.a.instance.ga(1104);ea.PL["107"]=ia.a.instance.ga(1111);ea.PL["110"]=ia.a.instance.ga(1113);ea.PL["111"]=ia.a.instance.ga(1164)}r3i(){var Ca=this.gridView.Qb(null);if(Ca&&(Ca=Ca.OA?Ca.formulaBarText:null))if("=SUBTOTAL("===Ca.substring(0,10)){if(Ca=Ca.substring(10,13),Ca in ea.PL)return Ca}else return"111";
return"100"}QTg(){this.gridView.Ca.Ns(this.nf);this.gridView.ha.wG(this.Eh);this.gridView.Uu(this.onContentReady);this.gridView.mc.xl(this.qAf);this.gridView.mc.Jm(this.vya)}Clh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.EK(this.Eh),this.gridView.Ca.Hq(this.nf)),this.gridView.jy(this.onContentReady),this.gridView.mc&&(this.gridView.mc.nl(this.qAf),this.gridView.mc.$l(this.vya)),this.tig())}jsb(Ca){this.e_j(Ca);this.aCb&&(this.LOj(),this.unb?(this.HLf||this.$Tg(),this.KVc?this.LZ=!1:(this.LZ=
!0,this.pXf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.LZ=!1))}pXf(){appChrome.renderTableTotalRowOptions(this.parentElement,ea.PL,ea.PL[this.r3i()].toString(),Math.round(aa.a(this.$).ki(17)),Ca=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${Ca}`);let db={["SelectedOption"]:ea.PL[Ca],["FunctionKeyCode"]:Ca,["Location"]:"canvas"};Sa.b(this.$).rd(O.a.rQj,
db,null,!0);if("111"===Ca)return this.wki(),!0;if("100"!==Ca){this.yLb=this.rRh(Ca);if(!this.yLb)return e.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.NRa(this.yLb)}else this.NRa("");y.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}wki(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const Ca=new ca.a(753860909,0,this.$.isEditMode?
2:1,19,null);this.$.Ia.Hb(Ca)}sva(Ca){if(!Ca)return null;var db=this.gridView.mc.textBox.domElement;var yb=0<y.DOMElementExtensions.getHeight(db)&&0<y.DOMElementExtensions.getWidth(db)&&0<=db.offsetTop&&0<=db.offsetLeft;if(yb)db=y.DOMElementExtensions.sva(db,this.gridView.pj);else{db=this.gridView.getCellBounds(Ca.cell);var kb=y.DOMElementExtensions.getBoundingClientRect(this.gridView.pj);db=new Sys.UI.Bounds(db.x-kb.x,db.y-kb.y,db.width,db.height)}if(db)if(yb)2<db.height&&2<db.height&&(db.x+=1,db.y+=
1,db.height-=2,db.width-=2);else if(yb=S.h(this.$).GJ(Ca.cell))yb=yb.width,kb=wa.a.equals(Ha.a.Bwb(Ca.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&kb&&(db.x=db.x+db.width-yb),Ca.Eba&&this.gridView.rtl===kb&&(db.width=yb);else return null;return db}e_j(Ca){var db=this.unb;if(db){var yb=17>=db.height?db.y:db.y+db.height-17-2;db=this.qqi?this.gridView.rtl?db.x:db.x+db.width-(17<db.height?17:db.height):this.gridView.rtl?db.x-(17<db.height?17:db.height):db.x+db.width;var kb=aa.a(this.$).Ija(new Sys.UI.Point(db,
yb));this.parentElement.style.top=R.HelperMethods.sc(kb.y);this.parentElement.style.left=R.HelperMethods.sc(kb.x);aa.a(this.$).Szj(this.parentElement);Ca&&(this.LZ=this.gridView.dkc(new qa.a(db,yb)))}else this.LZ=!1}$Tg(){this.cLa.insertBefore(this.parentElement,this.cLa.firstChild);this.HLf=!0}LOj(){this.pQ||(this.gridView.view.Ps(this.zt),this.pQ=!0)}tig(){this.pQ&&this.gridView.view&&(this.gridView.view.Jq(this.zt),this.pQ=!1)}NRa(Ca){const db=this.gridView.Vb,yb=this.gridView.Qb(null);yb&&(Ca=
Object(Z.a)(new Da.a,{Text:Ca}),this.gridView.setCell(Ca,yb.range,0,127,null),db.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}ea.qQj="TableTotalRowDropDownIconButtonId";ea.PL=null;Object(t.a)(ea,"TableTotalRowOptions",L.a,[2]);class sa extends m.a{constructor(Ca){super(S.h(Ca));this.Cqb=this.A0=this.yBc=this.Aqb=null;this.yte=!1;this.wce=null;this.JSb=0;this.D6b=null;this.r1b=()=>{const db={},yb=this.jid();for(let mb in yb){const W=yb[mb];if(!W)continue;const Q=this.r4h(W);if(Q){if(Q in this.KFa){var kb=
this.KFa[Q];if(kb.YA){kb.Vm.equals(W)||(kb.Vm=W);delete this.KFa[Q];db[Q]=kb;continue}}(kb=X.createInstance(S.h(this.$),W,this.lOh(),this))?db[Q]=kb:e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${W.NC(!1)}`)}}this.D3b(null,null);this.pRb=db};this.D3b=()=>{const db=this.KFa;for(let mb in db){var yb=mb,kb=db[mb];kb&&(kb.dispose(),delete this.KFa[yb])}this.pRb={}};this.lRf=()=>{this.D3b(null,null);this.r1b(null,null)};this.onFocus=()=>
{this.wce=S.h(this.$).ha.qa.activeCell};this.S5=()=>{this.$.isEditMode&&this.Eh(null,null)};this.Eh=()=>{!this.yte&&z.c(this.$,this.gridView.ha.qa.activeCell)&&this.uAi()};this.xV=()=>{this.Dzb(1);this.$.ea.Bn(this.xV)};this.WHb=()=>{this.yte=!0;this.yBc=new ea(this.$)};this.$=Ca;this.gridView=S.h(this.$);this.$.da.Ha(66,this);this.pRb={};this.r1b(null,null);this.$.va&&this.$.va.Vf(this.lRf);this.xXc(this.r1b);this.$.ea.e2(this.S5);this.gridView.ha.wG(this.Eh);this.$.isEditMode&&this.Eh(null,null)}xXc(Ca){this.addHandler(m.a.rbb,
Ca)}kMd(Ca){this.removeHandler(m.a.rbb,Ca)}KLg(Ca){this.addHandler("tce",Ca)}Fij(Ca){this.removeHandler("tce",Ca)}get KFa(){return this.pRb}get Iud(){return this.wce}get vIa(){return this.JSb}get Dg(){const Ca=S.h(this.$);return Ca.wb.zi(Ca.ha.qa.activeCell,!1)}get OHd(){return this.Iud?S.h(this.$).wb.zi(this.Iud,!1):null}rtd(Ca){return!!this.D5e(Ca)}Mp(Ca){return this.S0h(this.m6e(Ca))}hwb(Ca){return this.m6e(Ca)}xgj(Ca){Ca?(this.Cqb?this.Cqb!==Ca&&(f.a.Ja(this.A0),this.A0=null,this.Cqb=Ca):this.Cqb=
Ca,this.A0||(this.A0=H.a.instance.ie(this.Cqb)),this.A0.Bi("focusin")||this.A0.ka("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Xif(Ca,db){return Ca?Ca.$ja&&Ca.top===db.top:(e.ULS.shipAssertTag(537151244,0,!!Ca,"autofilterRange can't be null"),!1)}Gja(Ca){Ca=this.Aqb?n.I(Ca,this.Aqb):this.view.getRangeInformation(Ca);return 0<Ca.length&&Object(h.a)(r.PivotTableRange,Ca[0])?Ca[0]:null}Qmi(Ca,db){return Ca?!Ca.Dhc&&
!!Ca.gJ&&Ca.gJ.zd(db):(e.ULS.shipAssertTag(537151243,0,!!Ca,"Pivot table can't be null"),!1)}gti(Ca,db){return Ca?!Ca.Dhc&&!!Ca.NK&&Ca.NK.zd(db):(e.ULS.shipAssertTag(537151242,0,!!Ca,"Pivot table can't be null"),!1)}h_b(Ca){super.h_b(Ca);if((Ca=R.HelperMethods.O5e(Ca))&&0<Ca.length){this.Aqb=Array(Ca.length);for(let db=0;db<Ca.length;db++)this.Aqb[db]=v.a.bQ(Ca[db])}}lJb(){super.lJb();this.Aqb=null}pah(Ca,db){return this.FGe(Ca,db).returnValue}FGe(Ca,db){var yb=!1;if(!Ca||!db)return{returnValue:!1,
jY:yb};Ca=Ca.clone();Ca.right+=1;Ca.left=Ca.right;return!Ca.lz||Ca.top<db.ib.Mi&&(yb=Ca.clone(),yb.bottom>=db.ib.Mi&&(yb.bottom=db.ib.Mi-1),!({jY:yb}=this.EGe(yb,db)).returnValue)||Ca.bottom>=db.ib.Mi&&(yb=Ca.clone(),yb.top<=db.ib.Mi&&(yb.top=db.ib.Mi),!({jY:yb}=this.EGe(yb,db)).returnValue)?{returnValue:!1,jY:yb}:{returnValue:!0,jY:yb}}tdg(Ca){(Ca=this.Mp(Ca.topLeft))&&Ca.toString()in this.KFa&&(this.KFa[Ca.toString()].Ssd=!1)}jaj(){this.raiseEvent("tce")}Mh(Ca,db){if(!this.yBc)return!1;switch(db){case -569786022:case 541421805:if(this.yBc.LZ){const yb=
document.getElementById(ea.qQj);yb&&w.a.instance.create(()=>{y.DOMElementExtensions.vgc(yb,null)},0,C.a.jQj,!0,!0)}return!0;default:return!1}}dispose(){this.D3b(null,null);this.kMd(this.r1b);this.$.va.sg(this.lRf);this.$.ol(this.D3b);this.pRb=null;this.$.ea&&this.$.ea.D6(this.S5);this.gridView.ha.EK(this.Eh);this.yBc=null;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.A0&&(f.a.Ja(this.A0),this.A0=null);super.dispose()}eai(Ca,db,yb,kb){const mb=this.gridView.wb.zi(new A.Range(db,
yb,db,yb,!1,!1));if(this.D6b=mb){var W=mb.usedRange,Q=Ca.ctrlKey||d.a.isMac&&B.b(Ca),va=!Ca.shiftKey&&Q;Ca=Ca.shiftKey&&!Q;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(S.h(this.$).ha.selectionType=3);switch(kb){case 0:this.JSb=0;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(db=this.C6c(Ca,W.top,yb,W.bottom,yb),this.lSd(db,va,Ca)):this.mSd(W.top,yb,W.bottom,yb,u.d(mb),u.g(mb),va);break;case 1:this.JSb=1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(db=this.C6c(Ca,db,W.left,db,W.right),this.lSd(db,va,Ca)):this.mSd(db,W.left,db,W.right,!1,!1,va);break;case 2:this.JSb=2;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(db=this.C6c(Ca,W.top,W.left,W.bottom,W.right),this.lSd(db,va,Ca)):this.mSd(W.top,W.left,W.bottom,W.right,u.d(mb),u.g(mb),va);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${kb.toString()}`);return}I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&
(S.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}xEj(Ca){const db=this.D6b.usedRange;return this.ilf(Ca)||1!==this.vIa&&this.ilf(new A.Range(db.top,Ca.left,db.bottom,Ca.right,!1,!1))?!0:!1}hJd(Ca){return Ca.Autofilters}EGe(Ca,db){let yb;yb=!1;const kb=
db.ib.yi(Ca),mb=db.Rf(kb).fi;if(!mb)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${kb}`),{returnValue:!1,jY:yb};if(!mb.De(Ca))return{returnValue:!0,jY:yb};Ca=db.Wj("TableManager.CouldExpandImpl",Ca,2);try{for(;Ca.$$mn();){if(Ca.$$cu().text||Ca.Mm.Waf)return yb=!0,{returnValue:!1,jY:yb};if(Ca.$$cu().sH)return{returnValue:!1,jY:yb}}}finally{Ca&&Ca.dispose()}return{returnValue:!0,jY:yb}}S0h(Ca){if(!Ca)return null;const db=new l.AutofilterRange(Ca.top,
Ca.left,Ca.bottom,Ca.right,null,null,null,Ca.id,Ca.$ja);db.ZAa=Ca.ZAa;const yb=this.gridView.wb.zi(Ca,!0);if(!yb)return null;for(let kb=0,mb=this.rangeList.length;kb<mb;kb++){const W=this.rangeList[kb],Q=this.gridView.wb.zi(W,!0);Q&&Q.name===yb.name&&W!==Ca&&this.osi(W)&&(db.union(W),W.ZAa&&(db.ZAa=!0))}return db}osi(Ca){return!!S.h(this.$).wb.zi(Ca)}lOh(){const Ca=[];for(const db of this.rangeList){const yb=new G.a(this.Mp(db.topLeft),x.d(this.$.na));Ca.push(yb)}return Ca}jid(){const Ca={};for(const db of this.rangeList){if(!db)continue;
const yb=this.Mp(db.topLeft);yb&&(Ca[yb.toString()]=this.Mp(db.topLeft))}return Ca}uAi(){this.$.ea.Zf?this.Dzb(0):this.$.ea.Dk(this.xV)}Dzb(Ca){this.$.Sx(db=>{db.Gaa(Ca).then(this.WHb)})}r4h(Ca){const db=this.gridView.wb.zi(Ca);return db?db.name:Ca.toString()}mSd(Ca,db,yb,kb,mb,W,Q){const va=Ca+(mb?1:0),na=yb-(W?1:0),Ba=this.gridView.inRangePicker||this.gridView.Uh;let Oa=!1;const oa=new A.Range(va,db,na,kb,!1,!1);if(mb||W){mb=Ba?G.a.Csb(this.gridView.ha.rangePicker.yK):this.gridView.ha.qa.selectedRanges;
for(const Ja of mb){Oa=this.Irb(Ja,va,db,na,kb);mb=this.Irb(Ja,Ca,db,yb,kb);if(Ba&&Oa)break;if(!Ba&&(Oa||mb)){this.gridView.ha.updateSelection(Ja,Ja.topLeft,0,1);if(Q&&mb)return;break}}}Oa&&(oa.top=Ca,oa.bottom=yb);Ca=oa.topLeft;Q?this.gridView.ha.updateSelection(oa,Ca,0,1):Ba?this.gridView.ha.sy([oa],0,Ca,0):this.gridView.ha.updateSelection(oa,Ca,0,3)}lSd(Ca,db,yb){Ca&&(yb=yb?S.h(this.$).ha.qa.activeCell:Ca.topLeft,db?this.gridView.ha.updateSelection(Ca,yb,0,1):this.gridView.ha.sy([Ca],0,yb,0))}C6c(Ca,
db,yb,kb,mb){const W=u.d(this.D6b),Q=u.g(this.D6b),va=db+(1!==this.vIa&&W?1:0),na=kb-(1!==this.vIa&&Q?1:0),Ba=this.gridView.inRangePicker||this.gridView.Uh;if(Ca){var Oa=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Ba&&!G.a.Csb(this.gridView.ha.rangePicker.yK).length?new A.Range(va,yb,na,mb,!1,!1):Ba?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.qa.activeCell;Oa=new A.Range(Oa.top<va?Oa.top:va,Oa.left<yb?Oa.left:yb,Oa.bottom>na?Oa.bottom:na,Oa.right>mb?
Oa.right:mb,!1,!1)}else Oa=new A.Range(va,yb,na,mb,!1,!1);if(1!==this.vIa&&(W||Q)&&(!Ca||Ca&&this.Irb(Oa,va,yb,na,mb))){Ca=Ba?G.a.Csb(this.gridView.ha.rangePicker.yK):this.gridView.ha.qa.selectedRanges;for(const oa of Ca)if(this.Irb(oa,va,yb,na,mb)){Oa.top=db;Oa.bottom=kb;break}}return Oa}ilf(Ca){const db=this.gridView.inRangePicker||this.gridView.Uh?G.a.Csb(this.gridView.ha.rangePicker.yK):this.gridView.ha.qa.selectedRanges;for(const yb of db)if(this.Irb(yb,Ca.top,Ca.left,Ca.bottom,Ca.right))return!0;
return!1}Irb(Ca,db,yb,kb,mb){return!!Ca&&Ca.top===db&&Ca.bottom===kb&&Ca.left===yb&&Ca.right===mb}}Object(t.a)(sa,"TableManager",m.a,[392,2]);class Ea extends b.a{constructor(Ca){super();this.tableManager=null;this.$=Ca;this.Db()}create(){this.nb(this.tableManager||(this.tableManager=new sa(this.$)))}}Object(t.a)(Ea,"TableManagerFactory",b.a,[]);var ba=a(1242);a.d(F,"a",function(){return ka});const ka=()=>{c.a.Fa(Ca=>{Ca.da.Ha(134,new Ea(Ca));Ca.da.Ha(330,new ba.a(Ca))})}},1242:function(t,F,a){t=
a(0);var c=a(226),b=a(50),e=a(37),f=a(7),d=a(15),h=a(111),m=a(843),l=a(1489),v=a(739),r=a(1344),A=a(38),x=a(5),n=a(165),u=a(68),z=a(60),w=a(166),C=a(48),y=a(44),B=a(112);a(28);var H=a(197),I=a(29),R=a(250),S=a(1),G=a(22),D=a(13);a(30);class E{}Object(t.a)(E,"TableStyleElement",null,[]);var M=a(763),L=a(214),N=a(92),Y=a(526);class U{static Rsf(qa,O){return U.wdg[qa.Type]-U.wdg[O.Type]}static v4a(qa,O){try{return appChrome.buildTableStyleGalleryIconNew(U.kBa,U.joa,qa,O)}catch(ca){return null}}static Nmf(qa){return qa&&
u.a.Kc in qa&&(qa=qa[u.a.Kc])?G.a.KF(qa,x.a.fIb):!1}static $sa(qa){const O=[];let ca=0;for(const wa of qa){O[ca]={};O[ca].backgroundColor="white";O[ca].color="black";for(let ia in wa)switch(qa=wa[ia],ia){case "background-color":O[ca].backgroundColor=qa;break;case "color":O[ca].color=qa;break;case "font-size":O[ca].fontSize=qa;break;case "border-bottom":O[ca].borderBottom=qa;break;case "border-right":O[ca].borderRight=qa;break;case "border-left":O[ca].borderLeft=qa;break;case "border-top":O[ca].borderTop=
qa}ca++}return O}static e5b(qa,O){const ca=[];if(null===qa||void 0===qa?0:qa.TableStyleElementsList){var wa=0===qa.Category;for(let ia=0;ia<U.joa;ia++)ca.push(...U.oSh(qa,O,wa,ia))}else{if(U.Z7c)return U.Z7c;qa={color:"black","background-color":"white"};for(O=0;O<U.joa;O++)for(wa=0;wa<U.kBa;wa++)ca.push(qa);U.Z7c=ca}return ca}static s4h(qa,O){if(!qa.TableStyleElementsList)return"";let ca="";for(const wa of qa.TableStyleElementsList)if(wa.BackgroundColor&&"#000000"!==wa.BackgroundColor)switch(wa.Type){case 0:ca=
wa.BackgroundColor;break;case 5:case 7:if(O.Fha||O.BR)ca=wa.BackgroundColor;break;case 3:case 4:if(O.firstCol||O.lastCol)ca=wa.BackgroundColor;break;case 2:O.totalRow&&(ca=wa.BackgroundColor);break;case 1:O.headerRow&&(ca=wa.BackgroundColor)}return ca}static g4b(qa){qa=new L.a(parseInt(String("0x"+qa.substr(1,2)),16),parseInt(String("0x"+qa.substr(3,2)),16),parseInt(String("0x"+qa.substr(5,2)),16));return M.a.GKa(qa)}static c8e(qa,O){if(!qa||!O)return"";O=(O=U.s4h(qa,O))?U.g4b(O)+", ":D.a.instance.ga(2067)+
", ";switch(qa.Index){case 0:return O+D.a.instance.ga(2001);case 1:return O+D.a.instance.ga(2002);case 2:return O+D.a.instance.ga(2003);case 3:return O+D.a.instance.ga(2004);case 4:return O+D.a.instance.ga(2005);case 5:return O+D.a.instance.ga(2006);case 6:return O+D.a.instance.ga(2007);case 7:return O+D.a.instance.ga(2008);case 8:return O+D.a.instance.ga(2009);case 9:return O+D.a.instance.ga(2010);case 10:return O+D.a.instance.ga(2011);case 11:return O+D.a.instance.ga(2012);case 12:return O+D.a.instance.ga(2013);
case 13:return O+D.a.instance.ga(2014);case 14:return O+D.a.instance.ga(2015);case 15:return O+D.a.instance.ga(2016);case 16:return O+D.a.instance.ga(2017);case 17:return O+D.a.instance.ga(2018);case 18:return O+D.a.instance.ga(2019);case 19:return O+D.a.instance.ga(2020);case 20:return O+D.a.instance.ga(2021);case 21:return O+D.a.instance.ga(2022);case 22:return O+D.a.instance.ga(2023);case 23:return O+D.a.instance.ga(2024);case 24:return O+D.a.instance.ga(2025);case 25:return O+D.a.instance.ga(2026);
case 26:return O+D.a.instance.ga(2027);case 27:return O+D.a.instance.ga(2028);case 28:return O+D.a.instance.ga(2029);case 29:return O+D.a.instance.ga(2030);case 30:return O+D.a.instance.ga(2031);case 31:return O+D.a.instance.ga(2032);case 32:return O+D.a.instance.ga(2033);case 33:return O+D.a.instance.ga(2034);case 34:return O+D.a.instance.ga(2035);case 35:return O+D.a.instance.ga(2036);case 36:return O+D.a.instance.ga(2037);case 37:return O+D.a.instance.ga(2038);case 38:return O+D.a.instance.ga(2039);
case 39:return O+D.a.instance.ga(2040);case 40:return O+D.a.instance.ga(2041);case 41:return O+D.a.instance.ga(2042);case 42:return O+D.a.instance.ga(2043);case 43:return O+D.a.instance.ga(2044);case 44:return O+D.a.instance.ga(2045);case 45:return O+D.a.instance.ga(2046);case 46:return O+D.a.instance.ga(2047);case 47:return O+D.a.instance.ga(2048);case 48:return O+D.a.instance.ga(2049);case 49:return O+D.a.instance.ga(2050);case 50:return O+D.a.instance.ga(2051);case 51:return O+D.a.instance.ga(2052);
case 52:return O+D.a.instance.ga(2053);case 53:return O+D.a.instance.ga(2054);case 54:return O+D.a.instance.ga(2055);case 55:return O+D.a.instance.ga(2056);case 56:return O+D.a.instance.ga(2057);case 57:return O+D.a.instance.ga(2058);case 58:return O+D.a.instance.ga(2059);case 59:return O+D.a.instance.ga(2060);default:return qa.Name?qa.Name:""}}static uZh(qa){return(qa+1)%U.Cdi}static Rxb(qa,O,ca=""){return qa||!ca?`${U.mdf}, ${qa.Index.toString()}, -version, ${O.toString()}`:`${U.mdf}, ${ca}, -version, ${O.toString()}`}static oSh(qa,
O,ca,wa){const ia=[];for(let Ha=0;Ha<U.kBa;Ha++)ia.push(U.Gfd(qa,O,ca,wa,Ha));return ia}static Gfd(qa,O,ca,wa,ia){qa=qa.TableStyleElementsList;let Ha=new E;const Sa={};if(!qa)return Sa;for(var Da of qa)if(0===Da.Type){Ha=Da;break}Da=!!Ha.BackgroundColor;let ea="";!ca&&Ha.TableStyleBorderFromatList&&0<Ha.TableStyleBorderFromatList.length&&(ea=Ha.TableStyleBorderFromatList[0].Color);Sa["background-color"]=Da?Ha.BackgroundColor:"#FFFFFF";Ha.FontColor||(Ha.FontColor="#000000");Sa.color=Ha.FontColor;U.EBe(wa,
ia,Sa,Ha,ea,ca,Da);for(const sa of qa)sa&&0!==sa.Type&&(2!==sa.Type||Da||(sa.BackgroundColor=Ha.BackgroundColor),U.itd(sa,wa,ia,O)&&(sa.BackgroundColor&&(Sa["background-color"]=sa.BackgroundColor),Sa.color=sa.FontColor||Ha.FontColor,U.EBe(wa,ia,Sa,sa,ea,ca,Da)));return Sa}static GU(qa,O,ca,wa,ia,Ha){ca&&(ca.Color&&!ca.Style&&(ca.Style=1),ca.Style&&!ca.Color&&(ca.Color=ia?"#000000":wa?wa:Ha?"#FFFFFF":"#000000"),O[U.borders[qa]]="1px "+U.oV[ca.Style]+" "+ca.Color)}static itd(qa,O,ca,wa){return-1===
qa.Type?!1:U.ktd(qa,O,ca,wa)||U.zui(qa,O,ca,wa)||U.ltd(qa,O,ca,wa)}static zui(qa,O,ca,wa){return!O&&wa.headerRow||O===U.joa-1&&wa.totalRow?!1:1===O%2&&5===qa.Type&&wa.BR&&wa.headerRow||1<O&&!!((O-1)%(qa.BandSize+1))&&6===qa.Type&&wa.BR&&wa.headerRow||!(O%2)&&5===qa.Type&&wa.BR&&!wa.headerRow||!!(O%(qa.BandSize+1))&&6===qa.Type&&wa.BR&&!wa.headerRow||!(ca%2)&&7===qa.Type&&wa.Fha||!!(ca%(qa.BandSize+1))&&8===qa.Type&&wa.Fha}static ltd(qa,O,ca,wa){return O===U.joa-1&&2===qa.Type&&wa.totalRow||ca===U.kBa-
1&&O===U.joa-1&&12===qa.Type&&wa.totalRow&&wa.lastCol||!ca&&O===U.joa-1&&11===qa.Type&&wa.totalRow&&wa.firstCol||ca===U.kBa-1&&4===qa.Type&&wa.lastCol}static ktd(qa,O,ca,wa){return!O&&1===qa.Type&&wa.headerRow||!ca&&3===qa.Type&&wa.firstCol||!ca&&!O&&9===qa.Type&&wa.headerRow&&wa.firstCol||ca===U.kBa-1&&!O&&10===qa.Type&&wa.headerRow&&wa.lastCol}static EBe(qa,O,ca,wa,ia,Ha,Sa){if(wa.TableStyleBorderFromatList)for(const Da of wa.TableStyleBorderFromatList)if(Da.Style)switch(Da.Position){case 0:qa&&
12!==wa.Type&&11!==wa.Type&&2!==wa.Type&&5!==wa.Type&&6!==wa.Type||U.GU(0,ca,Da,ia,Ha,Sa);break;case 1:qa!==U.joa-1&&1!==wa.Type&&10!==wa.Type&&9!==wa.Type&&5!==wa.Type&&6!==wa.Type||U.GU(1,ca,Da,ia,Ha,Sa);break;case 2:O&&12!==wa.Type&&10!==wa.Type&&7!==wa.Type&&8!==wa.Type&&4!==wa.Type||U.GU(2,ca,Da,ia,Ha,Sa);break;case 3:O!==U.kBa-1&&9!==wa.Type&&11!==wa.Type&&3!==wa.Type&&7!==wa.Type&&8!==wa.Type||U.GU(3,ca,Da,ia,Ha,Sa);break;case 5:O!==U.kBa-1&&3!==wa.Type&&4!==wa.Type&&7!==wa.Type&&8!==wa.Type&&
U.GU(3,ca,Da,ia,Ha,Sa);break;case 6:qa!==U.joa-1&&2!==wa.Type&&1!==wa.Type&&5!==wa.Type&&6!==wa.Type&&U.GU(1,ca,Da,ia,Ha,Sa)}}static v4h(){const qa=Array(12);qa[0]=0;qa[7]=1;qa[8]=2;qa[5]=3;qa[6]=4;qa[4]=5;qa[3]=6;qa[1]=7;qa[2]=8;qa[9]=9;qa[10]=10;qa[11]=11;qa[12]=13;return qa}}U.joa=5;U.kBa=5;U.Cdi=5;U.mdf="TableStyleIcon";U.oV=[null,N.a.solid,N.a.dashed,N.a.dotted,N.a.dashed,N.a.dotted,N.a.dashed,N.a.double];U.borders=[Y.a.borderTop,Y.a.borderBottom,Y.a.borderLeft,Y.a.borderRight];U.wdg=U.v4h();
U.Z7c=null;Object(t.a)(U,"TableStyleHelper",null,[]);class P{constructor(qa,O,ca,wa,ia,Ha){this.headerRow=qa;this.totalRow=O;this.firstCol=ca;this.lastCol=wa;this.BR=ia;this.Fha=Ha}equals(qa){return qa?this.headerRow===qa.headerRow&&this.totalRow===qa.totalRow&&this.firstCol===qa.firstCol&&this.lastCol===qa.lastCol&&this.Fha===qa.Fha&&this.BR===qa.BR:!1}}Object(t.a)(P,"TableStyleOptions",null,[]);var aa=a(804);class X extends A.a{constructor(qa,O,ca){super();this.t8i={["height"]:"100%"};this.cJb=
{};this.jIa=this.gjd=0;this.lastSyncTime=new Date;this.Lda=-1;this.FN=null;this.Cma={};this.$K=null;this.pI={};this.sTa={};this.Etc=null;this.UBb=this.S6a=this.isInitialized=this.alf=!1;this.Iwc=null;this.TAc=this.ZNb=this.sZe=!1;this.ZTi=(wa,ia,Ha)=>{let Sa=!1;if(R.a(wa))-315732528!==wa.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${I.a.nc(wa.Errors)}`),this.FDf(null,ia,Ha));else if(d.ULS.sendTraceTag(537151202,
0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(wa=wa.Result)&&wa.TableStyleItems.length){Ha=60<wa.TableStyleItems.length;var Da=!1,ea=!1;if(this.$K)for(var sa=0;60>sa;++sa){const Ea=wa.TableStyleItems[sa],ba=this.$K.TableStyleItems[sa];if(Ea.HasStyleViolations!==ba.HasStyleViolations){Sa=ea=!0;break}for(let ka=0;9>ka&&!(ka>=Ea.TableStyleElementsList.length);ka++)if(!G.a.equals(Ea.TableStyleElementsList[ka].BackgroundColor,ba.TableStyleElementsList[ka].BackgroundColor,
!1)){Sa=Da=!0;break}}else{this.jIa=0;for(sa of wa.TableStyleItems)sa.TableStyleElementsList&&sa.TableStyleElementsList.sort(U.Rsf),this.pI[sa.Name]=sa}if(Da||ea)for(Da=0;60>Da;++Da)ea=wa.TableStyleItems[Da],this.pI[ea.Name]=ea;if(Ha&&this.$K)for(d.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${wa.TableStyleItems.length-60}`),Sa=!0,Ha=60;Ha<wa.TableStyleItems.length;++Ha)Da=wa.TableStyleItems[Ha],Da.Name in this.pI||Da.TableStyleElementsList&&
Da.TableStyleElementsList.sort(U.Rsf),this.pI[Da.Name]=Da;if(aa.a(this.pI).length!==wa.TableStyleItems.length)for(Sa=!0,Da=Ha=60;Da<this.$K.TableStyleItems.length;)Ha>=wa.TableStyleItems.length?delete this.pI[this.$K.TableStyleItems[Da].Name]:Ha>=wa.TableStyleItems.length||!G.a.equals(wa.TableStyleItems[Ha].Name,this.$K.TableStyleItems[Da].Name,!1)?delete this.pI[this.$K.TableStyleItems[Da].Name]:++Ha,++Da;this.$K=wa;this.ATf(Sa);Sa&&this.a0c();ia&&("accessibility"===ia?(this.ZNb=!1,this.TAc=!0):
this.TAc=!1);this.alf||(this.Rui()&&this.$.qf(),this.alf=!0);this.gjd=0;this.UBb||this.sZe?this.TAc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.sZe=!0)}};this.FDf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.gjd++;5>this.gjd&&C.a.instance.create(()=>{this.T4a("getTableStylesFailed")},1E3,y.a.vdg,!0,!0)};this.fJf=()=>{this.UBb&&(this.UBb=!1,this.Iwc&&this.Iwc(),C.a.instance.create(()=>
{this.T4a("galleryMenuClosed")},1E3,y.a.vdg,!0,!0))};this.$=qa;this.Va=O;this.tableManager=ca;this.$.da.Ha(329,this);this.w0c=this.Ewb();this.$.Ia.UYa(this.fJf)}iaf(qa){const O=this.tableManager.Dg;if(!O)return!1;qa=qa[u.a.Kc];if(!qa)return!1;switch(Number.parseInvariant(qa)){case 0:return w.d(O);case 1:return w.c(O);case 2:return w.g(O);case 3:return w.e(O);case 4:return w.f(O);case 5:return w.b(O);case 6:return O.hasAutoFilter}return!1}jNf(qa,O){if(h.a.isEmpty(this.pI))return!0;if("PopulateTableMoreStylesMenu"!==
qa&&"PopulateTableAccessibleStylesMenu"!==qa)return!1;if("PopulateTableAccessibleStylesMenu"===qa&&!this.TAc)return this.ZNb||(this.ZNb=!0,this.T4a("accessibilityTab")),!0;this.UBb=!0;const ca=this.Va.sq("TableStylesMenu"),wa=this.Va.xC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),ia=this.Va.xC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ha=this.Va.xC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Sa=this.Va.xC("Ribbon.TableTools.TableStyles.Gallery.Light",
7,"Size48by48");let Da=-123538519,ea;if(O.MenuId)if(G.a.contains(O.MenuId,"FormatAsTable",!0))Da=753331043,this.S6a=!0;else{ea=D.a.instance.ga(2E3);var sa=U.Rxb(null,1,"-1");S.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Sa.Zt("-1",Da,"QueryTableStyle",0,"-1",sa,void 0,void 0,ea):Sa.Zt("-1",Da,"QueryTableStyle",0,"-1",void 0,void 0,void 0,ea);this.S6a=!1}sa=0;const Ea=this.pI;for(let ba in Ea){const ka=Ea[ba];if("PopulateTableAccessibleStylesMenu"===qa&&ka.HasStyleViolations)continue;
let Ca;ea=U.c8e(ka,this.Ewb());Ca=U.Rxb(ka,this.jIa);if(ka)switch(ka.Category){case 0:wa.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,ea);sa++;break;case 3:ia.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,ea);break;case 2:Ha.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,ea);break;case 1:Sa.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,ea)}}0<sa&&this.d2(ca,
wa,1968);this.d2(ca,Sa,1969);this.d2(ca,Ha,1970);this.d2(ca,ia,1971);O.MenuItems=ca.lE();this.isInitialized||(this.isInitialized=!0);return!0}Tkd(qa){qa[m.a.On]=!1;let O=qa[u.a.Kc];if(O&&!h.a.isEmpty(this.pI)){G.a.contains(qa.ParentMenuId,"FormatAsTable",!0)?this.S6a=!0:this.S6a=!1;this.S6a||this.ejg();U.Nmf(qa)&&(O=this.$wb(O).toString());var ca=this.Ewb();qa[m.a.Alt]="-1"===O?D.a.instance.ga(2E3):U.c8e(this.fjd(O),ca);if(O in this.sTa&&ca.equals(this.w0c))this.lNf(qa,O,ca,!0);else{if(!this.Etc||
this.Etc&&!this.Etc.ep)this.Cma={},this.Etc=C.a.instance.create(()=>{this.ATf();this.w0c=this.Ewb()},0,y.a.pQj,!0,!0);this.GGd(ca,qa,O)}}}getTableStyleIndexFromName(qa){if(!qa||h.a.isEmpty(this.pI))return-1;if(qa in this.pI)return this.pI[qa].Index;this.T4a("getTableStyleIndexFromName");return-1}std(){return!!this.$K}$wb(qa){this.FN||this.a0c();return qa in this.FN?this.FN[qa]:-1}T4a(qa){if(this.$.isEditMode){var O=new Date;if(30<B.getElapsedSeconds(this.lastSyncTime,O)||h.a.isEmpty(this.pI)||this.ZNb){let ca=
this.$.oa.xa.Wb();this.lastSyncTime=O;qa=this.ZNb&&"accessibilityTab"===qa||"galleryMenuClosed"===qa;z.m(this.$.oa.xa,qa,this.ZTi,this.FDf,null,qa?"accessibility":"normal",ca)}}}dispose(){this.FN=this.sTa=this.$K=this.pI=null;this.$.Ia.LJb(this.fJf);super.dispose()}pOg(qa){this.addHandler("RefreshTableStyleGallery",qa)}Jkj(qa){this.removeHandler("RefreshTableStyleGallery",qa)}a0c(){const qa={};this.tableManager.Dg&&(this.Lda=this.getTableStyleIndexFromName(this.tableManager.Dg.wBc));for(let O=1;7>=
O;O++)qa["preview"+O]=this.wYh(O);this.FN=qa}wYh(qa){var O=this.$K.TableStyleItems.length;O=4>=this.Lda?this.Lda+qa-1:4<this.Lda&&this.Lda<O-4?4===qa?this.Lda:Math.floor(this.Lda+qa-4):this.Lda+qa-1;-1===O||O.toString()in this.sTa||(O=qa-3);return O}ejg(){if(this.tableManager.Dg){let qa=!1;const O=this.getTableStyleIndexFromName(this.tableManager.Dg.wBc);if(O!==this.Lda){if(this.FN){const ca=this.FN;for(let wa in ca)ca[wa]===O&&(qa=!0)}this.Lda=O;qa||h.a.isEmpty(this.sTa)||this.a0c()}}}d2(qa,O,ca){const wa=
this.Va.Ec();wa.Gp="Thin";wa.title=D.a.instance.ga(ca);wa.buttons.push(O);qa.rc.push(wa)}Ewb(){const qa=this.tableManager.Dg;return this.S6a||!qa?new P(!0,!1,!1,!1,!0,!1):new P(w.d(qa),w.g(qa),w.c(qa),w.e(qa),w.f(qa),w.b(qa))}ATf(qa=!1){const O={},ca={},wa=this.Ewb();if(!h.a.isEmpty(this.pI)&&(this.tableManager.Dg&&this.ejg(),!wa.equals(this.w0c)||qa||h.a.isEmpty(this.sTa))){this.jIa=U.uZh(this.jIa);qa=this.pI;for(var ia in qa){const Ha=qa[ia],Sa=U.Rxb(Ha,this.jIa);O[Ha.Index.toString()]=U.v4a(U.$sa(U.e5b(Ha,
wa)),Sa);ca[Sa]=O[Ha.Index.toString()];this.Oza(ca)}ia=U.Rxb(null,this.jIa,"-1");O["-1"]=U.v4a(U.$sa(U.e5b(null,wa)),ia);ca[ia]=O["-1"];this.Oza(ca);H.c(this.sTa,O,!1)}}Rui(){const qa=n.a(this.$);return qa?qa.lp.Iz===x.a.JIb:!1}GGd(qa,O,ca){Number.parseInvariant(ca);"-1"===ca&&G.a.contains(O.ParentMenuId,"FormatAsTable",!0)||this.lNf(O,ca,qa,!1)}lNf(qa,O,ca,wa){const ia=U.Rxb(null,this.jIa,O);U.Nmf(qa)?(ia in this.Cma?ca=this.Cma[ia]:(ca=U.$sa(U.e5b(this.fjd(O),ca)),this.Cma[ia]=ca),qa[m.a.GalleryButtonProps]=
Object(f.a)(new l.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:qa[m.a.Alt],MenuItemId:O,TableCellStyles:ca,TableStyles:this.t8i})):(qa[v.a.Icon]=ia,qa[m.a.GalleryButtonProps]=Object(f.a)(new r.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:qa[m.a.Alt],MenuItemId:O}),wa||(wa=[],this.fjd(O),"-1"===O||G.a.contains(qa.ParentMenuId,"FormatAsTable",!0)||(wa=U.e5b(this.$K.TableStyleItems[Number.parseInvariant(O)],ca)),this.sTa[O]=U.v4a(U.$sa(wa),ia)))}Oza(qa){if(this.UBb)this.Iwc=
()=>{this.Oza(qa)};else{this.Iwc=null;var O=[];for(let wa in qa){var ca=wa;ca in this.cJb?O.push(ca):this.cJb[ca]=!0}try{0<O.length&&appChrome.api.unregisterIcons(O),h.a.isEmpty(qa)||appChrome.api.registerIconProvider(()=>qa)}catch(wa){}}}fjd(qa){qa=Number.parseInvariant(qa);if(-1===qa||!this.$K)return null;if(60<qa)for(let O=60;O<this.$K.TableStyleItems.length;++O){const ca=this.$K.TableStyleItems[O];if(ca.Index===qa)return ca}return this.$K.TableStyleItems[qa]}}Object(t.a)(X,"TableStyleManager",
A.a,[243,2]);var Z=a(55);a.d(F,"a",function(){return da});class da extends c.a{constructor(qa){super();this.tableStyleManager=null;this.$=qa;this.Db()}create(){const qa=b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),O=b.GetServiceTaskFactory.Oa(this.$.da,66,134,this.Xa);e.TaskExtensions.za(Z.Task.ZF(qa,O),()=>{this.nb(this.tableStyleManager||(this.tableStyleManager=new X(this.$,qa.result,O.result)))},this.$.la,8)}}Object(t.a)(da,"TableStyleManagerFactory",c.a,[])},1255:function(t,F,
a){t=a(0);var c=a(226),b=a(15),e=a(167),f=a(251),d=a(376),h=a(4),m=a(653),l=a(88),v=a(96),r=a(264),A=a(165),x=a(77),n=a(424),u=a(50),z=a(37),w=a(94),C=a(74),y=a(1),B=a(574),H=a(21),I=a(33);class R extends v.a{constructor(Y,U){super(Y);this.HS=[];this.rce=null;this.CKb=P=>{let aa="forward";P.Values[d.a.direction]?aa=P.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;let X=!0;"backward"===aa?(P=this.Fud.length-1,X=!1):"forward"===aa?
(P=0,X=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${aa}`);this.nwf(X,P,!1)};this.FEf=()=>{this.HS=[]};this.WOa=P=>{-411645385===this.$.shortcutKeyManager.mt(P,!0)&&this.Djf()&&(this.$.Ia.Hb(new w.a(-411645385,1,this.$.xc,6,null),{["event"]:P},P),P.stopPropagation())};this.uVi=P=>{this.ema(P)};this.jb=U;this.Wt=H.h(this.jb);this.Cc.ka("keydown",this.uVi);this.Cc.ka("keyup",this.WOa);r.a(U).BOg(this.FEf);x.a(U.ya,27)&&z.TaskExtensions.za(u.GetServiceTaskFactory.Oa(U.da,
21,137,1),P=>{P=P.result;P.Yn(e.a.Ecf);P.Dl(e.a.Ecf,this.CKb)},U.la)}get $(){return this.jb}get Fud(){this.HS.length||(this.HS=this.d4e());return this.HS}get ela(){return this.rce}set ela(Y){this.rce=Y;this.HS=this.d4e()}dispose(){this.$&&r.a(this.$).Xkj(this.FEf);this.jb=null;this.HS.length=0;super.dispose()}d9i(Y){this.ema(Y)}nwf(Y,U,P=!0,aa=null){var X=this.EPj(Y,U,P,aa);if(!X){P=U;var Z=Y?1:-1,da=this.Fud;do{X=!1;if(x.a(this.$.ya,27)){if(P+=Z,P>=da.length||0>P)X=!0}else P=(P+Z+da.length)%da.length;
if(X){this.xEi(Y,U,aa);break}else if(X=this.edg(Y,U,P,!1,aa))break}while(P!==U)}}EPj(Y,U,P=!0,aa=null){let X=null;0<=U&&(X=this.HS[U]);return(null===X||void 0===X?0:X.Ff)&&X.ag(Y,P)?(aa&&C.g(aa),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${X.Yd} into a sub region`),X.rj(),!0):!1}edg(Y,U,P,aa,X=null){P=this.HS[P];if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const Z=r.a(this.jb).kw(f.a.Dua),da=r.a(this.jb).kw(f.a.$xb),qa=this.Wt.ha.Sa.G4;
if(P===da&&qa||P===Z&&!aa&&!qa)return!1}if((null===P||void 0===P?0:P.Ff)&&P.ag(Y,!1)){X&&C.g(X);P.rj();if(Y=this.HS[U])Y.dk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${Y.Yd} to ${P.Yd}`);return!0}return!1}xEi(Y,U,P=null){P&&C.g(P);if(U=this.HS[U])U.dk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${U.Yd}`);z.TaskExtensions.za(u.GetServiceTaskFactory.Oa(this.$.da,21,137,0),aa=>{aa.result.jj(e.a.inb,{[d.a.direction]:Y?"forward":"backward"})},this.$.la)}ema(Y){var U=
this.$.isEditMode?A.a(this.$):null;if(!this.$.qb.Uwa||R.Tpi(U))if(117===Y.keyCode&&(Y.ctrlKey||C.b(Y))){U=this.Z6e(Y.target);var P=!Y.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${U}`);if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var aa=r.a(this.jb).kw(f.a.HKb);aa=this.HS.indexOf(aa);h.AFrameworkApplication.ra.Qa.tw&&this.$.SZ&&-1!==aa&&U===aa&&m.ShyRibbon.bJ(this.$.yeb,0)}else h.AFrameworkApplication.ra.Qa.tw&&
this.$.SZ&&1===U&&m.ShyRibbon.bJ(this.$.yeb,0);this.nwf(P,U,!0,Y)}else 117!==Y.keyCode||R.IWe?-411645385===this.$.shortcutKeyManager.mt(Y)?this.Djf()&&(this.$.Ia.Hb(new w.a(-411645385,1,this.$.xc,6,null),{["event"]:Y},Y),Y.stopPropagation()):1588554917===this.$.shortcutKeyManager.mt(Y)?0===this.mode?(B.a(this.$)||this.$.Ia.Hb(new w.a(1588554917,1,this.$.xc,6,null),{["event"]:Y},Y),Y.preventDefault(),Y.stopPropagation()):3===this.mode&&(Y.preventDefault(),Y.stopPropagation()):y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)&&1058684758===this.$.shortcutKeyManager.mt(Y)?(U=this.Z6e(Y.target),aa=r.a(this.jb).kw(f.a.HKb),P=r.a(this.jb).kw(f.a.Dua),aa=this.HS.indexOf(aa),P=this.HS.indexOf(P),h.AFrameworkApplication.ra.Qa.tw&&this.$.SZ&&-1!==aa&&U===aa&&1===this.$.yeb&&m.ShyRibbon.bJ(1,0),-1!==P&&U!==P&&this.edg(!0,U,P,!0,Y)):this.d9h(Y):(Y=n.a.SI.notificationBar.I$(l.a.uUh(),!1),I.a.xBb()?Y.image=3:Y.image=0,n.a.SI.notificationBar.dE(Y),R.IWe=!0)}Z6e(Y){const U=this.Fud;for(let P=0,aa=U.length;P<aa;++P){const X=U[P];
if(X&&X.sh(Y))return P}return-1}d4e(){const Y=[];for(let U=0,P=this.ela.length;U<P;U++){const aa=r.a(this.$).kw(this.ela[U]);aa&&Y.push(aa)}return Y}Djf(){return 0===this.mode||4===this.mode}static Tpi(Y){return Y?Y.inKeytipMode:!1}}R.IWe=!1;Object(t.a)(R,"AccessibilityManager",v.a,[416,2]);var S=a(153),G=a(22),D=a(13);class E extends R{constructor(Y){super(document.documentElement,Y);this.RB=0;this.nVg=[f.a.uGe,f.a.dBd,f.a.Mec,f.a.$Yd,f.a.HKb,f.a.c0c,f.a.Jdd,f.a.G9e,f.a.m_c,f.a.DBc,f.a.QKj,f.a.$xb,
f.a.m1c,f.a.Dua,f.a.mTd,f.a.s1c,f.a.Cbg,f.a.tqf,f.a.H_c];this.Q4j=[f.a.Mec,f.a.tmg,f.a.smg,f.a.umg];this.F8i=[f.a.Mec,f.a.KOf,f.a.LOf,f.a.NOf];this.l2g=[f.a.CZe,f.a.F9e,f.a.Hdd,f.a.Fdd];this.i8i=[f.a.uGe,f.a.dBd,f.a.c0c,f.a.Jdd,f.a.m_c,f.a.DBc,f.a.$xb,f.a.m1c,f.a.Dua,f.a.mTd,f.a.hOf,f.a.s1c,f.a.H_c];this.u8i=[f.a.$xb,f.a.HZe];const U=D.a.instance.Ta(253);this.zyj=this.$.shortcutKeyManager.CKa(U);this.mode=0;Y.da.Ha(15,this);z.TaskExtensions.za(u.GetServiceTaskFactory.Oa(Y.da,21,137,1),P=>{P=P.result;
P.Yn(e.a.inb);P.Dl(e.a.inb,this.CKb)},Y.la)}get mode(){return this.RB}set mode(Y){this.RB=Y;switch(Y){case 0:this.ela=this.nVg;break;case 2:this.ela=this.Q4j;break;case 3:this.ela=this.F8i;break;case 4:this.ela=this.l2g;break;case 5:this.ela=this.i8i;break;case 6:this.ela=this.u8i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}ema(Y){this.$.qd&65536&&super.ema(Y)}d9h(Y){if(G.a.equals(this.zyj,this.$.shortcutKeyManager.Mgd(Y),!1)){const U=S.b(this.$);
if(null===U||void 0===U?0:U.Ff)C.g(Y),U.ag(!0,!1)}}}Object(t.a)(E,"EwaAccessibilityManager",R,[]);class M extends c.a{constructor(Y){super();this.$=Y;this.Db()}create(){this.nb(this.$.da.Aa(15)||new E(this.$))}static ka(Y){Y.da.Ha(157,new M(Y))}}Object(t.a)(M,"AccessibilityManagerFactory",c.a,[]);var L=a(9);a.d(F,"a",function(){return N});const N=()=>{L.a.Fa(M.ka)}},1256:function(t,F,a){var c=a(9),b=a(173);t=a(0);var e=a(15),f=a(226),d=a(37),h=a(51),m=a(1),l=a(288),v=a(217);class r{}r.eTe="ewa-svg-icon";
Object(t.a)(r,"CssClassNames",null,[]);var A=a(50),x=a(12),n=a(316),u=a(204),z=a(186),w=a(105);class C{constructor(H,I){this.htmlSanitizationHelper=null;this.Jf=()=>{this.yqf();this.$.ea.Bn(this.Jf)};this.$=H;this.ddg={};this.CXd={};this.htmlSanitizationHelper=I;(I=this.N3e("excelInitialAppSprite"))?(this.Ipe(I),this.$.ea.Zf?this.yqf():H.ea.Dk(this.Jf),this.$.da.Ha(388,this)):e.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.CXd=null;this.$.ea.Bn(this.Jf)}Kja(H,
I,R=null,S=null){let G;(G=this.CXd[H])||(this.CXd[H]=G=this.R3i(this.ddg[H]));if(!G)return e.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${H} was not found in loaded SVG sprites.`),null;const D=G.cloneNode(!0);if(!D.style){const E=n.b(G),M=n.b(D),L={};L.iconId=H;L.isOriginalNodeStyleNull=void 0===G.style||null===G.style;L.isOriginalNodeCurrentStyleNull=void 0===G.currentStyle||null===G.currentStyle;L.isClonedNodeCurrentStyleNull=void 0===D.currentStyle||null===D.currentStyle;
L.originalNode=E.substring(0,E.indexOf(">")+1);L.clonedNode=M.substring(0,M.indexOf(">")+1);e.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(L)}`)}D.setAttribute("style",`height: ${I}px; width: ${I}px;`);S&&(H=document.createElement("title"),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?this.htmlSanitizationHelper.Ph(H,
S):H.innerHTML=S,D.insertBefore(H,D.childNodes[0]));if(R)for(const E of R)Sys.UI.DomElement.addCssClass(D,E);return D}lba(H,I,R,S,G=0,D=0,E=null,M=null){G&&D||(D=x.DOMElementExtensions.getBoundingClientRect(S),G=D.height,D=D.width);if(E=this.Kja(H,I,E,M))S.appendChild(E),(S=x.DOMElementExtensions.hZ(E,"style",null))?E.setAttribute("style",S+` margin: ${(G-I)/2}px ${(D-R)/2}px;`):e.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${H}`);
return E}yqf(){m.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void z.a.resolve(w.d,{Tl:0}).then(H=>H("excel-uiSlice20-sprite")).then(()=>this.Hpe()):d.TaskExtensions.za(A.GetServiceTaskFactory.Oa(this.$.da,283,284,0),H=>{H=u.c(H.result.Hl.loadScript("excel-uiSlice20-sprite"));d.TaskExtensions.za(H,()=>{this.Hpe()},this.$.la,3)},this.$.da.la,3)}Hpe(){const H=this.N3e("excelUiSlice20Sprite");H?this.Ipe(H):e.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}Ipe(H){for(const I of H)I.type===
v.a.AXd&&(this.ddg[I.id]=I)}R3i(H){if(!H)return null;const I=H.viewBox;H=H.children;const R=document.createElementNS(l.a.DXd,v.a.AXd);Sys.UI.DomElement.addCssClass(R,r.eTe);R.setAttribute("focusable","false");R.setAttribute("viewBox",I);this.HKg(R,H);return R}HKg(H,I){for(const S of I){const G=document.createElementNS(l.a.DXd,S.type);for(let D in S){I=D;var R=S[D];"className"===I?G.setAttribute("class",R):G.setAttribute(I,R)}H.appendChild(G)}}N3e(H){return(H=window[H])?H.icons:null}}Object(t.a)(C,
"SvgIconProvider",null,[429,2]);class y extends f.a{constructor(H){super();this.$=H;this.Db()}create(){const H=this.bAi();if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){const I=A.GetServiceTaskFactory.Oa(this.$.da,498,499,0);d.TaskExtensions.za(d.TaskExtensions.Fd([H,I],this.$.la),()=>{window.excelInitialAppSprite?this.nb(this.$.da.Aa(388)||new C(this.$,I.result)):e.ULS.sendTraceTag(537151258,
0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}else d.TaskExtensions.za(H,()=>{window.excelInitialAppSprite?this.nb(this.$.da.Aa(388)||new C(this.$,null)):e.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}bAi(){if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:7521802_OnboardWdAppChromeVersion")){let H;H=m.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?z.a.resolve(w.d,{Tl:this.Xa}).then(I=>Object(b.a)(this,
void 0,void 0,function*(){return I("excel-app-intl")})):A.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Xa).result.Hl.loadScript("excel-app-intl");return Object(u.c)(H)}return h.a.RQ([129],4,this.Xa,void 0,void 0,void 0,387)}static ka(H){H.da.Ha(387,new y(H))}}Object(t.a)(y,"SvgIconProviderFactory",f.a,[]);a.d(F,"a",function(){return B});const B=()=>{c.a.Fa(y.ka)}},1281:function(t,F,a){var c=a(9);t=a(0);var b=a(226),e=a(21),f=a(478);class d extends f.a{constructor(l,v){super(l);v.Ha(240,this)}z3h(l){for(const v of this.rangeList)if(l.range.contains(v))return v;
return null}hJd(l){return l.GridBlockModel&&(l=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(l.GridBlockModel))?l.getSparklineRanges():null}}Object(t.a)(d,"SparklineManager",f.a,[395]);class h extends b.a{constructor(l){super();this.sparklineManager=null;this.$=l;this.Db()}create(){this.nb(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static ka(l){l.da.Ha(239,new h(l))}}Object(t.a)(h,"SparklineManagerFactory",b.a,[]);a.d(F,"a",function(){return m});const m=
()=>{c.a.Fa(h.ka)}},1302:function(t,F,a){t=a(0);var c=a(149),b=a(604);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.Vod()&&c.WacAirSpace.mCc()}animate(h,m,l,v,r){m&&c.WacAirSpace.RK(h.element,m);c.WacAirSpace.animate(h,v,r);l&&c.WacAirSpace.dhj(h.element,l)}}Object(t.a)(e,"AnimationManager",b.a,[2]);var f=a(102);a.d(F,"a",function(){return d});const d=()=>{f.a.Pl.Ha(141,new e)}},1480:function(t,F,a){a.r(F);t=a(1224);F=a(1187);var c=a(1146),b=a(1147),e=a(1148),f=a(1150);a(1149);
var d=a(1255),h=a(1302),m=a(9),l=a(0),v=a(226),r=a(191),A=a(551),x=a(15),n=a(826),u=a(518),z=a(83),w=a(4),C=a(81),y=a(925);class B extends C.a{constructor(D){super();this.Dvd=null;this.$=D;x.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Gpj(){const D=new r.a,E=u.a.Pq(z.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),M=new A.a(()=>E.result);this.Dvd=new A.a(()=>new n.a(M.value,null));if(!this.Dvd)return D;var L=this.Dvd.value.rZ("NewAndOpenCoreManager",!1);if(!L||3!==L.state||
!L.Nzd)return L?x.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${L.state}, mruResult MruDocuments is null: ${!L.Nzd}`):x.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;L=L.Nzd;const N=["xlsx","xlsb","xlsm"];for(let U=0;U<L.length;U++){var Y=L[U];if(0>Array.indexOf(N,Y.extension))continue;const P=`${Y.title}.${Y.extension}`,aa=y.b(Y,w.AFrameworkApplication.isRtl);Y=Y.url;P&&aa&&Y?D.add({[B.fileName]:P,
[B.friendlyPath]:aa,[B.section]:"mru",[B.absoluteUrl]:Y}):Y||x.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return D}dispose(){super.dispose()}}B.fileName="FileName";B.friendlyPath="FriendlyPath";B.section="Section";B.absoluteUrl="AbsoluteUrl";Object(l.a)(B,"NewAndOpenCoreManager",C.a,[820,2]);class H extends v.a{constructor(D){super();this.$=D;this.Db()}create(){this.nb(this.$.da.Aa(451)||this.$.da.Ha(451,new B(this.$)))}static ka(D){D.da.Ha(164,
new H(D))}}Object(l.a)(H,"NewAndOpenCoreFactory",v.a,[]);l=a(1179);v=a(1281);C=a(1256);var I=a(1225),R=a(1182),S=a(1173),G=a(1192);a=a(1166);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(t.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(F.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();m.a.Fa(H.ka);Object(h.a)();Object(l.a)();Object(v.a)();Object(C.a)();Object(f.a)();Object(I.a)();Object(R.a)();Object(S.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(G.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/7debc328da4d67566b9806e6c683b770/EwaDSEsNext.acc.js.map