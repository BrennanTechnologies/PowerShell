'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1154:function(t,F,a){a.d(F,"a",function(){return b});var c=a(511);const b=()=>{c.a.Ai(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1478:function(t,F,a){a.r(F);var c=a(9);t=a(0);var b=a(709),e=a(15),f=a(841),d=a(8),h=a(68),m=a(188),l=a(375),v=a(34),r=a(55);class A{constructor(O){this.$=O}Hc(){return!1}executeCommand(O,ca,wa){let ia=!1;O=ca.command;const Ha=v.a(this.$);11!==ca.We&&7!==ca.We&&6!==ca.We&&2!==ca.We&&14!==ca.We&&15!==ca.We&&16!==ca.We&&e.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${ca.We}`);const Sa=6===ca.We;switch(ca.command){case -1365094462:case -1441674458:Ha.MFc(Math.floor(10*
Ha.zoom)/10+.1,Sa);ia=!0;break;case 1056010365:case 1664364901:Ha.MFc(Math.ceil(10*Ha.zoom)/10-.1,Sa);ia=!0;break;case 346087880:Ha.MFc(d.a.q_,Sa);ia=!0;break;case -1918142559:case 1517993347:h.a.Kc in wa?(wa=parseFloat(wa[h.a.Kc]),wa!==Ha.zoom&&Ha.LFc(wa,1517993347===ca.command),ia=!0):e.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:ca=parseFloat(wa[f.a.Value]);isNaN(ca)||Ha.LFc(ca/100,!0);ia=!0;break;case 1409187195:Ha.zoomFitToScreen();
ia=!0;break;case -1836771825:Ha.zoomFitToScreenUndo(),ia=!0}return ia?r.Task.Ra(!0):m.a(O)}wc(O,ca){switch(ca.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return v.a(this.$).bX();case -1365094462:case 1056010365:case -2096586688:return l.a(this.$);default:return!1}}Mc(){return!1}}Object(t.a)(A,"ZoomCommandHandler",null,[221]);class x extends b.a{constructor(O){super(O)}hd(){this.$c([new A(this.$)])}static ka(O){b.a.Ld(370,
new x(O))}}Object(t.a)(x,"ZoomCommandHandlerFactory",b.a,[]);F=a(226);var n=a(89),u=a(27),z=a(83),w=a(543),C=a(49),y=a(5),B=a(165),H=a(65),I=a(294),R=a(127),S=a(41),G=a(33),D=a(12),E=a(11),M=a(106),L=a(21),N=a(309),Y=a(128);class U{constructor(O){this.Z5a=this.Xfc=0;this.g3b=null;this.Cif=!1;this.$=O;this.Cif=O.fkc}lpi(){return L.h(this.$).fb?(e.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.qb.tv?(e.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}sSi(O){this.g3b=new Sys.UI.Point(Math.round(O.Qua.center.x),Math.round(O.Qua.center.y));this.Xfc=v.a(this.$).zoom;this.Z5a=O.Qua.scale;let ca={["InitialZoom"]:this.Xfc,["Location"]:"canvas",["InputMethod"]:O.ub};Y.b(this.$).rd(R.a.$4i,ca);e.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.g3b.x},${this.g3b.y}), initial zoom ${this.Xfc}, initial scale ${this.Z5a}`);
this.l9a(O,"onGestureStart");return!0}rSi(O){if(!this.Z5a)return e.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.l9a(O,"OnGestureEvent"),!0;if(!isFinite(this.Z5a))return e.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.Z5a}`),this.l9a(O,"OnGestureEvent"),!0;const ca=O.Qua.scale/this.Z5a*this.Xfc;v.a(this.$).Wng(ca,this.g3b);e.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ca}. Current scale ${O.Qua.scale}`);this.l9a(O,"OnGestureEvent");return!0}qSi(O){v.a(this.$).Xng();e.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.l9a(O,"OnGestureEnd")}pSi(O){e.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.l9a(O,"OnGestureCancel")}l9a(O,ca){var wa,ia,Ha;this.Cif&&(e.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ca},        eventArgs non-null: ${isNullOrUndefined(O)}, gestureData non-null: ${isNullOrUndefined(null===
O||void 0===O?void 0:O.Qua)},        srcEvent non-null: ${isNullOrUndefined(null===(wa=null===O||void 0===O?void 0:O.Qua)||void 0===wa?void 0:wa.srcEvent)}`),null===(Ha=null===(ia=null===O||void 0===O?void 0:O.Qua)||void 0===ia?void 0:ia.srcEvent)||void 0===Ha?void 0:Ha.preventDefault())}}Object(t.a)(U,"PinchToZoomAdapter",null,[550]);var P=a(38);class aa extends P.a{constructor(){super()}Qre(O){this.addHandler("ZCIEK",O)}XWf(O){this.removeHandler("ZCIEK",O)}OXc(O){this.addHandler("ZCUIK",O)}zMd(O){this.removeHandler("ZCUIK",
O)}Abj(){this.raiseEvent("ZCIEK")}zbj(){this.raiseEvent("ZCUIK")}Bbj(){this.raiseEvent("ZCEK")}}Object(t.a)(aa,"ZoomEventManager",P.a,[549]);var X=a(22);class Z extends P.a{constructor(O){super();this.statusBarManager=null;this.IZe=!1;this.$=O;this.$.da.gb(29,ca=>{this.statusBarManager=ca;ca.XI(this)})}nq(O){this.addHandler("Zoom",O)}Iq(O){this.removeHandler("Zoom",O)}pz(){this.tn("QueryZoomStatus")&&this.raiseEvent("Zoom")}Tr(O,ca){return"QueryZoomStatus"!==O?!1:this.t$h(ca)}tn(){return v.a(this.$).bX()}dispose(){this.statusBarManager&&
(this.statusBarManager.wF(this),this.statusBarManager=null);this.$=null;super.dispose()}c9e(O){O=this.J6h(O);if(!O)return null;O=O.getElementsByClassName("cui-ctl-mediumlabel");return 1!==O.length?(e.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):O[0]}t$h(O){if(!this.$)return!1;const ca=v.a(this.$).YQb,wa=this.c9e("HandleQueryZoomStatusCommand");wa?X.a.equals(O.LabelText.toString(),ca,!1)||(wa.innerText="",this.l5f(O,ca)):this.l5f(O,
ca);return!0}l5f(O,ca){O.LabelText=ca}J6h(O){var ca=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ca)return ca=(ca=this.$.ea.$b)?ca.inEmbedView:!1,u.a.cp||ca||e.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${O}`),null;this.IZe||(this.IZe=!0,e.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${O}`));return ca}}Object(t.a)(Z,
"ZoomStatusBarManager",P.a,[2,282,203]);class da extends w.a{constructor(O){super(O);this.zoomEventManager=this.txa=this.RCb=null;this.VCb=-1;this.Aif=!1;this.Uc=()=>{this.VCb=-1};e.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Ugb=new Z(O);this.a5i()&&(e.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.OTg());this.Kgj()}dispose(){this.Ugb&&(n.a.Ja(this.Ugb),this.Ugb=null);this.zoomEventManager&&(this.$.da.eU(419),this.zoomEventManager=
null);this.Aif&&this.cmh();super.dispose()}bX(){return!0}Wng(O,ca){O=this.MJa(O);if(L.h(this.$).rtl){const wa=Math.round(D.DOMElementExtensions.getBounds(this.$.rf).width*v.a(this.$).zoom);this.RCb=new Sys.UI.Point(wa-ca.x,ca.y)}else this.RCb=ca;this.$Ra(O,!1,"ZoomWithPinch")}KFc(){return!0}JFc(O,ca){var wa=u.a.isMac?.07:.15;O=this.zoom+(O?wa:-wa);O=this.MJa(O);L.h(this.$).rtl?(wa=Math.round(D.DOMElementExtensions.getBounds(this.$.rf).width*v.a(this.$).zoom),this.txa=new Sys.UI.Point(wa-ca.x,ca.y)):
this.txa=ca;ca=this.zoom;this.$Ra(O,!0,"ZoomWithMouse");ca={["InitialZoom"]:ca,["FinalZoom"]:O,["Location"]:"canvas"};Y.b(this.$).rd(R.a.m7j,ca)}Xng(){this.RCb=null}LFc(O,ca){this.$Ra(this.MJa(O),!1,ca?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Yng(O){isNaN(O)?e.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.$Ra(this.MJa(O),!1,"ZoomToLevelInExcelLive")}MFc(O,ca){this.$Ra(this.MJa(O),!0,ca?"ZoomWithShortcuts":"ZoomWithButtons")}V6e(O,
ca){const wa=L.h(this.$).rtl,[ia,Ha]=this.Ohd(wa),[Sa,Da]=this.Jjd(O,Ha);return this.txa?(O=this.xhd(this.txa,O,ca,Ha,ia,"ZoomWithMouse"),this.txa=null,O):this.RCb?this.xhd(this.RCb,O,ca,Ha,ia,"ZoomWithPinch"):L.h(this.$).ha.Sa.G4?this.l7j(O,ca,Ha,ia,Sa,Da,L.h(this.$).rtl):this.n7j(O,ca,Ha,ia,Sa,Da,L.h(this.$).rtl)}N1f(O,ca,wa){if(O){e.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${O.x} ${O.y}) (new top-left) from zoom:${ca} to zoom:${wa}`);O=new C.a(O.x,O.y);wa=L.h(this.$).rtl;[,wa]=this.Ohd(wa);const [ia,
Ha]=this.Jjd(ca,wa);L.h(this.$).sse(O,ia,Ha,"ApplicationZoom")}else e.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ca} to zoom:${wa}`)}zoomFitToScreen(){const O=this.zoom;var ca=L.h(this.$).rtl;const [wa,ia]=this.Ohd(ca),[Ha,Sa]=this.Jjd(O,ia);var Da=L.h(this.$).ha.Sa.G4;(ca=Da?this.X2e(this.Y$a,Ha,Sa,!1):this.d7e(this.Y$a,ia,wa,Ha,Sa,ca,!1))?(ca=Math.min(Ha/(ca.width+100),Sa/(ca.height+100)),ca=this.hIh(ca),this.$Ra(ca,!0,"ZoomWithFitToScreen"),Da?L.h(this.$).ha.Sa.Gsa(L.h(this.$).ha.Sa.dc,
!1):(Da=S.v(L.h(this.$).ha.qa.activeRange,this.$),L.h(this.$).qg(Da,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.VCb=O,this.Aif||this.LTg()):e.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Da}`)}zoomFitToScreenUndo(){this.$Ra(this.VCb,!1,"ZoomWithFitToScreen")}fUd(){return-1!==this.VCb}LTg(){const O=L.h(this.$);O&&(O.ha.cC(this.Uc),O.gE(this.Uc))}cmh(){const O=L.h(this.$);O&&(O.ha.sB(this.Uc),O.yF(this.Uc))}hIh(O){O=Math.min(O,
d.a.tHi);O=Math.max(O,d.a.mIi);return Math.round(100*O)/100}$Ra(O,ca,wa){if(this.HFc()){var ia=L.h(this.$).view.visibleArea.toString();O=this.MJa(O);var Ha=H.d(this.$.va.na);Ha||(Ha=w.a.Exf);L.h(this.$).vh.u0(5,N.a.GFc,wa);L.h(this.$).vh.zla(N.a.GFc,this.$.ea.se);e.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${O} to sheet ${Ha} origin ${wa} prevZoom ${this.zoom}`);this.cCj(Ha,O);this.zoomEventManager.Bbj();this.NUj(wa);this.YUj(ca);this.VCb=-1;l.b(this.$,wa);O=L.h(this.$).view.visibleArea.toString();
e.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${ia}, NewGridVisibleArea: ${O}, IsShyRibbonActive: ${this.$.SZ}`)}}LRh(O){return(O=E.HelperMethods.LC(this.$.rf,this.$.domElement,O))?O:new Sys.UI.Point(0,0)}Ohd(O){const ca=this.LRh(O);O=this.wWh(ca,O);return[ca,O]}Jjd(O,ca){const wa=D.DOMElementExtensions.getBounds(this.$.rf);return[Math.round((wa.width-ca.x)*O),Math.round((wa.height-ca.y)*O)]}wWh(O,ca){ca=E.HelperMethods.LC(L.h(this.$).domElement,this.$.domElement,
ca);return ca?(O=new Sys.UI.Point(Math.round(ca.x-O.x),Math.round(ca.y-O.y)),O):new Sys.UI.Point(0,0)}n7j(O,ca,wa,ia,Ha,Sa,Da){return(Da=this.d7e(O,wa,ia,Ha,Sa,Da))?this.Q5e(Da,O,ca,wa,ia,Ha,Sa):null}d7e(O,ca,wa,ia,Ha,Sa,Da=!0){var ea=S.F(L.h(this.$).ha.qa.selectedRanges);if(Da&&(ea=ea.De(S.F(L.h(this.$).Cdc())),!ea))return e.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const sa=L.h(this.$).Qb(ea.topLeft);ea=L.h(this.$).Qb(ea.bottomRight);
if(!sa||!ea)return e.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;O=sa.cell.vQ===ea.cell.vQ&&sa.cell.uQ===ea.cell.uQ?this.BQh(O,ea,ca,wa,ia,Sa):this.w5h(O,sa,ea,ca,wa,ia,Sa);return O?Da?this.AYe(O,ia,Ha):O:(e.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}AYe(O,ca,wa){if(0>O.x||O.x>ca)O.x=0;if(0>O.y||O.y>wa)O.y=0;O.x+O.width>ca&&(O.width=
ca-O.x);O.y+O.height>wa&&(O.height=wa-O.y);return O}w5h(O,ca,wa,ia,Ha,Sa,Da){ca=L.h(this.$).getCellBounds(ca.cell);if(!ca)return null;const ea=L.h(this.$).getCellBounds(wa.cell);if(!ea)return null;let sa=Ha.x;Da&&(sa=0,ca.x=Math.round(Sa/O)-ca.x-Math.round(ca.width),ea.x=Math.round(Sa/O)-ea.x-Math.round(ea.width));O=new Sys.UI.Bounds(Math.round((ca.x-ia.x)*O)-sa,Math.round((ca.y-ia.y)*O-Ha.y),Math.round((ea.x+ea.width-ca.x)*O),Math.round((ea.y+ea.height-ca.y)*O));wa=wa.cell.getRange();e.ULS.sendTraceTag(537149774,
0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${wa.top}, b:${wa.bottom}, r:${wa.right}, l:${wa.left}) in bounds (${O.x}, ${O.y}, ${O.width}, ${O.height})`);return O}BQh(O,ca,wa,ia,Ha,Sa){const Da=L.h(this.$).getCellBounds(ca.cell);if(!Da)return null;let ea=ia.x;Sa&&(ea=0,Da.x=Math.round(Ha/O)-Da.x-Math.round(Da.width));O=new Sys.UI.Bounds(Math.round((Da.x-wa.x)*O)-ea,Math.round((Da.y-wa.y)*O-ia.y),Math.round(Da.width*O),Math.round(Da.height*
O));ca=ca.cell.getRange();e.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ca.top}, l:${ca.left}) in bounds (${O.x}, ${O.y}, ${O.width}, ${O.height})`);return O}l7j(O,ca,wa,ia,Ha,Sa){const Da=this.X2e(O,Ha,Sa);return Da?this.Q5e(Da,O,ca,wa,ia,Ha,Sa):null}Q5e(O,ca,wa,ia,Ha,Sa,Da){O=new Sys.UI.Point(this.v6e(Sa,O.x,O.width),this.v6e(Da,O.y,O.height));return this.xhd(O,ca,wa,ia,Ha)}v6e(O,ca,wa){return O===wa?(e.ULS.sendTraceTag(537149772,
0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),O/2):O*ca/(O-wa)}X2e(O,ca,wa,ia=!0){const Ha=L.h(this.$).ha.Sa.dc.domElement;var Sa=E.HelperMethods.LC(Ha,L.h(this.$).domElement,L.h(this.$).rtl);if(!Sa)return e.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Da=L.h(this.$).Vxb();Sa=new Sys.UI.Point(Math.round((Sa.x-Da.topLeft.x)*O),Math.round((Sa.y-Da.topLeft.y)*
O));O=new Sys.UI.Bounds(Sa.x,Sa.y,Math.round(Ha.offsetWidth*O),Math.round(Ha.offsetHeight*O));return ia?this.AYe(O,ca,wa):O}$xf(){this.Ugb.pz()}NLi(O){"ZoomToLevelInExcelLive"===O?this.zoomEventManager.Abj():this.zoomEventManager.zbj()}Kgj(){this.zoomEventManager=this.$.da.Ha(419,new aa)}xhd(O,ca,wa,ia,Ha,Sa=""){var Da=L.h(this.$).rtl?0:Ha.x;Ha="ZoomWithPinch"===Sa||"ZoomWithMouse"===Sa?new Sys.UI.Point(O.x-Da-Math.round(ia.x*ca),O.y-Ha.y-Math.round(ia.y*ca)):O;Ha=new Sys.UI.Point(Math.round(Ha.x/
ca),Math.round(Ha.y/ca));e.ULS.shipAssertTag(537149770,0,!!ca,"Original zoom level must be different than 0");Da=wa/ca;Ha=new Sys.UI.Point(Math.round(Ha.x*(1-1/Da)),Math.round(Ha.y*(1-1/Da)));"ZoomWithMouse"===Sa||"ZoomWithPinch"===Sa?(Ha.x+=Math.round((ia.x-L.h(this.$).xr)*(Da-1)),Ha.y+=Math.round((ia.y-L.h(this.$).hJ)*(Da-1))):(Da=Math.round(ia.x*(wa-ca)),0<Da&&Ha.x>Da&&(Ha.x+=Da),ca=Math.round(ia.y*(wa-ca)),0<ca&&Ha.y>ca&&(Ha.y+=ca));"ZoomWithMouse"===Sa&&(O.x||(Ha.x=0),O.y||(Ha.y=0));O=L.h(this.$).Vxb();
return new Sys.UI.Point(Ha.x+O.topLeft.x,Ha.y+O.topLeft.y)}OTg(){const O=[];z.a.instance.Tb("Common.IGestureInputManager").execute(ca=>{0===ca.VVh()&&ca.nfj(document.body,new U(this.$),O)})}a5i(){return this.HFc()&&(u.a.$o&&u.a.nMa(67)||this.$.fkc)}cCj(O,ca){l.a(this.$)?this.setZoomLevel(O,ca,this.S2d,d.a.eOf):this.setZoomLevel(O,ca,this.zoomPerSheetId,this.Y$a)}setZoomLevel(O,ca,wa,ia){wa.remove(O);ca!==ia&&wa.add(O,ca)}NUj(O){this.c6f();this.$.yza(I.a.mZ("TriggerImmediateZoomOperations"));this.e2j();
this.NLi(O)}e2j(){this.ati()?this.$.qf():this.Ugb.pz();const O=this.Ugb.c9e("UpdateZoomStatusBar");O&&(O.innerText=this.YQb)}ati(){const O=B.a(this.$);return O?O.lp.Iz===(G.a.SMa(this.$)?y.a.ktc:this.$.Bb+y.a.m_f):!1}YUj(O){L.h(this.$).k7j(O);this.VPg()}VPg(){const O=M.a(this.$);if(O)for(const ca of L.h(this.$).Ca.JA()){if(!ca){e.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!ca.uk)continue;const wa=ca.xi;if(wa)for(let ia=
0;ia<wa.count;ia++)if(2===wa.Xf(ia).type){const Ha=O.lr(wa.Xf(ia).Fg());Ha?(Ha.xea(!1),e.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):e.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else e.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(t.a)(da,"ZoomManager",w.a,[]);class qa extends F.a{constructor(O){super();
this.$=O;this.Db()}create(){const O=new da(this.$);this.g2j(O);this.$.da.Ha(368,O);this.nb(O)}g2j(O){const ca=v.a(this.$);if(ca){var wa=ca.Ojd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");O.ySd(wa);O.Bwc(ca.qDc)}else e.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(O){O.da.Ha(369,new qa(O))}}Object(t.a)(qa,"ZoomManagerFactory",
F.a,[]);a=a(1154);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(O=>{qa.ka(O);x.ka(O)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/c48f5e7c130adf00017ff5d67bedf5fc/EwaDSEsNext.zoom.js.map