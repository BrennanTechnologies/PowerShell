/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1210:function(t,F,a){t=a(0);var c=a(15),b=a(85),e;(function(S){S[S.generalException=0]="generalException";S[S.invalidArgument=1]="invalidArgument";S[S.notAllowed=2]="notAllowed";S[S.apiNotAvailable=3]="apiNotAvailable";S[S.unresolvedPendingRequest=4]="unresolvedPendingRequest";S[S.timeout=5]="timeout";S[S.adalTimeout=6]="adalTimeout";S[S.userNotSignedIn=7]="userNotSignedIn";S[S.userAborted=8]="userAborted";
S[S.silentSignInFailed=9]="silentSignInFailed";S[S.invalidResourceUrl=10]="invalidResourceUrl";S[S.invalidGrant=11]="invalidGrant";S[S.connectionLost=12]="connectionLost";S[S.clientError=13]="clientError";S[S.serverError=14]="serverError"})(e||(e={}));Object(t.b)("ErrorCodes",e);a(1325);class f{constructor(S,G){this.requestCallback=this.requestParameters=null;this.requestParameters=S;this.requestCallback=G}}Object(t.a)(f,"OutstandingRequest",null,[]);class d{}d.WKi="AADSTS50058";d.invalidResourceUrl=
"AADSTS50001";d.RKi="AADSTS65001";d.gLi="AADSTS70011";d.userAborted="13002";d.H6i="Popup Window is null";d.G6i="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.kTj="tokenRevoked";Object(t.a)(d,"WopiHostErrorType",null,[]);var h=a(4),m=a(555),l=a(572),v=a(39),r=a(1324);class A{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(A,"WopiIdentityInfo",null,[561]);class x{constructor(S,G,D){this.expiration=
this.authority=this.accessToken=null;this.accessToken=S;this.authority=G;this.expiration=D}}Object(t.a)(x,"WopiIdentityToken",null,[560]);var n=a(27),u=a(151),z=a(376),w=a(167),C=a(70),y=a(346);class B{constructor(S){this._initialized=!1;this.dab={};this.QAc={};this.iO=h.AFrameworkApplication.ra.ED;this.qmd=S}x2a(S){this._initialized||(S.Yn(w.a.qNf),S.Dl(w.a.qNf,Object(b.a)(this,this.VXi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(S,G,D=null){this.YNa(S,G);return new Promise((E,
M)=>{if(this.Uod(G))if(G in this.dab)M("unresolvedPendingRequest");else{var L=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,v.c({["error"]:"Request timeout.",["callerId"]:G}));M("timeout")},12E4);this.Fed(S,G,D,(N,Y)=>{window.clearTimeout(L);N?E(N):(c.ULS.sendTraceTag(37856033,369,15,v.c({["error"]:e[Y]})),M(Y))})}else c.ULS.sendTraceTag(37856034,344,10,v.c({["error"]:"Caller is not allowed."})),M("notAllowed")})}getPrimaryIdentityInfo(S){return new Promise((G,D)=>{this.Uod(S)?this.i0h((E,
M)=>{E?G(E):(c.ULS.sendTraceTag(37856064,369,10,v.c({["error"]:M.toString()})),D(M))}):(c.ULS.sendTraceTag(37856065,344,10,v.c({["error"]:"Caller is not allowed."})),D("notAllowed"))})}getAuthContext(S){return new Promise((G,D)=>{const E=this.getAuthContextSync(S);E?G(E):D("notAllowed")})}getAuthContextSync(S){if(this.Uod(S)){const G=new r.a;G.upn=h.AFrameworkApplication.fa.Wa("UserPrincipalName");G.userId=h.AFrameworkApplication.fa.Wa("LoggableUserId");G.authority=h.AFrameworkApplication.fa.Wa("HostAuthAuthority");
G.tenantId=h.AFrameworkApplication.fa.Wa("TenantId");G.isAnonymous=h.AFrameworkApplication.fa.pa("IsAnonymousUser");G.supportsAuthToken=this.idi(S);S=h.AFrameworkApplication.fa.Wa("HostAuthType");G.authorityType="aad"===S.toLowerCase()?2:"msa"===S.toLowerCase()?1:0;return G}c.ULS.sendTraceTag(40751647,344,10,v.c({["error"]:"Caller is not allowed."}));return null}idi(S){const G=m.OAuthManagerSettings.$yb;return n.a.hxa?G&&m.OAuthManagerSettings.Pdg?Array.contains(m.OAuthManagerSettings.Pdg,S.toLowerCase()):
!1:G}Fed(S,G,D,E){var M=[];Array.add(M,Object.assign(new C.a,{name:"CallerId",string:G}));Array.add(M,Object.assign(new C.a,{name:z.a.fWd,string:S.correlationId}));u.a.sendTelemetryEvent(Object.assign(new y.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:M}));M=l.a.create().toString();const L="getAccessToken_"+M,N=this.iO.Gc("ComponentAttach",L);this.QAc[L]=N;const Y={};Y[z.a.gWd]=M;Y[z.a.AMj]=S.resource;Y[z.a.BMj]=S.scope;Y[z.a.Sag]=h.AFrameworkApplication.fa.Wa("HostAuthType");
Y[z.a.EMj]=h.AFrameworkApplication.fa.Wa("UserPrincipalName");Y[z.a.CMj]=S.silentLogin;Y[z.a.xMj]=S.options;Y[z.a.fWd]=S.correlationId;Y[z.a.yMj]=G;D&&(Y[z.a.addinName]=D.AddinName,Y[z.a.wMj]=D.AddinTrustId);this.qmd.execute(U=>{this.x2a(U);U.jj(w.a.getAuthToken,Y)});this.dab[M]=new f(S,E)}i0h(S){const G=h.AFrameworkApplication.fa.Wa("UserName"),D=h.AFrameworkApplication.fa.Wa("UserPrincipalName"),E=h.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),M=new A;M.email=D;M.displayName=G;switch(E){case "OrgIdPuid":M.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":M.authority="MicrosoftAccount";break;default:M.authority=E}S(M,null)}VXi(S){let G=null;try{let E=S.Values[z.a.gWd];const M=S.Values[z.a.vMj],L=S.Values[z.a.Sag],N=S.Values[z.a.DMj];let Y=null,U=null;const P=this.dab[E];if("undefined"!==typeof P&&P){var D=[];Array.add(D,Object.assign(new C.a,{name:z.a.fWd,string:P.requestParameters.correlationId}));u.a.sendTelemetryEvent(Object.assign(new y.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:D}));G=P.requestCallback;delete this.dab[E];"undefined"!==typeof M&&M&&M.length?U=new x(M,L,N):Y=e[this.aGi(S)];D="getAccessToken_"+E;D in this.QAc&&(this.QAc[D].stop(),delete this.QAc[D]);G(U,Y)}else c.ULS.sendTraceTag(37856066,344,10,v.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:E}))}catch(E){S=S.Values[z.a.gWd],S in this.dab&&delete this.dab[S],this.Ilc(),c.ULS.sendTraceTag(37856067,344,10,v.c({["error"]:E.message,["stack"]:E.stack})),G&&G(null,"generalException")}}Uod(S){var G=
h.AFrameworkApplication.j7h();S=S.toLowerCase();for(const D of G)if(S===D.toLowerCase())return!0;G=m.OAuthManagerSettings.DYc;for(let D in G)if(S===G[D].toLowerCase())return!0;return!1}aGi(S){S=S.Values[z.a.zMj];this.Ilc();c.ULS.sendTraceTag(39068821,344,15,v.c({["error"]:S}));return S?-1<S.indexOf(d.WKi)?9:-1<S.indexOf(d.H6i)||-1<S.indexOf(d.G6i)?12:-1<S.indexOf(d.invalidResourceUrl)?10:-1<S.indexOf(d.userAborted)?8:-1<S.indexOf(d.gLi)||-1<S.indexOf(d.RKi)||S===d.kTj?11:-1<S.indexOf(d.adalTimeout)?
6:0:13}YNa(S,G){S=this.hej(S.resource);c.ULS.sendTraceTag(39921882,344,50,v.c({["callerId"]:G,["resource"]:S}))}Ilc(){c.ULS.sendTraceTag(39068822,344,50,v.c({["userAgent"]:window.navigator.userAgent}))}hej(S){return(S?S:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(B,"WopiIdentityManager",null,[535]);var H=a(252);class I{constructor(){this.$a=null}get name(){return"Common.App.WopiIdentity"}Ah(S){this.$a=S;S.register(B,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").qc().yc(()=>
new B(S.Tb("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.ru(Object(b.a)(this,this.jB,"onFullAppSettingsReady"))}jB(){try{this.$a.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(S){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+S)}}dispose(){}static main(){H.a.instance.gi(new I)}}Object(t.a)(I,"WopiIdentityPackage",null,[4,5]);a.d(F,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.WopiIdentity");
I.main()}},1215:function(t,F,a){a.r(F);t=a(0);var c=a(7),b=a(15),e=a(4),f=a(160),d=a(191),h=a(84),m=a(192),l=a(60),v=a(50),r=a(37),A=a(230),x=a(113),n=a(527);class u{constructor(Da){Da=Da.split("|");this.ex=Da[1];this.vTc=Da[2];this.YWd=Da[3]}get solutionId(){return this.ex}get solutionVersion(){return this.vTc}get needToRestoreManifest(){return this.YWd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(u,"AddinStoreInfo",null,[]);class z{}Object(t.a)(z,"CustomFunctionRegistrationInfos",null,[]);
var w=a(202),C=a(71);const y=(Da,ea,sa)=>B(Da,ea,w.a.none,C.a.current,sa),B=(Da,ea,sa,Ea,ba)=>{sa=Da.continueWith(()=>{ea(Da)},3,sa,Ea);sa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ba)},4);return sa},H=(Da,ea,sa)=>I(Da,ea,w.a.none,C.a.current,sa),I=(Da,ea,sa,Ea,ba)=>{sa=Da.Qo(()=>ea(Da),3,sa,Ea);sa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ba)},4);return r.TaskExtensions.rDc(sa)},R=(Da,ea,sa)=>S(Da,ea,w.a.none,C.a.current,sa),S=(Da,ea,sa,Ea,ba)=>{sa=Da.Qo(()=>ea(Da),3,sa,Ea);sa.continueWith(()=>
{b.ULS.sendTraceTag(537163461,0,10,ba)},4);return sa},G=(Da,ea,sa)=>D(Da,ea,w.a.none,C.a.current,sa),D=(Da,ea,sa,Ea,ba)=>{sa=Da.Qo(()=>ea(Da),3,sa,Ea);sa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ba)},4);return r.TaskExtensions.rDc(sa)},E=(Da,ea,sa)=>M(Da,ea,w.a.none,C.a.current,sa),M=(Da,ea,sa,Ea,ba)=>{sa=Da.continueWith(()=>{ea(Da)},3,sa,Ea);sa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ba)},4);return sa},L=(Da,ea)=>{R(a(1215).CustomFunctionsInstaller.q4e("CustomFunctionsRuntimeLogging"),
sa=>{if(sa.result&&window.console)switch(sa=N(Da.severity)+" "+Da.message+ea,Da.severity){case 2:window.console.log&&window.console.log(sa);break;case 0:window.console.info&&window.console.info(sa);break;case 1:window.console.error&&window.console.error(sa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},N=Da=>{switch(Da){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var Y=a(979);class U{}Object(t.a)(U,
"InstallationInfo",null,[]);class P{}Object(t.a)(P,"UninstallationInfo",null,[]);var aa=a(28),X=a(94),Z=a(35),da=a(29),qa=a(1),O=a(22),ca=a(282),wa=a(799),ia=a(55);class Ha{constructor(Da,ea){this.TSc=Da;this._message=ea}get severity(){return this.TSc}get message(){return this._message}}Object(t.a)(Ha,"CustomFunctionLog",null,[]);a.d(F,"CustomFunctionsInstaller",function(){return Sa});class Sa{constructor(Da,ea,sa){this.Qwa=!1;this.$E={};this.$=Da;this.lj=ea;this.nod().ina();this.indexedDB=sa;this.indexedDB.Fe()&&
(this.Qwa=!0,this.indexedDB.initialize(Sa.wzb,Sa.xzb))}get XU(){return this.lj.XU}pff(Da,ea,sa,Ea){if(Ea.invariantNamespace)for(let ba=0;ba<Ea.invariantNamespace.length;++ba){const ka=Ea.invariantNamespace.charAt(ba);if("."!==ka&&"_"!==ka&&"a">ka&&"z"<ka&&"A">ka&&"Z"<ka&&"0">ka&&"9"<ka)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ka}', Position=${ba}.`),Error.create("InvariantNamespace validation failed");}return H(this.K_g(sa,
Ea.manifest),()=>H(this.DJd(Da),ba=>{let ka=ba.result;return(null===ka||void 0===ka?0:ka.isDynamicMetadata)?this.EKd(Da,ea,ka,!1,!1,!1):H(this.T6j(Da,ea,Ea),Ca=>{let db;ka=(db=new U,db.addinId=sa,db.locale=Ea.locale,db.addinInvariantNamespace=Ea.invariantNamespace,db.addinNamespace=Ea.namespace,db.addinTitle=Ea.title,db.isXllCompatible=Ea.isXllCompatible,db.metadataContent=JSON.stringify(JSON.parse(Ca.result)),db);return this.EKd(Da,ea,ka,!1,Sa.PEh(Ea.osfControl.getStoreType()),Y.a(this.$,Ea))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}rff(Da,ea,sa,Ea){if(!Sa.Ptd(sa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return H(this.DJd(Da),ba=>{ba=ba.result;if(!ba&&(ba=Z.a.Fc(this.XU,Da),!ba))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
ea,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ba.metadataContent=JSON.stringify(JSON.parse(sa));ba.isDynamicMetadata=!0;return this.EKd(Da,ea,ba,!0,!0,Ea)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Ihg(Da,ea){this.lj.via();const sa=Object(c.a)(new P,{solutionId:Da}),Ea=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
ea,null)}.`;return H(this.nLd(Da),()=>H(this.uLd(Da),()=>this.B_d(this.lj,Da,ea,sa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ea)}T6j(Da,ea,sa){const Ea=new f.a;OSF.OUtil.xhrGet(sa.metadataUrl,ba=>{ba?Ea.setResult(ba):Ea.setException(Error.create("Invalid manifest"))},ba=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
ea,null)}. ErrorCode: ${ba}.`);Ea.rs()});return Ea.task}nod(){return H(this.mtc(),Da=>{const ea=Da.result;if(!ea.length)return ia.Task.Ra(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Da=new d.a;const sa=[];for(let Ea=0;Ea<ea.length;Ea++){const ba=Object(h.a)(String,ea[Ea]);Da.add(R(this.DJd(ba),ka=>{if(ka=ka.result){const Ca=Z.a.Fc(this.$E,ka.addinId);Ca&&Ca===ka.metadataContent||(this.$E[ka.addinId]=ka.metadataContent,
this.XU[ba]=ka,sa.push(ka))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return G(ia.Task.WhenAllEnumerable(Da),()=>{if(sa.length){let Ea;const ba=(Ea=new z,Ea.registrationInfos=sa,Ea);return this.F1b(this.lj,ea,ba)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ia.Task.Ra(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")}sff(){var Da=new f.a;new d.a;const ea=[],sa=[];Object.keys(this.XU).forEach(Ea=>{Ea=Object(h.a)(String,Ea);const ba=Z.a.Fc(this.XU,Ea);ea.push(ba);sa.push(Ea)});if(!sa.length)return Da.setResult(!0),Da.task;Da=Object(c.a)(new z,{registrationInfos:ea});return this.F1b(this.lj,sa,Da)}mtc(){return R(this.mhd(n.a.fZa),Da=>{Da=Da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Da||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Da||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Nng(Da){return this.NRd(n.a.fZa,Sys.Serialization.JavaScriptSerializer.serialize(Da))}DJd(Da){return H(this.mhd(n.a.C4a(Da)),ea=>{ea=ea.result||"";return 0<ea.length?ia.Task.Ra(Sys.Serialization.JavaScriptSerializer.deserialize(ea,!0)):ia.Task.Ra(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}L6j(Da,ea){return H(this.SPe(Da),
()=>H(this.NRd(n.a.C4a(Da),Sys.Serialization.JavaScriptSerializer.serialize(ea)),()=>Sa.ORd(n.a.fld,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}nLd(Da){return H(this.JUf(Da),()=>H(this.aVf(n.a.C4a(Da)),()=>H(this.mtc(),ea=>ea.result.length?ia.Task.Ra(!0):Sa.ORd(n.a.fld,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),
"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}SRf(Da){return this.mhd(n.a.B4a(Da))}Kng(Da,ea){return H(this.SPe(Da),()=>this.NRd(n.a.B4a(Da),ea),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}uLd(Da){return H(this.JUf(Da),()=>this.aVf(n.a.B4a(Da)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}SPe(Da){return H(this.mtc(),
ea=>{ea=ea.result;const sa=Da.toLowerCase();if(ea.includes(sa))return ia.Task.Ra(!0);ea.push(sa);return this.Nng(ea)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}JUf(Da){return H(this.mtc(),ea=>{ea=ea.result;const sa=Da.toLowerCase();return ea.includes(sa)?(ea.splice(Array.indexOf(ea,sa),1),this.Nng(ea)):ia.Task.Ra(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}K_g(Da,
ea){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Da=new OSF.AddinIdInfo(Da),Da.needToRestoreManifest()?this.Kng(Da.getSolutionId(),ea):ia.Task.Ra(!0);Da=new u(Da);return Da.needToRestoreManifest?this.Kng(Da.solutionId,ea):ia.Task.Ra(!0)}tpj(Da){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const sa=new OSF.AddinIdInfo(Da);return sa.needToRestoreManifest()?R(this.SRf(sa.getSolutionId()),Ea=>{(Ea=Ea.result)&&
OSF.OsfManifestManager.cacheManifestFromXml(sa.getSolutionId(),sa.getSolutionVersion(),Ea,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ia.Task.Ra(!0)}const ea=new u(Da);return ea.needToRestoreManifest?R(this.SRf(ea.solutionId),sa=>{(sa=sa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ea.solutionId,ea.solutionVersion,sa,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):
ia.Task.Ra(!0)}aVf(Da){return this.Qwa?this.indexedDB.e8c(Da):Sa.Qhj(Da)}NRd(Da,ea){return this.Qwa?this.indexedDB.adb(new wa.a(Da,ea)):Sa.ORd(Da,ea)}mhd(Da){return this.Qwa?this.indexedDB.yKa(Da):Sa.q4e(Da)}EKd(Da,ea,sa,Ea,ba,ka){const Ca=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,ea,null)}.`;return r.TaskExtensions.rDc(R(this.FKd(this.lj,Da,ea,sa,!1,Ea,ka),()=>ba?this.L6j(Da,sa):ia.Task.Ra(!0),
Ca))}FKd(Da,ea,sa,Ea,ba,ka,Ca){if(!ka&&(ka=Z.a.Fc(this.$E,Ea.addinId))&&ka===Ea.metadataContent)return ia.Task.Ra(!0);this.$E[Ea.addinId]=Ea.metadataContent;this.XU[ea]=Ea;Ca||Da.qJb(ea);Da.via();return H(this.lfj(ea,sa,Ea),()=>this.lId(Ea.addinId,ba),"Failed to register functions for customfunction addin")}lfj(Da,ea,sa){const Ea=new f.a,ba=this.UGa(sa);return this.B3(ka=>{L(Sa.atb,Da);(ka=ka.Result)&&204===ka.ResponseStatusCode?Ea.setResult(!0):(delete this.$E[sa.addinId],delete this.XU[Da],y(this.nLd(Da),
()=>{y(this.uLd(Da),()=>{this.t9f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Da}. Received status code ${ka?ka.ResponseStatusCode.toString():"Unknown"}.`),Ea.setResult(!1))},ka=>{ka=x.a.Pe(ka.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,ea,null)}. Errors: ${da.a.nc(ka)}.`);
L(Sa.$sb,Da);delete this.$E[sa.addinId];delete this.XU[Da];Ea.setResult(!1)},ba,Ea,!0)}F1b(Da,ea,sa){const Ea=new f.a,ba=aa.a.Ya.ue.m;ea.forEach(Ca=>{Ca=Object(h.a)(String,Ca);Da.GBe(Ca)});Da.via();const ka=this.Q_c(sa);return this.B3(Ca=>{L(Sa.atb,Sys.Serialization.JavaScriptSerializer.serialize(ea));Ca=Ca.Result;let db=!0;var yb=Sys.Serialization.JavaScriptSerializer.deserialize(Ca.ResponseBody.toString());yb=Array.isArray(yb.value)?yb.value:null;const kb=new d.a;for(let mb=0;mb<yb.length;mb++)if(!yb[mb]){db=
!1;const W=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Ca.ResponseStatusCode}.`;kb.add(H(this.nLd(ea[mb]),()=>{delete this.$E[sa.registrationInfos[mb].addinId];delete this.XU[ea[mb]];return this.uLd(ea[mb])},W))}E(ia.Task.WhenAllEnumerable(kb),()=>{y(this.lId("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${aa.a.Ya.ue.m-ba} Millisecond.`);db?Ea.setResult(db):
E(this.t9f(),()=>{Ea.setResult(db)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Ca=>{Ca=x.a.Pe(Ca.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${da.a.nc(Ca)}.`);L(Sa.$sb,
Sys.Serialization.JavaScriptSerializer.serialize(ea));for(Ca=0;Ca<sa.registrationInfos.length;Ca++)delete this.$E[sa.registrationInfos[Ca].addinId],delete this.XU[ea[Ca]];Ea.setResult(!1)},ka,Ea,!0)}B_d(Da,ea,sa,Ea){return H(this.WXj(Da,ea,sa,Ea),()=>this.lId(Ea.solutionId,!1),"Failed to unregister functions for customfunction addin")}WXj(Da,ea,sa,Ea){const ba=new f.a;Da.qJb(ea);(Da=Z.a.Fc(this.XU,ea))&&delete this.$E[Da.addinId];delete this.XU[ea];Ea=this.b0c(Ea);return this.B3(()=>{L(Sa.f7c,ea);
ba.setResult(!0)},ka=>{ka=x.a.Pe(ka.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ea,sa,null)}. Errors: ${da.a.nc(ka)}.`);L(Sa.e7c,ea);ba.setResult(!1)},Ea,ba,!1)}B3(Da,ea,sa,Ea,ba){const ka=this.$.userOperationManager,Ca=this.$.oa;let db=null,yb=null,kb=null;const mb=()=>{if(ka.NHa()||0<Ca.xa.C3||0<Ca.Ok.C3)return!1;db&&ka.zo(db);yb&&Ca.ps(yb);kb&&
Ca.ky(kb);const W=sa.request;let Q=0;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?W.RequestFlags&1&&256!==(W.RequestFlags&256)||(Q=16):Q=W.RequestFlags&1?0:16;ka.FE(new m.a(507,0,(va,na,Ba)=>{L(ba?Sa.d7c:Sa.g7c,W.RequestBody);return l.g(Ca.xa,"ExecuteRichApiRequest",sa,ca.b(va,Da),ca.a(na,ea),Ba,null,0)},Q|64));return!0};mb()||(db=()=>{mb()},yb=()=>{mb()},kb=()=>{mb()},ka.Lr(db),Ca.Xq(yb),Ca.ox(kb));return Ea.task}UGa(Da){const ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};ea.RequestBody=JSON.stringify(Da);ea.RequestFlags=1;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Da=this.$.oa.xa.Na(1);Da.request=ea;return Da}Q_c(Da){const ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Da);ea.RequestFlags=1;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Da=this.$.oa.xa.Na(1);
Da.request=ea;return Da}b0c(Da){const ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Da);ea.RequestFlags=1;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Da=this.$.oa.xa.Na(1);Da.request=ea;return Da}lId(Da,ea){const sa=v.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return I(sa,()=>{sa.result.FNd();return Da&&ea?this.tpj(Da):ia.Task.Ra(!0)},this.$.la,A.a.instance,
"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}t9f(){const Da=new X.a(1949669462,0,this.$.xc,0,null);return this.$.Ia.Hb(Da)}static q4e(Da){try{return ia.Task.Ra(localStorage.getItem(Da))}catch(ea){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${ea.message||"Unknown"}`),ia.Task.Ra(null)}}static ORd(Da,ea){try{return localStorage.setItem(Da,
ea),ia.Task.Ra(!0)}catch(sa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${sa.message||"Unknown"}`),ia.Task.Ra(!1)}}static Qhj(Da){try{return localStorage.removeItem(Da),ia.Task.Ra(!0)}catch(ea){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${ea.message||"Unknown"}`),ia.Task.Ra(!1)}}static PEh(Da){return O.a.equals(Da,
"registry",!0)||O.a.equals(Da,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static Ptd(Da){if(!Da)return!1;try{JSON.parse(Da)}catch(ea){return!1}return!0}}Sa.wzb="CustomFunctionCache";Sa.xzb="CustomFunction";Sa.d7c=new Ha(2,"CustomFunctions [Registration] [Begin] SolutionId=");Sa.atb=new Ha(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Sa.$sb=new Ha(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");Sa.g7c=new Ha(2,
"CustomFunctions [Unregistration] [Begin] SolutionId=");Sa.f7c=new Ha(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Sa.e7c=new Ha(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(Sa,"CustomFunctionsInstaller",null,[531])},1218:function(t,F,a){a.r(F);t=a(0);var c=a(7),b=a(15),e=a(952),f=a(160),d=a(84),h=a(192),m=a(60),l=a(50),v=a(37),r=a(113),A=a(527),x=a(979);class n{constructor(L){L=L.split("|");this.ex=L[1];this.vTc=L[2];this.YWd=L[3]}get solutionId(){return this.ex}get solutionVersion(){return this.vTc}get needToRestoreManifest(){return this.YWd===
OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(n,"AddinStoreInfo",null,[]);class u{}Object(t.a)(u,"CustomFunctionRegistrationInfos",null,[]);const z=(L,N)=>{if(a(1218).CustomFunctionsLegacyInstaller.dxb("CustomFunctionsRuntimeLogging")&&window.console)switch(N=w(L.severity)+" "+L.message+N,L.severity){case 2:window.console.log&&window.console.log(N);break;case 0:window.console.info&&window.console.info(N);break;case 1:window.console.error&&window.console.error(N)}},w=L=>{switch(L){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class C{}Object(t.a)(C,"InstallationInfo",null,[]);class y{}Object(t.a)(y,"UninstallationInfo",null,[]);var B=a(158),H=a(35),I=a(29),R=a(13),S=a(282),G=a(881),D=a(55);class E{constructor(L,N){this.TSc=L;this._message=N}get severity(){return this.TSc}get message(){return this._message}}Object(t.a)(E,"CustomFunctionLog",null,[]);a.d(F,"CustomFunctionsLegacyInstaller",function(){return M});class M{constructor(L){this.$E={};this.$=L;
this.nod().ina()}pff(L,N,Y,U){const P=new f.a;if(U.invariantNamespace)for(N=0;N<U.invariantNamespace.length;++N){const X=U.invariantNamespace.charAt(N);if("."!==X&&"_"!==X&&"a">X&&"z"<X&&"A">X&&"Z"<X&&"0">X&&"9"<X)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${X}', Position=${N}.`),P.setResult(!1),P.task}M.cacheManifest(Y,U.manifest);let aa=M.EJd(L);(null===aa||void 0===aa?0:aa.isDynamicMetadata)?this.DKd(L,
aa,P,!1,!1):OSF.OUtil.xhrGet(U.metadataUrl,X=>{aa=Object(c.a)(new C,{addinId:Y,locale:U.locale,addinInvariantNamespace:U.invariantNamespace,addinNamespace:U.namespace,addinTitle:U.title,isXllCompatible:U.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(X))});this.DKd(L,aa,P,!1,x.a(this.$,U))},X=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${L}. ErrorCode: ${X}.`);P.setResult(!1)});return P.task}rff(L,
N,Y,U){N=new f.a;if(!M.Ptd(Y))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),N.setResult(!1),N.task;const P=M.EJd(L);if(!P)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),N.setResult(!1),N.task;P.metadataContent=JSON.stringify(JSON.parse(Y));P.isDynamicMetadata=!0;this.DKd(L,P,N,!0,U);return N.task}Ihg(L){const N=
new f.a,Y=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.za(Y,()=>{const U=Y.result;U.via();const P=Object(c.a)(new y,{solutionId:L});M.oLd(L);M.vLd(L);v.TaskExtensions.za(this.B_d(U,L,P),aa=>{B.b(aa)?N.setResult(aa.result):(aa.Hf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${L}.`):aa.kh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${L}.`),
N.setResult(!1))},this.$.la,0)},this.$.la,3);return N.task}nod(){const L=new f.a,N=M.JJd();0<N.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Y=[];N.forEach(P=>{P=Object(d.a)(String,P);if(P=M.EJd(P)){const aa=H.a.Fc(this.$E,P.addinId);aa&&aa===P.metadataContent||(this.$E[P.addinId]=P.metadataContent,Y.push(P))}});if(!Y.length)return L.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
L.task;const U=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.za(U,()=>{const P=U.result,aa=Object(c.a)(new u,{registrationInfos:Y});v.TaskExtensions.za(this.F1b(P,N,aa),X=>{B.b(X)?L.setResult(X.result):(X.Hf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):X.kh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
L.setResult(!1))},this.$.la,0)},this.$.la,3);return L.task}spj(L){L=new n(L);if(L.needToRestoreManifest){const N=M.Pcj(L.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(L.solutionId,L.solutionVersion,N,this.$.ya.UICultureTag)}}DKd(L,N,Y,U,P){const aa=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.za(aa,()=>{v.TaskExtensions.za(this.FKd(aa.result,L,N,!1,U,P),X=>{B.b(X)?((X=X.result)&&M.M6j(L,N),Y.setResult(X)):(X.Hf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${L}.`):
X.kh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${L}.`),Y.setResult(!1))},this.$.la,0)},this.$.la,3)}FKd(L,N,Y,U,P,aa){if(!P&&(P=H.a.Fc(this.$E,Y.addinId))&&P===Y.metadataContent)return D.Task.Ra(!0);this.$E[Y.addinId]=Y.metadataContent;const X=new f.a;aa||L.qJb(N);L.via();L=this.UGa(Y);return this.B3(Z=>{z(M.atb,N);const da=Z.Result;204===da.ResponseStatusCode?v.TaskExtensions.za(this.kId(X,Y.addinId,U),
qa=>{qa.Hf?N?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${N}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Y.addinId}.`):qa.kh&&(N?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${N}.`):b.ULS.sendTraceTag(537163482,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Y.addinId}.`));X.setResult(!1)},this.$.la,4):(Z=()=>{delete this.$E[Y.addinId];M.oLd(N);M.vLd(N);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${N}. Received status code ${da.ResponseStatusCode}.`);X.setResult(!1)},Z=Object(c.a)(new G.a,{QLa:OSF.InfoType.Error,title:Y.addinTitle,description:String.format(R.a.instance.ob(153),
R.a.instance.ga(1889)),buttonText:R.a.instance.ga(4),jha:Z,cfc:!1,kia:Z,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.pUd(Z))},Z=>{Z=r.a.Pe(Z.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${N}. Errors: ${I.a.nc(Z)}.`);z(M.$sb,N);delete this.$E[Y.addinId];X.setResult(!1)},L,X,!0)}F1b(L,N,Y){const U=new f.a;N.forEach(aa=>{aa=Object(d.a)(String,aa);L.GBe(aa)});L.via();
const P=this.Q_c(Y);return this.B3(aa=>{z(M.atb,Sys.Serialization.JavaScriptSerializer.serialize(N));aa=aa.Result;let X=!0;var Z=Sys.Serialization.JavaScriptSerializer.deserialize(aa.ResponseBody.toString());Z=Array.isArray(Z.value)?Z.value:null;for(let da=0;da<Z.length;da++)Z[da]||(X=!1,delete this.$E[Y.registrationInfos[da].addinId],M.oLd(N[da]),M.vLd(N[da]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${N[da]}. Received status code ${aa.ResponseStatusCode}.`));
v.TaskExtensions.za(this.kId(U,"",!1),da=>{da.Hf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):da.kh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");U.setResult(!1)},this.$.la,4);U.setResult(X)},aa=>{aa=r.a.Pe(aa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(N)}. Errors: ${I.a.nc(aa)}.`);
z(M.$sb,Sys.Serialization.JavaScriptSerializer.serialize(N));for(const X of Y.registrationInfos)delete this.$E[X.addinId];U.setResult(!1)},P,U,!0)}B_d(L,N,Y){const U=new f.a;L.qJb(N);L=this.b0c(Y);return this.B3(()=>{z(M.f7c,N);v.TaskExtensions.za(this.kId(U,Y.solutionId,!1),P=>{P.Hf?N&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${N}.`):P.kh&&N&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${N}.`);
U.setResult(!1)},this.$.la,4)},P=>{P=r.a.Pe(P.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${N}. Errors: ${I.a.nc(P)}.`);z(M.e7c,N);U.setResult(!1)},L,U,!1)}B3(L,N,Y,U,P){const aa=this.$.userOperationManager,X=this.$.oa;let Z=null,da=null,qa=null;const O=()=>{if(aa.NHa()||0<X.xa.C3||0<X.Ok.C3)return!1;Z&&aa.zo(Z);da&&X.ps(da);qa&&X.ky(qa);const ca=Y.request;aa.FE(new h.a(507,0,(wa,ia,Ha)=>
{z(P?M.d7c:M.g7c,ca.RequestBody);return m.g(X.xa,"ExecuteRichApiRequest",Y,S.b(wa,L),S.a(ia,N),Ha,null,0)},(ca.RequestFlags&1?0:16)|64));return!0};O()||(Z=()=>{O()},da=()=>{O()},qa=()=>{O()},aa.Lr(Z),X.Xq(da),X.ox(qa));return U.task}UGa(L){const N={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};N.RequestBody=JSON.stringify(L);N.RequestFlags=1;L=this.$.oa.xa.Na(1);L.request=N;return L}Q_c(L){const N={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
N.RequestBody=JSON.stringify(L);N.RequestFlags=1;L=this.$.oa.xa.Na(1);L.request=N;return L}b0c(L){const N={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};N.RequestBody=JSON.stringify(L);N.RequestFlags=1;L=this.$.oa.xa.Na(1);L.request=N;return L}kId(L,N,Y){const U=l.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);v.TaskExtensions.za(U,()=>{U.result.FNd();N&&Y&&this.spj(N);L.setResult(!0)},this.$.la,3);return U}sff(){return D.Task.Ra(!0)}static JJd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(M.dxb(A.a.fZa)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(M.dxb(A.a.fZa)||"[]"):null)||[]}static Ong(L){M.PRd(A.a.fZa,Sys.Serialization.JavaScriptSerializer.serialize(L))}static EJd(L){L=M.dxb(A.a.C4a(L))||"";return 0<L.length?Sys.Serialization.JavaScriptSerializer.deserialize(L,!0):null}static M6j(L,N){M.RPe(L);M.PRd(A.a.C4a(L),Sys.Serialization.JavaScriptSerializer.serialize(N))}static oLd(L){M.IUf(L);M.bVf(A.a.C4a(L))}static Pcj(L){return M.dxb(A.a.B4a(L))}static N6j(L,N){M.RPe(L);M.PRd(A.a.B4a(L),
N)}static vLd(L){M.IUf(L);M.bVf(A.a.B4a(L))}static RPe(L){const N=M.JJd();L=L.toLowerCase();N.includes(L)||(N.push(L),M.Ong(N))}static IUf(L){const N=M.JJd();L=L.toLowerCase();N.includes(L)&&(N.splice(Array.indexOf(N,L),1),M.Ong(N))}static cacheManifest(L,N){L=new n(L);L.needToRestoreManifest&&M.N6j(L.solutionId,N)}static dxb(L){try{return localStorage.getItem(L)}catch(N){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${N.message||
"Unknown"}`),null}}static PRd(L,N){try{localStorage.setItem(L,N)}catch(Y){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Y.message||"Unknown"}`)}}static bVf(L){try{localStorage.removeItem(L)}catch(N){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${N.message||"Unknown"}`)}}static Ptd(L){if(!L)return!1;try{JSON.parse(L)}catch(N){return!1}return!0}}
M.d7c=new E(2,"CustomFunctions [Registration] [Begin] SolutionId=");M.atb=new E(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");M.$sb=new E(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");M.g7c=new E(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");M.f7c=new E(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");M.e7c=new E(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(M,"CustomFunctionsLegacyInstaller",null,[531])},
1258:function(t,F,a){t=a(0);var c=a(202),b=a(15);class e{}Object(t.a)(e,"AddinCommandsHost",null,[]);var f=a(1335),d=a(1419),h=a(880),m=a(60);const l=(H,I,R,S,G,D)=>{const E=H.Na(9);E.sharedInfo=I;return m.g(H,"InsertAgaveTaskpane",E,R,S,G,D,0)},v=(H,I,R,S,G,D,E=null)=>{E=H.Na(9,E);E.sharedInfo=I;return m.g(H,"ShowAgaveTaskpane",E,R,S,G,D,0)};var r=a(374),A=a(192),x=a(37),n=a(1),u=a(282),z=a(150);class w extends z.a{constructor(H){super();this.pe=this.mDa="AddInCommandsDialog";this.Ob=5;this.dialogWidth=
695;this.dialogHeight=438;this.o9g="100%";this.l9g="408px";this.m9g="15px";this.n9g="0";this.TAg=H}get containerDiv(){return this.Kh}Hw(){super.Hw();this.Kh.style.width=this.o9g;this.Kh.style.height=this.l9g;this.Kh.style.marginTop=this.m9g;this.Kh.style.padding=this.n9g}zD(){super.zD();this.lb.style.width=String.format("{0}px",this.dialogWidth);this.lb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.TAg()}}Object(t.a)(w,"AddInCommandsDialog",z.a,[]);var C=a(55),
y=a(71);z=a(100);a.d(F,"a",function(){return B});class B extends e{constructor(H,I,R,S=null,G=null){super();this.$=H;this.Md=I;this.ownerAddinInfo=R;this.Sd=G;this.Rcb=S||C.Task.Ra(!0)}g9g(){const H=this.Rcb;this.Rcb=C.Task.Ra(!0);return H}disposeHost(H){this.Md.zQa(H)}setOwnerAddinEToken(H){this.ownerAddinInfo.eToken=H}showTaskpane(H,I,R){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let S=null,G=!1,D=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,
!0)).TJe(H.solutionId.substr(this.ownerAddinInfo.solutionId.length));S=I.getSharedRuntimeForTaskpane("Workbook",D);G=!!S&&1===S.LifeTime;this.Md.JBe(G?this.ownerAddinInfo.solutionId:H.solutionId,G?S:null,null)||(this.psf(G,!0),this.Rcb=this.lod(H,S,(E,M)=>{E?(G&&(E.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,E.SharedRuntime=S),E.WebExtensionOsfControlType=3,this.Md.cIa(E),R(E.InstanceId,M),this.psf(G,!1),n.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),R(null,M))}))}getSettings(H,I){let R=this.Md.yaa(H.solutionId);R?I(this.Md.cZ(R).OsfPropertyBag):this.Rcb=this.lod(H,null,S=>{S?I(S.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(H,I,R){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const S=this.$.oa.xa,G=E=>{const M=E.Result,L=M?M.AgaveData:
null;L?(this.Md.OIe(L,()=>{const N=new w(()=>{this.disposeHost(L.InstanceId)});N.initializeAndShow("",null,null);return N.containerDiv}),R(L.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),R(null,E.Errors?E.Errors[0].ErrorCause:5001))},D=B.ita(H,this.ownerAddinInfo);this.Rcb=r.a(this.$.userOperationManager,(E,M,L)=>l(S,D,u.b(E,G),M,L,null),E=>new A.a(500,0,E,64),this.Sd)}createUILessSandbox(H,I,R){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");
const S=I.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),G=!!S&&1===S.LifeTime;(I=this.Md.tHh(G?this.ownerAddinInfo.solutionId:H.solutionId,G?S:null))?R(I,0):this.Rcb=this.lod(H,S,(D,E)=>{D?(G?(D.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,D.SharedRuntime=S,D.TaskpaneVisible=!1,D.WebExtensionOsfControlType=3,this.Md.cIa(D)):(D.WebExtensionOsfControlType=4,this.Md.OIe(D,()=>{B.Vfb.ia(D.InstanceId,new d.a);return B.Vfb.ma(D.InstanceId).V$})),R(D.InstanceId,E)):(b.ULS.sendTraceTag(537170636,
220,10,"UILess: instance id is null."),R(null,E))})}lod(H,I,R){let S=null;const G=this.$.oa.xa,D=Y=>{const U=Y.Result;(S=U?U.AgaveData:null)||R(null,Y.Errors?Y.Errors[0].ErrorCause:5001)},E=B.ita(H,this.ownerAddinInfo);I&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),E.SharedRuntimeId=I.Resid);let M=500;var L=(Y,U,P)=>l(G,E,u.b(Y,D),U,P,null);let N=0;void 0===E.IsToBePersisted||null===E.IsToBePersisted||E.IsToBePersisted||(M=538,L=(Y,U,P)=>{b.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return v(G,E,u.b(Y,D),U,P,null)},N=16);N|=64;L=r.a(this.$.userOperationManager,L,Y=>new A.a(M,0,Y,N),this.Sd);return x.TaskExtensions.ts(L,()=>S?this.gwd(G,S.InstanceId,(Y,U)=>{if(Y){I||(S.PrimaryMarketplace.MarketplaceType=H.storeType);
H.assetId?H.assetId.toLowerCase().startsWith("wa")?S.AssetMarketplace={SolutionId:H.assetId,SolutionVersion:H.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:H.assetStoreId}:(S.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):S.AssetMarketplace=null;S.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;S.OwnerAddinStoreType=this.ownerAddinInfo.storeType;S.OsfPropertyBag=[];for(U=0;U<Y.Settings.length;U++){const P=[];P[0]=
Y.Settings[U].Name;P[1]=Y.Settings[U].Value;S.OsfPropertyBag[U]=P}R(S,0)}else R(null,U.Errors?U.Errors[0].ErrorCause:5001)}):C.Task.Ra(!1),c.a.none,3,y.a.current)}gwd(H,I,R){const S=G=>{R(G.Result,G)};return r.a(this.$.userOperationManager,(G,D,E)=>{G=u.b(G,S);const M=H.Na(1);M.controlId=I;return m.g(H,"DdaLoadSettings",M,G,D,E,null,0)},G=>new A.a(501,0,G,80),this.Sd)}psf(H,I){var R;H&&(null===(R=window.performance)||void 0===R?0:R.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${I}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(H){B.Vfb.hb(H)&&
B.Vfb.ma(H).initializeAndShowWithTitle()}static hideUILessDialog(H){B.Vfb.hb(H)&&B.Vfb.ma(H).hide()}static ita(H,I){const R={};R.SolutionId=H.solutionId;R.Version=H.version;R.StoreType=I.storeType;R.StoreId=H.storeId;R.AssetId=H.solutionId;R.AssetStoreId="omex";R.TargetType=1;R.Width=350;R.OwnerAddinSolutionId=I.solutionId;R.OwnerAddinStoreType=I.storeType;R.SharedRuntimeId=null;R.Preload=!1;return R}}B.Vfb=new z.a;Object(t.a)(B,"WACExcelAddinCommandsHost",e,[])},1264:function(t,F,a){var c=a(9);t=
a(0);var b=a(709),e=a(15),f=a(104),d=a(4),h=a(1326),m=a(1),l=a(188),v=a(55);class r{constructor(z,w,C){this.dtb=null;this.$=z;w?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.dtb=new h.a(z,w,C)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Hc(){return!1}executeCommand(z,w,C){z=!1;switch(w.command){case 73979048:this.dtb&&
this.dtb.N7i(w,f.a.instance,d.AFrameworkApplication.fa,C),z=!0}return z?v.Task.Ra(!0):l.a(w.command)}wc(z,w){return 73979048===w.command&&m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Mc(){return!1}dispose(){this.dtb&&this.dtb.dispose()}}Object(t.a)(r,"DataFromPictureCommandHandler",null,[221,2]);var A=a(37),x=a(50);class n extends b.a{constructor(z){super(z)}hd(){const z=x.GetServiceTaskFactory.Oa(this.$.da,328,327,1),w=x.GetServiceTaskFactory.Oa(this.$.da,
484,485,1);A.TaskExtensions.za(A.TaskExtensions.Fd([z,w],this.$.la),()=>{this.$c([new r(this.$,z.result,w.result)])},this.$.la,3)}static ka(z){b.a.Ld(452,new n(z))}}Object(t.a)(n,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return u});const u=()=>{c.a.Fa(z=>{n.ka(z)})}},1324:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static VOh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(t.a)(c,"WopiAuthContext",null,[562])},1325:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.mKf="OneDriveWOPI";Object(t.a)(c,"HostApplicationType",null,[])},1326:function(t,F,a){(function(c){a.d(F,"a",function(){return B});var b=a(0),e=a(15),f=a(174),d=a(84),
h=a(1332),m=a(38),l=a(253),v=a(41),r=a(374),A=a(192),x=a(60),n=a(94),u=a(13),z=a(21),w=a(39),C=a(1333),y=a(1);class B extends m.a{constructor(H,I,R){super();this.eei=h.a.getTypeName();this.jzb=this.MT=this.Sd=null;this.imageHeight=this.imageWidth=0;this.NLa=this.errorMessage=this.tableData=null;this.Bmd=0;this.uVc=!1;this.ZJe=S=>{if(S){var G={};if(({ht:G}=w.d(this.Djh(S.data))).returnValue&&(S=Object(d.a)(Object,G),"."===S.DataFromPictureWildcard))if(S.SessionId!==this.NLa)e.ULS.sendTraceTag(523805139,
0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),S.CmdType){case "ACK":this.uVc=!0;this.Jdg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.$uj();0<this.errorMessage.length?
this.D2f():0<this.tableData.length&&this.V2f();break;case "insert_html":const E=this.$.oa.xa;G={};var D=z.h(this.$).ha.qa.ld.clone();G.PasteId=f.a.create().toString();G.DestinationRanges=v.s(v.v(D,this.$));D=S.Parameters.split("|",3);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${D[0]}|${D[1]}|${D[2]}.`);D=S.Parameters.indexOf("|");D=S.Parameters.indexOf("|",
D+1);D=S.Parameters.indexOf("|",D+1);G.SourceHtml=S.Parameters.substring(D+1);G.CopyOperationId=null;const M=E.Na(1,E.Wb());M.pasteHtmlParameters=G;r.a(this.$.userOperationManager,(L,N,Y)=>x.g(E,"pasteHtmlContent",M,L,N,Y,null,64),L=>new A.a(204,0,L,1),null);this.Bmd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Bmd.toString()}`)}}};this.dei=(S,G)=>{if(S=G.RL)if(!G.parentPath||1>=G.parentPath.length||
G.parentPath[1]!==this.NLa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=S.errorCode;switch(G){case null:case -1:this.errorMessage=u.a.instance.ga(2270);break;case 1:this.errorMessage=u.a.instance.ga(2271);break;case 2:this.errorMessage=u.a.instance.ga(2272)}0<this.errorMessage.length&&
e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${G?G.toString():"null"}.`);this.ote.stop();this.tableData=S.html;this.uVc&&(0<this.errorMessage.length?this.D2f():0<this.tableData.length&&this.V2f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=H;this.augmentationLoopManager=I;this.uploaderCreator=R;this.initialize()}dispose(){window.removeEventListener("message",
this.ZJe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}n_i(H,I){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let R=new Image;R.onload=()=>{var S=document.createElement("canvas");S.width=R.width;S.height=R.height;const G=S.getContext("2d");try{G.drawImage(R,0,0,R.width,R.height)}catch(M){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${M.message}`);
return}let D;try{D=S.toDataURL("image/jpeg")}catch(M){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${M.message}`);return}S=D.split(",");if(2>S.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{S=S[1];try{var E=window.self.atob(S)}catch(M){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${M.message}`);
return}28E5<E.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),I.iIj()):(this.irj(this.Sd,this.MT,S,R.width,R.height),URL.revokeObjectURL(R.src),R=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};R.src=H}N7i(H,I,R,S){this.Sd=H;this.MT=S;this.uploaderCreator.Qgi(this.$,I,R,S,this)}irj(H,I,R,S,G){this.NLa=f.a.create().toString();this.Bmd=0;this.jzb=R;this.imageWidth=S;this.imageHeight=
G;this.errorMessage=this.tableData="";this.uVc=!1;this.Jdg=this.$.Jb.zg("LoadResource","DataFromPictureTaskpaneLaunch");this.Jdg.start();this.W1i(H,I);this.ote=this.$.Jb.zg("LoadResource","DataFromPictureAnnotation");this.ote.start();this.m2j()}m2j(){if(this.jzb.length){var H=window.self.atob(this.jzb);var I=new Uint8Array(H.length);for(let R=0;R<H.length;R++)I[R]=H.charCodeAt(R);this.augmentationLoopManager.l2j(I,this.NLa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}W1i(H,
I){I.SessionID=this.NLa;I.DataFromPictureAssetId="FA000000050";I.LoadDataFromPictureTaskpane=!0;H=new n.a(-859308420,H.method,H.mode,H.We,H.tabName);this.$.Ia.Hb(H,I)}T9c(H){try{const I=c.from(H,"utf16le").toString("base64");return C.a.VHa(this.NLa,I)}catch(I){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Djh(H){try{const I=C.a.VHa(this.NLa,H);return c.from(I,"base64").toString("utf16le")}catch(I){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}$uj(){if(this.jzb.length){var H=l.a(this.$).yaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.imageData=this.T9c(this.jzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,R=>{R&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}V2f(){if(this.tableData.length){var H=
l.a(this.$).yaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.tableHtml=this.T9c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,R=>{R&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}D2f(){if(this.errorMessage.length){var H=
l.a(this.$).yaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.errorMessage=this.T9c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,R=>{R&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.ZJe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.V3a().Bdb("DataFromPicture").ydb(()=>{}).activateAnnotation({annotationType:this.eei,gz:!1,uV:this.dei}).build())}}Object(b.a)(B,"DataFromPictureManager",m.a,[438])}).call(this,a(1327).wog)},1327:function(t,F,a){(function(c){function b(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,C8j:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(D){return!1}}
function e(G,D){if((f.FO?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");f.FO?(G=new Uint8Array(D),G.__proto__=f.prototype):(null===G&&(G=new f(D)),G.length=D);return G}function f(G,D,E){if(!(f.FO||this instanceof f))return new f(G,D,E);if("number"===typeof G){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return m(this,G)}return d(this,G,D,E)}function d(G,D,E,M){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>E||D.byteLength<E)throw new RangeError("'offset' is out of bounds");if(D.byteLength<E+(M||0))throw new RangeError("'length' is out of bounds");D=void 0===E&&void 0===M?new Uint8Array(D):void 0===M?new Uint8Array(D,E):new Uint8Array(D,E,M);f.FO?(G=D,G.__proto__=f.prototype):G=l(G,D);D=G}else if("string"===typeof D){M=G;G=E;if("string"!==typeof G||""===G)G="utf8";if(!f.aif(G))throw new TypeError('"encoding" must be a valid string encoding');
E=A(D,G)|0;M=e(M,E);D=M.write(D,G);D!==E&&(M=M.slice(0,D));D=M}else D=v(G,D);return D}function h(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');if(0>G)throw new RangeError('"size" argument must not be negative');}function m(G,D){h(D);G=e(G,0>D?0:r(D)|0);if(!f.FO)for(var E=0;E<D;++E)G[E]=0;return G}function l(G,D){var E=0>D.length?0:r(D.length)|0;G=e(G,E);for(var M=0;M<E;M+=1)G[M]=D[M]&255;return G}function v(G,D){if(f.isBuffer(D)){var E=r(D.length)|0;G=e(G,E);if(0===
G.length)return G;D.copy(G,0,0,E);return G}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(E="number"!==typeof D.length)||(E=D.length,E=E!==E),E?e(G,0):l(G,D);if("Buffer"===D.type&&I(D.data))return l(G,D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function r(G){if(G>=(f.FO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.FO?2147483647:
1073741823).toString(16)+" bytes");return G|0}function A(G,D){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||G instanceof ArrayBuffer))return G.byteLength;"string"!==typeof G&&(G=""+G);var E=G.length;if(0===E)return 0;for(var M=!1;;)switch(D){case "ascii":case "latin1":case "binary":return E;case "utf8":case "utf-8":case void 0:return w(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
E;case "hex":return E>>>1;case "base64":return y(G).length;default:if(M)return w(G).length;D=(""+D).toLowerCase();M=!0}}function x(G,D,E){var M=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";if(void 0===E||E>this.length)E=this.length;if(0>=E)return"";E>>>=0;D>>>=0;if(E<=D)return"";for(G||(G="utf8");;)switch(G){case "hex":G=D;D=E;E=this.length;if(!G||0>G)G=0;if(!D||0>D||D>E)D=E;M="";for(E=G;E<D;++E)G=M,M=this[E],M=16>M?"0"+M.toString(16):M.toString(16),M=G+M;return M;case "utf8":case "utf-8":return z(this,
D,E);case "ascii":G="";for(E=Math.min(this.length,E);D<E;++D)G+=String.fromCharCode(this[D]&127);return G;case "latin1":case "binary":G="";for(E=Math.min(this.length,E);D<E;++D)G+=String.fromCharCode(this[D]);return G;case "base64":return 0===D&&E===this.length?H.MZe(this):H.MZe(this.slice(D,E));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,E);E="";for(G=0;G<D.length;G+=2)E+=String.fromCharCode(D[G]+256*D[G+1]);return E;default:if(M)throw new TypeError("Unknown encoding: "+
G);G=(G+"").toLowerCase();M=!0}}function n(G,D,E,M,L){if(0===G.length)return-1;"string"===typeof E?(M=E,E=0):2147483647<E?E=2147483647:-2147483648>E&&(E=-2147483648);E=+E;isNaN(E)&&(E=L?0:G.length-1);0>E&&(E=G.length+E);if(E>=G.length){if(L)return-1;E=G.length-1}else if(0>E)if(L)E=0;else return-1;"string"===typeof D&&(D=f.from(D,M));if(f.isBuffer(D))return 0===D.length?-1:u(G,D,E,M,L);if("number"===typeof D)return D&=255,f.FO&&"function"===typeof Uint8Array.prototype.indexOf?L?Uint8Array.prototype.indexOf.call(G,
D,E):Uint8Array.prototype.lastIndexOf.call(G,D,E):u(G,[D],E,M,L);throw new TypeError("val must be string, number or Buffer");}function u(G,D,E,M,L){function N(aa,X){return 1===Y?aa[X]:aa.Zcj(X*Y)}var Y=1,U=G.length,P=D.length;if(void 0!==M&&(M=String(M).toLowerCase(),"ucs2"===M||"ucs-2"===M||"utf16le"===M||"utf-16le"===M)){if(2>G.length||2>D.length)return-1;Y=2;U/=2;P/=2;E/=2}if(L)for(M=-1;E<U;E++)if(N(G,E)===N(D,-1===M?0:E-M)){if(-1===M&&(M=E),E-M+1===P)return M*Y}else-1!==M&&(E-=E-M),M=-1;else for(E+
P>U&&(E=U-P);0<=E;E--){U=!0;for(M=0;M<P;M++)if(N(G,E+M)!==N(D,M)){U=!1;break}if(U)return E}return-1}function z(G,D,E){E=Math.min(G.length,E);for(var M=[];D<E;){var L=G[D],N=null,Y=239<L?4:223<L?3:191<L?2:1;if(D+Y<=E)switch(Y){case 1:128>L&&(N=L);break;case 2:var U=G[D+1];128===(U&192)&&(L=(L&31)<<6|U&63,127<L&&(N=L));break;case 3:U=G[D+1];var P=G[D+2];128===(U&192)&&128===(P&192)&&(L=(L&15)<<12|(U&63)<<6|P&63,2047<L&&(55296>L||57343<L)&&(N=L));break;case 4:U=G[D+1];P=G[D+2];var aa=G[D+3];128===(U&
192)&&128===(P&192)&&128===(aa&192)&&(L=(L&15)<<18|(U&63)<<12|(P&63)<<6|aa&63,65535<L&&1114112>L&&(N=L))}null===N?(N=65533,Y=1):65535<N&&(N-=65536,M.push(N>>>10&1023|55296),N=56320|N&1023);M.push(N);D+=Y}G=M.length;if(G<=R)M=String.fromCharCode.apply(String,M);else{E="";for(D=0;D<G;)E+=String.fromCharCode.apply(String,M.slice(D,D+=R));M=E}return M}function w(G,D){D=D||Infinity;for(var E,M=G.length,L=null,N=[],Y=0;Y<M;++Y){E=G.charCodeAt(Y);if(55295<E&&57344>E){if(!L){if(56319<E){-1<(D-=3)&&N.push(239,
191,189);continue}else if(Y+1===M){-1<(D-=3)&&N.push(239,191,189);continue}L=E;continue}if(56320>E){-1<(D-=3)&&N.push(239,191,189);L=E;continue}E=(L-55296<<10|E-56320)+65536}else L&&-1<(D-=3)&&N.push(239,191,189);L=null;if(128>E){if(0>--D)break;N.push(E)}else if(2048>E){if(0>(D-=2))break;N.push(E>>6|192,E&63|128)}else if(65536>E){if(0>(D-=3))break;N.push(E>>12|224,E>>6&63|128,E&63|128)}else if(1114112>E){if(0>(D-=4))break;N.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw Error("Invalid code point");
}return N}function C(G){for(var D=[],E=0;E<G.length;++E)D.push(G.charCodeAt(E)&255);return D}function y(G){var D=H,E=D.JSj;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(S,"");if(2>G.length)G="";else for(;0!==G.length%4;)G+="=";return E.call(D,G)}function B(G,D,E,M){for(var L=0;L<M&&!(L+E>=D.length||L>=G.length);++L)D[L+E]=G[L];return L}var H=a(1329);a(1330);var I=a(1331);F.wog=f;F.U7j=function(G){+G!=G&&(G=0);return f.Ise(+G)};F.B7j=50;f.FO=void 0!==c.FO?c.FO:b();F.M8j=f.FO?2147483647:1073741823;
f.from=function(G,D,E){return d(null,G,D,E)};f.FO&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.Ise=function(G){h(G);return e(null,G)};f.CQg=function(G){return m(null,G)};f.isBuffer=function(G){return!(null==G||!G.Cyg)};f.compare=function(G,D){if(!f.isBuffer(G)||!f.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(G===D)return 0;
for(var E=G.length,M=D.length,L=0,N=Math.min(E,M);L<N;++L)if(G[L]!==D[L]){E=G[L];M=D[L];break}return E<M?-1:M<E?1:0};f.aif=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(G,D){if(!I(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.Ise(0);var E;if(void 0===D)for(E=D=
0;E<G.length;++E)D+=G[E].length;D=f.CQg(D);var M=0;for(E=0;E<G.length;++E){var L=G[E];if(!f.isBuffer(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(D,M);M+=L.length}return D};f.byteLength=A;f.prototype.Cyg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?z(this,0,G):x.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,
G)};f.prototype.compare=function(G,D,E,M,L){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===E&&(E=G?G.length:0);void 0===M&&(M=0);void 0===L&&(L=this.length);if(0>D||E>G.length||0>M||L>this.length)throw new RangeError("out of range index");if(M>=L&&D>=E)return 0;if(M>=L)return-1;if(D>=E)return 1;D>>>=0;E>>>=0;M>>>=0;L>>>=0;if(this===G)return 0;var N=L-M,Y=E-D,U=Math.min(N,Y);M=this.slice(M,L);G=G.slice(D,E);for(D=0;D<U;++D)if(M[D]!==G[D]){N=M[D];Y=G[D];
break}return N<Y?-1:Y<N?1:0};f.prototype.includes=function(G,D,E){return-1!==this.indexOf(G,D,E)};f.prototype.indexOf=function(G,D,E){return n(this,G,D,E,!0)};f.prototype.lastIndexOf=function(G,D,E){return n(this,G,D,E,!1)};f.prototype.write=function(G,D,E,M){if(void 0===D)M="utf8",E=this.length,D=0;else if(void 0===E&&"string"===typeof D)M=D,E=this.length,D=0;else if(isFinite(D))D|=0,isFinite(E)?(E|=0,void 0===M&&(M="utf8")):(M=E,E=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var L=this.length-D;if(void 0===E||E>L)E=L;if(0<G.length&&(0>E||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");for(L=!1;;)switch(M){case "hex":D=Number(D)||0;M=this.length-D;E?(E=Number(E),E>M&&(E=M)):E=M;M=G.length;if(0!==M%2)throw new TypeError("Invalid hex string");E>M/2&&(E=M/2);for(M=0;M<E;++M){L=parseInt(G.substr(2*M,2),16);if(isNaN(L))break;this[D+M]=L}return M;case "utf8":case "utf-8":return B(w(G,this.length-D),this,D,E);case "ascii":return B(C(G),
this,D,E);case "latin1":case "binary":return B(C(G),this,D,E);case "base64":return B(y(G),this,D,E);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":M=G;L=this.length-D;for(var N=[],Y=0;Y<M.length&&!(0>(L-=2));++Y){var U=M.charCodeAt(Y);G=U>>8;U%=256;N.push(U);N.push(G)}return B(N,this,D,E);default:if(L)throw new TypeError("Unknown encoding: "+M);M=(""+M).toLowerCase();L=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.Z7j||this,0)}};var R=4096;f.prototype.slice=
function(G,D){var E=this.length;G=~~G;D=void 0===D?E:~~D;0>G?(G+=E,0>G&&(G=0)):G>E&&(G=E);0>D?(D+=E,0>D&&(D=0)):D>E&&(D=E);D<G&&(D=G);if(f.FO)D=this.subarray(G,D),D.__proto__=f.prototype;else{E=D-G;D=new f(E,void 0);for(var M=0;M<E;++M)D[M]=this[M+G]}return D};f.prototype.Zcj=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,D,E,M){E||(E=0);
M||0===M||(M=this.length);D>=G.length&&(D=G.length);D||(D=0);0<M&&M<E&&(M=E);if(M===E||0===G.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>E||E>=this.length)throw new RangeError("sourceStart out of bounds");if(0>M)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length);G.length-D<M-E&&(M=G.length-D+E);var L=M-E;if(this===G&&E<D&&D<M)for(M=L-1;0<=M;--M)G[M+D]=this[M+E];else if(1E3>L||!f.FO)for(M=0;M<L;++M)G[M+D]=this[M+E];else Uint8Array.prototype.set.call(G,
this.subarray(E,E+L),D);return L};f.prototype.fill=function(G,D,E,M){if("string"===typeof G){"string"===typeof D?(M=D,D=0,E=this.length):"string"===typeof E&&(M=E,E=this.length);if(1===G.length){var L=G.charCodeAt(0);256>L&&(G=L)}if(void 0!==M&&"string"!==typeof M)throw new TypeError("encoding must be a string");if("string"===typeof M&&!f.aif(M))throw new TypeError("Unknown encoding: "+M);}else"number"===typeof G&&(G&=255);if(0>D||this.length<D||this.length<E)throw new RangeError("Out of range index");
if(E<=D)return this;D>>>=0;E=void 0===E?this.length:E>>>0;G||(G=0);if("number"===typeof G)for(M=D;M<E;++M)this[M]=G;else for(G=f.isBuffer(G)?G:w((new f(G,M)).toString()),L=G.length,M=0;M<E-D;++M)this[M+D]=G[M%L];return this};var S=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1328))},1328:function(t){var F=function(){return this}();try{F=F||(new Function("return this"))()}catch(a){"object"===typeof window&&(F=window)}t.exports=F},1329:function(t,F){function a(f){var d=f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");
f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}F.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};F.JSj=function(f){var d=a(f);var h=d[0];d=d[1];var m=new e(3*(h+d)/4-d),l=0,v=0<d?h-4:h,r;for(r=0;r<v;r+=4)h=b[f.charCodeAt(r)]<<18|b[f.charCodeAt(r+1)]<<12|b[f.charCodeAt(r+2)]<<6|b[f.charCodeAt(r+3)],m[l++]=h>>16&255,m[l++]=h>>8&255,m[l++]=h&255;2===d&&(h=b[f.charCodeAt(r)]<<2|b[f.charCodeAt(r+1)]>>4,m[l++]=h&255);1===d&&(h=b[f.charCodeAt(r)]<<10|b[f.charCodeAt(r+1)]<<4|b[f.charCodeAt(r+
2)]>>2,m[l++]=h>>8&255,m[l++]=h&255);return m};F.MZe=function(f){for(var d=f.length,h=d%3,m=[],l=0,v=d-h;l<v;l+=16383){for(var r=m,A=r.push,x,n=f,u=l+16383>v?v:l+16383,z=[],w=l;w<u;w+=3)x=(n[w]<<16&16711680)+(n[w+1]<<8&65280)+(n[w+2]&255),z.push(c[x>>18&63]+c[x>>12&63]+c[x>>6&63]+c[x&63]);x=z.join("");A.call(r,x)}1===h?(f=f[d-1],m.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],m.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return m.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?
Uint8Array:Array;for(t=0;64>t;++t)c[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;b[45]=62;b[95]=63},1330:function(t,F){F.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,m=h>>1,l=-7;f=b?f-1:0;var v=b?-1:1,r=a[c+f];f+=v;b=r&(1<<-l)-1;r>>=-l;for(l+=d;0<l;b=256*b+a[c+f],f+=v,l-=8);d=b&(1<<-l)-1;b>>=-l;for(l+=e;0<l;d=256*d+a[c+f],f+=v,l-=8);if(0===b)b=1-m;else{if(b===h)return d?NaN:Infinity*
(r?-1:1);d+=Math.pow(2,e);b-=m}return(r?-1:1)*d*Math.pow(2,b-e)};F.write=function(a,c,b,e,f,d){var h,m=8*d-f-1,l=(1<<m)-1,v=l>>1,r=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var A=e?1:-1,x=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=l):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+v?c+r/h:c+r*Math.pow(2,1-v),2<=c*h&&(e++,h/=2),e+v>=l?(c=0,e=l):1<=e+v?(c=(c*h-1)*Math.pow(2,f),e+=v):(c=c*Math.pow(2,v-1)*Math.pow(2,f),e=0));for(;8<=
f;a[b+d]=c&255,d+=A,c/=256,f-=8);e=e<<f|c;for(m+=f;0<m;a[b+d]=e&255,d+=A,e/=256,m-=8);a[b+d-A]|=128*x}},1331:function(t){var F={}.toString;t.exports=Array.isArray||function(a){return"[object Array]"==F.call(a)}},1332:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);F=a(736);var c=a(713);class b extends F.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Jd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Jd(){return["AugLoop_Core_Annotation"]}}
Object(t.a)(b,"DetectedHtmlTableAnnotation",F.a,[])},1333:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{static VHa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,m=0,l=0;let v,r="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var A=b.charCodeAt(h%b.length);if(256<=A)return"";m=(m+f[h]+A)%256;A=f[h];f[h]=f[m];f[m]=A}for(h=0;256>h;h++)d[h]=f[256-h-1];m=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;m=(m+f[h])%256;A=f[h];f[h]=f[m];f[m]=A;A=e.charCodeAt(b);
if(256<=A)return"";v=A^f[(f[h]+f[m])%256];l=(l+d[h])%256;A=d[h];d[h]=d[l];d[l]=A;r+=String.fromCharCode(v^f[(d[h]+d[l])%256])}return r}}Object(t.a)(c,"RC4A",null,[])},1335:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.Vkb=e;c.AFrameworkApplication.fa.pa("AddInCommandsMissingTabIsEnabled")&&d.zYh();this.ex=f;this.CDg=h}get PEb(){return this.Vkb}get solutionId(){return this.ex}get RTd(){return this.CDg}oKa(e){e=this.PEb+this.solutionId+e;return this.RTd?
(e in b.$_b||(b.$_b[e]="AddinControl"+b.nPg++),b.$_b[e]):e}TJe(e){if(this.RTd){const d=b.$_b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.PEb.length+this.solutionId.length)}}return e}Z7e(e){e=this.PEb+this.solutionId+e;return this.RTd?(e in b.VXc||(b.VXc[e]="AddinTab"+b.yPg++),b.VXc[e]):e}}b.$_b={};b.VXc={};b.yPg=0;b.nPg=0;Object(t.a)(b,"DefaultRibbonNamingProvider",null,[188])},1343:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=
1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(t.b)("AddinCollectionType",c)},1390:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(84),e;(function(x){x[x.none=0]="none";x[x.testEvent=1]="testEvent";x[x.test1Event=2]="test1Event";x[x.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";x[x.worksheetActivatedEvent=11]="worksheetActivatedEvent";x[x.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";x[x.worksheetAddedEvent=13]="worksheetAddedEvent";x[x.worksheetSelectionChangedEvent=
14]="worksheetSelectionChangedEvent";x[x.worksheetDeletedEvent=15]="worksheetDeletedEvent";x[x.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";x[x.worksheetFilteredEvent=17]="worksheetFilteredEvent";x[x.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";x[x.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";x[x.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";x[x.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";x[x.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";
x[x.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";x[x.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";x[x.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";x[x.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";x[x.worksheetMovedEvent=27]="worksheetMovedEvent";x[x.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";x[x.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";x[x.workbookFormulaReferenceStyleChangedEvent=
30]="workbookFormulaReferenceStyleChangedEvent";x[x.chartAddedEvent=50]="chartAddedEvent";x[x.chartActivatedEvent=51]="chartActivatedEvent";x[x.chartDeactivatedEvent=52]="chartDeactivatedEvent";x[x.chartDeletedEvent=53]="chartDeletedEvent";x[x.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";x[x.tableDataChangedEvent=101]="tableDataChangedEvent";x[x.tableAddedEvent=102]="tableAddedEvent";x[x.tableDeletedEvent=103]="tableDeletedEvent";x[x.tableFilteredEvent=104]="tableFilteredEvent";x[x.agaveVisualUpdateEvent=
150]="agaveVisualUpdateEvent";x[x.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";x[x.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";x[x.commentAddedEvent=250]="commentAddedEvent";x[x.commentDeletedEvent=251]="commentDeletedEvent";x[x.commentChangedEvent=252]="commentChangedEvent";x[x.invocationMessage=1E3]="invocationMessage";x[x.cancellationMessage=1001]="cancellationMessage";x[x.metadataMessage=1002]="metadataMessage";x[x.visualSelectionChangedEvent=
2E3]="visualSelectionChangedEvent";x[x.visualChangeEvent=2001]="visualChangeEvent";x[x.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";x[x.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";x[x.shapeActivatedEvent=2101]="shapeActivatedEvent";x[x.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";x[x.shapeAddedEvent=2103]="shapeAddedEvent";x[x.shapeDeletedEvent=2104]="shapeDeletedEvent";x[x.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";
x[x.wacOperationEvent=2201]="wacOperationEvent";x[x.recordingStateChangedEvent=2202]="recordingStateChangedEvent";x[x.workbookActivatedEvent=2203]="workbookActivatedEvent";x[x.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";x[x.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";x[x.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";x[x.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";
x[x.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";x[x.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";x[x.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";x[x.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";x[x.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";x[x.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";x[x.lineageActivityFilterUpdatedEvent=
2801]="lineageActivityFilterUpdatedEvent";x[x.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";x[x.pivotTableAddedEvent=2900]="pivotTableAddedEvent";x[x.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";x[x.namedItemAddedEvent=3E3]="namedItemAddedEvent";x[x.namedItemDeletedEvent=3001]="namedItemDeletedEvent";x[x.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";x[x.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";
x[x.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";x[x.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";x[x.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";x[x.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";x[x.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(t.b)("MessageType",e);var f=
a(776),d=a(253),h=a(748),m=a(59),l=a(37),v=a(158),r=a(1);a.d(F,"DdaEventDispatch",function(){return A});class A{constructor(x){this.xA=null;this.Dfg={};this.Ffg={};this.Gcd={};this.$Ad={};this.Kkd=(n,u)=>{n=this.$.Jb.Gc("Task","DdaEventDispatch.HandleServerEvent");u=u.b3f;for(let y=0;y<u.length;y++)switch(u[y].EventType){case 2:var z=u[y],w={};w.Name=z.Name;w.BindingType=z.BindingType;w.ColCount=z.ColCount;w.RowCount=z.RowCount;this.Nva(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,
w,null);break;case 4:this.Nva(u[y].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=u[y],z.InstanceId){w=Array(z.Entries.length);for(var C=0;C<z.Entries.length;C++)w[C]=A.bdc(z.Entries[C],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?this.a9i(z.InstanceId,w):z.InstanceId&&this.Nva(z.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)}else{this.Gcd={};this.$Ad={};for(w=0;w<z.Entries.length;w++)this.EMe(z.Entries[w],z.IsRemoteOverride);
z=JSON.stringify(this.Gcd);w=JSON.stringify(this.$Ad);C=JSON.stringify(this.Dfg);const B=JSON.stringify(this.Ffg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${z}, Number of Not Fired event: ${w}, Total Number of Fired event: ${C}, Total Number of Not Fired event: ${B}`)}}n.stop()};this.BLb=(n,u)=>{this.Nva(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};this.$=x;this.wxc=this.Kkd}G_b(x){x&&(this.via(),this.xA.push(x))}Huc(x){this.xA&&(Array.remove(this.xA,x),this.xA.length||
(this.$.wantServerEvents=!1,this.$.$kj(this.wxc),this.xA=null))}a9i(x,n){const u=Object(b.a)(h.DdaFacade,d.a(this.$));l.TaskExtensions.za(u.YZh(x),z=>{if(v.b(z)){var w=z.result;z=u.nn(w);if(w)if(z.Jic)this.Nva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n);else if(z.I6b)for(w=0;w<n.length;w++)z.I6b.push(n[w]);else z.I6b=n}else z.Hf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.kh&&c.ULS.sendTraceTag(537170590,
0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}y9i(x,n){const u=Object(b.a)(h.DdaFacade,d.a(this.$)),z=u.UNh(x);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,n,this.BLb):u.Gah(x,n)}EMe(x,n){let u=!1;const z=parseInt(x.Type,10);var w=x.Target;const C=Object(b.a)(h.DdaFacade,d.a(this.$));if((w=C.Ui.c_h(z,w))&&0<Object.keys(w).length){u=!0;for(let B in w)if(w=B,C.Ui.U0b(w)){const H=Array(1);H[0]=A.bdc(x,
n);if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var y=H[0][3];if(void 0!==y&&null!==y&&(y=Object(b.a)(Object,m.a.Wh(y)))&&void 0!==y.triggerControlId&&null!==y.triggerControlId&&void 0!==y.triggerSource&&null!==y.triggerSource){let I=!1;n?(y.triggerSource="Unknown",I=!0):C.moh(y.triggerControlId,w)&&(y.triggerSource="ThisLocalAddin",I=!0);I&&(H[0][3]=m.a.Dc(y))}}this.Nva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}u?(this.Lfc(e[z],this.Gcd),this.Lfc(e[z],
this.Dfg)):(this.Lfc(e[z],this.$Ad),this.Lfc(e[z],this.Ffg))}via(){this.xA||(this.xA=[],this.$.Cre(this.wxc),this.$.wantServerEvents=!0)}Lfc(x,n){x in n||(n[x]=0);n[x]+=1}wM(x,n,u){const z={};z.Target=n;z.Category=65536;z.Type=x;z.Message=u;z.Id=-1;this.EMe(z,!1)}JHh(x,n){const u={Target:"",Category:2,Type:1E3};u.Message=n;u.Id=0;n=Array(1);n[0]=A.bdc(u,!1);this.y9i(x,n)}aac(x,n,u,z){const w={};w.Target=u;w.Category=65536;w.Type=n;w.Message=z;w.Id=-1;n=Array(1);n[0]=A.bdc(w,!1);this.Nva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,n)}IHh(x,n){this.Nva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n)}Nva(x,n,u,z){if(this.xA){var w=Object(b.a)(h.DdaFacade,d.a(this.$));if(!w||n!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&n!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||w.Ui.U0b(x)){x=new f.a(n,x,u,z);for(let C=0,y=this.xA.length;C<y;C++)(n=this.xA[C])&&n(x)}}}static bdc(x,n){const u=Array(6);u[0]=x.Category;u[1]=x.Type;u[2]=x.Target;u[3]=x.Message;u[4]=x.Id;u[5]=n;return u}}Object(t.a)(A,"DdaEventDispatch",
null,[])},1419:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);F=a(150);var c=a(88);class b extends F.a{constructor(){super(void 0,void 0,void 0,!0);this.mDa="AddinCommandsUILessDialog";this.sUc="WACDialogTitleText";this.mX="0";this.gG=380;this.i1=190;this.pe=this.mDa;this.Ob=5;this.Fug=String.format("{0}px",this.gG);this.lX=String.format("{0}px",this.i1);this.xaf=this.pt=!1;this.Hw()}Hw(){super.Hw();this.Kh.style.width=this.Fug;this.Kh.style.height=this.lX;this.Kh.style.padding=this.mX}qy(e){this.zD();
document.getElementById(this.Dh(this.sUc)).innerText=e}zD(){super.zD();this.lb.style.width=String.format("{0}px",this.gG);this.lb.style.height=String.format("{0}px",this.i1);this.lb.removeAttribute(c.a.Cd);this.lb.removeAttribute(c.a.TL)}hide(){this.Wyb()}get V$(){return this.Kh}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(t.a)(b,"AddinCommandsUILessDialog",F.a,[860])},1451:function(t,F,a){a.r(F);var c=a(511),b=a(973),e=a(1210),f=a(9),
d=a(0),h=a(226),m=a(191),l=a(591);class v{constructor(){this.lhb=null}get rVg(){this.lhb||(this.lhb=new m.a,this.lhb.add(12),this.lhb.add(11));return this.lhb}Kli(K){return this.rVg.contains(K.operation)}jXj(K){const Ia=[],Ab=K.payload;for(const bc of Ab.batchedOperations)Ia.push(new l.a(K.operation,bc));return Ia}}Object(d.a)(v,"MacroRecorderBatchedEventList",null,[]);var r=a(15),A=a(59),x=a(123),n=a(648);class u{equals(K,Ia){return K===Ia}getHashCode(K){return K}vja(K){return K}}Object(d.a)(u,"UserOperationNameComparer",
null,[88,89]);class z{static h7h(){z.Nc||(z.Nc=new n.a(new u),z.Nc.add(507),z.Nc.add(10),z.Nc.add(576),z.Nc.add(563),z.Nc.add(564),z.Nc.add(565),z.Nc.add(566),z.Nc.add(567),z.Nc.add(568),z.Nc.add(569),z.Nc.add(570),z.Nc.add(571),z.Nc.add(572),z.Nc.add(573),z.Nc.add(574),z.Nc.add(575),z.Nc.add(501),z.Nc.add(520),z.Nc.add(1),z.Nc.add(1002),z.Nc.add(129),z.Nc.add(198),z.Nc.add(500),z.Nc.add(519),z.Nc.add(538),z.Nc.add(1E3),z.Nc.add(1003),z.Nc.add(144),z.Nc.add(502),z.Nc.add(505),z.Nc.add(179),z.Nc.add(205),
z.Nc.add(134),z.Nc.add(230),z.Nc.add(103),z.Nc.add(110),z.Nc.add(112),z.Nc.add(113),z.Nc.add(124),z.Nc.add(133),z.Nc.add(154),z.Nc.add(162),z.Nc.add(168),z.Nc.add(172),z.Nc.add(201),z.Nc.add(222),z.Nc.add(227),z.Nc.add(513),z.Nc.add(534),z.Nc.add(539),z.Nc.add(545),z.Nc.add(600),z.Nc.add(547),z.Nc.add(555),z.Nc.add(558),z.Nc.add(562),z.Nc.add(585),z.Nc.add(1001),z.Nc.add(1005),z.Nc.add(1008),z.Nc.add(1010),z.Nc.add(1011),z.Nc.add(1012),z.Nc.add(1018),z.Nc.add(1029),z.Nc.add(252),z.Nc.add(253),z.Nc.add(258),
z.Nc.add(101),z.Nc.add(102),z.Nc.add(108),z.Nc.add(257),z.Nc.add(119),z.Nc.add(120),z.Nc.add(123),z.Nc.add(126),z.Nc.add(127),z.Nc.add(130),z.Nc.add(140),z.Nc.add(159),z.Nc.add(160),z.Nc.add(165),z.Nc.add(166),z.Nc.add(167),z.Nc.add(169),z.Nc.add(189),z.Nc.add(223),z.Nc.add(214),z.Nc.add(228),z.Nc.add(233),z.Nc.add(247),z.Nc.add(504),z.Nc.add(511),z.Nc.add(512),z.Nc.add(525),z.Nc.add(533),z.Nc.add(537),z.Nc.add(542),z.Nc.add(544),z.Nc.add(548),z.Nc.add(550),z.Nc.add(551),z.Nc.add(552),z.Nc.add(554),
z.Nc.add(577),z.Nc.add(584),z.Nc.add(586),z.Nc.add(587),z.Nc.add(588),z.Nc.add(592),z.Nc.add(1009),z.Nc.add(1016),z.Nc.add(1017));return z.Nc}}z.Nc=null;Object(d.a)(z,"MacroRecorderUnrecognizedEventList",null,[]);class w{constructor(K,Ia,Ab){this.hvb=null;this.lFi=(bc,vc)=>{this.p8f()&&this.Dcd(vc)};this.uuf=Ia;this.tuf=Ab;this.$=K;this.$.FQ&&this.$.NNg(this.lFi);K.da.Ha(297,this)}init(K){this.$.FQ&&(K?this.hvb=K:r.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Dcd(K){if(this.p8f())try{if(this.tuf.Kli(K)){var Ia=
this.tuf.jXj(K);for(const Ab of Ia)this.gYe(Ab)}else this.gYe(K)}catch(Ab){Ia=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${x.a(K.operation)}, Exception: ${Ab.stack}`;r.ULS.sendTraceTag(537155423,0,10,Ia);try{this.GHh(K)}catch(bc){}}}gYe(K){var Ia=this.uuf.w4e(K,!0);Ia?(this.hvb(Ia.eventId,A.a.Dc(K.payload)),r.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}`)):(Ia=this.uuf.w4e(K,!1))?r.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}, but failed to match filters`):
z.h7h().contains(K.operation)||(this.hvb(0,A.a.Dc(K.operation)),K=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${x.a(K.operation)}`,r.ULS.sendTraceTag(537155420,0,50,K))}GHh(K){this.hvb(222,A.a.Dc(K.operation))}p8f(){return this.$.Qka&&this.hvb&&this.$.vba?!0:!1}}Object(d.a)(w,"MacroRecorderEventHandler",null,[536]);var C=a(1);class y{constructor(){this.uKc=this.vKc=this.sQc=this.PUc=null}get operations(){this.sQc||(this.sQc=new m.a,this.Yb());return this.sQc}get NEc(){this.PUc||
(this.PUc=new m.a,this.Yf());return this.PUc}get PWe(){this.uKc||(this.uKc=new m.a);return this.uKc}get featureGates(){this.vKc||(this.vKc=new m.a,this.kwa());return this.vKc}Yf(){}kwa(){}kd(K){this.NEc.add(K)}Pb(K){this.operations.contains(K)||this.operations.add(K)}Pnb(){this.featureGates.add(585)}Goe(K){this.PWe.add(K)}}Object(d.a)(y,"MacroRecorderEventBase",null,[]);class B extends y{constructor(){super()}get eventId(){return 130}Yb(){this.Pb(100)}}Object(d.a)(B,"AccessibilityCheckRunEvent",y,
[]);class H extends y{constructor(){super()}get eventId(){return 160}Yb(){this.Pb(241)}Yf(){this.kd(K=>K.addToPrintArea)}}Object(d.a)(H,"AddedToPrintAreaEvent",y,[]);class I extends y{constructor(){super()}get eventId(){return 65}Yb(){this.Pb(516)}}Object(d.a)(I,"AutoFilterToggledEvent",y,[]);class R extends y{constructor(){super()}get eventId(){return 118}Yb(){this.Pb(502)}Yf(){this.kd(K=>!(K.Q4a().FirstColumn===K.Q4a().LastColumn&&K.Q4a().FirstRow===K.Q4a().LastRow))}}Object(d.a)(R,"AutoSumEvent",
y,[]);class S extends y{constructor(K,Ia){super();this.jfa=K;this.S3j=Ia}get eventId(){return this.jfa}Yb(){this.Pb(529);this.Pb(594)}Yf(){this.kd(K=>this.S3j.includes(K.Hhd()))}}Object(d.a)(S,"ChartPropertyAppliedEventBase",y,[]);class G extends S{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(G,"ChartAxisChangedEvent",S,[]);class D extends S{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(D,"ChartAxisTitleChangedEvent",
S,[]);class E extends S{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(E,"ChartDataLabelsChangedEvent",S,[]);class M extends S{constructor(){super(76,[-100])}}Object(d.a)(M,"ChartDataSelectedEvent",S,[]);class L extends S{constructor(){super(83,[500,501,502])}}Object(d.a)(L,"ChartDataTableChangedEvent",S,[]);var N=a(552),Y=a(420),U=a(84);class P extends y{constructor(){super()}}Object(d.a)(P,"RichApiRequestExecutedEventBase",y,[]);class aa{constructor(K,Ia,Ab){this.response=
this.request=this.eventId=this.source=null;K&&(this.source=K.source,this.eventId=K.eventId,this.request=Ia,this.response=Ab)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(aa,"MacroRecorderRichApiRequestExecutedPayload",null,[122]);class X extends P{constructor(){super()}get eventId(){return 117}sw(K){X.C6||(X.C6=new n.a(N.a.Ni()),X.C6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),X.C6.add("fa000000014"));return!!K&&X.C6.contains(K.toLowerCase())}Yb(){this.Pb(507);
this.Pb(10);this.Pb(576)}Yf(){this.kd(K=>Object(Y.a)(aa,K)&&(K=Object(U.a)(aa,K),K.isValid&&this.sw(K.source))?(r.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${K.eventId}`),!0):!1)}}X.C6=null;Object(d.a)(X,"ChartFormatRichApiRequestExecutedEvent",P,[]);class Z extends S{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(d.a)(Z,"ChartGridlinesChangedEvent",S,[]);class da extends y{constructor(){super()}get eventId(){return 66}Yb(){this.Pb(528)}}
Object(d.a)(da,"ChartInsertedEvent",y,[]);class qa extends S{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(qa,"ChartLegendChangedEvent",S,[]);class O extends S{constructor(){super(75,[-101])}}Object(d.a)(O,"ChartRowColumnSwitchedEvent",S,[]);class ca extends S{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(ca,"ChartTitleChangedEvent",S,[]);class wa extends S{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,
-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(wa,"ChartTypeChangedEvent",S,[]);class ia extends y{constructor(){super()}get eventId(){return 131}Yb(){this.Pb(521)}}Object(d.a)(ia,"ConnectorFloatingObjectResizedEvent",y,[]);class Ha extends y{constructor(){super()}get eventId(){return 129}Yb(){this.Pb(109)}}Object(d.a)(Ha,"EntitySelectedEvent",y,[]);class Sa extends y{constructor(){super()}get eventId(){return 49}Yb(){this.Pb(149);this.Pb(147)}}Object(d.a)(Sa,"FindCellEvent",
y,[]);class Da extends y{constructor(){super()}get eventId(){return 96}Yb(){this.Pb(122)}}Object(d.a)(Da,"FloatingObjectAltTextAppliedEvent",y,[]);class ea extends y{constructor(){super()}get eventId(){return 93}Yb(){this.Pb(522)}}Object(d.a)(ea,"FloatingObjectDeletedEvent",y,[]);class sa extends y{constructor(){super()}get eventId(){return 94}Yb(){this.Pb(524)}}Object(d.a)(sa,"FloatingObjectMovedAndResizedEvent",y,[]);class Ea extends y{constructor(){super()}get eventId(){return 95}Yb(){this.Pb(523)}}
Object(d.a)(Ea,"FloatingObjectRotatedEvent",y,[]);class ba extends y{constructor(){super()}get eventId(){return 100}Yb(){this.Pb(543)}}Object(d.a)(ba,"GroupDetailsShownOrHiddenEvent",y,[]);class ka extends y{constructor(){super()}get eventId(){return 154}Yb(){this.Pb(125)}}Object(d.a)(ka,"HyperlinksRemovedFromRangeEvent",y,[]);class Ca extends P{constructor(){super()}get eventId(){return 125}sw(K){Ca.C6||(Ca.C6=new n.a(N.a.Ni()),Ca.C6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ca.C6.add("fa000000005"));
return!!K&&Ca.C6.contains(K.toLowerCase())}Yb(){this.Pb(507);this.Pb(10);this.Pb(576)}Yf(){this.kd(K=>Object(Y.a)(aa,K)?(K=Object(U.a)(aa,K),K.isValid&&this.sw(K.source)):!1)}}Ca.C6=null;Object(d.a)(Ca,"IdeasRichApiRequestExecutedEvent",P,[]);class db extends y{constructor(){super()}get eventId(){return 136}Yb(){this.Pb(115)}}Object(d.a)(db,"LinkedEntityConvertedEvent",y,[]);class yb extends y{constructor(){super()}get eventId(){return 148}Yb(){this.Pb(114)}}Object(d.a)(yb,"LinkedEntityDisambiguationPaneToggledEvent",
y,[]);class kb extends y{constructor(){super()}get eventId(){return 127}Yb(){this.Pb(119)}}Object(d.a)(kb,"MovedToEdgeEvent",y,[]);class mb extends y{constructor(){super()}get eventId(){return 135}Yb(){this.Pb(191)}kwa(){this.Pnb()}}Object(d.a)(mb,"NamedSheetViewCreatedEvent",y,[]);class W extends y{constructor(){super()}get eventId(){return 166}Yb(){this.Pb(200)}kwa(){this.Pnb()}}Object(d.a)(W,"NamedSheetViewDeletedEvent",y,[]);class Q extends y{constructor(){super()}get eventId(){return 133}Yb(){this.Pb(192)}kwa(){this.Pnb()}}
Object(d.a)(Q,"NamedSheetViewExitedEvent",y,[]);class va extends y{constructor(){super()}get eventId(){return 162}Yb(){this.Pb(199)}kwa(){this.Pnb()}}Object(d.a)(va,"NamedSheetViewRenamedEvent",y,[]);class na extends y{constructor(){super()}get eventId(){return 167}Yb(){this.Pb(195)}kwa(){this.Pnb()}}Object(d.a)(na,"NamedSheetViewSwitchedEvent",y,[]);class Ba extends y{constructor(){super()}get eventId(){return 99}Yb(){this.Pb(174)}}Object(d.a)(Ba,"OutlineLevelSetEvent",y,[]);class Oa extends y{constructor(){super()}get eventId(){return 156}Yb(){this.Pb(244)}}
Object(d.a)(Oa,"PageBreakInsertedEvent",y,[]);class oa extends y{constructor(){super()}get eventId(){return 157}Yb(){this.Pb(245)}}Object(d.a)(oa,"PageBreakRemovedEvent",y,[]);class Ja extends y{constructor(){super()}get eventId(){return 158}Yb(){this.Pb(246)}}Object(d.a)(Ja,"PageBreaksAllResetEvent",y,[]);class Wb extends y{constructor(){super()}get eventId(){return 112}Yb(){this.Pb(503)}Yf(){this.kd(K=>!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&
!K.isFromCurrentSession)}}Object(d.a)(Wb,"PasteArtOtherWorkbookEvent",y,[]);class nc extends y{constructor(){super()}get eventId(){return 52}Yb(){this.Pb(503)}Yf(){this.kd(K=>!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&K.isFromCurrentSession)}}Object(d.a)(nc,"PasteArtSameWorkbookEvent",y,[]);class Yb extends y{constructor(){super()}get eventId(){return 110}Yb(){this.Pb(204)}}Object(d.a)(Yb,"PasteHtmlEvent",y,[]);class pb extends y{constructor(){super()}get eventId(){return 35}Yb(){this.Pb(506)}}
Object(d.a)(pb,"PasteRangeEvent",y,[]);class Fa extends y{constructor(){super()}get eventId(){return 111}Yb(){this.Pb(503)}Yf(){this.kd(K=>1===K.pasteParameters.CopyPasteTargetType)}}Object(d.a)(Fa,"PasteShadowWorkbookRangeEvent",y,[]);class ab extends y{constructor(){super()}get eventId(){return 42}Yb(){this.Pb(180)}}Object(d.a)(ab,"PasteStringEvent",y,[]);class Gb extends y{constructor(){super()}get eventId(){return 134}Yb(){this.Pb(220)}}Object(d.a)(Gb,"PendingMergeEvent",y,[]);class Ga extends y{constructor(){super()}get eventId(){return 122}Yb(){this.Pb(510)}}
Object(d.a)(Ga,"PictureInsertedEvent",y,[]);class Ma extends y{constructor(){super()}get eventId(){return 153}Yb(){this.Pb(161)}}Object(d.a)(Ma,"PivotDrillToggledEvent",y,[]);class Qa extends y{constructor(K,Ia){super();this.jfa=K;this.opType=Ia}get eventId(){return this.jfa}Yb(){this.Pb(225)}Yf(){this.kd(K=>K.opType===this.opType)}}Object(d.a)(Qa,"PivotTableSettingsChangedEventBase",y,[]);class wb extends Qa{constructor(){super(171,4)}}Object(d.a)(wb,"PivotTableAllItemLabelsRepeatedEvent",Qa,[]);
class Na extends Qa{constructor(){super(184,17)}}Object(d.a)(Na,"PivotTableAltTextDescriptionChangedEvent",Qa,[]);class ya extends Qa{constructor(){super(183,16)}}Object(d.a)(ya,"PivotTableAltTextTitleChangedEvent",Qa,[]);class nb extends Qa{constructor(){super(173,6)}}Object(d.a)(nb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Qa,[]);class vb extends Qa{constructor(){super(172,5)}}Object(d.a)(vb,"PivotTableBlankLineAfterEachItemToggledEvent",Qa,[]);class gb extends Qa{constructor(){super(170,
3)}}Object(d.a)(gb,"PivotTableColumnGrandTotalShownEvent",Qa,[]);class cb extends y{constructor(){super()}get eventId(){return 98}Yb(){this.Pb(132)}}Object(d.a)(cb,"PivotTableCreatedEvent",y,[]);class La extends Qa{constructor(){super(177,10)}}Object(d.a)(La,"PivotTableDisplayErrorStringToggledEvent",Qa,[]);class ja extends Qa{constructor(){super(178,11)}}Object(d.a)(ja,"PivotTableDisplayNullStringToggledEvent",Qa,[]);class Ua extends Qa{constructor(){super(179,12)}}Object(d.a)(Ua,"PivotTableErrorStringChangedEvent",
Qa,[]);class lb extends Qa{constructor(){super(174,7)}}Object(d.a)(lb,"PivotTableExpandCollapseButtonsShownEvent",Qa,[]);class sb extends Qa{constructor(){super(187,20)}}Object(d.a)(sb,"PivotTableIndentChangedEvent",Qa,[]);class V extends Qa{constructor(){super(176,9)}}Object(d.a)(V,"PivotTableItemsWithNoDataOnColumnsShownEvent",Qa,[]);class za extends Qa{constructor(){super(175,8)}}Object(d.a)(za,"PivotTableItemsWithNoDataOnRowsShownEvent",Qa,[]);class Ra extends Qa{constructor(){super(186,19)}}
Object(d.a)(Ra,"PivotTableLayoutTypeSetEvent",Qa,[]);class Xa extends Qa{constructor(){super(180,13)}}Object(d.a)(Xa,"PivotTableNullStringChangedEvent",Qa,[]);class $a extends y{constructor(){super()}get eventId(){return 149}Yb(){this.Pb(219)}}Object(d.a)($a,"PivotTablePivotLocationChangedEvent",y,[]);class ma extends y{constructor(){super()}get eventId(){return 102}Yb(){this.Pb(145)}}Object(d.a)(ma,"PivotTablePivotedEvent",y,[]);class fa extends Qa{constructor(){super(182,15)}}Object(d.a)(fa,"PivotTableRefreshDataOnLoadToggledEvent",
Qa,[]);class eb extends y{constructor(){super()}get eventId(){return 104}Yb(){this.Pb(50)}Yf(){this.kd(K=>!!K.pivotTableId&&!!K.pivotTableName)}}Object(d.a)(eb,"PivotTableRefreshedEvent",y,[]);class ua extends Qa{constructor(){super(168,1)}}Object(d.a)(ua,"PivotTableRenamedEvent",Qa,[]);class xa extends Qa{constructor(){super(169,2)}}Object(d.a)(xa,"PivotTableRowGrandTotalShownEvent",Qa,[]);class tb extends Qa{constructor(){super(181,14)}}Object(d.a)(tb,"PivotTableSaveSourceDataWithFileToggledEvent",
Qa,[]);var Qb=a(612);class pc extends y{constructor(){super()}get eventId(){return 155}Yb(){this.Pb(131)}Yf(){this.kd(K=>{K=Object(U.a)(Qb.a,K);return!!K&&!!K.tKa()&&!!K.hierarchyName})}}Object(d.a)(pc,"PivotTableSortedEvent",y,[]);class hb extends Qa{constructor(){super(185,18)}}Object(d.a)(hb,"PivotTableSubTotalsVisibilitySettingSetEvent",Qa,[]);class ib extends y{constructor(){super()}get eventId(){return 206}Yb(){this.Pb(560)}}Object(d.a)(ib,"PivotValueFieldSettingAppliedEvent",y,[]);class Vb extends y{constructor(){super()}get eventId(){return 161}Yb(){this.Pb(243)}}
Object(d.a)(Vb,"PrintAreaClearedEvent",y,[]);class wc extends y{constructor(){super()}get eventId(){return 159}Yb(){this.Pb(241)}Yf(){this.kd(K=>!K.addToPrintArea)}}Object(d.a)(wc,"PrintAreaSetEvent",y,[]);class Lc extends y{constructor(){super()}get eventId(){return 57}Yb(){this.Pb(517)}}Object(d.a)(Lc,"RangeAutoFilterClearedEvent",y,[]);class Fc extends y{constructor(K,Ia){super();this.jfa=K;this.s1d=Ia}get eventId(){return this.jfa}Yb(){this.Pb(11)}Yf(){this.kd(K=>16===K.iZ().ValidMembers);this.kd(K=>
K.iZ().Font.ValidMembers===this.s1d)}}Object(d.a)(Fc,"RangeFontFormattedEventBase",y,[]);class fd extends Fc{constructor(){super(3,4)}}Object(d.a)(fd,"RangeBoldedEvent",Fc,[]);class Ta extends y{constructor(){super()}get eventId(){return 2}Yb(){this.Pb(11)}Yf(){this.kd(K=>128===K.iZ().ValidMembers)}}Object(d.a)(Ta,"RangeBorderedEvent",y,[]);class Fb{}Fb.W$a="Table";Fb.Kqc="Sheet";Object(d.a)(Fb,"MacroRecorderEventConstants",null,[]);class ic extends y{constructor(){super()}get eventId(){return 113}Yb(){this.Pb(208)}Yf(){this.kd(K=>
K.getParameters().FilterType===Fb.Kqc)}}Object(d.a)(ic,"RangeCheckedItemsFilteredEvent",y,[]);class zb extends y{constructor(){super()}get eventId(){return 109}Yb(){this.Pb(105)}}Object(d.a)(zb,"RangeConditionalFormattingCreatedEvent",y,[]);class Bb extends y{constructor(){super()}get eventId(){return 124}Yb(){this.Pb(221)}}Object(d.a)(Bb,"RangeConditionalFormattingRuleDeletedEvent",y,[]);class ec extends y{constructor(){super()}get eventId(){return 29}Yb(){this.Pb(508)}Yf(){this.kd(K=>3===K.mt()||
1===K.mt()||4===K.mt())}}Object(d.a)(ec,"RangeContentClearedEvent",y,[]);class Qd extends y{constructor(){super()}get eventId(){return 40}Yb(){this.Pb(104)}}Object(d.a)(Qd,"RangeCopiedCutCellsInsertedEvent",y,[]);class fc extends y{constructor(){super()}get eventId(){return 114}Yb(){this.Pb(209)}Yf(){this.kd(K=>K.getParameters().FilterType===Fb.Kqc)}}Object(d.a)(fc,"RangeCustomFilteredEvent",y,[]);class cd extends y{constructor(){super()}get eventId(){return 106}Yb(){this.Pb(121)}}Object(d.a)(cd,
"RangeDataValidationChangedEvent",y,[]);class jd extends Fc{constructor(){super(4,64)}}Object(d.a)(jd,"RangeDoubleUnderlinedEvent",Fc,[]);class nd extends y{constructor(){super()}get eventId(){return 69}Yb(){this.Pb(190)}}Object(d.a)(nd,"RangeDuplicatesRemovedEvent",y,[]);class vd extends y{constructor(){super()}get eventId(){return 1}Yb(){this.Pb(527);this.Pb(12)}}Object(d.a)(vd,"RangeEditedEvent",y,[]);class wd extends y{constructor(){super()}get eventId(){return 164}Yb(){this.Pb(255)}Yf(){this.kd(K=>
4===K.actionType)}}Object(d.a)(wd,"RangeExternalLinksBrokeAllLinksEvent",y,[]);class Td extends y{constructor(){super()}get eventId(){return 119}Yb(){this.Pb(255)}Yf(){this.kd(K=>3===K.actionType)}}Object(d.a)(Td,"RangeExternalLinksBrokeLinkEvent",y,[]);class jc extends y{constructor(){super()}get eventId(){return 205}Yb(){this.Pb(256)}kwa(){this.Goe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(d.a)(jc,"RangeExternalLinksChangeSourceEvent",y,[]);class bd extends y{constructor(){super()}get eventId(){return 163}Yb(){this.Pb(553)}Yf(){this.kd(K=>
1===K.actionType)}}Object(d.a)(bd,"RangeExternalLinksRefreshedAllEvent",y,[]);class Hd extends y{constructor(){super()}get eventId(){return 77}Yb(){this.Pb(553)}Yf(){this.kd(K=>0===K.actionType)}}Object(d.a)(Hd,"RangeExternalLinksRefreshedEvent",y,[]);class ge extends y{constructor(){super()}get eventId(){return 165}Yb(){this.Pb(224)}}Object(d.a)(ge,"RangeExternalLinksSetAutoRefreshEvent",y,[]);class Mb extends y{constructor(){super()}get eventId(){return 5}Yb(){this.Pb(11)}Yf(){this.kd(K=>64===K.iZ().ValidMembers)}}
Object(d.a)(Mb,"RangeFillColoredEvent",y,[]);class Kc extends y{constructor(){super()}get eventId(){return 59}Yb(){this.Pb(155)}}Object(d.a)(Kc,"RangeFilledEvent",y,[]);class Ob extends y{constructor(){super()}get eventId(){return 115}Yb(){this.Pb(176)}Yf(){this.kd(K=>K.EU().AutoFilterType===Fb.Kqc&&!!K.EU().CriteriaType)}}Object(d.a)(Ob,"RangeFilterAppliedEvent",y,[]);class Mc extends y{constructor(){super()}get eventId(){return 58}Yb(){this.Pb(176)}Yf(){this.kd(K=>K.EU().AutoFilterType===Fb.Kqc&&
!K.EU().CriteriaType)}}Object(d.a)(Mc,"RangeFilterClearedEvent",y,[]);class Dc extends y{constructor(){super()}get eventId(){return 41}Yb(){this.Pb(518)}}Object(d.a)(Dc,"RangeFilterReappliedEvent",y,[]);class $c extends y{constructor(){super()}get eventId(){return 86}Yb(){this.Pb(150)}}Object(d.a)($c,"RangeFlashFilledEvent",y,[]);class td extends Fc{constructor(){super(6,32)}}Object(d.a)(td,"RangeFontColoredEvent",Fc,[]);class Yd extends Fc{constructor(){super(7,8)}}Object(d.a)(Yd,"RangeFontItalicizedEvent",
Fc,[]);class ae extends Fc{constructor(){super(8,1)}}Object(d.a)(ae,"RangeFontNamedEvent",Fc,[]);class je extends Fc{constructor(){super(9,2)}}Object(d.a)(je,"RangeFontSizedEvent",Fc,[]);class Ke extends y{constructor(){super()}get eventId(){return 74}Yb(){this.Pb(215)}}Object(d.a)(Ke,"RangeFormattedAsTableEvent",y,[]);class Fd extends y{constructor(){super()}get eventId(){return 97}Yb(){this.Pb(188)}}Object(d.a)(Fd,"RangeGroupedOrUngroupedEvent",y,[]);class fe extends y{constructor(){super()}get eventId(){return 60}Yb(){this.Pb(11)}Yf(){this.kd(K=>
2===K.iZ().ValidMembers)}}Object(d.a)(fe,"RangeHorizontallyAlignedEvent",y,[]);class ne extends y{constructor(){super()}get eventId(){return 43}Yb(){this.Pb(526)}}Object(d.a)(ne,"RangeHyperlinkAppliedEvent",y,[]);class ce extends y{constructor(){super()}get eventId(){return 63}Yb(){this.Pb(11)}Yf(){this.kd(K=>256===K.iZ().ValidMembers)}}Object(d.a)(ce,"RangeIndentChangedEvent",y,[]);class te extends y{constructor(){super()}get eventId(){return 53}Yb(){this.Pb(156)}Yf(){this.kd(K=>2===K.mt()||5===
K.mt()||6===K.mt()||7===K.mt())}}Object(d.a)(te,"RangeMergedEvent",y,[]);class we extends y{constructor(){super()}get eventId(){return 107}Yb(){this.Pb(216)}}Object(d.a)(we,"RangeNamedCellStyleAppliedEvent",y,[]);class Pe extends y{constructor(){super()}get eventId(){return 12}Yb(){this.Pb(11)}Yf(){this.kd(K=>32===K.iZ().ValidMembers)}}Object(d.a)(Pe,"RangeNumberFormattedEvent",y,[]);var qf=a(975);class Ve extends y{constructor(){super()}get eventId(){return 108}Yb(){this.Pb(141)}Yf(){this.kd(K=>
Object(Y.a)(qf.a,K))}}Object(d.a)(Ve,"RangeSortedEvent",y,[]);class Qe extends Fc{constructor(){super(10,128)}}Object(d.a)(Qe,"RangeStrikedThroughEvent",Fc,[]);class Ze extends Fc{constructor(){super(11,16)}}Object(d.a)(Ze,"RangeUnderlinedEvent",Fc,[]);class Re extends y{constructor(){super()}get eventId(){return 61}Yb(){this.Pb(11)}Yf(){this.kd(K=>1===K.iZ().ValidMembers)}}Object(d.a)(Re,"RangeVerticallyAlignedEvent",y,[]);class Za extends y{constructor(){super()}get eventId(){return 62}Yb(){this.Pb(11)}Yf(){this.kd(K=>
8===K.iZ().ValidMembers)}}Object(d.a)(Za,"RangeWrapTextToggledEvent",y,[]);class Xb extends y{constructor(){super()}get eventId(){return 103}Yb(){this.Pb(51)}}Object(d.a)(Xb,"RefreshedAllEvent",y,[]);class jb extends y{constructor(){super()}get eventId(){return 47}Yb(){this.Pb(148)}}Object(d.a)(jb,"ReplaceAllEvent",y,[]);class Sb extends y{constructor(){super()}get eventId(){return 91}Yb(){this.Pb(532)}Yf(){this.kd(K=>95!==K.getShapeType()&&96!==K.getShapeType()&&97!==K.getShapeType()&&98!==K.getShapeType()&&
100!==K.getShapeType()&&102!==K.getShapeType()&&103!==K.getShapeType())}}Object(d.a)(Sb,"ShapeInsertedEvent",y,[]);class lc extends y{constructor(){super()}get eventId(){return 92}Yb(){this.Pb(531)}}Object(d.a)(lc,"ShapeStyleSetEvent",y,[]);var oc=a(830);class Qc extends y{constructor(K,Ia){super();this.jfa=K;this.s1d=Ia}get eventId(){return this.jfa}Yb(){this.Pb(581)}Yf(){this.kd(K=>Object(Y.a)(oc.a,K)&&4===K.getShapeTextFormat().ValidMembers);this.kd(K=>Object(Y.a)(oc.a,K)&&K.getShapeTextFormat().Font.ValidMembers===
this.s1d)}}Object(d.a)(Qc,"ShapeTextFontFormattedEventBase",y,[]);class Kb extends Qc{constructor(){super(193,4)}}Object(d.a)(Kb,"ShapeTextBoldedEvent",Qc,[]);var hc=a(977);class Cc extends y{constructor(){super()}get eventId(){return 191}Yb(){this.Pb(581)}Yf(){this.kd(K=>Object(Y.a)(hc.a,K))}}Object(d.a)(Cc,"ShapeTextChangedEvent",y,[]);class Ka extends Qc{constructor(){super(196,32)}}Object(d.a)(Ka,"ShapeTextFontColorChangedEvent",Qc,[]);class Ib extends Qc{constructor(){super(197,1)}}Object(d.a)(Ib,
"ShapeTextFontNameChangedEvent",Qc,[]);class dc extends Qc{constructor(){super(198,2)}}Object(d.a)(dc,"ShapeTextFontSizeChangedEvent",Qc,[]);class yc extends y{constructor(){super()}get eventId(){return 199}Yb(){this.Pb(581)}Yf(){this.kd(K=>Object(Y.a)(oc.a,K)&&2===K.getShapeTextFormat().ValidMembers)}}Object(d.a)(yc,"ShapeTextHorizontallyAlignedEvent",y,[]);class Eb extends Qc{constructor(){super(194,8)}}Object(d.a)(Eb,"ShapeTextItalicizedEvent",Qc,[]);class Ac extends Qc{constructor(){super(195,
16)}}Object(d.a)(Ac,"ShapeTextUnderlinedEvent",Qc,[]);class ld extends y{constructor(){super()}get eventId(){return 200}Yb(){this.Pb(581)}Yf(){this.kd(K=>Object(Y.a)(oc.a,K)&&1===K.getShapeTextFormat().ValidMembers)}}Object(d.a)(ld,"ShapeTextVerticallyAlignedEvent",y,[]);class Vd extends y{constructor(){super()}get eventId(){return 13}Yb(){this.Pb(138)}}Object(d.a)(Vd,"SheetAddedEvent",y,[]);var Od=a(8);class he extends y{constructor(){super()}get eventId(){return 142}Yb(){this.Pb(237)}Yf(){this.kd(K=>
!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==Od.a.cB)||!K.DeltaColumn&&0>K.DeltaRow&&(!!K.InsertDeleteRange.FirstColumn||K.InsertDeleteRange.LastColumn!==Od.a.$x)})}}Object(d.a)(he,"SheetCellsDeletedEvent",y,[]);class Ye extends y{constructor(){super()}get eventId(){return 143}Yb(){this.Pb(237)}Yf(){this.kd(K=>
!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==Od.a.cB)||!K.DeltaColumn&&0<K.DeltaRow&&(!!K.InsertDeleteRange.FirstColumn||K.InsertDeleteRange.LastColumn!==Od.a.$x)})}}Object(d.a)(Ye,"SheetCellsInsertedEvent",y,[]);class se extends y{constructor(){super()}get eventId(){return 139}Yb(){this.Pb(237)}Yf(){this.kd(K=>
!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Od.a.cB)}}Object(d.a)(se,"SheetColumnDeletedEvent",
y,[]);class bf extends y{constructor(){super()}get eventId(){return 138}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Od.a.cB)}}Object(d.a)(bf,"SheetColumnInsertedEvent",y,[]);class tf extends y{constructor(){super()}get eventId(){return 14}Yb(){this.Pb(137)}}Object(d.a)(tf,"SheetDeletedEvent",y,[]);class Ie extends y{constructor(){super()}get eventId(){return 137}Yb(){this.Pb(185)}}Object(d.a)(Ie,"SheetDirectionChangedEvent",y,[]);class uf extends y{constructor(){super()}get eventId(){return 54}Yb(){this.Pb(139)}}Object(d.a)(uf,"SheetDuplicatedEvent",y,[]);class Ya extends y{constructor(){super()}get eventId(){return 15}Yb(){this.Pb(207)}}
Object(d.a)(Ya,"SheetNameEditedEvent",y,[]);class Nb extends y{constructor(){super()}get eventId(){return 90}Yb(){this.Pb(151)}}Object(d.a)(Nb,"SheetPaneFrozenEvent",y,[]);class rc extends y{constructor(){super()}get eventId(){return 120}Yb(){this.Pb(226)}}Object(d.a)(rc,"SheetPrintSettingsSavedEvent",y,[]);var Oc=a(876);class sd extends y{constructor(){super()}get eventId(){return 215}Yb(){this.Pb(507)}kwa(){this.Goe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Yf(){this.kd(K=>Object.getType(K)===
Oc.a)}}Object(d.a)(sd,"SheetProtectionPausedResumedEvent",y,[]);class zd extends y{constructor(){super()}get eventId(){return 64}Yb(){this.Pb(557)}}Object(d.a)(zd,"SheetReorderedEvent",y,[]);class Pd extends y{constructor(){super()}get eventId(){return 141}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Od.a.$x)}}Object(d.a)(Pd,"SheetRowDeletedEvent",y,[]);class ue extends y{constructor(){super()}get eventId(){return 140}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Od.a.$x)}}Object(d.a)(ue,"SheetRowInsertedEvent",y,[]);class ze extends y{constructor(){super()}get eventId(){return 39}Yb(){this.Pb(135)}}Object(d.a)(ze,"SheetRowsColumnsAutoFitEvent",y,[]);class Ne extends y{constructor(){super()}get eventId(){return 36}Yb(){this.Pb(136)}}
Object(d.a)(Ne,"SheetRowsColumnsResizedEvent",y,[]);class ff extends y{constructor(){super()}get eventId(){return 68}Yb(){this.Pb(183)}}Object(d.a)(ff,"SheetShowGridlinesToggledEvent",y,[]);class Ge extends y{constructor(){super()}get eventId(){return 67}Yb(){this.Pb(184)}}Object(d.a)(Ge,"SheetShowHeadingsToggledEvent",y,[]);class af extends y{constructor(){super()}get eventId(){return 89}Yb(){this.Pb(213)}}Object(d.a)(af,"SheetSpellCheckedEvent",y,[]);class wf extends y{constructor(){super()}get eventId(){return 70}Yb(){this.Pb(515)}}
Object(d.a)(wf,"SheetTabColoredEvent",y,[]);class cf extends y{constructor(){super()}get eventId(){return 71}Yb(){this.Pb(157)}}Object(d.a)(cf,"SheetVisibilityChangedEvent",y,[]);class vf extends y{constructor(){super()}get eventId(){return 126}Yb(){this.Pb(239)}}Object(d.a)(vf,"SheetsVisibilityChangedEvent",y,[]);class ag extends y{constructor(){super()}get eventId(){return 188}Yb(){this.Pb(203)}}Object(d.a)(ag,"SlicerInsertedEvent",y,[]);class tc extends y{constructor(){super()}get eventId(){return 189}Yb(){this.Pb(173)}Yf(){this.kd(K=>
!K.clearFilter)}}Object(d.a)(tc,"SlicerSelectionAppliedEvent",y,[]);class Yc extends y{constructor(){super()}get eventId(){return 190}Yb(){this.Pb(173)}Yf(){this.kd(K=>K.clearFilter)}}Object(d.a)(Yc,"SlicerSelectionClearedEvent",y,[]);class fb extends y{constructor(){super()}get eventId(){return 27}Yb(){this.Pb(208)}Yf(){this.kd(K=>K.getParameters().FilterType===Fb.W$a)}}Object(d.a)(fb,"TableCheckedItemsFilteredEvent",y,[]);class Hb extends y{constructor(){super()}get eventId(){return 144}Yb(){this.Pb(237)}Yf(){this.kd(K=>
!!K.insertDeleteMultiRangeParameters);this.kd(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Hb,"TableColumnDeletedEvent",y,[]);class cc extends y{constructor(){super()}get eventId(){return 145}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);
this.kd(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(cc,"TableColumnInsertedEvent",y,[]);var Hc=a(976);class od extends y{constructor(){super()}get eventId(){return 121}Yb(){this.Pb(141)}Yf(){this.kd(K=>Object(Y.a)(Hc.a,K))}}Object(d.a)(od,"TableColumnSortedEvent",y,[]);class Dd extends y{constructor(){super()}get eventId(){return 105}Yb(){this.Pb(193)}}Object(d.a)(Dd,
"TableConvertedToRangeEvent",y,[]);class be extends y{constructor(){super()}get eventId(){return 16}Yb(){this.Pb(206)}}Object(d.a)(be,"TableCreatedEvent",y,[]);class Jb extends y{constructor(){super()}get eventId(){return 30}Yb(){this.Pb(209)}Yf(){this.kd(K=>K.getParameters().FilterType===Fb.W$a)}}Object(d.a)(Jb,"TableCustomFilteredEvent",y,[]);class sc extends y{constructor(){super()}get eventId(){return 25}Yb(){this.Pb(187)}Yf(){this.kd(K=>1===K.options.OperationType)}}Object(d.a)(sc,"TableCustomSortedEvent",
y,[]);class ed extends y{constructor(){super()}get eventId(){return 28}Yb(){this.Pb(176)}Yf(){this.kd(K=>K.EU().AutoFilterType===Fb.W$a);this.kd(K=>0===K.EU().CriteriaType)}}Object(d.a)(ed,"TableFilterClearedEvent",y,[]);class xd extends y{constructor(){super()}get eventId(){return 32}Yb(){this.Pb(176)}Yf(){this.kd(K=>K.EU().AutoFilterType===Fb.W$a);this.kd(K=>{const Ia=new m.a;Ia.add(1);Ia.add(2);Ia.add(8);Ia.add(9);Ia.add(10);Ia.add(11);Ia.add(12);Ia.add(13);Ia.add(14);Ia.add(15);Ia.add(16);Ia.add(17);
Ia.add(18);Ia.add(19);Ia.add(20);Ia.add(21);Ia.add(22);Ia.add(23);Ia.add(24);Ia.add(25);Ia.add(26);Ia.add(27);Ia.add(28);Ia.add(29);Ia.add(30);Ia.add(31);Ia.add(32);Ia.add(33);Ia.add(34);Ia.add(35);Ia.add(36);Ia.add(37);Ia.add(38);Ia.add(39);return Ia.contains(K.EU().CriteriaType)})}}Object(d.a)(xd,"TableItemFilteredEvent",y,[]);class le extends y{constructor(){super()}get eventId(){return 101}Yb(){this.Pb(217)}}Object(d.a)(le,"TableRenamedEvent",y,[]);class Sd extends y{constructor(){super()}get eventId(){return 73}Yb(){this.Pb(211)}}
Object(d.a)(Sd,"TableResizedEvent",y,[]);class me extends y{constructor(){super()}get eventId(){return 44}Yb(){this.Pb(514)}}Object(d.a)(me,"TableRowColumnRearrangedEvent",y,[]);class Ee extends y{constructor(){super()}get eventId(){return 146}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(Ee,"TableRowDeletedEvent",y,[]);class bb extends y{constructor(){super()}get eventId(){return 147}Yb(){this.Pb(237)}Yf(){this.kd(K=>!!K.insertDeleteMultiRangeParameters);this.kd(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(bb,"TableRowInsertedEvent",y,[]);class Lb extends y{constructor(){super()}get eventId(){return 26}Yb(){this.Pb(177)}Yf(){this.kd(K=>
K.EU().AutoFilterType===Fb.W$a)}}Object(d.a)(Lb,"TableSortedEvent",y,[]);class mc extends y{constructor(){super()}get eventId(){return 87}Yb(){this.Pb(212)}}Object(d.a)(mc,"TableStyleAppliedEvent",y,[]);class Uc extends y{constructor(){super()}get eventId(){return 88}Yb(){this.Pb(196)}}Object(d.a)(Uc,"TableStyleOptionToggledEvent",y,[]);class pd extends y{constructor(){super()}get eventId(){return 31}Yb(){this.Pb(210)}Yf(){this.kd(K=>K.getParameters().FilterType===Fb.W$a)}}Object(d.a)(pd,"TableTop10FilteredEvent",
y,[]);class ta extends y{constructor(){super()}get eventId(){return 207}Yb(){this.Pb(238)}}Object(d.a)(ta,"TextToColumnsEvent",y,[]);class rb extends y{constructor(){super()}get eventId(){return 128}Yb(){this.Pb(559)}}Object(d.a)(rb,"ValuesSortedEvent",y,[]);class gc extends y{constructor(){super()}get eventId(){return 55}Yb(){this.Pb(197)}}Object(d.a)(gc,"WorkbookCalculationModeSetEvent",y,[]);class Pc extends y{constructor(){super()}get eventId(){return 34}Yb(){this.Pb(181)}Yf(){this.kd(K=>!!K.parentCommentId)}}
Object(d.a)(Pc,"WorkbookCommentRepliedEvent",y,[]);class hd extends y{constructor(){super()}get eventId(){return 33}Yb(){this.Pb(181)}Yf(){this.kd(K=>!K.parentCommentId)}}Object(d.a)(hd,"WorkbookCommentedEvent",y,[]);class Cd extends y{constructor(){super()}get eventId(){return 56}Yb(){this.Pb(128)}}Object(d.a)(Cd,"WorkbookRecalculatedEvent",y,[]);class Zd extends y{constructor(){super()}get eventId(){return 46}Yb(){this.Pb(171)}}Object(d.a)(Zd,"WorkbookRedoEvent",y,[]);class Wd extends y{constructor(){super()}get eventId(){return 45}Yb(){this.Pb(170)}}
Object(d.a)(Wd,"WorkbookUndoEvent",y,[]);class Se extends y{constructor(){super()}get eventId(){return 116}Yb(){this.Pb(507);this.Pb(576);this.Pb(10)}Yf(){this.kd(K=>{if(Object(Y.a)(aa,K)&&(K=Object(U.a)(aa,K),void 0!==K.source&&null!==K.source&&void 0!==K.eventId&&null!==K.eventId))return r.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${K.source}; eventId: ${K.eventId}.`),!0;r.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(d.a)(Se,"DefaultRichApiRequestExecutedEvent",y,[]);class Le extends y{constructor(){super()}get eventId(){return 216}Yb(){this.Pb(1022)}}Object(d.a)(Le,"TablelAltTextEditedEvent",y,[]);class ve extends y{constructor(){super()}get eventId(){return 217}Yb(){this.Pb(263)}}Object(d.a)(ve,"FloatingObjectZOrderChangedEvent",y,[]);var We=a(978);class rf extends y{constructor(){super()}get eventId(){return 192}Yb(){this.Pb(507)}Yf(){this.kd(K=>Object(Y.a)(We.a,K)?!0:!1)}}Object(d.a)(rf,
"VisualPropertySetEvent",y,[]);class Jf extends S{constructor(){super(219,[510])}}Object(d.a)(Jf,"ChartSeriesDeletedEvent",S,[]);class Rf extends y{get eventId(){return 220}Yb(){this.Pb(1027)}}Object(d.a)(Rf,"ChartDataChangedEvent",y,[]);class zf extends S{constructor(){super(221,[512])}}Object(d.a)(zf,"ChartSeriesDataChangedEvent",S,[]);class Va{constructor(K){this.xb=null;this.$=K}get macroRecorderEvents(){this.xb||(this.xb=new m.a,this.xb.add(new vd),this.xb.add(new Ta),this.xb.add(new fd),this.xb.add(new jd),
this.xb.add(new Mb),this.xb.add(new td),this.xb.add(new Yd),this.xb.add(new ae),this.xb.add(new je),this.xb.add(new Qe),this.xb.add(new Ze),this.xb.add(new Pe),this.xb.add(new Vd),this.xb.add(new tf),this.xb.add(new Ya),this.xb.add(new be),this.xb.add(new Hb),this.xb.add(new cc),this.xb.add(new Ee),this.xb.add(new bb),this.xb.add(new bf),this.xb.add(new se),this.xb.add(new ue),this.xb.add(new Pd),this.xb.add(new sc),this.xb.add(new Lb),this.xb.add(new fb),this.xb.add(new ed),this.xb.add(new ec),this.xb.add(new Jb),
this.xb.add(new pd),this.xb.add(new xd),this.xb.add(new hd),this.xb.add(new Pc),this.xb.add(new pb),this.xb.add(new Ne),this.xb.add(new he),this.xb.add(new Ye),this.xb.add(new ze),this.xb.add(new Qd),this.xb.add(new Dc),this.xb.add(new ne),this.xb.add(new ab),this.xb.add(new me),this.xb.add(new Zd),this.xb.add(new Wd),this.xb.add(new jb),this.xb.add(new Sa),this.xb.add(new nc),this.xb.add(new te),this.xb.add(new uf),this.xb.add(new gc),this.xb.add(new Cd),this.xb.add(new Lc),this.xb.add(new Mc),this.xb.add(new Kc),
this.xb.add(new fe),this.xb.add(new Re),this.xb.add(new Za),this.xb.add(new ce),this.xb.add(new zd),this.xb.add(new I),this.xb.add(new da),this.xb.add(new Ge),this.xb.add(new ff),this.xb.add(new nd),this.xb.add(new cf),this.xb.add(new wf),this.xb.add(new Sd),this.xb.add(new Ke),this.xb.add(new O),this.xb.add(new M),this.xb.add(new Hd),this.xb.add(new wa),this.xb.add(new ca),this.xb.add(new D),this.xb.add(new qa),this.xb.add(new E),this.xb.add(new L),this.xb.add(new G),this.xb.add(new Z),this.xb.add(new $c),
this.xb.add(new mc),this.xb.add(new Uc),this.xb.add(new af),this.xb.add(new Nb),this.xb.add(new Sb),this.xb.add(new lc),this.xb.add(new ea),this.xb.add(new sa),this.xb.add(new Ea),this.xb.add(new Da),this.xb.add(new Fd),this.xb.add(new cb),this.xb.add(new Ba),this.xb.add(new ba),this.xb.add(new le),this.xb.add(new ma),this.xb.add(new Xb),this.xb.add(new eb),this.xb.add(new Dd),this.xb.add(new cd),this.xb.add(new we),this.xb.add(new Ve),this.xb.add(new zb),this.xb.add(new Yb),this.xb.add(new Fa),this.xb.add(new Wb),
this.xb.add(new ic),this.xb.add(new fc),this.xb.add(new Ob),this.xb.add(new R),this.xb.add(new Ga),this.xb.add(new Td),this.xb.add(new rc),this.xb.add(new od),this.xb.add(new Bb),this.xb.add(new vf),this.xb.add(new kb),this.xb.add(new rb),this.xb.add(new Ha),this.xb.add(new B),this.xb.add(new ia),this.xb.add(new Q),this.xb.add(new Gb),this.xb.add(new mb),this.xb.add(new db),this.xb.add(new Ie),this.xb.add(new yb),this.xb.add(new $a),this.xb.add(new Ma),this.xb.add(new ka),this.xb.add(new pc),this.xb.add(new Oa),
this.xb.add(new oa),this.xb.add(new Ja),this.xb.add(new wc),this.xb.add(new H),this.xb.add(new Vb),this.xb.add(new va),this.xb.add(new bd),this.xb.add(new wd),this.xb.add(new ge),this.xb.add(new W),this.xb.add(new na),this.xb.add(new ua),this.xb.add(new xa),this.xb.add(new gb),this.xb.add(new wb),this.xb.add(new vb),this.xb.add(new nb),this.xb.add(new lb),this.xb.add(new za),this.xb.add(new V),this.xb.add(new La),this.xb.add(new ja),this.xb.add(new Ua),this.xb.add(new Xa),this.xb.add(new tb),this.xb.add(new fa),
this.xb.add(new ya),this.xb.add(new Na),this.xb.add(new hb),this.xb.add(new Ra),this.xb.add(new sb),this.xb.add(new ag),this.xb.add(new tc),this.xb.add(new Yc),this.xb.add(new Cc),this.xb.add(new Kb),this.xb.add(new Eb),this.xb.add(new Ac),this.xb.add(new Ka),this.xb.add(new Ib),this.xb.add(new dc),this.xb.add(new yc),this.xb.add(new ld),this.xb.add(new jc),this.xb.add(new ib),this.xb.add(new ta),this.xb.add(new sd),this.xb.add(new Le),this.xb.add(new ve),this.xb.add(new rf),this.xb.add(new Jf),this.xb.add(new zf),
this.xb.add(new Rf),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.thj());return this.xb}w4e(K,Ia){let Ab=this.x4e(K,this.macroRecorderEvents,Ia);Ab||(Ab=this.x4e(K,Va.b7h(),Ia),!Ab&&this.Yjf(K,Va.IKe,Ia)&&(Ab=Va.IKe));return Ab}x4e(K,Ia,Ab){const bc=new m.a;for(let vc of Ia)this.Yjf(K,vc,Ab)&&bc.add(vc);return 1===bc.count?bc.ma(0):1<bc.count?Va.lPh(bc):null}Yjf(K,Ia,Ab){const bc=Va.b2i(K,Ia);return Ab?bc&&Va.x4j(K,Ia):bc}thj(){const K=new m.a;for(let Ia of this.xb){let Ab=
!1;for(let bc of Ia.featureGates)if(!C.EwaSettings.sa(bc)){K.add(Ia);Ab=!0;break}if(!Ab)for(let bc of Ia.PWe)if(!C.EwaSettings.getBooleanFeatureGate(bc,!1)){K.add(Ia);break}}for(let Ia of K)this.xb.remove(Ia)}static b7h(){Va.cEb||(Va.cEb=new m.a,Va.cEb.add(new X),Va.cEb.add(new Ca));return Va.cEb}static b2i(K,Ia){return Ia.operations.contains(K.operation)}static x4j(K,Ia){Ia=Ia.NEc;if(!Ia.count)return!0;let Ab=!0;for(let bc of Ia)if(!bc(K.payload)){Ab=!1;break}return Ab}static lPh(K){let Ia=K.ma(0);
for(let Ab of K)Ab.NEc.count>Ia.NEc.count&&(Ia=Ab);return Ia}}Va.cEb=null;Va.IKe=new Se;Object(d.a)(Va,"MacroRecorderEventList",null,[]);class xb extends h.a{constructor(K){super();this.$=K;this.Db()}create(){this.nb(this.$.da.Aa(297)||new w(this.$,new Va(this.$),new v))}static ka(K){K.da.Ha(298,new xb(K))}}Object(d.a)(xb,"MacroRecorderEventHandlerFactory",h.a,[]);var Ub=a(1264),xc=a(7),Rc=a(558);class kd{constructor(){this.Ktg=new m.a}get u2b(){return this.Ktg}NZh(K){r.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",K);const Ia=new m.a;for(let Ab of this.u2b)for(let bc of Ab.rFb)bc.id===K&&Ia.add(bc);return Ia}toe(K){this.u2b.add(K)}ohj(K){for(let Ia of this.u2b)if(Ia.Ase===K.Ase){this.u2b.remove(Ia);break}}static Omh(K,Ia,Ab=null){K=kd.TRh(K);0<K.length&&(kd.Yxc(K,!1),Ab&&Ab(Ia,K))}static TRh(K){const Ia=[];if(K&&K.rFb&&0<K.rFb.count)for(let Ab of K.rFb)if(Ab.controls&&0<Ab.controls.count)for(let bc of Ab.controls)if(bc.menuItems&&0<bc.menuItems.count)for(let vc of bc.menuItems)Array.add(Ia,
vc.id);return Ia}static Yxc(K,Ia){if(K.length){var Ab=[];for(const bc of K)Ab.push(appChrome.actions.updateControlEnabledDisabledState(bc,Ia));appChrome.api.dispatch(Ab)}}}Object(d.a)(kd,"ContextMenuExtensibilityCache",null,[488,489]);var Md=a(1490),Kd=a(85),Ad=a(4),Ae=a(881),qe=a(827);class mf{JYa(K,Ia=null){if(K=qe.a.I3a(K)){appChrome.addInApi.dispatchActionsToInstallAddIn(K,Ia);for(const Ab of K.tabs)if(Ab.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,()=>{});break}}}FLd(K){(K=
qe.a.I3a(K))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(K)}static Wmh(K,Ia,Ab=null){K=mf.P1h(K);0<K.length&&(mf.Yxc(K,!1),Ab&&Ab(Ia,K))}static P1h(K){const Ia=[];if(K&&(K=K.EV,K.Ks&&0<K.Ks.count))for(let Ab of K.Ks)if(Ab.groups&&0<Ab.groups.length)for(const bc of Ab.groups)if(bc.controls&&0<bc.controls.length)for(const vc of bc.controls)Array.add(Ia,vc.id);return Ia}static Yxc(K){if(K.length){var Ia=[];for(const Ab of K)Ia.push(appChrome.actions.updateControlEnabledDisabledState(Ab,!0));appChrome.api.dispatch(Ia)}}}
Object(d.a)(mf,"OneLineRibbonExtensibilityManager",null,[185]);var ub=a(952);class Pb{constructor(){this.d5d=this.pGc=null}get xVc(){return this.pGc||(this.pGc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set xVc(K){this.pGc=K}get TUg(){return this.d5d||(this.d5d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(K,Ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(K,Ia)}hkd(K,
Ia,Ab,bc,vc,Tc=null,ad=null){r.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",K);if((K=Ia.Nia(vc.ownerAddinInfo.storeType,vc.ownerAddinInfo.solutionId))&&K.mB&&!K.mB.getIsUpgrading())if(Ia=null,0<K.mB.getNotificationParams().length&&(Ia=this.qye(K.mB.getNotificationParams()[0]))&&2147758681===Ia.errorCode&&(K.isUpgraded=!0),2!==K.mB.getStatus()&&(1!==K.mB.getStatus()||Ia&&2147758681===Ia.errorCode))Ia&&this.c9f(K,Ia,ad);else try{Ab.setOwnerAddinEToken(K.mB.getEToken()),vc.action(Ab,bc.Jca),Tc&&
Tc()}catch(md){r.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Ad.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?md.stack:md.message)),ub.a.nUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}c9f(K,Ia,Ab=null){const bc=K.mB;if(1===bc.getNotificationParams().length||Ia.cfc){const vc=Ia.jha,Tc=Ia.kia;Ia.jha=()=>{bc.removeFirstNotification();if(0<bc.getNotificationParams().length){const ad=
this.qye(bc.getNotificationParams()[0]);this.c9f(K,ad)}2147758681===Ia.errorCode&&(mf.Wmh(K.Bo,bc,Object(Kd.a)(this,this.sef,"initUpgradeStateDetectTask")),kd.Omh(K.Zrb,bc,Object(Kd.a)(this,this.sef,"initUpgradeStateDetectTask")));vc&&vc()};Ia.kia=()=>{Tc&&Tc();Ab&&Ab()};ub.a.pUd(Ia)}}sef(K,Ia){let Ab=null;Ab=()=>{K.getIsUpgrading()?window.setTimeout(Ab,1E3):K.getUpgradingFailed()?mf.Yxc(Ia,!0):Ad.AFrameworkApplication.ra.updateCommandUI()};window.setTimeout(Ab,1E3)}qye(K){const Ia=new Ae.a;Ia.QLa=
K.infoType;Ia.id=K.id;Ia.title=K.title;Ia.description=K.description;Ia.buttonText=K.buttonTxt;Ia.jha=K.buttonCallback;Ia.cfc=K.highPriority;Ia.kia=K.dismissCallback;Ia.errorCode=K.errorCode;Ia.ydf=K.iframeNotificationUrl;return Ia}}Object(d.a)(Pb,"AddinCommandsActionHandler",null,[154]);var qc=a(83),Ic=a(160),gd=a(709),Bd=a(5),Id=a(751),Ud=a(710);class ke{constructor(K,Ia){this.Va=K;this.G9g=Ia}pMh(K){if(void 0!==K&&null!==K&&K===Bd.a.TFe)K="ContextMenuCell";else return null;const Ia=this.Va.Ec();
this.GLh(Ia,K);return Ia}GLh(K,Ia){Ia=this.G9g.NZh(Ia);for(let Ab of Ia){Ia=Ab.controls;for(let bc of Ia)this.tLh(K,bc)}}tLh(K,Ia){var Ab=Ia.QT[Id.a.id];const bc=Ia.QT[Id.a.IUa],vc=Ia.QT[Id.a.MUa];let Tc="Image16by16",ad=Ia.QT[Id.a.JUa];Ud.c(vc)&&(Tc="None");0<Ia.menuItems.count?(Ab=this.Va.Xv(Ab,Ab,bc,798637440),Ab.bMb(Tc,vc,null),this.nMh(Ab.menu,Ia),K.buttons.push(Ab)):K.buttons.push(this.Va.YHa(Ab,bc,ad,vc,Tc,null,!1))}nMh(K,Ia){const Ab=this.Va.Ec();for(let bc of Ia.menuItems){Ia=bc.Cla[Id.a.id];
const vc=bc.Cla[Id.a.IUa],Tc=bc.Cla[Id.a.MUa];let ad="Image16by16";const md=bc.Cla[Id.a.JUa];Ud.c(Tc)&&(ad="None");Ia=this.Va.YHa(Ia,vc,md,Tc,ad,null,!1);Ab.buttons.push(Ia)}K.rc.push(Ab)}}Object(d.a)(ke,"AddInCommandsContextMenuExtensibilityHandler",null,[583]);var Te=a(877);class Oe{constructor(){this.ei=null;this.visible=!1}}Object(d.a)(Oe,"AddinStatusCommandValues",null,[]);class xf{static r$i(K){const Ia=new Oe;Ia.ei=K.dZa;Ia.visible=Ia.ei?!0:!1;return Ia}static Nzc(K,Ia,Ab,bc,vc){const Tc=document.getElementById(Ab);
Tc?xf.PIj(K,Ia,Tc,bc,vc):r.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Ab))}static PIj(K,Ia,Ab,bc,vc){Ab?K.dZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?ub.a.AHj(Ia,Ab,bc,vc):K.dZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&ub.a.UIj(Ia,Ab):r.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(d.a)(xf,"AddinCommandsStatusHandler",null,[]);var Aa=a(38),Cb=a(229),Tb=a(13);class zc extends Aa.a{constructor(K,
Ia){super();this.agaveCommandManager=this.statusBarManager=null;this.KCe=()=>{this.BF&&this.BF.nCe()};this.P9e=()=>{this.raiseEvent("LAC")};this.Rc=(Ab,bc)=>{!Ab.Xb&&Cb.b(bc)&&this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null)};this.BF=Ia;this.$=K;this.SNj=K.Bb+"OfficeAddinLabel-Medium14";this.$.da.gb(29,Ab=>{this.statusBarManager=Ab;Ab.XI(this)});this.$.ea.Jj(this.Rc);this.BF.uLg(this.P9e);this.$.da.gb(206,Ab=>{this.agaveCommandManager=Ab;Ab.WMg(this.KCe)})}nq(K){this.addHandler("LAC",
K)}Iq(K){this.removeHandler("LAC",K)}Tr(K,Ia){if("QueryAddinLabel"!==K)return!1;Ia[Te.a.LabelText]!==this.BF.dZa&&(K=xf.r$i(this.BF),Ia[Te.a.LabelText]=K.ei,Ia[Te.a.Visible]=K.visible,window.setTimeout(()=>{this.Nzc()},0));return!0}tn(){return!0}Nzc(){this.$&&xf.Nzc(this.BF,this.$.domElement,this.SNj,Tb.a.instance.ga(332),Tb.a.instance.ga(333))}dispose(){this.$.ea.ik(this.Rc);this.BF.vij(this.P9e);this.agaveCommandManager&&(this.agaveCommandManager.Ijj(this.KCe),this.agaveCommandManager=null);this.statusBarManager&&
(this.statusBarManager.wF(this),this.statusBarManager=null);this.BF=this.$=null;super.dispose()}}Object(d.a)(zc,"AddinCommandsStatusBarManager",Aa.a,[282,203]);var Jc=a(1334),la=a(730),ra=a(151),$b=a(122),Vc=a(109),Gd=a(572),de=a(137);class pe{constructor(){this.cZa=null}setErrorMessageForAddin(K,Ia){this.cZa||(this.cZa={});this.cZa[K]=Ia}lUh(K){return this.cZa&&K in this.cZa?this.cZa[K]:null}}Object(d.a)(pe,"AddinCommandsErrorManager",null,[]);var Be=a(334),Df=a(98);class Ef{constructor(){this.Qp=
this.HN=0;this.QXc=null;this.Lsc=this.yCc=0;this.Dpa=this.$Kc=this.HGc=this.R4b=this.gja=this.y9=null}get PXc(){this.HGc||(this.HGc=new m.a);return this.HGc}get Ydd(){this.$Kc||(this.$Kc=new m.a);return this.$Kc}get OHa(){this.Dpa||(this.Dpa=new m.a);return this.Dpa}}Object(d.a)(Ef,"AddinCommandsListLoaderContext",null,[]);var If=a(832);class Mf{}Object(d.a)(Mf,"AppsForOfficeEntitlementQueryInfo",null,[]);var Yf=a(39);const pg=K=>{const Ia={};Ia.solutionId=K.solutionId;Ia.version=K.version;Ia.storeType=
K.storeType;Ia.storeId=K.storeId;Ia.assetId=K.assetId;Ia.assetStoreId=K.assetStoreId;Ia.targetType=K.targetType;Ia.requireConsent=K.requireConsent||!1;Ia.isAddinCommands=!0;Ia.addinCommandsActionType=0;return Ia};class zg{constructor(K,Ia){this.entitlement=K;this.metadata=Ia}Weg(){const K=pg(this.entitlement);K.targetType=this.targetType;return K}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(d.a)(zg,"AddinEntitlementEx",null,[]);var Vg=a(260),Lf=a(30);class qg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(qg,"AddinAbstract",null,[]);class Ag extends Sys.EventArgs{constructor(){super();this.Bo=this.fk=
null}}Object(d.a)(Ag,"InsertionParamEventArgs",Sys.EventArgs,[]);class Eg{constructor(K,Ia,Ab,bc=null){this.OKb=Ad.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=K;this.RDa=Ia;this.qjb=Ab;this.Blb=bc}b$b(K){this.WVe(K,"getAddinTeachingCalloutSettings",Object(Kd.a)(this,this.X3,"getRequestSuccessCallback"),Object(Kd.a)(this,this.GM,"getRequestFailureCallback"))}KDh(){const K=new m.a;K.add(this.appName);this.WVe(K,"getTeachingCalloutSettingsForAddinBetterEntryPoint",
Object(Kd.a)(this,this.C1h,"getRequestSuccessCallbackForBEP"),Object(Kd.a)(this,this.GM,"getRequestFailureCallback"))}WVe(K,Ia,Ab,bc){const vc=new Sys.StringBuilder(this.OKb);vc.append("RoamingServiceHandler.ashx?action=");vc.append(Ia);vc.append("&");vc.append(this.did(K));vc.append("&");vc.append(Ad.AFrameworkApplication.ti);Ad.AFrameworkApplication.Bd.Im(vc.toString(),1,null,null,!0,2,Ab,bc,null)}W2a(K){this.aWe(K,"saveAddinTeachingCalloutSettings")}PDh(K){this.aWe(K,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}aWe(K,
Ia){const Ab=new Sys.StringBuilder(this.OKb);Ab.append("RoamingServiceHandler.ashx?action=");Ab.append(Ia);Ab.append("&");Ab.append(Ad.AFrameworkApplication.ti);Ia=Ab.toString();K=Yf.c(K);Ad.AFrameworkApplication.Bd.Im(Ia,2,K,null,!0,4,null,Object(Kd.a)(this,this.EN,"postRequestFailureCallback"),null)}X3(K){let Ia=!1,Ab=null;try{if(0<K.data.de.length){const bc=Object(U.a)(Object,Yf.a(K.data.de)),vc=bc?bc[this.appName]:null;vc&&(Ab=Object(U.a)(Object,Yf.a(vc.toString())))}Ia=!0}catch(bc){this.GM(null)}Ia&&
this.RDa&&this.RDa(Ab)}C1h(K){let Ia=!1,Ab=null;try{if(0<K.data.de.length){const bc=Object(U.a)(Object,Yf.a(K.data.de));Ab=Object(U.a)(String,bc[this.appName])||null}Ia=!0}catch(bc){this.GM(null)}Ia&&this.RDa&&(K={},K.Platforms=Ab,this.RDa(K))}GM(K){this.qjb&&this.qjb(K?K.data:null)}EN(K){this.Blb&&this.Blb(K?K.data:null)}did(K){const Ia=new Sys.StringBuilder("requestedsettings=");for(let Ab=0;Ab<K.count;Ab++)Ia.append(K.ma(Ab)),Ab<K.count-1&&Ia.append(";");return Ia.toString()}}Object(d.a)(Eg,"AddinTeachingUIRoamingRequestHandler",
null,[]);class Jg extends Sys.EventArgs{constructor(K){super();this.solutionId=K.solutionId;this.assetId=K.assetId;this.storeType=K.storeType;this.storeId=K.storeId;this.assetStoreId=K.assetStoreId;this.targetType=K.targetType;this.width=K.width;this.height=K.height;this.displayName=K.displayName;this.version=K.version}}Object(d.a)(Jg,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Nf=a(346);class Bg{constructor(K){this.gZa=this.fk=null;this.Eda=!1;this.Dpa=this.uRb=this.Gma=this.Ng=
this.gX=this.SN=null;this.Pa=K}get appName(){return Ad.AFrameworkApplication.fa.Wa("WebAppShortName")}get Bob(){this.gX||(this.gX=new Eg(this.appName,Object(Kd.a)(this,this.X3,"getRequestSuccessCallback"),Object(Kd.a)(this,this.GM,"getRequestFailureCallback"),Object(Kd.a)(this,this.EN,"postRequestFailureCallback")));return this.gX}get Sra(){this.uRb||(this.uRb=new m.a);return this.uRb}set Sra(K){this.uRb=K}get OHa(){this.Dpa||(this.Dpa=new m.a);return this.Dpa}set OHa(K){this.Dpa=K}sWc(K,Ia){window.addEventListener?
(this.fk=K,this.gZa=Ia,window.addEventListener("LaunchAddinTaskpane",Object(Kd.a)(this,this.BDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Kd.a)(this,this.OFb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Kd.a)(this,this.KFb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.DFb,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}LZd(K,
Ia,Ab,bc){this.Ng=K;this.Sra=Ia;this.OHa=Ab;this.Gma=bc;r.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ia?Ia.count.toString():"null",Ab?Ab.count.toString():"null");0<this.Sra.count||0<this.OHa.count?(K=new m.a,K.add(this.appName),this.Bob.b$b(K)):this.Gma(new m.a,null)}BDd(){const K=new Vg.ScriptSharpLegacyMap;this.gZa&&this.gZa.tabs&&!this.gZa.tabs[0].isOfficeTab&&K.ia("SDX.FeatureFlags","NonOfficeTab");this.lla(Bg.KU(this.fk),
"ClickOnLaunch",K);this.yla();this.gZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.gZa,()=>{const Ia=new Ag;Ia.fk=this.fk;this.Pa.raiseEvent(la.a.rvd,Ia)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}KFb(){this.lla(Bg.KU(this.fk),"ClickOnClose");this.yla()}OFb(){this.lla(Bg.KU(this.fk),"ClickOnDismiss");this.yla()}DFb(K){if(K&&(K=K.detail)&&K.id&&this.mpd(K.id)){const Ia=(K.action||"").toLowerCase();if(K.success&&"opened"===
Ia)this.lla(Bg.KU(this.fk),"CampaignLaunched"),r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.yla(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.DFb,"onCampaignLaunchedHandler"),!0);else{let Ab;try{Ab=JSON.stringify(K),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ab)}catch(bc){Ab="id : "+K.id+" telemetryEventName: "+K.telemetryEventName,r.ULS.sendTraceTag(523321996,
220,50,"Error serializing campaign event. "+Ab+" Error: "+(bc?bc.toString():""))}}}}mpd(K){K=Lf.a.Yk(K);return-1!==K.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==K.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==K.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==K.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==K.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==K.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}lAa(K){if(this.appName){const Ia={},Ab={};Ab.LastTeachingUIShowTime=
(new Date).toUTCString();Ab.AddinHasShown=K;Ia[this.appName]=Yf.c(Ab);this.Bob.W2a(Ia);r.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}yla(){if(!this.Eda){const K=window.g_roamingAddinList;K&&(this.lAa(K),this.Eda=!0)}}X3(K){K?this.$Mb(K)?(r.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.SN="AddinHasShown"in
K&&K.AddinHasShown?K.AddinHasShown.toString():null,this.Lrb()):(r.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Gma(this.Sra,null)):(r.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.SN=null,this.Lrb())}GM(K){r.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",K?K.httpStatus:-1);this.Gma(this.Sra,null)}EN(K){r.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
K?K.httpStatus:-1)}Lrb(){const K=this.m8c();0===K.targetType?(K.solutionId?this.JId(K):this.lla(null,"NoSolutionId"),this.lkg(K),this.Gma(this.Sra,null)):this.Gma(this.Sra,K);r.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",K.addinId)}JId(K){const Ia=new Mf;Ia.callbackFunc=Ab=>{if(Ab.errorCode){this.lla(K.solutionId,"FailToGetAppDetails");var bc=window.g_roamingAddinList;bc&&this.lAa(bc)}else if(Ab.value)for(bc of Ab.value)if(Ab=bc[1],Ab===K.solutionId){const vc={};vc.solutionId=
Ab;vc.assetId=bc[5];vc.storeType=bc[12];vc.storeId=bc[11];vc.assetStoreId=bc[6];vc.targetType=bc[3];vc.width=bc[7];vc.height=bc[8];vc.displayName=bc[0];vc.version=bc[4];r.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",K.solutionId);bc=new Jg(vc);this.Pa.raiseEvent(la.a.tUd,bc);break}};Ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ia.fromInsertDialog=!1;Ia.refresh=!1;this.Ng.queryEntitlementDetails(Ia)}$Mb(K){if("LastTeachingUIShowTime"in K){if(K=+new Date-+new Date(K.LastTeachingUIShowTime.toString()),
K<Ad.AFrameworkApplication.fa.CM("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",K),!1}else r.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}m8c(){let K=new Be.a(new qg,0),Ia=new Be.a(new qg,0),Ab=0,bc=0,vc=0;var Tc=new m.a;for(var ad of this.Sra)Tc.add(ad);for(let md of this.OHa)Tc.add(md);for(let md of Tc)if(!("excatalog"!==md.storeType||Ud.c(md.installTimeInMS)||!md.installTimeInMS||
md.installTimeInMS<=Ad.AFrameworkApplication.fa.CM("DateTimeInMSForNewAddin",16409952E5))){Tc=Bg.bwb(md);if(this.SN&&(ad=this.SN.split(","),0<ad.length&&Array.contains(ad,Tc))){vc++;r.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(K=Bg.h4e(md,K),bc++):(Ia=Bg.h4e(md,Ia),Ab++)}r.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",bc,Ab,vc);return 0<Ia.value?
Ia.key:0<K.value?K.key:Object.assign(new qg,{addinId:null,targetType:-1,solutionId:null})}lla(K,Ia,Ab=null){K={["AppTeachingUICalloutAction"]:Ia,["SDX.Id"]:K,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ab)for(let bc of Ab.keys)K[bc]=Ab.ma(bc);ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}))}lkg(K){K&&(window.g_roamingAddinList=this.SN?this.SN+","+K.addinId:K.addinId)}static KU(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,
K.storeType,K.assetId,null,null,K.storeId)}static h4e(K,Ia){return Ia.value<K.installTimeInMS?new Be.a(Object.assign(new qg,{addinId:Bg.bwb(K),targetType:K.targetType,solutionId:K.solutionId}),K.installTimeInMS):Ia}static bwb(K){return Telemetry.PrivacyRules.IsPrivateAddin(K.storeType,K.assetId,null,null,K.storeId)?"private_"+K.installTimeInMS:K.solutionId}}Object(d.a)(Bg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var wg=a(79);const rg=()=>{const K=wg.a.qZ(window.location.href.toLowerCase(),
"wdomexsrctype");return!!K&&"4"===K},jh=()=>wg.a.qZ(window.location.href.toLowerCase(),"wdtpl"),Wg=()=>{const K=wg.a.qZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!K&&"1"===K};var Xg=a(831),Fg=a(696);class kh{constructor(K){this.Hr=null;this.Vt=K}get_current(){if(!this.Hr)throw Error.argumentOutOfRange();return this.Hr.data}moveNext(){if(!this.Hr)return this.Hr=this.Vt,!!this.Vt;if(!this.Hr.next)return!1;this.Hr=this.Hr.next;return!0}onc(){if(!this.Hr)return this.Hr=this.Vt,!!this.Vt;
if(!this.Hr.previous)return!1;this.Hr=this.Hr.previous;return!0}reset(){this.Hr=this.Vt}}Object(d.a)(kh,"ListEnumerator",null,[0]);class df{constructor(K,Ia,Ab){this.next=Ab;this.previous=Ia;this.data=K}}Object(d.a)(df,"ListNode",null,[]);class pa{constructor(){this.hA=this.aq=null;this._count=0}add(K){this.aq?this.hA=this.hA.next=new df(K,this.hA,null):this.aq=this.hA=new df(K,null,null);this._count=this.count+1}insert(K,Ia){if(K>this.count||0>K)throw Error.argumentOutOfRange("pos");if(K===this.count)this.add(Ia);
else{for(var Ab=this.aq;0!==K--;)Ab=Ab.next;K=new df(Ia,Ab.previous,Ab);K.previous?K.previous.next=K:this.aq=K;K.next?K.next.previous=K:this.hA=K;this._count=this.count+1}}remove(K){let Ia=this.aq;for(;Ia&&Ia.data!==K;)Ia=Ia.next;if(!Ia)return!1;Ia.previous?Ia.previous.next=Ia.next:this.aq=Ia.next;Ia.next?Ia.next.previous=Ia.previous:this.hA=Ia.previous;this._count=this.count-1;return!0}clear(){let K=this.aq,Ia;for(this.hA=this.aq=null;K;)Ia=K.next,K.previous=null,K.next=null,K=Ia;this._count=0}indexOf(K){let Ia=
this.aq,Ab=0;for(;Ia&&Ia.data!==K;)Ia=Ia.next,Ab++;return Ia?Ab:-1}ma(K){return this.at(K).data}get count(){return this._count}getEnumerator(){return new kh(this.aq)}[Symbol.iterator](){return Object(Fg.a)(this.getEnumerator())}$bc(K){K=this.at(K);return new kh(K)}toArray(){const K=Array(this.count);let Ia=0;for(let Ab of this)K[Ia]=Ab,Ia++;return K}at(K){let Ia=this.aq,Ab=0;for(;Ab!==K;){if(!Ia)throw Error.argumentOutOfRange("pos");Ia=Ia.next;Ab++}return Ia}}Object(d.a)(pa,"List",null,[1]);class qb extends Sys.EventArgs{constructor(K){super();
this.properties=K}}Object(d.a)(qb,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class kc{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(kc,"MiniAddinInfo",null,[]);class Ec{constructor(K,Ia,Ab){this.Pa=new Df.a;this.context=new Ef;this.$Tc=this.UVd=this.fGa=this.SN=this.gX=null;this.contextActivationMgr=K;this.oPg=Ia;this.gGa=Ab;this.appName=Ad.AFrameworkApplication.fa.Wa("WebAppShortName")}get AOb(){this.$Tc||(this.$Tc=new Bg(this.Pa));return this.$Tc}sLg(K){this.Pa.addHandler(la.a.wob,
K)}NOg(K){this.Pa.addHandler(la.a.tUd,K)}FWj(K){null!==K&&(this.context.HN=K[la.a.eP],this.context.Qp=K[la.a.OL],this.context.yCc=this.context.Lsc=0,K=la.a.hGa in K?K[la.a.hGa]:0,-1!==this.context.HN&&0!==this.context.Qp&&(this.context.y9=new pa,this.context.gja=new pa,this.context.R4b=new pa,this.context.QXc=this.oPg.createAddinDataProvider(Xg.a(this.context.HN),this.contextActivationMgr),this.context.QXc?this.context.QXc.getEntitlementsAsync(this.contextActivationMgr.Jca,!0,K,Ia=>{this.OVi(Ia)}):
r.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.HN)))}OVi(K){if(K&&0<K.length){this.context.yCc=K.length;const Ab=Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?jh():null;for(let bc=0;bc<K.length;bc++){const vc=K[bc];if(Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Wg()&&vc&&vc.storeType&&"omex"===vc.storeType.toLowerCase()&&vc.assetId&&Ab&&vc.assetId.toLowerCase()===
Ab.toLowerCase()){var Ia={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Ec.KU(vc)};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li(Ia)}))}!vc||1!==vc.targetType&&-1!==vc.targetType?this.noc():(Ia={},Ad.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ia.solutionId=vc.solutionId,Ia.version=vc.version):(Ia.marketplaceId=vc.solutionId,Ia.marketplaceVersion=
vc.version),Ia.storeType=vc.storeType,Ia.storeId=vc.storeId,Ia.targetData=vc,Ec.BOb?this.contextActivationMgr.isAddinCommandsExAsync(Ia,Object(Kd.a)(this,this.jVi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ia,(Tc,ad,md)=>{Tc?(ad&&this.context.y9.add(md.targetData),10===this.context.HN&&(Tc=md.targetData,ad=Tc.targetType,Ud.c(md.targetTypeForExp)||(ad=md.targetTypeForExp,Tc.targetType=ad),this.context.gja.add(Tc),0===ad&&this.context.R4b.add(Tc))):(md=md.targetData,
r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(md.solutionId,md.storeType,md.assetId,null,null,md.storeId),md.storeType));this.noc()}))}}else this.noc()}noc(){var K;(K=this.context).Lsc=K.Lsc+1;this.context.Lsc>=this.context.yCc&&(this.gGa.s3f(this.context.HN,!1),0<this.context.yCc&&10===this.context.HN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(K=!1,Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
rg()&&(K=this.QBi()),this.cBi(),Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!K?Ec.BOb?this.AOb.LZd(this.contextActivationMgr,this.context.PXc,this.context.OHa,(Ia,Ab)=>{const bc=new m.a;for(let vc of Ia)Ia=vc.Weg(),Ab&&Ab.solutionId===vc.solutionId&&(Ia.showCallout=!0,this.AOb.lkg(Ab)),bc.add(Ia);this.Gma(bc)}):this.aOh(this.context.y9):this.a_b(this.context.y9)):this.a_b(this.context.y9))}a_b(K){if(Ec.BOb)this.Gma(this.c8g(this.context.PXc));
else{var Ia=new m.a;if(K)for(let Ab of this.context.y9)Ia.add(pg(Ab));this.context.y9&&1>this.context.y9.count&&If.a.Tfb(la.a.xob,"false",this.context.HN);K={["ack2"]:Ia};K[la.a.eP]=this.context.HN;K[la.a.OL]=this.context.Qp;this.Pa.raiseEvent(la.a.wob,new qb(K),this)}}c8g(K){const Ia=new m.a;if(K)for(let Ab of K)Ia.add(Ab.Weg());return Ia}Gma(K){K&&K.count||If.a.Tfb(la.a.xob,"false",this.context.HN);K={["ack2"]:K};K[la.a.eP]=this.context.HN;K[la.a.OL]=this.context.Qp;this.Pa.raiseEvent(la.a.wob,
new qb(K),this)}lAa(K){if(this.appName){const Ia={},Ab={};Ab.LastTeachingUIShowTime=(new Date).toUTCString();Ab.AddinHasShown=K;Ia[this.appName]=Yf.c(Ab);this.gX&&(this.gX.W2a(Ia),r.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else r.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}aOh(K){(this.fGa=K)?(K=new m.a,K.add(this.appName),this.gX=new Eg(this.appName,Object(Kd.a)(this,
this.X3,"getRequestSuccessCallback"),Object(Kd.a)(this,this.GM,"getRequestFailureCallback"),Object(Kd.a)(this,this.EN,"postRequestFailureCallback")),this.gX.b$b(K)):(K={["ack2"]:new m.a},K[la.a.eP]=this.context.HN,K[la.a.OL]=this.context.Qp,this.Pa.raiseEvent(la.a.wob,new qb(K),this))}X3(K){K?this.$Mb(K)?(r.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.SN="AddinHasShown"in K&&K.AddinHasShown?K.AddinHasShown.toString():null,this.Lrb()):(r.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.a_b(this.fGa)):(r.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.SN=null,this.Lrb())}GM(K){r.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",K?K.httpStatus:-1);this.a_b(this.fGa)}EN(K){r.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",K?K.httpStatus:-1)}Lrb(){const K=this.m8c();0===K.targetType?(K.solutionId?(this.UVd=K.solutionId,this.JId()):this.lla("NoSolutionId"),K.addinId&&
(window.g_roamingAddinList=this.SN?this.SN+","+K.addinId:K.addinId),this.Soe(null)):this.Soe(K.addinId);r.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",K.addinId)}JId(){const K=new Mf;K.callbackFunc=Ia=>{if(Ia.errorCode){this.lla("FailToGetAppDetails");var Ab=window.g_roamingAddinList;Ab&&this.lAa(Ab)}else if(Ia.value)for(Ab of Ia.value)if(Ia=Ab[1],Ia===this.UVd){const bc={};bc.solutionId=Ia;bc.assetId=Ab[5];bc.storeType=Ab[12];bc.storeId=Ab[11];bc.assetStoreId=Ab[6];bc.targetType=
Ab[3];bc.width=Ab[7];bc.height=Ab[8];bc.displayName=Ab[0];bc.version=Ab[4];Ab=new Jg(bc);this.Pa.raiseEvent(la.a.tUd,Ab);break}};K.storeType=OSF.StoreTypeEnum.PrivateCatalog;K.fromInsertDialog=!1;K.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(K)}$Mb(K){if("LastTeachingUIShowTime"in K){if(K=+new Date-+new Date(K.LastTeachingUIShowTime.toString()),K<Ad.AFrameworkApplication.fa.CM("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
K),!1}else r.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}m8c(){let K=new Be.a(new kc,0),Ia=new Be.a(new kc,0),Ab=0,bc=0,vc=0;var Tc=new pa;if(0<this.context.y9.count)for(var ad of this.context.y9)Tc.add(ad);if(0<this.context.R4b.count)for(let md of this.context.R4b)Tc.add(md);for(let md of Tc)if(!("excatalog"!==md.storeType||Ud.c(md.installTimeInMS)||!md.installTimeInMS||md.installTimeInMS<=Ad.AFrameworkApplication.fa.CM("DateTimeInMSForNewAddin",16409952E5))){Tc=Ec.bwb(md);
if(this.SN&&(ad=this.SN.split(","),0<ad.length&&Array.contains(ad,Tc))){vc++;r.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(K.value<md.installTimeInMS&&(K=new Be.a(Object.assign(new kc,{addinId:Tc,targetType:md.targetType,solutionId:md.solutionId}),md.installTimeInMS)),bc++):(Ia.value<md.installTimeInMS&&(Ia=new Be.a(Object.assign(new kc,{addinId:Tc,targetType:md.targetType,solutionId:md.solutionId}),md.installTimeInMS)),Ab++)}r.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",bc,Ab,vc);return 0<Ia.value?Ia.key:0<K.value?K.key:Object.assign(new kc,{addinId:null,targetType:-1,solutionId:null})}Soe(K){const Ia=new m.a;for(let Ab of this.fGa){const bc=pg(Ab);if(K){const vc=Ec.bwb(Ab);K===vc&&(bc.showCallout=!0,window.g_roamingAddinList=this.SN?this.SN+","+K:K)}Ia.add(bc)}this.fGa&&1>this.fGa.count&&If.a.Tfb(la.a.xob,"false",this.context.HN);K={["ack2"]:Ia};K[la.a.eP]=this.context.HN;
K[la.a.OL]=this.context.Qp;this.Pa.raiseEvent(la.a.wob,new qb(K),this)}QBi(){if(Ec.BOb)return this.RBi(this.context.Ydd);var K=!1;if(this.context.gja&&1>this.context.gja.count)return K;const Ia=jh();if(!Ia)return K;for(let Ab of this.context.gja)if(Ab.storeId&&Ab.storeId.toLowerCase()===Ia.toLowerCase()||Ab.assetId&&Ab.assetId.toLowerCase()===Ia.toLowerCase())K={["SDX_Id"]:Ec.KU(Ab),["SDX_TargetType"]:Ud.c(Ab.targetType)?"":Ab.targetType.toString()},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:$b.a.Li(K)})),K=!0;return K}cBi(){if(Ec.BOb)this.dBi(this.context.Ydd);else if(!(this.context.gja&&1>this.context.gja.count))if(this.gGa.Tjf()){var K=this.gGa.$5e();K?(K=this.M1e(this.context.gja,K),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(K=this.M1e(this.context.gja,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.gGa.S5f(K)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}M1e(K,
Ia){const Ab={};let bc=!1;for(let vc of K)if(K=Ec.KU(vc))!Ia||K in Ia||(this.c_(vc,K),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===K.toLowerCase()?bc||(bc=!0,Ab[K]=null):Ab[K]=null;return Ab}c_(K,Ia){var Ab=K.installTimeInMS?(new Date(K.installTimeInMS)).toISOString():"";Ab={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ud.c(K.targetType)?"":K.targetType.toString(),["SDX.AdminDeploymentTime"]:Ab};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li(Ab)}));1===K.targetType&&(K={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:$b.a.Li(K)})))}RBi(K){let Ia=!1;if(K&&1>K.count)return Ia;const Ab=jh();if(!Ab)return Ia;for(let bc of K)if(bc.storeId&&bc.storeId.toLowerCase()===Ab.toLowerCase()||bc.assetId&&bc.assetId.toLowerCase()===Ab.toLowerCase())K=
{["SDX_Id"]:Ec.c6e(bc),["SDX_TargetType"]:Ud.c(bc.targetType)?"":bc.targetType.toString()},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:$b.a.Li(K)})),Ia=!0;return Ia}dBi(K){if(!(K&&1>K.count))if(this.gGa.Tjf()){var Ia=this.gGa.$5e();Ia?(K=this.N1e(K,Ia),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(K=this.N1e(K,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.gGa.S5f(K)}else r.ULS.sendTraceTag(528589915,
306,50,"Local storage got disabled")}N1e(K,Ia){const Ab={};let bc=!1;for(let vc of K)if(K=Ec.c6e(vc))!Ia||K in Ia||(this.XDi(vc,K),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===K.toLowerCase()?bc||(bc=!0,Ab[K]=null):Ab[K]=null;return Ab}XDi(K,Ia){var Ab=K.installTimeInMS?(new Date(K.installTimeInMS)).toISOString():"";Ab={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ud.c(K.targetType)?"":K.targetType.toString(),["SDX.AdminDeploymentTime"]:Ab};
ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li(Ab)}));1===K.targetType&&(K={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:$b.a.Li(K)})))}jVi(K,Ia,Ab,bc){K?(-1===bc.targetType&&(bc.targetType=Ab.targetTypeForExp),K=new zg(Ab.targetData,bc),Ia&&this.context.PXc.add(K),10===this.context.HN&&(this.context.Ydd.add(K),
0===K.targetType&&this.context.OHa.add(K))):(Ia=Ab.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.storeType,Ia.assetId,null,null,Ia.storeId),Ia.storeType));this.noc()}lla(K){K={["AppTeachingUICalloutAction"]:K,["SDX.Id"]:this.UVd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:$b.a.Li(K)}))}static get BOb(){return Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static KU(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static c6e(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static bwb(K){return Telemetry.PrivacyRules.IsPrivateAddin(K.storeType,K.assetId,null,null,K.storeId)?
"private_"+K.installTimeInMS:K.solutionId}}Object(d.a)(Ec,"AddInCommandsListLoader",null,[]);class ud{constructor(K){this.eBg=K}get Jca(){return this.eBg}insertOsfControl(K){return this.Jca.insertOsfControl(K)}getManifestInvaildErrorString(){return this.Jca.getManifestInvaildErrorString()}isAddinCommandsAsync(K,Ia){this.Jca.isAddinCommandsAsync(K,Ia)}isAddinCommandsExAsync(K,Ia){this.Jca.isAddinCommandsExAsync(K,Ia)}ownerAddinControlRecreated(K,Ia){this.Jca.ownerAddinControlRecreated(K,Ia)}queryEntitlementDetails(K){this.Jca.queryEntitlementDetails(K)}}
Object(d.a)(ud,"ContextActivationMgrWrapper",null,[157]);class Rd{createAddinDataProvider(K,Ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(K,Ia.Jca)}static get instance(){Rd.La||(Rd.La=new Rd);return Rd.La}}Rd.La=null;Object(d.a)(Rd,"OSFAddinDataProviderFactory",null,[155]);class ie{constructor(){this.Ver=1}}Object(d.a)(ie,"CacheItem",null,[]);class xe{constructor(K){this.nEa=K}zl(K){const Ia=this.nEa.getItem(K);if(Ia){let Ab=new ie;try{Ab=Sys.Serialization.JavaScriptSerializer.deserialize(Ia,
!0)}catch(bc){return this.nEa.removeItem(K),null}return Ab.Data?Ab.Data:Ab.data}return null}xQa(K){this.nEa.removeItem(K)}}Object(d.a)(xe,"AppsDataCacheManager",null,[884]);var ef=a(798);class gf{constructor(){new xe(ef.a.instance)}s3f(K,Ia){K=la.a.T2e()+K;ef.a.instance.setItem(K,Ia.toString())}$5e(){var K=la.a.d6e();r.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",K);K=ef.a.instance.getItem(K);return Yf.a(K)}S5f(K){const Ia=la.a.d6e();r.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
Ia);ef.a.instance.setItem(Ia,Yf.c(K))}Tjf(){return!!ef.a.instance.localStorage}static get instance(){gf.La||(gf.La=new gf);return gf.La}}gf.La=null;Object(d.a)(gf,"AddInCommandsCacheManager",null,[859]);class vg{constructor(K){this.KBc=null;this.Eda=!1;this.Pa=new Df.a;this.PKb=this.opa=null;this.contextActivationMgr=K;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(Kd.a)(this,this.zXi,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",
Object(Kd.a)(this,this.OFb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(Kd.a)(this,this.KFb,"onCloseButtonClickedEventHandler"),!0))}get appName(){Ud.b(this.opa)&&(this.opa=Ad.AFrameworkApplication.fa.Wa("WebAppShortName"));return this.opa}mNg(K){this.Pa.addHandler(la.a.Npf,K)}LZd(){this.contextActivationMgr.queryStoreDisabled("omex",K=>{K?r.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.hVj()})}hVj(){this.KBc=new Eg(this.appName,
Object(Kd.a)(this,this.X3,"getRequestSuccessCallback"),Object(Kd.a)(this,this.GM,"getRequestFailureCallback"),Object(Kd.a)(this,this.EN,"postRequestFailureCallback"));this.KBc.KDh()}X3(K){this.$Mb(K)&&(r.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.gVd())}GM(K){r.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",K?K.httpStatus:-1)}EN(K){r.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",K?
K.httpStatus:-1)}$Mb(K){if(!K)r.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in K&&(this.PKb=Object(U.a)(String,K.Platforms),!Ud.b(this.PKb)&&(K=this.PKb.split(","),0<K.length&&Array.contains(K,"Web"))))return r.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}gVd(){const K=qc.a.instance.Tb("Common.ISystemInitiatedFeedback");if(K){var Ia=this.RNh();Ud.b(Ia)?r.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):K.execute(Ab=>
{Ab.logActivity(Ia,null)})}else r.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}zXi(){this.c_("ClickOnLaunch");this.pPd();this.Pa.raiseEvent(la.a.Npf)}KFb(){this.c_("ClickOnClose");this.pPd()}OFb(){this.c_("ClickOnDismiss");this.pPd()}RNh(){let K;switch(this.appName){case "Word":K="WordShowCalloutForBEPHomeTab";break;case "Excel":K="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":K="PPTShowCalloutForBEPHomeTab";break;default:K=""}return K}c_(K){K={["AppTeachingUICalloutAction"]:K,
["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}))}pPd(){if(!this.Eda)if(Ud.b(this.appName))r.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const K={};K[this.appName]=this.PKb?this.PKb+",Web":"Web";this.KBc&&(this.KBc.PDh(K),r.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.Eda=
!0}}}Object(d.a)(vg,"BetterEntryTeachingCalloutLauncher",null,[]);class Tg{constructor(K,Ia,Ab,bc,vc,Tc){this.Qp=K;this.fk=Ia;this.rW=Ab;this.displayName=vc;this.Kof=Tc}}Object(d.a)(Tg,"PostLaunchAddinCommandsParameters",null,[]);class ph{constructor(K,Ia,Ab){this.Eda=!1;this.gX=null;this.Za=K;this.Kjb=Ia;this.dhb=Ab}sWc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Kd.a)(this,this.BDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Kd.a)(this,this.OFb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Kd.a)(this,this.KFb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.DFb,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}BDd(){const K={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ph.KU(this.Kjb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.dhb&&this.dhb.tabs&&!this.dhb.tabs[0].isOfficeTab&&(K["SDX.FeatureFlags"]="NonOfficeTab");ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));this.yla();this.dhb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.dhb,()=>{const Ia=new Ag;Ia.fk=this.Kjb;this.Za.raiseEvent(la.a.rvd,Ia)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}KFb(){const K=
{["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ph.KU(this.Kjb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));this.yla()}OFb(){const K={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ph.KU(this.Kjb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));this.yla()}DFb(K){if(K&&(K=K.detail)&&K.id&&this.mpd(K.id)){const Ab=(K.action||"").toLowerCase();if(K.success&&"opened"===Ab){var Ia={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ph.KU(this.Kjb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ia)}));
r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.yla();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.DFb,"onCampaignLaunchedHandler"),!0)}else try{Ia=JSON.stringify(K),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ia)}catch(bc){Ia="id : "+K.id+" telemetryEventName: "+K.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ia+" Error: "+
(bc?bc.toString():""))}}}mpd(K){K=Lf.a.Yk(K);return-1!==K.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==K.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==K.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==K.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==K.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==K.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}lAa(K){const Ia=Ad.AFrameworkApplication.fa.Wa("WebAppShortName");if(Ia){const Ab={},bc={};bc.LastTeachingUIShowTime=
(new Date).toUTCString();bc.AddinHasShown=K;Ab[Ia]=Yf.c(bc);this.gX=new Eg(Ia,null,null,Object(Kd.a)(this,this.EN,"postRequestFailureCallback")),this.gX.W2a(Ab),r.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}yla(){if(!this.Eda){const K=window.g_roamingAddinList;K&&(this.lAa(K),this.Eda=!0)}}EN(K){r.ULS.sendTraceTag(523535566,
220,10,"failed to POST data to Roaming Settings Service with status: {0}",K?K.httpStatus:-1)}static KU(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}}Object(d.a)(ph,"PrivateCatalogTeachingCalloutHandler",null,[]);class Ah{constructor(K){this.yce=null;this.oae=K}get qxa(){return this.yce}JYa(K,Ia=null){this.oae.JYa(K,Ia);this.yce=K}FLd(K){this.oae.FLd(K)}}Object(d.a)(Ah,"RibbonExtensibilityManagerWithChangeDetection",null,[185]);var qh=
a(833),vh=a(100);class Kg{static J3e(K){const Ia=new m.a;if(Kg.VEe)for(var Ab of Kg.VEe)Ia.add(Ab);Ab=null;switch(K){case "Workbook":Ab=Kg.t6j;break;case "Document":Ab=Kg.Ioh;break;case "Presentation":Ab=Kg.g8i}if(Ab)for(const bc of Ab)Ia.add(bc);return Ia}}Kg.VEe=["PrimaryCommandSurface","ContextMenu"];Kg.t6j=null;Kg.Ioh=null;Kg.g8i=null;Object(d.a)(Kg,"ExtensionPointType",null,[]);class Yg{constructor(K){this.zfe=null;if(Ud.c(K))throw r.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),
Error.create("The agave key should not be null or undefined");this.qsg=K}get rFb(){return this.zfe||(this.zfe=new m.a)}get Ase(){return this.qsg}}Object(d.a)(Yg,"ContextMenuExtensibility",null,[858]);class Ih{constructor(K,Ia=null,Ab=0){if(Ud.c(K))throw r.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.YAg=K;this.mEg=Ia;this.Twg=Ab}get EV(){return this.YAg}get startedNode(){return this.mEg}get nNh(){return this.Twg}}
Object(d.a)(Ih,"RibbonExtensibility",null,[907]);class xg{constructor(K){this.Tvg=K.entitlement}get entitlement(){return this.Tvg}createActionContext(K,Ia){K={};K.ownerAddinInfo=this.entitlement;K.action=Ia;return K}}Object(d.a)(xg,"AddInCommandsContextProvider",null,[]);class fh{constructor(K,Ia,Ab){this.x4d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=K;this.eventBuilder=Ia;this.contextMenuBuilder=Ab}get addinInfo(){return this.x4d}fch(K){return new xg(K)}createActionBuilder(K,
Ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(K,Ia.entitlement,Ia.manifest)}startApplyAddin(K){this.x4d=K;const Ia=this.fch(K);this.actionBuilder=this.createActionBuilder(Ia,K)}endApplyAddin(){}zed(K,Ia,Ab=0){return this.ribbonBuilder.Ks&&0<this.ribbonBuilder.Ks.count?new Ih(this.CMh(K,Ia),this.addinInfo.startedNode,Ab):null}m_e(){var K=null;if(this.contextMenuBuilder.Tmc&&0<this.contextMenuBuilder.Tmc.count){K||(K=this.addinInfo.entitlement.solutionId);K=new Yg(K);for(let Ia of this.contextMenuBuilder.Tmc)K.rFb.add(Ia);
return K}return null}CMh(K,Ia){return this.ribbonBuilder.Ks&&0<this.ribbonBuilder.Ks.count?new qe.a(this.ribbonBuilder.Ks,K,Ia):null}}Object(d.a)(fh,"AddinCommandsBuilder",null,[]);class re{constructor(K,Ia,Ab,bc,vc,Tc,ad){this.dTa=new vh.a;this.Qp=K;this.Ng=Ia;this.Ko=Ab;this.ribbonManager=bc;this.contextMenuManager=vc;this.BF=Tc;this.Mga=ad;this.iO=Ad.AFrameworkApplication.ra.ED}$Cb(K,Ia,Ab,bc,vc,Tc,ad){const md=(Ed,Xd,Fe,Me)=>{vc(Ed,Xd,Fe,Me);Ed=qh.a[this.Qp]+Xd.assetId;({value:Xd}=this.dTa.Fc(Ed)).returnValue&&
(Xd.stop(),this.dTa.remove(Ed))};if(0!==this.Qp&&K){r.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",K.count);4===this.Qp&&(r.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",bc)),this.t4g(K,bc),Tc());for(let Ed of K)if(K=Ed,r.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.lmg(K))if(ad&&
K.requireConsent)ad(K,Xd=>{try{if(this.iO){const Me=qh.a[this.Qp]+Xd.solutionId,lf=this.iO.Gc("ComponentAttach",Me);this.dTa.ia(Me,lf)}const Fe=this.BF.Nia(Xd.storeType,Xd.solutionId);6!==this.Qp&&(Fe&&(this.H3b(Fe),Fe.mB.purge(!1)),this.Ng.insertOsfControl(this.cIb(Xd,Ia,Ab,md)),Fe&&this.Ng.ownerAddinControlRecreated(Xd.solutionId,Xd.storeType))}catch(Fe){r.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Xd.solutionId,Xd.ownerAddinStoreType||Xd.storeType,Xd.assetId,null,null,Xd.storeId),Xd.version,Xd.storeType,Xd.storeId,Fe.message)),md(!1,Xd,null,null)}});else try{if(this.iO){const Fe=qh.a[this.Qp]+K.solutionId,Me=this.iO.Gc("ComponentAttach",Fe);this.dTa.ia(Fe,Me)}const Xd=this.BF.Nia(K.storeType,K.solutionId);6!==this.Qp&&(Xd&&(this.H3b(Xd),Xd.mB.purge(!1)),this.Ng.insertOsfControl(this.cIb(K,Ia,Ab,md)),Xd&&this.Ng.ownerAddinControlRecreated(K.solutionId,
K.storeType))}catch(Xd){r.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,Xd.message)),md(!1,K,null,null)}else md(!1,K,null,null)}}vyi(K,Ia,Ab,bc,vc,Tc){const ad=(md,Ed,Xd,Fe)=>{Tc(md,Ed,Xd,Fe);md=qh.a[this.Qp]+Ed.solutionId;
({value:Ed}=this.dTa.Fc(md)).returnValue&&(Ed.stop(),this.dTa.remove(md))};if(6===this.Qp&&K)if(r.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.lmg(K))try{if(this.iO){const Ed=qh.a[this.Qp]+K.solutionId,Xd=this.iO.Gc("ComponentAttach",Ed);this.dTa.ia(Ed,Xd)}const md=this.BF.Nia(K.storeType,K.solutionId);md||ad(!1,K,null,null);
Ad.AFrameworkApplication.ra&&Ad.AFrameworkApplication.ra.Qa.delayInstallAddInIsEnabled?this.K_e(K,Ia,bc,vc,Ab,Ed=>{ad(Ed,K,Ab,md.displayName)}):(this.K_e(K,Ia,bc,vc,Ab),ad(!0,K,Ab,md.displayName))}catch(md){r.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,
null,null,K.storeId),K.version,K.storeType,K.storeId,md.message)),ad(!1,K,null,null)}else ad(!1,K,null,null)}lNi(K,Ia,Ab,bc,vc,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.Ko.MM))try{Ad.AFrameworkApplication.ra&&Ad.AFrameworkApplication.ra.Qa.delayInstallAddInIsEnabled?this.J_e(K,Ia,Ab,vc,Tc,ad=>{bc(ad,K,Tc,Tc.getDefaultDisplayName())}):(this.J_e(K,Ia,Ab,vc,Tc),bc(!0,K,Tc,Tc.getDefaultDisplayName()))}catch(ad){r.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,ad.message)),bc(!1,K,Tc,Tc.getDefaultDisplayName())}else r.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,
K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),bc(!1,K,null,null);else r.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Ko.MM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),bc(!1,K,null,null)}cIb(K,Ia,Ab,bc){const vc={},Tc=document.createElement("div");Tc.setAttribute("visible",
"false");vc.div=Tc;vc.id=K.solutionId;vc.solutionId=K.solutionId;vc.version=K.version;vc.storeType=K.storeType;vc.storeId=K.storeId;vc.assetId=K.assetId;vc.assetStoreId=K.assetStoreId;vc.isvirtualOsfControl=!0;vc.virtualOsfControlActivationCallback=(ad,md)=>{const Ed=this.BF.Nia(K.storeType,K.solutionId);Ed&&(Ed.isUpgraded&&(K.isUpgraded=!0),this.H3b(Ed));this.lNi(K,Ia,Ab,bc,ad,md)};vc.reason=3===this.Qp?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return vc}J_e(K,Ia,Ab,bc,vc,Tc=null){const ad={};ad.solutionId=bc.getSolutionId();ad.version=bc.getVersion();ad.storeType=bc.getStoreType();ad.storeId=bc.getStoreId();ad.assetId=bc.getAssetId();ad.assetStoreId=bc.getAssetStoreId();ad.targetType=bc.getOsfControlType();let md=null,Ed=null;if(Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))md=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ko.MM,this.Ko.formFactor)).parseExtensions(ad,
vc,this.Mga),Ed=Kg.J3e(this.Ko.MM);else try{md=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ko.MM,this.Ko.formFactor)).parseExtensions(ad,vc,this.Mga),Ed=Kg.J3e(this.Ko.MM)}catch(Fe){throw r.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Fe.message),Fe;}if(Ed&&0<Ed.count){if(Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Xd=Ia(K);Ia=Ab(K);Ab=!!Ad.AFrameworkApplication.fa&&
Ad.AFrameworkApplication.fa.pa("AddinCommandsMultipleCustomTabsEnabled");Xd=new fh(Xd,null,Ia);for(let Fe of Ed)Xd.commandSurface=Fe,md.apply(Xd,this.Mga,Ab)}else try{let Fe=Ia(K),Me=Ab(K),lf=!!Ad.AFrameworkApplication.fa&&Ad.AFrameworkApplication.fa.pa("AddinCommandsMultipleCustomTabsEnabled");Xd=new fh(Fe,null,Me);for(let tg of Ed)Xd.commandSurface=tg,md.apply(Xd,this.Mga,lf)}catch(Fe){throw r.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Fe.message),
Fe;}if(OSF.OUtil.checkFlight(14))try{let Fe=Xd.zed(K.solutionId,vc.getDefaultDisplayName()),Me=Xd.m_e();Fe&&this.ribbonManager.JYa(Fe,Tc);Me&&this.contextMenuManager.toe(Me);this.BF.$oe(bc,Fe,Me,vc.getDefaultDisplayName());r.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Fe){throw OfficeExt.DevConsole.log(Fe),r.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Fe.message),Fe;}else try{let Fe=Xd.zed(K.solutionId,vc.getDefaultDisplayName()),
Me=Xd.m_e();Fe&&this.ribbonManager.JYa(Fe);Me&&this.contextMenuManager.toe(Me);this.BF.$oe(bc,Fe,Me,vc.getDefaultDisplayName());r.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Fe){throw r.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Fe.message),Fe;}}}K_e(K,Ia,Ab,bc,vc,Tc=null){const ad={};ad.solutionId=K.solutionId;ad.version=K.version;ad.storeType=K.storeType;ad.storeId=K.storeId;ad.assetId=K.assetId;ad.assetStoreId=
K.assetStoreId;ad.targetType=K.targetType;const md=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Ko.MM,this.Ko.formFactor);try{const Ed=Ia.getManifest(),Xd=md.parse(ad,Ed,vc,this.Mga,Ia.getSharedRuntimeId(),Ia),Fe=Ab(K),Me=bc(K),lf=new fh(Fe,null,Me);lf.commandSurface="PrimaryCommandSurface";Xd.apply(lf,this.Mga,!0);if(lf.ribbonBuilder.Ks&&0<lf.ribbonBuilder.Ks.count){const tg=lf.zed(K.solutionId,Ia.getManifest().getDefaultDisplayName(),1);Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.JYa(tg,Tc):tg&&this.ribbonManager.JYa(tg,Tc);this.BF.AJg(Ia,tg,vc,Ia.getManifest().getDefaultDisplayName());r.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ia.getManifest().getDefaultDisplayName())}}catch(Ed){r.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ia.getManifest().getDefaultDisplayName(),Ed.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ed)}}H3b(K){K.Bo&&this.ribbonManager.FLd(K.Bo);
K.Zrb&&this.contextMenuManager.ohj(K.Zrb);this.BF.Xgj(K.mB.getStoreType(),K.mB.getSolutionId())}t4g(K,Ia){Ia=Xg.a(Ia);for(let Ab of this.BF.e6a){if(Ab.mB.getStoreType()!==Ia)continue;let bc=!0;for(let vc of K){const Tc=vc;if(Tc&&Ab.Qlf(Tc.storeType,Tc.solutionId)){bc=!1;break}}bc&&(this.H3b(Ab),Ab.mB.purge(!1))}}lmg(K){return!!K&&!!K.solutionId&&!!K.version&&!!K.storeType&&!!K.storeId}}Object(d.a)(re,"AddInCommandsIntegration",null,[]);class k{constructor(K,Ia,Ab,bc,vc,Tc,ad,md=null){this.Za=new Df.a;
this.JGc=K;this.Kug=Ia;this.Gl=Ab;this.Jle=bc;this.vXa=vc;this.esg=Tc;this.vRb=ad;this.PAg=md;this.Gyg=Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.JMc=Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}tLg(K){this.Za.addHandler(la.a.Tre,K)}lNg(K){this.Za.addHandler(la.a.rvd,K)}MOg(K){this.Za.addHandler(la.a.k9f,K)}ALg(K){this.Za.addHandler(la.a.QZc,K)}Pyi(K,Ia,Ab){const bc=Ab[la.a.vob],
vc=void 0===Ab[la.a.OL]?0:Ab[la.a.OL];if(bc&&0!==vc)if(0>=bc.count&&4!==vc)this.wNf(new Tg(vc,null,null,Ia,null,!0));else{var Tc=bc.count,ad=new Ah(new mf),md=void 0===Ab[la.a.eP]?-1:Ab[la.a.eP],Ed=new re(vc,this.Gl,this.JGc,ad,this.Kug,this.vXa,this.vRb),Xd=jg=>this.Jle.IYg(jg.solutionId,this.vRb,this.JGc,K),Fe=jg=>this.Jle.SXg(jg.solutionId),Me=(jg,cg,eg)=>{Tc--;eg=new Tg(vc,cg,ad,Ia,eg,0>=Tc);if(jg&&cg)this.wNf(eg);else{if(3===vc||cg&&cg.isUpgraded)jg="",cg&&(jg=Telemetry.PrivacyRules.GetPrivacyCompliantId(cg.solutionId,
cg.ownerAddinStoreType||cg.storeType,cg.assetId,null,null,cg.storeId)),cg={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:jg},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li(cg)}));this.vNf(eg)}Tc||Ad.AFrameworkApplication.ra.updateCommandUI()},lf=(jg,cg,eg,og)=>{Me(jg,cg,og)},tg=()=>{this.mBd();0>=bc.count&&4===vc&&this.vXa.nRd()};6===vc?(md=Ab[la.a.UIa],Ab=Ab[la.a.VIa],Ed.vyi(bc.ma(0),
md,Ab,Xd,Fe,(jg,cg,eg,og)=>{Me(jg,cg,og)})):Ed.$Cb(bc,Xd,Fe,md,lf,tg,this.PAg)}else ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),r.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.JGc.MM)),this.vNf(new Tg(vc,null,null,Ia,null,!0))}vNf(K){this.mBd(K);this.a$f(!1,
K)}wNf(K){const Ia=K.fk;let Ab=null;null!==Ia&&(Ab=Ia.storeType,Ab=Ab.toLowerCase());if(K&&"omex"===Ab&&(3===K.Qp||Ia.isUpgraded)){var bc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)};ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$b.a.Li(bc)}))}this.mBd(K);bc=this.JMc&&Wg()&&"omex"===
Ab&&!!K.rW&&!!Ia.solutionId&&2===K.Qp&&Ia.solutionId.toLowerCase()===jh().toLowerCase();var vc="omex"===Ab&&!!K.rW&&(3===K.Qp&&"hardcodedpreinstall"!==Ab||Ia.isUpgraded);const Tc=Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===Ab&&3===K.Qp;if(vc||bc||Tc)bc=new Ag,bc.fk=Ia,bc.Bo=K.rW.qxa,this.Za.raiseEvent(la.a.QZc,bc);this.Gyg&&(bc=rg(),vc=jh(),bc&&Ia&&"excatalog"===Ia.storeType&&K.rW&&5===K.Qp&&vc&&(Ia.storeId&&Ia.storeId.toLowerCase()===
vc.toLowerCase()||Ia.assetId&&Ia.assetId.toLowerCase()===vc.toLowerCase())&&(bc=new Ag,bc.fk=Ia,bc.Bo=K.rW.qxa,this.Za.raiseEvent(la.a.QZc,bc),r.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Ia&&(gf.instance.s3f(Xg.b(Ab),!0),"uploadfiledevcatalog"===Ab&&(bc=this.esg.createAddinDataProvider(Ab,this.Gl))&&bc.localCacheAddinCommands(this.Gl.Jca,Ia.solutionId,Ia.version,Ia.storeId),If.a.Tfb(la.a.xob,"true",Xg.b(Ab)));this.a$f(!0,K)}a$f(K,Ia){K?Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Ia.rW&&5===Ia.Qp&&Ia.rW.qxa&&void 0!==Ia.fk.showCallout&&null!==Ia.fk.showCallout&&Ia.fk.showCallout?(Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Bg(this.Za)).sWc(Ia.fk,qe.a.I3a(Ia.rW.qxa)):(new ph(this.Za,Ia.fk,qe.a.I3a(Ia.rW.qxa))).sWc(),K=new Ag,K.Bo=Ia.rW.qxa,K.fk=Ia.fk,this.Za.raiseEvent(la.a.k9f,K)):3!==Ia.Qp?Ia.Kof&&this.vXa.nRd():Ia.rW&&Ia.rW.qxa&&"hardcodedpreinstall"!==Ia.fk.storeType&&ub.a.CHj(Ia.displayName,
Ia.rW.qxa,Ia.fk.isAutoLaunched):3===Ia.Qp?Ia.fk&&"uploadfiledevcatalog"===Ia.fk.storeType.toLowerCase()?(Ia=this.vRb.lUh(Ia.fk.solutionId),ub.a.nUd(Ia?Ia:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.vXa.z4f():Ia.Kof&&this.vXa.nRd()}mBd(K=null){var Ia=K?K.fk:null;const Ab=new Ag;if(Ab.fk=Ia){var bc=this.vXa.Nia(Ia.storeType,Ia.solutionId,6===K.Qp?1:0);if(bc&&bc.Bo){Ab.Bo=bc.Bo;var vc=this.JMc?jh():null;vc=this.JMc&&Wg()&&!!Ia.solutionId&&!!vc&&Ia.solutionId.toLowerCase()===
vc.toLowerCase()&&2===K.Qp;if(3===K.Qp&&"hardcodedpreinstall"!==Ia.storeType||vc)K="",bc.Bo.EV&&bc.Bo.EV.Ks&&(bc=bc.Bo.EV.Ks.ma(0))&&(K=bc.id),Ia={["SDX_CommandPlacement"]:K,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)},ra.a.sendTelemetryEvent(Object.assign(new Nf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:$b.a.Li(Ia)}))}}this.Za.raiseEvent(la.a.Tre,
Ab)}}Object(d.a)(k,"LaunchAddinCommandsHandler",null,[861]);class J{}J.IUa="Alt";J.JUa="Command";J.id="Id";J.MUa="Image16by16";J.fRb="LabelText";J.NUa="Title";J.GROUP="Group";J.t3d="Groups";J.Xgb="Controls";J.button="Button";J.Caa="FlyoutAnchor";J.LARGE="Large";J.SMALL="Small";Object(d.a)(J,"AddinDataNodeConstants",null,[]);var ha=a(377);a(566);var Pa=a(561);a(146);class Db{constructor(K,Ia){this.tEa=this.Z6d=null;if(Ud.c(K)||Ud.c(Ia))throw r.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.Rug=Ia;this._id=K;this.QT[J.id]=this._id}get id(){return this._id||""}get QT(){return this.Z6d||(this.Z6d={})}get controlType(){return this.Rug||""}get menuItems(){return this.tEa||(this.tEa=new m.a)}}Object(d.a)(Db,"ControlDefinition",null,[496]);class Rb{constructor(K){this.gee=null;if(Ud.c(K))throw r.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=K;this.Cla[J.id]=this._id}get Cla(){return this.gee||(this.gee={})}get id(){return this._id||""}}Object(d.a)(Rb,"MenuItemDefinition",null,[495]);class ac{constructor(K){this.Fpa=null;if(Ud.c(K))throw r.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=K}get id(){return this._id}get controls(){return this.Fpa||(this.Fpa=new m.a)}}Object(d.a)(ac,"OfficeMenuDefinition",
null,[494]);var Bc=a(25);class Xc{constructor(K,Ia,Ab){this.AI=this.zVa=null;this.SPc=K;this.pVa=Ia;this.PUa=Ab;this.mAg=new m.a}get znc(){return this.SPc}get zrb(){return this.pVa}get wVc(){return this.PUa}addButton(K){r.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",K.actionType);this.AI=new Db(this.ssa(K.id),J.button);this.AI.QT[J.fRb]=K.label;this.AI.QT[J.IUa]=K.label;this.AI.QT[J.MUa]=K.icon["16"];this.Spb(this.AI.QT[J.id],K.action);this.QFa(this.AI.QT);this.zVa.controls.add(this.AI);
this.AI=null}startBuildMenu(K){if(Ud.c(this.zVa))this.zVa=new ac(K.id);else{const Ia=this.ssa(K.id);this.AI=new Db(Ia,J.Caa);this.v_a(this.AI.QT,K);this.AI.QT[J.MUa]=K.icon["16"];this.AI.QT[J.JUa]=Bc.a.alwaysEnabled}}addMenuItem(K){r.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",K.actionType);const Ia=new Rb(this.ssa(K.id));this.v_a(Ia.Cla,K);K.icon&&(Ia.Cla[J.MUa]=K.icon["16"]);this.Spb(Ia.Cla[J.id],K.action);this.QFa(Ia.Cla);this.AI.menuItems.add(Ia)}endBuildMenu(){Ud.c(this.AI)?
(this.Tmc.add(this.zVa),this.zVa=null):(this.zVa.controls.add(this.AI),this.AI=null)}get Tmc(){return this.mAg}Spb(K,Ia){this.wVc.bindAction(K,Ia)}QFa(K){this.zrb.QFa(K)}ssa(K){return this.znc.oKa(K)}v_a(K,Ia){K[J.fRb]=Ia.label;K[J.IUa]=Ia.label}}Object(d.a)(Xc,"ContextMenuExtensibilityCreator",null,[486,183]);class dd{constructor(K){this.Vkb=K}get PEb(){return this.Vkb}oKa(K){return this.PEb+K}}Object(d.a)(dd,"DefaultContextMenuNamingProvider",null,[487]);var yd=a(1335);class $d{bindAction(K,Ia){OfficeExt.DefaultControlActionBinder.bindAction(K,
Ia)}}Object(d.a)($d,"DefaultUIControlActionBinder",null,[184]);class oe{constructor(K){this.$Ca=K}get command(){return this.$Ca}QFa(K){K[J.JUa]=this.command}}Object(d.a)(oe,"DefaultUIControlCommandBinder",null,[181]);var Je=a(32);class Ce{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(Ce,"AddInControl",null,[]);class De{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(d.a)(De,"AddInGroup",null,[]);class Cf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(Cf,"AddInMenuItem",null,[]);class hf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(hf,"AddInTab",null,[]);class of{constructor(K,Ia,Ab,bc,vc,Tc){this.sRb=new m.a;this.jib=this.Yea=this.AVa=null;this.SPc=K;this.PUa=
Ia;this.pVa=Ab;this.ex=bc;this.vRb=vc;this.$8d=Tc}get znc(){return this.SPc}get Ks(){return this.sRb}get wVc(){return this.PUa}get zrb(){return this.pVa}startBuildTab(K){const Ia=K.isOfficeTab?K.id:this.znc.Z7e(K.id),Ab=K.isOfficeTab?null:K.label;this.AVa=Object.assign(new hf,{id:Ia,title:Ab,isOfficeTab:K.isOfficeTab,visible:K.visible,groups:[],tabType:K.tabType,insertBefore:K.insertBefore,insertAfter:K.insertAfter,autoFocus:K.autoFocus})}startBuildGroup(K){const Ia=this.ssa(K.id);this.Yea=Object.assign(new De,
{id:Ia,mlrId:K.mlrId,title:K.label,controls:[],groupType:0})}addNativeGroup(K){this.Yea=Object.assign(new De,{id:K.id,mlrId:K.mlrId,title:K.label,controls:[],groupType:1});this.AVa.groups.push(this.Yea)}addButton(K){const Ia=this.ssa(K.id);Ia&&(this.Spb(Ia,K.action),r.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new Ce,{id:Ia,title:K.label,iconLocation:this.Wgd(K),enabled:K.enabled,controlType:0,attributes:this.v_a()}),this.$8d.eoe(new Je.a(Ia,
this.zrb.command.toString())),this.Yea.controls.push(K))}addNativeControl(K){K.id&&(r.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new Ce,{id:K.id,title:"",iconLocation:"",enabled:K.enabled,controlType:2,attributes:this.v_a()}),this.Yea.controls.push(K))}startBuildMenu(K){const Ia=this.ssa(K.id);Ia&&(this.jib=Object.assign(new Ce,{id:Ia,title:K.label,iconLocation:this.Wgd(K),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(K){const Ia=
this.ssa(K.id);Ia&&(this.Spb(Ia,K.action),r.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",K.actionType),K=Object.assign(new Cf,{id:Ia,title:K.label,iconLocation:this.Wgd(K),enabled:K.enabled,attributes:this.v_a()}),this.$8d.eoe(new Je.a(Ia,this.zrb.command.toString())),this.jib.menuItems.push(K))}endBuildMenu(){Ud.c(this.jib.id)||this.Yea.controls.push(this.jib);this.jib=null}endBuildGroup(){Ud.c(this.Yea.id)||this.AVa.groups.push(this.Yea);this.Yea=null}endBuildTab(){Ud.c(this.AVa.id)||
this.sRb.add(this.AVa);this.AVa=null}v_a(){const K={};this.QFa(K);return K}Wgd(K){return K.icon["80"]?K.icon["80"]:K.icon["32"]}QFa(K){this.zrb.QFa(K)}ssa(K){return this.znc.oKa(K)}Spb(K,Ia){this.wVc.bindAction(K,Ia)}}Object(d.a)(of,"OneLineRibbonExtensibilityCreator",null,[182,183]);class nf{constructor(K,Ia){this.Vkb=K;this.PUa=new $d;this.pVa=new oe(Ia)}SXg(K){K=new dd(K);return new Xc(K,this.pVa,this.PUa)}IYg(K,Ia,Ab,bc){Ab=new yd.a(this.Vkb,K,Ab,!0);return new of(Ab,this.PUa,this.pVa,K,Ia,bc)}}
Object(d.a)(nf,"UIExtensibilityFactory",null,[156]);var $e=a(94),pf=a(880),Kf=a(22),Af=a(37),fg=a(68),Uf=a(50);class Gg{constructor(K){this.eGa=this.jGa=this.fk=this.Bo=null;this.TUf=0;this.CVi=()=>{if(this.fk&&this.eGa){const Ia=new $e.a(Bc.a.c2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ia,{["SourceControlId"]:this.eGa},null);r.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.DHj=(Ia,Ab)=>{Ia=null;if(Ab)if(Ia=Ab,this.fk=Ia.fk,(this.Bo=Ia.Bo)&&this.Bo.EV&&
this.Bo.EV.Ks&&(this.jGa=this.Bo.EV.Ks.ma(0)),this.jGa&&this.jGa.id)if(this.jGa.isOfficeTab)if(Ab=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ia=this.fk.solutionId,Ia in Ab?this.eGa=Ab[Ia]:(Ab=Gg.GetPrivacyCompliantId(this.fk),r.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Ab}`),this.eGa=this.$Nh(this.Bo)),this.eGa)if(Kf.a.contains(this.jGa.id,Bd.a.bW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(qe.a.I3a(this.Bo),
()=>{this.D$f(this.eid(this.eGa))});else{if(Ab=this.$.Ia)Ab.Kre(this.dJf),r.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else r.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Ab={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:$b.a.Li(Ab)})),this.y5();else this.F$f(this.eid(this.jGa.id),0);else r.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Ab={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ab)})),this.y5();
else this.y5()};this.dJf=()=>{if(Kf.a.contains(this.jGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ia=this.$.Ia;Ia&&Ia.SWf(this.dJf);this.D$f(this.eid(this.eGa))}};this.EVi=()=>{var Ia={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ia)}));this.y5();let Ab=
{};Ab[fg.a.Pf]=this.tC;Ia={};Ia.solutionId=this.tC.solutionId;Ia.assetId=this.tC.assetId;Ia.assetStoreId=this.tC.assetStoreId;Ia.height=0!=this.tC.height?this.tC.height:600;Ia.storeId=this.tC.storeId;Ia.storeType=this.tC.storeType;Ia.targetType=this.tC.targetType;Ia.width=0!=this.tC.width?this.tC.width:600;Ia.displayName=this.tC.displayName;Ia.version=this.tC.version;Ia.isAddinCommands=!1;Ab[la.a.z9]=Ia;let bc=new $e.a(-741808261,0,0,2,null);Af.TaskExtensions.za(Uf.GetServiceTaskFactory.Oa(this.$.da,
374,375,1),vc=>{vc=vc.result;null!=vc&&vc.insertAgave(Ab,bc)},this.$.la,3)};this.kPi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ia)}));this.y5()};this.HQi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ia)}));this.y5()};this.EN=Ia=>{r.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ia?Ia.httpStatus:-1}`)};this.$=K.$;this.addinUICommandHandler=K;this.appName=Ad.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.sPg=Ad.AFrameworkApplication.fa.vd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static KUa(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}qgj(K){this.tC=K;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.EVi,!0),window.addEventListener("DismissCallout",this.HQi,!0),window.addEventListener("CloseCallout",this.kPi,!0))}eid(K){return"[id="+K+"]"}F$f(K,
Ia){Ia>this.sPg?(window.clearTimeout(this.TUf),this.E$f("[data-unique-id='pivotOverflowButton']"),r.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+K)?this.E$f(K):this.TUf=window.setTimeout(()=>{this.F$f(K,Ia+1)},1E3)}D$f(K){var Ia=document.querySelector("button[data-unique-id='RightPaddle']");if(Ia)K={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));else if(Ia=document.querySelector("button"+K),!Ia||"none"===window.getComputedStyle(Ia).display)if(Ia=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ia){Ia={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(Ia)}));r.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.y5();return}this.cgg(Ia,"ShowTeachingUIForAddinButton")}E$f(K){K=document.querySelector("button"+K);if(!K&&(K=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!K)){K={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));r.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.y5();return}this.cgg(K,"ShowTeachingUIForAddinTab")}cgg(K,Ia){K.setAttribute("lpp-id","latestAddin");const Ab=qc.a.instance.Tb("Common.ISystemInitiatedFeedback");Ab&&K?(Ab.execute(bc=>{bc.logActivity(Ia,null)}),K={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)})),r.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(r.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Gg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)})),this.y5())}$Nh(K){if(!K)return null;K=K.EV;if((null===K||void 0===K?0:K.Ks)&&0<K.Ks.count)for(let Ia of K.Ks)if(Ia.groups&&0<Ia.groups.length)for(const Ab of Ia.groups)if(Ab.controls&&0<Ab.controls.length)for(const bc of Ab.controls){if(bc.attributes&&
0===bc.controlType&&bc.enabled)return bc.id;if(bc.menuItems)for(const vc of bc.menuItems)if(vc.attributes&&vc.enabled)return bc.id}return null}XJj(){var K=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(K&&"none"!==window.getComputedStyle(K).display)r.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{K=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==K){K={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)}));r.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.y5();return}r.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ia=qc.a.instance.Tb("Common.ISystemInitiatedFeedback");null==
Ia||null==K?(K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)})),r.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.y5()):(Ia.execute(Ab=>{Ab.logActivity("ShowTeachingUIForContentAddin",null)}),K={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Gg.KUa(this.tC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li(K)})),r.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}lAa(K){const Ia={},Ab={};Ab.LastTeachingUIShowTime=(new Date).toUTCString();Ab.AddinHasShown=K;Ia[this.appName]=Yf.c(Ab);this.Bob=new Eg(this.appName,null,null,
this.EN),this.Bob.W2a(Ia),r.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}y5(){if(!this.Eda){const K=window.g_roamingAddinList;K&&(this.lAa(K),this.Eda=!0)}}}Object(d.a)(Gg,"AddinTeachingCalloutHandler",null,[]);var Qh=a(1258),Yh=a(424),Eh=a(11),Zh=a(188),ei=a(43),Cg=a(21),Ug=a(55);class Zg{constructor(K,Ia,Ab,bc,vc,Tc,ad=null){this.disposed=!1;this.RNi=(md,Ed)=>{if(Ed)if(Ed)if(md=Ed.fk){if(Wg()||rg()){const Fe=
this.$.ea.workbookContext.WebExtensions;if(Fe){let Me=!1;for(var Xd of Fe)if(Xd.PrimaryMarketplace.SolutionId.toLowerCase()===md.solutionId.toLowerCase()){Me=!0;break}if(!Me){r.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{r.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Ed=Ed.Bo;Xd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(md.solutionId in Xd)Ed=Xd[md.solutionId];else if(Ed=
this.XRh(Ed),void 0===Ed||null===Ed){r.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Xd=new $e.a(Bc.a.c2,0,0,2,null);this.executeCommand(0,Xd,{["SourceControlId"]:Ed},null);md.isAutoLaunched=!0}else r.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else r.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else r.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.kff=(md,Ed)=>{"Insert"==Ed.tabName&&(md=this.$.Ia,null!=
md&&(md.SWf(this.kff),r.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.AOb.XJj())};this.DVi=(md,Ed)=>{md=null;Ed&&(md=Ed);(null===md||void 0===md?0:md.Bo)&&this.FAj(md.Bo);this.$.qf();C.EwaSettings.sa(86)&&md&&md.fk&&this.SUg(md.fk)};this.$=K;r.ULS.shipAssertTag(537170659,0,!(void 0===Ia||null===Ia),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${ei.a.X2()}`);this.Md=Ia;this.SFe=Ab;this.Z_b=bc;this.A9=vc;this.yob=Tc;this.Ko=new pf.a;
this.Mga=new pe;this.Gbd=ad;Jc.a.Zyb=Jc.a.LVe;this.Q7c=new m.a;this.Q1a=new m.a}dispose(){void 0!==this.yob&&null!==this.yob&&(this.yob.dispose(),this.yob=null);this.Md=this.$=null;this.disposed=!0}OEj(K,Ia){switch(K){case Bc.a.c2:K=this.yEj(Ia);break;default:K=!1}return K}Hc(){return!1}executeCommand(K,Ia,Ab){K=Af.TaskExtensions.Tj();Ia=Ia.command;switch(Ia){case 843847158:break;case -2025863019:ub.a.nUd(Ab[la.a.RXc].toString(),()=>{Cg.h(this.$).focus()});break;case -1777565636:Qh.a.showUILessDialog(Ab[la.a.Aob].toString());
this.Md.RHj(Ab[la.a.Aob].toString());break;case 1592314317:Qh.a.hideUILessDialog(Ab[la.a.Aob].toString());this.Md.eci(Ab[la.a.Aob].toString());break;case Bc.a.c2:K=this.hkd(Ab);break;case Bc.a.ZCb:this.$Cb(Ab);break;case Bc.a.nR:this.l$i(Ab);break;case Bc.a.dna:this.dna(Ab);break;case Bc.a.oUd:this.yob.Nzc();break;case Bc.a.refreshAddinCommands:this.jej();break;case 1949669462:this.A9.z4f(!0);break;case -1014260128:K=this.executeDynamicAddInCommandsAPI(Ab);break;case Bc.a.Mfb:this.Mfb();break;default:K=
Zh.a(Ia)}return K}wc(K,Ia){K=!1;switch(Ia.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Bc.a.nR:case Bc.a.dna:case Bc.a.oUd:case Bc.a.refreshAddinCommands:case 1949669462:case Bc.a.ZCb:case -1014260128:case Bc.a.Mfb:K=!0;break;case Bc.a.c2:K=!Ad.AFrameworkApplication.protectedFile}return K}Mc(){return!1}XRh(K){if(!K)return r.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((K=K.EV)&&K.Ks&&0<K.Ks.count)for(let Ia of K.Ks){if(Ia.groups&&
1===Ia.groups.length){K=Ia.groups[0];if(K.controls&&1===K.controls.length){const Ab=K.controls[0];if(Ab.attributes&&!Ab.controlType&&Ab.enabled)return Ab.id}K.controls&&r.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ia.groups&&r.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}l$i(K){K&&la.a.eP in K?this.nR(K[la.a.eP],!0):r.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}nR(K,Ia=!1){this.Md?(r.ULS.sendTraceTag(509686149,
220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",K,Ia),this.Md.nR(K,Ia)):r.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}jej(){if(this.A9.Blc()){this.A9.nCe();var K=this.Xed();if(K&&0<K.count)for(let Ia of K)K={[la.a.eP]:Ia,[la.a.OL]:4,[la.a.hGa]:(new Date).getTime()},this.dna(K)}else Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(r.ULS.sendTraceTag(509686148,
220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.A9.Blc()),this.nR(10,!0),this.nR(0,!0))}dna(K){r.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${K[la.a.OL]}, DataProvider ${K[la.a.eP]}.`);this.A9.Pwj();window.setTimeout(()=>{if(void 0===this.Md||null===this.Md)r.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${ei.a.X2()}`);
else{const Ia=new Ec(new ud(this.Md.Ng),Rd.instance,gf.instance);Ia.sLg((Ab,bc)=>{Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.nR(K[la.a.eP]);this.$Cb(bc.properties)});Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ia.NOg((Ab,bc)=>{null==bc?ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$b.a.Li({["AppTeachingUICalloutAction"]:"InvalidEventArgs",
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.AOb=new Gg(this),this.AOb.qgj(bc),Ab=this.$.Ia,null!=Ab&&(Ab.Kre(this.kff),r.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ia.FWj(K)}},0)}Mfb(){if(this.Ili)if(void 0===this.Md||null===this.Md)r.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const K=new vg(this.Md.Ng);K.mNg(()=>{this.Byi()});K.LZd()}}get Ili(){return!C.EwaSettings.sa(174)&&this.$.ea.wg.get(27)&&
this.$.rT}Byi(){const K=document.getElementById("InsertAddInFlyout");if(null===K||void 0===K||"none"===window.getComputedStyle(K).display){const Ia=document.getElementById("RibbonOverflowMenu-overflow");null!=Ia?(Ia.onclick=function(){const Ab=new Vc.a(0,1,500,()=>{const bc=document.getElementsByName("Add-ins")[0];null!=bc&&(bc.click(),r.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});Ad.AFrameworkApplication.hi.fg(Ab);Ia.onclick=function(){}},Ia.click()):r.ULS.sendTraceTag(509677591,
220,10,"Cannot find flyout button on ribbon or overflow button")}else K.click(),r.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}$Cb(K){if(!this.disposed){r.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${K[la.a.OL]}.`);try{if(C.EwaSettings.sa(174)){const Ab=K[la.a.vob];if(Ab&&0<Ab.count){const bc=Ab.count;for(let vc=bc-1;0<=vc;vc--){const Tc=Ab.ma(vc);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||Ab.remove(Ab.ma(vc))}if(Ab.count<bc){const vc=Uf.GetServiceTaskFactory.Oa(this.$.da,
5,4,0);Af.TaskExtensions.za(vc,()=>{vc.result.ih(36,null)},this.$.la,3)}if(!Ab.count)return}}if(void 0===this.Md||null===this.Md)r.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${ei.a.X2()}`);else{var Ia=null;Ia=Ad.AFrameworkApplication.fa.pa("HostInstallAddInsIsEnabled")?new k(this.Ko,this.SFe,new ud(this.Md.Ng),new nf(this.$.Bb,Bc.a.c2),this.A9,Rd.instance,this.Mga,(Ab,bc)=>{const vc={};vc.InstanceId=Gd.a.create().toString();vc.PrimaryMarketplace=
{};vc.PrimaryMarketplace.SolutionId=Ab.solutionId;vc.PrimaryMarketplace.SolutionVersion=Ab.version;vc.PrimaryMarketplace.MarketplaceType=Ab.storeType;vc.PrimaryMarketplace.MarketplaceRef=Ab.storeId;vc.WebExtensionType=1;this.Md.cKj(vc,()=>{bc(Ab)})}):new k(this.Ko,this.SFe,new ud(this.Md.Ng),new nf(this.$.Bb,Bc.a.c2),this.A9,Rd.instance,this.Mga);Ia.ALg(this.RNi);Ia.tLg(this.DVi);if(Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Ab=new Gg(this);Ia.lNg(Ab.CVi);Ia.MOg(Ab.DHj)}this.$.da.Aa(53).lp&&de.a.get_instance().Lj(5,null).continueWith(()=>{this.disposed||Ia.Pyi(this.Gbd,this.$.domElement,K)})}}catch(Ab){r.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Ab.message}.`)}}}hkd(K){const Ia=Af.TaskExtensions.Tj();K=K[this.Ko.Pha];const Ab=this.Z_b.xVc(K),bc=new Qh.a(this.$,this.Md,Ab.ownerAddinInfo,Ia);return this.O9e(Ia,K,Ab,bc)}O9e(K,Ia,Ab,bc){this.Z_b.hkd(Ia,this.A9,bc,new ud(this.Md.Ng),
Ab,()=>{K=bc.g9g()},()=>{Cg.h(this.$).focus()});return K}SUg(K){const Ia=Af.TaskExtensions.Tj();var Ab=this.Md.yaa(K.solutionId);if(Ab){var bc=this.Md.cZ(Ab);if(Eh.HelperMethods.lw(bc)&&0!==bc.SharedRuntime.State)return}bc=this.Z_b.TUg;const vc=K.solutionId in bc?bc[K.solutionId]:null;if(vc){const Tc=this.Z_b.xVc(vc),ad=new Qh.a(this.$,this.Md,Tc.ownerAddinInfo,Ia),md=Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,null!==Tc.ownerAddinInfo?Tc.ownerAddinInfo.storeType:K.storeType,K.assetId,
null,null,K.storeId);bc=Ed=>{if(Ed){const Xd={};for(const Fe of Ed)Xd[Fe[0]]=Fe[1];(Ed=la.a.Sre in Xd?Xd[la.a.Sre]:null)&&"true"===Ed.toLowerCase()&&(r.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${md}.`),this.O9e(Ia,vc,Tc,ad))}};r.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${md}.`);if(Ab)bc(this.Md.cZ(Ab).OsfPropertyBag);else if(Ab=
this.$.ea.workbookContext.WebExtensions)for(const Ed of Ab)if((1===Ed.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===K.targetType&&Ed.PrimaryMarketplace.MarketplaceType.toLowerCase()===K.storeType.toLowerCase()&&Ed.PrimaryMarketplace.MarketplaceRef.toLowerCase()===K.storeId.toLowerCase()&&Ed.PrimaryMarketplace.SolutionId.toLowerCase()===K.solutionId.toLowerCase()){bc(Ed.OsfPropertyBag);break}}}KXd(K,Ia,Ab=!1){K&&(!Ab||Ia||this.Q7c.contains(K)||this.Q7c.add(K),(Ab=
this.Q1a.contains(K))&&Ia&&this.Q1a.remove(K),Ab||Ia||this.Q1a.add(K))}FAj(K){if((K=K.EV)&&K.Ks)for(let Ia of K.Ks)if(Ia.groups)for(const Ab of Ia.groups)if(Ab.controls)for(const bc of Ab.controls)if(this.KXd(bc.id,bc.enabled,!0),1===bc.controlType&&bc.menuItems)for(const vc of bc.menuItems)this.KXd(vc.id,vc.enabled,!0)}Xed(){const K=new m.a;C.EwaSettings.sa(52)&&(this.$.ea.wg.get(27)&&(K.add(0),K.add(16)),this.$.ea.wg.get(33)&&K.add(1),K.add(8));return K}executeDynamicAddInCommandsAPI(K){let Ia=
!0;if(void 0===K||null===K||void 0===K[la.a.Wtb]||null===K[la.a.Wtb])return Ug.Task.Ra(!1);switch(K[la.a.Wtb]){case 1:Ia=this.PZj(K);break;case 2:Ia=this.JAj(K);break;case 4:this.Q1a.clear();this.Q1a.addRange(this.Q7c);break;case 3:Ia=this.installContextualTab(K);break;default:Ia=!1}return Ug.Task.Ra(Ia)}yEj(K){return K&&this.Ko.Pha in K?(K=K[this.Ko.Pha])?this.Q1a.contains(K):!1:!1}PZj(K){var Ia=null;let Ab=null,bc=null,vc=!0;void 0!==K[la.a.p3]&&null!==K[la.a.p3]&&void 0!==K[this.Ko.Pha]&&null!==
K[this.Ko.Pha]&&void 0!==K[la.a.o3]&&null!==K[la.a.o3]&&(Ia=K[la.a.p3],Ab=K[la.a.C8b],bc=K[this.Ko.Pha],vc=K[la.a.o3]);if(!Ia||!bc)return r.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;K=(new yd.a(this.$.Bb,Ia,this.Ko,!0)).oKa(bc);Ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ia.AssetId=Ab;Ia.MaskedTabId=K;Ia.IsToEnable=vc;r.ULS.sendTraceTag(537170648,220,50,A.a.Dc(Ia));this.KXd(K,vc);Yh.a.SI.updateCommandUI();return!0}JAj(K){var Ia,
Ab,bc=null,vc=null;let Tc=null;var ad=null;let md=!0;void 0!==K[la.a.n9c]&&null!==K[la.a.n9c]&&void 0!==K[la.a.p3]&&null!==K[la.a.p3]&&void 0!==K[this.Ko.Pha]&&null!==K[this.Ko.Pha]&&void 0!==K[la.a.o3]&&null!==K[la.a.o3]&&(bc=K[la.a.n9c],vc=K[la.a.p3],Tc=K[la.a.C8b],ad=K[this.Ko.Pha],md=K[la.a.o3]);if(!bc||!vc||!ad)return r.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;K=(new yd.a(this.$.Bb,vc,this.Ko,!0)).Z7e(ad);ad={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
ad.StoreType=bc;ad.AssetId=Tc;ad.MaskedTabId=K;ad.IsToShow=md;r.ULS.sendTraceTag(537170646,220,15,A.a.Dc(ad));bc=this.A9.Nia(bc,vc,1);vc=!1;if(null===(Ab=null===(Ia=null===bc||void 0===bc?void 0:bc.Bo)||void 0===Ia?void 0:Ia.EV)||void 0===Ab?0:Ab.Ks)for(let Ed of bc.Bo.EV.Ks)if(Ed.id===K){vc=!0;break}if(!vc)return r.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ia=[];md?appChrome.selectors.getSelectedTabId()!==K&&Ia.push(appChrome.actions.activateRibbonTab(K)):
(appChrome.selectors.getSelectedTabId()===K&&Ia.push(appChrome.actions.setCurrentTab(Bd.a.bW)),Ia.push(appChrome.actions.deactivateRibbonTab(K)));appChrome.api.dispatch(Ia);return!0}installContextualTab(K){let Ia=null,Ab=null,bc=null;var vc=null;if(void 0!==K[la.a.p3]&&null!==K[la.a.p3]&&void 0!==K[la.a.o3]&&null!==K[la.a.o3]){const Tc=K[la.a.o3];Ia=K[la.a.p3];void 0!==Tc[la.a.UIa]&&null!==Tc[la.a.UIa]&&void 0!==Tc[la.a.VIa]&&null!==Tc[la.a.VIa]&&(Ab=Tc[la.a.UIa],bc=Tc[la.a.VIa],vc=Tc[la.a.o9c])}if(!(Ia&&
bc&&Ab&&vc))return r.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;K=this.A9.Nia(vc.PrimaryMarketplace.MarketplaceType,vc.PrimaryMarketplace.SolutionId,1);if(null===K||void 0===K?0:K.Bo)return r.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;K={};K.solutionId=vc.PrimaryMarketplace.SolutionId;K.version=vc.PrimaryMarketplace.SolutionVersion;K.storeType=vc.PrimaryMarketplace.MarketplaceType;K.storeId=vc.PrimaryMarketplace.MarketplaceRef;
vc.AssetMarketplace?(K.assetId=vc.AssetMarketplace.SolutionId,K.assetStoreId=vc.AssetMarketplace.MarketplaceRef):(K.assetId=null,K.assetStoreId=null);K.targetType=vc.WebExtensionOsfControlType;K.width=vc.TaskpaneWidth;K.height=0;K.isAddinCommands=!0;vc=new m.a;vc.add(K);K={};K[la.a.vob]=vc;K[la.a.OL]=6;K[la.a.UIa]=Ab;K[la.a.VIa]=bc;this.$Cb(K);return!0}}Object(d.a)(Zg,"AddinUICommandHandler",null,[582,221,2]);var vi=a(69),wi=a(605),Bh=a(18),Ni=a(16);class lh extends gd.a{constructor(K){super(K);this.handler=
null;this.kHg=()=>{r.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.qd&16384)}]`);const Ia=new Ic.a;this.$.da.gb(53,Xd=>{r.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Ia.setResult(Xd)});const Ab=Ia.task,bc=new kd,vc=Md.a.getInstance(),Tc=new zc(this.$,vc),ad=Uf.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Xa),md=this.Rej(bc),
Ed=Uf.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Xa);return Af.TaskExtensions.za(Af.TaskExtensions.Fd([Ab,ad,md,Ed],this.la),()=>{r.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Xa),Xd=>{this.handler=new Zg(this.$,Xd.result,bc,new Pb,vc,Tc,qc.a.instance.mg("Common.IExternalUICommandDefinitionMapping"));r.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.$c([this.handler]);this.$.da.Ha(198,this.handler)},this.la,3)},this.la,3)};this.qjh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Zbb(this.handler),this.$.da.eU(198),this.handler=null):r.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.eU(204);Ni.a(Bh.a,20,this.$.da,198)}}hd(){r.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");vi.a(this.$).add(Object(xc.a)(new wi.a,
{Wyc:()=>{const K=this.$.ea.wH&&this.$.ea.Xb&&!!(this.$.qd&16384)&&this.$.isEditMode;this.$.ea.Xb&&r.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${K}] IsSessionFullyLoaded [${this.$.ea.wH}] IsSessionActive [${this.$.ea.Xb}] ShowCommandUI [${!!(this.$.qd&16384)}] IsEditMode [${this.$.isEditMode}]`);return K},nZb:this.kHg,T6b:this.qjh,b3a:2}))}Rej(K){const Ia=Uf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);
return Af.TaskExtensions.za(Ia,()=>{r.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ha(204,new ke(Ia.result,K))},this.la,3)}static ka(K){gd.a.Ld(199,new lh(K))}}Object(d.a)(lh,"AddinUICommandHandlerFactory",gd.a,[]);var Oi=a(1215),xi=a(1218),Wc=a(712),Ld=a(204),$g=a(186),Wi=a(105);class $h extends h.a{constructor(K){super();this.$=K;this.Db()}create(){let K;if(C.EwaSettings.sa(355)){const Ia=Uf.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.Xa);let Ab;Ab=C.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")?Object(Ld.c)($g.a.resolve(Wi.i)):Uf.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Xa);Af.TaskExtensions.za(Ug.Task.ZF(Ia,Ab),()=>{this.nb(Object(Wc.a)(this.$.da,278,()=>new Oi.CustomFunctionsInstaller(this.$,Ia.result,Ab.result)))},this.$.la,3)}else K=Object(Wc.a)(this.$.da,278,()=>new xi.CustomFunctionsLegacyInstaller(this.$)),this.nb(K)}static ka(K){K.da.Ha(279,new $h(K))}}Object(d.a)($h,
"CustomFunctionsInstallerFactory",h.a,[]);var fi=a(89),Xi=a(48),gi=a(44);class Pi{constructor(K,Ia){this.dQa=this.eQa=null;this.fgg=(Ab,bc)=>{let vc=null,Tc=null,ad=null;bc?(Object(Y.a)(506,bc)?(vc=bc.oGa,ad=bc.instanceId):Object(Y.a)(370,bc)&&(vc=bc.get_element(),ad=bc.instanceId),vc)?(Tc=Object(U.a)(524,Ab),Tc)?this.rSf(ad,vc,Tc)||ad in this.dQa||(this.eQa[ad]=0,this.dQa[ad]=Xi.a.instance.wC(()=>{10<=this.eQa[ad]||this.rSf(ad,vc,Tc)?(delete this.eQa[ad],this.dQa[ad].dispose(),delete this.dQa[ad]):
this.eQa[ad]+=1},500,gi.a.eQg,!0,!1)):r.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):r.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):r.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=K;this.$=Ia;this.EZc=!1;this.$.da.Ha(224,this)}ka(K){this.EZc?r.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.EZc=!0,this.dQa={},this.eQa={},K?K.eMg(this.fgg):r.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(K){if(K){K.$ij(this.fgg);K=this.dQa;for(let Ia in K)fi.a.Ja(K[Ia]);this.eQa=this.dQa=null;this.EZc=!1}else r.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}rSf(K,Ia,Ab){if(this.lli(Ab,K))return!1;K=Ia.querySelector("iframe");if(!K)return r.ULS.sendTraceTag(537170595,0,10,
"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;K=K.title;if(!K||!K.length)return r.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(K);return!0}lli(K,Ia){return(K=K.Ng.getOsfControl(Ia))?K.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(Pi,"AgaveOnSelectedReadoutHandler",null,[525]);class hi extends h.a{constructor(K){super();this.$=K;this.Db()}create(){const K=
this.$.da;Af.TaskExtensions.za(Uf.GetServiceTaskFactory.Oa(K,211,212,this.Xa),Ia=>{Ia=K.Aa(224)||new Pi(Ia.result,this.$);this.nb(Ia)},this.la,3)}static ka(K){K.da.Ha(225,new hi(K))}}Object(d.a)(hi,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var yg=a(748),ii=a(51);const Qi=(K,Ia)=>ii.a.fwd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Ad.AFrameworkApplication.fa.vd("MaxRetriesForLoadingScript",0),K,Ia);var Yi=a(242);class Jh{constructor(K,Ia,Ab){this.iframe=K;this.onSuccess=
Ia;this.onError=Ab;$addHandler(window,"message",Object(Kd.a)(this,this.X$e,"handleResponse"))}X$e(K){try{if(K&&K.rawEvent&&K.rawEvent.origin&&this.iframe&&this.iframe.id){var Ia=this.LLf(K.rawEvent.origin);const Ab=this.LLf(document.domain);if(N.a.Ni().equals(Ab,Ia))if(K.rawEvent.source&&K.rawEvent.source.frameElement&&K.rawEvent.source.frameElement.id&&N.a.Ni().equals(K.rawEvent.source.frameElement.id,this.iframe.id)){Ia=null;try{Ia=JSON.parse(K.rawEvent.data)}catch(bc){r.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",bc.message)}Ia?(Ia.statusCode!==Yi.a.EO||void 0!==Ia.error&&Ia.error?(r.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ia.statusCode,Ia.error),this.onError()):(r.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ia.authorizationCode?Ia.authorizationCode:
Ia.signInUrl)),$removeHandler(window,"message",Object(Kd.a)(this,this.X$e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):r.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):r.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):r.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else r.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else r.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else r.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ab){r.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ab.message)}}LLf(K){let Ia="";try{K&&(Ia=-1<K.indexOf("//")?K.split("/")[2]:K.split("/")[0])&&(Ia=Ia.split(":")[0],Ia=Ia.split("?")[0])}catch(Ab){r.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ab.message)}return Ia}static ka(K,Ia,Ab){new Jh(K,Ia,Ab)}}Object(d.a)(Jh,"ResponseHandler",null,[]);var ji=a(256);class ah{constructor(K){this.CFa=K}tryAuthenticate(K,Ia){this.zab(ah.Uxg,()=>{K()},Ia)}tryAuthorize(K,Ia){this.zab(ah.atg,K,Ia)}getSignInUrl(K,Ia){this.zab(ah.fke,K,Ia)}signOut(K,Ia){this.zab(ah.XDg,K,Ia)}zab(K,Ia,Ab){var bc=new ji.QueryStringBuilder("AuthenticationProxyHandler.aspx");bc.$i("responseType",K);Ad.AFrameworkApplication.EYa(bc);
bc=String.format("{0}{1}&{2}",this.CFa,bc.toString(),Ad.AFrameworkApplication.ti);const vc=document.createElement("iframe");vc.setAttribute("id","privateCatalogIframe");vc.setAttribute("name","privateCatalogIframe");vc.setAttribute("style","display: none");N.a.Ni().equals(K,ah.fke)||vc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Jh.ka(vc,Ia,Ab);vc.setAttribute("src",bc);document.body.appendChild(vc)}}ah.atg="authcode";ah.Uxg="identitytoken";
ah.fke="signinurl";ah.XDg="signout";Object(d.a)(ah,"AuthenticationProxy",null,[]);class Gf{}Gf.getUserId="getUserId";Gf.getLastStoreUpdate="laststoreupdate";Gf.getEntitlement="getEntitlements";Gf.getEToken="getEToken";Gf.getManifest="getManifest";Gf.getAppState="getAppState";Gf.getKilledApps="getRemovedAddins";Gf.getAppDetails="getAppDetails";Gf.removeApps="removeAddin";Gf.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Gf.getPrivateCatalogAddIns="getAddIns";Gf.getPrivateCatalogManifests=
"getAppManifests";Gf.isStoreDisabled="isStoreDisabled";Object(d.a)(Gf,"S2SWebRequestActions",null,[]);var Kh=a(575);class Rh{getUserId(K,Ia){const Ab=new m.a;Ab.add(new Be.a("corr",K));this.xW(Gf.getUserId,Ab,1,Ia)}getLastStoreUpdate(K,Ia,Ab){const bc=new m.a;bc.add(new Be.a("lc",K));bc.add(new Be.a("corr",Ia));this.xW(Gf.getLastStoreUpdate,bc,1,Ab)}getEntitlement(K,Ia,Ab,bc){K=new m.a;K.add(new Be.a("av",Ia));K.add(new Be.a("corr",Ab));this.xW(Gf.getEntitlement,K,1,bc)}getEToken(K,Ia,Ab,bc,vc,Tc){const ad=
new m.a;ad.add(new Be.a("cmu",K));ad.add(new Be.a("cmf",Ia));ad.add(new Be.a("assetid",Ab));ad.add(new Be.a("expver",bc));ad.add(new Be.a("corr",vc));this.xW(Gf.getEToken,ad,1,Tc)}getManifest(K,Ia,Ab,bc){const vc=new m.a;vc.add(new Be.a("cmu",K));vc.add(new Be.a("assetid",Ia));vc.add(new Be.a("corr",Ab));this.xW(Gf.getManifest,vc,1,bc)}getAppState(K,Ia,Ab){const bc=new m.a;bc.add(new Be.a("ma",K));bc.add(new Be.a("corr",Ia));this.xW(Gf.getAppState,bc,1,Ab)}getKilledApps(K,Ia){const Ab=new m.a;Ab.add(new Be.a("corr",
K));this.xW(Gf.getKilledApps,Ab,1,Ia)}getAppDetails(K,Ia,Ab,bc){const vc=new m.a;vc.add(new Be.a("cmo",K));vc.add(new Be.a("corr",Ab));this.sendWithBody(Gf.getAppDetails,vc,Ia,2,bc,!1)}removeApps(K,Ia,Ab){const bc=new m.a;bc.add(new Be.a("corr",Ia));this.sendWithBody(Gf.removeApps,bc,K,2,Ab,!1)}getLastPrivateCatalogUpdate(K,Ia,Ab,bc,vc,Tc){const ad=new m.a;ad.add(new Be.a("catalog","privatecatalog"));ad.add(new Be.a("clientCode",K));ad.add(new Be.a("clientVersion",Ia));ad.add(new Be.a("corr",vc));
K=String.format("authorizationCode={0}&refreshToken={1}",Ab?Lf.a.hf(Ab):"",bc?Lf.a.hf(bc):"");this.sendWithBody(Gf.getLastPrivateCatalogUpdate,ad,K,2,Tc,!0)}getPrivateCatalogAddIns(K,Ia,Ab,bc,vc,Tc){const ad=new m.a;ad.add(new Be.a("catalog","privatecatalog"));ad.add(new Be.a("clientCode",K));ad.add(new Be.a("clientVersion",Ia));ad.add(new Be.a("corr",vc));K=String.format("authorizationCode={0}&refreshToken={1}",Ab?Lf.a.hf(Ab):"",bc?Lf.a.hf(bc):"");this.sendWithBody(Gf.getPrivateCatalogAddIns,ad,
K,2,Tc,!0)}getPrivateCatalogManifests(K,Ia,Ab,bc,vc){const Tc=new m.a;Tc.add(new Be.a("catalog","privatecatalog"));Tc.add(new Be.a("corr",bc));K=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Lf.a.hf(K),Ia?Lf.a.hf(Ia):"",Ab?Lf.a.hf(Ab):"");this.sendWithBody(Gf.getPrivateCatalogManifests,Tc,K,2,vc,!0)}isStoreDisabled(K,Ia){const Ab=new m.a;Ab.add(new Be.a("corr",K));this.xW(Gf.isStoreDisabled,Ab,2,Ia)}xW(K,Ia,Ab,bc){this.sendWithBody(K,Ia,null,Ab,bc,!1)}sendWithBody(K,Ia,Ab,
bc,vc,Tc){const ad=new ji.QueryStringBuilder("AddinServiceHandler.ashx");ad.$i("action",K);ad.$i("app",Kh.a[Ad.AFrameworkApplication.ra.Qa.Oj]);for(let md of Ia)ad.$i(md.key,md.value);Ia=String.format("{0}{1}&{2}",Ad.AFrameworkApplication.ra.Qa.o_,ad.toString(),Ad.AFrameworkApplication.ti);Ad.AFrameworkApplication.Bd.Im(Ia,bc,Ab,null,!1,2,md=>{let Ed=null,Xd=null;md&&md.data&&(md.data.responseHeaders["X-BlockedForMinor"]&&"1"===md.data.responseHeaders["X-BlockedForMinor"].toString()&&(md.data.httpStatus=
451),Ed=md.data.de,Xd=md.data.responseHeaders);vc(md.data.httpStatus,Ed,Xd)},md=>{var Ed=null;let Xd=null;Tc&&md&&md.data&&md.data.de&&(Ed=md.data.de,Xd=md.data.responseHeaders);vc(md.data.httpStatus,Ed,Xd);if(Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Ed={message:"AddinServiceHandler request failed"};Ed.code=md.data.httpStatus;Ed.action=K;if(md.data.request||md.data.request.get_headers())Ed["X-UserSessionId"]=md.data.request.get_headers()["X-UserSessionId"];
408===md.data.httpStatus||503===md.data.httpStatus?r.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Ed)):r.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ed))}else r.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",md.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+K,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(Rh,"S2SWebRequestManager",null,[]);class sh extends h.a{constructor(K){super();this.qSf=this.ddaFacade=null;this.$=K;K.da.Ha(106,this);
this.Db()}get Md(){return this.ddaFacade||(this.ddaFacade=new yg.DdaFacade(this.$,this.qSf))}create(){r.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Ad.AFrameworkApplication.disableWholeAppsForOfficeFeature?r.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Ad.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):C.EwaSettings.sa(359)?qc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(K=>
{K.isFeatureEnabled("mso_officeStore",!0).then(Ia=>{yg.DdaFacade.b5b=Ia;this.YHe();return null})}):this.YHe()}YHe(){const K=Uf.GetServiceTaskFactory.Oa(this.$.da,224,225,this.Xa),Ia=ii.a.fwd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.Xa,106),Ab=Qi(this.la,this.Xa);Af.TaskExtensions.za(Af.TaskExtensions.Fd([K,Ia,Ab],this.$.la),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?r.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${ei.a.X2()}`):
this.Jfi();r.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.qSf=K.result;this.nb(this.Md);r.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}Jfi(){C.EwaSettings.sa(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Rh);this.$.Xd.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Rh,new ah(Ad.AFrameworkApplication.fa.appSettings.WebServiceBase),C.EwaSettings.sa(70),C.EwaSettings.sa(378));
OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Rh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Rh)}dispose(){fi.a.Ja(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(K){new sh(K)}}Object(d.a)(sh,"DdaFacadeServiceFactory",h.a,[]);var Sh=a(33),Th=a(461);class wh{constructor(K,Ia,Ab,bc,vc,Tc){this.$=K;this.agaveCommandManager=Tc}Mc(K,Ia,Ab){switch(Ia){case "PopulateAddInGallery":return 32===
Ad.AFrameworkApplication.rb.Wd(Bc.a.WMf,2,Ab);default:return!1}}Hc(){return!1}wc(K,Ia,Ab,bc){let vc=!1;switch(Ia.command){case Bc.a.dlc:vc=!!Ab;break;case Bc.a.ilc:vc=!!Ab;break;case -684355545:vc=!0;break;case -741808261:vc=!!Ab;break;case -859308420:vc=!!bc&&1===bc.wx;break;case 418618014:vc=1===K&&!!bc&&1===bc.wx;break;case -167264441:vc=Sh.a.kif(this.$)&&1===K&&!!bc&&1===bc.wx;break;case -515602470:Ia=C.EwaSettings.sa(217)&&2===K;vc=(1===K||Ia)&&!!bc&&1===bc.wx;break;case 2086613372:vc=C.EwaSettings.sa(217)&&
2===K&&!!bc&&1===bc.wx;break;case -1336341324:vc=C.EwaSettings.sa(417)&&1===K&&!!bc&&1===bc.wx;break;case 451940422:vc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===K&&!!bc&&1===bc.wx;break;case -1444574190:case -336193495:vc=1===K&&!!bc&&1===bc.wx;break;case 1296389134:vc=1===K&&!!bc&&1===bc.wx;break;case -1473679467:vc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===K&&!!bc&&1===bc.wx;
break;case 1221897806:vc=C.EwaSettings.sa(155)&&2===K;break;case 1172793074:case 1930653487:vc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===K;break;case -1753056834:vc=!0;break;case 932597253:vc=!0;break;case 301511274:vc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:vc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:vc=
this.$.isEditMode&&this.$.ea.FMb}return vc}executeCommand(K,Ia,Ab){let bc=Af.TaskExtensions.Tj();const vc=Ia.command;switch(Ia.command){case -1473679467:Th.a(this.$,488,489,1,Tc=>{bc=Tc.Iii(Ab.SourceControlId,Ia)});break;case Bc.a.dlc:this.agaveCommandManager.D9h(Ab.SourceControlId);break;case Bc.a.ilc:this.agaveCommandManager.F9h(Ab.SourceControlId);break;case 1296389134:this.agaveCommandManager.bNj(Ab.SourceControlId,Ab.LabelText);break;case -684355545:this.agaveCommandManager.T0c();break;case -741808261:bc=
this.agaveCommandManager.insertAgave(Ab,Ia);Th.a(this.$,488,489,1,Tc=>{Tc.LHg(Ab)});break;case -1336341324:C.EwaSettings.sa(417)&&(bc=this.agaveCommandManager.vkd(Ab,K,Ia));break;case 1172793074:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(bc=this.agaveCommandManager.vkd(Ab,K,Ia));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:bc=
this.agaveCommandManager.vkd(Ab,K,Ia);break;default:bc=Zh.a(vc)}return bc}}Object(d.a)(wh,"AgaveCommandHandler",null,[221]);class ki{}Object(d.a)(ki,"Selection",null,[]);var kf=a(1340),Fh=a(1339),bh=a(1341),dg=a(1420),Sg=a(1336);class li{}Object(d.a)(li,"SmartLookupApplicationInterface",null,[]);class ai{}Object(d.a)(ai,"ApplicationProperties",null,[]);class mi{}Object(d.a)(mi,"EnterpriseUserInfo",null,[]);class ni{}Object(d.a)(ni,"FeatureGates",null,[]);class oi{constructor(K,Ia,Ab=!0){this.gTj=
9E5;this.jTj=3E5;this.Lxd=null;this.jtf="";this.Ixd=0;this.gtb=Date.now;this.Pxa=K;this.i9a=Ia;Ab&&this.Ued()}n3h(){const K=this.gtb();if(K<this.Ixd+this.gTj)return K>this.Ixd+this.jTj&&this.Ued(),this.jtf;this.Ued();return""}Ued(){this.Lxd=this.Lxd||new Promise(K=>{this.o3h().then(Ia=>{this.jtf=Ia;this.Ixd=this.gtb();this.Lxd=null;K(Ia)})})}o3h(){return this.i9a&&this.i9a.length?new Promise(K=>{this.Pxa.wO("SmartLookup",this.i9a).then(Ia=>{Ia.IsSuccess?Ia.Token||(K(""),r.ULS.sendTraceTag(51446545,
1313,15,"SmartLookupManager - The AAD token is empty")):(r.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Ia.ErrorCode+": "+Ia.ErrorMessage),K(""));K(Ia.Token)}).catch(Ia=>{Ia=Yf.c(Ia);r.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ia);K("")})}):(r.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(oi,"SmartLookupAuthenticationManager",
null,[568]);class Uh{static eUh(){switch(Object(U.a)(String,Ad.AFrameworkApplication.Rb.AudienceGroup)||""){case "Dogfood":if(Ad.AFrameworkApplication.fa){let K=Ad.AFrameworkApplication.fa.Wa("UserPrincipalName");K=Lf.a.Yk(K);const Ia=Ad.AFrameworkApplication.fa.Ep("SmartLookupINTEnabledForSKITeam")?Ad.AFrameworkApplication.fa.hw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ia,K)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static O2h(){switch(Ad.AFrameworkApplication.fa.pa("IntentSvcEnableEdogSourceLocationOverride")?
"EDOG":Ad.AFrameworkApplication.fa.pa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Ad.AFrameworkApplication.fa.pa("IntentSvcEnableIntSourceLocationOverride")?"INT":Uh.eUh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(Uh,"Utils",null,[]);var yi=a(557),Lh=
a(174);class Vh{constructor(K){r.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Qtf=Ad.AFrameworkApplication.fa.pa("IsTellMeUpSellEnterpriseEnabled");this.BEi=Ad.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.i9a=Ad.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");this.fFi=wg.a.LJ(Ad.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.h9a=new ni;this.h9a.EnableAllTabV2=!0;this.h9a.EnableIntentService=!0;this.h9a.EnableInDocumentSearch=
Ad.AFrameworkApplication.fa.pa("SmartLookupEnableInDocumentSearch");this.h9a.EnableLocalSearch=Ad.AFrameworkApplication.fa.pa("SmartLookupEnableLocalSearch");this.h9a.IntentServiceEndpoint=Uh.O2h();this.aFi=new oi(K,this.i9a)}get approvedOriginPattern(){return this.BEi}GOh(){return Promise.resolve(this.HOh())}HOh(){const K=new ai;K.anid="";K.applicationVersion=Ad.AFrameworkApplication.buildVersion;K.appCorrelationId=Lh.a.create().toString();K.themePlatform=Vh.z5j;K.lcid=Ad.AFrameworkApplication.lcid;
K.launchUtcTime=(new Date).toUTCString();K.featureGates=this.h9a;var Ia=yi.a.IJ(Ad.AFrameworkApplication.lcid);Ia=Ia?Ia.name:null;K.market=this.Pbc(Ia);K.uiLanguage=Ia;K.sessionId=Ad.AFrameworkApplication.userSessionId;K.themeId=0;K.parentalControl=Vh.q3i;const Ab=new mi;Ab.CountryCode=this.Pbc(Ia);Ab.ServiceEndpoint=this.i9a;Ab.IsGoLocal=!1;Ab.IsEnabled=this.Qtf;Ab.IsEnterpriseEnabled=this.Qtf;Ab.TenantRoot=this.fFi;K.enterpriseUserInfo=Ab;K.accessToken=this.aFi.n3h();return K}Pbc(K){K=K.split("-");
return K[K.length-1]}}Vh.z5j="web";Vh.q3i="yes";Object(d.a)(Vh,"SmartLookupManager",null,[557]);class Gh extends Aa.a{constructor(K){super();this.$=K;this.isFirstLaunch=!1}Mc(){return!1}Hc(){return!1}wc(K,Ia){K=C.EwaSettings.sa(127);return-983891024===Ia.command&&K}executeCommand(K,Ia){K=Af.TaskExtensions.Tj();-983891024===Ia.command&&this.wyi();return K}wyi(){var K=new Vh(null);const Ia={};var Ab=Cg.h(this.$).Qb(null).originalText;Ab=Object(xc.a)(new ki,{neighborhood:Ab,mentionStart:0,mentionLength:Ab?
Ab.length:0});const bc=Object(xc.a)(new li,{selection:Ab,entryPoint:0});K.GOh().then(Tc=>{Tc.applicationName=Gh.appName;Tc.isFirstLaunch=this.isFirstLaunch;Tc.themeId=5;Ia[Gh.smartLookupApplicationInterface]=JSON.stringify(bc);Ia[Gh.xRg]=JSON.stringify(Tc);this.isFirstLaunch=!1});K=new kf.a("ExcelOnline","Web","en-Us");Ab=new Fh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const vc=new bh.a;vc.optionalProperties[dg.a.Wk]=Tb.a.instance.ga(1807);vc.optionalProperties[dg.a.taskPaneWidth]=
350;vc.optionalProperties[dg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";vc.hr=Ia;Sg.a.instance.zxa(Ab,"Taskpane","SmartLookupSDXTaskpane",K,vc)}}Gh.xRg="AppProperties";Gh.appName="Excel";Gh.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(d.a)(Gh,"SmartLookupCommandHandler",Aa.a,[221]);class zi extends gd.a{constructor(K){super(K)}hd(){Th.a(this.$,374,375,this.Xa,K=>{this.$c([new wh(this.$,null,null,null,null,K),new Gh(this.$)])})}static ka(K){gd.a.Ld(76,new zi(K))}}
Object(d.a)(zi,"AgaveCommandHandlerFactory",gd.a,[]);var Ai=a(1342),rh=a(108);class xh{constructor(){this.Md=null;this.hbb=(K,Ia,Ab,bc,vc)=>{if(2===Ab){K=vc?vc:{};Ia=K.callback;Ab=K.refresh?K.refresh:!1;if(!Ia)return 16;Ad.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=K.storeType?this.Md.TPf(Ia,Ab,K.storeType):this.Md.cda(Ia,Ab)}return 32};this.Htc=(K,Ia,Ab,bc,vc)=>{if(2===Ab){K=vc?vc:{};Ia=K.Observer;if(!Ia)return r.ULS.sendTraceTag(509686147,
220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(K)),16;if(!this.Md||!this.Md.k2)return r.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(K)),16;this.Md.k2.Ktc(Ia)}return 32};this.Sfj=(K,Ia,Ab,bc,vc)=>{2===Ab&&(K=vc?vc.callback:null)&&this.Md.dMg(K);return 32};this.Hii=(K,Ia,Ab,bc,vc)=>{2===Ab&&this.Md.Qpc(null,OSF.AgaveHostAction.InsertAgave,vc);return 32}}initialize(K){xh.initialized||
(this.Md=K,this.Ag(),xh.initialized=!0)}Ag(){Ad.AFrameworkApplication.rb.Ne(Bc.a.hbb,rh.a.frame,this.hbb,96);Ad.AFrameworkApplication.rb.Ne(Bc.a.Htc,rh.a.frame,this.Htc,96);Ad.AFrameworkApplication.rb.Nb(Bc.a.Hej,rh.a.frame,this.Sfj);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",!1)&&Ad.AFrameworkApplication.rb.Ne(Bc.a.hff,rh.a.frame,this.Hii,96)}static get instance(){xh.La||(xh.La=new xh);return xh.La}}xh.La=null;xh.initialized=!1;Object(d.a)(xh,"AgaveCommandActor",
null,[]);var mh=a(1386),th=a(1338),bi=a(1343),ci=a(111),Ch;(function(K){K[K.OK=0]="OK";K[K.notReady=1]="notReady";K[K.storeDisabled=2]="storeDisabled";K[K.invokeFailure=3]="invokeFailure"})(Ch||(Ch={}));Object(d.b)("AddinDetailsQueryError",Ch);class Wh{constructor(K){this.ASc=K}next(K){this.ASc=(9301*this.ASc+49297)%233280;return Math.floor(this.ASc/233280*K)}}Object(d.a)(Wh,"Random",null,[]);var Bi=a(983),Ri=a(582);class pi{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=
null}}Object(d.a)(pi,"GallerySectionProps",null,[]);var Ci=a(1344),lg=a(175);class qi{constructor(K,Ia,Ab,bc,vc){this.ojb={};this.hLc={};this.PTb=0;this.Vge=!1;this.Ma=K;this.lpa=Ia;this.tWb=null;this.Ezg=Ab;this.Gzg=bc;this.iDg=vc;this.lpa.Ktc(Object(Kd.a)(this,this.Afj,"registerIcons"));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));appChrome.addInApi.loadOfficeAddInIcons()}get $Fe(){return this.hLc}Afj(K,Ia){if(Ia.dY)for(K=0;K<Ia.dY.length;K++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
Ia.dY[K].solutionId,Ia.dY[K].iconUrl);else r.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}Z4i(K){const Ia=[];var Ab=new Wh((new Date).getDate());for(var bc=0;8>bc;bc++)Array.add(Ia,Ab.next(K.count));Ab=0;for(let vc of K){bc=!1;for(const Tc of Ia)if(Ab===Tc){bc=!0;break}Ab++;if(bc){let Tc;(Tc=vc.addinInfo).AUP=20*Tc.AUP}else if(1===vc.addinInfo.priority){let Tc;(Tc=vc.addinInfo).AUP=4*Tc.AUP}else if(2===vc.addinInfo.priority){let Tc;(Tc=vc.addinInfo).AUP=
2*Tc.AUP}}K.Sc((vc,Tc)=>vc.addinInfo.AUP<Tc.addinInfo.AUP?1:-1);return K}L$(K,Ia){const Ab={};Ab.width=K;Ab.height=Ia;Ab.backgroundColor="transparent";return Ab}C5c(){return{flexDirection:"column"}}W5c(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}TVh(){const K={},Ia={},Ab={};Ia.root={marginTop:"12px",
marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Ia.inner={margin:"-4px"};Ab.root=this.L$(100,100);Ab.flexContainer=this.C5c();Ab.label=this.W5c();K.galleryButtonInExpanded=Ab;K.galleryStack=Ia;return K}SMh(){return Object.assign(new Ci.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",Command:this.iDg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px",
"min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}NLh(K,Ia,Ab){return Object.assign(new Ci.a,{Id:Ab,ExternalId:Ab,Icon:"AddinFlyoutControl"+Ia.solutionId,Command:K===CommonUIStrings.l_PopularAddins?this.Ezg:this.Gzg,LabelText:Ia.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},
Alt:Ia.displayName})}e6i(K,Ia,Ab){const bc=Object.assign(new pi,{SectionId:K,Title:K,GalleryButtons:[]});for(let vc=0;vc<Ab;vc++)Array.add(bc.GalleryButtons,this.NLh(K,Ia[vc],this.ojb[Ia[vc].solutionId]));return bc}Y0h(){var K=[];const Ia=this.lpa.awb(0);Array.addRange(K,Ia.dY);const Ab=this.lpa.awb(1);Array.addRange(K,Ab.dY);let bc=K.length;Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&r.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",
bc,Ch[Ia.errorCode],Ia.dY.length,Ch[Ab.errorCode],Ab.dY.length);K.sort((Fe,Me)=>{Fe=lg.d(Fe.displayName);Me=lg.d(Me.displayName);return Lf.a.localeCompare(Fe,Me)});const vc=6<bc;vc&&(bc=5);for(var Tc=0;Tc<bc;Tc++)if(!(K[Tc].solutionId in this.ojb)){var ad="AddinGalleryButton"+this.PTb.toString();this.ojb[K[Tc].solutionId]=ad;this.hLc[ad]=K[Tc].solutionId;this.PTb++}Tc=[];ad=null;if(this.tWb)Tc=this.tWb;else if(ad=this.lpa.awb(2),0===ad.errorCode){Tc=ad.dY;for(var md=0;md<Tc.length;md++)Tc[md].solutionId in
this.ojb||(ad="AddinGalleryButton"+this.PTb.toString(),this.ojb[Tc[md].solutionId]=ad,this.hLc[ad]=Tc[md].solutionId,this.PTb++)}ad=!0;Tc.length||(ad=!1);md=0;if(ad&&(md=K.length?3>=K.length?9:6:12,Tc=this.uSg(Tc,K),md>Tc.length&&(md=Tc.length),Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.Vge)){var Ed="",Xd="";for(let Fe=0;Fe<Tc.length&&Fe<md;Fe++)Ed+=Tc[Fe].displayName,Ed+=",",Xd+=Tc[Fe].solutionId,Xd+=",";r.ULS.sendTraceTag(509673818,
220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",md,Ed,Xd);this.Vge=!0}Ed=Object.assign(new Rc.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Xd=Object.assign(new ha.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Ed.ControlList,Xd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));
Ed=Object.assign(new Pa.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Ed,UpdateDynamically:!0});2!==Ia.errorCode||K.length?3===Ia.errorCode||3===Ab.errorCode?(r.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),K=this.p_e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Ed.MenuSectionList,K)):(0<bc&&this.NGe(Ed,K,bc,"MRUAddins",CommonUIStrings.l_MyAddinSection,vc),ad&&this.NGe(Ed,Tc,md,"PopularAddins",CommonUIStrings.l_PopularAddins)):(r.ULS.sendTraceTag(509687427,
220,10,"store disabled hit"),K=this.p_e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Ed.MenuSectionList,K));return Ed}p_e(K,Ia){const Ab=Object.assign(new Rc.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});K=Object.assign(new Bi.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:K,Label:Ia});Array.add(Ab.ControlList,K);return Ab}uSg(K,Ia){var Ab=new m.a;for(var bc=0;bc<K.length;bc++)Ab.add(K[bc]);if(!this.tWb){8>Ab.count&&(Ab=this.Z4i(Ab));bc=
[];for(var vc of Ab)Array.add(bc,vc);this.tWb=bc}for(Ab=0;Ab<K.length;Ab++)for(vc=0;vc<Ia.length;vc++)if(K[Ab].solutionId.toLowerCase()===Ia[vc].solutionId.toLowerCase()){Array.remove(K,K[Ab--]);break}return K}NGe(K,Ia,Ab,bc,vc,Tc=!1){const ad=Object.assign(new Rc.a,{Id:bc+"Section",ControlsId:bc+"Section.Controls",ControlList:[]});bc=Object.assign(new Ri.a,{Id:bc+"GalleryControl",ExternalId:bc+"GalleryControl",GalleryStyle:this.TVh(),Width:3,Type:4,GallerySections:[]});Array.add(K.MenuSectionList,
ad);Array.add(ad.ControlList,bc);K=this.e6i(vc,Ia,Ab);Tc&&Array.add(K.GalleryButtons,this.SMh());bc.GallerySections.push(K)}i6i(K){if(K)try{K.MenuItems=this.Y0h()}catch(Ia){r.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Ia?Ia.toString():""))}else r.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}}Object(d.a)(qi,"AppsFlyoutGenerator",null,[2]);var ri=a(356),Zi=a(353),Di=a(1262),gh=a(150),Qg=a(184);class Mh extends gh.a{constructor(K,Ia,Ab,bc){super();
this.lX="calc(100% - 46px)";this.e8="15px";this.mX="0";this.zib="WACDialogPanel";this.gG=695;this.Aib=462;this.i1="80%";this.phb=350;this.upa="100%";this.BS=null;this.Ob=5;this.pe="AddinInstallDialog";this.Usg=K;this.yX=Ia;this.LFg=Ab;this.VAg=bc}Hw(){super.Hw();this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=this.e8;this.Kh.style.padding=this.mX;document.getElementById(this.Dh("WACDialogButtonPanel")).style.display="none";this.zha.setAttribute("tabindex","0");$addHandler(this.zha,
"keyup",Object(Kd.a)(this,this.onKeyUp,"onKeyUp"));const K=document.createElement("iframe");K.setAttribute("id","InstallAddinDialog");K.setAttribute("src","about:blank");K.setAttribute("width","100%");K.setAttribute("height","100%");K.setAttribute("marginHeight","0");K.setAttribute("marginWidth","0");K.setAttribute("frameBorder","0");K.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Ia=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.Usg,this.yX,this.LFg);K.setAttribute("src",Ia);this.BS=K;$addHandler(K,"load",Object(Kd.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Kd.a)(this,this.onMessage,"onMessage"));this.Kh.appendChild(K);this.Kh.appendChild(this.ddh())}ddh(){const K=document.createElement("div");K.setAttribute("tabindex","0");$addHandler(K,"focus",Object(Kd.a)(this,this.YVi,"onLoopPivotFocus"));return K}onKeyUp(K){13!==K.keyCode&&32!==K.keyCode||this.hide()}YVi(){this.zha.focus()}onLoad(){this.BS.focus()}onMessage(K){K=
K.rawEvent;if(K.source===this.BS.contentWindow&&(K=(K=K.data)?K.split("|"):null)&&0<K.length&&("REFRESH_REQUIRED"===K[0]||"PRELOAD_MANIFEST"===K[0])){ef.a.instance.setItem("refreshRequired","true");const Ia={};Ia.solutionId=K[1];Ia.version=Mh.aLi(K[3]);Ia.storeType=K[4];Ia.storeId=K[5];Ia.assetId=K[6];Ia.targetType=Mh.S3i(K[2]);Ia.assetStoreId=K[7];Ia.width=parseInt(K[8]);Ia.height=parseInt(K[9]);this.VAg(Ia)}}Jma(){this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=
this.e8;this.Kh.style.padding=this.mX;this.gG>Qg.a.C_?(this.lb.style.width=String.format("{0}px",Qg.a.C_),this.lb.style.overflowX="scroll",Ad.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.gG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Qg.a.A_||this.Aib+50>Qg.a.A_?(this.lb.style.height=String.format("{0}px",Qg.a.A_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Ad.AFrameworkApplication.isRtl?this.lb.style.right=
"0":this.lb.style.left="0",this.Kh.style.minHeight=String.format("{0}px",this.phb)):(this.lb.style.overflowY="hidden",this.lb.style.top="10%",this.lb.style.height=this.i1);this.l$()}l$(){if(this.lb){var K=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.gG>Qg.a.C_)Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight=Ia:this.lb.style.marginLeft=
Ia;Ad.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=String(K)}else r.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}zD(){super.zD();const K=document.getElementById(this.Dh(this.zib));K.style.width=String.format("{0}px",this.gG);K.style.height=this.i1}get V$(){return this.Kh}dispose(){super.dispose();$removeHandler(window,"message",Object(Kd.a)(this,this.onMessage,"onMessage"))}static S3i(K){switch(K){case "1":return 0;
case "2":return 1;default:return 0}}static aLi(K){const Ia=K.split(".");for(let Ab=0;Ab<4-Ia.length;Ab++)K+=".0";return K}}Object(d.a)(Mh,"AddinInstallDialog",gh.a,[]);var mg=a(19),si=a(348);class Ei{constructor(){this.$Xd=this.IBc=null;this.Fv=0;this.GBc=null}}Object(d.a)(Ei,"FirstPartyAddinTaskpaneOverrides",null,[]);class ti{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=
null}}Object(d.a)(ti,"IdeasSelectionContext",null,[]);class ui extends ti{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(ui,"IdeasTableSelectionContext",ti,[]);class Fi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(Fi,"AutoFilterRange",null,[]);class Gi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(Gi,
"IdeasAutoFilterSource",null,[]);class Hi{constructor(K,Ia){this.selection=K;this.tables=Ia}}Object(d.a)(Hi,"IdeasXLIMTableBoundaries",null,[]);var Dg=a(60);const Ii=(K,Ia,Ab,bc,vc,Tc,ad=null)=>{ad=K.Na(9,ad);ad.sharedInfo=Ia;return Dg.g(K,"ShowAgaveTaskpane",ad,Ab,bc,vc,Tc,0)};var ch=a(982),Nh=a(65),Si=a(127),Dh=a(41),Xh=a(374),Oh=a(192),Ji=a(166),Ki=a(568),Vf=a(282),T=a(106),Wa=a(128),ob=a(52);class Zb extends gh.a{constructor(){super();this.lX="calc(100% - 46px)";this.e8="15px";this.mX="0";this.zib=
"WACDialogPanel";this.gG=695;this.Aib=462;this.i1="80%";this.phb=350;this.upa="100%";this.Ob=5;this.pe="AppsForOfficeInsertionDialog";this.aKc=!!Ad.AFrameworkApplication.fa&&Ad.AFrameworkApplication.fa.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}Hw(){super.Hw();this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=this.e8;this.Kh.style.padding=this.mX}Jma(){this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=this.e8;this.Kh.style.padding=
this.mX;this.gG>Qg.a.C_?(this.lb.style.width=String.format("{0}px",Qg.a.C_),this.lb.style.overflowX="scroll",Ad.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.gG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Qg.a.A_||this.Aib+50>Qg.a.A_?(this.lb.style.height=String.format("{0}px",Qg.a.A_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Ad.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left=
"0",this.aKc||(this.lb.style.marginTop="-48px"),this.Kh.style.minHeight=String.format("{0}px",this.phb)):(this.lb.style.overflowY="hidden",this.lb.style.top="10%",this.lb.style.height=this.i1);this.l$()}l$(){if(this.lb){var K=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.gG>Qg.a.C_)Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight=
Ia:this.lb.style.marginLeft=Ia;Ad.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=String(K)}else r.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}zD(){super.zD();const K=document.getElementById(this.Dh(this.zib));K.style.width=String.format("{0}px",this.gG);K.style.height=this.i1}get V$(){return this.Kh}}Object(d.a)(Zb,"AppsForOfficeInsertionDialog",gh.a,[411]);class uc extends gh.a{constructor(){super();this.lX="calc(100% - 46px)";
this.e8="15px";this.mX="0";this.zib="WACDialogPanel";this.gG=695;this.Aib=462;this.i1="80%";this.phb=350;this.upa="100%";this.Ob=5;this.pe="SDXDialog"}Hw(){super.Hw();this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=this.e8;this.Kh.style.padding=this.mX}Jma(){this.Kh.style.width=this.upa;this.Kh.style.height=this.lX;this.Kh.style.marginTop=this.e8;this.Kh.style.padding=this.mX;this.gG>Qg.a.C_?(this.lb.style.width=String.format("{0}px",Qg.a.C_),this.lb.style.overflowX=
"scroll",Ad.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.gG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Qg.a.A_||this.Aib+50>Qg.a.A_?(this.lb.style.height=String.format("{0}px",Qg.a.A_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Ad.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0",this.Kh.style.minHeight=String.format("{0}px",this.phb)):(this.lb.style.overflowY="hidden",
this.lb.style.top="10%",this.lb.style.height=this.i1);this.l$()}l$(){if(this.lb){var K=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.gG>Qg.a.C_)Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Ad.AFrameworkApplication.isRtl?this.lb.style.marginRight=Ia:this.lb.style.marginLeft=Ia;Ad.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=
String(K)}else r.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}zD(){super.zD();const K=document.getElementById(this.Dh(this.zib));K.style.width=String.format("{0}px",this.gG);K.style.height=this.i1}get V$(){return this.Kh}}Object(d.a)(uc,"SDXDialog",gh.a,[]);var Sc=a(980),Zc=a(145),qd=a(576),Gc;(function(K){K[K.Valid=2]="Valid";K[K.Invalid=4]="Invalid";K[K.All=6]="All"})(Gc||(Gc={}));Object(d.b)("MetadataState",Gc);var id=a(345);class rd extends Aa.a{constructor(K,
Ia,Ab,bc,vc){super();this.HAa={};this.Mcd={};this.kza=this.eZa=this.sdxDialog=this.AZ=null;this.Sbb=!1;this.tob=0;this.WLj=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.TYj=(Tc,ad)=>{ad.uob===bi.a.myAddins&&(this.tob|=1);ad.uob===bi.a.adminManaged&&(this.tob|=2);0!==this.tob&&
appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.j$h=()=>!Ad.AFrameworkApplication.fa.pa("AppsForOfficeThirdPartyIsDisabled")&&Ad.AFrameworkApplication.rT&&this.P0b&&this.CBe()?32:8;this.d$h=(Tc,ad,md,Ed,Xd)=>{if(2!==md)return this.CBe()?32:8;this.P0b.i6i(Xd);return 32};this.E9h=(Tc,ad,md,Ed,Xd)=>{if(2!==md)return 32;Tc=Xd[Sc.a.Uub];ad=Xd[Sc.a.Mha];md=Xd[Sc.a.rma];Xd=new mh.a;Xd.mgc=md.optionalProperties.InstanceToken;Xd.sourceLocationOverrideResourceId=
md.optionalProperties[dg.a.sourceLocationOverrideResourceId];Xd.fB=md.hr;Xd.Mha=ad;ad=null!=Xd.mgc?Xd.mgc:(new Gd.a(Lh.a.create(),1)).toString();md=null!=Xd.fB?Xd.fB:{};Ed={};Ed.id=ad;Ed.solutionId=Tc.getId();Ed.version=Tc.HCa;Ed.storeType=Tc.getStoreType();Ed.storeId=Tc.getStoreId();Ed.assetId=null;Ed.assetStoreId=null;Ed.settings=md;Ed.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Ed.osfControlType=OSF.OsfControlType.ContainerLevel;Ed.sourceLocationOverrideResourceId=Xd.sourceLocationOverrideResourceId;
Ed.featureGates=Ad.AFrameworkApplication.fa.U2e(Tc.getId());this.hlc(Xd,Ed);return 32};this.aDb=(Tc,ad,md,Ed,Xd)=>{2===md&&(this.AZ=new Zb,this.AZ.initializeAndShow("",null,null),Tc=Xd.CommandValueId,ad=[],ad.push(Xd.SourceControlId),ad.push(Tc),ad.push(null),this.Md.Spf(this.AZ.V$,ad));return 32};this.F9h=Tc=>{if(Tc)if(Tc=this.P0b.$Fe[Tc])if(Tc=this.XWh(Tc)){var ad={[la.a.z9]:Tc,[fg.a.Pf]:rd.ita(Tc)},md=new $e.a(-741808261,0,this.$.xc,0,"");this.$.Ia.Hb(md,ad);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(Tc=Telemetry.PrivacyRules.GetPrivacyCompliantId(Tc.solutionId,Tc.storeType,Tc.assetId,null,null,Tc.storeId),ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:$b.a.Li({SolutionId:Tc})})))}else r.ULS.sendTraceTag(509681666,220,10,"Get add-in entitlement fails.");else r.ULS.sendTraceTag(509642528,220,10,"SolutionId is null.");else r.ULS.sendTraceTag(509642529,220,10,"Control id is null.")};this.D9h=Tc=>{if(Tc)if(Tc=this.P0b.$Fe[Tc]){var ad=
this.Md.Ng;ad=ad?ad.getAppUILocale()||"en-US":"en-US";this.eZa=new Mh(Tc,"wac_excel",ad,md=>{this.Md.Qpc("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,md);const Ed=new $e.a(-741808261,0,this.$.xc,0,null),Xd={[la.a.z9]:md,[fg.a.Pf]:rd.ita(md)};this.$.Ia.Hb(Ed,Xd);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(md=Telemetry.PrivacyRules.GetPrivacyCompliantId(md.solutionId,md.storeType,md.assetId,null,null,md.storeId),ra.a.sendTelemetryEvent(Object(xc.a)(new Nf.a,
{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:$b.a.Li({SolutionId:md})})))});this.eZa.initializeAndShow("",null,null)}else r.ULS.sendTraceTag(509642526,220,10,"Solution id is null.");else r.ULS.sendTraceTag(509642527,220,10,"Control id is null.")};this.hlc=(Tc,ad)=>{this.sdxDialog=new uc;this.sdxDialog.initializeAndShow("",null,null);ad.div=this.sdxDialog.V$;Tc={};Tc.InstanceId=ad.id;Tc.WebExtensionType=2;Tc.PrimaryMarketplace={};Tc.PrimaryMarketplace.SolutionId=ad.solutionId;
Tc.PrimaryMarketplace.MarketplaceType=ad.storeType;Tc.PrimaryMarketplace.MarketplaceRef=ad.storeId;Tc.PrimaryMarketplace.SolutionVersion=ad.version;Tc.SrcLocationOverrideResourceId=ad.sourceLocationOverrideResourceId;Tc.WebExtensionOsfControlType=6;this.HAa[ad.solutionId]=ad.settings;Tc.OsfPropertyBag=this.Wmc([],ad.solutionId);this.Md.cIa(Tc);this.Md.Ng.insertOsfControl(ad)};this.W$h=(Tc,ad,md,Ed,Xd)=>{if(2!==md)return 32;Tc=Xd[Sc.a.Uub];md=Xd[Sc.a.Mha];Xd=Xd[Sc.a.rma];ad=new mh.a;ad.mgc=Xd.optionalProperties.InstanceToken;
ad.Wk=Xd.optionalProperties[dg.a.Wk];ad.oO=Xd.optionalProperties[dg.a.oO];dg.a.taskPaneWidth in Xd.optionalProperties&&(ad.taskPaneWidth=Xd.optionalProperties[dg.a.taskPaneWidth]);ad.sourceLocationOverrideResourceId=Xd.optionalProperties[dg.a.sourceLocationOverrideResourceId];ad.fB=Xd.hr;ad.onTaskPaneClose=Xd.optionalProperties[dg.a.onTaskPaneClose];ad.Mha=md;md=new $e.a(-859308420,0,2,0,"");Ed=Tc.getStoreType()===OSF.StoreType.Sdx;const Fe=new ch.a;Fe.k4=Xd.optionalProperties.HeaderCssClass||mg.a.N2a;
Fe.tfb=Xd.optionalProperties.TitleCssClass;this.j7(md,Tc.getId(),ad,Ed,Fe);return 32};this.F$h=(Tc,ad,md,Ed,Xd)=>{if(2!==md)return 32;Tc=Xd[Sc.a.Uub].getId();Xd=Xd[Sc.a.rma].optionalProperties[dg.a.sourceLocationOverrideResourceId];return Tc?(this.Md.Ng.refreshOsfControl(Tc,Xd),32):8};this.U6i=Tc=>{Tc=Tc.Result;if(Tc=null===Tc?null:Tc.SolutionId)this.Md.voe(Tc),T.a(this.$).nna(3,Tc)};this.uNf=(Tc,ad)=>{var md;const Ed=(Tc=Tc.Result)?Tc.AgaveData:null;if(Ed){var Xd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.PrimaryMarketplace.SolutionId,
Ed.PrimaryMarketplace.MarketplaceType,null===(md=null===Ed||void 0===Ed?void 0:Ed.AssetMarketplace)||void 0===md?void 0:md.SolutionId,null,null,Ed.PrimaryMarketplace.MarketplaceRef);r.ULS.shipAssertTag(537170434,0,Ed.TaskpaneWidth===rd.lkh,`Taskpane width is ${Ed.TaskpaneWidth}, assetId is ${Xd}.`);if(md=this.Mcd[Ed.PrimaryMarketplace.SolutionId])md.IBc&&(Ed.TaskpaneTitle=md.IBc),md.GBc&&(Ed.TaskpaneIconId=md.GBc),md.$Xd&&(Ed.TaskpaneButtonTooltip=md.$Xd),0<md.Fv&&(Ed.TaskpaneWidth=md.Fv);ad&&(Ed.FocusOnIframeWhenLoaded=
ad.focusOnIframeWhenLoaded,ad.width&&(Ed.TaskpaneWidth=ad.width),Ed.TaskpaneIconCssClass=ad.ek,Ed.TaskpaneHeaderCssClass=ad.k4,Ed.TaskpaneTitleCssClass=ad.tfb,Ed.IsFirstPartyOptOutAppContextOptmization=ad.isFirstPartyOptOutAppContextOptmization);this.HAa[Ed.PrimaryMarketplace.SolutionId]&&(Ed.OsfPropertyBag=this.Wmc(Ed.OsfPropertyBag,Ed.PrimaryMarketplace.SolutionId));Ki.a(Ed)||(Ed.WebExtensionOsfControlType=1);Ed&&(this.Md.voe(Tc.SolutionId),this.Md.cIa(Ed))}else r.ULS.sendTraceTag(593285650,220,
10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.bFh=Tc=>{Tc&&(this.Wbd.pof(Tc),this.MAe())};this.yNf=Tc=>{Tc=Tc.toDataURL("image/jpeg");const ad=this.Md.yaa(rd.Mbf+"."+rd.Odc),md={};md.screenshot=Tc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ad,"onScreenshot",md,()=>{})};this.X8h=(Tc,ad,md,Ed,Xd)=>{if(2!==md)return 32;if(ci.a.lh(Xd)||Xd[Sc.a.gFe]!==th.a.action)return 8;ad=Xd[Sc.a.rma];return ad?(Tc=(Tc=this.b_h(Xd))?this.Md.yaa(Tc):null)?
(Xd=this.Md.Dah(Xd[Sc.a.Mha],ad.optionalProperties[dg.a.vVc]),C.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(md=this.Md.cZ(Tc),md.TaskpaneTitle!==ad.optionalProperties[dg.a.Wk]&&(md.TaskpaneTitle=ad.optionalProperties[dg.a.Wk],md.TaskpaneIconCssClass=ad.optionalProperties.IconCssClass,md.TaskpaneIconUrl=ad.optionalProperties.TaskPaneIconUrl,md.TaskpaneIconId=ad.optionalProperties.TaskPaneIconId,C.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(ad=this.Md.Ng,ad.changeIframeTitle(Tc,md.TaskpaneTitle),md=ad.getOsfControl(Tc),ad.raiseOsfControlStatusChange(md)):(ad=this.Md.Ng.getOsfControl(Tc),this.Md.Ng.raiseOsfControlStatusChange(ad)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Tc,Xd,this.BLb),32):8:8};this.BLb=(Tc,ad)=>{this.Md.DHh(Tc,ad)};this.NKd=()=>{Af.TaskExtensions.V2(Uf.GetServiceTaskFactory.Oa(this.$.da,20,404,1),Tc=>{Tc.result.VKa()},this.$.la)};this.$=K;this.viewBlockContainerHelpers=Ab;this.Md=Ia;this.Wbd=
bc;this.hh=vc;this.SXc&&(this.k2=this.Md.k2,null!==this.k2?(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.k2.Ktc(this.TYj),this.P0b=new qi(this.hh,this.k2,Bc.a.dlc.toString(),Bc.a.ilc.toString(),"1296389134")):r.ULS.sendTraceTag(509642525,220,10,"addinDetailsProvider is null"));this.hh.Nb(Bc.a.D9f,rh.a.frame,this.W$h);this.hh.Nb(Bc.a.HZf,rh.a.frame,this.F$h);this.hh.Nb(Bc.a.OVe,rh.a.frame,this.X8h);this.hh.Nb(Bc.a.hlc,rh.a.frame,this.E9h);
this.hh.Nb(Bc.a.aDb,rh.a.frame,this.aDb);this.hh.Nb(Bc.a.RPf,rh.a.frame,this.j$h);this.hh.Nb(Bc.a.WMf,rh.a.frame,this.d$h)}get SXc(){return Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}CBe(){let K=this.k2.awb(bi.a.myAddins);if(K.errorCode!==Ch.notReady)return!0;K=this.k2.awb(bi.a.adminManaged);return K.errorCode!==Ch.notReady}WMg(K){this.addHandler(rd.VEd,
K)}Ijj(K){this.removeHandler(rd.VEd,K)}dispose(){fi.a.Ja(this.AZ);this.AZ=null;this.Sbb&&(this.$.ea.Bn(this.NKd),this.Sbb=!1);super.dispose()}T0c(){this.AZ&&this.AZ.hide();this.eZa&&this.eZa.hide()}bNj(K,Ia){var Ab;if(K){this.raiseEvent(rd.VEd);const bc=K.split("|");this.DCi(K,Ia,bc);this.AZ=new Zb;this.AZ.initializeAndShow("",null,null);this.Md.Spf(this.AZ.V$,bc);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&(window[rd.pPg]=null!==(Ab=this.WLj.get(K))&&
void 0!==Ab?Ab:"Unknown")}}vkd(K,Ia,Ab){var bc=Af.TaskExtensions.Tj();if(-515602470===Ab.command||-167264441===Ab.command||-336193495===Ab.command||2086613372===Ab.command||-1444574190===Ab.command||-1336341324===Ab.command||451940422===Ab.command)bc=this.s9h(K,Ia,Ab);418618014===Ab.command&&(Ia=new mh.a,Ia.Wk=Tb.a.instance.ga(1820),bc=this.j7(Ab,rd.Qbi,Ia,!0));if((Ab.tabName===this.$.Bb+Bd.a.g_f||Ab.tabName===Bd.a.K_)&&2===Ab.We||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
K[fg.a.Kc])||K[fg.a.Kc]===Bd.a.RU)return this.C$e(K,Ab);if(7===Ab.We&&K.SourceControlId===this.$.Bb+Bd.a.Ndc)return K.MenuItemId=Bd.a.LJd,this.C$e(K,Ab);1221897806===Ab.command&&(bc=this.m9f(Ab,"Format"));if(1930653487===Ab.command||1172793074===Ab.command)bc=this.m9f(Ab,"Data");-1753056834===Ab.command&&(bc=this.NIj(Ab));932597253===Ab.command&&(r.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Zc.c(932597253,!0),Ia=new mh.a,Ia.Wk=Tb.a.instance.ga(2160),Ia.sourceLocationOverrideResourceId=
C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?rd.d7i:rd.f7i,Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=rd.udf,bc={},bc.LaunchSource=Object(U.a)(String,K.SourceControlId),bc.LaunchMode="Default",Ia.fB=bc,bc=this.j7(Ab,rd.e7i,Ia,!0));301511274===Ab.command&&(bc=this.YIj(Ab));if(515196233===Ab.command){Ia=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);bc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1);var vc=this.$.da.Aa(465);vc&&(vc.Ubf(),Ia||bc)&&(vc.iii(),bc&&vc.gzj(10===Ab.We));vc=new mh.a;vc.Wk=Tb.a.instance.ga(2234);const Tc={};Tc.SourceUILocation=ri.a[Ab.We];if(Ia||bc)Tc.SessionID=this.$.ea.sessionId,Ia&&this.oRd(Tc);vc.fB=Tc;Ia=new ch.a;Ia.k4=mg.a.N2a;bc=this.j7(Ab,rd.c2i,vc,!0,Ia,void 0,vc.Wk)}1723441034===Ab.command&&(Ia=new mh.a,Ia.Wk=Tb.a.instance.ga(2246),Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=rd.W9i,bc=new ch.a,bc.k4=mg.a.bwh,bc=this.j7(Ab,qd.a,Ia,!0,bc));C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&K.LoadDataFromPictureTaskpane&&(Ia={},bc=new mh.a,bc.Wk=Tb.a.instance.ga(2273),Ia.SessionID=K.SessionID,bc.fB=Ia,bc.focusOnIframeWhenLoaded=!0,bc=this.j7(Ab,K.DataFromPictureAssetId,bc,!0));return bc}insertAgave(K,Ia){var Ab=Af.TaskExtensions.Tj();const bc=this.$;let vc;var Tc=K[la.a.z9];vc=K[fg.a.Pf];let ad=null;ch.a.key in K&&(ad=K[ch.a.key]);this.AZ&&this.AZ.hide();this.eZa&&this.eZa.hide();if(!vc||!Tc)return r.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),
Ab;this.$.X4&&Bd.a.loa in K&&(vc.EnabledInViewMode=K[Bd.a.loa]);K=this.uRh(Ia.command);if(!vc.EnabledInViewMode&&!bc.Us(null,!1,K))return Ab;let md=void 0===vc.IsToBePersisted||null===vc.IsToBePersisted||vc.IsToBePersisted?0:16;if(1===vc.TargetType)Ab=this.$ii(vc,Tc,Ia,ad,md);else{Tc=Cg.h(bc);Ab=this.viewBlockContainerHelpers.Jgb(Tc);const Ed=bc.ea.isNamedObjectViewMode?bc.na.sheetName:bc.na.name;let Xd,Fe,Me,lf;Ab?(Tc=Ab.fe,Xd=Tc.Je.top,Fe=Tc.Je.left,Me=Ab.wI.x,lf=Ab.wI.y):(Xd=Fe=1,Ab=this.viewBlockContainerHelpers.ZKa(Tc),
Me=Ab.x,lf=Ab.y);const tg=this.$.oa.xa.Wb();md|=64;Ab=Xh.a(this.$.userOperationManager,(jg,cg,eg)=>{var og=bc.oa.xa,Og=Xd,Ng=Fe,Pg=Me,Ph=lf;jg=Vf.b(jg,this.U6i);const di=og.Na(9,tg);di.sharedInfo=vc;di.sheetName=Ed;di.positionRow=Og;di.positionCol=Ng;di.positionOffsetX=Pg;di.positionOffsetY=Ph;return Dg.g(og,"InsertWebExtension",di,jg,cg,eg,null,0)},jg=>new Oh.a(534,0,jg,md),Ia)}return Ab}b9g(){var K=qc.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper");if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Ia=qc.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Wbd?this.Wbd.ekb?this.MAe():Ia.instance.Z8c(this.bFh):r.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ia={};Ad.AFrameworkApplication.fa.Qoe(Ia);K=K.instance.getContext(Ia);Ia={};"telemetryGroup"in K&&(Ia=K.telemetryGroup);Ia.processSessionId=K.sessionId;Ia.officeBuild=K.build;K.telemetryGroup=Ia;K.feedbackType=-1;K.userVoiceEnabled=!1;"disableIncludeScreenshot"in K||(K.disableIncludeScreenshot=
!1);"screenshot"in K||(K.screenshot=!1);K.disableScreenshotPreview=!1;K.includeScreenshotSelectedDefault=!0;return K}KNf(K){if(!this.kza&&C.EwaSettings.getBooleanFeatureGate(rd.Jdi,!1)){var Ia=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ia=this.jye(Ia);const Ab=new ch.a;Ab.ek=mg.a.Kub;Ab.k4=mg.a.ESe;Ab.tfb=mg.a.rad;this.kza=this.Gwc(Ia,null,!1,null,Ab);Wa.b(this.$).rd(Si.a.t7i,{["Location"]:K?ri.a[K.We]:0,["InputMethod"]:K?
Zi.a[K.method]:0},void 0,!0);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.KZd()}}oRd(K){const Ia=this.$.ea.wg.get(17);qc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ab=>{Ab.isFeatureEnabled("mso_sendASmile",Ia).then(bc=>{K.FeedbackEnabled=Ia&&bc;return null})})}m9f(K,Ia){const Ab=Cg.h(this.$),bc=new mh.a;var vc={};vc.ActiveTab=Ia;vc.DatapaneFlighting=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);vc.AceFlighting=!0;vc.ChartNewSDXRecording=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);vc.ThemeColorsFlighting=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");vc.UOMirror=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);vc.FormatTaskPaneAceButtonDark=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);vc.FormatTaskPaneBetterFeedbackButton=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);vc.FormatTaskPaneBetterScrollbar=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);vc.FormatTaskPaneUXImprovePhase2=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.oRd(vc);vc.startTimeMs=Date.now();vc.UserSessionId=this.$.ya.UserSessionId;(Ia=Ab.ha.Sa.Un)&&(vc.SubSelection=
Ia);r.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${vc.UserSessionId}, UILocation: ${void 0===K.We||null===K.We?"Null":ri.a[K.We]}, SubSelection: ${Ia||"ChartRoot"}`);bc.fB=vc;bc.Wk=Tb.a.instance.ga(982);vc=new ch.a;vc.k4=mg.a.N2a;return this.j7(K,rd.$2g,bc,!0,vc)}NIj(K){const Ia=new mh.a;Ia.fB={};Ia.Wk=Tb.a.instance.ga(1806);Ia.oO=rd.qqf;const Ab=new ch.a;Ab.k4=mg.a.N2a;return this.j7(K,rd.qqf,Ia,!0,Ab,void 0,Ia.Wk)}YIj(K){const Ia=new mh.a;Ia.fB={};Ia.Wk=Tb.a.instance.ga(2184);
const Ab=new ch.a;Ab.k4=mg.a.Dxh;Ab.tfb=mg.a.ISe;return this.j7(K,rd.iKi,Ia,!0,Ab)}C$e(K,Ia){const Ab=rd.Mbf;var bc=K[fg.a.Kc].toString();const vc={},Tc=new mh.a;Tc.Wk=Tb.a.instance.ga(9);switch(bc){case "A0":vc.query=(K[fg.a.Pf]||"").split("|").slice(2,si.a.mS).join("|");break;case "A1":vc.query=K.CommandValueId;break;case "Help":vc.gwdropdownflightinfo=C.EwaSettings.sa(222);vc.query="";break;case Bd.a.LJd:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(Tc.Wk=Tb.a.instance.ga(1772),Tc.sourceLocationOverrideResourceId=rd.Odc,vc.feedback=this.b9g()):vc.query=bc;break;case "HelpArticle":vc.query=K[fg.a.Pf];break;case "ContactSupport":vc.query=bc;Tc.sourceLocationOverrideResourceId=rd.j9g;break;case "ShowTraining":case "WhatsNew":vc.query=bc;break;default:return Ug.Task.Ra(!0)}Tc.fB=vc;bc=new ch.a;bc.k4=mg.a.N2a;return this.j7(Ia,Ab,Tc,!1,bc,K[Bd.a.loa]||!1)}jye(K){const Ia={};Ia.SolutionId=rd.K5a;Ia.Version="0.0.0.0";Ia.StoreType=OSF.StoreType.Sdx;
Ia.StoreId=OSF.StoreType.Sdx;Ia.AssetId=null;Ia.AssetStoreId=null;Ia.Height=0;Ia.Width=0;Ia.TargetType=OSF.OsfControlTarget.TaskPane;Ia.IsToBePersisted=!1;Ia.SourceLocationOverrideResourceId=K;Ia.SharedRuntimeId=K;return Ia}s9h(K,Ia,Ab){function bc(){ad.LaunchMode="Default";C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";vc.Wk=Tb.a.instance.ga(1819);
vc.oO=rd.w0b;vc.ek=mg.a.Kub;Tc.ek=mg.a.Kub}const vc=new mh.a,Tc=new ch.a,ad={};this.kza&&this.oRd(ad);ad.LaunchSource="";ad.StartTimeMs=Date.now();ad.CorrelationId=Lh.a.create().toString();vc.fB=ad;vc.focusOnIframeWhenLoaded=!0;vc.taskPaneWidth=rd.udf;Tc.k4=mg.a.ESe;Tc.tfb=mg.a.rad;switch(Ab.command){case -1444574190:let Xd;ad.LaunchMode="RecommendedPivotTables";ad.SelectionContext="";ad.LaunchSource="PivotTableHandRaise"===Object(U.a)(String,K.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";
if(this.$&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&K.SourceSelection){var md=K.SourceSelection.split(",")[0];Ia=C.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:md,jRf:Xd,range:Ed}=Dh.Y(md,this.$.va)).returnValue&&!Cg.h(this.$).wb.U4(Ed))K=this.$.va.getItemByName(md),ad.SelectionContext=JSON.stringify(Object(xc.a)(new ti,{address:Xd,addressWithSheet:md+"!"+Ed.NC(!1),sheetId:Nh.d(K),sheetName:md,isSheetEmpty:!1,
columnCount:Ed.width,rowCount:Ed.height,columnIndex:Ed.left+Ia,rowIndex:Ed.top+Ia,selectionType:"Continuous"}));else if((K=this.$.yb.getItemByName(Object(U.a)(String,K.SourceSelection)))&&Nh.n(K)){var Ed=Ji.a(K,!0);md=this.$.va.getItemByName(K.sheetName);ad.SelectionContext=JSON.stringify(Object(xc.a)(new ui,{tableName:K.name,hasTableHeaders:Ji.d(K),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Ed.NC(!1),addressWithSheet:md.name+"!"+Ed.NC(!1),sheetId:Nh.d(md),sheetName:md.name,isSheetEmpty:!1,
columnCount:Ed.width,rowCount:Ed.height,columnIndex:Ed.left+Ia,rowIndex:Ed.top+Ia,selectionType:"Continuous"}))}}C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":vc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";vc.Wk=Tb.a.instance.ga(1818);vc.oO=rd.m5i;vc.ek=mg.a.ZUe;Tc.ek=mg.a.ZUe;break;case -336193495:ad.LaunchMode="RecommendedCharts";C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?vc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":vc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";vc.Wk=Tb.a.instance.ga(1817);vc.oO=rd.qdj;vc.ek=mg.a.$Ue;Tc.ek=mg.a.$Ue;break;case -1336341324:if(!C.EwaSettings.sa(417))return Ug.Task.Ra(!1);ad.LaunchMode="NL";vc.oO=rd.w0b;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":vc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(C.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:vc.Wk=Tb.a.instance.ga(1822);ad.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:vc.Wk=Tb.a.instance.ga(1823);ad.NLLaunchModeBrandingCandidatesIndex=2;break;default:vc.Wk=Tb.a.instance.ga(1821),ad.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!C.EwaSettings.sa(217))return Ug.Task.Ra(!1);ad.LaunchMode="ChartDesigner";ad.LaunchSelectionMode=Ia.toString();C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";vc.Wk=Tb.a.instance.ga(1824);vc.oO=rd.w0b;break;case 451940422:ad.LaunchSource="AutoFilter";Ed=JSON.parse(K.CommandValueId);ad.AutoFilterSource=JSON.stringify(Object.assign(new Gi,{autoFilterRange:{sheetName:Ed.AutoFilterRange.SheetName,firstColumn:Ed.AutoFilterRange.FirstColumn,lastColumn:Ed.AutoFilterRange.LastColumn,firstRow:Ed.AutoFilterRange.FirstRow,lastRow:Ed.AutoFilterRange.LastRow},autoFilterType:Ed.AutoFilterType,
itemIndex:Ed.ItemIndex,id:Ed.Id}));bc();break;case -167264441:ad.LaunchMode="ExcelIntelligence";ad.TableName=K.TableName;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":vc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";vc.Wk=Tb.a.instance.ga(1819);vc.oO=rd.w0b;vc.ek=mg.a.Kub;Tc.ek=mg.a.Kub;break;default:C.EwaSettings.sa(217)&&(ad.LaunchSelectionMode=Ia.toString()),C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&(ad.XlimTableBoundaries=this.p4h()),bc()}C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?vc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.kza?this.kza.Qo(()=>this.v2f(ad,vc)):this.khi(Ab,vc,Tc,ad)}khi(K,Ia,Ab,bc){this.kza=this.Gwc(this.jye(Ia.sourceLocationOverrideResourceId),Ia,!1,K,Ab,!1);return C.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?
(bc.NoActionMsgOnFirstInstance=!0,this.HAa[rd.K5a]=bc,this.kza):this.kza.Qo(()=>this.v2f(bc,Ia))}v2f(K,Ia){const Ab=this.Md.yaa(this.Md.L3a(rd.K5a,Ia.sourceLocationOverrideResourceId));if(Ab){this.HAa[rd.K5a]=K;const bc=this.Wmc(this.Md.cZ(Ab).OsfPropertyBag,rd.K5a);this.Md.cZ(Ab).OsfPropertyBag=bc}this.zxa(rd.K5a,"LaunchIdeasAction",K,Ia);return Ug.Task.Ra(!0)}XWh(K){if(this.k2){if(K=this.k2.VNh(K)){const Ia={};Ia.solutionId=K.solutionId;Ia.version=K.version;Ia.storeType=K.storeType;Ia.storeId=K.storeId;
Ia.assetId=K.assetId;Ia.assetStoreId=K.assetStoreId;Ia.targetType=K.targetType;Ia.displayName=K.displayName;Ia.width=K.width;Ia.height=K.height;return Ia}r.ULS.sendTraceTag(509642524,0,10,"Get addinDetail fail.");return null}r.ULS.sendTraceTag(509642523,0,10,"No addinDetailManager instance.");return null}j7(K,Ia,Ab=null,bc=!1,vc=null,Tc=!1,ad=null){Af.TaskExtensions.Tj();Ab||(Ab=new mh.a);const md={};md.SolutionId=Ia;md.Version="0.0.0.0";md.StoreType=bc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;
md.StoreId=bc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;md.AssetId=null;md.AssetStoreId=null;md.Height=0;md.Width=0;md.TargetType=OSF.OsfControlTarget.TaskPane;md.IsToBePersisted=!1;md.SourceLocationOverrideResourceId=Ab.sourceLocationOverrideResourceId;if(Ab.Wk||ad)this.Mcd[Ia]=Object(xc.a)(new Ei,{IBc:Ab.Wk,$Xd:ad,GBc:Ab.oO});C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Ab.fB||(Ab.fB={}),Ab.fB.ShowFeedback=this.$.isFeedbackEnabled,
this.HAa[Ia]=Ab.fB):Ab.fB&&(this.HAa[Ia]=Ab.fB);Ia={};Ia[fg.a.Pf]=md;ad={};ad.solutionId=md.SolutionId;ad.version=md.Version;ad.storeType=md.StoreType;ad.storeId=md.StoreId;ad.assetId=md.AssetId;ad.assetStoreId=md.AssetStoreId;ad.height=md.Height;ad.targetType=md.TargetType;ad.width=md.Width;ad.isAddinCommands=!bc;Ia[la.a.z9]=ad;vc||(vc=new ch.a);vc.focusOnIframeWhenLoaded=Ab.focusOnIframeWhenLoaded;vc.width=Ab.taskPaneWidth;Ia[ch.a.key]=vc;Ia[Bd.a.loa]=Tc;return this.insertAgave(Ia,K)}$ii(K,Ia,Ab,
bc,vc){const Tc=(Xd,Fe)=>{var Me=Xd.SolutionId;var lf=OSF.OsfControl.isFirstPartyStoreString(Xd.StoreType);lf&&Xd.SourceLocationOverrideResourceId&&(Me=this.Md.L3a(Me,Xd.SourceLocationOverrideResourceId));var tg=this.Md.JBe(Me,null,Xd.SharedRuntimeId);lf&&(C.EwaSettings.sa(263)&&tg&&(lf=this.Md.yaa(Me))&&(Me=null,Me=this.Wmc(this.Md.cZ(lf).OsfPropertyBag,Xd.SolutionId),(lf=this.Md.Ng.getOsfControl(lf))&&lf.setSettings(Me)),Xd.SharedRuntimeId&&tg||this.Md.Ng.refreshOsfControl(Xd.SolutionId,Xd.SourceLocationOverrideResourceId));
if(!tg){const jg=this.$.oa.xa.Wb();let cg=519;tg=(eg,og,Og)=>{var Ng=this.$.oa.xa;eg=Vf.b(eg,this.uNf);const Pg=Ng.Na(9,jg);Pg.sharedInfo=Xd;return Dg.g(Ng,"InsertAgaveTaskpane",Pg,eg,og,Og,bc,0)};void 0===Xd.IsToBePersisted||null===Xd.IsToBePersisted||Xd.IsToBePersisted||(cg=538,tg=(eg,og,Og)=>{const Ng=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xd.SolutionId,Xd.StoreType,Xd.AssetId,null,null,Xd.StoreId);r.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Xd.StoreType}, StoreId ${Xd.StoreId}, SolutionId ${Ng}.`);
return Ii(this.$.oa.xa,Xd,Vf.b(eg,this.uNf),og,Og,bc,jg)});vc|=64;return Xh.a(this.$.userOperationManager,tg,eg=>new Oh.a(cg,0,eg,vc),Fe)}return Af.TaskExtensions.Uaa()},ad=Xd=>{var Fe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xd.solutionId,Xd.storeType,Xd.assetId,null,null,Xd.storeId);r.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Fe} from ${Xd.storeType}.`);Fe={};const Me=new m.a;Me.add(Xd);Fe[la.a.vob]=Me;Fe[la.a.OL]=3;Xd=new $e.a(Bc.a.ZCb,0,this.$.xc,0,null);return this.$.Ia.Hb(Xd,
Fe)};if(!C.EwaSettings.sa(52)||K.StoreId===OSF.StoreType.FirstParty)return Tc(K,Ab,bc);if(Ia.isAddinCommands)return ad(Ia);const md=new Ic.a,Ed={};Ed.solutionId=K.SolutionId;Ed.version=K.Version;Ed.storeType=K.StoreType;Ed.storeId=K.StoreId;Ed.targetData=K;C.EwaSettings.sa(92)&&(Ed.clearCache=!0);this.Md.Ng.isAddinCommandsAsync(Ed,(Xd,Fe,Me)=>{md.setResult(Fe);Xd||(Xd=Me.targetData,Fe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xd.SolutionId,Xd.StoreType,Xd.AssetId,null,null,Xd.StoreId),r.ULS.sendTraceTag(537170438,
220,10,`Judging AddinCommands failed for ${Fe} from ${Xd.StoreType} during addin inserting`))});return Af.TaskExtensions.ts(md.task,Xd=>Xd.result?ad(Ia):Tc(K,Ab,bc),this.$.la)}Wmc(K,Ia){if(!this.HAa[Ia])return K;const Ab={};if(K)for(const vc of K)Ab[vc[0]]=vc[1];K=this.HAa[Ia];for(var bc of Object.keys(K))bc===rd.dFh&&C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Ab[bc]=Sys.Serialization.JavaScriptSerializer.serialize(K[bc]):Ab[bc]=Sys.Serialization.JavaScriptSerializer.serialize(K[bc].toString());
bc=Object.keys(Ab).length;bc=Array(bc);K=0;for(const vc of Object.keys(Ab))bc[K]=[vc,Ab[vc].toString()],K++;return bc}DCi(K,Ia,Ab){const bc=this.$.ya.UserSessionId,vc=this.$.ya.UICultureTag,Tc=this.$.ya.UICultureTagLcid,ad=this.$.ya.WacHostId;let md="",Ed="";5<=Ab.length&&(md=Ab[3],Ed=Ab[4]);this.ECi(md,Ed,K,Ia,vc,Tc,bc,ad)}ECi(K,Ia,Ab,bc,vc,Tc,ad,md){const Ed={};Ed.a=ad;Ed.b=Ab;Ed.c=bc;Ed.d=K;Ed.e=Ia;Ed.f=vc;Ed.g=Tc;Ed.h=md;ob.b().Te(36,Ed)}MAe(){if(Di.a.Dyf())r.ULS.sendTraceTag(537170433,1302,15,
"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.yNf);return}catch(K){r.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(K?K.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.yNf)}catch(K){r.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(K?K.toString():null))}}}Gwc(K,Ia=null,Ab=!1,bc=null,vc=null,Tc=!0){var ad=K.SolutionId;let md=Ug.Task.Ra(!1);K&&ad&&K.SharedRuntimeId&&(bc=bc||
new $e.a(-859308420,0,2,0,""),ad={},ad.solutionId=K.SolutionId,ad.version=K.Version,ad.storeType=K.StoreType,ad.storeId=K.StoreId,ad.assetId=K.AssetId,ad.assetStoreId=K.AssetStoreId,ad.height=K.Height,ad.targetType=K.TargetType,ad.width=0,ad.isAddinCommands=!1,ad.sharedRuntimeId=K.SharedRuntimeId,K.Preload=Tc,vc=vc?vc:new ch.a,vc.width=0,Ia&&(vc.focusOnIframeWhenLoaded=Ia.focusOnIframeWhenLoaded,Tc=new Ei,Ia.Wk&&(Tc.IBc=Ia.Wk),0<Ia.taskPaneWidth&&(Tc.Fv=Ia.taskPaneWidth),Ia.oO&&(Tc.GBc=Ia.oO),this.Mcd[K.SolutionId]=
Tc),Ia={},Ia[fg.a.Pf]=K,Ia[la.a.z9]=ad,Ia[ch.a.key]=vc,Ia[Bd.a.loa]=Ab,md=this.insertAgave(Ia,bc));return md}zxa(K,Ia,Ab,bc=null){if(K&&Ia){K=new Fh.a(K,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const vc=new kf.a("ExcelOnline","Web",this.$.ya.UICultureTag),Tc=new bh.a;Tc.optionalProperties[dg.a.vVc]=Ab;bc&&(bc.sourceLocationOverrideResourceId&&(Tc.optionalProperties[dg.a.sourceLocationOverrideResourceId]=bc.sourceLocationOverrideResourceId),bc.Wk&&(Tc.optionalProperties[dg.a.Wk]=bc.Wk),bc.ek&&
(Tc.optionalProperties.IconCssClass=bc.ek),bc.XXd&&(Tc.optionalProperties.TaskPaneIconUrl=bc.XXd),bc.oO&&(Tc.optionalProperties.TaskPaneIconId=bc.oO));Sg.a.instance.zxa(K,th.a.action,Ia,vc,Tc)}}b_h(K){if(!ci.a.lh(K)){var Ia=K[Sc.a.Uub];if(Ia&&(Ia=Ia.getId(),K=K[Sc.a.rma],Ia&&K))return this.L3a(Ia,K.optionalProperties[dg.a.sourceLocationOverrideResourceId])}return null}L3a(K,Ia=null){return K&&Ia?`${K}.${Ia}`:K}uRh(K){switch(K){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return C.EwaSettings.sa(217)?
1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}KZd(){this.$.ea.Zf?this.NKd():(this.$.ea.Dk(this.NKd),this.Sbb=!0)}p4h(){var K=this.$.da.Aa(20);if(!K)return this.KZd(),"";K=K.VKa();if(!K)return this.KZd(),"";var Ia=this.$.va.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Ia=Nh.d(Ia);var Ab=Cg.h(this.$).ha.qa.selectedRanges;const bc=[];for(const Tc of Ab){Ab=new id.a(Tc,Ia);var vc=K.Gxb(Ab,Gc.Valid);Ab=[];
if(vc)for(const ad of vc)(vc=ad.table.mA)&&(vc=vc.range.toString())&&Ab.push(vc);Ab=new Hi(Tc.toString(),Ab);bc.push(Ab)}return JSON.stringify(bc)}}rd.Jdi="Microsoft.Office.Excel.IdeasXLOPreload";rd.VEd="IDS";rd.Mbf="FA000000012";rd.K5a="FA000000005";rd.Qbi="HelloWorld";rd.$2g="FA000000014";rd.Odc="Help.GiveFeedback.Url";rd.j9g="Help.ContactSupport.Url";rd.dFh="feedback";rd.qqf="FA000000066";rd.f7i="PowerBi.Url";rd.d7i="PowerBi.DevUrl";rd.e7i="FA000000054";rd.iKi="FA000000064";rd.c2i="FA000000075";
rd.w0b="AnalyzeDataTaskPane";rd.qdj="RecommendedChartsTaskPane";rd.m5i="PivotTableTaskPane";rd.lkh=350;rd.udf=320;rd.W9i=320;rd.pPg="g_InstallOrigin";rd.ita=K=>{const Ia={};Ia.Version=K.version;Ia.AssetId=K.assetId;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Ia.AssetStoreId=K.assetStoreId:Ia.AssetStoreId=null!==K.assetStoreId?K.assetStoreId.toString():null;Ia.StoreType=K.storeType;Ia.Height=K.height;Ia.SolutionId=K.solutionId;Ia.StoreId=K.storeId;Ia.TargetType=
K.targetType;Ia.Width=1===Ia.TargetType?0:K.width;Ia.SharedRuntimeId=K.sharedRuntimeId;return Ia};Object(d.a)(rd,"AgaveCommandManager",Aa.a,[527,528]);class Jd extends h.a{constructor(K){super();this.$=K;this.Db()}create(){const K=this.$.da,Ia=Uf.GetServiceTaskFactory.create(K,106,this.la,this.Xa),Ab=Uf.GetServiceTaskFactory.create(K,104,this.la,this.Xa),bc=ii.a.loadScript(35,0,this.Xa,void 0,void 0,375);Af.TaskExtensions.za(Af.TaskExtensions.Fd([Ab,Ia,bc],this.la),()=>{let vc=null;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(vc=qc.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);xh.instance.initialize(Ia.result);const Tc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Wc.a)(this.$.da,374,()=>new rd(this.$,Ia.result,Ab.result,vc,Ad.AFrameworkApplication.rb)):new rd(this.$,Ia.result,Ab.result,vc,Ad.AFrameworkApplication.rb);K.Ha(206,Tc);this.nb(K.Aa(374)||K.Ha(374,Tc))},this.la,3);qc.a.instance.register(Ai.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").qc().yc(()=>
new Ai.a(this.$.eu))}static ka(K){K.da.Ha(375,new Jd(K))}}Object(d.a)(Jd,"AgaveCommandManagerFactory",h.a,[]);var Nd=a(563);class ee{constructor(){this.initialized=!1;this.agaveCommandManager=this.Md=this.C0a=null;this.OT={}}initialize(K){C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.nrj(K)}Iii(K,Ia){let Ab=Af.TaskExtensions.Tj();if(this.initialized&&K&&0<K.length){let bc=this.iOh(K);K in this.OT&&(Ab=this.agaveCommandManager.insertAgave(bc,
Ia))}return Ab}LHg(K){this.initialized&&(K=K[fg.a.Pf]||{},!K.SolutionId||K.SolutionId in this.OT||this.Md.cda(Ia=>{this.cda(Ia)},!0))}A$h(K){this.initialized&&(K=K||"")&&0<K.length&&K in this.OT&&(delete this.OT[K],this.Md.cda(Ia=>{this.cda(Ia)},!0))}iOh(K){return K in this.OT?this.OT[K]:{}}cda(K){var Ia=!1;if(K&&!K.errorCode){if(K.value)for(const Ab of K.value)K=Ab[1],Ab[3]==OSF.OsfControlTarget.InContent&&K&&0<K.length&&!(K in this.OT)&&(Ia={NoReporting:!1,IsSystemInitiated:!1},Ia.description=Ab[2],
Ia.iconUrl=Ab[9],Ia[la.a.z9]={solutionId:Ab[1],version:Ab[4],storeType:Ab[12],storeId:Ab[11],assetId:Ab[5],assetStoreId:Ab[6],targetType:Ab[3],width:Ab[7],height:Ab[8],displayName:Ab[0],id:Ab[1]},Ia[fg.a.Pf]={SolutionId:Ab[1],Version:Ab[4],StoreType:Ab[12],StoreId:Ab[11],AssetId:Ab[5],AssetStoreId:Ab[6],TargetType:Ab[3],Width:Ab[7],Height:Ab[8],Id:Ab[1]},this.OT[K]=Ia,Ia=!0);Ia&&this.$bh()}}$bh(){let K=[];for(const Ia in this.OT)K.push({id:Ia,controlType:0,title:this.OT[Ia][la.a.z9].displayName});
if(0<K.length){for(const Ia in this.OT)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ia,this.OT[Ia].iconUrl);this.l4g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:ee.Kyf,isOfficeTab:!0,groups:[{id:ee.tff,title:ee.uff,controls:K}]}]});for(const Ia in this.OT)this.C0a.addCommandToMaps(Object(xc.a)(new Je.a(Ia,"-1473679467"),{legacyControlId:Ia}))}}l4g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:ee.Kyf,isOfficeTab:!0,groups:[{id:ee.tff,title:ee.uff,controls:[]}]}]})}nrj(K){const Ia=
Uf.GetServiceTaskFactory.Oa(K.da,374,375,1),Ab=Uf.GetServiceTaskFactory.create(K.da,106,K.la,1);Af.TaskExtensions.za(Af.TaskExtensions.Fd([Ia,Ab],K.la),()=>{this.agaveCommandManager=Ia.result;this.C0a=qc.a.instance.mg("Common.IExternalUICommandDefinitionMapping")||new Nd.a(K.Bb,K);Ad.AFrameworkApplication.rb.Nb(Bc.a.EUf,rh.a.frame,(bc,vc,Tc,ad,md)=>{this.A$h(md)});this.Md=Ab.result;this.Md.cda(bc=>{this.cda(bc)},!0);this.initialized=!0},K.la,3)}}ee.Kyf="tabinsert";ee.tff="installedContentAddins";
ee.uff=Tb.a.instance.ga(2282);Object(d.a)(ee,"AgaveCommandRibbon",null,[526]);class ye extends h.a{constructor(K){super();this.$=K;this.Db()}create(){if(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const K=this.$.da,Ia=new ee;Ia.initialize(this.$);this.nb(K.Aa(488)||K.Ha(488,Ia))}}static ka(K){K.da.Ha(489,new ye(K))}}Object(d.a)(ye,"AgaveCommandRibbonFactory",h.a,[]);var He=a(1325),Xe=a(745);class Pf{constructor(){this.l9d=this.G8d=
this.cfa=null;this.Fjb=0}get displayName(){return this.cfa}set displayName(K){this.cfa=K}get email(){return this.G8d}set email(K){this.G8d=K}get federationProvider(){return this.l9d}set federationProvider(K){this.l9d=K}get identityType(){return this.Fjb}set identityType(K){this.Fjb=K}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(K){switch(K){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}static kdh(K){const Ia=new Pf;Ia.displayName=K.displayName;Ia.email=K.email;
switch(K.authority){case He.a.mKf:Ia.identityType=1;break;default:Ia.identityType=0}Ia.federationProvider="";return Ia}}Object(d.a)(Pf,"OfficeIdentityInfo",null,[]);class Sf{static get uQe(){return Sf.Xvg}static acc(K){return K in Sf.uQe?Sf.uQe[K].toString():K}}Sf.map=null;Sf.Xvg={["GeneralException"]:Xe.a.generalException,["AccessDenied"]:Xe.a.rVc,["ApiNotAvailable"]:Xe.a.apiNotAvailable,["UserNotSignedIn"]:Xe.a.userNotSignedIn,["UserAborted"]:Xe.a.userAborted,["UnsupportedUserIdentity"]:Xe.a.MYj,
["InvalidResourceUrl"]:Xe.a.invalidResourceUrl,["InvalidGrant"]:Xe.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:Xe.a.rPg,["ResourceNotAllowed"]:Xe.a.cpj,["ClientError"]:Xe.a.clientError,["ServerError"]:Xe.a.serverError};Object(d.a)(Sf,"SingleSignOnErrorCodeMap",null,[]);class jf{constructor(K,Ia){this.jRb=K;this.Fjb=Ia}get accessToken(){return this.jRb}set accessToken(K){this.jRb=K}get tokenIdenityType(){return this.Fjb}set tokenIdenityType(K){this.Fjb=K}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(K){switch(K){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(jf,"SingleSignOnToken",null,[]);class gg{constructor(){this.a5d=null;this.Wie=this.XWb=this.OD="";this.hke=!0;this.options=null}get authChallenge(){return this.a5d}set authChallenge(K){this.a5d=
K}get correlationId(){return this.OD}set correlationId(K){this.OD=K}get policy(){return null}set policy(K){}get resource(){return this.XWb}set resource(K){this.XWb=K}get scope(){return this.Wie}set scope(K){this.Wie=K}get silentLogin(){return this.hke}set silentLogin(K){this.hke=K}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(K){switch(K){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(gg,"TokenParameters",null,[461]);class Zf{constructor(K,Ia){this.bib=Ia;this.cA=K}get roamingSettings(){return null}getAccessToken(K){const Ia=this.bib.getOsfControl(this.cA),Ab=Ia.getManifest(),bc=Ab.getMarketplaceID();this.YNa(K,bc);return OfficeExtension.WacRuntime.Utility.createPromise((vc,Tc)=>{Ia.isFirstParty()&&this.bib._enableFirstPartySSO?this.Eli(Ab,K)?qc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(K,
bc).then(ad=>{vc(ad)},ad=>{Tc(ad)}):Tc(Xe.a.rVc):Tc(Xe.a.apiNotAvailable)}).then(vc=>{let Tc;switch(vc.authority){case He.a.mKf:Tc=1;break;default:Tc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new jf(vc.accessToken,Tc))},vc=>{this.logErrorResponse(K,bc,vc);return vc?OfficeExtension.WacRuntime.Utility.createPromise((Tc,ad)=>{ad(OfficeExtension.WacRuntime.Utility.createRichApiException(vc,Sf.acc(vc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Tc,ad)=>{ad(OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,
Sf.acc(Xe.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const K=this.bib.getOsfControl(this.cA);K.getManifest();const Ia=K.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Ab,bc)=>{qc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ia).then(vc=>{Ab(vc)},vc=>{bc(vc.toString())})}).then(Ab=>{Ab=Pf.kdh(Ab);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Ab)},Ab=>Ab?OfficeExtension.WacRuntime.Utility.createPromise((bc,
vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ab,Sf.acc(Ab)))}):OfficeExtension.WacRuntime.Utility.createPromise((bc,vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,Sf.acc(Xe.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(K){switch(K){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.zNh(Ia);case 3:return this.TOh();case 2:return this.h0h()}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}zNh(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,gg);return this.getAccessToken(K)}TOh(){return this.getAuthContext()}h0h(){return this.getPrimaryIdentityInfo()}Eli(K,Ia){let Ab=!1;const bc=K.getWebApplicationAuthorizations();K=null;for(const vc of bc)if(vc.getResource().toLowerCase()===Ia.resource.toLowerCase()){K=vc;Ab=!0;break}if(!Ab)return!1;Ia=Ia.scope.split(" ,+");for(const vc of Ia)if(vc&&vc.length){Ia=
!1;for(const Tc of K.getScopes())vc.toLowerCase()===Tc.toLowerCase()&&(Ia=!0);if(!Ia)return!1}return!0}YNa(K,Ia){K=this.wyf(K.resource);r.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ia,["resource"]:K})}logErrorResponse(K,Ia,Ab){K=this.wyf(K.resource);r.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ia,["resource"]:K,["error"]:Ab})}wyf(K){return K.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Zf,"AuthenticationService",null,[]);class ng{create(K,
Ia){return new Zf(K,Ia)}}Object(d.a)(ng,"AuthenticationServiceFactory",null,[]);var Lg=a(865),Hg=a(981),ug=a(963);class ig{}ig.generalException="generalException";ig.invalidArgument="invalidArgument";ig.notAllowed="notAllowed";ig.apiNotAvailable="apiNotAvailable";ig.unresolvedPendingRequest="unresolvedPendingRequest";ig.timeout="timeout";ig.adalTimeout="adalTimeout";ig.userNotSignedIn="userNotSignedIn";ig.userAborted="userAborted";ig.silentSignInFailed="silentSignInFailed";ig.invalidResourceUrl="invalidResourceUrl";
ig.invalidGrant="invalidGrant";ig.connectionLost="connectionLost";ig.clientError="clientError";ig.serverError="serverError";Object(d.a)(ig,"WopiHostErrorCodes",null,[]);var hh=a(555);class sf{}Object(d.a)(sf,"OAuthCallerMetadata",null,[]);var Wf=a(27);class Ue{constructor(K){this.Pxa=K;this.Ovg=Ad.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}YGg(K,Ia,Ab,bc,vc,Tc){if(!this.Pxa)return bc=new Hg.a,bc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(bc);const ad=new sf;ad.AddinName=vc;ad.AddinTrustId=Tc;let md=-1;Tc=null;if(bc&&this.xjf())Tc=this.Pxa.Ogg(la.a.bCc,K,bc,Ue.f6e(vc),ad);else{const Ed=Date.now();Tc=this.Pxa.wO(la.a.bCc,K,ad).then(Xd=>{md=Date.now()-Ed;const Fe=(Ia||Ab)&&"login_required"===Xd.ErrorCode;return(Ia&&("interaction_required"===Xd.ErrorCode||"consent_required"===Xd.ErrorCode||"invalid_grant"===Xd.ErrorCode)||Fe)&&this.xjf()?this.Pxa.Ogg(la.a.bCc,K,null,Ue.f6e(vc),ad):Promise.resolve(Xd)})}return Tc.then(Ed=>
{const Xd=new Hg.a;Ed.IsSuccess?(Xd.token=Ed.Token,Ed.Telemetry&&(Xd.ITa=Ed.Telemetry.fromCache,Xd.expiresOn=Ed.Telemetry.expiresOn)):(Xd.errorCode=this.$Fi(Ed),Xd.dYd=this.s3i(Ed));return Xd}).catch(()=>{const Ed=new Hg.a;Ed.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ed)}).then(Ed=>{Ed.Zga="OauthManager";0<=md&&(Ed.Txb=md);return Ed})}foi(K){const Ia=(Ad.AFrameworkApplication.fa.Wa(Ad.AFrameworkApplication.C7)||"").toLowerCase();return(Wf.a.hxa||"teams"===
Ia&&hh.OAuthManagerSettings.$yb)&&!Ue.Kni(K)||!this.Pxa||!this.Pxa.o6a()?!1:!0}xjf(){return this.Ovg||1!==ug.a.nbc()}$Fi(K){switch(K.ErrorCode){case "UserCancelled":case "interaction_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":K=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:K=K.ErrorCode===ig.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:K.ErrorCode===ig.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:K.ErrorCode===ig.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
K.ErrorCode===ig.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:K.ErrorCode===ig.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return K}s3i(K){let Ia="";(K=RegExp("AADSTS(\\d+)").exec(K.ErrorMessage))&&1<K.length&&(Ia=K[1]);return Ia}static f6e(K){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,K)}static Kni(K){if(!K)return!1;K=K.toLowerCase();for(const Ia of Lg.AppsForOfficeSingleSignOnManager.oYe)if(Ia===
K)return!0;return!1}}Object(d.a)(Ue,"AppsforOfficeTokenFromOauthManager",null,[686]);class Bf{constructor(K){this.hFi=K}static Aoa(){if(Ad.AFrameworkApplication.fa.pa("AppForOfficeSSOV2IsEnabled")){var K=null;try{K=qc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ia){r.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ia)}K=new Ue(K);Bf.La=new Bf(K)}}static getInstance(){Bf.gae||(Bf.Aoa(),Bf.gae=!0);return Bf.La}}Bf.La=null;Bf.gae=!1;Object(d.a)(Bf,"AppsForOfficeOauthManagerFactory",
null,[665]);var Qf=a(1324),bg=a(136);class Xf{constructor(K,Ia,Ab,bc){this.menuItemId=K;this.HF=Ia;this.xOj=Ab;this.OFh=bc}}Object(d.a)(Xf,"NewDocumentParameters",null,[]);const Of=K=>{var Ia=K.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Ab=Ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ab.addParameter("shortcuts","String[]",1,null,0);Ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Ab=Ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ab.addParameter("shortcuts","Object",1,null,0);Ia=K.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ab=Ia.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Ab.addParameter("pickerCustomizationJsonString","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}",
"",3,0);Ab=Ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Ab.addParameter("base64File","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ab=Ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Ab.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=
K.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Ab=Ia.addMethod("Register",1,"Void",0,0,"Register",0);Ab.addParameter("metadata","String",1,null,0);Ab.addParameter("javascript","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ia.addProperty("Enabled",
1,"Boolean",1,!1,null,0);Ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ia=K.addEnumType("Microsoft.Authentication.IdentityType");Ia.addEnumField("OrganizationAccount",0);Ia.addEnumField("MicrosoftAccount",1);Ia=K.addEnumType("Microsoft.Authentication.AuthorityType");Ia.addEnumField("External",0);Ia.addEnumField("Msa",1);Ia.addEnumField("Aad",2);Ia=K.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}",
"{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ia.addProperty("DisplayName",4,"String",1,!1,null,0);Ia.addProperty("Email",3,"String",1,!1,null,0);Ia.addProperty("FederationProvider",2,"String",1,!1,null,0);Ia.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ia.addProperty("AppId",4,"String",1,!1,null,0);Ia.addProperty("Authority",
2,"String",1,!1,null,0);Ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ia.addProperty("TenantId",6,"String",1,!1,null,0);Ia.addProperty("Upn",1,"String",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,
null,0);Ab=Ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Ab.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ia=K.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",
2,0);Ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ia.addProperty("CorrelationId",7,"String",1,!1,null,0);Ia.addProperty("Policy",4,"String",1,!1,null,0);Ia.addProperty("Resource",2,"String",1,!1,null,0);Ia.addProperty("Scope",5,"String",1,!1,null,0);Ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ia.addProperty("AccessToken",2,"String",1,
!1,null,0);Ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ia.addProperty("Id",1,"String",1,!0,null,0);Ia.addProperty("Value",2,"Object",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Ab=Ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Ab.addParameter("id",
"String",1,null,0);Ab=Ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Ab.addParameter("id","String",1,null,0);Ia=K.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ab=Ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ab.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=K.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ia.addEnumField("Inactive",0);Ia.addEnumField("Background",1);Ia.addEnumField("Visible",2);Ia=K.addEnumType("Microsoft.AppRuntime.Visibility");Ia.addEnumField("Hidden",1);Ia.addEnumField("Visible",2);Ia=K.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Ab=Ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ab.addParameter("jsonCreate","String",1,null,0);Ab=Ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ab.addParameter("jsonUpdate","String",1,null,0);Ab=Ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ab.addParameter("id","String",1,null,0);Ab=Ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ab.addParameter("id","String",1,null,
0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Ab=Ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ab.addParameter("visibility","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ia.addProperty("Enabled",3,"Boolean",
1,!1,null,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Ia.addProperty("Label",4,"String",1,!0,null,0);Ab=Ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ab.addParameter("enabled","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ia.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ab=Ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ab.addParameter("key",
"String",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ia=K.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ia.addEnumField("Unknown",0);Ia.addEnumField("Basic",1);Ia.addEnumField("Premium",2);Ia=K.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ab=Ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);Ab.addParameter("feature","String",1,null,0);Ab.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ab=Ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ab.addParameter("feature","String",1,null,0);Ab=Ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ab.addParameter("feature","String",1,null,0);Ab.addParameter("fallbackValue","Boolean",1,null,0);Ia.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ab=Ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ab.addParameter("experienceId","String",1,null,0);Ab=Ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ab.addParameter("feature","String",1,null,0);Ia=K.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ia.addProperty("Id",5,"String",1,!0,null,0);Ia.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);Ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ia=K.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ia=K.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);Ia.addMethod("Disable",3,"Void",0,1,"Disable",0);Ia.addMethod("Enable",2,"Void",0,1,"Enable",0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Ff=a(189);class kg{constructor(K,Ia){this.gAg=K;this.CAg=Ia}createAndOpenWorkbook(K){if(K&&K.length>this.gAg)throw r.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",K.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.invalidArgument,Ff.a.ga(1766));const Ia=new Xf("blank","agave",K?"streamBase64":"streamEmpty",
K);let Ab=null;return OfficeExtension.WacRuntime.Utility.createPromise((bc,vc)=>{const Tc=new bg.StandardDialog;Tc.Ob=4;Tc.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,ad=>{2===ad||0===ad?vc("Cancelled"):(Ab=window.open(""),this.CAg.create(bc,vc,Ia).c1a())})}).then(bc=>{if(!bc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,Ff.a.ga(1762));try{Ab.top.location.href=bc}catch(vc){r.ULS.sendTraceTag(538572820,0,10,
"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Wf.a.$o,vc),r.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Ab.location.replace(bc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},bc=>{if("Cancelled"===bc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.YEd,Ff.a.ga(1765));Ab.close();this.HRj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.Wah(Ia)}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Wah(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.createAndOpenWorkbook(K)}HRj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,Ff.a.ga(1762));}}Object(d.a)(kg,"WacWorkbook",null,[]);const dh=(K,Ia)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof K+", objectId="+K+", value="+Ia);return null},$f=K=>{K.add("InternalTest",
"PreviewExecutionMethod",dh)};var nh=a(253),Tf=a(744),$i=a(753);class Li{constructor(K){this.jb=K}get $(){return this.jb}}Object(d.a)(Li,"RichApiPreviewExecutionContext",null,[]);var sg=a(24),Rg=a(987),eh=a(213),hg=a(215),Mg=a(87),ih=a(12);class uh extends hg.a{constructor(K,Ia,Ab,bc,vc){super(K,"Select Data");this.htmlSanitizationHelper=this.Tpb=null;this.iKe=Ia;this.G7c=Ab;this.htmlSanitizationHelper=vc;this.callback=bc}get kc(){return"DdaBindingPrompt"}start(K,Ia){let Ab="<div class='"+Mg.a.Puh+
" "+mg.a.fo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Mg.a.Mx+"' /></div>";Ab=String.format(Ab,Lf.a.yg(this.G7c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ph(this.Fb,Ab):this.Fb.innerHTML=Ab;this.Tpb=
ih.DOMElementExtensions.getElementById(this.Fb,"bindingText");K=Ia?K.h3a(Ia,this.G7c.DdaBindingsMethod.BindingId):null;(null===K||void 0===K?0:K.IsValidRef)?(Ia=new sg.Range(K.Reference.FirstRow+1,K.Reference.FirstColumn+1,K.Reference.LastRow+1,K.Reference.LastColumn+1,!1,!1),this.Tpb.value=K.Reference.SheetName+"!"+Ia):(K=Cg.h(this.$).ha,this.Tpb.value=Nh.f(this.$.na)||!K.qa.Tg?"":K.cia);this.initialize();this.kg()}Yp(){this.h2c();this.addButton(0);this.addButton(1);super.Yp()}setFocus(){ih.DOMElementExtensions.setFocus(this.Tpb)}validate(){return!0}commit(){let K=
this.Tpb.value.trim();const Ia=K.indexOf("!");-1!==Ia&&(K=this.h3h(K.substring(0,Ia))+K.substr(Ia));this.iKe.addBinding(this.G7c,K,0,this.callback);return!0}Asa(){this.iKe.SP.zf(Tf.a.internalError,this.callback);super.Asa()}h3h(K){K=Kf.a.trimStart(K.trim(),"=");return K.length?K.startsWith("'")&&K.endsWith("'")?K:Eh.HelperMethods.n9b(K):""}}Object(d.a)(uh,"DdaBindingPrompt",hg.a,[]);class Hh{constructor(K){this.ea=K}zf(K,Ia){if(Ia){const Ab={};Ab.Error=K;Ab.Version=this.ea.se;Ia(Ab)}}dKa(K,Ia){this.zf(K,
Ia)}$G(K,Ia){this.zf(Tf.a.NZe(K.Errors[0].MessageId),Ia)}kv(K){K&&K(this.BP())}BP(){const K={Error:0};K.Version=this.ea.se;return K}}Object(d.a)(Hh,"DdaErrorGenerator",null,[]);var Ig=a(250);class Mi{constructor(K,Ia,Ab){this.$=K;this.SP=Ia;this.Rz=Ab}dAd(K,Ia){const Ab=K.DdaGoToByIdMethod.GoToType,bc=K.DdaGoToByIdMethod.SelectionMode,vc=K.DdaGoToByIdMethod.Id.toString().trim(),Tc=ad=>{const md=this.$.va.getItemByName(ad.SheetName);(null===md||void 0===md?0:md.visible)?(Cg.h(this.$).qg(ad,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.SP.kv(Ia)):this.SP.zf(Tf.a.F1g,Ia)};0===Ab?this.ZJi(vc,bc,K.DdaMethod.ControlId,Tc,Ia):1===Ab?this.cKi(vc,bc,Tc,Ia):this.SP.zf(Tf.a.JYj,Ia)}ZJi(K,Ia,Ab,bc,vc){this.Rz.ddaGetBinding(Ab,K,Tc=>{if(!Ig.a(Tc)&&Tc.Result&&Tc.Result.Reference){Tc=Tc.Result;var ad={};ad.SheetName=Tc.Reference.SheetName;ad.FirstRow=Tc.Reference.FirstRow;ad.FirstColumn=Tc.Reference.FirstColumn;ad.LastRow=Tc.Reference.LastRow;ad.LastColumn=Tc.Reference.LastColumn;
Mi.eYc(ad,Ia);1!==Tc.BindingType?bc(ad):this.Rz.ddaGetBindingData(Ab,K,1,0,2,0,0,-1,-1,md=>{Ig.a(md)||!md.Result?this.SP.$G(md,vc):(md=md.Result,2!==Ia&&(ad.FirstRow-=md.Headers.length,0>ad.FirstRow&&(ad.FirstRow=0)),bc(ad))},vc)}else this.SP.dKa(Tf.a.Iag,vc)},vc)}cKi(K,Ia,Ab,bc){var vc=Dh.z(K);vc?(vc=Dh.v(vc,this.$),Mi.eYc(vc,Ia),Ab(vc)):this.$.ea.isNamedObjectViewMode&&this.$.yb.Gk(K)?this.$.yb.na=this.$.yb.getItemByName(K):(vc=Tc=>{Ig.a(Tc)||!Tc.Result?this.$.va.contains(K)?(Tc={},Tc.SheetName=
K,Tc.FirstRow=0,Tc.FirstColumn=0,Tc.LastRow=0,Tc.LastColumn=0,Ab(Tc)):this.SP.dKa(Tf.a.Iag,bc):(Tc=Tc.Result,Mi.eYc(Tc,Ia),Ab(Tc))},this.$.va.na?this.Rz.parseRangeForGoto(K,this.$.va.na.name,vc,bc):this.Rz.parseRange(K,vc,bc))}static eYc(K,Ia){K.LastRow=2===Ia?K.FirstRow:K.LastRow;K.LastColumn=2===Ia?K.FirstColumn:K.LastColumn}}Object(d.a)(Mi,"DdaNavigator",null,[]);const dj=(K,Ia,Ab,bc,vc,Tc)=>{const ad=K.Na(1);ad.request=Ia;return Dg.g(K,"ExecuteRichApiRequest",ad,Ab,bc,vc,Tc,0)};var ej=a(296),
Ti;(function(K){K[K.unsupported=0]="unsupported";K[K.surface=1]="surface";K[K.combo=2]="combo";K[K.column=3]="column";K[K.column3D=4]="column3D";K[K.bar=5]="bar";K[K.bar3D=6]="bar3D";K[K.line=7]="line";K[K.line3D=8]="line3D";K[K.pie=9]="pie";K[K.pie3D=10]="pie3D";K[K.scatter=11]="scatter";K[K.bubble=12]="bubble";K[K.area=13]="area";K[K.area3D=14]="area3D";K[K.doughnut=15]="doughnut";K[K.radar=16]="radar";K[K.stock=17]="stock";K[K.waterfall=18]="waterfall";K[K.funnel=19]="funnel";K[K.treemap=20]="treemap";
K[K.sunburst=21]="sunburst";K[K.boxWhisker=22]="boxWhisker";K[K.histogram=23]="histogram";K[K.pareto=24]="pareto";K[K.regionMap=25]="regionMap";K[K.noVisibleSeries=26]="noVisibleSeries";K[K.complexDataSource=27]="complexDataSource";K[K.pivotChart=28]="pivotChart"})(Ti||(Ti={}));Object(d.b)("ChartCategory",Ti);class fj{constructor(K,Ia){this.source=K;this.eventId=Ia}}Object(d.a)(fj,"MacroRecorderEventData",null,[]);class oh{constructor(K,Ia,Ab){this.parentName=K;this.$=Ia;this.request=Ab}A1h(K){var Ia;
if(void 0===K||null===K||void 0===K.RequestBody||null===K.RequestBody)return null;const Ab=JSON.parse(K.RequestBody);if(void 0!==K.ActiveChartId&&null!==K.ActiveChartId){Ab.ActiveChartId=K.ActiveChartId;const bc=Cg.h(this.$).ha.Sa.dc;if(null===(Ia=null===bc||void 0===bc?void 0:bc.floatingObject)||void 0===Ia?0:Ia.Wc)Ab.ActiveChartType=Ti[bc.floatingObject.Wc.ChartCategory]}void 0!==K.SheetMultiRange&&null!==K.SheetMultiRange&&(Ab.SheetName=K.SheetMultiRange.SheetName);return Ab}M1h(K){if(void 0===
K||null===K||void 0===K.Result||null===K.Result)return null;K=K.Result;return void 0===K.ResponseBody||null===K.ResponseBody||K.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(K.ResponseBody.join(""))}Isi(K){return!!K&&!(void 0===K.eventId||null===K.eventId)&&0<K.eventId.length}Vj(K){return()=>{if(this.$.vba){const Ia=this.SYg(this.request);if(this.Isi(Ia)){const Ab=this.A1h(this.request),bc=this.M1h(K);if(Ab&&!ci.a.isEmpty(Ab)&&bc&&!ci.a.isEmpty(bc))return r.ULS.sendTraceTag(537163164,0,
50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new aa(Ia,Ab,bc);r.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Ab?"(not null)":"(null)"}; responseInfo: ${bc?"(not null)":"(null)"}`}`)}}return new aa(null,null,null)}}SYg(K){const Ia=this.Jsi(K.SolutionId),Ab=oh.g1h(K);if(Ab&&Ia)return r.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Ab,["request.SolutionId"]:K.SolutionId})}`),
new fj(K.SolutionId,Ab);K=JSON.stringify({["recorderEventId"]:Ab,["isRecorderAwareAddin"]:Ia,["request.SolutionId"]:K.SolutionId});r.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${K}`);return null}Jsi(K){if(!K)return!1;K=K.toLowerCase();return oh.e7h().contains(K)}static e7h(){oh.Hza||(oh.Hza=new n.a(N.a.Ni()),oh.Hza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),oh.Hza.add("fa000000005"),oh.Hza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),oh.Hza.add("fa000000014"),oh.Hza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return oh.Hza}static g1h(K){let Ia=null;var Ab=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Ab.test(K.RequestBody))Ia=Ab.exec(K.RequestBody)[1];else{K=K.RequestHeaders;if(!K)return Ia;Ab=Od.a.DMi.toLowerCase();for(let bc=0;bc<K.length;bc++)if(K[bc].Name.toLowerCase()===Ab){Ia=K[bc].Value;break}}return Ia}}oh.Hza=null;Object(d.a)(oh,"DdaRichApiRequestRecorder",null,[]);class gj extends ej.a{constructor(K,Ia,Ab,bc,vc,Tc,ad,md){super(10,0,Ia,md);this.Dmb=Ab;this.Vib=
bc;this.g3=vc;this.xFa=Tc;this.request=ad;this.MOd=new oh("10",K,ad)}get CEc(){return this.xFa}get Kt(){return this.Dmb}get taa(){return this.Vib}w2(K){return super.w2(K)||this.z0g(K)}Vj(){return this.MOd.Vj(this.od)}vfb(){const K={OperationType:3};K.RichApiRequest=this.request;return K}z0g(K){return(Ia,Ab,bc)=>dj(K,this.request,Vf.b(Ia,this.Dmb),Vf.a(Ab,this.Vib),bc,this.g3)}}Object(d.a)(gj,"DdaRichApiRequestBatchOperation",ej.a,[]);class hj extends Oh.a{constructor(K,Ia,Ab,bc){super(576,0,Ab,bc);
this.MOd=new oh("576",K,Ia)}Vj(){return this.MOd.Vj(this.od)}}Object(d.a)(hj,"DdaRichApiRequestOperation",Oh.a,[]);class ij{constructor(K,Ia){this.UH=(Ab,bc)=>{this.SP.dKa(Tf.a.internalError,bc)};this.$=K;this.SP=Ia}ddaAddBinding(K,Ia,Ab,bc,vc,Tc,ad){this.zJ((md,Ed,Xd)=>{var Fe=this.$.oa.xa,Me=this.sja();md=Vf.b(md,Tc);Ed=Vf.a(Ed,this.UH);const lf=Fe.Na(9);lf.controlId=K;lf.bindingId=Ia;lf.bindingType=Ab;lf.currentSheetName=Me;lf.formula=bc;lf.options=vc;return Dg.g(Fe,"DdaAddBinding",lf,md,Ed,Xd,
ad,0)},ad,563)}ddaReleaseBinding(K,Ia,Ab,bc){this.zJ((vc,Tc,ad)=>{var md=this.$.oa.xa;vc=Vf.b(vc,Ab);Tc=Vf.a(Tc,this.UH);const Ed=md.Na(9);Ed.controlId=K;Ed.bindingId=Ia;return Dg.g(md,"DdaReleaseBinding",Ed,vc,Tc,ad,bc,0)},bc,564)}ddaGetBinding(K,Ia,Ab,bc){this.zJ((vc,Tc,ad)=>{var md=this.$.oa.xa;vc=Vf.b(vc,Ab);Tc=Vf.a(Tc,this.UH);const Ed=md.Na(1);Ed.controlId=K;Ed.bindingId=Ia;return Dg.g(md,"DdaGetBinding",Ed,vc,Tc,ad,bc,0)},bc,565,16)}ddaGetAllBindings(K,Ia,Ab){this.zJ((bc,vc,Tc)=>{var ad=this.$.oa.xa;
bc=Vf.b(bc,Ia);vc=Vf.a(vc,this.UH);const md=ad.Na(1);md.controlId=K;return Dg.g(ad,"DdaGetAllBindings",md,bc,vc,Tc,Ab,0)},Ab,566,16)}ddaGetBindingData(K,Ia,Ab,bc,vc,Tc,ad,md,Ed,Xd,Fe){this.zJ((Me,lf,tg)=>{var jg=this.$.oa.xa,cg=this.sja();Me=Vf.b(Me,Xd);lf=Vf.a(lf,this.UH);const eg=jg.Na(1);eg.controlId=K;eg.bindingId=Ia;eg.coerceType=Ab;eg.valueFormat=bc;eg.filterType=vc;eg.startRow=Tc;eg.startCol=ad;eg.rowCount=md;eg.colCount=Ed;eg.currentSheetName=cg;return Dg.g(jg,"DdaGetBindingData",eg,Me,lf,
tg,Fe,0)},Fe,567,16)}ddaSetBindingData(K,Ia,Ab,bc,vc,Tc,ad){this.zJ((md,Ed,Xd)=>{var Fe=this.$.oa.xa,Me=this.sja();md=Vf.b(md,Tc);Ed=Vf.a(Ed,this.UH);const lf=Fe.Na(9);lf.controlId=K;lf.bindingId=Ia;lf.startRow=Ab;lf.startCol=bc;lf.currentSheetName=Me;lf.bindingData=vc;return Dg.g(Fe,"DdaSetBindingData",lf,md,Ed,Xd,ad,0)},ad,568)}ddaGetSelectedData(K,Ia,Ab,bc,vc,Tc,ad){this.zJ((md,Ed,Xd)=>{var Fe=this.$.oa.xa,Me=this.sja();md=Vf.b(md,Tc);Ed=Vf.a(Ed,this.UH);const lf=Fe.Na(1);lf.controlId=K;lf.coerceType=
Ia;lf.valueFormat=Ab;lf.filterType=bc;lf.currentSheetName=Me;lf.formula=vc;return Dg.g(Fe,"DdaGetSelectedData",lf,md,Ed,Xd,ad,0)},ad,569,16)}ddaSetSelectedData(K,Ia,Ab,bc,vc){this.zJ((Tc,ad,md)=>{var Ed=this.$.oa.xa,Xd=this.sja();Tc=Vf.b(Tc,bc);ad=Vf.a(ad,this.UH);const Fe=Ed.Na(9);Fe.controlId=K;Fe.currentSheetName=Xd;Fe.formula=Ia;Fe.bindingData=Ab;return Dg.g(Ed,"DdaSetSelectedData",Fe,Tc,ad,md,vc,0)},vc,570)}ddaLoadSettings(K,Ia,Ab){this.zJ((bc,vc,Tc)=>{var ad=this.$.oa.xa;bc=Vf.b(bc,Ia);vc=Vf.a(vc,
this.UH);const md=ad.Na(1);md.controlId=K;return Dg.g(ad,"DdaLoadSettings",md,bc,vc,Tc,Ab,0)},Ab,501,16)}ddaSaveSettings(K,Ia,Ab,bc,vc){this.zJ((Tc,ad,md)=>{var Ed=this.$.oa.xa;Tc=Vf.b(Tc,bc);ad=Vf.a(ad,this.UH);const Xd=Ed.Na(9);Xd.controlId=K;Xd.settings=Ia;Xd.overwriteIfStale=Ab;return Dg.g(Ed,"DdaSaveSettings",Xd,Tc,ad,md,vc,0)},vc,571)}ddaAddRowsColumns(K,Ia,Ab,bc,vc,Tc){this.zJ((ad,md,Ed)=>{var Xd=this.$.oa.xa,Fe=this.sja();ad=Vf.b(ad,vc);md=Vf.a(md,this.UH);const Me=Xd.Na(9);Me.controlId=K;
Me.bindingId=Ia;Me.isRow=Ab;Me.currentSheetName=Fe;Me.bindingData=bc;return Dg.g(Xd,"DdaAddRowsColumns",Me,ad,md,Ed,Tc,0)},Tc,572)}ddaDeleteAllDataValues(K,Ia,Ab,bc){this.zJ((vc,Tc,ad)=>{var md=this.$.oa.xa,Ed=this.sja();vc=Vf.b(vc,Ab);Tc=Vf.a(Tc,this.UH);const Xd=md.Na(9);Xd.controlId=K;Xd.bindingId=Ia;Xd.currentSheetName=Ed;return Dg.g(md,"DdaDeleteAllDataValues",Xd,vc,Tc,ad,bc,0)},bc,573)}ddaClearBindingFormats(K,Ia,Ab,bc){this.zJ((vc,Tc,ad)=>{var md=this.$.oa.xa,Ed=this.sja();vc=Vf.b(vc,Ab);Tc=
Vf.a(Tc,this.UH);const Xd=md.Na(9);Xd.controlId=K;Xd.bindingId=Ia;Xd.currentSheetName=Ed;return Dg.g(md,"DdaClearBindingFormats",Xd,vc,Tc,ad,bc,0)},bc,574)}ddaSetBindingFormats(K,Ia,Ab,bc,vc,Tc){this.zJ((ad,md,Ed)=>{var Xd=this.$.oa.xa,Fe=this.sja();ad=Vf.b(ad,vc);md=Vf.a(md,this.UH);const Me=Xd.Na(9);Me.controlId=K;Me.bindingId=Ia;Me.currentSheetName=Fe;Me.bindingData=Ab;Me.isSetFormats=bc;return Dg.g(Xd,"DdaSetBindingFormats",Me,ad,md,Ed,Tc,0)},Tc,575)}parseRange(K,Ia,Ab){this.zJ((bc,vc,Tc)=>{const ad=
this.$.oa.xa.Wb();return Dg.v(this.$.oa.xa,K,-1,Vf.b(bc,Ia),Vf.a(vc,this.UH),Tc,Ab,ad)},Ab,162,16)}parseRangeForGoto(K,Ia,Ab,bc){this.zJ((vc,Tc,ad)=>{const md=this.$.oa.xa.Wb();return Dg.w(this.$.oa.xa,K,Ia,Vf.b(vc,Ab),Vf.a(Tc,this.UH),ad,bc,md)},bc,562,16)}executeRichApiRequest(K,Ia,Ab){C.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(K.RequestFlags&=8191);if(C.EwaSettings.sa(233))this.VDh(this.$.oa.xa.Wb(),Ia,()=>{this.SP.dKa(Tf.a.internalError,Ab)},Ab,K);
else{let bc=yg.DdaFacade.Ghd(K);!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.qb.tv||bc&16?(bc|=64,this.$.userOperationManager.FE(new hj(this.$,K,(vc,Tc,ad)=>dj(this.$.oa.xa,K,Vf.b(vc,Ia),Vf.a(Tc,this.UH),ad,Ab),bc))):(this.SP.dKa(Tf.a.FFc,Ab),r.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}sja(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}zJ(K,Ia,Ab,bc=0){!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.qb.tv||bc&16?this.$.userOperationManager.FE(new Oh.a(Ab,0,K,bc|64)):(this.SP.dKa(Tf.a.FFc,Ia),r.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}VDh(K,Ia,Ab,bc,vc){let Tc=yg.DdaFacade.Ghd(vc);if(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.qb.tv||Tc&16){var ad=this.$.Jb.Gc("UserAction","Rich Api request");this.$.userOperationManager.Jc(new gj(this.$,K,Ia,Ab,bc,ad,vc,Tc|64),null)}else this.SP.dKa(Tf.a.FFc,bc),r.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(d.a)(ij,"DdaWebServiceHelper",null,[]);class jj{constructor(K,Ia,Ab,bc){this.CFh=K;this.fileSize=Ia;this.VKj=bc}}Object(d.a)(jj,"DocumentFile",null,[]);class yh{}yh.generalException="GeneralException";yh.lRg="ApiNotFound";yh.YEd="OperationCancelled";yh.invalidArgument="InvalidArgument";Object(d.a)(yh,"ErrorCodes",null,[]);class Ui{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(d.a)(Ui,"WacApiDelegates",null,[]);var xj=a(620);class Vi extends Ui{constructor(K,Ia){super();this.rmf=(Ab,bc)=>{Ab=Vi.q$g(Ab,bc);if(!xj.a(this.$,Ab))return!0;Ab=this.$.shortcutKeyManager.z7e(Ab);return!!Ab&&0<Ab.length};this.addinId=K;this.$=Ia}replaceShortcuts(K){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,K,this.rmf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(K){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(K,
this.rmf)}static Udh(K,Ia){const Ab=document.createEvent("KeyboardEvent");if(Wf.a.gF)Ab.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(K&8),!!(K&32),!!(K&4),!!(K&256));else{const bc=[];K&4&&bc.push("Shift");K&8&&bc.push("Control");K&32&&bc.push("Alt");Ab.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,bc.join(" "),!1,"en-US")}K=new Sys.UI.DomEvent(Ab);K.keyCode=Ia;return K}static q$g(K,Ia){if(Wf.a.Cf)switch(Ia){case 189:Ia=173;break;case 187:Ia=61;break;case 186:Ia=59}return Vi.Udh(K,
Ia)}}Object(d.a)(Vi,"ExcelWacApiDelegates",Ui,[]);class zh{constructor(K){this.RIa={};this.UGi=K}HIg(K,Ia){this.vec(K)||(this.RIa[K]={});if(this.Jni(K))return r.ULS.sendTraceTag(537163157,344,50,`App ${K} has reach the limit of number of cached files.`),Tf.a.DHi;this.RIa[K][Ia.CFh.toString()]=Ia;return Tf.a.success}GTh(K,Ia){let Ab=null;this.vec(K)&&(Ab=this.RIa[K][Ia.toString()]);Ab||r.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${K}, fileHandler:${Ia}] doesn't exist`);return Ab}vec(K){return K in
this.RIa}Pgj(K,Ia){if(this.vec(K)){const Ab=this.RIa[K];delete Ab[Ia.toString()];1>Object.keys(Ab).length&&delete this.RIa[K];return Ia.toString()in Ab?Tf.a.internalError:Tf.a.success}return Tf.a.internalError}Jni(K){return this.vec(K)?Object.keys(this.RIa[K]).length>=this.UGi:!1}static getInstance(K){return K.da.Aa(200)||K.da.Ha(200,new zh(zh.VGi))}static KKi(){return++zh.O_g}}zh.vGi=4194304;zh.VGi=1;zh.O_g=0;Object(d.a)(zh,"GetFileApiHelper",null,[]);class kj{constructor(K){this.cA=K}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.cA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.pLi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}pLi(){this.notifyActionHandlerReady();return null}}Object(d.a)(kj,"AddinInternalService",null,[]);class lj{constructor(K,Ia){this.BI=Ia;this.cA=K}getAppRuntimeState(){return this.BI.getAppRuntimeState(this.cA)?2:1}setAppRuntimeState(K){switch(K){case 2:K=!0;break;case 1:K=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.invalidArgument,Ff.a.ga(1766));}this.BI.setAppRuntimeState(this.cA,K)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Ia){switch(K){case 2:return this.IOh();case 1:return this.Fwj(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,
Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}IOh(){return this.getAppRuntimeState()}Fwj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");this.setAppRuntimeState(K);return null}}Object(d.a)(lj,"AppRuntimeService",null,[]);var aj=a(988);class mj{constructor(K,Ia,Ab,bc){this.ex=K;this.h1=Ab;this.Fy=bc.Ng.getOsfControl(Ia)}disable(){try{if(!Ff.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.$Ge();
if(!this.Plf())return this.aHe();this.h1.NXj(this.ex)}catch(K){return r.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",K.message||"Unknown"),this.YGe()}return null}enable(){try{if(!Ff.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.$Ge();if(!this.Plf())return this.aHe();this.h1.Mej(this.ex)}catch(K){return r.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
K.message||"Unknown"),this.YGe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 3:return this.Smh();case 2:return this.Irh()}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Smh(){return this.disable()}Irh(){return this.enable()}ACa(){this._OnAccess();return null}$Ge(){return aj.a(Xe.a.notImplemented,
Ff.a.ga(1767))}aHe(){return aj.a(Xe.a.sharedRuntimeNotAvailable,Ff.a.ga(1771))}YGe(){return aj.a(Xe.a.generalException,Ff.a.ga(1762))}Plf(){const K=this.Fy.getSharedRuntimeId();return!!K&&0<K.length}}Object(d.a)(mj,"BeforeDocumentCloseNotification",null,[]);class nj{constructor(){this.Ike=this.See=this.$z=!1}get enabled(){return this.$z}set enabled(K){this.$z=K}get nativeRuntime(){return this.See}set nativeRuntime(K){this.See=K}get streamingEnabled(){return this.Ike}set streamingEnabled(K){this.Ike=
K}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(K){switch(K){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(nj,"CustomFunctionEngineStatus",null,[]);class oj{constructor(K,Ia,Ab){this.syg=K;this.tyg=Ia;this.nCg=Ab}get status(){const K=new nj;K.enabled=this.syg;K.streamingEnabled=this.tyg;K.nativeRuntime=!1;return K}register(K){return OfficeExtension.WacRuntime.Utility.createPromise(this.nCg(K))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(K){switch(K){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.Dfj(Ia)}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Dfj(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"string");return this.register(Ia,K)}}Object(d.a)(oj,"CustomFunctionManager",null,[]);var yj=a(962);class pj{constructor(K,Ia,Ab,bc){this.N5d="";this.xTb=0;this.IO=K;this._id=Ia;this.cA=Ab;this.BI=bc}get id(){return this._id}_RegisterStateChange(){this.xTb||this.IO.execute(K=>
{this.N5d=K.Mza(this._id,Ia=>{this.BI.HHh(this.cA,this._id,JSON.stringify(Ia))})});this.xTb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.xTb--;this.xTb||this.IO.execute(K=>{K.iLd(this._id,this.N5d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(K){switch(K){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 6:return this.Srg();case 7:return this.Urg()}K=
this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Srg(){return this._RegisterStateChange()}Urg(){return this._UnregisterStateChange()}}Object(d.a)(pj,"LicenseFeature",null,[]);class qj{constructor(K,Ia){this.IO=qc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.cA=K;this.BI=Ia;this.fBg=this.BI.Ng.getOsfControl(this.cA)}getFeatureTier(K,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Ab=>{const bc=1===Ia?1:2===
Ia?2:0;this.IO.execute(vc=>{vc.getFeatureTier(K,bc).then(Tc=>{Ab(this.VXh(Tc))},()=>{Ab(Ia)})})})}getLicenseFeature(K){K=new pj(this.IO,K,this.cA,this.BI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}isFeatureEnabled(K,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Ab=>{this.IO.execute(bc=>{bc.isFeatureEnabled(K,Ia).then(vc=>{Ab(vc)},()=>{Ab(Ia)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(K=>{this.IO.execute(Ia=>{Ia=
Ia.isFreemiumUpsellEnabled();K(Ia)})})}launchUpsellExperience(K){if(this.fBg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.IO.execute(Ia=>{Ia.launchUpsellExperience(K)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.rVc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Ia){switch(K){case 6:return this.Trg(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 2:return this.AUh(Ia);case 5:return this.UXh(Ia);
case 1:return this.voi(Ia);case 3:return this.epi();case 4:return this.Xyi(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}AUh(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"int");return this.getFeatureTier(Ia,K)}UXh(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getLicenseFeature(K)}voi(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,
0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"boolean");return this.isFeatureEnabled(Ia,K)}epi(){return this.isFreemiumUpsellEnabled()}Xyi(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.launchUpsellExperience(K)}Trg(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");this._TestFireStateChangedEvent(K);return null}VXh(K){switch(K){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(qj,"License",
null,[]);var zj=a(158);const Aj=(K,Ia,Ab)=>bc=>(vc,Tc)=>{Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(Ia.da,279,Ia.la,1),ad=>{ad=ad.result;let md=!1;var Ed=Ab.Ng.getOsfControl(K);let Xd=null;Ed&&(Xd=Ed.getStoreType(),(Ed=Ed.getManifest())&&Ed.getSharedRuntimeForCustomFunctions("Workbook")&&(md=!0));Af.TaskExtensions.za(ad.rff(K,Xd,bc,md),Fe=>{zj.b(Fe)?Fe.result?vc(null):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.invalidArgument,Tb.a.instance.ga(1766))):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,
Tb.a.instance.ga(1762)))},Ia.la,3)},Ia.la,3)};class rj{constructor(K){if(!K)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.iyd=K}areShortcutsInUse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,Ab)=>{this.iyd.checkShortcutsInUse(K).then(bc=>{Ia(bc)}).catch(bc=>{Ab(bc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((K,Ia)=>{this.iyd.getShortcuts().then(Ab=>{K(Ab)}).catch(Ab=>{Ia(Ab)})})}replaceShortcuts(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
Ab)=>{this.iyd.replaceShortcuts(K).then(()=>{Ia(null)}).catch(bc=>{Ab(bc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){switch(K){case 3:return this.ZSg(Ia);case 1:return this.l3h();case 2:return this.hmj(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}ZSg(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"Array<string>");return this.areShortcutsInUse(K)}l3h(){return this.getShortcuts()}hmj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"any");return this.replaceShortcuts(K)}}Object(d.a)(rj,"ActionService",
null,[]);var Bj=a(518);class sj{constructor(){this.nra=null}Z2h(){this.nra||(this.nra=Bj.a.Pq(qc.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.nra}getSharedFilePickerResponse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,Ab)=>{try{const bc=this.Z2h();Ug.Task.WAA.call(null,bc).continueWith(()=>{const vc=bc.result;if(vc){let Tc={};({ht:Tc}=Yf.d(K)).returnValue?vc.pgd(Tc).then(ad=>{ad&&0<ad.length?Ia(ad):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(ad=>{Ab(ad)}):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(bc){Ab(bc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.Y2h(Ia)}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Y2h(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getSharedFilePickerResponse(K)}}Object(d.a)(sj,"SharedFilePicker",null,[]);class tj{createInstance(K,Ia){switch(K){case "Microsoft.Office.ActionService":return new rj(Ia);case "Microsoft.Office.SharedFilePicker":return new sj}return null}}Object(d.a)(tj,"WacApiHost",null,[]);class uj{constructor(K,Ia,Ab,bc,vc){this.XUc=null;this.FRb=
K;this.cA=Ia;this.BI=Ab;this.jb=bc;this.rGg=vc}hostName(){return"ExcelOnline"}appId(){return this.FRb}createInstance(K){switch(K){case "Microsoft.Authentication.AuthenticationService":return qc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.cA,this.BI.Ng);case "Microsoft.Authentication.TokenParameters":return new gg;case "Microsoft.ExcelServices.CustomFunctionManager":K=this.jb.sa(114);var Ia=this.jb.sa(115);return new oj(K,Ia,Aj(this.FRb,
this.jb,this.BI));case "Microsoft.AppRuntime.AppRuntimeService":return new lj(this.cA,this.BI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return K=nh.a(this.jb),new mj(this.FRb,this.cA,K,this.BI);case "Microsoft.DynamicRibbon.DynamicRibbon":return K=nh.a(this.jb),new yj.DynamicRibbon(this.FRb,this.cA,this.BI,K,K.nn(this.cA).sl);case "Microsoft.Office.Licensing.License":return new qj(this.cA,this.BI);case "Microsoft.InternalService.AddinInternalService":return new kj(this.cA);
default:if(this.XUc||(this.XUc=new tj),Ia=this.XUc.createInstance(K,this.rGg))return Ia}r.ULS.sendTraceTag(537163155,0,10,`Typename: ${K} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xe.a.generalException,Xe.a.generalException);}}Object(d.a)(uj,"RichApiHost",null,[]);var Cj=a(385),vj=a(28),Dj=a(120),bj=a(35),Ej=a(101),Fj=a(286),Gj=a(45),Hj=a(254),Ij=a(6),Jj=a(73);class yf{constructor(K,Ia,Ab,bc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=K;this.Md=Ia;this.htmlSanitizationHelper=bc;this.Be=new Hh(K.ea);this.Rz=new ij(K,this.Be);this.kxf=Ab;this.u$b=new Map}get SP(){return this.Be}dispose(){this.$=this.u$b=null}Hc(){return!1}Mc(){return!1}executeCommand(K,Ia,Ab){K=Ia.command;switch(K){case 451041795:this.Be.zf(Ab[fg.a.Pf],Ab[fg.a.g3]);break;case 974713501:this.L9h(Ab[fg.a.Pf],Ab[fg.a.g3]);break;case 1237877382:this.Be.kv(Ab[fg.a.g3]);break;default:return Zh.a(K)}return Ug.Task.Ra(!0)}wc(K,Ia,Ab){if(K=!!Ab)switch(Ia.command){case 974713501:case 1237877382:case 451041795:break;
default:K=!1}return K}L9h(K,Ia){var Ab;const bc=K.DdaMethod;"undefined"===typeof bc.DispatchId?this.Be.zf(Tf.a.internalError,Ia):yf.zni(K)||this.$.qd&1?(bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new uh(this.$,this,K,Ia,this.htmlSanitizationHelper)).start(this.Md,K.DdaMethod.ControlId):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.y2h(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.fBj(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(K,this.Jfd(K.DdaMethod.ControlId),0,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.nPh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Qwj(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.mPh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Ogj(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.mOh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.gwd(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(K.DdaAddRowsColumns.IsRow=!0,this.upe(K,Ia)):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(K.DdaAddRowsColumns.IsRow=!1,this.upe(K,Ia)):bc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Fkh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.x4g(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(K.DdaSetBindingFormats.IsSetFormats=!0,this.I3f(K,Ia)):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(K.DdaSetBindingFormats.IsSetFormats=!1,this.I3f(K,Ia)):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(K,K.DdaBindingsMethod.ItemName,K.DdaBindingsMethod.FailOnCollision?2:1,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.EUh(Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.dAd(K,Ia):bc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.DTh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.ETh(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Qgj(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(K.DdaMethod.ControlId,K),this.Be.kv(Ia)):
bc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?C.EwaSettings.sa(23)?this.Be.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ia):this.$Hi(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?C.EwaSettings.sa(23)?this.Be.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ia):this.WHi(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(K,Ia):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(K,Ia):this.Be.zf(Tf.a.bFd,Ia),C.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&bc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(K=this.Md.cZ(K.DdaMethod.ControlId),Ia="",K&&(Ia=yg.DdaFacade.getSolutionId(K,this.$),Ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia,K.OwnerAddinStoreType||K.PrimaryMarketplace.MarketplaceType,null===(Ab=K.AssetMarketplace)||void 0===Ab?void 0:Ab.SolutionId,null,null,K.PrimaryMarketplace.MarketplaceRef)),
r.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${bc.DispatchId}, AppID: ${Ia}`))):this.Be.zf(Tf.a.iNe,Ia)}nPh(K,Ia){K.DdaGetBindingData.CoerceType=yf.d4b(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.FilterType=yf.yXe(K.DdaGetBindingData.FilterType);K.DdaGetBindingData.ValueFormat=yf.fmg(K.DdaGetBindingData.ValueFormat);if(this.Xjc(K.DdaGetBindingData.CoerceType,Ia)){if(K.DdaGetBindingData){const Ab=K.DdaGetBindingData;0===Ab.FilterType&&(Ab.FilterType=2);Ab.StartCol|=0;Ab.StartRow|=0;
Ab.ColCount=void 0===Ab.ColCount?-1:Ab.ColCount;Ab.RowCount=void 0===Ab.RowCount?-1:Ab.RowCount}this.Rz.ddaGetBindingData(K.DdaMethod.ControlId,K.DdaGetBindingData.BindingId,K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,K.DdaGetBindingData.StartRow,K.DdaGetBindingData.StartCol,K.DdaGetBindingData.RowCount,K.DdaGetBindingData.ColCount,Ab=>{if(Ig.a(Ab)||!Ab.Result)this.Be.$G(Ab,Ia);else{const bc=this.Be.BP();bc.Data=yf.hye(Ab.Result);Ia(bc)}},Ia)}}Qwj(K,
Ia){K.DdaSetBindingData.CoerceType=yf.d4b(K.DdaSetBindingData.CoerceType);if(this.Xjc(K.DdaSetBindingData.CoerceType,Ia)){var Ab=yf.R_c(K.DdaSetBindingData.CoerceType,K.DdaSetBindingData.Data);yf.Qgc(Ab)?this.Be.zf(Tf.a.oDc,Ia):(1===Ab.CoerceType&&(Ab.CellFormat||(Ab.CellFormat=K.DdaSetBindingData.CellFormat),Ab.TableOptions||(Ab.TableOptions=K.DdaSetBindingData.TableOptions)),K.DdaSetBindingData&&(K.DdaSetBindingData.StartCol|=0,K.DdaSetBindingData.StartRow|=0),this.Rz.ddaSetBindingData(K.DdaMethod.ControlId,
K.DdaSetBindingData.BindingId,K.DdaSetBindingData.StartRow,K.DdaSetBindingData.StartCol,Ab,bc=>{Ig.a(bc)?this.Be.$G(bc,Ia):this.Be.kv(Ia)},Ia))}}y2h(K,Ia){K.DdaGetBindingData.CoerceType=yf.d4b(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.ValueFormat=yf.fmg(K.DdaGetBindingData.ValueFormat);K.DdaGetBindingData.FilterType=yf.yXe(K.DdaGetBindingData.FilterType);if(this.Xjc(K.DdaGetBindingData.CoerceType,Ia)){var Ab=this.Jfd(K.DdaMethod.ControlId);Ab?this.Rz.ddaGetSelectedData(K.DdaMethod.ControlId,
K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,Ab,bc=>{if(Ig.a(bc))this.Be.$G(bc,Ia);else{const vc=this.Be.BP();vc.Data=yf.hye(bc.Result);Ia(vc)}},Ia):this.Be.zf(Tf.a.h7e,Ia)}}DTh(K,Ia){const Ab=K[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],bc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],vc=K.DdaMethod.ControlId,Tc=zh.getInstance(this.$);if(0>=bc)r.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),
this.Be.zf(Tf.a.$ji,Ia);else if(bc>zh.vGi)r.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Be.zf(Tf.a.Z1e,Ia);else{var ad=null;switch(Ab){case 1:ad="Compressed";break;case 0:ad="Text";break;case 2:ad="Pdf";break;default:r.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Ab} is not supported.`);this.Be.zf(Tf.a.lXe,Ia);return}if("Text"===ad)r.ULS.sendTraceTag(537163218,344,15,`Requested file type ${ad} is not supported.`),this.Be.zf(Tf.a.lXe,
Ia);else{C.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(K=new Sys.StringBuilder,K.append(Rg.a(this.$,ad)),"Pdf"===ad&&eh.a.Mk(K,Od.a.ZPf,"WholeWorkbook"),K=K.toString()):K=Rg.a(this.$,ad);var md=null,Ed=new XMLHttpRequest;Ed.onreadystatechange=()=>{if(4===Ed.readyState)if(200===Ed.status){var Xd=Ed.response;if(Xd){md=new Uint8Array(Xd);Xd=this.Be.BP();var Fe=md.length,Me=zh.KKi(),lf={},tg=0;for(let jg=0;jg<Fe;jg+=bc){const cg=[],eg=jg+bc<Fe?jg+bc:Fe;
for(let og=0,Og=jg;Og<eg;og++,Og++)cg[og]=md[Og];lf[(tg++).toString()]=cg}lf=new jj(Me,Fe,bc,lf);lf=Tc.HIg(vc,lf);lf!==Tf.a.success?this.Be.zf(lf,Ia):(Xd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Me,Xd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Fe,r.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${ad}, the file size is ${Fe}`),Ia(Xd))}else r.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${ad}.`),
this.Be.zf(Tf.a.internalError,Ia)}else 500===Ed.status?this.Be.zf(Tf.a.NZe(parseInt(Ed.statusText,10)),Ia):(r.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${ad}.`),this.Be.zf(Tf.a.rKi,Ia))};Ed.open("GET",K,!0);Ed.responseType="arraybuffer";Ed.setRequestHeader("If-Modified-Since","0");Ed.send(null)}}}ETh(K,Ia){var Ab=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],bc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];K=K.DdaMethod.ControlId;(Ab=
zh.getInstance(this.$).GTh(K,Ab))?(Ab=Ab.VKj,0>bc||bc>=Object.keys(Ab).length?this.Be.zf(Tf.a.Iei,Ia):(bc=Ab[bc.toString()],Ab=this.Be.BP(),Ab[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=bc,Ab[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=bc.length,Ia(Ab))):this.Be.zf(Tf.a.internalError,Ia)}Qgj(K,Ia){var Ab=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];K=K.DdaMethod.ControlId;Ab=zh.getInstance(this.$).Pgj(K,Ab);Ab===Tf.a.success?this.Be.kv(Ia):this.Be.zf(Ab,
Ia)}fBj(K,Ia){K.DdaSetBindingData.CoerceType=yf.d4b(K.DdaSetBindingData.CoerceType);if(this.Xjc(K.DdaSetBindingData.CoerceType,Ia)){var Ab=this.Jfd(K.DdaMethod.ControlId);if(Ab){var bc=yf.R_c(K.DdaSetBindingData.CoerceType,K.DdaSetBindingData.Data),vc=Cg.h(this.$).ha;1===bc.CoerceType&&(!bc.Data&&vc.qa.b5&&(bc.Headers||(bc.Headers=[]),bc.Headers.length||bc.Headers.push([]),bc.Headers[0].length||bc.Headers[0].push("")),yf.Qgc(bc)||(bc.CellFormat||(bc.CellFormat=K.DdaSetBindingData.CellFormat),bc.TableOptions||
(bc.TableOptions=K.DdaSetBindingData.TableOptions)));if(yf.Qgc(bc))this.Be.zf(Tf.a.oDc,Ia);else{var Tc=vc.qa.ld.clone(),ad=vc.qa.activeCell.clone();this.Rz.ddaSetSelectedData(K.DdaMethod.ControlId,Ab,bc,md=>{var Ed;if(Ig.a(md))this.Be.$G(md,Ia);else{md=Tc.clone();const Xd=bc.Headers?bc.Headers[0].length:bc.Data[0].length;1!==bc.CoerceType||bc.Data?1===bc.CoerceType&&(null===(Ed=bc.TableOptions)||void 0===Ed?0:Ed.length)&&0==bc.TableOptions[0]?(md.top+=1,md.bottom=md.top+bc.Data.length-1):md.bottom=
md.top+bc.Data.length-(1===bc.CoerceType?0:1):md.bottom=md.top+1;md.right=md.left+Xd-1;Ed=md.contains(ad)?ad:md.topLeft;vc.updateSelection(md,Ed,0);this.Be.kv(Ia)}},Ia)}}else this.Be.zf(Tf.a.IAe,Ia)}}addBinding(K,Ia,Ab,bc){Ia?this.Rz.ddaAddBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,K.DdaBindingsMethod.BindingType,Ia,Ab,vc=>{if(Ig.a(vc))this.Be.$G(vc,bc);else{const Tc=this.Be.BP();Tc.Bindings=Array(1);Tc.Bindings[0]=this.Md.J1b(vc.Result);bc(Tc)}},bc):this.Be.zf(Tf.a.luj,bc)}mPh(K,
Ia){this.Rz.ddaGetBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,Ab=>{if(Ig.a(Ab)||!Ab.Result)this.Be.$G(Ab,Ia);else{const bc=this.Be.BP();bc.Bindings=Array(1);bc.Bindings[0]=this.Md.J1b(Ab.Result);Ia(bc)}},Ia)}EUh(K){const Ia=this.Be.BP(),Ab={};Ab[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Ab;K(Ia)}Ogj(K,Ia){this.Rz.ddaReleaseBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,
Ab=>{Ig.a(Ab)?this.Be.$G(Ab,Ia):this.Be.kv(Ia)},Ia)}mOh(K,Ia){this.Rz.ddaGetAllBindings(K.DdaMethod.ControlId,Ab=>{if(Ig.a(Ab))this.Be.$G(Ab,Ia);else{const bc=this.Be.BP();if(Ab.Result){Ab=Ab.Result;bc.Bindings=Array(Ab.length);for(let vc=0;vc<Ab.length;vc++)bc.Bindings[vc]=this.Md.J1b(Ab[vc])}else bc.Bindings=null;Ia(bc)}},Ia)}gwd(K,Ia){this.Rz.ddaLoadSettings(K.DdaMethod.ControlId,Ab=>{if(Ig.a(Ab))this.Be.$G(Ab,Ia);else{const bc=this.Be.BP();bc.Properties=Ab.Result;Ia(bc)}},Ia)}saveSettings(K,Ia){const Ab=
{Settings:[]};for(let bc=0;bc<K.DdaSettingsMethod.Properties.length;bc++){const vc={};vc.Name=K.DdaSettingsMethod.Properties[bc][0];vc.Value=K.DdaSettingsMethod.Properties[bc][1];Ab.Settings[bc]=vc}this.Rz.ddaSaveSettings(K.DdaMethod.ControlId,Ab,K.DdaSettingsMethod.OverwriteIfStale,bc=>{Ig.a(bc)?this.Be.$G(bc,Ia):this.Be.kv(Ia)},Ia)}upe(K,Ia){const Ab=yf.R_c(1,K.DdaAddRowsColumns.Data);yf.Qgc(Ab)?this.Be.zf(Tf.a.oDc,Ia):this.Rz.ddaAddRowsColumns(K.DdaMethod.ControlId,K.DdaAddRowsColumns.BindingId,
K.DdaAddRowsColumns.IsRow,Ab,bc=>{Ig.a(bc)?this.Be.$G(bc,Ia):this.Be.kv(Ia)},Ia)}Fkh(K,Ia){this.Rz.ddaDeleteAllDataValues(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,Ab=>{Ig.a(Ab)?this.Be.$G(Ab,Ia):this.Be.kv(Ia)},Ia)}x4g(K,Ia){this.Rz.ddaClearBindingFormats(K.DdaMethod.ControlId,K.DdaClearBindingFormats.BindingId,Ab=>{Ig.a(Ab)?this.Be.$G(Ab,Ia):this.Be.kv(Ia)},Ia)}I3f(K,Ia){const Ab={},bc=K.DdaSetBindingFormats.IsSetFormats;bc?Ab.CellFormat=K.DdaSetBindingFormats.CellFormat:Ab.TableOptions=
K.DdaSetBindingFormats.TableOptions;this.Rz.ddaSetBindingFormats(K.DdaMethod.ControlId,K.DdaSetBindingFormats.BindingId,Ab,bc,vc=>{Ig.a(vc)?this.Be.$G(vc,Ia):this.Be.kv(Ia)},Ia)}executeRichApiRequest(K,Ia){var Ab;const bc=K.ArrayData,vc={},Tc=Cg.h(this.$).ha;if(bc){if("WacPartition"===bc[0]){this.zDh(K,Ia);return}const Me=Object(U.a)(yg.DdaFacade,nh.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===bc[0]){var ad=Me.nn(K.DdaMethod.ControlId);ad&&(ad.Jic=!0,ad.rPf())}vc.HttpMethod=bc[1];
vc.PathAndQuery=bc[2];vc.RequestHeaders=yf.z3e(bc[3]);vc.RequestBody=bc[4];vc.AppPermission=bc[5];ad=bc[6];vc.RequestFlags=ad;var md=0;if(Nh.i(this.$.na))switch(Tc.Oe){case 1:md=2;break;case 2:md=3;break;case 128:md=4;break;default:md=1}var Ed=null;Tc.Sa.wA&&(Ed=Tc.Sa.wA.Gi);vc.SheetMultiRange=Dh.r(Tc.qa.selectedRanges,this.$);vc.ActiveCell=Dh.v(Tc.qa.activeCell,this.$);vc.ActiveChartId=Ed;vc.SelectionState=md;md=this.Md.cZ(K.DdaMethod.ControlId);vc.InstanceId=md?md.InstanceId:"";if(md&&md.PrimaryMarketplace){let lf;
if(md.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)lf=md.PrimaryMarketplace.SolutionId,Ed=md.PrimaryMarketplace.MarketplaceType;else{if(!md.OwnerAddinSolutionId){r.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Be.zf(Tf.a.Rzb,Ia);return}if(!md.OwnerAddinStoreType){r.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Be.zf(Tf.a.Rzb,Ia);return}lf=md.OwnerAddinSolutionId;Ed=md.OwnerAddinStoreType}let tg=
Telemetry.PrivacyRules.GetPrivacyCompliantId(lf,Ed,null===(Ab=md.AssetMarketplace)||void 0===Ab?void 0:Ab.SolutionId,null,null,md.PrimaryMarketplace.MarketplaceRef);vc.CompliantSolutionId=tg;vc.SolutionId=lf;vc.MarketplaceType=Ed;vc.SolutionVersion=md.PrimaryMarketplace.SolutionVersion;vc.StoreLocation=md.PrimaryMarketplace.MarketplaceRef}else vc.SolutionId=vc.MarketplaceType="",vc.CompliantSolutionId="";vc.IsEventsEnabled=void 0===Me||null===Me||Me.Ui.U0b(vc.InstanceId);vc.RequestGuid=Lh.a.create().toString();
Ab=vc.RequestBody.length;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Ab>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Be.zf(Tf.a.Cnj,Ia);r.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Ab} exceeded the limit`);return}C.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&ad&4096&&(Ab=new Li(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Ab,$f,bc),vc.RequestBody=bc[4])}const Xd=yf.J6e(vc.RequestHeaders);
yf.VFd++;const Fe=vj.a.Ya.Ub;C.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&vc&&vc.RequestBody&&r.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${vc.RequestBody.length}`);this.Rz.executeRichApiRequest(vc,Me=>{var lf;this.O2f(Fe,!0,Me.ServerCorrelationId);let tg=null,jg=null;var cg=Me.ServerCorrelationId;if(null===(lf=null===Me||void 0===Me?void 0:Me.Errors)||void 0===lf?0:lf[0])tg=Me.Errors[0].MessageIdName,jg=Me.Errors[0].Description,C.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&
Jj.a(this.$).gd.KL(Me.Errors[0].MessageId);if(Ig.a(Me)||!Me.Result)this.X8a(cg,Xd,"Server error",tg,jg),this.Be.$G(Me,Ia);else{let og=null;if(C.EwaSettings.sa(233))if((lf=Me.Result)&&lf.length){for(let Pg=0;Pg<lf.length;Pg++)if(lf[Pg].RequestGuid===vc.RequestGuid){og=lf[Pg];break}og||this.Be.$G(Me,Ia)}else og=Me.Result;else og=Me.Result;if(!tg&&og&&og.ResponseBody&&og.ResponseBody[0])if(Me=og.ResponseBody[0],Me.startsWith('{"Error":')){1<og.ResponseBody.length&&(Me=Me.substring(0,Me.indexOf("}")+
1),Me+="}");try{var eg=A.a.Wh(Me);eg.Error&&this.X8a(cg,Xd,"Pipeline error",eg.Error.Code,eg.Error.Message)}catch(Pg){this.X8a(cg,Xd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.X8a(cg,Xd);else this.X8a(cg,Xd,"Server error",tg,jg);const Og=(cg=og.SheetMultiRange)?cg.SheetName:null;eg=og.ActiveChartId;const Ng=og.SelectionState;Me=5===Ng&&!!cg||6===Ng||7===Ng||8===Ng;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.qb.tv&&
Me)this.Be.zf(Tf.a.FFc,Ia),r.ULS.sendTraceTag(537163211,0,50,`${Ng.toString()} is not allowed`);else if(5===Ng&&cg){if(this.$.va&&Og)if(this.$.va.Gk(Og))this.RVc(Og);else{let Pg=null;Pg=()=>{this.$.va.Gk(Og)&&(r.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.RVc(Og),this.$.va.KJb(Pg))};this.$.va.hob(Pg);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Ph=null;Ph=()=>{this.$.va.Gk(Og)&&(this.RVc(Og),this.$.va.Wma(Ph))};
this.$.va.Kga(Ph)}}}else if(6===Ng||7===Ng||8===Ng||9===Ng){if(cg){const Pg=Dh.g(cg.Ranges);if(Og&&Dh.bb(Pg,!0))if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.va.Gk(Og)){let Ph=null;Ph=()=>{this.qkg(Tc,Pg,Og,Ng);this.$.va.Wma(Ph)};this.$.va.Kga(Ph)}else this.qkg(Tc,Pg,Og,Ng)}7===Ng?(eg="38.{"+lg.e(eg)+"}",T.a(this.$).nna(0,eg,!0)):8===Ng&&T.a(this.$).nna(2,eg,!0);9===Ng&&(this.$.ya.ApiCallToSetPageLayout=!0)}og.PostProcessActions?(cg=
A.a.Wh(og.PostProcessActions),this.Z6i(cg).then(()=>{this.jdb(og,Ia);this.Ecd(K.DdaMethod.ControlId,vc);return Promise.resolve(null)},Pg=>{this.jdb(og,Ia,Pg);return Promise.reject(Pg)})):this.jdb(og,Ia)}},Me=>{this.O2f(Fe,!1,null);this.X8a(null,Xd,"Web service error");Ia(Me)})}Ecd(K,Ia){const Ab=Object(U.a)(yg.DdaFacade,nh.a(this.$));(null===Ab||void 0===Ab?0:Ab.LOd)&&Ab.nn(K)&&yf.YEj(Ia.RequestHeaders)&&(r.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${K}; SolutionId: ${Ia.SolutionId}.`),
Ab.LOd.Qsh(K))}zDh(K,Ia){var Ab=this.Md.cZ(K.DdaMethod.ControlId);const bc=yg.DdaFacade.getSolutionId(Ab,this.$);var vc=null;vc=yg.DdaFacade.Rua(Ab,this.$);vc=new Vi(vc,this.$);vc=new uj(bc,K.DdaMethod.ControlId,this.Md,this.$,vc);const Tc={ResponseHeaders:[]};Tc.ResponseBody=Array(1);Ab=yf.z3e(K.ArrayData[3]);const ad=yf.J6e(Ab);Ab=new kg(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.kxf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(vc,Of,Ab,K.ArrayData).then(md=>{if(!md)return this.Xwd(!1,
"The rich api executor call failed",ad),r.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Tc.ResponseStatusCode=500,this.jdb(Tc,Ia),null;this.Xwd(!0,"The rich api executor call succeeded",ad);Tc.ResponseStatusCode=md[0];Tc.ResponseBody[0]=md[2];this.jdb(Tc,Ia);return null},md=>{Tc.ResponseStatusCode=400;Tc.ResponseBody[0]=md.toString();this.Xwd(!1,"The rich api executor call failed",ad);r.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${bc}`);
this.jdb(Tc,Ia);return null})}O2f(K,Ia,Ab){yf.VFd--;K=Dj.a(vj.a.Ya,K);r.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${K}, requests pending:${yf.VFd}, request result:${Ia?"success":"false"}, server correlationid: ${Ab}.`)}jdb(K,Ia,Ab=null){const bc=Array(3);bc[0]=K.ResponseStatusCode;bc[1]=yf.S3h(K.ResponseHeaders);const vc=[];var Tc=!1;if(Ab&&K.ResponseBody){const ad=A.a.Wh(K.ResponseBody.join(""));ad.Error||(Tc={},Tc.Error=Ab,Tc.TraceIds=ad.TraceIds,Tc.ProcessedResults=
{},Tc.ProcessedResults.Results=ad.Results,vc[0]=A.a.Dc(Tc),Tc=!0)}bc[2]=Tc?vc:K.ResponseBody;K=this.Be.BP();K.Data=bc;Ia(K)}dAd(K,Ia){(new Mi(this.$,this.Be,this.Rz)).dAd(K,Ia)}$Hi(K,Ia){r.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Ab=K[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],bc=K[la.a.TXc],vc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];K=this.$.da.Aa(232).M1a.aIi(K.DdaMethod.ControlId,Ab,bc,vc);K===Tf.a.success?this.Be.kv(Ia):(r.ULS.sendTraceTag(537163205,
0,10,"MessageParent API Failed!"),this.Be.zf(K,Ia))}WHi(K,Ia){r.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Ab=K[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],bc=K[la.a.TXc],vc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).M1a.fvj(K.DdaMethod.ControlId,Ab,bc,vc);this.Be.kv(Ia)}getAccessToken(K,Ia){r.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Ab=(vc,Tc)=>{var ad;if(vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)vc=this.Be.BP(),
vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Tc.accessToken,Ia(vc);else{Tc=this.Md.cZ(K.DdaMethod.ControlId);let md=null!==Tc.OwnerAddinStoreType?Tc.OwnerAddinStoreType:Tc.PrimaryMarketplace.MarketplaceType;r.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:vc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(yg.DdaFacade.getSolutionId(Tc,this.$),md,null===(ad=Tc.AssetMarketplace)||void 0===ad?void 0:ad.SolutionId,null,null,Tc.PrimaryMarketplace.MarketplaceRef),
["storeType"]:md})}.`);this.Be.zf(vc,Ia)}},bc=!C.EwaSettings.sa(23);Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),vc=>{const Tc=this.Md.Ng,ad=Bf.getInstance();Lg.AppsForOfficeSingleSignOnManager.getInstance(Tc,vc.result,ad).getAccessToken(K.DdaMethod.ControlId,bc,K,Ab)},this.$.la)}getAuthContext(K,Ia){Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>{var Ab=this.Md.Ng.getOsfControl(K.DdaMethod.ControlId);if(Ab.isFirstParty()){Ab=
Ab.getManifest();var bc=Ab.getMarketplaceID(),vc=Ab.getWebApplicationId(),Tc=Ab.getWebApplicationMsaId();qc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(bc).then(ad=>{const md=this.Be.BP(),Ed={};Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=vc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||vc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ad.upn;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ad.userId;
Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ad.authority;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Qf.a.VOh(ad.authorityType);Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ad.isAnonymous;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ad.tenantId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ad.supportsAuthToken;md[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ed;
Ia(md)},ad=>{const md=this.Be.BP(),Ed={},Xd=new Qf.a;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=vc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||vc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Xd.upn;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Xd.userId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Xd.authority;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Xd.authorityType;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Xd.isAnonymous;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Xd.tenantId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ad;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Xd.supportsAuthToken;md[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ed;md.Error=1;Ia(md)})}},this.$.la)}mni(K){const Ia=Cg.h(this.$).ha;return 16===Ia.Oe&&!!Ia.Sa.dc&&!!Ia.Sa.dc.floatingObject&&Kf.a.equals(Ia.Sa.dc.floatingObject.id,K,!0)}Jfd(K){const Ia=
Cg.h(this.$).ha;return Ia.qa.Tg?1===Ia.Oe||this.mni(K)?Ia.cia:null:null}Xjc(K,Ia){return 1!==K&&2!==K&&3!==K?(this.Be.zf(Tf.a.$De,Ia),!1):!0}Xwd(K,Ia,Ab){const bc={};bc.a=this.$.ya.UserSessionId;bc.b=K;bc.c=Ia;bc.d=null;bc.e=Ab;ob.b().Te(37,bc)}X8a(K,Ia,Ab=null,bc=null,vc=null){const Tc={};K&&(Tc.ServerCorrelationId=K);void 0!==Ia&&null!==Ia&&(Tc.Source=Ia);Ab&&(Tc.ErrorType=Ab);bc&&(Tc.MessageId=bc);vc&&(Tc.StatusDescription=vc);C.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&
bc&&"ExternalDataRefreshFailed"===bc&&(Tc.StatusDescription="");r.ULS.sendTraceTag(50688452,0,50,A.a.Dc(Tc))}Z6i(K){let Ia=new Promise(Ab=>{Ab(null)});for(let Ab=0;Ab<K.length;Ab++)Ia=this.Y6i(Ia,K[Ab]);return Ia}Y6i(K,Ia){if(!Ia)return r.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),K.then(()=>Promise.reject(yf.N3a(yh.generalException,Tb.a.instance.ga(1762),null)));switch(Ia.actionType){case 1:case 2:K=K.then(()=>{const Ab=Object(U.a)(yg.DdaFacade,nh.a(this.$));if(Ab.nn(Ia.controlId))switch(Ab.Ui.V8h(Ia),
Ia.messageType){case 14:case 100:Ab.KOd.p1b(Ia);break;case 11:case 12:Ab.tqj.Bpb(Ia);break;case 51:case 52:Ab.rqj.Bpb(Ia);break;case 2101:case 2102:Ab.sqj.Bpb(Ia);break;case 2E3:Ab.uqj.p1b(Ia);break;case 2201:this.$.Qka&&Ab.LOd.STg(Ia);break;case 2203:Ab.vqj.TTg(Ia);break;case 2700:C.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Ab.JOd.p1b(Ia)}else r.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ia.controlId}] doesn't exist.`);return Promise.resolve(null)});break;
case 3:K=K.then(()=>{this.G8h(Ia);return Promise.resolve(null)});break;case 15:C.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(K=K.then(()=>{this.u$h(Ia);return Promise.resolve(null)}));break;case 4:K=K.then(()=>{if(C.EwaSettings.sa(102)){var Ab=Cg.h(this.$).ha.qa.activeCell;Ab.top!==Ia.row+1&&Ab.left!==Ia.column+1&&(Ab=Dh.v(sg.Range.Pc(Ia.row+1,Ia.column+1),this.$),Cg.h(this.$).qg(Ab,null,null,null,3,"DdaMethodHandler.ShowCard"));Th.a(this.$,243,242,0,bc=>{bc.oeb(Ia.row+1,Ia.column+
1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:K=K.then(()=>{Object(U.a)(yg.DdaFacade,nh.a(this.$)).Ui.pPe(Ia.controlId,Ia.isEnableEvents);return Promise.resolve(null)});break;case 5:K=K.then(()=>this.Shh(Ia));break;case 6:K=K.then(()=>this.X1i(Ia));break;case 8:K=K.then(()=>{C.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(U.a)(yg.DdaFacade,nh.a(this.$)).w4g();const Ab=new Hj.a(Ij.a.Kj,5,null);Gj.a(this.$).tr(Ab);return Promise.resolve(null)});
break;case 9:K=K.then(()=>this.Uwj(Ia));break;case 10:K=K.then(()=>this.A6j(Ia));break;case 11:K=K.then(()=>this.z6j());break;case 12:K=K.then(()=>this.w6j());break;case 13:K=K.then(()=>this.x6j(Ia));break;case 14:K=K.then(()=>this.y6j(Ia));break;case 16:K=K.then(()=>Promise.resolve(Ia));break;case 17:K=K.then(()=>this.ktj(Ia,Object(U.a)(yg.DdaFacade,nh.a(this.$))));break;case 18:Cg.h(this.$).focus();break;case 19:this.T9e(Ia.entryType,!1,Ia.options);break;case 20:this.T9e(Ia.entryType,!0,Ia.options);
break;default:K=K.then(()=>Promise.reject(yf.N3a(yh.lRg,Tb.a.instance.ga(1763),null)))}return K}u$h(K){var Ia=Object(U.a)(yg.DdaFacade,nh.a(this.$)).nn(K.controlId);if(Ia&&!(0===K.operationType^!Ia.Dda)){Cg.h(this.$).szb=!0;switch(K.operationType){case 0:var Ab=new Fj.a(document.createElement("input"));Ab.text=K.range;Ia.Shi(Cg.h(this.$).Gg.ogh(Ab,new Cj.a(this.$)));Ia.Dda.startEdit(!0);break;case 1:Ia.sVf();this.rangePicker=null;break;case 2:Ia.Dda.Hkg(K.range);break;case 3:Ia.Dda.Hkg(K.startingRange);
Ia=K.expandSelection;Ab=K.getNextDataRegionCell;let bc=0;switch(K.keyboardDirectionValue){case 2:bc=38;K=Ia&&Ab?105288353:Ia?-31900117:Ab?542791952:137938150;break;case 3:bc=40;K=Ia&&Ab?-1297307319:Ia?-1603798598:Ab?1713663844:-798660877;break;case 0:bc=37;K=Ia&&Ab?-403586027:Ia?2039316657:Ab?-2012742350:-1470715894;break;case 1:bc=39;K=Ia&&Ab?784916030:Ia?589730764:Ab?1324884057:-1231471547;break;default:K=1461300262}Ia=this.N5b("keydown",bc,Ia,Ab);Cg.h(this.$).RKb(Ia,new $e.a(K,1,0,8,null))}Cg.h(this.$).szb=
!1}}N5b(K,Ia,Ab,bc){const vc=document.createEvent("KeyboardEvent");if(Wf.a.gF)vc.initKeyboardEvent(K,!1,!1,window.self,"A",0,bc,!1,Ab,!1);else{let Tc="";Ab&&(Tc+="Shift");bc&&(Tc+=0<Tc.length?" Control":"Control");vc.initKeyboardEvent(K,!1,!1,window.self,"A",0,Tc,!1,"en-US")}K=new Sys.UI.DomEvent(vc);K.keyCode=Ia;return K}G8h(K){switch(K.operationType){case 1:Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),Ia=>{Ia.result.FNd()},this.$.la,3);break;case 2:if(K=Object(U.a)(yg.DdaFacade,
nh.a(this.$)).nn(K.controlId))K.Jic=!0,K.rPf()}}Shh(K){const Ia=K.fileBase64;return Ia&&Ia.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(yf.N3a(yh.invalidArgument,Tb.a.instance.ga(1766),"Application.CreateWorkbook")):(new Promise((Ab,bc)=>{const vc=new bg.StandardDialog;vc.Ob=4;vc.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Tc=>{2!==Tc&&0!==Tc||bc(yf.N3a(yh.YEd,Tb.a.instance.ga(1765),"Application.CreateWorkbook"));Tc=new Xf("blank",
"agave",Ia?"streamBase64":"streamEmpty",Ia);this.kxf.create(Ab,bc,Tc).c1a()})})).then(Ab=>{this.u$b.set(K.fakeFileId,Ab);return Promise.resolve(null)},Ab=>Ab?Promise.reject(Ab):Promise.reject(yf.N3a(yh.generalException,Tb.a.instance.ga(1762),"Application.CreateWorkbook")))}X1i(K){return new Promise((Ia,Ab)=>{if(this.u$b.has(K.fakeFileId)){const bc=this.u$b.get(K.fakeFileId);Ab=new bg.StandardDialog;Ab.Ob=4;Ab.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,
1,vc=>{1===vc&&Eh.HelperMethods.gf(bc,void 0,void 0,"DdaMethodHandler.fileUrl");Ia(null)})}else Ab(yf.N3a(yh.generalException,Tb.a.instance.ga(1762),"Document.Open"))})}Uwj(K){return new Promise(Ia=>{Object(U.a)(yg.DdaFacade,nh.a(this.$)).n_f=K.runtimeCalculationMode;const Ab=this.$.da.Aa(268);Ab&&Ab.fBd(3===K.runtimeCalculationMode);Ia(null)})}A6j(K){Sh.a.jCb(this.$)&&this.$.da.Aa(331).kdb(0,K.urlStr,!0,!0,null);return Promise.resolve(null)}z6j(){Sh.a.jCb(this.$)&&this.$.da.Aa(331).kdb(1,null,!0,
!0,null);return Promise.resolve(null)}w6j(){Sh.a.jCb(this.$)&&this.$.da.Aa(331).mPe();return Promise.resolve(null)}x6j(K){Sh.a.jCb(this.$)&&this.$.da.Aa(331).kdb(5,K.urlStr,!0,!0,null);return Promise.resolve(null)}y6j(K){if(Sh.a.jCb(this.$)){const Ia=this.$.da.Aa(331);for(const Ab of Ia.saa)Ab.IsActive&&Ab.HostEditUrl&&Ab.UrlStr===K.hostEditUrlStr&&Eh.HelperMethods.gf(Ab.HostEditUrl,"_blank")}return Promise.resolve(null)}ktj(K,Ia){const Ab=$i.a.sW;K=A.a.Wh(K.payload);const bc={};"eventId"in K&&"payload"in
K&&(bc.eventId=K.eventId,bc.payload=K.payload);Ia.wM(2201,Ab,A.a.Dc(bc));return Promise.resolve(null)}T9e(K,Ia,Ab){const bc=this.$.da.Aa(5);bc&&(K=this.SPh(K))&&(Ia?bc.removeEntry(K):bc.fpe(K,Ab))}SPh(K){switch(K){case 0:return 64;case 1:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}RVc(K){K=Object(U.a)(Ej.a,this.$.va.getItemByName(K));(null===K||void 0===K?0:K.visible)&&K.activate(!0)}qkg(K,Ia,Ab,bc){var vc=K.qa.es;const Tc=vc<Ia.length&&Ia[vc].contains(K.qa.activeCell);
K=Tc?K.qa.activeCell:Ia[0].topLeft;vc=Tc?vc:0;Cg.h(this.$).e4(Ia,vc,Ab,null,K,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===bc)}static get jjh(){yf.Opa||(yf.Opa={},yf.Opa[Microsoft.Office.WebExtension.CoercionType.Table]=1,yf.Opa[Microsoft.Office.WebExtension.CoercionType.Text]=2,yf.Opa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,yf.Opa[Microsoft.Office.WebExtension.CoercionType.Html]=4,yf.Opa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return yf.Opa}static get mjh(){yf.nib||
(yf.nib={},yf.nib[Microsoft.Office.WebExtension.FilterType.All]=1,yf.nib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return yf.nib}static get njh(){yf.oib||(yf.oib={},yf.oib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,yf.oib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return yf.oib}static z3e(K){if(!K||!K.length)return null;const Ia=Array(K.length/2);for(let Ab=0;Ab<K.length/2;Ab++)Ia[Ab]={},Ia[Ab].Name=K[2*Ab],Ia[Ab].Value=K[2*Ab+1];return Ia}static S3h(K){if(!K||
!K.length)return null;const Ia=Array(2*K.length);for(let Ab=0;Ab<K.length;Ab++)Ia[2*Ab]=K[Ab].Name,Ia[2*Ab+1]=K[Ab].Value;return Ia}static Ucd(K){if(!K||!K.length)return null;const Ia=Array(K.length);for(let Ab=0,bc=K.length;Ab<bc;Ab++){const vc=K[Ab].length;if(vc){Ia[Ab]=Array(vc);for(let Tc=0;Tc<vc;Tc++)Ia[Ab][Tc]=null==K[Ab][Tc]?null:K[Ab][Tc].toString()}else return null}return Ia}static d4b(K){return"string"===typeof K?bj.a.Zp(yf.jjh,K,0):K}static yXe(K){return"string"===typeof K?bj.a.Zp(yf.mjh,
K,0):K}static fmg(K){return"string"===typeof K?bj.a.Zp(yf.njh,K,0):K}static zni(K){switch(K.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static R_c(K,Ia){const Ab={};Ab.CoerceType=K;1===Ab.CoerceType?(Ab.Data=yf.Ucd(Ia.Rows),Ab.Headers=yf.Ucd(Ia.Headers)):Ab.Data=yf.Ucd(Ia);return Ab}static hye(K){return 1===K.CoerceType?{["Headers"]:K.Headers,["Rows"]:K.Data}:K.Data}static Qgc(K){return 1===K.CoerceType?!K.Data&&!K.Headers:!K.Data}static J6e(K){let Ia=
"Unknown";if(!K)return Ia;for(let Ab=0;Ab<K.length;Ab++)if(K[Ab].Name.toLowerCase()===Od.a.wqj){Ia=K[Ab].Value;break}return Ia}static YEj(K){if(!K)return!1;const Ia=Od.a.EMi.toLowerCase();for(let Ab=0;Ab<K.length;Ab++)if(K[Ab].Name.toLowerCase()===Ia)return!0;return!1}static N3a(K,Ia,Ab){const bc={};bc.Code=K;bc.Message=Ia;bc.Location=Ab;bc.ActionIndex=0;return bc}}yf.Opa=null;yf.nib=null;yf.oib=null;yf.VFd=0;Object(d.a)(yf,"DdaMethodHandler",null,[221,2]);class cj extends gd.a{constructor(K){super(K)}hd(){const K=
Uf.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Xa),Ia=Uf.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Xa),Ab=Qi(this.la,this.Xa),bc=C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?Uf.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):Ug.Task.Ra(null);Af.TaskExtensions.za(Af.TaskExtensions.Fd([K,Ia,Ab,bc],this.la),()=>{const Tc=K.result,ad=qc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
this.$c([new yf(this.$,Tc,ad,bc.result)])},this.la,3);const vc=qc.a.instance;Af.TaskExtensions.za(Uf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.Xa),()=>{vc.register(ng,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").qc().yc(()=>new ng)},this.$.la)}static ka(K){gd.a.Ld(82,new cj(K))}}Object(d.a)(cj,"DdaCommandHandlerFactory",gd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Ai("");c.a.Ai(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(K=>{xb.ka(K)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Ub.a)();Type.registerNamespace("CommandUI.AddInCommands");
(()=>{f.a.Fa(K=>{C.EwaSettings.sa(52)&&lh.ka(K)})})();(()=>{f.a.Fa(K=>{C.EwaSettings.sa(114)&&$h.ka(K)})})();f.a.Fa(hi.ka);f.a.Fa(sh.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(K=>{zi.ka(K);Jd.ka(K);ye.ka(K)})})();f.a.Fa(cj.ka)},1490:function(t,F,a){t=a(0);var c=a(191),b=a(98);class e{constructor(){this.kOe=this.displayName=this.Zrb=this.Bo=this.mB=null;this.isUpgraded=!1}Qlf(d,h){return this.mB.getStoreType().toLowerCase()===
d.toLowerCase()&&this.mB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(t.a)(e,"AddinCommandsResourceItem",null,[]);a.d(F,"a",function(){return f});class f{constructor(){this.IGc=null;this.wLc=0;this.aNc=!1;this.Za=new b.a;this.lyg=new c.a}uLg(d){this.Za.addHandler("AddinCommandsLoadingMessageChanged",d)}vij(d){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",d)}get dZa(){return this.IGc}Ldb(d){d!==this.IGc&&(this.IGc=d,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))}Pwj(){this.wLc++;
this.dZa||this.Ldb(CommonUIStrings.l_LoadingAddInsTitle)}nRd(){this.wLc--;this.Blc()&&(this.aNc?this.dZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Ldb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Ldb(null))}z4f(d=!1){this.aNc=!0;this.Ldb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}nCe(){this.aNc=!1;this.Blc()?this.Ldb(null):this.Ldb(CommonUIStrings.l_LoadingAddInsTitle)}Blc(){return 0>=this.wLc}get e6a(){return this.lyg}Nia(d,
h,m=0){for(let l of this.e6a)if(l.Qlf(d,h)&&(!l.Bo||l.Bo.nNh===m))return l;return null}$oe(d,h,m,l){const v=new e;v.mB=d;v.Bo=h;v.Zrb=m;v.displayName=l;this.e6a.add(v)}AJg(d,h,m,l){const v=new e;v.mB=d;v.Bo=h;v.Zrb=null;v.kOe=m;v.displayName=l;this.e6a.add(v)}Xgj(d,h){let m=0;for(let l of this.e6a)l.mB.getStoreType()===d&&l.mB.getSolutionId()===h?this.e6a.removeAt(m):m++}static getInstance(){f.La||(f.La=new f);return f.La}}f.La=null;Object(t.a)(f,"AddinCommandsResourceManager",null,[])},744:function(t,
F,a){a.d(F,"a",function(){return b});t=a(0);var c=a(35);class b{static get YHi(){return b.oee||(b.oee={["-2002156328"]:b.$De,["-1954750170"]:b.h7e,["317650254"]:b.h6g,["-1005263101"]:b.Tji,["1353664579"]:b.xuj,["159671765"]:b.Uji,["1446690022"]:b.Z1e,["1150069548"]:b.oDc,["-1409306331"]:b.IAe,["338507772"]:b.$Je,["-457159301"]:b.M2i,["-1037701970"]:b.Lih,["-1893322318"]:b.Zji,["965579896"]:b.Nih,["93287890"]:b.Mih,["358088857"]:b.Exj,["-1223650923"]:b.$Je,["2007306190"]:b.j2g,["1549955423"]:b.gxe,
["-1275974171"]:b.Yji,["382101082"]:b.$1i,["-898776235"]:b.DJi,["335464256"]:b.tJi,["1677378049"]:b.Xji,["-261992848"]:b.GXj,["-980820954"]:b.gxe,["-931375837"]:b.Z1i,["929186550"]:b.mqh,["-982144310"]:b.V9i,["-785741187"]:b.Rji,["2125217573"]:b.aki,["299124955"]:b.Sji,["1669853884"]:b.Jqj,["-1515932330"]:b.i6g,["314621024"]:b.GJh,["-300049690"]:b.n2g,["14766835"]:b.ICj,["-1251992761"]:b.iNe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,
["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.LFa,["49173765"]:b.LFa,["-907155566"]:b.LFa,["-1201603824"]:b.LFa,["1541165282"]:b.LFa,["-1347753427"]:b.LFa,["134912532"]:b.LFa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static NZe(e){return c.a.Zp(b.YHi,e.toString(),b.internalError)}}b.success=0;b.$De=1E3;b.h7e=1001;b.h6g=1002;b.Tji=1003;b.xuj=1004;b.Uji=1005;b.Z1e=1008;b.lXe=1009;
b.invalidSheetName=1014;b.oDc=2E3;b.IAe=2001;b.$Je=2002;b.M2i=2003;b.Lih=2004;b.Zji=2005;b.Nih=2007;b.Mih=2008;b.Exj=2009;b.j2g=2014;b.luj=3E3;b.gxe=3002;b.Yji=3004;b.$1i=3005;b.DJi=3006;b.tJi=3007;b.Xji=3008;b.GXj=3009;b.Z1i=3010;b.ICj=4002;b.bFd=5E3;b.internalError=5001;b.iNe=5002;b.Rzb=5004;b.JYj=5007;b.Iei=5008;b.invalidOrTimedOutSession=5012;b.FFc=5016;b.LFa=5102;b.Cnj=5103;b.responsePayloadSizeLimitExceeded=5104;b.F1g=7001;b.Iag=7002;b.mqh=8E3;b.V9i=8001;b.Rji=8010;b.aki=8011;b.Sji=8012;b.Jqj=
8020;b.i6g=8021;b.GJh=8022;b.n2g=8023;b.DHi=11E3;b.rKi=11001;b.$ji=11002;b.oee=null;Object(t.a)(b,"DdaErrorIds",null,[])},745:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.rVc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.YEd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";
c.MYj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.rPg="AddinIsAlreadyRequestingToken";c.cpj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.b$g="ControlIdNotFound";c.Spj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(t.a)(c,"ErrorCodes",null,[])},748:function(t,F,a){a.r(F);var c=a(0),
b=a(7),e=a(15),f=a(1336),d=a(85),h=a(98);class m{constructor(Ka,Ib,dc){this._id=Ka;this.gsg=Ib;this.oug=dc;this.agf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get qPg(){return this.gsg}get M6g(){return this.oug}execute(Ka,Ib,dc){dc=dc||{};dc.commandMode=this.agf;Ib.invokeAppCommand(this.qPg,this.M6g,dc,()=>{Ka.sWi(this.id)})}}Object(c.a)(m,"AddinNativeActionBase",null,[149]);class l extends m{constructor(Ka,Ib){super(1,Ka,Ib);this.agf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}
Object(c.a)(l,"AddinTakeSnapshotAction",m,[]);class v{Hah(Ka){return new m(3,Ka,this.YNh().getNativeActionName(3))}YNh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(v,"AddinNativeActionManager",null,[125]);var r=a(150);class A{invokeAppCommand(Ka,Ib,dc,yc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ka,Ib,dc,yc)}static getInstance(){A.La||(A.La=new A);return A.La}}A.La=null;Object(c.a)(A,"OSFAddinCommandsRuntimeManager",null,[124]);var x=a(4),n=a(184),u=
a(27);class z extends r.a{constructor(Ka,Ib,dc){super();this.d9=null;this.sUc="WACDialogTitleText";this.mX="0";this.e8="15px";this.Eug="0px";this.lX="calc(100% - 30px)";this.Dug="100%";this.Qhe=0;this.Za=new h.a;this.isg=new v;this.Ob=5;this.pe=this.mDa=dc;this.NJc=Ka;this.W7d=Ib;this.aKc=!!x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}INg(Ka){this.Za.addHandler("OnDialogClosedEventKey",Ka)}Dzj(){this.vEa=null}Hw(){super.Hw();this.Kh.style.width=
"100%";this.Kh.style.height=this.Eec?this.lX:this.Dug;this.Kh.style.marginTop=this.Eec?this.e8:this.Eug;this.Kh.style.padding=this.mX}zD(){super.zD();this.lb.style.width=String.format("{0}px",this.NJc*window.innerWidth/100);this.lb.style.height=String.format("{0}px",this.W7d*window.innerHeight/100);this.lb.style.minWidth="0px";this.aKc&&x.AFrameworkApplication.isRtl&&100===this.NJc&&(this.lb.style.right="0px",this.lb.style.marginRight="0px");this.d9=document.getElementById(this.Dh(this.sUc));this.d9.style.position=
"absolute";this.d9.style.whiteSpace="nowrap";this.d9.style.textOverflow="ellipsis";x.AFrameworkApplication.isRtl?(this.d9.style.right="14px",this.d9.style.left="44px"):(this.d9.style.right="44px",this.d9.style.left="14px")}qy(Ka){super.qy(Ka);this.d9&&this.d9.setAttribute("title",Ka)}get V$(){return this.Kh}LNd(){this.lb.style.width=String.format("{0}px",this.NJc*window.innerWidth/100);this.lb.style.height=String.format("{0}px",this.W7d*window.innerHeight/100);this.lb.style.overflowY="hidden";this.lb.style.overflowX=
"hidden";this.lb.style.marginTop="";this.lb.style.top="";u.a.N4&&x.AFrameworkApplication.isRtl?(this.lb.style.right="",this.lb.style.marginRight=""):(this.lb.style.left="",this.lb.style.marginLeft="")}hide(){this.isg.Hah(this.mDa).execute(this,A.getInstance(),{});this.Qhe=window.setTimeout(()=>{this.Za.raiseEvent("OnDialogClosedEventKey",this.mDa);n.a.prototype.hide.call(this)},500)}sWi(Ka){3===Ka&&(window.clearTimeout(this.Qhe),this.Za.raiseEvent("OnDialogClosedEventKey",this.mDa),super.hide())}}
Object(c.a)(z,"AppsForOfficeDialog",r.a,[104,105]);class w{constructor(){this.dialog=this.pe=null}}Object(c.a)(w,"DialogInfo",null,[]);class C{}C.url="url";C.height="height";C.width="width";C.G8c="displayInIframe";C.bfc="hideTitle";Object(c.a)(C,"DialogSettings",null,[]);class y{constructor(){this.height=this.width=0;this.pe=this.controlId=this.pageUrl=null;this.bfc=this.G8c=!1}}Object(c.a)(y,"DisplayDialogParams",null,[]);class B extends Sys.EventArgs{constructor(Ka,Ib,dc=null,yc="",Eb=""){super();
this.controlId=Ka;this.messageType=Ib;this.messageContent=dc;this.messageOrigin=yc;this.targetOrigin=Eb}}Object(c.a)(B,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(Ka,Ib,dc=null,yc="",Eb=""){super();this.controlId=Ka;this.messageType=Ib;this.messageContent=dc;this.messageOrigin=yc;this.targetOrigin=Eb}}Object(c.a)(H,"OnMessageParentEventArgs",Sys.EventArgs,[]);var I=a(39),R=a(30),S=a(174),G=a(100);class D{constructor(Ka){this.Za=new h.a;this.Gl=Ka}QNg(Ka){this.Za.addHandler("OnMessageParentEventKey",
Ka)}PNg(Ka){this.Za.addHandler("OnMessageDialogEventKey",Ka)}showDialog(Ka,Ib,dc,yc){if(D.R7.hb(Ib))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Ye=I.b(Ka),se=Ye[C.url];if(this.Gl.getOsfControl(Ib).checkAppDomains(se)){var Eb=new y;Eb.width=Ye[C.width];Eb.height=Ye[C.height];Eb.pageUrl=se;Eb.G8c=Ye[C.G8c];Eb.bfc=Ye[C.bfc];Eb.controlId=Ib;Eb.pe=S.a.create().toString();
var Ac=new w;Ac.pe=Eb.pe;var ld=this.Gl.getOsfControl(Eb.controlId).getManifest().getDefaultDisplayName(),Vd=this.Gl.getOsfControl(Eb.controlId).getStoreType().toLowerCase();Ka=null;Ka=(4===x.AFrameworkApplication.ra.Qa.Oj&&"hardcodedpreinstall"===Vd||"sdxcatalog"===Vd)&&Eb.bfc?this.createAndShowAppsForOfficeDialog(Eb.width,Eb.height,Eb.pe,!0,ld):this.createAndShowAppsForOfficeDialog(Eb.width,Eb.height,Eb.pe,!1,ld);var Od=this.Gl.getOsfControl(Eb.controlId),he=Od.getManifest();Ib={};Ib.id=Eb.pe;Ib.solutionId=
Od.getSolutionId();Ib.version=Od.getVersion();Ib.storeType=Vd;Ib.storeId=Od.getStoreId();Ib.assetId=Od.getAssetId();Ib.assetStoreId=Od.getAssetStoreId();Ib.ownerAddinSolutionId=Od.getOwnerAddinSolutionId();Ib.ownerAddinStoreType=Od.getOwnerAddinStoreType();Ib.appDomains=he.getAppDomains();Ib.dialogUrl=se;Ib.osfControlType=1;Ib.agaveName=ld;Ib.div=Ka.V$;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.solutionId,Ib.ownerAddinStoreType||
Ib.storeType,Ib.assetId,null,null,Ib.storeId),R.a.Yu(Eb.pageUrl));this.Gl.insertDialogControl(Ib);Ka.INg(Object(d.a)(this,this.CQi,"onDialogClosed"));Ac.dialog=Ka;D.R7.ia(Eb.controlId,Ac);yc&&yc(Ib);dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Ye){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Ye.message),
dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}aIi(Ka,Ib,dc,yc){x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===yc&&(yc=dc);try{const Eb=this.oKa(Ka);Eb&&this.Za.raiseEvent("OnMessageParentEventKey",new H(Eb,OSF.DialogMessageType.DialogMessageReceived,Ib,dc,yc))}catch(Eb){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Eb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}urb(Ka,
Ib){if(D.R7.hb(Ka))try{const dc=D.R7.ma(Ka);dc.dialog&&dc.dialog.hide();this.Gl.purgeDialogControl(dc.pe);D.R7.remove(Ka);Ib(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(dc){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",dc.message),Ib(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Ib(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}fvj(Ka,
Ib,dc,yc){x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===yc&&(yc=dc);if(D.R7.hb(Ka)&&(Ka=D.R7.ma(Ka),Ka.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new B(Ka.pe,OSF.DialogMessageType.DialogParentMessageReceived,Ib,dc,yc))}catch(Eb){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Eb.message)}}oKa(Ka){let Ib=null;for(let dc of D.R7)if(dc.value.pe===Ka){Ib=dc.key;
break}return Ib}CQi(Ka,Ib){if(Ka=this.oKa(Ib))this.Gl.purgeDialogControl(Ib),D.R7.remove(Ka),this.Za.raiseEvent("OnMessageParentEventKey",new H(Ka,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Ka,Ib,dc,yc,Eb){Ka=new z(Ka,Ib,dc);Eb=yc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Eb);yc&&(Ka.Eec=!1,Ka.pt=!1);Ka.initializeAndShow(Eb,null,null);Ka.Dzj();return Ka}static O6h(){return D.R7}static getInstance(Ka){D.La||(D.La=new D(Ka));return D.La}}
D.La=null;D.R7=new G.a;Object(c.a)(D,"AppsForOfficeDialogManager",null,[32]);var E=a(865),M=a(697),L=a(552),N=a(191),Y=a(380),U=a(1343);class P{constructor(){this.Heb=null;this.errorCode=0;this.failure=null}}Object(c.a)(P,"AddinCollection",null,[]);class aa extends Sys.EventArgs{constructor(Ka,Ib){super();this.uob=Ka;this.dY=Ib}}Object(c.a)(aa,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class X{constructor(Ka){this.errorCode=Ka;this.dY=[];this.failure=null}}Object(c.a)(X,"GetAddinDetailsResult",
null,[]);var Z=a(730),da=a(834);class qa{}Object(c.a)(qa,"GetEntitlementDetailsParameters",null,[]);var O=a(179);class ca{constructor(Ka,Ib){this.Za=new h.a;this.Q7=new M.a(L.a.Ni());this.Uz=new Y.a;this.JTc=new O.a;this.JTc.add(OSF.StoreTypeEnum.MarketPlace,0);this.JTc.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.mb=Ka;this.Gl=Ib;this.aqe(Object(d.a)(this,this.mNi,"onAddinDetailsRefreshed"))}get Ng(){return this.Gl.value}get xGd(){return this.mb.Wa("PopularAddinDetailsJsonString")}awb(Ka){if(!this.Rod(Ka))return Ka=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:U.a[Ka]}),Object.assign(new X(1),{failure:Ka});if(this.Uz.ma(Ka).failure)return Object.assign(new X(this.Uz.ma(Ka).errorCode),{failure:this.Uz.ma(Ka).failure});e.ULS.shipAssertTag(509870082,220,!!this.Uz.ma(Ka).Heb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ka);const Ib=new X(0);for(let dc of this.Uz.ma(Ka).Heb)this.Q7.hb(dc)&&Array.add(Ib.dY,this.Q7.ma(dc));return Ib}VNh(Ka){return this.Q7.hb(Ka)?
this.Q7.ma(Ka):null}Ktc(Ka){if(Ka){this.aqe(Ka);for(let dc of this.Uz.keys)if(this.Rod(dc)&&!this.Uz.ma(dc).failure){e.ULS.shipAssertTag(509870081,220,!!this.Uz.ma(dc).Heb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",dc);var Ib=[];for(let yc of this.Uz.ma(dc).Heb)Array.add(Ib,this.Q7.ma(yc));Ib=new aa(dc,Ib);Ka(null,Ib)}}}nR(Ka,Ib=!1){0!==Ka&&10!==Ka?e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",da.a[Ka]):this.k$i(Ka,
Object(d.a)(this,this.FXi,"onQueryAddinDetailsCompleted"),Ib)}aqe(Ka){this.Za.addHandler(Z.a.Ure,Ka)}FXi(Ka,Ib,dc){if(dc)if(ca.nDi(Ka,dc,window.performance.now()-Ib),0===dc.errorCode){let Eb;if(dc.value){let Ac=0;Eb=Array(dc.value.length);dc.value.forEach(ld=>{Eb[Ac++]=ld})}else Eb=[];this.Nxf(Ka,Eb)}else if(-1===dc.errorCode||10===dc.errorCode)this.Nxf(Ka,[]);else{var yc={};yc.collectionType=U.a[Ka];yc.invokeResultCode=dc.errorCode;yc["queryResult.Value"]=dc.value?String.format("Length: {0}",dc.value.length):
"null";yc.queryStart=Ib;yc.queryDuration=window.performance.now()-Ib;this.Uz.ia(Ka,Object.assign(new P(Ka),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",yc)}));e.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",U.a[Ka],this.Uz.ma(Ka).failure.toString(),JSON.stringify(this.Uz.ma(Ka).failure))}else yc={},yc.collectionType=U.a[Ka],yc.queryResult=dc?"not null":"null",
yc.queryStart=Ib,yc.queryDuration=window.performance.now()-Ib,this.Uz.ia(Ka,Object.assign(new P(Ka),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",yc)})),e.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",U.a[Ka],this.Uz.ma(Ka).failure.toString(),JSON.stringify(this.Uz.ma(Ka).failure))}Skd(Ka){const Ib={};Ib.collectionType=U.a[Ka];this.Uz.ia(Ka,Object.assign(new P(Ka),
{errorCode:2,failure:Error.create("The store is disabled.",Ib)}));e.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",U.a[Ka],this.Uz.ma(Ka).failure.toString(),JSON.stringify(this.Uz.ma(Ka).failure))}k$i(Ka,Ib,dc=!1){e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Ka);Ka!==OSF.StoreTypeEnum.MarketPlace&&Ka!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",
Ka):(this.Rod(2)||this.queryStoreDisabled(0,(yc,Eb)=>{Eb?this.Skd(2):(yc=window.performance.now(),Ib(2,yc,this.Q_h()))}),this.queryStoreDisabled(Ka,(yc,Eb)=>{if(yc===OSF.StoreTypeEnum.MarketPlace&&Eb)this.Skd(0);else if(yc===OSF.StoreTypeEnum.PrivateCatalog&&Eb)this.Skd(1);else{var Ac=window.performance.now();this.Ng.getEntitlementDetails(Object.assign(new qa,{storeType:yc,refresh:dc}),ld=>{Ib(this.JTc.ma(yc),Ac,ld)})}}))}Nxf(Ka,Ib){Ka=new aa(Ka,Ib);this.Za.raiseEvent(Z.a.Ure,Ka)}mNi(Ka,Ib){Ka=Object.assign(new P(Ib.uob),
{Heb:new N.a});var dc=Ib.dY;for(const yc of dc)dc=yc.solutionId,this.Q7.hb(dc)?this.Q7.ia(dc,this.LHi(this.Q7.ma(dc),Ib.uob,yc)):this.Q7.add(dc,yc),Ka.Heb.add(dc);this.Uz.ia(Ib.uob,Ka)}Rod(Ka){return this.Uz.hb(Ka)?!!this.Q7:!1}get aTg(){return!this.mb.pa("AreThirdPartyAddInsAllowed")||this.mb.pa("AppsForOfficeThirdPartyIsDisabled")}get Bqi(){return!this.mb.pa("AppsForOfficeAllowExternalMarketplace")}queryStoreDisabled(Ka,Ib){if(this.aTg)Ib(Ka,!0);else if(Ka===OSF.StoreTypeEnum.MarketPlace&&this.Bqi)Ib(Ka,
!0);else{const dc=ca.NSj(Ka);if(dc){const yc=window.performance.now();this.Ng.queryStoreDisabled(dc,Eb=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Ka,Eb,yc,window.performance.now()-yc);Ib(Ka,Eb)})}else Ib(Ka,!1)}}LHi(Ka,Ib,dc){if(!Ka)return dc;if(!dc)return Ka;if(2===Ib)return Ka.addinInfo=dc.addinInfo,Ka;dc.addinInfo=Ka.addinInfo;return dc}Q_h(){const Ka=JSON.parse(this.xGd);return ca.RYg(Ka)}static nDi(Ka,Ib,dc){const yc=
{};yc.AddinCollectionType=U.a[Ka];yc.ErrorCode=Ib.errorCode;yc.AddinCount=Ib.value?Ib.value.length:0;e.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",dc,JSON.stringify(yc))}static RYg(Ka){const Ib={errorCode:0};Ib.value=Ka;return Ib}static NSj(Ka){return Ka===OSF.StoreTypeEnum.MarketPlace?"omex":Ka===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}}Object(c.a)(ca,"AddinDetailsManager",null,[469]);var wa=a(831),ia=a(1335),Ha=a(1419),
Sa=a(952),Da=a(176),ea=a(1342),sa=a(121),Ea=a(83),ba=a(359),ka=a(89),Ca=a(648),db=a(84),yb=a(420),kb=a(551),mb=a(160),W=a(38),Q=a(5),va=a(880),na=a(1258),Ba=a(81);class Oa{constructor(){this.command=0;this.properties=null}}Object(c.a)(Oa,"DdaRequestInfo",null,[]);var oa=a(744),Ja=a(68);class Wb extends Ba.a{constructor(Ka,Ib){super();this.requests=[];this.disposed=this.$2b=!1;this.$f=()=>{if(!this.disposed){this.grid.Vb.$l(this.$f);this.$2b=!1;const dc=this.requests;this.requests=[];for(let yc of dc)this.ddaFacade.QJ(yc.command,
yc.properties)}};this.ddaFacade=Ka;this.grid=Ib}wkh(Ka,Ib){this.disposed||(this.$2b||(this.grid.Vb.Jm(this.$f),this.$2b=!0),this.requests.push(Object(b.a)(new Oa,{command:Ka,properties:Ib})))}dispose(){if(!this.disposed){this.disposed=!0;this.$2b&&this.grid.Vb.$l(this.$f);var Ka=this.requests;this.requests=null;for(let Ib of Ka)(Ka=Ib.properties?Ib.properties[Ja.a.g3]:null)&&this.ddaFacade.zf(oa.a.Rzb,Ka);this.ddaFacade=this.grid=null;super.dispose()}}static P6g(Ka,Ib){var dc=!1;974713501===Ka&&(Ib=
(Ka=Ib?Ib[Ja.a.Pf]:null)?Ka.DdaMethod:null)&&Ib.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(dc=Ka.ArrayData,dc=!!dc&&64===(dc[6]&64));return dc}}Object(c.a)(Wb,"DdaCellEditDelayRequestHandler",Ba.a,[]);var nc=a(776);class Yb extends nc.a{constructor(Ka,Ib,dc,yc,Eb,Ac,ld){super(Ka,Ib,dc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=yc;this.messageContent=Eb;this.messageOrigin=Ac;this.targetOrigin=ld}}Object(c.a)(Yb,"DialogMessageReceivedEventArgs",
nc.a,[]);class pb extends nc.a{constructor(Ka,Ib,dc,yc,Eb,Ac,ld){super(Ka,Ib,dc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=yc;this.messageContent=Eb;this.messageOrigin=Ac;this.targetOrigin=ld}}Object(c.a)(pb,"DialogParentMessageReceivedEventArgs",nc.a,[]);var Fa=a(1),ab=a(21);class Gb{constructor(Ka){this.Ng=this.UYc=null;this.iWi=(Ib,dc)=>{this.handlers.hb(dc.controlId)&&(Ib=new Yb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,dc.controlId,
null,dc.messageType,dc.messageContent,dc.messageOrigin,dc.targetOrigin),this.handlers.ma(dc.controlId)(Ib),dc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(dc.controlId))};this.hWi=(Ib,dc)=>{this.Ymc.hb(dc.controlId)&&(Ib=new pb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,dc.controlId,null,dc.messageType,dc.messageContent,dc.messageOrigin,dc.targetOrigin),this.Ymc.ma(dc.controlId)(Ib))};this.handlers=new G.a;this.Ymc=new G.a;this.Eg=Ka;this.M1a.QNg(this.iWi);
this.M1a.PNg(this.hWi)}get M1a(){this.UYc||(this.UYc=D.getInstance(this.contextActivationMgr));return this.UYc}get contextActivationMgr(){!this.Ng&&this.Eg&&(this.Ng=this.Eg.Ng);return this.Ng}addHandler(Ka,Ib,dc,yc){if(Fa.EwaSettings.sa(23))this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Eb=Ac=>{Ac===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Ka,
Ib),this.Eg.kv(dc)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Eg.zf(Ac,dc))};this.handlers.hb(Ka)?Eb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Ka,yc,Eb)}}sJg(Ka,Ib,dc){Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Ymc.ia(Ka,Ib),this.Eg.kv(dc))}removeHandler(Ka,
Ib){Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.handlers.hb(Ka)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.M1a.urb(Ka,dc=>{this.handlers.remove(Ka);dc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Eg.kv(Ib):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Eg.zf(dc,Ib))})):this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Ib)}Shj(Ka,Ib){Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Ymc.remove(Ka),this.Eg.kv(Ib))}showDialog(Ka,Ib,dc){try{Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&ab.h(this.Eg.$).fb&&ab.h(this.Eg.$).Do(!0),this.M1a.showDialog(Ib,Ka,dc,yc=>{this.Eg.HJg(this.LZg(yc))})}catch(yc){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${yc.message}`),dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}LZg(Ka){const Ib={};Ib.InstanceId=Ka.id;Ib.WebExtensionType=Ka.osfControlType===OSF.OsfControlTarget.InContent?0:1;Ib.PrimaryMarketplace={};Ib.PrimaryMarketplace.SolutionId=Ka.solutionId;Ib.PrimaryMarketplace.SolutionVersion=Ka.version;Ib.PrimaryMarketplace.MarketplaceRef=Ka.storeId;Ib.PrimaryMarketplace.MarketplaceType=Ka.storeType;Ib.OwnerAddinSolutionId=
Ka.ownerAddinSolutionId;Ib.OwnerAddinStoreType=Ka.ownerAddinStoreType;return Ib}static ka(Ka){if(!Ka.$.da.Aa(232)){const Ib=new Gb(Ka);Ka.$.da.Ha(232,Ib)}}}Object(c.a)(Gb,"DialogMessageReceivedEventManager",null,[664]);class Ga{constructor(Ka,Ib){this.xA=null;this.jfa=Ka;this.MEg=Ib}G_b(Ka){Ka&&(this.xA||(this.xA=[]),this.xA.push(Ka))}Huc(Ka){this.xA&&Array.remove(this.xA,Ka)}get eventId(){return this.jfa}get targetId(){return this.MEg}get Wai(){return 0<this.xA.length}tGi(Ka){return this.eventId!==
Ka.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Ka.ddaBinding.Name:!0}E2b(Ka){this.xA&&Array.forEach(this.xA,Ib=>{Ib(Ka)})}Qma(){this.xA=[]}}Object(c.a)(Ga,"DdaEventRegistration",null,[]);class Ma{constructor(Ka){this.BE=null;this.dwa=!1;this.Uc=()=>{this.BE.forEach(Ib=>{Ib.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ib.E2b(new nc.a(Ib.eventId,"",null))})};this.Eg=
Ka}invokeDdaMethod(Ka,Ib){const dc={};dc[Ja.a.Pf]=Ka;dc[Ja.a.g3]=Ib;this.Eg.QJ(974713501,dc)}registerDdaEventAsync(Ka,Ib,dc,yc,Eb){Ma.DAb(Ka)?(Ma.Npd(Ka)&&this.emd(),this.BE||(this.BE=[]),Ib=this.dvb(Ka,dc),Ib||(Ib=new Ga(Ka,dc),this.BE.push(Ib)),Ib.G_b(yc),this.Eg.kv(Eb)):this.Eg.zf(-1,Eb)}unregisterDdaEventAsync(Ka,Ib,dc,yc,Eb){Ma.DAb(Ka)?((Ka=this.dvb(Ka,dc))&&Ka.Huc(yc),this.Eg.kv(Eb)):this.Eg.zf(-1,Eb)}emd(){this.dwa||(ab.h(this.Eg.$).ha.NL(this.Uc),this.dwa=!0)}dvb(Ka,Ib){if(!this.BE)return null;
for(let dc=0;dc<this.BE.length;dc++){const yc=this.BE[dc];if(yc.eventId===Ka&&yc.targetId===Ib)return yc}return null}static DAb(Ka){return Ka===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Npd(Ka){return Ka===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Ma,"EmbeddingPage",null,[586]);var Qa=a(181);class wb extends nc.a{constructor(Ka,Ib,dc,yc,Eb,Ac,ld,Vd){super(Ka,Ib,dc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Ac-yc.Reference.FirstColumn;
this.columnCount=Vd;Ka=Math.max(Eb,yc.Reference.FirstRow);Eb=Math.min(Eb+ld-1,yc.Reference.LastRow);Ka>Eb?this.startRow=this.rowCount=void 0:(this.startRow=Ka-yc.Reference.FirstRow,this.rowCount=Eb-Ka+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(wb,"DdaBindingSelectionEventArgs",nc.a,[]);var Na=a(206),ya=a(24),nb=a(41),vb=a(50),gb=a(421),cb=a(33),La=a(37),ja=a(568),Ua=a(114),
lb=a(51),sb=a(94),V=a(12),za=a(11),Ra=a(106);class Xa{}Xa.czh="ewa-wx-disabled-div";Xa.bzh="ewa-wx-container-div";Xa.FSe="ewa-ptp-nov2-flex";Object(c.a)(Xa,"CssClassNames",null,[]);const $a=Xa.czh,ma=Xa.bzh;class fa extends Qa.a{constructor(Ka,Ib,dc,yc=!1){super();this.ndb=0;this.BE=null;this.dwa=!1;this.zsc=null;this.gU=0;this.J6b=this.CVa=this.rJc=this.$4d=null;this.Ebe=!1;this.tQc=this.Dda=this.m2d=null;this.Uc=()=>{this.enabled&&(this.pvj(),this.zsc=nb.d(ab.h(this.$).ha.qa.selectedRanges))};this.b$e=
Eb=>{Eb.controlId===this.Nd.InstanceId&&Array.forEach(this.BE,Ac=>{Ac.tGi(Eb)&&Ac.E2b(Eb)})};this.szf=Eb=>{if((Eb=Object(db.a)(506,Eb))&&!Eb.wt())if(!this.Nd||OSF.OsfControl.isFirstPartyStoreString(this.Nd.PrimaryMarketplace.MarketplaceType)||this.$.rT){Eb.af=this.Nd;Eb.lj=this.Eg;this.m2d=Eb;this.lyc(Eb.oGa);const Ac=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&cb.a.Ad(this.$)&&za.HelperMethods.lw(this.Nd)&&this.Nd.Preload&&!this.Nd.TaskpaneVisible;Ac?Eb.tDd():
Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Eb.tDd(),(this.Nd.SharedRuntime&&1===this.Nd.SharedRuntime.LifeTime||this.Nd.SharedRuntimeId)&&!this.Nd.TaskpaneVisible&&Eb.Kg(!1)):((this.Nd.SharedRuntime&&1===this.Nd.SharedRuntime.LifeTime||this.Nd.SharedRuntimeId)&&!this.Nd.TaskpaneVisible&&Eb.Kg(!1),Eb.tDd());this.n6a||(cb.a.Ad(this.$)?Ac||Eb.k6():gb.a(this.$).result.eI(Eb,!0));this.$.da.Aa(77).HVf(this.szf);this.S9=Object(db.a)(389,Eb)}else e.ULS.sendTraceTag(537170464,
0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Eb,Ac)=>{3===Ac.control.floatingObject.type&&Ac.control.floatingObject.sl.InstanceId===this.S0.WebExtensionId&&(this.S9=Object(db.a)(389,Ac.control),this.lyc(Ac.control.Hd.firstChild),Ra.a(this.$).zuc(this.onFloatingObjectControlAdded))};this.jb=Ka.$;this.Eg=Ka;this.Nd=dc;this.Nd.InstanceId=dc.SrcLocationOverrideResourceId?Ka.L3a(dc.InstanceId,dc.SrcLocationOverrideResourceId):dc.InstanceId;this.Th=Ib;this.S0={};this.S0.WebExtensionId=
dc.InstanceId;this.XKf="osfControl_"+dc.InstanceId;this.w8c="disabled_"+dc.InstanceId;this.S0.BindingData=dc.BindingData;this.n6a=this.Eg.n6a(dc.InstanceId);this.Hgc=this.Eg.Hgc(dc.InstanceId);this.dge=dc.WebExtensionOsfControlType;this.pOf=yc}get controlId(){return this.Nd.InstanceId}Shi(Ka){this.Dda||(this.Dda=Ka)}sVf(){this.Dda&&(this.Dda.dispose(),this.Dda=null)}get controlType(){return this.Nd.WebExtensionType}get ownerAddinSolutionId(){return this.Nd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.gU}get ey(){return this.tQc}get RT(){return this.Nd.SrcLocationOverrideResourceId?
this.Eg.L3a(this.Nd.PrimaryMarketplace.SolutionId,this.Nd.SrcLocationOverrideResourceId):this.Nd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Nd.SrcLocationOverrideResourceId}get sl(){return this.Nd}get S9(){return this.$4d}set S9(Ka){this.$4d=Ka}get osfControlType(){return this.dge}get vta(){return this.rJc}set vta(Ka){this.rJc=Ka}get I6b(){return this.CVa}set I6b(Ka){this.CVa=Ka}get focusOnIframeWhenLoaded(){return this.Nd.FocusOnIframeWhenLoaded}get Jic(){return this.Ebe}set Jic(Ka){this.Ebe=
Ka}Bnd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Nd.PrimaryMarketplace.MarketplaceType)&&Fa.EwaSettings.sa(174)){const Ib=vb.GetServiceTaskFactory.Oa(this.$.da,5,4,0);La.TaskExtensions.za(Ib,()=>{Ib.result.ih(36,null)},this.la,3);return this}if(1===this.Nd.WebExtensionType)La.TaskExtensions.za(gb.a(this.$),Ib=>{Ib.result.ssb(this.$.da,77,5,this.szf,1)},this.la,3);else{var Ka=this.FXe();const Ib=Ra.a(this.$);Ka||(Ka={Type:3},Ka.Id=this.S0.WebExtensionId,Ka.WebExtensionData=this.Nd,Ka.ContentHtml=
"<div/>",Ka.Version=0,Ka.AbsoluteLeft=0,Ka.AbsoluteTop=0,Ka.AbsoluteRight=0,Ka.AbsoluteBottom=0,Ka.Width=0,Ka.Height=0,Ka.ZOrder=0,Ka.OriginDeltaX=0,Ka.OriginDeltaY=0,Ka=new Na.a(Ka),Ib.v5b(Ka,null),Ka=Ib.lr(Ka.Fg()));Ka?(this.lyc(Ka.Hd.firstChild),this.S9=Object(db.a)(389,Ka)):Ib.w_b(this.onFloatingObjectControlAdded)}return this}lef(Ka){this.lyc(Ka);return this}Moc(){this.pOf||this.Eg.Ng.purgeOsfControl(this.controlId,!1);this.Fhg(!0);const Ka=this.FXe();Ka&&Ra.a(this.$).deleteFloatingObject(Ka);
this.Eg.Ui.Bhj(this.controlId);this.Eg.Ui.pPe(this.controlId,!0);this.tQc=null}FDd(Ka){this.S0=Ka}invokeDdaMethod(Ka,Ib){if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var dc={};dc[Ja.a.Pf]=Ka;dc[Ja.a.g3]=Ib;this.Eg.QJ(974713501,dc)}else this.Eg.zf(oa.a.Rzb,Ib)}Tej(Ka,Ib,dc,yc){if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!fa.Roh(Ka)||void 0!==Ib&&null!==Ib&&void 0!==this.h3a(Ib)&&null!==this.h3a(Ib))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${Ka}, targetId: ${Ib}`),fa.Khf(Ka)&&this.Tci(),fa.Npd(Ka)&&this.emd(),fa.Ihf(Ka))Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc):this.Eg.$.da.Aa(232).addHandler(this.controlId,dc,yc,Ib);else if(fa.Jhf(Ka))Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc):this.Eg.$.da.Aa(232).sJg(this.controlId,dc,yc);else{fa.Hhf(Ka)&&this.d$e(-1777565636,yc);this.BE||(this.BE=[]);var Eb=this.dvb(Ka,
Ib);Eb||(Eb=new Ga(Ka,Ib),this.BE.push(Eb));Eb.Qma();Eb.G_b(dc);this.Eg.kv(yc);Ka===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.CVa&&(this.J6b=dc)}else this.Eg.zf(3002,yc);else this.Eg.zf(-1,yc)}QXj(Ka,Ib,dc,yc){fa.Ihf(Ka)?Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc):this.Eg.$.da.Aa(232).removeHandler(this.controlId,yc):fa.Jhf(Ka)?Fa.EwaSettings.sa(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc):this.Eg.$.da.Aa(232).Shj(this.controlId,
yc):(fa.Hhf(Ka)&&this.d$e(1592314317,yc),Ib=this.dvb(Ka,Ib),this.enabled?(Ib&&(Ib.Huc(dc),Ib.Wai||Array.remove(this.BE,Ib),this.BE.length?fa.Khf(Ka)&&this.Ghg(!1):this.Fhg(!1)),this.Eg.kv(yc)):this.Eg.zf(-1,yc))}ka(Ka){V.DOMElementExtensions.getElementById(Ka,this.XKf)||Ka.appendChild(V.DOMElementExtensions.vf(this.ey))}showHide(Ka){V.DOMElementExtensions.setVisible(this.ey,Ka)}resize(Ka,Ib){V.DOMElementExtensions.Hv(this.ey,Ka);V.DOMElementExtensions.vI(this.ey,Ib)}dMe(Ka){if(!this.gU&&!V.DOMElementExtensions.getElementById(this.ey,
this.w8c)&&this.ey){const Ib=document.createElement("div");Ib.id=this.w8c;Ib.className=$a;Ib.style.backgroundImage="url("+lb.a.current.lo(102)+")";Ib.style.opacity=Ka?"1":"0";Ib.style.backgroundRepeat="no-repeat";Ib.style.backgroundPosition="center";this.ey.insertBefore(Ib,this.ey.firstChild)}this.gU++}Frh(){0<this.gU&&this.gU--;this.gU||(V.DOMElementExtensions.vf(V.DOMElementExtensions.getElementById(this.ey,this.w8c)),this.dwa&&!nb.Q(this.zsc,ab.h(this.$).ha.qa.selectedRanges)&&this.Uc(null,null))}h3a(Ka){if(!this.S0||
!this.S0.BindingData)return null;for(let Ib=0;Ib<this.S0.BindingData.length;Ib++)if(this.S0.BindingData[Ib].Name===Ka)return this.S0.BindingData[Ib];return null}getDefaultIconUrl(){const Ka=this.A5e();return Ka?Ka.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Nd.TaskpaneTitle)return this.Nd.TaskpaneTitle;const Ka=this.A5e();return Ka?Ka.getDefaultDisplayName():null}rPf(){if(this.CVa&&this.J6b){const Ka=new nc.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.CVa);
this.J6b(Ka);this.J6b=this.CVa=null}}Kg(Ka){this.m2d&&this.m2d.Kg(Ka)}qxj(){this.$.ea.isNamedObjectViewMode&&this.fsi()&&(this.$.da.Aa(34).pxj(this.ey),this.showHide(!1));if(this.Eg.P5j){if(!this.pOf){const Ka={};Ka.div=this.ey;Ka.id=this.Nd.InstanceId;Ka.solutionId=this.Nd.PrimaryMarketplace.SolutionId;Ka.version=this.Nd.PrimaryMarketplace.SolutionVersion;Ka.storeId=this.Nd.PrimaryMarketplace.MarketplaceRef;Ka.storeType=this.Nd.PrimaryMarketplace.MarketplaceType;Ka.ownerAddinSolutionId=this.Nd.OwnerAddinSolutionId;
Ka.ownerAddinStoreType=this.Nd.OwnerAddinStoreType;this.Nd.AssetMarketplace?(Ka.assetId=this.Nd.AssetMarketplace.SolutionId,Ka.assetStoreId=this.Nd.AssetMarketplace.MarketplaceRef):(Ka.assetId=null,Ka.assetStoreId=null);Ka.settings=this.Nd.OsfPropertyBag;Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Ka.reason=this.n6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Hgc?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Ka.reason=this.n6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Ka.osfControlType=0===this.Nd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Ka.isForUILessAction=4===this.Nd.WebExtensionOsfControlType;Ka.sourceLocationOverrideResourceId=this.Nd.SrcLocationOverrideResourceId;Ka.focusOnIframeWhenLoaded=this.Nd.FocusOnIframeWhenLoaded;
ja.a(this.Nd)&&(Ka.featureGates=x.AFrameworkApplication.fa.U2e(Ka.solutionId));Ka.hostInfoFlags=0;this.vta&&(Ka.hostInfoFlags|=2);za.HelperMethods.lw(this.Nd)&&(Ka.hostInfoFlags|=1);this.$.rT||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Ka.hostInfoFlags|=4);Fa.EwaSettings.sa(553)&&(Ka.hostInfoFlags|=8);Fa.EwaSettings.sa(52)&&Fa.EwaSettings.sa(92)&&!this.rJc&&(Ka.virtualOsfControlActivationCallback=()=>{this.Eg.GEd(this.Nd)});Ka.sharedRuntimeId=this.Nd.SharedRuntime?
this.Nd.SharedRuntime.Resid:this.Nd.SharedRuntimeId;!za.HelperMethods.lw(this.Nd)||this.Nd.Preload||ja.a(this.Nd)||this.Eg.Ng.getOsfControl(a(748).DdaFacade.getSolutionId(this.Nd,this.$))||(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Eg.GEd(this.Nd):this.Eg.GEd(this.Nd));Ka.initialDisplayMode=this.Nd.TaskpaneVisible?2:1;Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Ka.titleOverride=this.sl.TaskpaneTitle);
this.Eg.Ng.insertOsfControl(Ka)}this.gU=0}else this.dMe(!0)}Fhg(Ka){this.Ghg(Ka);this.zXj()}Tci(){this.ndb||this.Th.G_b(this.b$e);this.ndb++}Ghg(Ka){0<this.ndb&&(Ka?this.ndb=0:this.ndb--,this.ndb||this.Th.Huc(this.b$e))}emd(){if(!this.dwa){const Ka=ab.h(this.$).ha;this.zsc=nb.d(ab.h(this.$).ha.qa.selectedRanges);Ka.NL(this.Uc);this.dwa=!0}}zXj(){this.dwa&&(ab.h(this.$).ha.sR(this.Uc),this.dwa=!1)}muj(Ka){var Ib=new ya.Range(Ka.Reference.FirstRow+1,Ka.Reference.FirstColumn+1,Ka.Reference.LastRow+1,
Ka.Reference.LastColumn+1,!1,!1);1===Ka.BindingType&&(Ka.HasHeaders&&--Ib.top,Ka.HasTotals&&(Ib.bottom+=1));var dc=ab.h(this.$).ha.qa.selectedRanges;Ka=Ib.Pzb(this.zsc);dc=Ib.Pzb(dc);return(Ib=Ib.De(ab.h(this.$).ha.qa.activeRange))&&(Ua.e(Ka)&&!Ua.e(dc)||!Ua.e(Ka)&&!Ua.e(dc)&&!nb.Q(Ka,dc))?Ib:null}pvj(){Array.forEach(this.BE,Ka=>{if(Ka.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ka.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Eg.Ui.U0b(this.controlId))if(Ka.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Ka.E2b(new nc.a(Ka.eventId,this.controlId,null));else if(Ka.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Ib=this.h3a(Ka.targetId);if((null===Ib||void 0===Ib?0:Ib.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.yb.na.sheetName:this.$.va.na.name)===Ib.Reference.SheetName){const dc=this.muj(Ib);dc&&Ka.E2b(new wb(Ka.eventId,this.controlId,this.Eg.J1b(Ib),Ib,dc.top-1,dc.left-1,dc.height,dc.width))}}})}dvb(Ka,Ib){if(!this.BE)return null;
for(let dc=0;dc<this.BE.length;dc++){const yc=this.BE[dc];if(yc.eventId===Ka&&yc.targetId===Ib)return yc}return null}FXe(){const Ka=Ra.a(this.$).yU;for(let Ib=Ka.length-1;0<=Ib;--Ib){const dc=Ka[Ib];if(3===dc.floatingObject.type&&dc.floatingObject.sl.InstanceId===this.S0.WebExtensionId)return dc}return null}fsi(){for(let Ka=0;Ka<this.$.yb.count;Ka++)if(this.$.yb.getItem(Ka).imageId===this.S0.WebExtensionId)return!0;return!1}lyc(Ka){this.tQc=Ka;this.ey.id=this.XKf;this.ey.className=ma;this.ey.dir=
this.$.isChromeRtl?"rtl":"ltr";this.qxj()}A5e(){if(!this.enabled)return null;const Ka=ja.a(this.sl)?"":this.sl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.sl.PrimaryMarketplace.SolutionId,Ka)}d$e(Ka,Ib){if(Fa.EwaSettings.sa(23))this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.dge)this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,
Ib);else{const dc={};dc[Z.a.Aob]=this.controlId;const yc=new sb.a(Ka,0,this.$.isEditMode?2:1,0,null);this.$.Ia.Hb(yc,dc);this.Eg.kv(Ib)}}catch(dc){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${dc.message}.`),this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ib)}}static Roh(Ka){return Ka===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ka===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Khf(Ka){return Ka===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
Ka===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ka===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static Npd(Ka){return Ka===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ka===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Ihf(Ka){return Ka===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Jhf(Ka){return Ka===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Hhf(Ka){return Ka===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}
Object(c.a)(fa,"OsfControl",Qa.a,[657]);class eb{constructor(){this.hZa={}}add(Ka){this.hZa[Ka]=!0}remove(Ka){delete this.hZa[Ka]}clear(){for(const Ka of Object.keys(this.hZa))delete this.hZa[Ka]}saf(){return 0<Object.keys(this.hZa).length}XNh(){return Object.keys(this.hZa)}}Object(c.a)(eb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var ua=a(59);class xa{constructor(Ka,Ib,dc){this.jUf=this.iUf=0;this.EMb=this.Wab=null;this.HOi=()=>{var yc=ab.h(this.$).ha.Sa.wA;if(this.xpd(yc)&&
(yc=this.twb(yc))){var Eb={};Eb.chartId=yc;Eb.worksheetId=this.tja();Eb=ua.a.Dc(Eb);this.Qia(51,yc,Eb);this.Qia(51,this.tja(),Eb)}};this.IOi=()=>{if(this.Wab){var yc={};yc.chartId=this.Wab;yc.worksheetId=this.EMb;yc=ua.a.Dc(yc);this.Qia(52,this.Wab,yc);this.Qia(52,this.EMb,yc)}yc=ab.h(this.$).ha.Sa.wA;this.xpd(yc)?(this.Wab=this.twb(yc),this.EMb=this.tja()):this.EMb=this.Wab=null};this.$=Ka;this.Ui=Ib;this.Th=dc}Bpb(Ka){51===Ka.messageType?this.iUf=this.CGa(Ka.actionType,this.iUf,this.HOi):52===Ka.messageType&&
(this.jUf=this.CGa(Ka.actionType,this.jUf,this.IOi))}CGa(Ka,Ib,dc){if(1===Ka)Ib||ab.h(this.$).ha.Sa.dXc(dc),Ib++,this.eBj();else if(2===Ka){if(1>Ib)return Ib;1===Ib&&ab.h(this.$).ha.Sa.SLd(dc);Ib--}return Ib}Qia(Ka,Ib,dc){Ib&&this.Ui.MZ(Ka,Ib)&&this.Th.wM(Ka,Ib,dc)}twb(Ka){return Ka&&Ka.floatingObject?(Ka=Ka.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Ka.length?Ka[0]:null:null}tja(){const Ka=this.$.va.na;return Ka&&0===Ka.GF?Ka.sheetId:null}eBj(){const Ka=ab.h(this.$).ha.Sa.wA;
this.xpd(Ka)&&(this.Wab=this.twb(Ka),this.EMb=this.tja())}xpd(Ka){return!!Ka&&!!Ka.floatingObject&&0===Ka.floatingObject.type}}Object(c.a)(xa,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var tb=a(753),Qb=a(197),pc=a(616),hb=a(101),ib=a(349),Vb=a(55);class wc extends Ba.a{constructor(Ka,Ib,dc){super();this.gU=this.Qza=0;this.Uc=(yc,Eb)=>{if(this.enabled&&!(this.Cjf()||null!==Eb&&void 0!==Eb&&Eb.Ymf)&&(yc=Object(db.a)(hb.a,this.$.va.na))&&0===yc.GF){const Ac=yc.sheetId,ld=this.R1e();let Vd=
null,Od=null;this.Ui.Mmf()&&(Vd=this.grid.wb.zi(this.grid.ha.qa.activeCell),Od=Ac in this.Hkc?this.Hkc[Ac]:null);this.gve(Ac,ld)&&La.TaskExtensions.za(Vb.Task.Ra(!0),()=>{this.sai(Ac,ld);this.dai(Ac,ld,Vd,Od)},this.la);this.cNe(Ac,ld,Vd)}};this.$=Ka;this.Ui=Ib;this.Th=dc;this.grid=ab.h(Ka);this.DNa={};this.Hkc={}}get enabled(){return!this.gU&&0<this.Qza}p1b(Ka){Object(db.a)(ib.a,this.$.va);1===Ka.actionType?(this.Qza||this.grid.ha.NL(this.Uc),this.Qza++):2!==Ka.actionType||1>this.Qza||(1===this.Qza&&
this.grid.ha.sR(this.Uc),this.Qza--)}Wxc(Ka){Ka?this.gU++:(0<this.gU&&this.gU--,this.gU||this.Uc(null,new pc.a(!1)))}R1e(){return this.grid.ha.qa.selectedRanges}gve(Ka,Ib){return Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Ka&&Qb.e(this.DNa)||Ka in this.DNa)&&!nb.Q(this.DNa[Ka],Ib):Ka in this.DNa&&!nb.Q(this.DNa[Ka],Ib)}cNe(Ka,Ib,dc){this.DNa[Ka]=nb.d(Ib);this.Hkc[Ka]=dc}Cjf(){return this.grid.fb||this.grid.Uh}cYe(Ka,Ib){this.Ui.MZ(14,
Ka)&&this.Th.wM(14,Ka,Ib);this.Ui.MZ(14,tb.a.sW)&&this.Th.wM(14,tb.a.sW,Ib)}sai(Ka,Ib){const dc={};dc.worksheetId=Ka;dc.address=this.iid(Ib);Ib=ua.a.Dc(dc);this.cYe(Ka,Ib)}dai(Ka,Ib,dc,yc){if(this.Ui.Mmf()){var Eb="";let Ac="";yc&&(Eb=yc.Gi);dc&&(Ac=dc.Gi);yc?dc?(Ib=dc.usedRange.Pzb(Ib),Eb!==Ac&&this.bac(Eb,"",Ka),this.bac(Ac,this.iid(Ib),Ka)):this.bac(Eb,"",Ka):dc&&(Eb=dc.usedRange.Pzb(Ib),this.bac(Ac,this.iid(Eb),Ka))}}bac(Ka,Ib,dc){if(this.Ui.MZ(100,Ka)){const yc={};yc.address=Ib;yc.worksheetId=
dc;this.Th.wM(100,Ka,ua.a.Dc(yc))}}iid(Ka){return nb.i(Ka,",",this.$,!1)}dispose(){0<this.Qza&&this.grid.ha.sR(this.Uc);this.Hkc=this.DNa=null;this.Qza=0;this.Th=this.Ui=this.$=this.grid=null}}Object(c.a)(wc,"RichApiEventSelectionChangedHandler",Ba.a,[]);var Lc=a(345);class Fc extends wc{constructor(Ka,Ib,dc){super(Ka,Ib,dc);this.Vof=this.Wof=null}R1e(){return Lc.a.Csb(this.grid.ha.rangePicker.yK)}gve(Ka,Ib){return this.Wof!==Ka||!nb.Q(this.Vof,Ib)}cNe(Ka,Ib){this.Wof=Ka;this.Vof=nb.d(Ib)}Cjf(){return!this.grid.fb&&
!this.grid.Uh}cYe(Ka,Ib){this.Ui.MZ(2700,tb.a.sW)&&this.Th.wM(2700,tb.a.sW,Ib)}}Object(c.a)(Fc,"RichApiEventPickedRangesChangedHandler",wc,[]);class fd{constructor(Ka,Ib,dc){this.rQa=this.qQa=0;this.aHa=this.mha=null;this.RCf=()=>{var yc=ab.h(this.$).ha.Sa.wA;if(0<this.rQa&&this.mha&&this.aHa){var Eb={};Eb.shapeId=this.mha;Eb.worksheetId=this.aHa;Eb=ua.a.Dc(Eb);this.fireEvent(2102,this.mha,Eb)}this.Uti(yc)?(this.mha=this.bWj(yc),this.aHa=this.tja(),this.mha&&this.aHa)?0<this.qQa&&(yc={},yc.shapeId=
this.mha,yc.worksheetId=this.aHa,yc=ua.a.Dc(yc),this.fireEvent(2101,this.mha,yc)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.mha}', or worksheet id: '${this.aHa}' from a Floating object or gridview.`):this.aHa=this.mha=null};this.$=Ka;this.Ui=Ib;this.Th=dc}Bpb(Ka){const Ib=ab.h(this.$).ha;1===Ka.actionType?(this.qQa||this.rQa||Ib.Sa.dXc(this.RCf),2101===Ka.messageType?this.qQa++:2102===Ka.messageType&&this.rQa++):2===Ka.actionType&&(2101===Ka.messageType?
this.qQa=0<this.qQa?this.qQa-1:0:2102===Ka.messageType&&(this.rQa=0<this.rQa?this.rQa-1:0),this.qQa||this.rQa||Ib.Sa.SLd(this.RCf))}Uti(Ka){return!!Ka&&!!Ka.floatingObject&&(0===Ka.floatingObject.type||7===Ka.floatingObject.type||1===Ka.floatingObject.type||3===Ka.floatingObject.type||5===Ka.floatingObject.type)}bWj(Ka){if(!Ka||!Ka.floatingObject)return null;Ka=Ka.floatingObject.id;var Ib=Ka.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Ib=Ib&&1===Ib.length?Ib[0]:null;return Ib?Ib:(e.ULS.sendTraceTag(537170457,
344,10,`Expect get the guid like shape id from the floating object id: '${Ka}', but we failed.`),null)}tja(){const Ka=this.$.va.na;return Ka&&0===Ka.GF?Ka.sheetId:null}fireEvent(Ka,Ib,dc){Ib&&this.Ui.MZ(Ka,Ib)&&this.Th.wM(Ka,Ib,dc)}}Object(c.a)(fd,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Ta{constructor(Ka,Ib,dc){this.mUf=this.lUf=this.nUf=this.kUf=0;this.g1i=(yc,Eb)=>{yc=Object(db.a)(hb.a,Eb.na);this.b8a(yc)&&(Eb={},Eb.worksheetId=yc.sheetId,Eb=ua.a.Dc(Eb),this.Qia(11,yc.sheetId,
Eb))};this.j1i=(yc,Eb)=>{yc=Object(db.a)(hb.a,Eb.sF);this.b8a(yc)&&(Eb={},Eb.worksheetId=yc.sheetId,Eb=ua.a.Dc(Eb),this.Qia(12,yc.sheetId,Eb))};this.h1i=(yc,Eb)=>{yc=Object(db.a)(hb.a,Eb.na);this.b8a(yc)&&(Eb={},Eb.worksheetId=yc.sheetId,yc=ua.a.Dc(Eb),this.Qia(11,null,yc,!0))};this.i1i=(yc,Eb)=>{yc=Object(db.a)(hb.a,Eb.sF);this.b8a(yc)&&(Eb={},Eb.worksheetId=yc.sheetId,yc=ua.a.Dc(Eb),this.Qia(12,null,yc,!0))};this.$=Ka;this.Ui=Ib;this.Th=dc}Bpb(Ka){11===Ka.messageType?Ka.targetId===tb.a.sW?this.VTg(Ka.actionType):
this.UTg(Ka.actionType):12===Ka.messageType&&(Ka.targetId===tb.a.sW?this.WTg(Ka.actionType):this.XTg(Ka.actionType))}UTg(Ka){this.kUf=this.CGa(Ka,this.kUf,this.g1i)}XTg(Ka){this.nUf=this.CGa(Ka,this.nUf,this.j1i)}VTg(Ka){this.lUf=this.CGa(Ka,this.lUf,this.h1i)}WTg(Ka){this.mUf=this.CGa(Ka,this.mUf,this.i1i)}CGa(Ka,Ib,dc){1===Ka?Ib=this.CZc(Ib,dc):2===Ka&&(Ib=this.l8c(Ib,dc));return Ib}CZc(Ka,Ib){Ka||this.$.va.Vf(Ib);Ka++;return Ka}l8c(Ka,Ib){if(1>Ka)return Ka;1===Ka&&this.$.va.sg(Ib);Ka--;return Ka}b8a(Ka){return!!Ka&&
0===Ka.GF}Qia(Ka,Ib,dc,yc=!1){Ib=yc?tb.a.sW:Ib;this.Ui.MZ(Ka,Ib)&&this.Th.wM(Ka,Ib,dc)}}Object(c.a)(Ta,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Fb=a(241),ic=a(14),zb=a(227);class Bb extends Sys.EventArgs{constructor(Ka,Ib,dc,yc){super();this.sheet=Ka;this.g2g=Ib;this.offsetX=dc;this.offsetY=yc}}Object(c.a)(Bb,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class ec{constructor(Ka,Ib,dc){this.V3b=null;this.Ctd=!1;this.onPointerDown=yc=>{let Eb;3===yc.ub?({o0a:Eb}=this.gridView.vbc(yc.clientPoint),
this.Ctd=!!Eb&&this.gridView.ha.qa.lNe(Eb)):this.Ctd=!1;this.V3b=yc.clientPoint;return!1};this.fd=yc=>{if(this.gridView.inRangePicker||this.gridView.Uh||this.Ctd||yc.shiftKey||yc.ctrlKey||yc.Ea.button!==Sys.UI.MouseButton.leftButton||!this.V3b||!yc.clientPoint||yc.clientPoint.x!==this.V3b.x||yc.clientPoint.y!==this.V3b.y)return!1;const Eb=({o0a:yc}=this.gridView.vbc(yc.clientPoint)).returnValue,Ac=Object(db.a)(hb.a,this.$.va.na);if(Eb&&Ac&&0===Ac.GF){if(!this.gridView.ha.qa.P3.contains(yc))return!1;
yc=new Bb(Ac,yc,za.HelperMethods.pGd(Eb.x),za.HelperMethods.pGd(Eb.y));this.k1i(yc)}return!1};this.$=Ka;this.gridView=ab.h(Ka);this.Ui=Ib;this.Th=dc;this.tgj()}dispose(){this.nYj()}tgj(){for(const Ka of this.gridView.xn){const Ib=Ka.domElement;Fb.a.instance.ta(ic.a.pointerDown,Ib,this.onPointerDown);zb.a.instance.ta(ic.a.click,Ib,this.fd)}}nYj(){for(const Ka of this.gridView.xn){const Ib=Ka.domElement;Fb.a.instance.Ba(ic.a.pointerDown,Ib,this.onPointerDown);zb.a.instance.Ba(ic.a.click,Ib,this.fd)}}k1i(Ka){var Ib=
Ka.sheet;if(this.b8a(Ib)){var dc={};dc.worksheetId=Ib.sheetId;dc.address=Ka.g2g.toString();dc.offsetX=Ka.offsetX;dc.offsetY=Ka.offsetY;Ka=Ib.sheetId;this.Ui.MZ(21,Ka)&&(Ib=ua.a.Dc(dc),this.Th.wM(21,Ka,Ib));Ka=tb.a.sW;this.Ui.MZ(21,Ka)&&(dc=ua.a.Dc(dc),this.Th.wM(21,Ka,dc))}}b8a(Ka){return!!Ka&&0===Ka.GF}}Object(c.a)(ec,"RichApiEventSingleClickedHandler",null,[]);class Qd{constructor(Ka,Ib,dc){this.fJb=0;this.Kab=this.Sab=null;this.XJf=()=>{const yc=ab.h(this.$).ha.Sa.wA;if(yc)if(this.Bnf(yc)){const Eb=
this.tja();this.Fcd(Eb);this.Sab=yc.floatingObject.id;this.Kab=Eb}else this.Sab&&(this.Fcd(this.Kab),this.Kab=this.Sab=null);else this.Sab&&(this.Fcd(this.Kab),this.Kab=this.Sab=null)};this.$=Ka;this.Ui=Ib;this.Th=dc}p1b(Ka){2E3===Ka.messageType&&(1===Ka.actionType?(this.fJb||ab.h(this.$).ha.Sa.dXc(this.XJf),this.fJb++,this.xxj()):2===Ka.actionType&&this.fJb&&(1===this.fJb&&ab.h(this.$).ha.Sa.SLd(this.XJf),this.fJb--))}Fcd(Ka){var Ib;const dc={};dc.worksheetId=Ka;dc.revisionLoad=!1;if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&
(Fa.EwaSettings.sa(616)||Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const yc=ab.h(this.$).ha.Sa.wA;(null===(Ib=null===yc||void 0===yc?void 0:yc.floatingObject)||void 0===Ib?0:Ib.Wc)?dc.selectedVisualId=yc.floatingObject.Wc.VisualID:dc.selectedVisualId=null}Ib=ua.a.Dc(dc);Ka&&this.Ui.MZ(2E3,Ka)&&this.Th.wM(2E3,Ka,Ib)}tja(){const Ka=this.$.va.na;return Ka&&0===Ka.GF?Ka.sheetId:null}xxj(){const Ka=ab.h(this.$).ha.Sa.wA;this.Bnf(Ka)&&(this.Sab=
Ka.floatingObject.id,this.Kab=this.tja())}Bnf(Ka){return!!Ka&&Ka.$td()}}Object(c.a)(Qd,"RichApiEventVisualSelectionChangedHandler",null,[]);class fc{constructor(Ka,Ib,dc){this.gJb=0;this.Ing=!0;this.pac=0;this.usd=!0;this.RBe=()=>{const yc=document.hasFocus();if(this.Ing!==yc){if(yc){const Eb=ua.a.Dc({});this.Th.wM(2203,tb.a.sW,Eb)}this.Ing=yc}};this.SBe=yc=>{(0<yc.timeRemaining()||yc.didTimeout)&&this.RBe();window.requestIdleCallback(this.SBe)};this.$=Ka;this.Ui=Ib;this.Th=dc;window.requestIdleCallback||
(this.usd=!1)}TTg(Ka){1===Ka.actionType?(this.gJb||this.lUg(),this.gJb++):2!==Ka.actionType||1>this.gJb||(1===this.gJb&&this.Flh(),this.gJb--)}lUg(){if(this.Ui.MZ(2203,tb.a.sW))if(this.usd){const Ka={};Ka.timeout=this.$.ya.CheckFocusTimeout;this.pac=window.requestIdleCallback(this.SBe,Ka)}else this.pac=window.setInterval(this.RBe,this.$.ya.CheckFocusTimeInterval)}Flh(){this.usd?window.cancelIdleCallback(this.pac):window.clearInterval(this.pac)}}Object(c.a)(fc,"RichApiEventWorkbookActivatedHandler",
null,[]);var cd;(function(Ka){Ka[Ka.none=0]="none";Ka[Ka.registerEvent=1]="registerEvent";Ka[Ka.unregisterEvent=2]="unregisterEvent";Ka[Ka.customFunction=3]="customFunction";Ka[Ka.showCard=4]="showCard";Ka[Ka.createWorkbook=5]="createWorkbook";Ka[Ka.openWorkbook=6]="openWorkbook";Ka[Ka.enableEvents=7]="enableEvents";Ka[Ka.closeWorkbook=8]="closeWorkbook";Ka[Ka.setCalculationMode=9]="setCalculationMode";Ka[Ka.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Ka[Ka.workbookLinksRequestRefreshAll=
11]="workbookLinksRequestRefreshAll";Ka[Ka.workbookLinksEnableContent=12]="workbookLinksEnableContent";Ka[Ka.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Ka[Ka.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Ka[Ka.rangePicker=15]="rangePicker";Ka[Ka.enableRichApiRecording=16]="enableRichApiRecording";Ka[Ka.recordAction=17]="recordAction";Ka[Ka.focus=18]="focus";Ka[Ka.businessBarShow=19]="businessBarShow";Ka[Ka.businessBarHide=20]="businessBarHide"})(cd||(cd={}));Object(c.b)("PostProcessActionType",
cd);var jd=a(253);class nd{constructor(Ka,Ib,dc){this.YKf=null;this.Dcd=(yc,Eb)=>{const Ac=tb.a.sW,ld={};ld.eventId=yc;ld.payload=Eb;this.Ui.MZ(2201,Ac)&&this.Th.wM(2201,Ac,ua.a.Dc(ld))};this.$=Ka;this.Ui=Ib;this.Th=dc;this.thi()}STg(Ka){1===Ka.actionType?(this.$.vba=!0,Object(db.a)(a(748).DdaFacade,jd.a(this.$)).Ecd(!0)):2===Ka.actionType&&(this.$.vba=!1);this.YKf=Ka.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${cd[Ka.actionType]}; controlId: ${this.YKf}; this.ewaControl.IsMacroRecorderListening: ${this.$.vba}.`)}Qsh(Ka){Object(db.a)(a(748).DdaFacade,
jd.a(this.$)).fYe(Ka,this.$.vba)}thi(){this.$.FQ&&La.TaskExtensions.za(vb.GetServiceTaskFactory.Oa(this.$.da,297,298,1),Ka=>{(Ka=Ka.result)&&Ka.init(this.Dcd)},this.$.la,3)}}Object(c.a)(nd,"RichApiMacroRecorderEventHandler",null,[]);class vd{}Object(c.a)(vd,"SessionRecreationInfo",null,[]);class wd{constructor(Ka,Ib,dc){this.$=Ka;this.Ui=Ib;this.runtimeCalculationMode=dc}kKi(){return Fa.EwaSettings.sa(234)?this.Ui.hbi()||0!==this.runtimeCalculationMode:!1}XYg(){var Ka={};Ka.eventRegistrationInfos=
this.Ui.qUh();Ka.runtimeCalculationMode=this.runtimeCalculationMode;Ka=Object(b.a)(new vd,{runtimeState:Ka});const Ib={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Ib.RequestBody=JSON.stringify(Ka);Ib.RequestFlags=1;return Ib}}Object(c.a)(wd,"RichApiRuntimeStateHandler",null,[]);class Td{constructor(Ka,Ib,dc,yc,Eb,Ac,ld,Vd,Od){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=
this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Ka;this.processUtcTime=Ib;this.dequeueUtcTime=dc;this.inQueueDurationInMS=yc;this.executionDurationInMS=Eb;this.operationCount=Ac;this.ServerCorrelationId=ld;this.UserOperationName=Vd;this.IsDocumentHidden=Od}}Object(c.a)(Td,"UserOperationQueueItemsStatisticsData",null,[]);var jc=a(330),bd=a(31),Hd=a(19),ge=a(295),Mb=a(49),Kc=a(598),Ob=a(65),Mc=a(56),Dc=a(74);class $c extends jc.a{constructor(Ka,Ib,dc){super(dc,Ka);this.Hva=
this.hashCode=null;this.U4b=!1;this.Sm=(yc,Eb)=>{Eb.Yc.hash===this.hashCode&&this.Hva&&Object(db.a)(a(748).DdaFacade,this.$.da.Aa(35)).xIj(this.Hva.InstanceId)};this.nf=(yc,Eb)=>{switch(Eb.Yc.block.state){case 1:case 3:case 5:this.Qda(Eb)}};this.vj=()=>{this.zIb(!0)};this.vo=(yc,Eb)=>{this.isVisible&&this.ZTa(Eb.sF);this.clearCache()};this.Vd=(yc,Eb)=>{this.$Sa(Eb.na,!!Eb.sF)};this.sN=()=>{this.$.ea.nma()};this.CUa=Ib;this.domElement.classList.add(bd.a.Q9b);this.domElement.classList.add(Hd.a.fo);
dc.tabIndex=0;this.$Sa(this.$.na,!1);this.Cc.ka("mousedown",this.sN);this.Cc.ka("contextmenu",yc=>{Dc.g(yc)});this.$.va.YI(this.vo);this.$.yb.YI(this.vo);this.$.yb.Vf(this.Vd);this.$.va.Vf(this.Vd);this.Ca.Ns(this.nf);this.Ca.xG(this.Sm);this.Ca.Rv(this.vj);this.Uu(this.yya)}get Ca(){return this.CUa}dispose(){this.$&&(this.$.va.FK(this.vo),this.$.yb.FK(this.vo),this.$.yb.sg(this.Vd),this.$.va.sg(this.Vd));this.CUa&&(this.CUa.Hq(this.nf),this.CUa.YH(this.Sm),this.CUa.Mw(this.vj));this.jy(this.yya);
this.clearCache();ka.a.Ja(this.CUa);this.CUa=null;V.DOMElementExtensions.vf(this.domElement);super.dispose()}pxj(Ka){V.DOMElementExtensions.vf(V.DOMElementExtensions.getElementById(this.domElement,Ka.id));this.domElement.appendChild(Ka)}Pnd(){if(this.Hva&&!this.U4b){var Ka=Object(db.a)(a(748).DdaFacade,jd.a(this.$)).nn(this.Hva.InstanceId);Ka&&(Ka.resize(this.Hva.Width,this.Hva.Height),Ka.ka(this.domElement),Ka.showHide(!0),this.U4b=!0)}}d8a(){return!0}Qda(Ka){this.Hva=Ka.Yc.block.Td;this.U4b=!1;
this.Pnd()}ZTa(Ka){this.$.ea.x4&&Ka&&(Ka.Ju||(Ka.Ju=new ge.a),Ka.Ju.ii=new Mb.a(this.domElement.scrollLeft,this.domElement.scrollTop),Ka.Ju.VHb=20)}clearCache(){this.Ca.xQa(this.hashCode);this.Hva=this.hashCode=null;this.U4b=!1}$Sa(Ka,Ib){if(this.isVisible=!!Ka&&Ob.o(Ka))this.hashCode=this.Ca.Kra(Ka,Mc.a.Y6b,this.hashCode),this.Ayc(Ib)}static DGa(Ka){if(!Ka.da.Aa(34)){const Ib=Ka.rf;Ka.da.Ha(34,new $c(Ka,new Kc.a(Ka,Ka.ea,Ka.oa.Ok,3,0),Ib.appendChild(Ib.ownerDocument.createElement("div"))))}}}Object(c.a)($c,
"WebExtensionView",jc.a,[609,484,2]);var td=a(229),Yd=a(374),ae=a(440),je=a(192),Ke=a(60),Fd=a(113),fe=a(48),ne=a(44),ce=a(158),te=a(112),we=a(69),Pe=a(28),qf=a(29),Ve=a(250),Qe=a(22),Ze=a(13),Re=a(282),Za=a(752),Xb=a(52),jb=a(151),Sb=a(882);const lc=Ka=>{jb.a.sendOtelEvent(Object.assign(new Sb.a,{otelEvent:Ka}))},oc=Ka=>{jb.a.sendOtelCustomerContent(Object.assign(new Sb.a,{otelEvent:Ka}))};var Qc=a(175),Kb=a(881),hc=a(25);a.d(F,"DdaFacade",function(){return Cc});class Cc extends W.a{constructor(Ka,
Ib){super();this.Th=this.Gl=this.ea=null;this.uf=[];this.$Ia=null;this.disposed=this.initialized=this.VQb=this.GJe=!1;this.kCa=null;this.Oqc=[];this.AJe=[];this.DPa=[];this.B1a=null;this.gGd=new Ca.a(L.a.Ni());this.Y_b=new M.a(L.a.Ni());this.CHb=[];this.tMf=[];this.c7b=350;this.oxa=this.Tea=null;this.aVc=!1;this.lpa=this.jkb=this.yie=this.xie=this.wie=this.uie=this.qie=this.vie=this.rie=this.tie=this.oie=this.sie=null;this.tf=()=>{this.kCa=this.ea.Pn.WebExtensions;for(var dc=this.uf.length-1;0<=dc;--dc){var yc=
this.uf[dc],Eb;if(Eb=!this.zHh(yc.controlId))Eb=yc,Eb=Fa.EwaSettings.sa(114)?!Eb.vta:!0;Eb&&(yc.Moc(),this.uf.splice(dc,1))}if(this.kCa)for(let Ac=0,ld=this.kCa.length;Ac<ld;Ac++)dc=this.kCa[Ac],(yc=this.nn(dc.WebExtensionId))&&yc.FDd(dc)};this.Ppc=dc=>{this.raiseEvent("csc",dc.getID())};this.Qpc=(dc,yc,Eb)=>{if(yc===OSF.AgaveHostAction.KeyboardShortcuts){var Ac=Object(db.a)(Object,Eb);yc={};yc.keyCode=Ac.keyCode;yc.type="keydown";yc.ctrlKey=Ac.ctrlKey;yc.shiftKey=Ac.shiftKey;yc.altKey=Ac.altKey;
yc.metaKey=Ac.metaKey;Ac=this.nn(dc);dc=Ac.S9;yc.srcElement=Object(yb.a)(506,dc)?dc.oGa:ab.h(this.$).jc;dc=new Sys.UI.DomEvent(yc);Ac=Cc.Rua(Ac.sl,this.$);yc={};yc.focusedAddinId=Ac;Ac=new sb.a(1461300262,1,this.$.xc,6,null);ab.h(this.$).RKb(dc,Ac,yc)}else if(yc===OSF.AgaveHostAction.Select)this.Q9e(!0);else if(yc===OSF.AgaveHostAction.UnSelect)this.Q9e(!1);else if(yc===OSF.AgaveHostAction.CancelDialog)this.QJ(-684355545,null);else if(yc===OSF.AgaveHostAction.InsertAgave)dc={},Eb&&(this.jkb=Eb,dc[Z.a.z9]=
Eb,dc[Ja.a.Pf]=Cc.ita(Eb),this.QJ(-741808261,dc));else if(yc===OSF.AgaveHostAction.ClickTrust)this.gYc&&Eb&&(this.jkb=Eb);else if(yc===OSF.AgaveHostAction.OsfControlLoad)this.gYc&&this.jkb&&Eb&&this.WSg(this.jkb,Eb)&&Eb.storeType&&(this.jkb=null,this.nR(wa.b(Eb.storeType)));else if(yc===OSF.AgaveHostAction.InsertDevManifest)dc={},Eb&&(dc[Z.a.z9]=Eb,dc[Ja.a.Pf]=Cc.ita(Eb),this.QJ(-741808261,dc));else if(yc===OSF.AgaveHostAction.InsertDevManifestError)dc=Object(db.a)(Object,Eb),dc={[Z.a.RXc]:this.Gl.getDevManifestInvalidUrlErrorString(dc.manifestUrl)},
this.QJ(-2025863019,dc);else if(yc===OSF.AgaveHostAction.NotifyHostError)dc={[Z.a.RXc]:this.Gl.getManifestInvaildErrorString()},this.QJ(-2025863019,dc);else if(yc===OSF.AgaveHostAction.RefreshAddinCommands)Fa.EwaSettings.sa(52)&&this.QJ(hc.a.refreshAddinCommands,null);else if(yc===OSF.AgaveHostAction.CtrlF6Exit||yc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ac=this.$.da.Aa(15)){(dc=this.nn(dc).S9)&&dc.MAc();u.a.Cf&&document.activeElement.blur();var ld={keyCode:117,type:"keydown",ctrlKey:!0};ld.shiftKey=
yc===OSF.AgaveHostAction.CtrlF6ExitShift;ld.srcElement=Object(yb.a)(506,dc)?dc.oGa:ab.h(this.$).jc;dc=new Sys.UI.DomEvent(ld);Ac.ema(dc)}}else if(yc===OSF.AgaveHostAction.PageIsReady){if((dc=this.nn(dc).S9)&&dc.oZa===OSF.OsfControlTarget.TaskPane&&(dc=this.$.da.Aa(183))&&this.uf){yc=cb.a.Ad(this.$);for(Ac of this.uf)Cc.mMa(Ac.RT)&&(yc?dc.ag(!0,!1):dc.setFocusOnToolbarFirstElement())}}else if(yc===OSF.AgaveHostAction.TabExit){yc=this.nn(dc);const he=yc.S9;if(he)if(he.oZa===OSF.OsfControlTarget.InContent)he.Aof();
else{if(he.oZa===OSF.OsfControlTarget.TaskPane)if(cb.a.Ad(this.$))u.a.Cf&&document.activeElement.blur(),Da.UISurfaces.ej().then(Ye=>{const se=Object(yb.a)(506,he)?he:null;se?se.isResizable?Ye.focusResizeHandle():Ye.focusTabbedTaskPaneArea():Ye.focusTabbedTaskPaneArea();return null});else if(yc=this.$.da.Aa(183))u.a.Cf&&document.activeElement.blur(),(dc=document.getElementById(this.$.Bb+Q.a.Tnc))&&V.DOMElementExtensions.isVisible(dc)?V.DOMElementExtensions.setFocus(dc):yc.setFocusOnToolbarFirstElement()}else yc&&
4===yc.osfControlType&&this.Gl.notifyAgave(dc,OSF.AgaveHostAction.TabIn)}else if(yc===OSF.AgaveHostAction.TabExitShift)(yc=this.nn(dc),Ac=yc.S9)?Ac.oZa===OSF.OsfControlTarget.InContent?Ac.Bof():Ac.oZa===OSF.OsfControlTarget.TaskPane&&(dc=Object(yb.a)(506,Ac)?Ac:null)&&(u.a.Cf&&document.activeElement.blur(),dc.G4f()):yc&&4===yc.osfControlType&&this.Gl.notifyAgave(dc,OSF.AgaveHostAction.TabIn);else if(yc===OSF.AgaveHostAction.EscExit||yc===OSF.AgaveHostAction.ExitNoFocusable||yc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ac=
this.nn(dc).S9)Ac.MAc();else{if(yc===OSF.AgaveHostAction.EscExit){yc=null;for(ld of D.O6h())if(ld.value.pe===dc){ld.value.dialog.hide();yc=ld.key;break}yc&&(dc=this.nn(yc))&&4!==dc.osfControlType&&this.Ng.notifyAgave(yc,OSF.AgaveHostAction.TabIn)}}else if(yc===OSF.AgaveHostAction.InstallCustomFunctions)if(Fa.EwaSettings.sa(114)){we.a(this.$).nZe(()=>!1);var Vd=this.$.da;La.TaskExtensions.za(vb.GetServiceTaskFactory.Oa(Vd,278,279,1),he=>{he=he.result;Vd.Aa(278)||Vd.Ha(278,he);const Ye=Eb.osfControl.getStoreType();
he.pff(Eb.osfControl.getSolutionId(),Ye,Cc.FSh(Eb.osfControl),Eb).ina()},this.la,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(yc===OSF.AgaveHostAction.UninstallCustomFunctions)if(Fa.EwaSettings.sa(114)){we.a(this.$).nZe(()=>!1);var Od=this.$.da;La.TaskExtensions.za(vb.GetServiceTaskFactory.Oa(Od,278,279,1),he=>{he=he.result;Od.Aa(278)||Od.Ha(278,he);he.Ihg(Eb.solutionId,Eb.storeType).ina()},this.la,
3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else yc===OSF.AgaveHostAction.SendTelemetryEvent?lc(Eb):yc===OSF.AgaveHostAction.SendCustomerContent?oc(Eb):yc===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.yyi(Eb):yc===OSF.AgaveHostAction.RefreshRibbonGallery?(dc=this.$.da.Aa(519))&&dc.Jkd(Eb):yc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.Yhj(Eb.solutionId),cb.a.Ad(this.$)||(dc=this.$.da.Aa(183))&&
dc.FB(),Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&x.AFrameworkApplication.rb.Wd(hc.a.EUf,2,Eb.solutionId)):yc===OSF.AgaveHostAction.GetOriginalControlId&&(dc=new ia.a(this.$.Bb,Eb.ownerAddinSolutionId,new va.a,!0),Eb.originalControlId=dc?dc.TJe(Eb.controlId):Eb.controlId)};this.qvj=(dc,yc)=>{const Eb=Array(2);Eb[0]=yc;Eb[1]=null;this.Th.JHh(dc,JSON.stringify(Eb))};this.Q0i=()=>{this.$.na&&Ob.o(this.$.na)&&this.$.da.Aa(34).Pnd()};
this.dd=()=>{this.Cqf()};this.dR=(dc,yc)=>{var Eb,Ac;1===yc.sr&&(dc=yc.Lf)&&(yc=new Td(te.toTimestamp(dc.enqueueUtcTime),te.toTimestamp(dc.processUtcTime),te.toTimestamp(dc.dequeueUtcTime),te.getElapsedMilliseconds(dc.enqueueUtcTime,dc.processUtcTime),te.getElapsedMilliseconds(dc.processUtcTime,dc.dequeueUtcTime),dc.operationCount,(null===(Ac=null===(Eb=dc.operation)||void 0===Eb?void 0:Eb.od)||void 0===Ac?0:Ac.ServerCorrelationId)?dc.operation.od.ServerCorrelationId:null,dc.operation?Enum.toString(ae.a,
dc.operation.operationName):null,Za.a.oH(te.getElapsedMilliseconds(dc.enqueueUtcTime,Pe.a.Ya.Ub))),Eb=Sys.Serialization.JavaScriptSerializer.serialize(yc),e.ULS.sendTraceTag(50872916,0,50,Eb))};this.Rc=(dc,yc)=>{!this.ea.Xb&&td.a(yc)?(Array.forEach(this.uf,this.FBf),this.uf.length=0,this.VQb=!1):(yc.lH&&(e.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.lZf()),this.JK(),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.VQb=!1))};this.xo=()=>{Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.lZf());this.JK();Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.VQb=!1)};this.FBf=dc=>{dc.Moc();this.raiseEvent("cd",dc.controlId)};this.jb=Ka;this.jYc=Ib;this.initialize();Gb.ka(this);this.n_f=0;(Ka=(Ka=!(u.a.cp||u.a.xba))&&(!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!u.a.Cf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.myg={}}get a1b(){return this.Tea||(this.Tea=new ea.a(this.$.eu))}qqe(Ka){this.addHandler("cd",Ka)}Zij(Ka){this.removeHandler("cd",Ka)}fMg(Ka){this.addHandler("csc",Ka)}ajj(Ka){this.removeHandler("csc",Ka)}cMg(Ka){this.addHandler("ca",Ka)}Yij(Ka){this.removeHandler("ca",Ka)}dMg(Ka){this.addHandler("ci",Ka)}eMg(Ka){this.addHandler("ekros",Ka)}$ij(Ka){this.removeHandler("ekros",Ka)}JFd(Ka,Ib){try{return JSON.parse(Ka)[Ib].toLowerCase()}catch(dc){return""}}VDj(Ka){const Ib=
this.JFd(Ka,"AudienceGroup"),dc=this.JFd(Ka,"SessionOrigin");try{const yc=parseInt(this.JFd(Ka,"Ring"),10);if("automation"!==Ib&&"bluechicken"!==dc&&-2<=yc)return!0}catch(yc){if("automation"!==Ib&&"bluechicken"!==dc)return!0}return!1}get Ng(){if(!this.Gl){const Ka={},Ib=!(this.$.qd&1),dc=lb.a.current.zK,yc=this.$.workbookContext,Eb=sa.a.ZK+sa.a.q4b;Ka.pageBaseUrl=dc.LayoutsContentUrlPrefix;Ka.appName=OSF.AppName.ExcelWebApp;Ka.appVersion="16";Ka.appSettings=this.CWh();Ka.singleSignOnSettings=E.AppsForOfficeSingleSignOnManager.r3h();
Ka.clientMode=Ib?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Ka.appUILocale=this.$.ya.UICultureTag;Ka.dataLocale=this.$.ya.DataCultureTag;Ka.docUrl=yc.ClientUrl;Ka.hostControl=this;Ka.formFactor=OSF.FormFactor.Default;Ka.lcid=this.$.UF.toString();Ka.localizedScriptsUrl=sa.a.ZK+sa.a.M3c;Ka.localizedImagesUrl=Eb;Ka.localizedStylesUrl=sa.a.ZK+sa.a.UEe;Ka.localizedResourcesUrl=Eb;Ka.osfOmexBaseUrl=dc.OsfOmexBaseUrl;Ka.firstPartyManifestCDNUrl=dc.FirstPartyAddInManifestCDN;Ka.sdxAssetsToPrefetchMapping=
x.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");Ka.sdxCdnUrl=dc.SdxCdnUrl;Ka.sdxDmsUrl=dc.SdxDmsUrl;Ka.devCatalogUrl=dc.DevCatalogUrl;Ka.controlStatusChanged=this.Ppc;Ka.notifyHost=this.Qpc;Ka.allowExternalMarketplace=this.$.ea.wg.get(27)&&Cc.b5b;Ka.enableAddinCommands=Fa.EwaSettings.sa(52);Ka.enableBlackForestRedirect=Fa.EwaSettings.sa(87);Ka.enableMyOrg=this.$.ea.wg.get(33);Ka.enableMyApps=this.$.ea.wg.get(34);Ka.enableDevCatalog=Fa.EwaSettings.sa(43);Ka.enablePrivateCatalog=this.QEj();
Ka.enableTaskpaneUpgradeToAppCommand=Fa.EwaSettings.sa(92);Ka.showSignOutFromPrivateCatalogMessage=this.$.ea.wg.get(36);Ka.enableUploadFileDevCatalog=Fa.EwaSettings.sa(52)&&!Fa.EwaSettings.sa(254);Ka.userNameHashCode=R.a.Yu(x.AFrameworkApplication.userName);Ka.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();Ka.enableSingleSignOnForAddin=!Fa.EwaSettings.sa(23)&&x.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Ka.enableDisplayBlockedMinorError=Fa.EwaSettings.sa(171);
Ka.hideAppsExtensionUrl=x.AFrameworkApplication.hideAppsExtensionUrl;Ka.enableAnonymousUseLegacyCatalogService=Fa.EwaSettings.sa(162);Ka.enableInsertDialogAccessibilityFix=Fa.EwaSettings.sa(169);Ka.disableAppsForOfficeThirdParty=Fa.EwaSettings.sa(174);Ka.enableFirstPartySSO=Fa.EwaSettings.sa(186);Ka.wacSessionId=this.$.ya.UserSessionId;Ka.disableLogging=!this.$.ya.AriaLoggingIsEnabled;Ka.enableFirstPartySDXErrorMessages=Fa.EwaSettings.sa(198);Ka.enableRichApiCellEditDelay=Fa.EwaSettings.sa(178);Ka.isHostDocumentDomain=
Fa.EwaSettings.sa(209);Ka.loggableUserId=x.AFrameworkApplication.fa.Wa("LoggableUserId");Ka.sessionStartInfoJson=x.AFrameworkApplication.fa.Wa("SessionStartInfoJson");Ka.wopiHostOriginFromPostMessage=x.AFrameworkApplication.wopiHostOriginFromPostMessage;Ka.wopiHostOriginFromWacPropBag=x.AFrameworkApplication.fa.Wa("PostMessageOrigin");Ka.wacIsEmbedded=x.AFrameworkApplication.fa.pa("IsEmbedded");Ka.accessibilityAllowFocusAddinTaskpane=x.AFrameworkApplication.fa.pa("AccessibilityAllowFocusAddinTaskpane");
Ka.enableRemoveAppCommandsAddin=x.AFrameworkApplication.fa.pa("RemoveAppCommandsAddinIsEnabled");Ka.isHostFrameTrustCheckEnabledForAddIns=x.AFrameworkApplication.fa.pa("HostFrameTrustCheckIsEnabledForAddIns");Ka.isHostFrameTrusted=x.AFrameworkApplication.isHostFrameTrusted;Ka.agaveAddinUploadEnabled=Fa.EwaSettings.sa(45);Ka.hostAllowedOfficeStore=x.AFrameworkApplication.fa.pa("HostAllowedOfficeStore");Ka.hostAllowedSdxEmbedding=x.AFrameworkApplication.fa.pa("HostAllowedSdxEmbedding");Ka.hostInstallAddIns=
x.AFrameworkApplication.fa.Wa("HostInstallAddIns");Ka.hostInstallAddInsIsEnabled=x.AFrameworkApplication.fa.pa("HostInstallAddInsIsEnabled");Ka.approvedAddIns=x.AFrameworkApplication.fa.Wa("ApprovedAddIns");Ka.addinEnforceHttpsIsEnabled=this.VDj(Ka.sessionStartInfoJson);Ka.hostFeatureGateFlag=0;Ka.isUpnCheckEnabled=x.AFrameworkApplication.fa.pa("IsUpnCheckEnabled");Ka.wacUpn=x.AFrameworkApplication.fa.Wa("UserPrincipalName");Ka.isReactRibbonEnabled=cb.a.isReactRibbonEnabled();Ka.enableSetFocusOnTaskpaneOnUserAction=
Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Ka.isSafariWithIndexedDBDisabled=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&u.a.YMa;Ka.isIndexedDBDisabled=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&u.a.YMa||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&u.a.Cf;Ka.enableCustomShortcuts=!0;Ka.changeGetModifierKeyStringOutputOrder=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
Ka.officeJsUrl=x.AFrameworkApplication.WN("OfficeJs/excel.js",5);Ka.enableOfficeJsUrlParam=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Gl=new OSF.ContextActivationManager(Ka);this.Gl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Gl.setWSA(x.AFrameworkApplication.Fn);this.Gl&&"undefined"!==typeof this.Gl.hostCheckReadyHandler&&x.AFrameworkApplication.aNg(Object(d.a)(this.Gl,this.Gl.hostCheckReadyHandler,"hostCheckReadyHandler"));
try{const Ac=Ea.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Gl.setOAuthManager(Ac)}catch(Ac){}}return this.Gl}get P5j(){return this.aVc}get Ui(){return this.sie}get ena(){return this.oie}get KOd(){return this.tie}get JOd(){return this.rie}get tqj(){return this.vie}get rqj(){return this.qie}get sqj(){return this.uie}get uqj(){return this.wie}get vqj(){return this.xie}get LOd(){return this.yie}get XU(){return this.myg}get $(){return this.jb}J1b(Ka){const Ib={};Ib.Name=Ka.Name;Ib.BindingType=
Ka.BindingType;Ib.HasHeaders=Ka.HasHeaders;Ka.IsValidRef&&(Ib.ColCount=Ka.Reference.LastColumn-Ka.Reference.FirstColumn+1,Ib.RowCount=Ka.Reference.LastRow-Ka.Reference.FirstRow+1);return Ib}get SXc(){return x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}Spf(Ka,Ib){const dc=this.ZXg(Ib);let yc=null;if(x.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Ib&&"LaunchAddinDialogFromTellMe"===Ib[0])null!==dc.assetId&&"undefined"!==typeof dc.assetId&&(yc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.SXc){const Eb=this.$.ea.wg.get(27);Eb&&null!==Ib&&"InsertMoreAddInsFromFooter"===Ib[0]?yc="{98143890-AC66-440E-A448-ED8771A02D52}":Eb&&null!==Ib&&"AddinFlyoutMoreButton"===Ib[0]&&(yc="0")}this.Gl.launchInsertDialog(Ka,yc,dc)}get k2(){return this.zob}get zob(){this.gYc&&
!this.lpa&&(this.lpa=new ca(new ba.a({["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.tRj.toString(),["AreThirdPartyAddInsAllowed"]:this.$.rT.toString(),["PopularAddinDetailsJsonString"]:Cc.xGd}),new kb.a(()=>this.Gl)));return this.lpa}get tRj(){return Fa.EwaSettings.sa(174)}get allowExternalMarketplace(){return this.$.ea.wg.get(27)}get gYc(){return x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get xGd(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","iconUrl":"https://store-images.s-microsoft.com/image/apps.45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","addinInfo":{"priority":1,"AUP":1156}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","iconUrl":"https://store-images.s-microsoft.com/image/apps.31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","addinInfo":{"priority":1,"AUP":17494}},{"displayName":"\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u65e5\u4ed8\u5165\u529b","solutionId":"wa104017332","iconUrl":"https://store-images.s-microsoft.com/image/apps.10311.0344d7d5-ce70-4f70-a74e-3ebeb3971854.94d2cf9c-6327-468e-a46e-70a3c37ecbfb.1b44e913-4613-4bfa-bdb7-c4ec1bdd53b3.png","addinInfo":{"priority":3,"AUP":1162}},{"displayName":"QR4Office","solutionId":"wa104051163","iconUrl":"https://store-images.s-microsoft.com/image/apps.53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","addinInfo":{"priority":1,"AUP":1220}},{"displayName":"Wikipedia","solutionId":"wa104099688","iconUrl":"https://store-images.s-microsoft.com/image/apps.7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","addinInfo":{"priority":2,"AUP":226}},{"displayName":"Solver","solutionId":"wa104100404","iconUrl":"https://store-images.s-microsoft.com/image/apps.37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","addinInfo":{"priority":1,"AUP":2955}},{"displayName":"People Graph","solutionId":"wa104104476","iconUrl":"https://store-images.s-microsoft.com/image/apps.49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","addinInfo":{"priority":1,"AUP":1046}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","iconUrl":"https://store-images.s-microsoft.com/image/apps.2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","addinInfo":{"priority":3,"AUP":7154}},{"displayName":"Stock Connector","solutionId":"wa104379220","iconUrl":"https://store-images.s-microsoft.com/image/apps.35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","addinInfo":{"priority":1,"AUP":1375}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","iconUrl":"https://store-images.s-microsoft.com/image/apps.53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","addinInfo":{"priority":1,"AUP":558}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","iconUrl":"https://store-images.s-microsoft.com/image/apps.2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","addinInfo":{"priority":2,"AUP":2278}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","iconUrl":"https://store-images.s-microsoft.com/image/apps.21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","addinInfo":{"priority":2,"AUP":525}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","iconUrl":"https://store-images.s-microsoft.com/image/apps.60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","addinInfo":{"priority":3,"AUP":489}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","iconUrl":"https://store-images.s-microsoft.com/image/apps.832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","addinInfo":{"priority":3,"AUP":1300}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","iconUrl":"https://store-images.s-microsoft.com/image/apps.7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","addinInfo":{"priority":3,"AUP":809}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","iconUrl":"https://store-images.s-microsoft.com/image/apps.6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","addinInfo":{"priority":3,"AUP":889}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","iconUrl":"https://store-images.s-microsoft.com/image/apps.24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","addinInfo":{"priority":2,"AUP":6761}},{"displayName":"FYI for Office","solutionId":"wa104381841","iconUrl":"https://store-images.s-microsoft.com/image/apps.55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","addinInfo":{"priority":3,"AUP":586}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","iconUrl":"https://store-images.s-microsoft.com/image/apps.10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","addinInfo":{"priority":1,"AUP":459}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","iconUrl":"https://store-images.s-microsoft.com/image/apps.28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","addinInfo":{"priority":1,"AUP":9262}},{"displayName":"Analytic Solver","solutionId":"wa200000018","iconUrl":"https://store-images.s-microsoft.com/image/apps.13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","addinInfo":{"priority":3,"AUP":1270}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","iconUrl":"https://store-images.s-microsoft.com/image/apps.14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","addinInfo":{"priority":1,"AUP":265}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","iconUrl":"https://store-images.s-microsoft.com/image/apps.22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","addinInfo":{"priority":3,"AUP":655}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","iconUrl":"https://store-images.s-microsoft.com/image/apps.56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","addinInfo":{"priority":2,"AUP":50071}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","iconUrl":"https://store-images.s-microsoft.com/image/apps.22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","addinInfo":{"priority":3,"AUP":517}},{"displayName":"Money in Excel","solutionId":"wa200001306","iconUrl":"https://store-images.s-microsoft.com/image/apps.9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","addinInfo":{"priority":3,"AUP":1217}},{"displayName":"McGraw Hill","solutionId":"wa200002270","iconUrl":"https://store-images.s-microsoft.com/image/apps.10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","addinInfo":{"priority":2,"AUP":90071}},{"displayName":"FRED Data","solutionId":"wa200003692","iconUrl":"https://store-images.s-microsoft.com/image/apps.51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","addinInfo":{"priority":1,"AUP":169}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","iconUrl":"https://store-images.s-microsoft.com/image/apps.42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","addinInfo":{"priority":3,"AUP":697}}]'}nR(Ka,
Ib){this.zob&&this.zob.nR(Ka,Ib)}Htc(Ka){this.zob&&this.zob.Ktc(Ka)}WSg(Ka,Ib){return L.a.Ni().equals(Ka.solutionId,Ib.solutionId)&&L.a.Ni().equals(Ka.storeType,Ib.storeType)}cda(Ka,Ib){if(x.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.TPf(Ka,Ib,OSF.StoreTypeEnum.MarketPlace);else{const dc={};dc.callbackFunc=Ka;dc.storeType=OSF.StoreTypeEnum.MarketPlace;dc.fromInsertDialog=!1;dc.refresh=Ib;this.Gl.queryEntitlementDetails(dc)}}TPf(Ka,Ib,dc){const yc=
{};yc.callbackFunc=Ka;yc.storeType=dc;yc.fromInsertDialog=!1;yc.refresh=Ib;this.Gl.queryEntitlementDetails(yc)}invokeDdaMethod(Ka,Ib){const dc=this.nn(Ka.DdaMethod.ControlId);dc?dc.invokeDdaMethod(Ka,Ib):this.zf(oa.a.internalError,Ib)}registerDdaEventAsync(Ka,Ib,dc,yc,Eb){(Ib=this.nn(Ib))?Cc.DAb(Ka)?Ib.Tej(Ka,dc,yc,Eb):this.zf(oa.a.bFd,Eb):this.zf(oa.a.internalError,Eb)}unregisterDdaEventAsync(Ka,Ib,dc,yc,Eb){(Ib=this.nn(Ib))?Cc.DAb(Ka)?Ib.QXj(Ka,dc,yc,Eb):this.zf(oa.a.bFd,Eb):this.zf(oa.a.internalError,
Eb)}dispose(){this.disposed||(this.$.pl(this.dd),this.ea.ik(this.Rc),this.ea.rR(this.xo),this.ea.yv(this.tf),this.jYc.detach(this),this.$.userOperationManager.zo(this.dR),this.Oqc=this.uf=this.Th=this.jYc=this.jb=null,this.$Ia&&(this.$Ia.dispose(),this.$Ia=null),ka.a.Ja(this.KOd),ka.a.Ja(this.JOd),this.B1a&&(this.B1a.dispose(),this.B1a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}Mfd(Ka){return(Ka=this.nn(Ka))?Ka.getDefaultIconUrl():null}Wxc(Ka){if(this.GJe!==
Ka){this.GJe=Ka;for(let Ib=0,dc=this.uf.length;Ib<dc;Ib++){const yc=this.uf[Ib];Ka?yc.dMe(!1):yc.Frh()}this.KOd.Wxc(Ka);this.JOd.Wxc(Ka)}}$Sh(Ka){return(Ka=this.nn(Ka))?Ka.getDefaultDisplayName():null}zf(Ka,Ib,dc=!0){const yc={};yc[Ja.a.Pf]=Ka;yc[Ja.a.g3]=Ib;this.QJ(451041795,yc,dc)}kv(Ka){const Ib={};Ib[Ja.a.g3]=Ka;this.QJ(1237877382,Ib)}QJ(Ka,Ib,dc=!0){const yc=new sb.a(Ka,0,this.$.xc,0,null),Eb=Ib?Ib[Ja.a.g3]:null;this.B1a&&ab.h(this.$).fb&&Wb.P6g(Ka,Ib)?this.B1a.wkh(Ka,Ib):(Ka=this.$.Ia.Hb(yc,
Ib),dc&&La.TaskExtensions.za(Ka,Ac=>{ce.a(Ac)?this.zf(oa.a.internalError,Eb,!1):Ac.result||(ab.h(this.$).fb?this.zf(oa.a.Rzb,Eb,!1):this.zf(oa.a.internalError,Eb,!1))},this.la,8))}p9g(Ka){return!!this.Pia(Ib=>Cc.getSolutionId(Ib.sl,this.$)===Cc.getSolutionId(Ka,this.$)&&Ib.sl.PrimaryMarketplace.MarketplaceType===Ka.PrimaryMarketplace.MarketplaceType&&Ib.sl.PrimaryMarketplace.MarketplaceRef===Ka.PrimaryMarketplace.MarketplaceRef&&Ib.sl.PrimaryMarketplace.SolutionVersion===Ka.PrimaryMarketplace.SolutionVersion)}nn(Ka){return this.Pia(Ib=>
Ib.controlId.startsWith(Ka))}mHh(Ka){return this.Pia(Ib=>Ib.vta===Ka)}GXe(Ka){return this.Pia(Ib=>Ib.RT===Ka&&!!Ib.vta)}VXe(Ka,Ib,dc,yc){return this.Pia(Eb=>Eb.RT===Ka&&Eb.sl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Ib.toLowerCase()&&Eb.sl.PrimaryMarketplace.MarketplaceType.toLowerCase()===dc.toLowerCase()&&!!Eb.sl.SharedRuntime&&!!Eb.sl.SharedRuntime.Resid&&!!yc&&!!yc.Resid&&Eb.sl.SharedRuntime.Resid.toLowerCase()===yc.Resid.toLowerCase())}GTg(Ka,Ib){if(Ka=this.nn(Ka))Ka.ka(Ib),Ka.showHide(!0)}xIj(Ka){(Ka=
this.nn(Ka))&&Ka.showHide(!1)}cIa(Ka){var Ib;if(1!==Ka.WebExtensionType||this.$.qd&8388608&&Ka.TaskpaneVisible||this.$.qd&8388608&&!Ka.TaskpaneVisible&&za.HelperMethods.lw(Ka)){let dc=null;za.HelperMethods.lw(Ka)&&(dc=Cc.Rua(Ka,this.$),Ka.TaskpaneWidth||(Ka.TaskpaneWidth=this.c7b));const yc=(new fa(this,this.Th,Ka)).Bnd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka.PrimaryMarketplace.SolutionId,Ka.OwnerAddinStoreType||
Ka.PrimaryMarketplace.MarketplaceType,null===(Ib=Ka.AssetMarketplace)||void 0===Ib?void 0:Ib.SolutionId,null,null,Ka.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ka.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${za.HelperMethods.lw(Ka)}`);dc&&(yc.vta=dc);this.uf.push(yc);this.oxa=null;this.n6a(Ka.InstanceId)||(Ka=String.format("{0}|{1}|{2}|{3}|{4}",Ka.PrimaryMarketplace.SolutionId,Ka.PrimaryMarketplace.SolutionVersion,Ka.PrimaryMarketplace.MarketplaceRef,Ka.PrimaryMarketplace.MarketplaceType,
Ka.WebExtensionType),this.raiseEvent("ci",Ka))}}cKj(Ka,Ib){Ka.TaskpaneWidth=this.c7b;Ka.TaskpaneVisible=!0;const dc={};dc.SolutionId=Ka.PrimaryMarketplace.SolutionId;dc.TargetType=Ka.WebExtensionType;dc.Version=Ka.PrimaryMarketplace.SolutionVersion;dc.StoreType=Ka.PrimaryMarketplace.MarketplaceType;dc.StoreId=Ka.PrimaryMarketplace.MarketplaceRef;Ka.AssetMarketplace?(dc.AssetId=Ka.AssetMarketplace.SolutionId,dc.AssetStoreId=Ka.AssetMarketplace.MarketplaceRef):(dc.AssetId=null,dc.AssetStoreId=null);
dc.Width=Ka.TaskpaneWidth;const yc=new fa(this,this.Th,Ka,!0);yc.Bnd();this.uf.push(yc);const Eb=()=>{this.zQa(yc.controlId);this.Ng.purgeOsfControl(yc.controlId,!1);Ib()};let Ac=null;Ac=fe.a.instance.wC(()=>{yc.ey&&(ka.a.Ja(Ac),Ac=null,this.Ng.insertBlankControlWithErrorUX(this.cIb(yc,dc),Eb))},100,ne.a.ljh)}mch(Ka){if(Ka&&Ka.length){var Ib=[];Ka.forEach(dc=>{if(dc.ContainsCustomFunctions){const yc=Cc.Rua(dc,this.$);this.gGd.contains(yc)||(this.gGd.add(yc),this.tMf.push(dc));this.p9g(dc)||Ib.push(dc)}});
Ib.length&&this.PGe(Ib)}}OIe(Ka,Ib){this.nn(Ka.InstanceId)||(Ib=Ib(),Ka=(new fa(this,this.Th,Ka)).lef(Ib),this.uf.push(Ka),this.oxa=null)}RHj(Ka){Cc.u1a.hb(Ka)&&Cc.u1a.ma(Ka).initializeAndShowWithTitle()}eci(Ka){Cc.u1a.hb(Ka)&&Cc.u1a.ma(Ka).hide()}YZh(Ka){var Ib=null;let dc,yc,Eb=null;dc=Cc.Ljd(Ka,!0);if(!dc)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Vb.Task.Ra(null);(yc=this.Gl.getOsfControl(Cc.getSolutionId(dc,this.$)))&&
(Ib=yc.getManifest())&&(Eb=Ib.getSharedRuntimeForCustomFunctions("Workbook"));if(Ib=Eb&&1===Eb.LifeTime?this.VXe(dc.PrimaryMarketplace.SolutionId,dc.PrimaryMarketplace.MarketplaceRef,dc.PrimaryMarketplace.MarketplaceType,Eb):this.mHh(Ka))return Vb.Task.Ra(Ib.controlId);const Ac=new mb.a;za.HelperMethods.$jc(Eb)&&(dc.SharedRuntime=Eb);Ka=yc?yc.getNotificationParams():[];if(!Ka.length)return this.sHe(dc);this.e9f(Ka,()=>{La.TaskExtensions.za(Ac.task,()=>{this.sHe(dc)},this.la,3)},()=>{});return Ac.task}UNh(Ka){Ka=
Cc.Ljd(Ka,!1);if(!Ka)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Ib=null;var dc=this.Gl.getOsfControl(Cc.getSolutionId(Ka,this.$));dc&&(dc=dc.getManifest())&&(Ib=dc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return za.HelperMethods.$jc(Ib)&&(Ka=this.VXe(Ka.PrimaryMarketplace.SolutionId,Ka.PrimaryMarketplace.MarketplaceRef,Ka.PrimaryMarketplace.MarketplaceType,Ib))?Ka.controlId:null}Gah(Ka,Ib){var dc=Cc.Ljd(Ka,!1);if(dc){var yc=
null,Eb=this.Gl.getOsfControl(Cc.getSolutionId(dc,this.$));Eb&&(Eb=Eb.getManifest())&&(yc=Eb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(za.HelperMethods.$jc(yc)){dc.SharedRuntime=yc;var Ac=dc.PrimaryMarketplace.SolutionId;Eb=dc.PrimaryMarketplace.SolutionVersion;var ld=OSF.OsfManifestManager.getCachedManifest(Ac,Eb);if(ld)if(this.Y_b.hb(Ka))yc=this.Y_b.ma(Ka),La.TaskExtensions.za(yc,he=>{(he=he.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(he,Ib,this.Th.BLb)},
this.la,3);else{var Vd={};Vd.solutionId=Ac;Vd.version=Eb;Vd.storeType=dc.PrimaryMarketplace.MarketplaceType;Vd.storeId=dc.PrimaryMarketplace.MarketplaceRef;dc.AssetMarketplace?(Vd.assetId=dc.AssetMarketplace.SolutionId,Vd.assetStoreId=dc.AssetMarketplace.MarketplaceRef):(Vd.assetId=null,Vd.assetStoreId=null);Vd.targetType=OSF.OsfControlTarget.TaskPane;var Od=new mb.a;dc=La.TaskExtensions.Tj();dc=new na.a(this.$,this,Vd,dc);yc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Ac,yc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ld,
yc,Eb);dc.createUILessSandbox(Vd,ld,(he,Ye)=>{he&&!Ye?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(he,Ib,this.Th.BLb),Od.setResult(he)):Od.setResult(null);this.Y_b.remove(Ka)});this.Y_b.ia(Ka,Od.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}GBe(Ka){(Ka=this.GXe(Ka))&&(Ka.sl.SharedRuntime||this.qJb(Ka.controlId))}qJb(Ka){(Ka=this.GXe(Ka))&&this.zQa(Ka.controlId)}moh(Ka,Ib){if(!this.uf||!Ka||!Ib)return!1;
if(Ka.toLowerCase()===Ib.toLowerCase())return!0;let dc=null,yc=null;for(let Eb=0,Ac=this.uf.length;Eb<Ac;Eb++){const ld=this.uf[Eb];if(ld.ownerAddinSolutionId&&(ld.controlId===Ka&&(dc=ld.ownerAddinSolutionId.toLowerCase()),ld.controlId===Ib&&(yc=ld.ownerAddinSolutionId.toLowerCase()),dc&&yc))break}return dc&&dc===yc?!0:!1}HJg(Ka){this.nn(Ka.InstanceId)||(Ka=new fa(this,this.Th,Ka),this.uf.push(Ka),this.oxa=null)}iVf(Ka){if(this.uf&&0<=Ka&&Ka<this.uf.length){const Ib=this.uf[Ka],dc=Ib.ey;this.uf.splice(Ka,
1);this.FBf(Ib);V.DOMElementExtensions.vf(dc)}}zQa(Ka){if(this.uf)for(let Ib=0,dc=this.uf.length;Ib<dc;Ib++)if(this.uf[Ib].controlId===Ka){this.iVf(Ib);break}}Yhj(Ka){if(this.uf){Ka=Ka.toLowerCase();for(let Ib=0,dc=this.uf.length;Ib<dc;Ib++)if(Ka===this.uf[Ib].ownerAddinSolutionId.toLowerCase()){this.iVf(Ib);break}}}kUg(Ka){Ka.Bi&&(this.nn(Ka.floatingObject.sl.InstanceId)||(this.Hgc(Ka.floatingObject.sl.InstanceId)||this.Oqc.push(Ka.floatingObject.sl.InstanceId),this.cIa(Ka.floatingObject.sl)),this.ea.isNamedObjectViewMode&&
this.GTg(Ka.floatingObject.sl.InstanceId,Ka.Hd))}yaa(Ka){if(this.uf)for(let Ib=0,dc=this.uf.length;Ib<dc;Ib++)if(1===this.uf[Ib].controlType&&Qe.a.equals(this.uf[Ib].RT,Ka,!0))return this.uf[Ib].controlId;return null}PGh(Ka){const Ib=[];if(this.uf)for(let dc=0,yc=this.uf.length;dc<yc;dc++)Qe.a.equals(this.uf[dc].RT,Ka,!0)&&Ib.push(this.uf[dc].controlId);return Ib}tHh(Ka,Ib){if(!Ib||!Ka)return null;if(this.uf)for(let dc=0,yc=this.uf.length;dc<yc;dc++)if(1===this.uf[dc].controlType&&Qe.a.equals(this.uf[dc].RT,
Ka,!0)&&this.uf[dc].sl.SharedRuntime&&Qe.a.equals(this.uf[dc].sl.SharedRuntime.Resid,Ib.Resid,!0))return this.uf[dc].controlId;return null}L3a(Ka,Ib=null){return Ka?Ib?`${Ka}.${Ib}`:Ka:""}JBe(Ka,Ib,dc){if(this.oxa===Ka)return!0;this.oxa=Ka;let yc=null,Eb=!1;if(!yc&&this.uf)for(let Ac=0,ld=this.uf.length;Ac<ld;Ac++)if(1===this.uf[Ac].controlType&&Qe.a.equals(this.uf[Ac].RT,Ka,!0)){let Vd=!1,Od=!1;Ib?(Vd=!0,Od=!!this.uf[Ac].sl.SharedRuntime&&Qe.a.equals(this.uf[Ac].sl.SharedRuntime.Resid,Ib.Resid,!0)):
dc&&(Vd=!0,Od=Qe.a.equals(this.uf[Ac].sl.SharedRuntimeId,dc,!0));if(!Vd||Od){Od&&this.uf[Ac].Kg(!0);yc=this.uf[Ac].controlId;Eb=!0;this.oxa=null;break}}yc&&this.raiseEvent("ca",yc);return Eb}setAppRuntimeState(Ka,Ib){var dc;if(Ka){const yc=this.nn(Ka);if(yc&&za.HelperMethods.lw(yc.sl))yc.Kg(Ib),Ib&&(this.raiseEvent("ca",Ka),(null===(dc=yc.ey)||void 0===dc?0:dc.firstChild)&&(Ka=yc.ey.firstChild.title)&&0<Ka.length&&this.a1b.hvj(Ka));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(Ze.a.instance.ga(2247));}else throw e.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ze.a.instance.ga(2248));}getAppRuntimeState(Ka){if(Ka)if((Ka=this.nn(Ka))&&za.HelperMethods.lw(Ka.sl))Ka=Ka.sl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ze.a.instance.ga(2247));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ze.a.instance.ga(2248));return Ka}h3a(Ka,Ib){return(Ka=this.nn(Ka))?Ka.h3a(Ib):null}n6a(Ka){return this.LBe(this.Oqc,Ka)}Hgc(Ka){return this.LBe(this.AJe,Ka)}voe(Ka){this.AJe.push(Ka)}cZ(Ka){return(Ka=this.nn(Ka))?Ka.sl:null}hBd(Ka){this.raiseEvent("ekros",Ka,this)}GEd(Ka){if(Ka){var Ib=this.nn(Ka.InstanceId);Ib&&(Ka.SharedRuntime||Ka.SharedRuntimeId||(this.zQa(Ib.controlId),this.Ng.purgeOsfControl(Ib.controlId,!1)),Ib={},Ib.SolutionId=Ka.PrimaryMarketplace.SolutionId,Ib.TargetType=
Ka.WebExtensionType,Ib.Version=Ka.PrimaryMarketplace.SolutionVersion,Ib.StoreType=Ka.PrimaryMarketplace.MarketplaceType,Ib.StoreId=Ka.PrimaryMarketplace.MarketplaceRef,Ka.AssetMarketplace?(Ib.AssetId=Ka.AssetMarketplace.SolutionId,Ib.AssetStoreId=Ka.AssetMarketplace.MarketplaceRef):(Ib.AssetId=null,Ib.AssetStoreId=null),Ib.Width=Ka.TaskpaneWidth,Ib.SharedRuntimeId=Ka.SharedRuntimeId,this.dgg(Ib))}}via(){this.Th.via()}wM(Ka,Ib,dc){this.Th.wM(Ka,Ib,dc)}fYe(Ka,Ib){Ib=Cc.Xfh(Ib);Ka=this.cZ(Ka);this.Th.aac(Ka.InstanceId,
2202,tb.a.sW,Ib)}Ecd(Ka){for(let Ib=0,dc=this.uf.length;Ib<dc;Ib++)this.fYe(this.uf[Ib].controlId,Ka)}EHh(Ka,Ib){Ib=Cc.lbh(Ib);this.Th.aac(Ka,65539,"",Ib)}HHh(Ka,Ib,dc){this.Th.aac(Ka,1,Ib,dc)}DHh(Ka,Ib){this.Th.IHh(Ka,Ib)}Dah(Ka,Ib){return[[2,1E3,"",JSON.stringify([Ka,Ib]),0,!1]]}Lli(){return!!this.ena&&this.ena.saf()}w4g(){this.ena&&this.ena.clear()}FHh(){if(this.ena&&this.ena.saf()){var Ka=this.ena.XNh();for(const Ib of Ka){Ka=this.PGh(Ib);for(const dc of Ka)this.Th.aac(dc,65540,"","{}")}}}Mej(Ka){this.ena.add(Ka)}NXj(Ka){this.ena.remove(Ka)}Pia(Ka){if(!this.uf)return null;
for(const Ib of this.uf)if(Ka(Ib))return Ib;return null}sHe(Ka){const Ib=new mb.a,dc=Cc.Rua(Ka,this.$);if(za.HelperMethods.lw(Ka))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.qMf(Ka,yc=>{yc?(Ka.InstanceId=yc.InstanceId,Ka.WebExtensionOsfControlType=3,Ka.TaskpaneVisible=!1,this.cIa(Ka),Ib.setResult(Ka.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka.PrimaryMarketplace.SolutionId,
Ka.PrimaryMarketplace.MarketplaceType,null,null,null,Ka.PrimaryMarketplace.MarketplaceRef)} failed`),Ib.setException(Error.create("Null insert data")))});else{Cc.u1a.ia(Ka.InstanceId,new Ha.a);const yc=Cc.u1a.ma(Ka.InstanceId).V$;this.lch(Ka,yc,dc);this.qMf(Ka,null);Ib.setResult(Ka.InstanceId)}return Ib.task}lch(Ka,Ib,dc){this.nn(Ka.InstanceId)||(Ka=new fa(this,this.Th,Ka),Ka.vta=dc,Ka.lef(Ib),this.uf.push(Ka),this.oxa=null)}qMf(Ka,Ib){const dc=Cc.Rua(Ka,this.$);if(!this.gGd.contains(dc))this.CHb.push(Ka),
1<=this.CHb.length&&this.rMf(Ka,Ib);else if(Ib)for(const yc of this.tMf)if(Cc.Rua(yc,this.$)===dc){Ib(yc,0);break}}rMf(Ka,Ib){let dc=null;const yc={};yc.SolutionId=Cc.getSolutionId(Ka,this.$);yc.TargetType=Ka.WebExtensionType;yc.Version=Ka.PrimaryMarketplace.SolutionVersion;yc.StoreType=Ka.PrimaryMarketplace.MarketplaceType;yc.StoreId=Ka.PrimaryMarketplace.MarketplaceRef;Ka.AssetMarketplace?(yc.AssetId=Ka.AssetMarketplace.SolutionId,yc.AssetStoreId=Ka.AssetMarketplace.MarketplaceRef):(yc.AssetId=
null,yc.AssetStoreId=null);yc.Width=Ka.TaskpaneWidth;yc.ContainsCustomFunctions=!0;za.HelperMethods.lw(Ka)&&(yc.SharedRuntimeId=Ka.SharedRuntime.Resid);const Eb=this.$.oa.xa;Ka=this.$.oa.xa.Wb();const Ac=Eb.Na(9,Ka);Ac.sharedInfo=yc;const ld=Od=>{Od=Fd.a.Pe(Od.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${qf.a.nc(Od)}`)},Vd=Od=>{Od&&!Ve.a(Od)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(yc.SolutionId,
yc.StoreType,yc.AssetId,null,null,yc.StoreId)} finish with errors: ${qf.a.nc(Od.Errors)}`);this.CHb.shift();0<this.CHb.length&&this.rMf(this.CHb[0],Ib)};if(Ib){const Od=he=>{const Ye=he.Result;(dc=Ye?Ye.AgaveData:null)||Ib(null,he.Errors?he.Errors[0].ErrorCause:5001);Ib(dc,0)};Ka=(he,Ye,se)=>Ke.g(Eb,"InsertAgaveTaskpane",Ac,Re.b(he,Vd,Od),Re.a(Ye,ld),se,null,0)}else Ka=(Od,he,Ye)=>Ke.g(Eb,"InsertAgaveTaskpane",Ac,Re.b(Od,Vd),Re.a(he,ld),Ye,null,0);Yd.a(this.$.userOperationManager,Ka,Od=>new je.a(519,
0,Od,64),null)}QEj(){return this.$.Xd.get(35)}BLd(Ka){Ka=this.nn(Ka);(null===Ka||void 0===Ka?0:Ka.Dda)&&Ka.sVf()}uLi(Ka){var Ib=this.Pia(dc=>Cc.mMa(dc.RT));Ib&&(Ib=this.Ng.getOsfControl(Ib.controlId))&&Ib.notifyAgave(OSF.AgaveHostAction.SendMessage,Ka)}zmi(){return!!this.Pia(Ka=>1===Ka.controlType&&Cc.mMa(Ka.RT))}ymi(){const Ka=this.Pia(Ib=>Cc.mMa(Ib.RT));return Ka?Ka.ey?V.DOMElementExtensions.isVisible(Ka.ey):!1:!1}pyj(){const Ka=this.Pia(Ib=>Cc.mMa(Ib.RT));Ka&&(Ka.Kg(!0),this.raiseEvent("ca",Ka.controlId))}initialize(){const {DdaEventDispatch:Ka}=
a(1390),Ib=void 0===this.$||null===this.$||Fa.EwaSettings.sa(234);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ib&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||($c.DGa(this.$),this.ea=this.$.ea,this.Th=new Ka(this.$),this.$.Lk(this.dd),this.ea.Jj(this.Rc),this.ea.ML(this.xo),this.ea.$t(this.tf),this.$.userOperationManager.Lr(this.dR),this.Cqf(),
this.RVi(),this.Igi(),this.$.da.Ha(35,this),this.jYc.ka(this),Ib&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.sie=new tb.a,Ib&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.vie=new Ta(this.$,this.Ui,this.Th),new ec(this.$,this.Ui,this.Th),this.tie=new wc(this.$,this.Ui,this.Th),this.rie=new Fc(this.$,this.Ui,this.Th),this.qie=new xa(this.$,this.Ui,this.Th),this.uie=new fd(this.$,this.Ui,this.Th),this.wie=
new Qd(this.$,this.Ui,this.Th),this.xie=new fc(this.$,this.Ui,this.Th),this.$.FQ&&(this.yie=new nd(this.$,this.Ui,this.Th)),Fa.EwaSettings.sa(178)&&(this.B1a=new Wb(this,ab.h(this.$))),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.oie=new eb),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}zHh(Ka){if(!this.kCa)return null;for(let Ib=0,dc=this.kCa.length;Ib<dc;Ib++)if(Ka.startsWith(this.kCa[Ib].WebExtensionId))return this.kCa[Ib];
return null}Cqf(){var Ka,Ib=this.ea;if(Ib.Xb&&!this.VQb){if(Ib.workbookContext){if(this.aVc=this.$.ea.wg.get(22),null===(Ka=Ib.workbookContext.WebExtensions)||void 0===Ka?0:Ka.length){Ka=Ib.workbookContext.WebExtensions;Ib=!1;for(let dc=Ka.length-1;0<=dc;dc--){if(!this.ea.isNamedObjectViewMode){this.Oqc.push(Ka[dc].InstanceId);if(1!==Ka[dc].WebExtensionType){Ka.splice(dc,1);continue}if(za.HelperMethods.lw(Ka[dc])&&0!==Ka[dc].SharedRuntime.State)1===Ka[dc].SharedRuntime.State?Ka[dc].TaskpaneVisible=
!1:2===Ka[dc].SharedRuntime.State?Ka[dc].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Ka[dc].ContainsCustomFunctions&&!Ka[dc].TaskpaneVisible&&!ja.a(Ka[dc])){Ka.splice(dc,1);continue}}const yc=OSF.OsfControl.isFirstPartyStoreString(Ka[dc].PrimaryMarketplace.MarketplaceType);if(Fa.EwaSettings.sa(174)&&!yc&&(Ka.splice(dc,1),!Ib)){Ib=!0;const Eb=vb.GetServiceTaskFactory.Oa(this.$.da,5,4,3);La.TaskExtensions.za(Eb,()=>{Eb.result.ih(36,null)},this.la,
3)}Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Ka[dc].PrimaryMarketplace&&Cc.mMa(Ka[dc].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Ka.splice(dc,1))}this.PGe(Ka)}}else this.aVc=!1;this.VQb=!0}}Q9e(Ka){const Ib=ab.h(this.$),dc=Ib.ha.Sa.dc;if(dc&&Ka){Ka=!1;if(this.uf)for(const yc of this.uf)if(Cc.mMa(yc.RT)||Cc.Mpi(yc.RT)){Ka=!0;break}Ka||Ib.ha.Sa.OG(dc)}}RVi(){this.Ng&&
this.ea.isNamedObjectViewMode&&this.$.na&&Ob.o(this.$.na)&&(this.$.da.Aa(34).AQ?this.$.da.Aa(34).Pnd():this.$.da.Aa(34).Uu(this.Q0i))}PGe(Ka){let Ib=null;Ib=dc=>{const yc=dc.WebExtensionData,Eb=dc.IsTaskPane,Ac=dc.RecordHandler,ld=()=>{this.DPa.shift();0<this.DPa.length&&Ib(this.DPa[0])};if(this.yaa(yc.PrimaryMarketplace.SolutionId))ld();else{Eb&&(yc.WebExtensionOsfControlType=1);var Vd=ja.a(yc);if(!Eb||yc.TaskpaneVisible||Vd||yc.SharedRuntime&&0!==yc.SharedRuntime.State||yc.ContainsCustomFunctions){var Od=
new fa(this,this.Th,yc,!Eb);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(yc.PrimaryMarketplace.SolutionId,yc.PrimaryMarketplace.MarketplaceType,null,null,null,yc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${yc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${za.HelperMethods.lw(yc)}`);Od.Bnd();za.HelperMethods.lw(yc)&&(Od.vta=Cc.Rua(yc,this.$),yc.TaskpaneWidth=this.c7b);Vd&&(yc.WebExtensionToolTip="");Eb&&
yc.TaskpaneVisible&&!Vd&&(yc.TaskpaneWidth=this.c7b);this.uf.push(Od);var he=this.oxa=null;he=fe.a.instance.wC(()=>{Od.ey&&(ka.a.Ja(he),he=null,Ac&&Ac(dc,Od),ld())},100,ne.a.kjh)}else ld()}};for(let dc=0;dc<Ka.length;dc++)if(!this.nn(Ka[dc].InstanceId))if(1!==Ka[dc].WebExtensionType)this.cIa(Ka[dc]);else if(!Fa.EwaSettings.sa(52))this.rnb(Ka[dc],Ib);else if(this.$.qd&8388608||Ka[dc].TaskpaneVisible){const yc={};yc.solutionId=Ka[dc].PrimaryMarketplace.SolutionId;yc.version=Ka[dc].PrimaryMarketplace.SolutionVersion;
yc.storeType=Ka[dc].PrimaryMarketplace.MarketplaceType;yc.storeId=Ka[dc].PrimaryMarketplace.MarketplaceRef;yc.targetData=Ka[dc];this.Ng.isAddinCommandsAsync(yc,(Eb,Ac,ld)=>{if(Eb){var Vd=ld.targetData;if(Ac){if(Fa.EwaSettings.sa(86))if(yc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Eb=yc.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Ac=yc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Eb||Ac)&&za.HelperMethods.lw(Vd)&&this.rnb(Vd,
Ib);else if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.X9h(ld,Ib);else{let Od=!1;this.cda(he=>{if(!he.errorCode){if(he.value)for(const Ye of he.value){if(Od)break;Od=Qc.e(Ye[1])===Qc.e(Vd.PrimaryMarketplace.SolutionId)}Od?za.HelperMethods.lw(Vd)&&this.rnb(Vd,Ib):(he={},he.SolutionId=ld.solutionId,he.Version=ld.version,he.StoreType=Vd.PrimaryMarketplace.MarketplaceType,he.StoreId=ld.storeId,he.AssetId=null,he.AssetStoreId=null,he.Width=
Vd.TaskpaneWidth,he.TargetType=Vd.WebExtensionType,Vd.TaskpaneVisible=!0,this.ine(he,Vd,Ib))}},!0)}}else this.rnb(Vd,Ib)}else Eb=ld.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Eb.PrimaryMarketplace.SolutionId,Eb.PrimaryMarketplace.MarketplaceType,null,null,null,Eb.PrimaryMarketplace.MarketplaceRef)} from ${Eb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}X9h(Ka,Ib){let dc=!1;this.cda(yc=>{const Eb=
Ka.targetData;if(!yc.errorCode){if(yc.value)for(const Ac of yc.value){if(dc)break;dc=Qc.e(Ac[1])===Qc.e(Eb.PrimaryMarketplace.SolutionId)}dc?za.HelperMethods.lw(Eb)&&this.rnb(Eb,Ib):(yc={},yc.SolutionId=Ka.solutionId,yc.Version=Ka.version,yc.StoreType=Eb.PrimaryMarketplace.MarketplaceType,yc.StoreId=Ka.storeId,yc.AssetId=null,yc.AssetStoreId=null,yc.TargetType=Eb.WebExtensionType,yc.Width=Eb.TaskpaneWidth,Eb.TaskpaneVisible=!0,this.ine(yc,Eb,Ib))}},!0)}rnb(Ka,Ib){const dc={};dc.WebExtensionData=Ka;
dc.IsTaskPane=!0;this.DPa.push(dc);1===this.DPa.length&&Ib(dc)}ine(Ka,Ib,dc){const yc={};yc.ActivationInfo=Ka;yc.WebExtensionData=Ib;yc.IsTaskPane=!1;yc.RecordHandler=(Eb,Ac)=>{const ld=Eb.ActivationInfo;this.Ng.insertBlankControlWithErrorUX(this.cIb(Ac,ld),()=>{this.zQa(Ac.controlId);this.Ng.purgeOsfControl(Ac.controlId,!1);this.dgg(ld)})};this.DPa.push(yc);1===this.DPa.length&&dc(yc)}dgg(Ka){var Ib={};Ib.solutionId=Ka.SolutionId;Ib.version=Ka.Version;Ib.storeType=Ka.StoreType;Ib.storeId=Ka.StoreId;
Ib.assetId=Ka.AssetId;Ib.assetStoreId=Ka.AssetStoreId;Ib.targetType=Ka.TargetType;Ib.sharedRuntimeId=Ka.SharedRuntimeId;Ka=new N.a;Ka.add(Ib);Ib={};Ib[Z.a.vob]=Ka;Ib[Z.a.OL]=3;Ka=new sb.a(hc.a.ZCb,0,this.$.xc,0,null);this.$.Ia.Hb(Ka,Ib)}cIb(Ka,Ib){const dc={};dc.div=Ka.ey;dc.id=Ka.controlId;dc.solutionId=Ib.SolutionId;dc.version=Ib.Version;dc.storeId=Ib.StoreId;dc.storeType=Ib.StoreType;dc.osfControlType=OSF.OsfControlTarget.TaskPane;return dc}lZf(){if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const dc=
[];for(var Ka=0;Ka<this.uf.length;Ka++){var Ib=this.uf[Ka];0!==Ib.osfControlType&&3!==Ib.osfControlType&&4!==Ib.osfControlType||dc.push(Ib)}Ka=!1;for(Ib=0;Ib<dc.length;Ib++){const yc=dc[Ib];this.zQa(yc.controlId);!Ka&&yc&&yc.sl&&(Ka=za.HelperMethods.lw(yc.sl))}Ka&&this.QJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Fa.EwaSettings.sa(355)&&La.TaskExtensions.za(vb.GetServiceTaskFactory.Oa(this.$.da,278,279,3),dc=>{dc&&(dc=dc.result)&&(this.$.da.Aa(278)||this.$.da.Ha(278,dc),dc.sff().ina())},
this.la,3)}JK(){var Ka=new wd(this.$,this.Ui,this.n_f);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Fa.EwaSettings.sa(234)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Ui||null===this.Ui));if(Ka.kKi()){const Ib=()=>{},dc=Eb=>{Eb=Fd.a.Pe(Eb.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${qf.a.nc(Eb)}.`)},
yc=Ka.XYg();Ka=Cc.Ghd(yc);Ka|=64;this.$.userOperationManager.FE(new je.a(507,0,(Eb,Ac,ld)=>Ke.g(this.$.oa.xa,"ExecuteRichApiRequest",this.YYg(yc),Re.b(Eb,Ib),Re.a(Ac,dc),ld,null,0),Ka))}}YYg(Ka){const Ib=this.$.oa.xa.Na(1);Ib.request=Ka;return Ib}LBe(Ka,Ib){if(Ka)for(let dc=0;dc<Ka.length;dc++)if(Qe.a.equals(Ka[dc],Ib,!0))return!0;return!1}ZXg(Ka){const Ib={};Ib.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ib.assetId=null;Ib.category=null;if(!Ka||3>Ka.length)return Ib;if(Ka[0]){const dc=parseInt(Ka[0],
10);isNaN(parseInt(dc,10))||(Ib.navigationMode=dc)}Ka[1]&&(Ib.assetId=Ka[1]);Ka[2]&&(Ib.category=Ka[2]);return Ib}Igi(){if(Fa.EwaSettings.sa(60)){var Ka=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Ka&&"*"!==Ka.trim()){this.$Ia=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Ma(this),Ka,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Xd.get(2));try{this.$Ia.init()}catch(Ib){try{this.$Ia.dispose()}catch(dc){}this.$Ia=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Ib.message)}Ka={};Ka.a=this.$.ya.UserSessionId;Xb.b().Te(39,Ka)}}}e9f(Ka,Ib,dc){const yc=Cc.lXg(Ka[0]),Eb=yc.jha,Ac=yc.kia;yc.jha=()=>{Eb&&Eb();const ld=yc.QLa!==OSF.InfoType.Error?Ib:null;Ka.shift();Ka.length?this.e9f(Ka,ld,dc):ld&&ld()};yc.kia=()=>{Ac&&Ac();dc&&yc.QLa!==OSF.InfoType.Error&&dc()};Sa.a.pUd(yc)}CWh(){const Ka={};Ka.AddinRibbonControlsOverriddenByApi=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
Ka.AddinActionDefinitionHybridMode=Fa.EwaSettings.sa(556).toString();Ka.UseActionIdForUILessCommand=Fa.EwaSettings.sa(559).toString();Ka.AllowStorageAccessByUserActivationOnIFrame=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Ka.RequirementSetRibbonApiOnePointTwo=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Ka.flightingTreatmentVariables=x.AFrameworkApplication.fa.hac;
Ka.ShortcutInfoArrayInUserPreferenceData=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return Ka}static get b5b(){return Cc.$6d}static set b5b(Ka){Cc.$6d=Ka}static getSolutionId(Ka){let Ib=Ka.PrimaryMarketplace.SolutionId;Fa.EwaSettings.sa(261)&&Ka.OwnerAddinSolutionId&&(Ib=Ka.OwnerAddinSolutionId);return Ib}static Ghd(Ka){let Ib=0;Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Ka.RequestFlags&1&&256!==
(Ka.RequestFlags&256)||(Ib=16):Ib=Ka.RequestFlags&1?0:16;return Ib}static Rua(Ka,Ib){Ib=Cc.getSolutionId(Ka,Ib);return Cc.V1e(Ib,Ka.PrimaryMarketplace.SolutionVersion,Ka.PrimaryMarketplace.MarketplaceType,Ka.PrimaryMarketplace.MarketplaceRef)}static Xfh(Ka){return JSON.stringify({["recording"]:Ka})}static lbh(Ka){const Ib={};Ib.visibility=Ka?"Visible":"Hidden";return JSON.stringify(Ib)}static FSh(Ka){let Ib=Ka.getSolutionId(),dc=Ka.getVersion(),yc=Ka.getStoreType();Ka=Ka.getStoreId();return Cc.V1e(Ib,
dc,yc,Ka)}static V1e(Ka,Ib,dc,yc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Ka,Ib,Cc.Q3h(dc).toString(),yc)}static Ljd(Ka,Ib){var dc=Ka.split("|");if(7>dc.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==dc[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${dc[0]}'.`),null;let yc=dc[1];const Eb=dc[2],Ac=Cc.R3h(dc[3]),ld=dc[4];dc=
dc[5];yc&&yc.length||(yc=dc);dc={};dc.InstanceId=String.format("{{{0}}}",S.a.create().toString());dc.WebExtensionOsfControlType=4;dc.WebExtensionType=1;dc.PrimaryMarketplace={};dc.PrimaryMarketplace.SolutionId=yc;dc.PrimaryMarketplace.SolutionVersion=Eb;dc.PrimaryMarketplace.MarketplaceRef=ld;dc.PrimaryMarketplace.MarketplaceType=Ac;dc.ContainsCustomFunctions=Ib?!0:!1;Ib&&(dc.OsfPropertyBag=[["customFunctionAddinId",Ka]]);return dc}static R3h(Ka){Ka=parseInt(Ka,10);return Ka===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:Ka===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Ka===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Ka===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Ka===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Ka===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Ka===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Ka===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Ka===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Ka===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Ka===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static Q3h(Ka){return Ka===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Ka===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Ka===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Ka===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Ka===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Ka===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Ka===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Ka===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Ka===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Ka===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Ka===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static ita(Ka){const Ib={};Ib.Version=Ka.version;Ib.AssetId=Ka.assetId;Ib.AssetStoreId=Ka.assetStoreId;Ib.StoreType=Ka.storeType;Ib.Height=Ka.height;Ib.SolutionId=Ka.solutionId;Ib.StoreId=Ka.storeId;Ib.TargetType=Ka.targetType;
Ib.Width=1===Ib.TargetType?0:Ka.width;Ib.SharedRuntimeId=Ka.sharedRuntimeId;return Ib}static DAb(Ka){return Ka===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ka===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Ka===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ka===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ka===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Ka===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Ka===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||
Ka===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static lXg(Ka){return Object(b.a)(new Kb.a,{QLa:Ka.infoType,id:Ka.id,title:Ka.title,description:Ka.description,buttonText:Ka.buttonTxt,jha:Ka.buttonCallback,cfc:Ka.highPriority,kia:Ka.dismissCallback,errorCode:Ka.errorCode,ydf:Ka.iframeNotificationUrl})}static mMa(Ka){let Ib="FA000000014"===Ka;Ib||(Ib="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Ka);return Ib}static Mpi(Ka){return"FA000000005"===Ka}}Cc.u1a=new G.a;Cc.$6d=!0;Object(c.a)(Cc,
"DdaFacade",W.a,[200,584,524,585,586,2])},753:function(t,F,a){a.d(F,"a",function(){return e});t=a(0);var c=a(15),b=a(111);class e{constructor(){this.XKd=0;this.gW={};this.Xsa={}}c_h(f,d){return this.gW[e.U_c(f,d)]}pPe(f,d){d||void 0!==this.Xsa[f]&&null!==this.Xsa[f]?d&&void 0!==this.Xsa[f]&&null!==this.Xsa[f]&&delete this.Xsa[f]:this.Xsa[f]=1}U0b(f){return void 0===this.Xsa[f]||null===this.Xsa[f]}V8h(f){const d=e.U_c(f.messageType,f.targetId);1===f.actionType?this.z$h(f.controlId,f.messageType,d):
2===f.actionType&&this.lai(f.controlId,f.messageType,d)}Bhj(f){if(f){var d=Object.keys(this.gW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.gW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.gW[h])}}MZ(f,d){f=e.U_c(f,d);f=this.gW[f];return!!f&&0<Object.keys(f).length}hbi(){return!b.a.isEmpty(this.gW)}Mmf(){return 0<this.XKd}qUh(){const f=[],d=this.gW;for(let l in d){var h=l,m=d[l];for(let v in m){m=v;const r={};r.eventType=parseInt(h.split("#")[0],10);r.targetId=h.split("#")[1];
r.addinId=m;f.push(r)}}return f}z$h(f,d,h){if(this.gW[h])h=this.gW[h],h[f]=h[f]?h[f]+1:1;else{let m={};m[f]=1;this.gW[h]=m}100===d&&this.XKd++}lai(f,d,h){if(this.gW[h]){const m=this.gW[h];if(f){const l=m[f];1===l?(delete m[f],Object.keys(m).length||delete this.gW[h]):m[f]=l-1;100===d&&this.XKd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static U_c(f,
d){return String.format("{0}#{1}",f,d)}}e.sW="Workbook";Object(t.a)(e,"RichApiEventRegistration",null,[])},776:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(t.a)(c,"DdaEventArgs",null,[])},827:function(t,F,a){t=a(0);class c{constructor(){this.title=
this.id=this.tabs=null}}Object(t.a)(c,"AddInDataTransferObject",null,[]);a.d(F,"a",function(){return b});class b{constructor(e,f,d){this.sRb=e;this.csg=f;this.dsg=d}get Ks(){return this.sRb}get eJg(){return this.csg}get fJg(){return this.dsg}static I3a(e){return(e=e.EV)?Object.assign(new c,{tabs:e.Ks.toArray(),id:e.eJg,title:e.fJg}):null}}Object(t.a)(b,"OneLineRibbonExtensibility",null,[])},831:function(t,F,a){a.d(F,"a",function(){return c});a.d(F,"b",function(){return b});const c=e=>{let f=null;
switch(e){case 0:f="omex";break;case 1:f="spcatalog";break;case 2:f="spapp";break;case 3:f="filesystem";break;case 4:f="exchange";break;case 6:f="registry";break;case 7:f="inmemory";break;case 8:f="uploadfiledevcatalog";break;case 9:f="hardcodedpreinstall";break;case 10:f="excatalog";break;case 16:f="wopicatalog"}return f},b=e=>{let f=-1;switch(e.toLowerCase()){case "omex":f=0;break;case "spcatalog":f=1;break;case "spapp":f=2;break;case "filesystem":f=3;break;case "exchange":f=4;break;case "registry":f=
6;break;case "inmemory":f=7;break;case "uploadfiledevcatalog":f=8;break;case "hardcodedpreinstall":f=9;break;case "excatalog":f=10;break;case "wopicatalog":f=16}return f}},865:function(t,F,a){a.r(F);t=a(0);var c=a(191),b=a(15),e=a(100);class f{constructor(){this.startTime=0;this.callback=null}}Object(t.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(t.a)(d,"AccessTokenInformation",null,[150]);var h=a(981);class m{constructor(){this.token=null;this.expiresOn=0;this.Zga=
this.authChallenge=null}}Object(t.a)(m,"CachedTokenInfo",null,[]);class l{constructor(){this.WRb=new c.a;this.J9=this.I9=!1;this.soa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Yre=null}get callbacks(){return this.WRb}}Object(t.a)(l,"SSORequestInfo",null,[]);class v extends l{constructor(){super();this.errorCode=0}}Object(t.a)(v,"SSOFailedRequestInfo",l,[]);var r=a(4);class A{constructor(I,R,S,G){this.NS=new c.a;this.kG=new c.a;this.xpa=null;this.Mlb=new c.a;this.Xce=Promise.resolve(null);
this.dke=!1;this.XWb=R;this.Pug=I;this.Hke=S;this.hsg=G}TFj(I){if(this.xpa&&this.xpa.authChallenge===I.authChallenge){if(Date.now()/1E3+A.LGi>this.xpa.expiresOn)return this.xpa=null,!1;I=new h.a;I.token=this.xpa.token;I.expiresOn=this.xpa.expiresOn;I.Zga=this.xpa.Zga;I.ITa=!0;I.Txb=0;this.kyb(I);return!0}return!1}uEj(I){for(let R=0;R<this.kG.count;R++)if(this.kG.ma(R).authChallenge===I.authChallenge&&this.kG.ma(R).soa===I.soa){let S;(S=this.kG.ma(R)).retryCount=S.retryCount+1;I.retryCount=this.kG.ma(R).retryCount;
if(this.kG.ma(R).retryCount<A.jHi||!this.kG.ma(R).I9&&I.I9||!this.kG.ma(R).J9&&I.J9){if(!this.kG.ma(R).I9&&I.I9||!this.kG.ma(R).J9&&I.J9)I.retryCount=0;this.kG.removeAt(R);break}I=new h.a;I.errorCode=this.kG.ma(R).errorCode;this.kyb(I);return!0}return!1}TKg(I,R){for(let S=0;S<this.kG.count;S++)if(this.kG.ma(S).soa===I.soa&&this.kG.ma(S).authChallenge===I.authChallenge)return;this.kG.add(Object.assign(new v,{I9:I.I9,J9:I.J9,authChallenge:I.authChallenge,soa:I.soa,errorCode:R,retryCount:I.retryCount}))}get resource(){return this.XWb}Eed(I,
R,S,G,D,E){const {AppsForOfficeSingleSignOnManager:M}=a(865);""===S&&(S=null);if(this.dke)M.s5(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var L=null;for(let N of this.NS)if(N.I9===I&&N.J9===R&&N.authChallenge===S&&N.soa===D){L=N;break}L||(L=Object.assign(new l,{I9:I,J9:R,authChallenge:S,Yre:G,soa:D,retryCount:0,startTime:M.gw()}),this.NS.add(L));L.retryCount=0;L.callbacks.add(E);this.Xce=this.Xce.then(()=>{var {AppsForOfficeSingleSignOnManager:N}=a(865);if(0<this.NS.count){var Y=
this.NS.ma(0);if(this.TFj(Y)||this.uEj(Y))return null;for(let P=0;P<this.Mlb.count;)this.Mlb.ma(P)+A.zRj<N.gw()?this.Mlb.removeAt(P):P++;if(this.Mlb.count>=A.fHi||this.NS.count>=A.HGi)return Y=new h.a,Y.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.kyb(Y),null;let U=null;r.AFrameworkApplication.ra&&(N=r.AFrameworkApplication.ra.ED)&&(U=N.Gc("ComponentAttach",this.Pug+A.tEg));return Y.soa.YGg(this.resource,Y.I9,Y.J9,Y.authChallenge,this.hsg,Y.Yre).then(P=>{U&&U.stop();this.kyb(P)},
()=>{U&&U.stop();const P=new h.a;P.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.kyb(P)})}return null})}}kyb(I){const {AppsForOfficeSingleSignOnManager:R}=a(865);try{if(this.NS.count){var S=this.NS.ma(0);this.NS.removeAt(0);var G=null;I.errorCode||(G=new d,G.accessToken=I.token);I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&
I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.TKg(S,I.errorCode);var D={};null!=I.Txb&&(D.getTokenSilentTime=I.Txb.toString());null!=I.qjd&&(D.getTokenPopupTime=I.qjd.toString());null!=I.Vgd&&(D.getIDTokenTime=I.Vgd.toString());null!=I.ITa&&(D.tokenCached=I.ITa.toString());I.dYd&&(D.detailedError=I.dYd);I.Zga&&(D.authLibrary=I.Zga);S.retryCount&&(D.retryCount=S.retryCount);for(var E of S.callbacks)R.s5(E,I.errorCode,G,D);null!=I.ITa&&I.ITa||this.Mlb.add(S.startTime);if(!I.errorCode)for(null!=
I.expiresOn&&(this.xpa=Object.assign(new m,{token:I.token,expiresOn:I.expiresOn,authChallenge:S.authChallenge,Zga:I.Zga})),this.kG.clear(),E=0;E<this.NS.count;)if(this.NS.ma(E).authChallenge===S.authChallenge){for(let M of this.NS.ma(E).callbacks)R.s5(M,I.errorCode,G,D);this.NS.removeAt(E)}else E++}}catch(M){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",M.message)}}shutdown(){this.dke=!0;this.NS.clear()}}A.zRj=6E4;A.fHi=6;A.HGi=6;A.jHi=3;A.LGi=300;A.tEg="GetAccessToken";
Object(t.a)(A,"SSOCallbackManager",null,[]);var x=a(730),n=a(555),u=a(122),z=a(79),w=a(27),C=a(30),y=a(151),B=a(346);a.d(F,"AppsForOfficeSingleSignOnManager",function(){return H});class H{constructor(I,R,S=null){this.GGc=new e.a;const G=new c.a;R&&G.add(R.hFi);S&&G.addRange(S);this.Gl=I;this.xFg=G}Fed(I,R,S,G,D,E,M,L,N,Y){Y=Object.assign(new f,{startTime:H.gw(),callback:Y});try{const aa=!!S&&""!==S;var U=Y.startTime;const X=this.getOsfControl(I);let Z=X.getStoreType()||"",da=X.getOwnerAddinStoreType()||
"",qa=X.getSolutionId()||"";const O=X.getVersion()||"";Z=Z.toLowerCase();da=da.toLowerCase();qa=qa.toLowerCase();var P=z.a.Ugd(R)||"";const ca=z.a.Ugd(X.getIframeUrl())||"",wa=P.toLowerCase()===ca.toLowerCase();P=Z;"inmemory"===Z&&(P=da);const ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,P,X.getAssetId(),null,null,X.getStoreId()),Ha={["callInstanceId"]:U.toString(),["controlSolutionId"]:ia,["controlVersion"]:O,["storeType"]:Z,["ownerStoreType"]:da,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:D.toString(),
["allowSignInPrompt"]:E.toString(),["hasAddinAuthChallenge"]:aa.toString(),["securityOriginEqualsSourceLocation"]:wa.toString(),["singleSignOnEnabled"]:M.toString(),["accountTypeFilter"]:L||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ha);y.a.sendTelemetryEvent(Object.assign(new B.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:u.a.Li(Ha)}));U=!0;const Sa=r.AFrameworkApplication.fa.Wa("HostAuthType");switch(L){case "aad":U="aad"===Sa;break;case "msa":U="msa"===Sa;break;
default:U=!L||"noFilter"===L}if(U){L=null;if(M)for(let Da of this.xFg)if(Da.foi(qa)){L=Da;break}L?this.isSSOAddin(I)?(M=!0,"omex"===P&&(M=!1),"spapp"===P||"spcatalog"===P?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!M?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(D&&"exchange"===P&&(G=!1),this.Eed(I,R,S,P,G,E,N,L,Y))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(aa){this.Ilc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
aa.message),H.s5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(I,R,S,G){this.Fed(I,S[x.a.TXc]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,R,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,G)}Eed(I,R,S,G,D,E,M,L,N){this.GGc.hb(I)?G=this.GGc.ma(I):(G=new A(I,this.getWebApplicationResource(I).split(",")[0],G,this.getDefaultDisplayName(I)),this.GGc.add(I,G));const Y=G.resource;I=H.L1h(Y,this.getWebApplicationId(I));const U=OfficeExt.WACUtils.getHostSecure(R);I&&U?I.toLowerCase()===U.toLowerCase()?G.Eed(D,E,S,M,L,N):(H.ZNa('SSO Resource "'+Y+'" cannot be used from "'+R+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),H.s5(N,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(I||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),U||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),H.s5(N,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Ilc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(I){return this.Gl.getOsfControl(I)}isSSOAddin(I){return this.getOsfControl(I).getManifest().isSSOAddin()}getWebApplicationId(I){return this.getOsfControl(I).getManifest().getWebApplicationId()}getWebApplicationResource(I){return this.getOsfControl(I).getManifest().getWebApplicationResource()}getDefaultDisplayName(I){return this.getOsfControl(I).getManifest().getDefaultDisplayName()}static r3h(){try{const I=
{};w.a.hxa&&n.OAuthManagerSettings.$yb&&(I.UiHostSupportsAuthTokenAddinList=H.oYe);I.UiHostSupportsAuthToken=n.OAuthManagerSettings.$yb;return I}catch(I){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",I.message)}return null}static getInstance(I,R,S=null){H.La||(H.La=new H(I,S));return H.La}static ZNa(I){window.console.warn&&window.console.warn(I)}static L1h(I,R){if(!I)return"";R||(R="");let S=I.toLowerCase();var G=R.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(G)||
(H.ZNa('SSO App Id "'+R+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));S.endsWith(G)||(H.ZNa('SSO Resource "'+I+'" does not end with App Id "'+R+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!S.startsWith("https://")&&!S.startsWith("api://"))return H.ZNa('SSO Resource "'+I+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(R=0;R<I.length;R++){G=I.charAt(R);const D=C.a.charCodeAt(I,R);if(33>D||126<D||"&"===G||"?"===G||"#"===G||"%"===G||"\\"===G)return H.ZNa('SSO Resource "'+I+'" contains an invalid character "'+G+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+G+"' in resource URI."),""}if(0<=I.indexOf("::"))return H.ZNa('SSO Resource "'+I+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
I.length)return H.ZNa('SSO Resource "'+I+'" is '+I.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+I.length+"."),"";S.startsWith("api://")&&(S="https://"+S.substring(6,S.length));return 8===S.length?"":OfficeExt.WACUtils.getHostSecure(S)||""}static s5(I,R,S,G){var D=I.startTime;let E=0;0<D&&(E=H.gw()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:E.toString(),["errorCode"]:R.toString()};if(G)for(let M in G)D[M]=
G[M];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);y.a.sendTelemetryEvent(Object.assign(new B.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:u.a.Li(D)}));I.callback(R,S)}static gw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(I){}return Date.now()}}H.oYe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");H.La=null;Object(t.a)(H,
"AppsForOfficeSingleSignOnManager",null,[109])},880:function(t,F,a){a.d(F,"a",function(){return b});t=a(0);var c=a(13);class b{constructor(){this.JVe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.HVe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1630),c.a.instance.ga(1634)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1631),c.a.instance.ga(1635)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1632),c.a.instance.ga(1636)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1633),c.a.instance.ga(1637)]};this.Z9b=null}get Pha(){return"SourceControlId"}get MM(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}zYh(){if(!this.Z9b){this.Z9b={};for(const e of Object.keys(this.JVe))this.Z9b[e]=this.JVe[e];for(const e of Object.keys(this.HVe))this.Z9b[e]=this.HVe[e][0]}}}Object(t.a)(b,"AddinCommandsStringProvider",null,[630])},881:function(t,F,a){a.d(F,"a",function(){return c});
t=a(0);class c{constructor(){this.QLa=0;this.jha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.cfc=!1;this.ydf=this.kia=null}}Object(t.a)(c,"AddInCommandsNotificationParameters",null,[])},952:function(t,F,a){t=a(0);var c=a(15),b=a(85),e=a(156),f=a(14),d=a(88);class h extends Sys.UI.Control{constructor(G,D,E,M){super(document.createElement("div"));this.tS=this.rS=this.Jv=this.eG=this.mG=this.rpa=this.Qqa=null;this.wjb=this.fqa=!1;this.content=this.zp=null;this.T0=0;
this.Rwe=null;this.wT=0;this.GIf=null;this.cle=G;this.qge=D;this.VO=E;this.IG=M;this.eg=D.ownerDocument;this.Dec=this.pt=this.Qjb=!1}get IV(){this.Qqa||(this.Qqa=this.eg.createElement("div"),this.Qqa.id=this.Dh("WACCalloutOuter"),this.Qqa.className="WACCalloutOuter",this.Qqa.setAttribute(d.a.Cd,d.a.KZa),this.Qqa.style.width=this.T0+"px");return this.Qqa}get Ppb(){if(!this.rpa){this.rpa=this.eg.createElement("div");this.rpa.id=this.Dh("WACCalloutBeakContainer");this.rpa.className="WACCalloutBeakContainer";
var G="CalloutBeakTopFilled_32x16x32";if(5===this.wT||6===this.wT||4===this.wT)G="CalloutBeakBottomFilled_32x16x32";G=e.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.rpa.appendChild(G)}return this.rpa}set Ppb(G){this.rpa=G}get uMa(){return this.Qjb}get title(){return this.zp}set title(G){this.zp!==G&&(this.zp=G,this.rS&&(this.rS.innerText=this.zp))}get pt(){return this.fqa}set pt(G){this.fqa!==G&&(this.fqa=G,this.mG&&(this.mG.contains(this.Jv)&&!this.fqa?this.mG.removeChild(this.Jv):!this.mG.contains(this.Jv)&&
this.fqa&&this.poe()))}get Dec(){return this.wjb}set Dec(G){this.wjb!==G&&(this.wjb=G,this.mG&&(this.mG.contains(this.rS)&&!this.wjb?this.mG.removeChild(this.rS):!this.mG.contains(this.rS)&&this.wjb&&this.Kpe()))}show(){this.Qjb||(this.Dch(),this.lm(),this.qge.appendChild(this.IV),this.IV.style.display="Block",this.qBj(),this.Qjb=!0,this.GIf&&this.GIf())}dismiss(){this.Qjb&&(this.U$(),this.qge.removeChild(this.IV),this.Qjb=!1,this.IG&&this.IG())}dispose(){this.dismiss();this.rS=this.Jv=this.eG=this.rpa=
this.mG=this.Qqa=null;Sys.Component.prototype.dispose.call(this)}Dh(G){return this.get_element().id+G}Dch(){this.mG=this.eg.createElement("div");this.mG.id=this.Dh("WACCalloutHeader");this.mG.className="WACCalloutHeader";this.pt&&this.poe();this.Dec&&this.Kpe();this.eG=this.eg.createElement("div");this.eG.id=this.Dh("WACCalloutContent");this.eG.className="WACCalloutContent";this.eG.style.width=190<this.T0?this.T0-26+"px":"164px";this.eG.appendChild(this.content);this.IV.appendChild(this.Ppb);this.IV.appendChild(this.mG);
this.IV.appendChild(this.eG)}poe(){this.Jv=this.eg.createElement("a");this.Jv.className="WACCalloutCloseAnchor";this.Jv.id=this.Dh("WACCalloutCloseAnchor");this.Jv.href="#";this.mG.appendChild(this.Jv);const G=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Jv.appendChild(G)}Kpe(){this.rS=this.eg.createElement("div");this.rS.className="WACCalloutTitle UIFontBold";this.rS.style.width=190<this.T0?this.T0-30+"px":"160px";this.rS.id=
this.Dh("WACCalloutTitle");this.rS.innerText=this.title;this.mG.contains(this.Jv)?this.mG.insertBefore(this.rS,this.Jv):this.mG.appendChild(this.rS)}qBj(){var G=this.cle;let D;if(1===this.wT){var E=this.Rwe.y+16;D=-16}else 2===this.wT||3===this.wT||0===this.wT?(E=G.y+G.height+15,D=-15):(E=G.y-this.IV.clientHeight-15-2,D=this.IV.clientHeight-1);this.IV.style.top=E+"px";this.Ppb.style.top=D+"px";1===this.wT?(G=this.Rwe.x-16,this.IV.style.left="50%",this.IV.style.marginLeft=-this.T0/2+"px",E=Sys.UI.DomElement.getBounds(this.IV),
this.Ppb.style.left=G-E.x+"px"):(E=G.x+this.cle.width/2,2===this.wT||5===this.wT?(G=20,E-=36):0===this.wT||4===this.wT?(G=this.T0/2-16,E-=this.T0/2):(G=this.T0-20-32,E=E-this.T0+36),this.IV.style.left=E+"px",this.Ppb.style.left=G+"px")}lm(){this.pt&&!this.tS&&(this.tS=Object(b.a)(this,this.s$,"closeHandler"),this.VO.ta(f.a.click,this.Jv,this.tS,null))}U$(){this.pt&&this.tS&&(this.VO.Ba(f.a.click,this.Jv,this.tS),this.tS=null)}s$(){this.dismiss();return!0}}Object(t.a)(h,"Callout",Sys.UI.Control,[72]);
class m extends h{constructor(G,D,E,M,L,N=null){super(G,E,L.OW,N);this.yee=0;this.T0=this.EYh(M);this.fYa=D;this.Ze=L;this.ASj=7;this.vl=this.fYa.ownerDocument.createElement("div");this.vl.className="ModalCalloutControlOverlay";this.vl.tabIndex=0;this.fYa.insertBefore(this.vl,this.fYa.firstChild)}show(){this.uMa||(this.Ze.msc(),this.Ze.lP(!1),this.vl.style.zIndex=String(this.Ze.U1),super.show(),this.Aj(),this.yee=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.ASj))}dismiss(){this.uMa&&
(this.Ze.qM(!1),this.Sj(),this.fYa&&this.fYa.contains(this.vl)&&this.fYa.removeChild(this.vl),super.dismiss(),window.clearTimeout(this.yee))}Aj(){this.Ze.Rra(Object(b.a)(this,this.dismiss,"dismiss"));this.Ze.vy.ta(f.a.click,this.vl,Object(b.a)(this,this.fd,"onClick"))}Sj(){this.Ze.ncb(Object(b.a)(this,this.dismiss,"dismiss"));this.Ze.vy.Ba(f.a.click,this.vl,Object(b.a)(this,this.fd,"onClick"))}fd(){this.dismiss();return!0}EYh(G){let D=0;switch(G){case 0:D=190;break;case 1:D=250;break;case 2:D=300;
break;case 3:D=360}return D}}Object(t.a)(m,"ModalCallout",h,[]);var l=a(462),v=a(176);class r extends m{constructor(G,D,E,M,L,N=null){super(G,D,E,M,L,N);this.KVb=null}show(){if(!this.uMa){const G=Object.assign(new l.a,{onShow:()=>{m.prototype.show.call(this)}});v.UISurfaces.eH().then(D=>{const E=D.externalNotification();this.KVb=D.addNotification(E,G);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.uMa&&this.KVb&&(v.UISurfaces.eH().then(G=>
{G.removeNotification(this.KVb);return this.KVb=null},G=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(t.a)(r,"ReactManagedModalCallout",m,[]);var A=a(4);class x{static reh(G,D,E){return A.AFrameworkApplication.ra.Qa.GQ?new r(G,D,E,3,A.AFrameworkApplication.ra,null):new m(G,D,E,3,A.AFrameworkApplication.ra,null)}}Object(t.a)(x,"ModalCalloutControlFactory",null,[]);var n=a(54),u=a(878),z=a(586),w=a(879),C=a(136),y=a(57),B=a(40),
H=a(83),I=a(827),R=a(710);a.d(F,"a",function(){return S});class S{static get a1b(){return S.Tea||(S.Tea=H.a.instance.mg("Common.Utils.IAriaNotifier"))}static WGe(G,D,E,M){S.JI&&S.JI.uMa&&S.JI.dismiss();S.JI=x.reh(D,G,G);S.JI.content=E;R.b(M)||(S.JI.title=M,S.JI.Dec=!0);G=new Sys.UI.Bounds(0,0,y.a.Adc(),y.a.zdc());S.JI.wT=S.pQh(G,D,S.JI.T0);S.JI.show();S.a1b&&S.a1b.sendNotification(E.innerText,!0)}static j5c(G,D,E,M=null){v.UISurfaces.eH().then(L=>{let N=null;S.Jlb&&(L.removeNotification(S.Jlb),S.Jlb=
null);const Y=L.callout(Object.assign(new u.a,{target:G,title:D,content:E,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new w.a,{onDismiss:()=>{L.removeNotification(N)},directionalHint:null!=M?M:null})})),U=Object.assign(new l.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:()=>{L.removeNotification(S.Jlb)}})});N=S.Jlb=L.addNotification(Y,U);return null},L=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
L);return null})}static nUd(G,D=null){S.JI&&S.JI.uMa&&S.JI.dismiss();const E=new C.StandardDialog;E.ESa=!1;E.Ob=0;E.Kz(n.a.jyi,CommonUIStrings.l_DialogError,R.b(G)?S.d2e():G,D)}static pUd(G){S.JI&&S.JI.uMa&&S.JI.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));const D=R.b(G.description)?S.d2e():G.description,E=new C.StandardDialog;let M=null;G.jha?(E.Ob=1,E.tc(1,G.buttonText),E.k0(1)):E.Ob=0;M=L=>{1===L?G.jha():G.kia&&G.kia()};
E.ESa=!1;0===G.QLa?E.Kz(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,D,M):1===G.QLa?E.QR(G.title?G.title:CommonUIStrings.l_DialogWarning,D,M):E.Tna(G.title?G.title:CommonUIStrings.l_DialogInfo,D,M)}static pQh(G,D,E){let M=4;const L=G.x+G.width-D.x-D.width;D.x-G.x+D.width/2<=E/2?M=5:L+D.width/2<=E/2&&(M=6);return M}static BHj(G,D,E,M=!1){(D=I.a.I3a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,L=>{L&&(M||S.j5c(L,
E,G,5))})}static CHj(G,D,E=!1){S.BHj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),E)}static AHj(G,D,E,M){if(S.ilg)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,M,CommonUIStrings.l_InsertionDialogRefresh)),S.j5c(D,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=
B.a.Vo(D);var L=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),N=document.createElement("span");N.innerText=L[0];var Y=document.createElement("span");Y.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,M,CommonUIStrings.l_InsertionDialogRefresh);Y.className="UIFontBold";E=document.createElement("span");E.innerText=L[1];M=document.createElement("div");Sys.UI.DomElement.addCssClass(M,"ModalCalloutControl");M.appendChild(N);M.appendChild(Y);M.appendChild(E);
S.WGe(G,D,M,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static UIj(G,D){var E=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,M=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;S.ilg?S.j5c(D,E,M):(D=B.a.Vo(D),S.WGe(G,D,S.DZg(M),E))}static DZg(G){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=G;return D}static d2e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get ilg(){return A.AFrameworkApplication.ra.Qa.Ci&&
A.AFrameworkApplication.ra.Qa.GQ}}S.JI=null;S.Jlb=null;S.Tea=null;Object(t.a)(S,"AddInCommandsNotificationFactory",null,[])},962:function(t,F,a){a.r(F);t=a(0);var c=a(15),b=a(1490),e=a(151),f=a(122),d=a(730),h=a(745),m=a(346);class l{constructor(n,u,z,w){this.$z=!1;this._id=n;this.ex=u;this.h1=z;this.Nd=w}get enabled(){return this.$z}set enabled(n){const {DynamicRibbon:u}=a(962);var z=this.Nd.OwnerAddinStoreType;const w=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:
null,y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,z,null,null,null,w);z={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,z,C,null,null,w),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:n};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:u.MBc+"ControlUpdate",dataFields:f.a.Li(z)}));this.$z=n;this.h1.QJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.ex,["PrivacyCompliantSolutionId"]:y,
["SourceControlId"]:this.id,["MethodData"]:this.$z})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(n){switch(n){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n,
u){switch(n){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertySetAsync(n,u){this.invokePropertySet(n,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n,u){switch(n){case 5:return this.Xxj(u);case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,u){n=this.invokeMethod(n,
u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}Xxj(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");this.setEnabled(n);return null}ACa(){this._OnAccess();return null}}Object(t.a)(l,"RibbonButton",null,[]);class v{constructor(n,u,z,w){this._id=n;this.ex=u;this.h1=z;this.Nd=w}get id(){return this._id}setVisibility(n){const {DynamicRibbon:u}=a(962),z=this.Nd.OwnerAddinStoreType;var w=this.Nd.PrimaryMarketplace.MarketplaceRef;const C=this.Nd.AssetMarketplace?
this.Nd.AssetMarketplace.SolutionId:null,y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,z,C,null,null,w);w={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,z,C,null,null,w),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:n};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:u.MBc+"ControlUpdate",dataFields:f.a.Li(w)}));this.h1.QJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.ex,
["PrivacyCompliantSolutionId"]:y,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:n})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(n){switch(n){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
}invokePropertySetAsync(n,u){this.invokePropertySet(n,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n,u){switch(n){case 3:return this.TBj(u);case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,u){n=this.invokeMethod(n,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}TBj(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");this.setVisibility(n);
return null}ACa(){this._OnAccess();return null}}Object(t.a)(v,"RibbonTab",null,[]);var r=a(988),A=a(189);a.d(F,"DynamicRibbon",function(){return x});class x{constructor(n,u,z,w,C){this.ex=n;this.BI=z;this.h1=w;this.Nd=C;this.bib=this.BI.Ng;this.Fy=this.bib.getOsfControl(u);this.fAg=this.Fy.getManifest()}get buttons(){return null}executeRequestCreate(n){try{var u=this.Nd.OwnerAddinStoreType;const w=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:
null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,u,C,null,null,w);const y={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,u,C,null,null,w),["ownerAddinStoreType"]:this.Nd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:x.MBc+"ExecuteRequestCreate",dataFields:f.a.Li(y)}));const B=A.a.Wh(n);n={};u={};u[d.a.UIa]=this.Fy;u[d.a.VIa]=B;u[d.a.o9c]=this.Nd;n[d.a.Wtb]=
3;n[d.a.p3]=this.ex;n[d.a.C8b]=z;n[d.a.o3]=u;this.h1.QJ(-1014260128,n);let H=x.bbc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,H)}catch(w){z=x.bbc("ExecuteRequestCreate",!1,w.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(n){try{var u=this.Nd.OwnerAddinStoreType;const w=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,u,C,null,
null,w);const y={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,u,C,null,null,w),["ownerAddinStoreType"]:this.Nd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:x.MBc+"ExecuteRequestUpdate",dataFields:f.a.Li(y)}));const B=A.a.Wh(n);n={};u={};u[d.a.UIa]=this.Fy;u[d.a.VIa]=B;u[d.a.o9c]=this.Nd;n[d.a.Wtb]=3;n[d.a.p3]=this.ex;n[d.a.C8b]=z;n[d.a.o3]=u;this.h1.QJ(-1014260128,
n);let H=x.bbc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,H)}catch(w){z=x.bbc("ExecuteRequestUpdate",!1,w.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(n){let u=null;if(!this.Whf())return this.ZGe();if(n&&0<n.length){if(!this.YBe(n))return this.qHe(n);u=new l(n,this.ex,this.h1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}getTab(n){let u=null;if(!this.Whf())return this.ZGe();if(this.Fy.getOwnerAddinControlRecreated())return this.Edh();
if(n&&0<n.length){if(!this.YBe(n))return this.qHe(n);u=new v(n,this.ex,this.h1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(n){switch(n){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
}invokePropertySetAsync(n,u){this.invokePropertySet(n,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n){switch(n){case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,u){switch(n){case 7:return this.QDh(u);case 6:return this.RDh(u);case 3:return this.VPh(u);case 5:return this.o4h(u)}n=this.invokeMethod(n,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}QDh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return this.executeRequestCreate(n)}RDh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.executeRequestUpdate(n)}VPh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getButton(n)}o4h(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getTab(n)}ACa(){this._OnAccess();return null}qHe(n){return r.a(h.a.b$g,A.a.ga(1768)+n)}ZGe(){return r.a(h.a.Spj,A.a.ga(1764))}Edh(){return r.a(h.a.hostRestartNeeded,
A.a.ga(1769))}Whf(){var n=this.Fy.getSharedRuntimeId();n=!!n&&0<n.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",n));return n}YBe(n){const u=this.fAg.getRibbonExtensionControlMap();return n in u||this.r3g(n)}r3g(n){var u=this.pHh();if(u){u=u.kOe;for(const z of u.tabs){if(z.id===n)return!0;for(const w of z.groups)for(const C of w.controls){if(C.id===n)return!0;if("Menu"===C.type){u=C;for(const y of u.items)if(y.id===n)return!0}}}}return!1}pHh(){return b.a.getInstance().Nia(this.Nd.PrimaryMarketplace.MarketplaceType,
this.Nd.PrimaryMarketplace.SolutionId,1)}static bbc(n,u,z){const w={};w.methodName="DynamicRibbon."+n;w.result=u?"Succeeded":"Failed";w.message=z;return A.a.Dc(w)}}x.MBc="Office.Online.Extensibility.Ribbon.";Object(t.a)(x,"DynamicRibbon",null,[])},973:function(t,F,a){a.d(F,"a",function(){return b});var c=a(974);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},979:function(t,F,a){a.d(F,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},981:function(t,F,a){a.d(F,"a",function(){return c});t=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Zga=this.ITa=this.Vgd=this.qjd=this.Txb=this.dYd=null}}Object(t.a)(c,"AppsForOfficeOauthResult",null,[])},988:function(t,F,a){a.d(F,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/02880cb05602e2315a92b48c00f3b98f/EwaDSEsNext.agave.js.map