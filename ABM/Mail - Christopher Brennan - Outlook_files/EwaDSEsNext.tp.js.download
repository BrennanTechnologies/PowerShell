'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1472:function(t,F,a){a.r(F);var c=a(0),b=a(511),e=a(47),f=a(9),d=a(51),h=a(89),m=a(55),l=a(84),v=a(226),r=a(421),A=a(37),x=a(7),n=a(15),u=a(86),z=a(83),w=a(227),C=a(14),y=a(110),B=a(4),H=a(88),I=a(151),R=a(122),S=a(576),G=a(96),D=a(746),E=a(5),M=a(127),L=a(374),N=a(192),Y=a(284),U=a(33),P=a(251),aa=a(568),X=a(12),Z=a(1),da=a(11),qa=a(13),O=a(21),ca=a(128),wa=a(156),ia=a(346),Ha=a(697),Sa=a(552),Da=a(19),ea=
a(554),sa=a(68),Ea;(function(jc){jc[jc.NavigateToPane=24]="NavigateToPane"})(Ea||(Ea={}));Object(c.b)("InsightsActionType",Ea);var ba;(function(jc){jc[jc.Feedback=0]="Feedback"})(ba||(ba={}));Object(c.b)("TargetPane",ba);var ka;(function(jc){jc[jc.Error=0]="Error"})(ka||(ka={}));Object(c.b)("InsightsResponseType",ka);class Ca{constructor(jc){this.$=jc}Ifj(){window.addEventListener("message",this.onMessage.bind(this))}fig(){window.removeEventListener("message",this.onMessage.bind(this))}onMessage(jc){if(Ca.zli(jc.origin)){var bd;
try{(bd=jc.data)&&"string"===typeof bd&&(bd=JSON.parse(bd)),jc.source!==window&&bd&&void 0!==bd.actionType&&this.actionHandler(bd)}catch(Hd){jc.source.postMessage(JSON.stringify({responseType:ka.Error,errorMessage:Hd?Hd.message:void 0}),jc.origin)}}}actionHandler(jc){if(jc)switch(jc.actionType){case Ea.NavigateToPane:this.navigateToPane(jc.data);break;default:throw Error(`unknow action type: ${jc.actionType}`);}}navigateToPane(jc){switch(jc){case ba.Feedback:this.$.Zc(802602464,sa.a.zb,12,{[E.a.sM]:"AnalyzeDataPane"});
break;default:throw Error(`unknow navigate pane: ${jc}`);}}static zli(jc){return jc&&jc.endsWith("insights.microsoft.com")?!0:!1}}Object(c.a)(Ca,"InsightsTaskPaneListener",null,[]);const db=Da.a.qad;class yb extends G.a{constructor(jc,bd,Hd,ge){super(jc);this.Bse='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.k0b=null;this.Jmd=this.Ueg=!1;this.U$d=this.lj=this.af=null;this.Fv=0;this.button=null;this.KPf=!1;this.Odc="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=
Mb=>{if(void 0!==Mb.Ea&&null!==Mb.Ea&&Mb.Ea.keyCode===u.a.Ay)if(Mb.Ea.shiftKey){if(!U.a.Ad(this.$)){Mb=this.$.da.Aa(183);if(!Mb)return!1;Mb.xRd()}}else this.ag(!0,!1),Mb.Ea.preventDefault(),Mb.Ea.stopPropagation();return!0};this.Ppc=(Mb,Kc)=>{Object.getType(Kc)===String&&Kc.toString()===this.af.InstanceId&&(Mb=!!this.title,Kc=!this.Jmd,Mb&&this.jPe(),this.jhg(),U.a.Ad(this.$)&&(Mb&&this.Ueg||Kc&&this.Jmd)&&this.s7.updateTaskPane(this.z0,this.CB))};this.Yla=()=>{var Mb;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&
this.lj.BLd(this.af.InstanceId);this.nwa&&(this.nwa.fig(),this.nwa=void 0);const Kc=aa.a(this.af);if(Kc)if(this.af.TaskpaneTitle===qa.a.instance.ga(982))n.ULS.sendTraceTag(537151139,9,50,"Chart task pane closed");else if(this.af.PrimaryMarketplace)if("FA000000005"===this.af.PrimaryMarketplace.SolutionId){n.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let Ob="Unknown",Mc="Unknown",Dc="Unknown";null===(Mb=this.af.OsfPropertyBag)||void 0===Mb?void 0:Mb.forEach($c=>{2===$c.length&&("LaunchMode"===
$c[0]?Ob=$c[1]:"CorrelationId"===$c[0]?Mc=$c[1]:"LaunchSelectionMode"===$c[0]&&(Dc=$c[1]))});Mb={["LaunchMode"]:Ob,["CorrelationId"]:Mc,["LaunchSelectionMode"]:Dc,["Location"]:"taskPane"};ca.b(this.$).rd(M.a.O5g,Mb,void 0,!0);'"Default"'===Ob?z.a.instance.Tb("Common.ISystemInitiatedFeedback").execute($c=>{$c.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===Ob?z.a.instance.Tb("Common.ISystemInitiatedFeedback").execute($c=>{$c.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",
null)}):'"RecommendedPivotTables"'===Ob&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?z.a.instance.Tb("Common.ISystemInitiatedFeedback").execute($c=>{$c.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===Ob&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&z.a.instance.Tb("Common.ISystemInitiatedFeedback").execute($c=>{$c.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",
null)})}else U.a.Pki()&&"FA000000043"===this.af.PrimaryMarketplace.SolutionId?"Record Actions"===this.af.TaskpaneTitle&&(this.$.vba=!1,n.ULS.sendTraceTag(537151137,0,50,"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.af.PrimaryMarketplace.SolutionId===S.a?this.dsf(!1):"FA000000075"===this.af.PrimaryMarketplace.SolutionId&&(Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)||Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1))&&(Mb=this.$.da.Aa(465))&&(Mb.rii(),Mb.SMe());da.HelperMethods.lw(this.af)?this.Kg(!1):(U.a.Ad(this.$)?this.s7.hideTaskPane(this.z0):this.raiseEvent("AgavePaneRemovedEventKey"),this.lj.zQa(this.af.InstanceId),U.a.Ad(this.$)||this.s7.FB());O.h(this.$).setFocus();if(1===this.af.WebExtensionOsfControlType&&!Kc){this.af.TaskpaneVisible=!1;const Ob=this.$.oa.xa.Wb();L.a(this.$.userOperationManager,(Mc,Dc,$c)=>Y.c(this.$.oa.xa,this.af.InstanceId,!1,Mc,Dc,$c,Ob),Mc=>new N.a(547,0,Mc,64),null)}return!0};
this.bGf=(Mb,Kc)=>{Object.getType(Kc)===String&&Kc.toString()===this.af.InstanceId&&(U.a.Ad(this.$)?this.s7.hideTaskPane(this.z0):this.raiseEvent("AgavePaneRemovedEventKey"))};this.aGf=(Mb,Kc)=>{Object.getType(Kc)===String&&Kc.toString()===this.af.InstanceId&&(this.JZd(),U.a.Ad(this.$)?this.k6():this.s7.eI(this,!0))};this.onResize=()=>{this.t$c()};this.$=bd;this.s7=Hd;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&
ge?ge.Ph(this.domElement,String.format(this.Bse,db,this.$.Bb+E.a.lYc,this.$.Bb+E.a.kYc)):this.domElement.innerHTML=String.format(this.Bse,db,this.$.Bb+E.a.lYc,this.$.Bb+E.a.kYc);this.psg=X.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+E.a.kYc);this.Vra=X.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+E.a.lYc);this.k0b=X.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");jc=X.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");
this.moa=this.Kbh();jc.appendChild(this.moa);w.a.instance.ta(C.a.click,this.moa,this.Yla);this.pkc=y.KeyInputManager.instance.Dt(this.moa,this.Yla,u.a.Jh);U.a.Ad(this.$)||y.KeyInputManager.instance.ta(C.a.Sb,this.moa,this.onCloseButtonTabKeyDown);X.DOMElementExtensions.setVisible(this.Vra,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.t$c();this.$&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
this.domElement.classList.add(D.a.FSe);this.$.bC(this.onResize)}kT(jc){this.addHandler("AgavePaneRemovedEventKey",jc)}iW(jc){this.removeHandler("AgavePaneRemovedEventKey",jc)}vLg(jc){this.addHandler("AgavePaneReadyKey",jc)}wij(jc){this.removeHandler("AgavePaneReadyKey",jc)}get oGa(){return this.psg}get Hh(){return 6}get ek(){return this.af.TaskpaneIconCssClass||""}get tQ(){return this.af.TaskpaneButtonTooltip||this.af.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.U$d}get Up(){return this.af.TaskpaneWidth}get isResizable(){const jc=
bd=>{var Hd,ge;return(null===(ge=null===(Hd=this.af)||void 0===Hd?void 0:Hd.PrimaryMarketplace)||void 0===ge?void 0:ge.SolutionId)===bd};return!OSF.OsfControl.isFirstPartyStoreString(this.af.PrimaryMarketplace.MarketplaceType)&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||jc("FA000000043")||jc("FA000000054")||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&jc("FA000000005")||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&
jc("FA000000050")?!0:!1}get Yd(){return P.a.fQg}get jc(){return this.domElement}get Ff(){return!!this.af}get title(){return this.lj.$Sh(this.af.InstanceId)}get titleText(){return this.title}get oZa(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.af.InstanceId}get z0(){return"AgaveTaskPane-"+this.instanceId.replace(RegExp("[{}]","g"),"")}get CB(){const jc=this.s7.Pua(this.jc,this.titleText,this.Up,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=
!0},()=>{this.isVisible=!1},this.Up,void 0,this.iconUrl,this.af.TaskpaneIconId,da.HelperMethods.lw(this.af));if(Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.af.SrcLocationOverrideResourceId===this.Odc){jc.contentProps.type="OcvFeedbackTaskPaneProps";jc.hideHeader=!1;let bd=JSON.parse(this.af.OsfPropertyBag[0][1]);bd.IsProd=!0;jc.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:bd,taskPaneLocation:jc.location,taskPaneIdToClose:this.z0}}return jc}startEdit(){return!0}MAc(){return!0}Aof(){this.lj.Ng.notifyAgave(this.af.InstanceId,
OSF.AgaveHostAction.TabIn)}Bof(){this.lj.Ng.notifyAgave(this.af.InstanceId,OSF.AgaveHostAction.TabInShift)}tDd(){this.lj.qqe(this.bGf);this.lj.cMg(this.aGf);let jc=this.lj.Mfd(this.af.InstanceId);this.title&&jc||this.lj.fMg(this.Ppc);this.title&&this.jPe();this.raiseEvent("AgavePaneReadyKey");U.a.Ad(this.$)&&(""!==this.ek?d.a.qe(10):d.a.current.lo(101),this.gjg(),Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&U.a.Ad(this.$)&&da.HelperMethods.lw(this.af)&&this.af.Preload&&
!this.af.TaskpaneVisible?this.W5b():this.k6())}W5b(){this.s7.W5b(this.z0,this.CB)}k6(){"FA000000005"!==this.af.PrimaryMarketplace.SolutionId||this.nwa||(this.nwa=new Ca(this.$),this.nwa.Ifj());this.s7.k6(this.z0,this.CB)}dispose(){var jc,bd;this.KPf||(null===(bd=null===(jc=this.af)||void 0===jc?void 0:jc.PrimaryMarketplace)||void 0===bd?void 0:bd.SolutionId)!==S.a||this.dsf(!0);this.nwa&&(this.nwa.fig(),this.nwa=void 0);w.a.instance.Ba(C.a.click,this.moa,this.Yla);y.KeyInputManager.instance.Uw(this.moa,
this.pkc);U.a.Ad(this.$)||y.KeyInputManager.instance.Ba(C.a.Sb,this.moa,this.onCloseButtonTabKeyDown);this.lj&&(this.lj.ajj(this.Ppc),this.lj.Zij(this.bGf),this.lj.Yij(this.aGf),this.$&&(this.$.xF(this.onResize),this.$=null));this.$=this.af=null;super.dispose()}gjg(){this.af&&this.jhg()}BV(jc){jc||this.JZd()}Kg(jc){if(this.af){const bd=this.af.TaskpaneVisible!==jc;this.af.TaskpaneVisible=jc;U.a.Ad(this.$)?jc||this.s7.hideTaskPane(this.z0):this.s7.FB();da.HelperMethods.lw(this.af)&&bd&&this.lj.EHh(this.instanceId,
jc)}}Aq(){let jc=!1;this.af&&this.$.qd&8388608&&(jc=this.af.TaskpaneVisible);return jc}wt(){return!this.af||OSF.OsfControl.isFirstPartyStoreString(this.af.PrimaryMarketplace.MarketplaceType)||this.$.rT?da.HelperMethods.lw(this.af)?this.af.TaskpaneVisible:!!this.af:!1}ag(jc,bd){return bd?!1:(this.JZd(),this.lj.Ng.notifyAgave(this.af.InstanceId,jc?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}sh(jc){return X.DOMElementExtensions.Af(this.jc,jc)}rj(){}dk(){}OU(jc,bd){var Hd=bd.querySelectorAll(X.DOMElementExtensions.kr);
bd=X.DOMElementExtensions.rm(Hd);Hd=X.DOMElementExtensions.LA(Hd);let ge=!1;bd===jc.Mb&&jc.Ea.shiftKey?((jc=document.getElementById(this.$.Bb+E.a.Tnc))&&X.DOMElementExtensions.isVisible(jc)?X.DOMElementExtensions.setFocus(jc):this.ag(!1,!1),ge=!0):Hd!==jc.Mb||jc.Ea.shiftKey||(this.G4f(),ge=!0);return ge}G4f(){this.moa&&X.DOMElementExtensions.setFocus(this.moa)}Kbh(){const jc=document.createElement("a");jc.tabIndex=0;jc.id="AgaveTaskpaneCloseButtonId";jc.className=E.a.wOb+(B.AFrameworkApplication.isRtl?
E.a.Tia:E.a.Uia);jc.title=qa.a.instance.ga(10);jc.setAttribute(H.a.Cd,H.a.Qs);jc.style.borderColor="transparent";Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?jc.style.margin="6px 6px 0px 6px":jc.style.margin="6px";jc.style.zIndex="2";jc.style.position="relative";const bd=document.createElement("span");bd.className="StandardButtonImage clip16x16 StandardButtonImageNoText";bd.id=jc.id+"-close";const Hd=wa.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32",
"",!0,qa.a.instance.ga(792));bd.appendChild(Hd);jc.appendChild(bd);return jc}jPe(){this.Vra.innerText=this.title;this.Vra.style.textOverflow="ellipsis";this.Vra.style.whiteSpace="nowrap";this.Vra.style.overflowX="hidden";this.af.TaskpaneTitleCssClass&&(this.Vra.className=this.Vra.className+" "+this.af.TaskpaneTitleCssClass);this.k0b.className=this.k0b.className+" "+this.af.TaskpaneHeaderCssClass;X.DOMElementExtensions.setVisible(this.Vra,!0);this.button&&(this.button.D_a.title=this.title);this.t$c();
this.Ueg=!0}jhg(){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.ek&&!U.a.Ad(this.$)){if(this.button){var jc=d.a.qe(10),bd=this.button.Bl;bd.setAttribute("src",jc);bd.setAttribute("class",this.ek)}return}}else if(this.ek){this.button&&(jc=d.a.qe(10),bd=this.button.Bl,bd.setAttribute("src",jc),bd.setAttribute("class",this.ek));return}if(bd=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.af.TaskpaneIconUrl?this.af.TaskpaneIconUrl:
this.lj.Mfd(this.af.InstanceId):this.lj.Mfd(this.af.InstanceId))this.$.Qka&&this.af.PrimaryMarketplace&&this.af.PrimaryMarketplace.SolutionId===ea.a.solutionId&&(bd=this.IWh(bd)),U.a.Ad(this.$)?this.U$d=bd:(jc=this.button.Bl,jc.setAttribute("src",bd),bd=d.a.current.lo(101),jc.setAttribute("onerror","this.onerror = null;this.src = '"+bd+"';")),this.Jmd=!0}IWh(jc){const bd=ea.a.r6e(this.$),Hd=ea.a.Jwb(this.$),ge=ea.a.zxb(this.$),Mb=ea.a.X5e(this.$),Kc=this.af.SrcLocationOverrideResourceId,Ob=U.a.Ad(this.$);
return Kc===bd?Ob?jc.replace("/icon-32.png","/record-tp-20.png"):jc.replace("/icon-32.png","/record-tp-32.png"):Kc===Hd?Ob?jc.replace("/icon-32.png","/code-tp-20.png"):jc.replace("/icon-32.png","/code-tp-32.png"):Kc===ge?Ob?jc.replace("/icon-32.png","/rfb-tp-20.png"):jc.replace("/icon-32.png","/rfb-tp-32.png"):Kc===Mb?Ob?jc.replace("/icon-32.png","/flowconnector-tp-20.png"):jc.replace("/icon-32.png","/flowconnector-tp-32.png"):jc}t$c(){this.$&&!Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
(this.oGa.style.height=da.HelperMethods.sc(this.s7.nO.offsetHeight-this.k0b.offsetHeight))}JZd(){this.lj.hBd(this)}dsf(jc){jc={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:jc.toString()};const bd=new Ha.a(Sa.a.Ni());bd.add("PaneClosedTime",3);bd.add("IsSessionEnded",1);I.a.sendTelemetryEvent(Object(x.a)(new ia.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:R.a.Li(jc,bd)}));this.KPf=!0}}Object(c.a)(yb,"AgaveTaskPane",G.a,[28,506,510,389]);var kb=a(50);class mb extends v.a{constructor(jc){super();
this.CFd=[];this.nKf=null;this.tzf=bd=>{this.nb(Object(l.a)(506,bd))};this.$=jc;this.Db()}create(){const jc=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?kb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):m.Task.Ra(null),bd=r.a(this.$);A.TaskExtensions.za(A.TaskExtensions.Fd([bd,jc],this.$.la),()=>{const Hd=new yb(document.createElement("div"),this.$,bd.result,jc.result);
this.CFd.push(Hd);Hd.vLg(this.tzf);this.Pa.raiseEvent(v.a.i_c,null,Hd)},this.la,3)}dispose(){for(const jc of this.CFd)jc.wij(this.tzf);h.a.pc(this.CFd);h.a.Ja(this.nKf);this.$=this.nKf=null;super.dispose()}}Object(c.a)(mb,"AgaveTaskPaneFactory",v.a,[]);var W=a(30),Q=a(239),va=a(194),na=a(264),Ba=a(60),Oa=a(48),oa=a(44),Ja=a(325),Wb=a(74),nc=a(22),Yb=a(286),pb=a(282);const Fa=Da.a.yAh,ab=`<div class="${Da.a.qad}"><div title="{0}" class="${Da.a.Hxh}">{0}</div></div><div><div class="${Da.a.Axh}">{1}</div><div class="${Da.a.Exh} ${Da.a.fo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${Da.a.zxh}"><button class="${Da.a.DSe} ${Da.a.yxh}" id="applyButton" type="submit">{2}</button><button class="${Da.a.DSe}" id="resetButton" type="button">{3}</button></div></div>`,
Gb=`<div><div class="${Da.a.Fxh}"><label for="{2}" title="{1}">{0}</label></div><div class="${Da.a.Gxh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class Ga extends Q.a{constructor(jc,bd,Hd,ge){super(jc);this.VRd=this.HVa=this.B0=null;this.Fv=0;this.htmlSanitizationHelper=null;this.mIf=()=>{this.HVa=null};this.Yzj=()=>{h.a.Ja(this.VRd);this.VRd=null;this.isVisible!==this.BTd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.J7g=(Mb,Kc)=>nc.a.compare(Mb.Name,Kc.Name,!0);
this.Czf=Mb=>{Wb.g(Mb);if(!this.csa.domElement.classList.contains(Da.a.C9b)){O.h(this.$).Do(!0);var Kc=[];for(Mb=0;Mb<this.B0.length;Mb++){const Mc=this.HVa[Mb],Dc=this.B0[Mb].text;Mc.Values=[Dc];Dc&&Kc.push(Mc)}if(Kc.length){var Ob=this.$.oa.xa.Wb();this.csa.addCssClass(Da.a.C9b);this.$.userOperationManager.Jc(new N.a(142,0,(Mc,Dc,$c)=>Ba.F(this.$.oa.xa,Kc,!1,0,!1,pb.b(Mc,this.zZi),pb.a(Dc,this.yZi),$c,null,Ob)),null)}}};this.kYi=Mb=>{Wb.g(Mb);Mb=this.B0;for(let Kc=0,Ob=Mb.length;Kc<Ob;Kc++)Mb[Kc].text=
""};this.zZi=()=>{this.csa.removeCssClass(Da.a.C9b)};this.yZi=()=>{this.csa.removeCssClass(Da.a.C9b)};this.JGb=(Mb,Kc)=>{13===Kc.charCode&&this.Czf(Kc)};this.$=bd;this.taskPaneManager=Hd;this.htmlSanitizationHelper=ge;bd=String.format(ab,this.titleText,qa.a.instance.ga(1327),qa.a.instance.ga(1328),qa.a.instance.ga(1329));this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
this.htmlSanitizationHelper.Ph(jc,bd):jc.innerHTML=bd;this.lab=this.getElementById("parametersSection");this.csa=new Ja.a(this.getElementById("applyButton"));this.csa.Cc.ka("click",this.Czf);this.HNd=new Ja.a(this.getElementById("resetButton"));this.HNd.Cc.ka("click",this.kYi);this.$.ea.Jj(this.mIf);na.a(this.$).Xh(this)}kT(jc){this.get_events().addHandler("RemoveParamTpEventKey",jc)}iW(jc){this.get_events().removeHandler("RemoveParamTpEventKey",jc)}hE(jc){this.addHandler("parameterTaskPaneVilibilityChanged",
jc)}zF(jc){this.removeHandler("parameterTaskPaneVilibilityChanged",jc)}get U7b(){this.Fef();return this.HVa}get jc(){return this.domElement}get Up(){return 250}get isResizable(){return!1}get Ff(){return this.isVisible}get Yd(){return P.a.i3i}get Hh(){return 2}get ek(){return Fa}get tQ(){return qa.a.instance.ga(1068)}get BTd(){return!!this.U7b&&0<this.U7b.length&&!this.$.isEditMode}get titleText(){return qa.a.instance.ga(1326)}get CB(){return this.taskPaneManager.Pua(this.jc,this.titleText,this.Up,
this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}Kg(jc){U.a.Ad(this.$)&&(jc?(this.Fef(),this.taskPaneManager.k6("ParametersTaskPane",this.CB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}Aq(){return this.BTd}wt(){return this.BTd}BV(){}dispose(){this.$&&this.$.ea.ik(this.mIf);this.wVf();h.a.pc([this.csa,this.HNd]);this.HVa=this.lab=this.$=this.csa=this.HNd=null;super.dispose()}ag(jc,bd){bd||(this.B0&&0<this.B0.length?this.B0[0]:
this.csa).focus();return!bd}sh(jc){return X.DOMElementExtensions.Af(this.jc,jc)}rj(){}dk(){}OU(){return!1}Fef(){!this.HVa&&this.$.qd&2048&&this.YTg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}YTg(jc,bd){var Hd=[];this.wVf();if(!this.$.isEditMode&&jc&&0<jc.length){var ge=this.J7g;if(bd&&0<bd.length){var Mb=new va.a([...bd]);Mb.R9.sort(ge)}else Mb=null;for(let Ob=0,Mc=jc.length;Ob<Mc;Ob++){var Kc=jc[Ob];bd&&!(0>da.HelperMethods.Xu(Mb,0,Mb.Bja(),Kc,ge))||Kc.IsPivotPageField||
Kc.IsSlicer||Hd.push(Kc)}}this.HVa=Hd;if(this.lab&&(this.isVisible!==0<Hd.length&&(this.VRd=Oa.a.instance.create(this.Yzj,500,oa.a.j3i,!0,!0)),this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.HG(this.lab):this.lab.innerHTML="",Hd.length)){bd="";jc=[];for(let Ob=0,Mc=Hd.length;Ob<Mc;Ob++)ge=this.$.Bb+"param"+Ob,jc.push(ge),
Kc=Hd[Ob],Mb=Kc.Name?W.a.yg(Kc.Name):"",Kc=Kc.Comment?W.a.TJ(Kc.Comment):"",bd+=String.format(Gb,Mb,Kc,ge);this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.Ph(this.lab,bd):this.lab.innerHTML=bd;bd=[];for(let Ob=0,Mc=Hd.length;Ob<Mc;Ob++)Hd=new Yb.a(document.getElementById(jc[Ob])),bd.push(Hd),Hd.gNg(this.JGb);this.B0=
bd}}wVf(){if(this.B0){for(let jc=0,bd=this.B0.length;jc<bd;jc++)this.B0[jc].Ojj(this.JGb);h.a.pc(this.B0);this.B0=null}}static ZTg(jc,bd,Hd){const ge=jc.da;let Mb=ge.Aa(17);if(!Mb){const Kc=document.getElementById(jc.Bb+E.a.k3i);Kc&&(Mb=ge.Ha(17,new Ga(Kc,jc,bd,Hd)))}return Mb}}Object(c.a)(Ga,"ParametersTaskPane",Q.a,[140,510,28,2]);class Ma extends v.a{constructor(jc){super();this.$=jc;this.Db()}create(){const jc=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
kb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):m.Task.Ra(null),bd=r.a(this.$);A.TaskExtensions.za(A.TaskExtensions.Fd([bd,jc],this.$.la),()=>{this.nb(Ga.ZTg(this.$,bd.result,jc.result))},this.la,3)}}Object(c.a)(Ma,"ParametersTaskPaneFactory",v.a,[]);var Qa=a(709),wb=a(188);class Na{Hc(){return!1}executeCommand(jc,bd){jc=bd.command;switch(jc){case 329273335:case 1962240939:case 296943390:case -625072140:return m.Task.Ra(!0);default:return wb.a(jc)}}wc(jc,bd,Hd,ge){if(jc=!!ge&&2===ge.wx)switch(bd.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:jc=!1}return jc}Mc(){return!1}}Object(c.a)(Na,"TaskPaneCommandHandler",null,[221]);class ya extends Qa.a{constructor(jc){super(jc)}hd(){this.$c([new Na])}static ka(jc){Qa.a.Ld(115,new ya(jc))}}Object(c.a)(ya,"TaskPaneCommandHandlerFactory",Qa.a,[]);var nb=a(1346),vb=a(176);class gb{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(gb,"TaskPaneGroupAppProps",null,[]);var cb=a(27),La=a(38),ja=a(217);class Ua{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(Ua,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var lb=a(294),sb=a(18),V=a(16),za=a(132);class Ra{constructor(jc){this.width=jc}}Object(c.a)(Ra,"ActiveTaskPaneData",null,[]);class Xa extends La.a{constructor(jc,bd){super();this.isVisible=!1;this.YXd=
this.hea=-1;this.$Ke=40;this.Bh=this.bL=this.animationManager=this.nJc=null;this.$Cd=()=>{this.eZf()};this.FBc=new Set;this.FBc.add("FieldListTaskPane");this.FBc.add("PivotTableSettingsTaskPane");this.FBc.add("SlicerSettingsTaskPane");this.jb=bd;na.a(this.$).Xh(this);this.Mz=jc;this.w9a=this.xYg();U.a.Qi(bd)||B.AFrameworkApplication.ra.Qa.Qe||(this.Mz.style.bottom=this.$.qd&4?da.HelperMethods.sc(this.$.dea):"0");this.r$b={};this.yOb={};this.p4d={};this.VXd=za.a.instance.ie(this.jc);this.VXd.ka("focusin",
this.$Cd);this.hii()}get $(){return this.jb}get zga(){return this.p4d}get mM(){return this.nJc}get isCollapsed(){return!this.mM}dispose(){na.a(this.$).Cz(this);const jc=this.r$b;for(let bd in jc)({key:bd,value:jc[bd]}).value();this.yOb=this.p4d=this.r$b=null;this.VXd.AC();this.w9a=this.Mz=this.VXd=null;super.dispose()}Pua(jc,bd,Hd,ge,Mb,Kc,Ob,Mc,Dc=Xa.qzi,$c=Xa.pzi,td=null,Yd=null,ae=!1){const je=Object(x.a)(new Ua,{getContent:()=>jc});je.isSharedRuntime=ae;return Object(x.a)(new nb.a,{hideHeader:!0,
contentProps:je,title:bd,width:Hd,location:2,onOpen:Mb,onClose:Kc,onShow:Ob,onHide:Mc,iconUrl:td,iconId:Yd,enableResize:ge,minResizeWidth:Dc,maxResizeWidth:$c})}k6(jc,bd){vb.UISurfaces.ej().then(Hd=>{jc in this.zga?Hd.setSelectedTaskPane(jc):Hd.showTaskPane(jc,bd);return null})}W5b(jc,bd){vb.UISurfaces.ej().then(Hd=>{Hd.initializeHiddenSharedRuntimeTaskPane(jc,bd);const ge=this.$.domElement;ge.addEventListener("scroll",function Kc(){0!=ge.scrollLeft&&(ge.scrollLeft=0,ge.removeEventListener("scroll",
Kc))})})}updateTaskPane(jc,bd){vb.UISurfaces.ej().then(Hd=>{Hd.updateTaskPane(jc,bd);return null})}setSelectedTaskPane(jc){vb.UISurfaces.ej().then(bd=>{bd.setSelectedTaskPane(jc);return null})}hideTaskPane(jc){vb.UISurfaces.ej().then(bd=>{bd.hideTaskPane(jc,Xa.CQj);return null})}get jc(){return this.Mz}get Ff(){return this.isVisible}get Yd(){return P.a.DBc}ag(jc,bd){return bd?!1:(this.h2f(),!0)}sh(jc){return X.DOMElementExtensions.Af(this.jc,jc)}rj(){this.$.frame.Ke.kk(this.Yd)}dk(){}xYg(){const jc=
document.createElement(ja.a.div);jc.style.height="0px";jc.style.width="0px";jc.tabIndex=-1;return jc}HNh(){var jc=X.DOMElementExtensions.getElementById(this.Mz,"tabStripFocusZone");if(jc){jc=jc.getElementsByTagName("button");for(let bd=0;bd<jc.length;bd++)if(Boolean.parse(jc[bd].getAttribute("aria-selected")))return jc[bd].getAttribute("aria-controls")}return null}k8g(jc){return(jc=window.getComputedStyle(jc,null).getPropertyValue("transition-duration"))?parseInt(jc.endsWith("ms")?parseFloat(jc):
1E3*parseFloat(jc),10):0}jfj(){const jc=document.getElementById("tabbedTaskPaneContainer");jc&&jc.addEventListener("transitionend",()=>this.cHa(-1))}hii(){vb.UISurfaces.ej().then(jc=>{let bd;jc.renderTaskPaneGroups(null,this.Mz,(bd=new gb,bd.middleContainer=this.w9a,bd.onOpen=(Hd,ge)=>{this.isVisible=!0;-1===this.hea&&(this.hea=this.k8g(ge));U.a.Qi(this.$)||(this.zga[Hd]=new Ra(X.DOMElementExtensions.tP(X.DOMElementExtensions.getElementById(ge,Xa.Edg))))},bd.onClose=Hd=>{this.isVisible=0<jc.selectors.getTabbedTaskPaneCount();
n.ULS.sendTraceTag(537014371,0,50,`Closing of ${Hd} TaskPane`);if(!this.isVisible)this.aZe(),U.a.Qi(this.$)||B.AFrameworkApplication.ra.Qa.Qe||window.requestAnimationFrame(()=>{this.d0b(this.w9a)});else if(!U.a.Qi(this.$)&&this.mM&&this.mM!==Hd){const ge=1<jc.selectors.getTabbedTaskPaneCount()?this.pdc():0,Mb=1===jc.selectors.getTabbedTaskPaneCount()?-1*this.pdc():0;this.fse(Hd,this.mM,ge,Mb)}U.a.Qi(this.$)?this.cHa(this.hea):(B.AFrameworkApplication.ra.Qa.Qe&&0>=this.hea&&this.cHa(this.hea),delete this.zga[Hd]);
delete this.yOb[Hd]},bd.onShow=(Hd,ge)=>{null!=this.Qh&&(this.Qh.stop(),this.Qh=null);this.nJc=Hd;this.eZf();1!==ge&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.hrj()},0)});U.a.Qi(this.$)?window.requestAnimationFrame(()=>{this.cHa(this.hea)}):B.AFrameworkApplication.ra.Qa.Qe&&0>=this.hea?window.requestAnimationFrame(()=>{this.cHa(this.hea)}):window.requestAnimationFrame(()=>{this.Csj(this.w9a,this.hea)})},bd.onHide=(Hd,ge,Mb)=>{const Kc=this.HNh();Kc!==Hd&&(this.Qh=this.$.Jb.Gc("UserAction",
"TaskPaneToggle"),n.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Hd} to ${Kc}`));Mb?U.a.Qi(this.$)||this.d0b(this.w9a):!U.a.Qi(this.$)&&Kc&&(Hd=1===Object.keys(this.zga).length?this.pdc():0,this.fse(this.mM,Kc,this.pdc(),Hd));this.nJc=null;Mb&&1!==ge&&this.aZe();U.a.Qi(this.$)&&window.requestAnimationFrame(()=>{this.cHa(this.hea)})},bd.setFocusCallback=(Hd,ge)=>{ge&&(this.yOb[Hd]=ge)},bd.onResizeStart=()=>{U.a.Qi(this.$)||this.$Xc(da.HelperMethods.sc(0))},bd.onResizeEnd=()=>{U.a.Qi(this.$)?
this.cHa():(this.d0b(this.w9a),this.zga[this.mM]=this.ijd(this.mM));n.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.mM} TaskPane`)},bd));B.AFrameworkApplication.ra.Qa.Qe&&!U.a.Qi(this.$)&&this.jfj();return null})}d0b(jc){this.$Xc(this.$.isChromeRtl?jc.style.left:jc.style.right)}$Xc(jc){n.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.mM}`);this.$.Xnj(jc)}cHa(jc=0){-1<jc?m.Task.delay(jc+this.$Ke).continueWith(()=>{this.$.yza(lb.a.mZ("ResetContentAreaMargin"))}):
this.$.yza(lb.a.mZ("ResetContentAreaMargin"))}fse(jc,bd,Hd,ge){bd=bd.endsWith(Xa.WXd)?bd.substring(0,bd.length-Xa.WXd.length):bd;bd=this.$8e(bd);ge=bd+ge;jc=this.$8e(jc);ge<jc&&this.$Xc(da.HelperMethods.sc(bd+Hd))}Csj(jc,bd){window.setTimeout(()=>{this.d0b(jc)},bd+this.$Ke)}pdc(){return-1!==this.YXd?this.YXd:this.YXd=X.DOMElementExtensions.tP(X.DOMElementExtensions.getElementById(this.Mz,"tabStripFocusZone"))}ijd(jc){return X.DOMElementExtensions.tP(X.DOMElementExtensions.getElementById(X.DOMElementExtensions.getElementById(this.Mz,
jc+Xa.WXd),Xa.Edg))}$8e(jc){if(jc in this.zga){const bd=this.zga[jc].width;return 0<bd?bd:this.ijd(jc)}return jc?this.ijd(jc):0}aZe(){O.h(this.$).setFocus()}hrj(){if(this.yOb[this.mM]){const jc=this.yOb[this.mM];jc&&jc(null,null)}else this.FBc.has(this.mM)||this.h2f()}h2f(){vb.UISurfaces.ej().then(jc=>{1<jc.selectors.getTabbedTaskPaneCount()?jc.focusTabbedTaskPaneArea():(jc=X.DOMElementExtensions.getElementById(this.jc,"AgaveTaskpaneCloseButtonId"))?jc.focus():(jc=X.DOMElementExtensions.rm(this.jc.querySelectorAll("button")))&&
jc.focus();return null})}eZf(){this.$.domElement.scrollLeft=0;cb.a.YMa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}hE(jc){this.addHandler(Xa.Mgb,jc)}zF(jc){this.removeHandler(Xa.Mgb,jc)}get nO(){return this.Mz}get DD(){n.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}ssb(jc,bd,Hd,ge,Mb){let Kc=jc.Aa(bd);Kc||(Kc=V.a(sb.a,Hd,jc,bd),Kc.SetScriptLoadFlavor(Mb));
ge&&Kc.YWc(ge);const Ob=""+bd;let Mc=null;const Dc=()=>{Kc.create();Mc()};this.r$b[Ob]=Mc=()=>{Kc.xuc(Dc);delete this.r$b[Ob]};Kc.u_b(Dc)}initialize(){n.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}N9f(){}yQ(){n.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}eI(){n.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}Jpe(){n.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}EYf(){n.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}Sxb(){n.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}dfd(){n.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}Fia(){n.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}FB(){n.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){n.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}xRd(){n.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(jc){const bd=
Xa.uZg(jc.Bb,jc.isChromeRtl,jc);Xa.dUg(jc,bd);return new Xa(bd,jc)}static uZg(jc,bd,Hd){const ge=document.createElement("div");ge.id=jc+E.a.EBc;U.a.Qi(Hd)?ge.classList.add(Da.a.u5j):(ge.classList.add(bd?Da.a.w5j:Da.a.v5j),B.AFrameworkApplication.ra.Qa.Qe&&ge.classList.add(Da.a.Kza));return ge}static dUg(jc,bd){jc.isMobileMode&&bd.setAttribute("aria-hidden","true");B.AFrameworkApplication.ra.Qa.Qe?document.getElementById("FarPaneRegion").appendChild(bd):(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7497951_GridLayoutCleanup")||
U.a.Qi(jc)&&bd.classList.add(Da.a.quh),document.getElementById(jc.Bb+E.a.p0a).insertBefore(bd,jc.cBa))}}Xa.qzi=300;Xa.pzi=950;Xa.CQj=2;Xa.WXd="-panel";Xa.Edg="ExcelTaskPaneContentWrapper";Xa.cag="rtpSizeChanged";Xa.fEe="rtpCollapsed";Xa.tLf="rtpAdded";Xa.Mgb="rtpVisibility";Object(c.a)(Xa,"ReactTaskPaneManager",La.a,[508,28,2]);var $a=a(97),ma=a(159),fa=a(241),eb=a(420),ua=a(85),xa=a(556);class tb extends Sys.EventArgs{constructor(){super()}}Object(c.a)(tb,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,
[]);var Qb=a(46);const pc=D.a.axh,hb=D.a.cxh,ib=`<span class='${Da.a.orb} ${D.a.dxh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class Vb extends Q.a{constructor(jc){super(document.createElement("a"));this.Pa=new La.a;this.htmlSanitizationHelper=this.gle=null;this.fd=()=>{this.enabled&&this.Pa.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=jc}JLg(jc){this.Pa.addHandler("tpButtonClicked",jc)}MVf(jc){this.Pa.removeHandler("tpButtonClicked",jc)}get D_a(){return this.domElement}get taskPane(){return this.gle}get enabled(){return super.enabled}set enabled(jc){jc!==
super.enabled&&(this.domElement.classList.toggle(D.a.VT),this.domElement.classList.toggle(hb),this.domElement.tabIndex=jc?0:-1,super.enabled=jc)}get Bl(){return this.domElement.firstChild.firstChild}dispose(){h.a.pc([this.Pa]);this.Pa=null;this.domElement&&Qb.a.Qma(this.domElement);super.dispose()}gii(jc){const bd=6===jc.Hh;var Hd=bd&&!jc.ek;Hd=String.format(ib,jc.tQ,jc.ek,Hd?d.a.current.lo(101):d.a.qe(10),D.a.$ha,Hd?String.format('style="width:24px;{0}:0px"',"left"):"");Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Ph(this.domElement,Hd):this.domElement.innerHTML=Hd;this.domElement.classList.add(pc);this.domElement.classList.add(hb);this.domElement.title=jc.tQ;this.domElement.tabIndex=0;X.DOMElementExtensions.It(this.domElement,E.a.Qs,null,null);this.gle=jc;bd&&(jc=this.taskPane,null===jc||void 0===jc?void 0:jc.gjg());w.a.instance.ta(C.a.click,this.domElement,this.fd);y.KeyInputManager.instance.Dt(this.domElement,
this.fd,u.a.Jh)}}Object(c.a)(Vb,"TaskPaneButton",Q.a,[607]);class wc extends G.a{constructor(jc,bd,Hd,ge){super(jc);this.animationManager=this.m5=this.Me=null;this.FI=this.iVa=!1;this.q7d=0;this.jb=null;this.kNc=!1;this.htmlSanitizationHelper=null;this.vz=()=>{this.zpi||(this.FB(),this.$.qf())};this.mCd=(Mb,Kc)=>{this.onButtonClick(Mb,Kc)};this.R5=()=>{this.zDc()};this.$=bd;this.htmlSanitizationHelper=ge;na.a(this.$).Xh(this);this.$.yb.Vf(this.R5);this.configuration=Hd;this.baseName=da.HelperMethods.pva(this.domElement,
this.configuration.Hdg||this.configuration.z0);this.q$b={};this.efb=[];this.Yt=[];this.pqb={};this.hle=document.getElementById(this.baseName+this.configuration.UXd);this.nO||n.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.UXd} not found`);this.REg=document.getElementById(this.baseName+this.configuration.z0);this.Mz||n.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.z0} not found`);
this.SEg=document.getElementById(this.baseName+this.configuration.ZYd);this.bL||n.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.ZYd} not found`);jc=String.format(wc.DQj,this.baseName+this.configuration.vfg,this.baseName+wc.xOb);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Ph(this.bL,jc):this.bL.innerHTML=
jc;this.F5d=document.getElementById(this.baseName+wc.xOb);this.Mye||n.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+wc.xOb} not found`);(this.oqb=document.getElementById(this.baseName+wc.xOb))||n.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+wc.xOb} not found`);this.hug=this.WHe(this.configuration.dEe,this.aEe);this.gug=this.mHe(this.configuration.bEe,qa.a.instance.ga(1295),this.v7h,this.w0a,!0);this.dwg=
this.WHe(this.configuration.nWe,this.$Dh);this.cwg=this.mHe(this.configuration.lWe,qa.a.instance.ga(1294),this.w7h,this.xJa,!1);X.DOMElementExtensions.setVisible(this.xJa,!1);w.a.instance.ta(C.a.click,this.v0a,Object(ua.a)(this,this.Hoc,"onCollapseIconClicked"));w.a.instance.ta(C.a.click,this.wJa,Object(ua.a)(this,this.Xoc,"onExpandIconClicked"));w.a.instance.ta(C.a.click,this.w0a,Object(ua.a)(this,this.Hoc,"onCollapseIconClicked"));w.a.instance.ta(C.a.click,this.xJa,Object(ua.a)(this,this.Xoc,"onExpandIconClicked"));
y.KeyInputManager.instance.ta(C.a.Sb,this.v0a,Object(ua.a)(this,this.SAf,"onCollapseIconKeyDown"));y.KeyInputManager.instance.ta(C.a.Sb,this.wJa,Object(ua.a)(this,this.xCf,"onExpandIconKeyDown"))}hE(jc){this.addHandler(wc.Mgb,jc);jc(this,new tb(this.isVisible,X.DOMElementExtensions.isVisible(this.bL)))}zF(jc){this.removeHandler(wc.Mgb,jc)}get bL(){return this.SEg}get jc(){return this.bL}get Ff(){return this.iVa}set Ff(jc){this.iVa=jc}get Mz(){return this.REg}get Yd(){return P.a.SLi}get nO(){return this.hle}get DD(){return this.Yt}get Bh(){return this.Me}get mM(){return null}get zga(){return null}get isCollapsed(){return this.FI}get Z6c(){return this.q7d}get $(){return this.jb}set $(jc){this.jb=
jc}get Mye(){return this.F5d}get v0a(){return this.gug}get wJa(){return this.cwg}get w0a(){return this.hug}get xJa(){return this.dwg}get zpi(){return this.kNc}get w7h(){return this.configuration.cEe}get v7h(){return this.configuration.mWe}ssb(jc,bd,Hd,ge,Mb){let Kc=jc.Aa(bd);Kc||(Kc=V.a(sb.a,Hd,jc,bd),Kc.SetScriptLoadFlavor(Mb));ge&&Kc.YWc(ge);const Ob=""+bd;Ob in this.q$b||Kc.Q_b(($c,td)=>{this.a6(td)});let Mc=null;const Dc=()=>{Kc.create();Mc()};this.q$b[Ob]=Mc=()=>{Kc.xuc(Dc);delete this.q$b[Ob]};
Kc.u_b(Dc)}dispose(){if(this.Yt)for(let bd=0,Hd=this.Yt.length;bd<Hd;bd++)this.Yt[bd].MVf(this.mCd),this.Yt[bd].dispose();const jc=this.q$b;for(let bd in jc)({key:bd,value:jc[bd]}).value();this.$.ea&&this.$.yb&&this.$.yb.sg(this.R5);this.oqb=this.F5d=this.hle=this.Me=this.pqb=this.efb=this.Yt=null;w.a.instance.Ba(C.a.click,this.v0a,Object(ua.a)(this,this.Hoc,"onCollapseIconClicked"));w.a.instance.Ba(C.a.click,this.wJa,Object(ua.a)(this,this.Xoc,"onExpandIconClicked"));w.a.instance.Ba(C.a.click,this.w0a,
Object(ua.a)(this,this.Hoc,"onCollapseIconClicked"));w.a.instance.Ba(C.a.click,this.xJa,Object(ua.a)(this,this.Xoc,"onExpandIconClicked"));y.KeyInputManager.instance.Ba(C.a.Sb,this.v0a,Object(ua.a)(this,this.SAf,"onCollapseIconKeyDown"));y.KeyInputManager.instance.Ba(C.a.Sb,this.wJa,Object(ua.a)(this,this.xCf,"onExpandIconKeyDown"));super.dispose()}ag(jc,bd){if(bd)return!1;this.Me&&!this.isCollapsed?(jc=this.Bh.taskPane,jc.Ff&&jc.ag(!0,!1)||X.DOMElementExtensions.setFocus(this.Bh.D_a)):X.DOMElementExtensions.setFocus(this.wJa);
return!0}sh(jc){return this.isVisible?X.DOMElementExtensions.Af(this.domElement,jc)||X.DOMElementExtensions.Af(this.domElement,X.DOMElementExtensions.Ywb(jc)):!1}rj(){}dk(){this.Me&&this.Me.taskPane.dk()}setFocusOnToolbarFirstElement(){this.isCollapsed?X.DOMElementExtensions.setFocus(this.wJa):X.DOMElementExtensions.setFocus(this.v0a)}xRd(){for(let jc=this.Yt.length-1;0<=jc;jc--)if(this.Yt[jc].isVisible){X.DOMElementExtensions.setFocus(this.Yt[jc].D_a);return}this.setFocusOnToolbarFirstElement()}Sxb(jc){const bd=
[];for(let Hd=this.Yt.length-1;0<=Hd;Hd--)this.Yt[Hd].taskPane.Hh===jc&&bd.push(this.Yt[Hd].taskPane);return bd}dfd(jc){const bd=[];for(let Hd=0;Hd<this.Yt.length;Hd++)this.Yt[Hd].taskPane.Hh===jc&&bd.push(this.Yt[Hd]);return bd}Jpe(jc){if(jc){let bd;const Hd=Object(l.a)(506,jc);Hd?(bd=new Vb(this.htmlSanitizationHelper),bd.domElement.id=this.baseName+"bt_"+jc.Hh.toString()+"_"+jc.af.InstanceId,this.oqb.appendChild(bd.domElement),this.pqb["6"]=bd,Hd.button=bd):bd=this.pqb[jc.Hh.toString()];bd.gii(jc);
bd.JLg(this.mCd);bd.isVisible=jc.Aq();bd.enabled=jc.wt();this.efb.push(jc);this.Yt.push(bd);wc.fJi(jc,this.nO);this.Bsh(bd);this.zDc()}}eI(jc,bd){let Hd;for(const ge of this.Yt)Hd=ge.taskPane,Hd.Hh===jc.Hh&&Hd==jc&&this.n3b(ge,bd)}Pua(){n.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}k6(){n.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}W5b(){n.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){n.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){n.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){n.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}N9f(jc,bd){jc?(this.kNc=!0,this.nSd(!1)):
(this.kNc=!1,this.nSd(!0),bd&&(this.FB(),this.$.qf()))}yQ(jc){if(!this.efb.includes(jc)){let Hd=null;Hd=()=>{this.gij(jc);jc.iW(Hd)};jc.kT(Hd);this.Jpe(jc);var bd=Object(l.a)(534,jc);bd&&(bd.hE(this.vz),this.vz(bd,Sys.EventArgs.Empty));if(bd=Object(l.a)(141,jc))bd.hE(this.vz),this.vz(bd,Sys.EventArgs.Empty);if(bd=Object(l.a)(578,jc))bd.hE(this.vz),this.vz(bd,Sys.EventArgs.Empty);this.raiseEvent(wc.tLf,null,jc);this.FB()}}n3b(jc,bd){if(jc.taskPane.wt()&&jc.taskPane.Aq()){if(this.Me){this.Me.domElement.classList.remove(wc.snb);
this.Me.taskPane.isVisible=!1;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Hd=Object(l.a)(506,this.Me.taskPane);Hd&&Hd.lj.BLd(Hd.af.InstanceId)}this.m5=this.Me}this.Me=jc;this.Me.taskPane.isVisible=!0;this.Me.domElement.classList.add(wc.snb);bd&&this.Fia(!1,!1);this.ugb()}}onButtonClick(jc){let bd=!1;if(this.Me!==jc){bd=!0;const Hd=jc.taskPane.jc;this.animationManager.V7i(Hd);if(this.Me){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const ge=
Object(l.a)(506,this.Me.taskPane);ge&&ge.lj.BLd(ge.af.InstanceId)}this.Me.taskPane.isVisible=!1;this.Me.domElement.classList.remove(wc.snb)}this.m5=this.Me;this.Me=jc;this.Me.domElement.classList.add(wc.snb);this.Me.taskPane.isVisible=!0;this.ugb();this.animationManager.TDh(Hd)}this.Fia(!(this.isCollapsed||bd),!1)}ugb(){const jc=this.Z6c;let bd=0;this.Me&&(bd=this.Me.taskPane.Fv?this.Me.taskPane.Fv:this.Me.taskPane.Up);bd!==jc&&(this.q7d=bd,this.isCollapsed||(this.animationManager&&this.Me?this.animationManager.x0b(this.Mz,
jc,bd,this.Bh.taskPane):this.Mz.style.width=da.HelperMethods.sc(bd)),this.NQa(),this.raiseEvent(wc.cag,null,this))}kM(jc){const bd=new Vb(this.htmlSanitizationHelper);bd.isVisible=!1;bd.domElement.id=this.baseName+"bt_"+jc.toString();this.oqb.appendChild(bd.domElement);this.pqb[jc.toString()]=bd}zDc(){if(void 0!==this.Yt&&null!==this.Yt){void 0===this.Me||null===this.Me||this.Me.taskPane.wt()||(this.Me.domElement.classList.remove(wc.snb),this.Me.taskPane.isVisible=!1,this.Me.taskPane.Aq()&&(this.m5=
this.Me),this.Me=null);var jc=null;for(let bd=0;bd<this.Yt.length;bd++)if(this.efb[bd].Aq()){const Hd=this.efb[bd].wt();(this.Yt[bd].enabled=Hd)&&!jc&&(jc=this.Yt[bd])}void 0!==this.Me&&null!==this.Me||!jc||(void 0!==this.m5&&null!==this.m5&&this.m5.taskPane.wt()&&this.m5.taskPane.Aq()?this.n3b(this.m5,!1):this.n3b(jc,!1));void 0!==xa.a(this.$)&&null!==xa.a(this.$)&&xa.a(this.$).isVisible&&void 0!==this.Me&&null!==this.Me&&1!==this.Me.taskPane.Hh&&(xa.a(this.$).isVisible=!1);void 0!==this.Me&&null!==
this.Me&&7!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(52),null===jc||void 0===jc?0:jc.isVisible)&&(jc.isVisible=!1);void 0!==this.Me&&null!==this.Me&&8!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(233))&&(jc.isVisible=!1);void 0!==this.Me&&null!==this.Me&&9!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(248))&&(jc.isVisible=!1);Z.EwaSettings.sa(264)&&void 0!==this.Me&&null!==this.Me&&12!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(302))&&(jc.isVisible=!1);Z.EwaSettings.sa(418)&&void 0!==this.Me&&null!==this.Me&&15!==
this.Me.taskPane.Hh&&(jc=this.$.da.Aa(365))&&(jc.isVisible=!1);U.a.aud(this.$)&&void 0!==this.Me&&null!==this.Me&&13!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(334))&&(jc.isVisible=!1);void 0!==this.Me&&null!==this.Me&&14!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(346))&&(jc.isVisible=!1);void 0!==this.Me&&null!==this.Me&&16!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(371))&&(jc.isVisible=!1);Z.EwaSettings.Wic()&&void 0!==this.Me&&null!==this.Me&&17!==this.Me.taskPane.Hh&&(jc=this.$.da.Aa(408))&&(jc.isVisible=
!1);this.ugb()}}yGh(jc,bd){X.DOMElementExtensions.setVisible(this.w0a,!jc);X.DOMElementExtensions.setVisible(this.xJa,jc);jc&&this.raiseEvent(wc.fEe,null,this);this.ugb();bd&&X.DOMElementExtensions.setFocus(jc?this.wJa:this.v0a)}jec(jc,bd){this.$.Zc(jc,bd,26,null)}a6(jc){jc.$N&&this.yQ(jc.$N)}gij(jc){if(jc){const bd=this.Yt.length;let Hd=!1;for(let ge=0;ge<bd;ge++){const Mb=this.Yt[ge];if(Mb.taskPane===jc){this.oqb.removeChild(Mb.D_a);delete this.pqb[jc.Hh.toString()];Array.remove(this.efb,jc);Array.remove(this.Yt,
Mb);Mb.MVf(this.mCd);Mb.taskPane.jc.parentNode.removeChild(Mb.taskPane.jc);this.Me&&this.Me.taskPane===Mb.taskPane&&(this.Me=null);this.m5&&this.m5.taskPane===Mb.taskPane&&(this.m5=null);Hd=!0;break}}Hd&&this.zDc()}}Bsh(jc){const bd=jc.taskPane.Hh,Hd=!!this.Me&&1===this.Me.taskPane.Hh;(1===bd||!Hd&&2===bd)&&this.n3b(jc,!1)}static fJi(jc,bd){const Hd=jc.jc;Hd.parentNode&&Hd.parentNode.removeChild(Hd);bd.appendChild(Hd);jc.isVisible=!1}mHe(jc,bd,Hd,ge,Mb){const Kc=document.createElement("a");Kc.setAttribute(E.a.sT,
Mb?E.a.Uj:E.a.pq);Kc.setAttribute(E.a.Cd,E.a.Qs);Kc.tabIndex=0;Kc.classList.add(Da.a.Or);Kc.classList.add(jc);Kc.classList.add(D.a.$wh);jc=String.format(wc.b4g,bd,Hd,d.a.qe(10));Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Ph(Kc,jc):Kc.innerHTML=jc;ge.appendChild(Kc);return Kc}}wc.Mgb="tpVisibility";wc.DQj=`<div id='{0}' class='${D.a.fxh}'><div id='{1}' class='${D.a.exh}'></div></div>`;
wc.b4g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";wc.xOb="novTaskpaneButtonGroup";wc.snb=D.a.bxh;wc.cag="tpSizeChanged";wc.fEe="tpCollapsed";wc.tLf="tpAdded";Object(c.a)(wc,"TaskPaneControl",G.a,[508,28,2]);var Lc=a(49),Fc=a(370),fd=a(724);class Ta{constructor(){this.mWe=this.cEe=this.lWe=this.bEe=this.nWe=this.dEe=this.vfg=this.ZYd=this.UXd=this.z0=this.Hdg=null}}Object(c.a)(Ta,"Configuration",null,[]);a(434);var Fb=a(297);class ic extends Fb.a{constructor(jc){super(5,jc)}}Object(c.a)(ic,
"ResizeAnimationEvent",Fb.a,[]);var zb=a(473),Bb=a(590),ec=a(102);class Qd{constructor(jc,bd){this.Idg=null;this.$=bd;this.taskPane=jc}LDh(){this.Idg=X.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Bb+E.a.qBd);const jc=Qd.x6c(this.taskPane),bd=Qd.x6c(this.Idg),Hd=Bb.a(ec.a.Pl);Hd.animate(jc,E.a.Kyc);Hd.animate(bd,E.a.Kyc)}V7i(jc){jc.style.opacity="0"}TDh(jc){Bb.a(ec.a.Pl).animate(Qd.x6c(jc),E.a.Kyc)}x0b(jc,bd,Hd,ge){bd||(ge.isVisible=!0);this.$.NQa(Hd);Bb.a(ec.a.Pl).animate(Qd.fgh(jc,
bd,Hd),E.a.Kyc,null,null,()=>{this.$.bAa();Hd||1===ge.Hh||(ge.isVisible=!1);ge.BV(Hd<bd)})}static fgh(jc,bd,Hd){jc=new ic(jc);jc.cRg(bd,Hd);return jc}static x6c(jc){jc=new zb.a(jc);jc.ZI(0,1);return jc}}Object(c.a)(Qd,"TaskPaneAnimationManager",null,[546]);const fc=`<div id="{0}" class="${D.a.jxh}" runat="server"></div></div><div id="{1}" class="${D.a.ixh} ${D.a.fo}" runat="server"></div>`,cd=`<button type="button" id="{0}" class="${D.a.gxh}"></button><span><div id="{1}" class="${D.a.hxh}"></div></span>`,
jd=D.a.Uwh;class nd extends wc{constructor(jc,bd,Hd,ge){super(jc,Hd,nd.Wbh(),ge);this.frc=null;this.vtd=!1;this.VR=null;this.gXi=Mb=>{var Kc=!1;if(9===Mb.Ea.keyCode){Kc=this.Bh.taskPane.OU(Mb,this.bL);if(!Kc){Kc=this.$.da.Aa(52);var Ob=this.domElement.querySelectorAll(this.Bh.taskPane===Kc?Kc.kr:Fc.a.a3i);Kc=X.DOMElementExtensions.rm(Ob);Ob=X.DOMElementExtensions.LA(Ob);Kc=X.DOMElementExtensions.CAa(Mb.Ea,Kc,Ob)}return Kc}Ob=$a.FocusManager.instance().Sh;if(null===Ob||void 0===Ob?0:Ob.dN)return Kc;
27===Mb.Ea.keyCode&&this.Bh.taskPane.Kg(!1);return Kc};this.dd=()=>{this.bL.style.bottom=this.Mz.style.bottom=this.$.qd&4&&!B.AFrameworkApplication.ra.Qa.Qe?da.HelperMethods.sc(this.$.dea):"0";this.FB()};this.hHf=Mb=>{Object(eb.a)(506,this.Bh.taskPane)&&(this.Bh.taskPane.oGa.firstChild.style[E.a.pointerEvents]="none");this.vtd=!0;this.VR=this.ixb(Mb.clientPoint);ma.a.instance.ta(C.a.Tf,this.domElement.ownerDocument.body,this.bqc);ma.a.instance.ta(C.a.ve,this.domElement.ownerDocument.body,this.cqc);
fa.a.instance.ta(C.a.yj,this.domElement.ownerDocument.body,this.bqc);fa.a.instance.ta(C.a.Kf,this.domElement.ownerDocument.body,this.cqc);return!0};this.cqc=()=>{Object(eb.a)(506,this.Bh.taskPane)&&(this.Bh.taskPane.oGa.firstChild.style[E.a.pointerEvents]="");this.vtd=!1;ma.a.instance.Ba(C.a.Tf,this.domElement.ownerDocument.body,this.bqc);ma.a.instance.Ba(C.a.ve,this.domElement.ownerDocument.body,this.cqc);fa.a.instance.Ba(C.a.yj,this.domElement.ownerDocument.body,this.bqc);fa.a.instance.Ba(C.a.Kf,
this.domElement.ownerDocument.body,this.cqc);return!0};this.bqc=Mb=>{this.vtd&&(Mb=this.ixb(Mb.clientPoint),Mb=fd.a.CD(Mb,this.VR),this.gte(Mb.x));return!0};this.lYi=Mb=>{void 0!==Mb.Ea&&null!==Mb.Ea&&(9===Mb.Ea.keyCode?Mb.Ea.shiftKey?(Mb=Object(eb.a)(28,this.Bh.taskPane)?this.Bh.taskPane:null)&&Mb.ag(!1,!1):this.setFocusOnToolbarFirstElement():37!==Mb.Ea.keyCode&&39!==Mb.Ea.keyCode||this.gte(37===Mb.Ea.keyCode?-20:20));return!0};this.$.domElement.classList.add(jd);this.Fdg=bd;this.initialize();y.KeyInputManager.instance.ta(C.a.Sb,
this.domElement,this.gXi);this.zOb=X.DOMElementExtensions.getElementById(bd.parentNode,this.$.Bb+E.a.Tnc);this.HBc=X.DOMElementExtensions.getElementById(bd.parentNode,this.$.Bb+E.a.byf);this.zOb.title=qa.a.instance.ga(2230);ma.a.instance.ta(C.a.pf,this.HBc,this.hHf);fa.a.instance.ta(C.a.pointerDown,this.HBc,this.hHf);y.KeyInputManager.instance.ta(C.a.Sb,this.zOb,this.lYi)}get Yd(){return P.a.DBc}get aEe(){return this.bL}get $Dh(){return this.aEe}ugb(){super.ugb();this.zOb&&(this.Bh&&this.Bh.taskPane.isResizable?
(this.zOb.style.display="block",this.HBc.style.display="block"):(this.zOb.style.display="none",this.HBc.style.display="none"))}get uCc(){const jc=this.bL;return jc&&X.DOMElementExtensions.isVisible(jc)?Fc.a.uCc:0}EYf(jc){jc&&(this.animationManager=jc);this.snj();this.animationManager=jc||new Qd(this.Mz,this.$);this.animationManager.LDh()}dispose(){this.frc&&this.frc.zF(this.vz);xa.a(this.$)&&xa.a(this.$).zF(this.vz);const jc=this.$.da.Aa(52);jc&&jc.zF(this.vz);this.$.pl(this.dd);h.a.pc([this.frc]);
this.frc=null;super.dispose()}initialize(){this.EYf(null);this.kM(0);this.kM(1);this.kM(2);this.kM(7);this.kM(8);this.kM(9);this.kM(10);Z.EwaSettings.sa(264)&&this.kM(12);Z.EwaSettings.sa(418)&&this.kM(15);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.kM(13):U.a.aud(this.$)&&this.kM(13);this.kM(14);this.kM(16);Z.EwaSettings.Wic()&&this.kM(17);Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.kM(18);
this.FB()}FB(){var jc=0;let bd=0;for(let Hd=this.DD.length-1;0<=Hd;Hd--){const ge=this.DD[Hd].taskPane.Aq(),Mb=this.DD[Hd].taskPane;if(this.DD[Hd].isVisible=ge)bd++,(1!==Mb.Hh&&(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Mb.Hh)&&14!==Mb.Hh&&16!==Mb.Hh||Mb.wt())&&jc++}jc=0<jc;X.DOMElementExtensions.setVisible(this.bL,jc);this.nSd(jc);X.DOMElementExtensions.setVisible(this.xJa,jc&&this.isCollapsed);X.DOMElementExtensions.setVisible(this.w0a,jc&&
!this.isCollapsed);X.DOMElementExtensions.setVisible(this.Mye,1<bd);this.zDc()}Fia(jc,bd){if(this.isCollapsed!==jc){jc||(this.Fdg.style.display=B.AFrameworkApplication.ra.Qa.Qe?"flex":"block");var Hd=this.Z6c;this.FI=!this.isCollapsed;var ge=jc?Hd:0;Hd=jc?0:Hd;this.Bh&&(this.animationManager.x0b(this.Mz,ge,Hd,this.Bh.taskPane),this.NQa());jc&&(this.Fdg.style.display="none");this.yGh(jc,bd)}}nSd(jc){const bd=this.isVisible!==jc;this.Ff=jc;X.DOMElementExtensions.setVisible(this.domElement,jc);bd&&(B.AFrameworkApplication.ra.Qa.Qe&&
X.DOMElementExtensions.toggleCssClass(this.domElement,D.a.Jwh,jc),this.NQa(),this.raiseEvent(wc.Mgb,new tb(jc,jc),this))}Hoc(jc){if(jc.Mb===this.w0a&&3!==jc.ub)return!1;this.jec(296943390,jc.ub);this.Fia(!0,!0);return!0}Xoc(jc){if(jc.Mb===this.xJa&&3!==jc.ub)return!1;this.jec(-625072140,jc.ub);this.Fia(!1,!0);return!0}SAf(jc){return 13===jc.Ea.keyCode?(this.jec(296943390,jc.ub),this.Fia(!0,!0),!0):!1}xCf(jc){return 13===jc.Ea.keyCode?(this.jec(-625072140,jc.ub),this.Fia(!1,!0),!0):!1}NQa(){let jc=
0;this.$.qd&262144&&(jc+=this.uCc,X.DOMElementExtensions.isVisible(this.Mz)&&!this.isCollapsed&&(jc+=this.Z6c));this.$.NQa(jc)}WHe(jc,bd){const Hd=document.createElement("div");Hd.classList.add(jc);bd.insertBefore(Hd,bd.firstChild);return Hd}snj(){const jc=this.domElement;let bd=document.getElementById(this.$.Bb+E.a.p0a);B.AFrameworkApplication.ra.Qa.Qe&&(bd=document.getElementById("FarPaneRegion"));jc.parentNode&&jc.parentNode!==bd&&jc.parentNode.removeChild(jc);bd.appendChild(jc);this.fai()}fai(){const jc=
this.Mz,bd=this.bL,Hd=this.$.ea;jc.style.right="0";B.AFrameworkApplication.ra.Qa.Qe||(jc.style.marginRight=da.HelperMethods.sc(Fc.a.uCc));jc.style.bottom=this.$.qd&4&&!B.AFrameworkApplication.ra.Qa.Qe?da.HelperMethods.sc(this.$.dea):"0";this.nO.style.bottom="0";bd.style.right="0";this.$.Lk(this.dd);Hd.wH&&this.dd(null,null)}ixb(jc){const bd=new Lc.a(0,0);return fd.a.Gu(bd,this.Mz,jc,!1)}gte(jc){const bd=this.Mz.offsetWidth;jc=bd-jc;jc<this.Bh.taskPane.Up?jc=this.Bh.taskPane.Up:950<jc&&(jc=950);this.Bh.taskPane.Fv=
jc;const Hd=new Qd(this.Mz,this.$);Hd.x0b(this.Mz,bd,jc,this.Bh.taskPane);Object(eb.a)(506,this.Bh.taskPane)||Hd.x0b(this.Bh.taskPane.jc,bd,jc,this.Bh.taskPane);this.$.NQa(this.bL.offsetWidth+jc);this.$.yza(lb.a.mZ("AnimateTaskpaneResize"))}static ka(jc,bd){let Hd=null;jc.Jb&&(Hd=jc.Jb.zg("ComponentAttach","AttachTaskPanePickerControl"),Hd.start());const ge=nd.wZg(jc.Bb),Mb=nd.vZg(jc.Bb,bd),Kc=nd.xZg(jc.Bb);ge.appendChild(Kc);ge.appendChild(Mb);nd.eUg(jc,ge);jc=new nd(ge,Mb,jc,bd);Hd&&Hd.stop();return jc}static wZg(jc){const bd=
document.createElement("div");bd.id=jc+E.a.EBc;return bd}static vZg(jc,bd){const Hd=document.createElement("div");Hd.id=jc+E.a.ayf;Hd.className=D.a.Vwh;let ge=String.format(fc,jc+E.a.QLi,jc+E.a.vV);ge+=String.format(cd,jc+E.a.Tnc,jc+E.a.byf);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?bd.Ph(Hd,ge):Hd.innerHTML=ge;B.AFrameworkApplication.ra.Qa.Qe&&X.DOMElementExtensions.toggleCssClass(Hd,
D.a.Kza,!0);return Hd}static xZg(jc){const bd=document.createElement("div");bd.id=jc+E.a.qBd;bd.className=D.a.Tyh;bd.style.zIndex="100";B.AFrameworkApplication.ra.Qa.Qe&&X.DOMElementExtensions.toggleCssClass(bd,D.a.Kza,!0);return bd}static eUg(jc,bd){(B.AFrameworkApplication.ra.Qa.Qe?document.getElementById("FarPaneRegion"):document.getElementById(jc.Bb+E.a.p0a)).appendChild(bd)}static Wbh(){const jc=new Ta;jc.Hdg=E.a.EBc;jc.z0=E.a.ayf;jc.UXd=E.a.vV;jc.ZYd=E.a.qBd;jc.vfg=E.a.RLi;jc.dEe=D.a.Xwh;jc.nWe=
D.a.Zwh;jc.bEe=D.a.Wwh;jc.lWe=D.a.Ywh;jc.cEe=D.a.VUe;jc.mWe=D.a.WUe;return jc}}Object(c.a)(nd,"TaskPanePickerControl",wc,[]);var vd=a(712);class wd extends v.a{constructor(jc){super();this.$=jc;this.Db()}create(){if(U.a.Ad(this.$))this.wKd(()=>Xa.ka(this.$));else if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const jc=kb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);A.TaskExtensions.za(jc,
()=>{this.wKd(()=>nd.ka(this.$,jc.result))},this.la,3)}else this.wKd(()=>nd.ka(this.$,null))}static ka(jc){jc.da.Ha(50,new wd(jc))}wKd(jc){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7377510_InitializingTPSlicePI")?(jc=Object(vd.a)(this.$.da,183,jc),this.nb(jc)):this.nb(jc())}}Object(c.a)(wd,"TaskPaneManagerFactory",v.a,[]);class Td extends e.a{constructor(jc){super(jc);this.yt=()=>{this.$.ea.NN(this.yt);this.dJe()};this.$=jc}dJe(){const jc=this.$.da;jc.Ha(72,new Ma(this.$));jc.Ha(77,new mb(this.$));
wd.ka(this.$);ya.ka(this.$)}static main(){f.a.Fa(jc=>{b.a.Mdf(jc.domElement.ownerDocument,d.a.current.lo(96),()=>{jc.ZH()});const bd=new Td(jc);jc.ea.qv?bd.dJe():jc.ea.dP(bd.yt)})}}Object(c.a)(Td,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");Td.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/85ee34f163831c494562228a9f8b774b/EwaDSEsNext.tp.js.map