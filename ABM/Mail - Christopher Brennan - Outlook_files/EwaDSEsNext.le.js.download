'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1259:function(t,F,a){t=a(0);var c=a(7),b=a(15),e=a(27),f=a(89),d=a(14),h=a(84),m=a(420),l=a(81),v=a(8),r=a(64),A=a(461);class x{constructor(Z,da){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=da;this.parentElement=Z}sbh(){const Z=this.tbh();A.a(this.$,243,242,0,da=>{this.cardViewManager=da;da.u9f(this.parentElement,2,
Z)})}Tbf(){this.cardViewManager&&this.cardViewManager.wLa(-1,-1,this.parentElement)}tbh(){const Z={layoutId:"AutoDetectTooltip"};Z.description=this.longDescription;Z.convertToDomainName=this.convertToDomainName;Z.longDescription=this.longDescription;Z.urlValue=this.urlValue;Z.imageAltText=this.imageAltText;Z.helpText=this.helpText;Z.helpId=this.helpId;return Z}}Object(t.a)(x,"AutoDetectCardManager",null,[]);var n=a(31),u=a(194),z=a(30),w=a(227),C=a(19),y=a(51),B=a(1);class H extends l.a{constructor(Z,
da,qa){super();this.fd=O=>{if(O.Mb.id===this.Nta.firstChild.id){O=this.wwe;const ca={};ca.Id=O.Gpb;this.convertToLinkedEntityManager.G4c(ca,!0,O);this.Nta.removeChild(this.Nta.firstChild);return!0}return!1};this.wwe=Z;this.convertToLinkedEntityManager=da;this.Nta=document.createElement("div");this.Nta.className="clip16x16";this.oka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.yg("autodetectid"+this.wwe.left),C.a.Kad,
y.a.qe(11));B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?qa.Ph(this.Nta,this.oka):this.Nta.innerHTML=this.oka;Z=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");w.a.instance.ta(d.a.click,Z,this.fd)}get domElement(){return this.Nta}dispose(){if(this.Nta){const Z=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");w.a.instance.Ba(d.a.click,
Z,this.fd)}super.dispose()}static get XZg(){return"clip16x16"}}Object(t.a)(H,"AutoDetectColumnHeaderButton",l.a,[]);var I=a(1109),R=a(11),S=a(21),G=a(179);class D extends l.a{constructor(Z,da,qa){super();this.htmlSanitizationHelper=null;this.$=Z;this.gridView=S.h(Z);this.convertToLinkedEntityManager=da;this.htmlSanitizationHelper=qa;this.r3c=new G.a}dispose(){super.dispose()}unh(Z){for(let da of this.gridView.Hha)for(let qa of da){const O=qa,ca=O.qt,wa=I.a(O.j4);this.qIg(Z,wa,ca);O.ERd(wa)}}qIg(Z,
da,qa){if(da.length){var O=qa.length;qa[O-1]<Z.left||(qa=R.HelperMethods.Xu(new u.a(qa),0,O,Z.left,R.HelperMethods.qz),0>qa||!(da=da[qa]))||(this.gridView.rtl?da.classList.add(n.a.QAh):da.classList.add(n.a.PAh),this.r3c.hb(Z.left)||this.r3c.add(Z.left,new H(Z,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),Z=this.r3c.ma(Z.left).domElement,!da.getElementsByClassName(H.XZg).length&&this.ZLj(da)&&da.appendChild(Z))}}ZLj(Z){const da=parseInt(Z.style.width,10);var qa=document.querySelector(".ewrch-col-cellsel")?
"bold":"normal";qa=D.edh(qa);Z=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.n2h(Z.firstChild.innerHTML),qa,!0,B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<da-(da/2+Z/2)?!0:!1}static edh(Z){return`${"normal"} ${"normal"} ${Z} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(t.a)(D,"AutoDetectColumnHeaderManager",l.a,[]);var E=a(429),M=a(24),L=a(65),N=a(140),Y=a(12),U=a(13),
P=a(145),aa=a(70);a.d(F,"a",function(){return X});class X extends l.a{constructor(Z,da,qa,O,ca){super();this.isMac=e.a.isMac;this.yYa=-1;this.j6b=null;this.mta=-1;this.eN=this.qkc=this.iVd=this.$Z=this.xwe=!1;this.uT=null;this.Xg=()=>{this.uwa&&this.gridView&&this.HW()};this.uc=()=>{this.Vx()};this.fd=()=>{this.VHa();S.h(this.$).ag(!0,!1)};this.Eya=(ia,Ha)=>{Ha?(this.Iig(this.j6b),this.veb()):(ia=[29],this.gridView.Cb.Nj(ia),this.gridView.Cb.wk(null,ia),this.uT&&this.uT.Tbf())};this.wj=()=>{this.j7a()&&
this.wh.hide();1===this.gridView.ha.Oe&&this.HW()};this.bR=()=>{const ia=this.gridView.ha.Oe;this.gridView.ha.qa.activeCell&&1===ia&&this.HW()};this.onKeyUp=ia=>this.bDb?this.$Z?!1:17===ia.Ea.keyCode&&this.iVd?(this.eN?(this.veb(),this.Ada()):this.jMb(),!0):!1:this.$Z=!1;this.onKeyDown=ia=>{if(!this.bDb)return this.$Z=!1;this.iVd=!1;this.$Z=ia.ctrlKey;switch(ia.Ea.keyCode){case 27:return this.eN?(this.Eya(null,!1),this.Ada()):this.uT&&(this.uT.Tbf(),this.jMb()),!0;case 13:if(this.eN)return this.eN=
!1,this.VHa(),!0;break;case 17:return this.iVd=!0}return!1};const {AutoDetectActionButton:wa}=a(1371);this.$=Z;this.Hpb=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);da||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=O;O.UHb();this.wh=new wa(Z,da,this.fd,qa,"");this.CUg=new D(this.$,O,ca);this.gridView=S.h(this.$);this.gridView.ha.lT(this.Xg);this.gridView.Vb.PYa(this.Xg);
this.gridView.Uu(this.bR);Z.nj(this.uc);Z.bC(this.wj);this.gridBlockManager=Object(h.a)(776,this.gridView.Ca);this.qo=Z.frame.Lt;this.HW()}get jc(){return this.wh.domElement(1)}get bDb(){const Z=this.wh.domElement(X.Dea);return Z?Y.DOMElementExtensions.isVisible(Z):!1}get uwa(){return this.$.isEditMode&&B.EwaSettings.sa(128)&&B.EwaSettings.sa(131)&&(new N.a(this.$.va)).Nh?!1:-1!==this.mta}dispose(){this.gridView&&this.gridView.ha.tR(this.Xg);if(this.$){const Z=this.$;Z.ol(this.uc);Z.xF(this.wj);S.h(Z).jy(this.bR)}f.a.Ja(this.wh);
this.qo=this.$=this.gridView=this.wh=null;super.dispose()}Vx(){this.Eya(null,!1);this.yYa=-1;this.wh.hide();this.tXj();this.eN=!1}Ada(){this.wh.getButton(X.Dea).Ecb();this.eN=!1}jMb(){this.wh.getButton(X.Dea).PHb();this.Iig(this.j6b);this.eN=!0;this.$.da.gb(211,Z=>{Z.cQa(U.a.instance.ga(1748))})}onAutoDetectUIShown(){if(this.uwa&&-1!==this.yYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}DUg(Z){var da=new M.Range(1===Z.top?1:Z.top-1,Z.left,Z.bottom,Z.right,!0,!1);da=this.gridView.getRangeInformation(da);
for(const qa of da)if(Object(m.a)(E.AutoDetectRange,qa)&&this.$gc(Z,!1,qa))return!0;return!1}VHa(){if(this.uwa&&-1!==this.yYa){this.wh.getButton(X.Dea).PHb();var Z={};Z.Id=this.mta;Z.StringId=null;this.convertToLinkedEntityManager.G4c(Z,!0,this.j6b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Z=[Object(c.a)(new aa.a,{name:"Domain",int64:this.mta})];P.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,Z);this.mta=-1}}UPh(){let Z=U.a.instance.ga(1744);
if(-1!==this.mta){Z+=" ";try{Z+=this.convertToLinkedEntityManager.zCb(this.mta.toString())}catch(da){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.mta}`)}}Z+=" ";return Z=this.Hpb?Z+U.a.instance.ga(1747):Z+U.a.instance.ga(this.isMac?1746:1745)}veb(){this.Hpb&&(this.uT||(this.uT=new x(this.jc,this.$),this.uT.convertToDomainName=U.a.instance.ga(1749),this.uT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",
this.uT.imageAltText=U.a.instance.ga(1751),this.uT.helpId="HID_DataTypes_Wolfram",this.uT.helpText=U.a.instance.ga(1750)),this.uT.longDescription=this.convertToLinkedEntityManager.dZd(this.yYa.toString()),this.uT.sbh())}$gc(Z,da,qa){if((new M.Range(qa.top,qa.left,qa.bottom===v.a.Vg?qa.bottom:qa.bottom+1,qa.right,!0,!1)).zd(Z)){if(da){if(qa&&qa.Gpb!==this.yYa){this.yYa=qa.Gpb;Z=qa.Gpb.toString();da=this.Hpb?"":this.convertToLinkedEntityManager.dZd(Z);const O=this.convertToLinkedEntityManager.zdi(Z);
this.wh.vgb(this.convertToLinkedEntityManager.zCb(Z),da,O,X.Dea)}this.mta=qa.Gpb;this.j6b=qa}return!0}return!1}HW(){if(this.convertToLinkedEntityManager){var Z=this.gridView.ha.Oe;if(this.gridBlockManager&&this.gridBlockManager.Zkd){var da=this.gridView.ha.qa.activeCell,qa=!this.gridBlockManager.Ur(da),O=this.gridView.getRangeInformation(this.gridView.fi);for(const ca of O)if(Object(m.a)(E.AutoDetectRange,ca))switch(O=ca,O.k4g){case 3:if(this.$gc(da,!0,O)){if(1!==Z||qa){this.Vx();return}b.ULS.sendTraceTag(537166981,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.IKd();this.wh.SAa(da,this.Eya);this.xwe||(this.xwe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.CUg.unh(O);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Vx()}}Iig(Z){const da=
[29];this.gridView.Cb.wk(Z,da);this.gridView.Cb.Nq(da)}j7a(){return this.$.ea.isNamedObjectViewMode&&L.f(this.$.na)}IKd(){this.Hpb&&!this.qkc&&this.qo&&(this.qo.ms(d.a.Sb,this.$.domElement,this.onKeyDown,!0),this.qo.ms(d.a.Kd,this.$.domElement,this.onKeyUp,!0),this.qkc=!0)}tXj(){this.Hpb&&this.qkc&&this.qo&&(this.qo.ys(d.a.Sb,this.$.domElement,this.onKeyDown,!0),this.qo.ys(d.a.Kd,this.$.domElement,this.onKeyUp,!0),this.qkc=!1)}static get Dea(){return 1}static cSh(Z){return U.a.instance.ga(1805)+r.a.space+
Z}}Object(t.a)(X,"AutoDetectManager",l.a,[])},1371:function(t,F,a){a.r(F);a.d(F,"AutoDetectActionButton",function(){return d});t=a(0);F=a(81);var c=a(1259),b=a(51),e=a(13),f=a(21);class d extends F.a{constructor(h,m,l,v,r){super();this.$=h;this.$n=v.R5b(h,m,l,"",b.a.qe(11),r,"AutoDetectPointerDown",e.a.instance.ga(1805)+"...")}get Zy(){return this.$n.Zy}dispose(){this.$n.dispose();this.$=null;super.dispose()}domElement(h){return this.$n.domElement(h)}getButton(h){return this.$n.getButton(h,!1)}vgb(h,
m,l,v){this.$n.gUa(c.a.cSh(h),m,v);this.$n.Ejg(l,m,v)}SAa(h,m){const l=f.h(this.$),v=l.ib.yi(h);h=l.xg(h,v);const r=l.Rf(v).yn;if(h&&0<=h.x&&0<=h.y&&r.width>h.width+160){let A=h.bottomRight.x+this.Zy,x=h.topLeft.y+this.Zy,n=!1;A+160>r.bottomRight.x&&(A=h.topLeft.x-this.Zy,n=!0);if(x<r.topLeft.y+this.Zy){if(l.ib.BBa){this.hide();return}x=r.topLeft.y+this.Zy}this.$n.Q8b(m,v);this.rp(A,x,l.rtl,v,n)}else this.hide()}rp(h,m,l,v,r){this.$n.rp(h,m,l,v,!1,r)}hide(){this.$n.hide()}}Object(t.a)(d,"AutoDetectActionButton",
F.a,[])},1479:function(t,F,a){a.r(F);t=a(0);var c=a(709),b=a(15),e=a(5),f=a(68),d=a(37),h=a(1),m=a(188),l=a(21),v=a(145);class r{constructor(N,Y){this.$=Y;this.convertToLinkedEntityManager=N}Hc(N,Y){switch(Y){case -1203788282:case 48568533:case -1662108744:return N=l.h(this.$),Y=this.convertToLinkedEntityManager.wHi||7E3,(null===N||void 0===N?0:N.ha)&&N.ha.qa.ld.Ny>Y?!0:!1;default:return!1}}executeCommand(N,Y,U){N=d.TaskExtensions.Tj();Y=Y.command;switch(Y){case -1203788282:this.convertToLinkedEntityManager.M$g(U[f.a.Kc].toString());
break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(U[f.a.Kc].toString());break;case 1266950951:this.convertToLinkedEntityManager.uyi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();
break;case -1081442996:this.convertToLinkedEntityManager.rPe();break;case 1702917262:this.convertToLinkedEntityManager.showHelpArticle(e.a.NYj);break;case -90814711:this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===Y||U[f.a.Vpf]&&"ConvertToLinkedEntityGallery"===U[f.a.Vpf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),v.a("ExpandDataTypeGallery");
break;default:N=m.a(Y)}return N}wc(N,Y){switch(Y.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.sa(123);case -1081442996:case 1702917262:case -90814711:case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Mc(N,Y,U){return"PopulateConvertToLinkedEntityMenu"===Y&&h.EwaSettings.sa(123)?this.convertToLinkedEntityManager.Mc(N,Y,U):!1}}Object(t.a)(r,"ConvertToLinkedEntityCommandHandler",null,[221]);var A=a(461);
class x extends c.a{constructor(N){super(N)}hd(){A.a(this.$,271,272,this.Xa,N=>{this.$c([new r(N,this.$)])})}static ka(N){c.a.Ld(273,new x(N))}}Object(t.a)(x,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var n=a(55);F=a(226);var u=a(772),z=a(50),w=a(421),C=a(712);class y extends F.a{constructor(N){super();this.$=N;this.Db()}create(){const N=z.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.Xa),Y=z.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Xa),U=z.GetServiceTaskFactory.Oa(this.$.da,
388,387,this.Xa),P=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?z.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):n.Task.Ra(null),aa=z.GetServiceTaskFactory.Oa(this.$.da,257,258,this.Xa),X=w.a(this.$);d.TaskExtensions.za(d.TaskExtensions.Fd([N,aa,X,Y,U,P],this.la),()=>{this.nb(Object(C.a)(this.$.da,271,()=>new u.ConvertToLinkedEntityManager(this.$,N.result,U.result,
aa.result,X.result,Y.result,P.result)))},this.$.la,3)}static ka(N){N.da.Ha(272,new y(N))}}Object(t.a)(y,"ConvertToLinkedEntityManagerFactory",F.a,[]);var B=a(239),H=a(264),I=a(33),R=a(251),S=a(12),G=a(719);const D=a(19).a.xAh;class E extends B.a{constructor(N,Y,U){super(N);this.Fv=0;this.Bs=!1;this.uc=()=>{this.Kg(!1)};this.$=Y;this.taskPaneManager=U;H.a(Y).Xh(this);this.$.nj(this.uc);I.a.Ad(this.$)&&(this.isVisible=!1)}kT(N){this.get_events().addHandler("EnrichmentTaskPaneRemoved",N)}iW(N){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",
N)}hE(N){this.addHandler("EnrichmentTaskPaneVilibilityChanged",N)}zF(N){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",N)}JNg(N){this.addHandler("EnrichmentTaskPaneOnFocus",N)}lkj(N){this.removeHandler("EnrichmentTaskPaneOnFocus",N)}get isVisible(){return super.isVisible}set isVisible(N){super.isVisible=N;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Ff(){return this.isVisible}get Yd(){return R.a.lsh}get Hh(){return 10}get ek(){return D}get tQ(){return this.titleText}get titleText(){return"Enrichment"}get Up(){return 300}get isResizable(){return!1}get jc(){return this.domElement}get height(){return this.taskPaneManager.nO.offsetHeight}get CB(){return this.taskPaneManager.Pua(this.jc,
this.titleText,this.Up,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Up)}Aq(){return this.Bs}wt(){return this.Bs}BV(){}dispose(){this.$&&this.$.ol(this.uc);this.taskPaneManager=this.$=null;super.dispose()}ag(N,Y){Y||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!Y}sh(N){return S.DOMElementExtensions.Af(this.jc,N)}rj(){}dk(){}Kg(N){this.Bs=N;const Y=this.taskPaneManager;this.isVisible=N;I.a.Ad(this.$)?N?this.taskPaneManager.k6("EnrichmentTaskPane",
this.CB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(N&&0<Y.DD.length&&(!Y.Bh||10!==Y.Bh.taskPane.Hh||Y.isCollapsed)&&Y.eI(this,!0),Y.FB());N||(l.h(this.$).ag(!0,!1),this.$.qf())}OU(){return!1}static ka(N,Y){var U=N.Bb;let P=document.getElementById(U+e.a.OPe);P||(P=G.a("div",N.Bb+e.a.OPe,"cui-taskpane"),I.a.Ad(N)||(U=document.getElementById(U+e.a.vV),void 0!==U&&null!==U?U.appendChild(P):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${N.VC}`)));
U=N.da;return U.Aa(257)||U.Ha(257,new E(P,N,Y))}}Object(t.a)(E,"EnrichmentTaskPane",B.a,[713,2,510,28]);class M extends F.a{constructor(N){super();this.Yg=this.Yh=null;this.$=N;this.Db()}get mD(){this.Yh||(this.Yh=d.TaskExtensions.za(w.a(this.$),N=>{this.Yg=E.ka(this.$,N.result)},this.la,3));return this.Yh}create(){const N=z.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Xa),Y=z.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa);d.TaskExtensions.za(d.TaskExtensions.ts(d.TaskExtensions.Fd([N,
Y],this.la),()=>this.mD,this.la),()=>{this.nb(this.Yg)},this.la,3)}dispose(){this.Yg=this.Yh=this.$=null;super.dispose()}static ka(N){N.da.Ha(258,new M(N))}}Object(t.a)(M,"EnrichmentTaskPaneFactory",F.a,[]);var L=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{L.a.Fa(N=>{M.ka(N);y.ka(N);x.ka(N)})})()},772:function(t,F,a){a.r(F);var c=a(0),b=a(15),e=a(89),f=a(268),d=a(4),h=a(30),m=a(843),l=a(137),v=a(83),r=a(38),A=a(19),x=a(5),n=a(165),u=a(1259),z=a(1262),
w=a(174),C=a(557),y=a(348),B=a(60);const H=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"GetRichDataClassificationLabels",Fc,ib,Vb,wc,Lc,4)},I=(hb,ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=hb.Na(1,Fb);Fb.selectedRanges=ib;Fb.domainId=Vb;Fb.autodetect=wc;return B.g(hb,"ConvertToLinkedEntity",Fb,Lc,Fc,fd,Ta,4)},R=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"OnAutoDetectUIShown",Fc,ib,Vb,wc,Lc,4)},S=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"GetLinkedEntityMetadata",Fc,
ib,Vb,wc,Lc,4)},G=(hb,ib,Vb,wc,Lc,Fc,fd=null)=>{fd=hb.Na(1,fd);fd.selectedRanges=ib;return B.g(hb,"ConvertLinkedEntityToText",fd,Vb,wc,Lc,Fc,4)},D=(hb,ib,Vb,wc,Lc,Fc,fd=null)=>{fd=hb.Na(1,fd);fd.selectedRanges=ib;return B.g(hb,"RefreshLinkedEntitiesInRange",fd,Vb,wc,Lc,Fc,4)},E=(hb,ib,Vb,wc,Lc,Fc,fd,Ta,Fb,ic,zb=null)=>{zb=hb.Na(1,zb);zb.selectedRanges=ib;zb.isChangeObject=Vb;zb.isFloodgateEnabled=wc;zb.isStarterData=Lc;zb.starterDataDomainId=Fc;return B.g(hb,"GetDataSelectorPaneData",zb,fd,Ta,Fb,
ic,4)},M=(hb,ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=hb.Na(9,Ta);Ta.activeCell=ib;Ta.selectionIndex=Vb;return B.g(hb,"SelectLinkedEntityForDisambiguation",Ta,wc,Lc,Fc,fd,4)},L=(hb,ib,Vb,wc,Lc,Fc,fd,Ta,Fb,ic,zb,Bb=null)=>{Bb=hb.Na(1,Bb);Bb.searchCell=ib;Bb.searchQuery=Vb;Bb.isFloodgateEnabled=wc;Bb.isStarterData=Lc;Bb.starterDataDomainId=Fc;Bb.starterDataDomainIdString=fd;return B.g(hb,"LinkedEntitySearch",Bb,Ta,Fb,ic,zb,4)},N=(hb,ib,Vb,wc,Lc,Fc,fd,Ta,Fb=null)=>{Fb=hb.Na(1,Fb);Fb.cell=ib;Fb.starterDataDomainId=
Vb;Fb.starterDataDomainIdString=wc;return B.g(hb,"InsertStarterDataTable",Fb,Lc,Fc,fd,Ta,4)},Y=(hb,ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=hb.Na(1,Ta);Ta.activeCell=ib;Ta.isBackward=Vb;return B.g(hb,"MoveToNextAmbiguousLinkedEntity",Ta,wc,Lc,Fc,fd,4)},U=(hb,ib,Vb,wc,Lc,Fc,fd=null)=>{fd=hb.Na(9,fd);fd.activeCell=ib;return B.g(hb,"CancelSearchLinkedEntity",fd,Vb,wc,Lc,Fc,4)},P=(hb,ib,Vb,wc,Lc,Fc,fd,Ta=null)=>{Ta=hb.Na(1,Ta);Ta.selectedRanges=ib;Ta.letyDomainId=Vb;return B.g(hb,"GetDataTypeSelectorData",Ta,
wc,Lc,Fc,fd,4)},aa=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"GetErrorMessageForLinkedDataTypeRefresh",Fc,ib,Vb,wc,Lc,4)},X=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"GetHasUntrustedImageUrls",Fc,ib,Vb,wc,Lc,4)},Z=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"LinkedEntitiesEnableUntrustedImages",Fc,ib,Vb,wc,Lc,0)},da=(hb,ib,Vb,wc,Lc,Fc=null)=>{Fc=hb.Na(1,Fc);return B.g(hb,"LinkedEntityTryAutoRefresh",Fc,ib,Vb,wc,Lc,0)};var qa=a(85),O=a(719),ca=a(802);class wa{}
wa.tdi="EnrichmentContentFrame";wa.width=320;Object(c.a)(wa,"EnrichmentConstants",null,[]);class ia{constructor(hb){this.messageType=0;this.messageType=hb}}Object(c.a)(ia,"EnrichmentResponseMessage",null,[]);class Ha extends ia{constructor(hb,ib){super(hb);this.messageContent=null;this.messageContent=ib}}Object(c.a)(Ha,"EnrichmentResponseMessageWithContent",ia,[]);class Sa extends Ha{constructor(hb,ib,Vb){super(hb,ib);this.telemetryJson=null;this.telemetryJson=Vb}}Object(c.a)(Sa,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ha,[]);var Da=a(265),ea=a(14),sa=a(97),Ea=a(46),ba=a(86),ka=a(110),Ca=a(39),db=a(79),yb=a(27),kb=a(108),mb=a(710),W=a(25);class Q{constructor(hb,ib,Vb,wc,Lc){this.Rq=this.pk=this.kae=this.iae=this.Mv=this.Nu=null;this.$w=!1;this.ri=hb;this.Zd=ib;this.QO=Vb;this.Zb=wc;this.Ma=Lc;this.Wpa=ka.KeyInputManager.Al(ba.a.Ooa,0)}get MMb(){return!0}get lub(){return d.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}dispose(){this.MMb&&this.Rq&&(this.ri.Ba(ea.a.click,this.Rq,Object(qa.a)(this,this.ll,"onClosePaneClick")),
this.Zd.Ba(ea.a.Kd,this.Rq,Object(qa.a)(this,this.EEf,"onKeyHide")));this.Rq=null;this.Mv&&(this.$Xj(),this.Mv.parentNode.removeChild(this.Mv),this.Mv=null);this.Zb.ni("EnrichmentPaneId").yk(this.Wpa)}show(hb,ib,Vb){this.Nu=hb;this.$w||(this.pk=this.a1a(),this.gna.appendChild(this.pk),this.zfj(),this.Ma.Nb(W.a.sDe,kb.a.frame,Object(qa.a)(this,this.T8h,"handleEscapeKeyAction")),this.iSa(),this.$w=!0);this.Mv.src=this.lub&&this.lub.length?this.lub+"?culture="+ib.market+"&appName="+ib.applicationName+
"&themeId="+ib.themeId+"&featuresBitMask="+ib.featuresBitMask:Q.gyf;this.iae=ib;this.kae=Vb;this.peb()}QDc(hb,ib){hb=new Sa(2,hb,ib);this.asc(hb)}iSa(){const hb=this.Zb.ni("EnrichmentPaneId");hb.parent=Da.AFrame.jOa;this.ri.Rnb("EnrichmentPaneId",this.pk);hb.bindAction(this.Wpa,W.a.sDe)}J4f(){if(this.Mv){sa.FocusManager.zoa(this.Mv.contentWindow);const hb=new Sa(4,null,null);this.asc(hb)}}ll(){this.Z3b();return!0}EEf(hb){hb=hb.Ea.keyCode;return hb===Sys.UI.Key.enter||hb===Sys.UI.Key.space?(this.Z3b(),
!0):!1}Z3b(){this.hide();if(this.Nu)this.Nu.onPaneClosed()}a1a(){const hb=O.a("div","EnrichmentPaneId","EnrichmentPane");this.MMb&&hb.appendChild(this.L5c());this.ihi(hb);return hb}L5c(){const hb=O.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),ib=O.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");ib.innerText=CommonUIStrings.l_EnrichmentPaneTitle;ib.title=CommonUIStrings.l_EnrichmentPaneTitle;const Vb=ca.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.ri.ta(ea.a.click,Vb,Object(qa.a)(this,this.ll,"onClosePaneClick"));this.Zd.ta(ea.a.Kd,Vb,Object(qa.a)(this,this.EEf,"onKeyHide"));hb.appendChild(ib);hb.appendChild(Vb);this.Rq=Vb;return hb}ihi(hb){this.Mv=O.b("iframe","","EnrichmentFrame");hb.appendChild(this.Mv);this.Mv.id=wa.tdi;this.Mv.setAttribute("role","presentation")}zfj(){Ea.a.addHandler(this.Mv,"load",Object(qa.a)(this,this.gEf,"onIFrameLoad"));Ea.a.addHandler(this.Mv,"error",Object(qa.a)(this,this.lpc,
"onIFrameError"));$addHandler(window,"message",Object(qa.a)(this,this.hEf,"onIFrameMessage"))}$Xj(){Ea.a.removeHandler(this.Mv,"load",Object(qa.a)(this,this.gEf,"onIFrameLoad"));Ea.a.removeHandler(this.Mv,"error",Object(qa.a)(this,this.lpc,"onIFrameError"));$removeHandler(window,"message",Object(qa.a)(this,this.hEf,"onIFrameMessage"))}sjh(){this.Mv.src=Q.gyf}hide(){this.Xec();this.sjh()}T8h(hb,ib,Vb){if(1!==Vb&&(this.hide(),this.Nu))this.Nu.onPaneClosed();return 32}gEf(){}lpc(){}hEf(hb){hb=hb.rawEvent;
if(!this.Mv||-1!==this.Mv.src.indexOf(hb.origin)){try{var ib=Ca.a(hb.data)}catch(Vb){return}if(!mb.c(ib.messageType)){hb=window.g_badCastCallback;window.g_badCastCallback=null;switch(ib.messageType){case 2:this.asc(new Sa(1,Ca.c(this.iae),this.kae));break;case 1:this.asc(new Ha(0,this.rOh()));break;case 3:this.Nu&&this.Nu.selectEntity(ib.messageContent);break;case 5:this.Nu&&this.Nu.DEb(ib.messageContent);break;case 8:this.Nu&&(ib=Ca.a(ib.messageContent),0<ib.DomainId?this.Nu.LPd(ib.Query,ib.TelemetryJson,
ib.DomainId,ib.DomainIdString):this.Nu.searchEntity(ib.Query,ib.TelemetryJson));break;case 6:this.Nu&&this.Nu.cancelSearch();break;case 11:ib=Ca.a(ib.messageContent);ib=Q.N5b("keydown","f6",ba.a.hRb,!0,!1,ib,!0,!1);this.Mv&&this.Mv.dispatchEvent(ib);break;case 12:if(Ca.a(ib.messageContent).keyCode===ba.a.XF&&(ib=Q.N5b("keydown","esc",ba.a.XF,!0,!1,!1,!1,!1),this.Mv&&(this.Mv.dispatchEvent(ib),this.hide(),this.Nu)))this.Nu.onPaneClosed();break;case 13:this.Nu&&this.Nu.selectDataType(ib.messageContent);
break;case 14:this.Nu&&this.Nu.showHelpArticle(ib.messageContent);break;case 15:this.Nu&&this.Nu.showSurveyDialog(ib.messageContent);break;case 16:this.Nu&&(ib=Ca.a(ib.messageContent),this.Nu.insertTable(ib.DomainId,ib.DomainIdString))}window.g_badCastCallback=hb}}}rOh(){return Ca.c([2,1,3,5,8,6])}asc(hb){hb=Ca.c(hb);this.Mv.contentWindow.postMessage(hb,db.a.Qaa(this.lub))}static N5b(hb,ib,Vb,wc,Lc,Fc,fd,Ta){yb.a.qw?(Fc=String.format("{0} {1} {2}",Fc?"Shift":"",fd?"Control":"",Ta?"Alt":""),Fc.trim(),
Vb=document.createEvent("KeyboardEvent"),Vb.initKeyboardEvent(hb,wc,Lc,window.self,ib,0,Fc,!1,"en-US")):(ib={},ib.keyCode=Vb,ib.ctrlKey=fd,ib.shiftKey=Fc,ib.altKey=Ta,ib.bubbles=wc,ib.cancelable=Lc,Vb=new KeyboardEvent(hb,ib));return Vb}}Q.gyf="about:blank";Object(c.a)(Q,"EnrichmentPane",null,[813,2]);class va extends Q{constructor(hb){super(d.AFrameworkApplication.ra.vy,d.AFrameworkApplication.ra.Lt,d.AFrameworkApplication.ra.lea,d.AFrameworkApplication.ra.Ke,d.AFrameworkApplication.rb);this.taskPane=
hb;this.taskPane.JNg(this.J4f)}get gna(){return this.taskPane.jc}peb(){this.taskPane.isVisible||this.taskPane.Kg(!0)}Xec(){this.taskPane.Kg(!1)}dispose(){this.taskPane&&(this.taskPane.lkj(this.J4f),this.taskPane=null);super.dispose()}}Object(c.a)(va,"EnrichmentTaskPaneWrapper",Q,[]);class na{constructor(hb){this.Gy=null;this.ifa=hb}xyi(hb,ib){this.Gy=hb;this.ifa&&this.ifa.show(this,ib,null)}QDc(hb,ib){this.ifa&&this.ifa.QDc(hb,ib)}Uyb(){this.ifa&&this.ifa.hide()}dispose(){this.ifa&&(this.ifa.dispose(),
this.ifa=null)}selectEntity(hb){return this.Gy?this.Gy.selectEntity(hb):!1}searchEntity(hb,ib){this.Gy&&this.Gy.searchEntity(hb,ib)}LPd(hb,ib,Vb,wc){this.Gy&&this.Gy.LPd(hb,ib,Vb,wc)}DEb(hb){return this.Gy?this.Gy.DEb(hb):!1}onPaneClosed(){if(this.Gy)this.Gy.onPaneClosed()}cancelSearch(){this.Gy&&this.Gy.cancelSearch()}selectDataType(hb){this.Gy&&this.Gy.selectDataType(hb)}showHelpArticle(hb){this.Gy&&this.Gy.showHelpArticle(hb)}showSurveyDialog(hb){this.Gy&&this.Gy.showSurveyDialog(hb)}insertTable(hb,
ib){this.Gy&&this.Gy.insertTable(hb,ib)}}Object(c.a)(na,"EnrichmentManager",null,[812,2]);class Ba extends na{constructor(hb){super(hb)}dispose(){super.dispose()}}Object(c.a)(Ba,"ExcelEnrichmentManager",na,[]);var Oa=a(13);class oa{constructor(hb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=hb;this.commentQuestion=
Oa.a.instance.ob(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Oa.a.instance.ob(195);this.ratingValuesAscending=[Oa.a.instance.ob(196),Oa.a.instance.ob(197),Oa.a.instance.ob(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Oa.a.instance.ob(194)}}Object(c.a)(oa,"FloodgateSurvey",null,[]);var Ja=a(24),Wb=a(68),nc=a(423),Yb=a(41),pb=a(374),Fa=a(192),ab=a(33),Gb=a(94),Ga=a(29),Ma=a(282),Qa=a(21);class wb{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(wb,"EnrichmentMessageContentAppProperties",null,[]);class Na{constructor(hb,ib,Vb,wc,Lc){this.Ita=this.rMe=!1;this.hdb=this.Mwa=!0;this.XGb=this.UMb=!1;this.Ceb=null;this.crc=0;this.bR=()=>{(this.hdb||this.Ita)&&2!==this.crc&&(this.XGb||this.uvd(!1))};this.Rc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.aQi=Fc=>{Ga.a.Wf(Fc.Errors)?(Fc=Ga.a.nc(Fc.Errors),Fc.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Fc}`)):Fc.Result&&(this.$.ea.ik(this.Rc),this.$.ea.Jj(this.Rc),Fc=Fc.Result,this.Ceb=Fc.SkydanceFeatureBitmask,this.Lzd(Fc),this.UMb=!0)};this.Xg=()=>{(this.hdb||this.Ita)&&this.uvd(!1)};this.epc=(Fc,fd)=>{Ga.a.Wf(Fc.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Ga.a.nc(Fc.Errors)}`):Fc.Result&&(Fc=Fc.Result,Fc.DisambiguationJson?(this.UMb=!1,this.I5f(fd),this.Ceb=Fc.SkydanceFeatureBitmask,fd=Fc.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.XGb=!1,this.Rpf(fd)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.JSi=(Fc,fd)=>{Ga.a.Wf(Fc.Errors)?(fd=Ga.a.nc(Fc.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${fd}`)):Fc.Result&&(Fc=Fc.Result,Fc.DisambiguationJson?(this.I5f(fd),this.Ceb=Fc.SkydanceFeatureBitmask,fd=Fc.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.XGb=!0,this.Rpf(fd)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.oWi=Fc=>{Ga.a.Wf(Fc.Errors)?(Fc=Ga.a.nc(Fc.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Fc}`),this.hdb=!0):Fc.Result&&(Fc=Fc.Result,this.Ceb=Fc.SkydanceFeatureBitmask,this.Lzd(Fc),this.UMb=!0)};this.iZi=Fc=>{if(Ga.a.Wf(Fc.Errors)){const fd=Ga.a.nc(Fc.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${fd}`)}Fc.Result?
(this.Lzd(Fc.Result),this.UMb=!0):this.Msa()};this.VHf=Fc=>{Ga.a.Wf(Fc.Errors)?(Fc=Ga.a.nc(Fc.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Fc}`)):Fc.Result?this.Z8b.QDc(Fc.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Msa())};this.WUi=Fc=>{Ga.a.Wf(Fc.Errors)?(Fc=Ga.a.nc(Fc.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${Fc}`)):this.Msa()};this.$=hb;this.gridView=Qa.h(this.$);this.gridView.ha.lT(this.Xg);this.gridView.Uu(this.bR);this.oQe=wc;this.convertToLinkedEntityManager=Lc;ab.a.Ad(this.$)||Vb.yQ(ib);hb=new va(ib);this.Z8b=new Ba(hb);v.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Fc=>{Fc.isFeatureEnabled("mso_sendASmile",!0).then(fd=>{this.Mwa=fd;return null})})}dispose(){this.$&&(this.gridView.ha.tR(this.Xg),
this.gridView.jy(this.bR))}selectEntity(hb){const ib=Yb.o(this.gridView.ha.qa.activeCell,this.$),Vb=()=>new nc.a;pb.a(this.$.userOperationManager,(wc,Lc,Fc)=>M(this.$.oa.xa,ib,hb,Ma.b(wc,this.iZi),Lc,Fc,null),wc=>new Fa.a(109,0,wc,void 0,Vb),null);return!0}searchEntity(hb,ib,Vb=!1,wc=0,Lc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${ib}`);const Fc=Yb.o(this.gridView.ha.qa.activeCell,this.$);pb.a(this.$.userOperationManager,
(fd,Ta,Fb)=>L(this.$.oa.xa,Fc,hb,this.Mwa,Vb,wc,Lc,Ma.b(fd,this.VHf),Ta,Fb,null),fd=>new Fa.a(110,0,fd,16),null)}DEb(hb){const ib=Yb.o(this.gridView.ha.qa.activeCell,this.$);this.hdb=!1;pb.a(this.$.userOperationManager,(Vb,wc,Lc)=>Y(this.$.oa.xa,ib,hb,Ma.b(Vb,this.oWi),wc,Lc,null),Vb=>new Fa.a(111,0,Vb,16),null);return!0}onPaneClosed(){this.Ita=!1;this.rMe=!0;this.crc=0;this.XGb=!1}cancelSearch(){const hb=this.bQd();hb&&pb.a(this.$.userOperationManager,(ib,Vb,wc)=>U(this.$.oa.xa,hb,Ma.b(ib,this.VHf),
Vb,wc,null),ib=>new Fa.a(112,0,ib,16),null)}selectDataType(hb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Msa();if(hb&&hb.length)if(hb=JSON.parse(hb))if(null==hb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var ib={};ib.Id=hb.domainId;ib.StringId=hb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(ib)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(hb){const ib=new Gb.a(-859308420,Wb.a.zb,this.$.xc,9,null);this.$.Ia.Hb(ib,{[Wb.a.Pf]:"HelpID="+hb,["InputMethod"]:Wb.a.zb,["ShouldCanvasTakeFocus"]:!0,[Wb.a.Kc]:x.a.RU})}showSurveyDialog(hb){z.a.uNb(new oa(hb))}insertTable(hb,ib){const Vb=this.bQd();Vb&&pb.a(this.$.userOperationManager,(wc,Lc,Fc)=>
N(this.$.oa.xa,Vb,hb,ib,Ma.b(wc,this.WUi),Lc,Fc,null),wc=>new Fa.a(259,0,wc,1),null)}uvd(hb){this.launchOrCloseDisambiguationPane(hb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const hb=this.juj();hb&&pb.a(this.$.userOperationManager,(ib,Vb,wc)=>E(this.$.oa.xa,hb,!0,this.Mwa,!1,null,Ma.b(ib,this.JSi),Vb,wc,1),ib=>new Fa.a(114,0,ib,16),null)}launchLinkedEntityDataTypeSelectorPane(hb,
ib){pb.a(this.$.userOperationManager,(Vb,wc,Lc)=>P(this.$.oa.xa,hb,ib,Ma.b(Vb,this.epc),wc,Lc,2),Vb=>new Fa.a(233,0,Vb,16),null)}ryi(hb,ib){hb&&pb.a(this.$.userOperationManager,(Vb,wc,Lc)=>E(this.$.oa.xa,hb,!1,!1,!0,ib,Ma.b(Vb,this.epc),wc,Lc,2),Vb=>new Fa.a(257,0,Vb,16),null)}I5f(hb){hb&&(this.crc=hb)}Rpf(hb){var ib=new Gb.a(-90814711,Wb.a.zb,0,10,null);this.$.Ia.Hb(ib,null);this.Ita?this.Z8b.QDc(hb,null):(ib=3,null!=this.Ceb?ib=this.Ceb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),
(hb=this.fUh(hb,ib))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.oQe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.Z8b.xyi(this.oQe,hb),this.Ita=!0)}Msa(){this.Ita&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.Z8b.Uyb(),this.Ita=!1,this.crc=0,this.XGb=!1)}Lzd(hb){var ib=hb.Row+1;hb=hb.Column+1;0>ib||0>hb?(b.ULS.sendTraceTag(537166933,
0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Msa(),this.$.ea.ik(this.Rc)):(ib=new Ja.Range(ib,hb,ib,hb,!0,!1),this.gridView.ha.updateSelection(ib,ib,60),this.hdb=!0)}fUh(hb,ib){const Vb=new wb;Vb.applicationVersion=d.AFrameworkApplication.buildVersion;Vb.applicationName="ExcelWac";Vb.anid="00000000-0000-0000-0000-000000000000";Vb.sessionId=d.AFrameworkApplication.userSessionId;Vb.appCorrelationId=w.a.create().toString();var wc=C.a.IJ(d.AFrameworkApplication.lcid);
wc=wc?wc.name:null;Vb.uiLanguage=wc;Vb.market=this.Pbc(wc);Vb.themeId=0;Vb.disambiguationJson=hb;ib<=y.a.mS?Vb.featuresBitMask=ib:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Vb}Pbc(hb){hb=hb.split("-");return hb[hb.length-1]}launchOrCloseDisambiguationPane(hb){const ib=this.gridView.ha.qa.activeCell;if(this.bQd()&&ib)if(this.gridView.wb.Yzb(ib)){if((!this.rMe||hb||this.UMb)&&!this.gridView.fb){hb&&(this.hdb=!0);var Vb=
Yb.q(ib,this.$);pb.a(this.$.userOperationManager,(wc,Lc,Fc)=>E(this.$.oa.xa,Vb,!1,this.Mwa,!1,null,Ma.b(wc,this.epc),Lc,Fc,1),wc=>new Fa.a(114,0,wc,16),null)}}else this.Msa();else this.Msa()}pej(){if(this.Ita){var hb=this.gridView.ha.qa.activeCell;if(hb){var ib=Yb.q(hb,this.$);pb.a(this.$.userOperationManager,(Vb,wc,Lc)=>E(this.$.oa.xa,ib,!1,this.Mwa,!1,null,Ma.b(Vb,this.epc),wc,Lc,1),Vb=>new Fa.a(114,0,Vb,16),null)}else this.Msa()}}bQd(){const hb=this.gridView.ha.qa;return hb.Dba()?Yb.o(hb.activeCell,
this.$):null}juj(){const hb=this.gridView.ha.qa;return hb.Dba()?Yb.q(hb.activeCell,this.$):null}}Object(c.a)(Na,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var ya=a(7),nb=a(377),vb=a(1344),gb=a(51),cb=a(727);class La{constructor(hb,ib,Vb){this.oqf=2;this.nqf="Size64by48";this.$=hb;this.Va=ib;this.convertToLinkedEntityManager=Vb}kMh(hb,ib){var {ConvertToLinkedEntityManager:Vb}=a(772);this.D_j();ib=this.Va.sq(ib).lE();let wc=0,Lc=0,Fc=!1;for(var fd of hb.Categories){const Ta=this.PMh(fd,wc);
Ta&&(Lc===Vb.O8a&&(Fc=!0),ib.MenuSectionList.push(Ta),++wc);++Lc}Fc&&wc<=Vb.pqf&&ib.MenuSectionList.splice(Vb.O8a,1);Vb=this.Va.Ec().h2b();fd=gb.a.qe(11);for(const Ta of hb.LongButtons)this.convertToLinkedEntityManager.wGj(Ta)&&this.jKg(Vb,Ta,fd);0<Vb.ControlList.length&&ib.MenuSectionList.push(Vb);return ib}jKg(hb,ib,Vb){if(ib){var wc="Data.ConvertToLinkedEntityMenuItem_"+ib.Name,Lc=this.convertToLinkedEntityManager.iU(ib.DomainId);Lc&&(ib=Object(ya.a)(new nb.a,{Id:wc,ExternalId:wc,Command:"-1662108744",
LabelText:ib.Name,Alt:ib.SuperTip,Visible:!0,MenuItemId:a(772).ConvertToLinkedEntityManager.$1a(ib.DomainId),Image16by16:Vb,Image16by16Class:this.$di(Lc.FontLocator)}),hb.ControlList.push(ib))}}KMh(hb,ib){return Object(ya.a)(new vb.a,{Id:a(772).ConvertToLinkedEntityManager.jOe+hb.toString(),ExternalId:a(772).ConvertToLinkedEntityManager.jOe+hb.toString(),MenuItemId:a(772).ConvertToLinkedEntityManager.p9c+hb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.ldf(ib.FontLocator),
LabelText:ib.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.Ofd(ib)})}EUg(hb){switch(hb){case "Animal":return cb.a.XQg;case "Apple":return cb.a.aSg;case "Atom":return cb.a.zTg;case "Beaker":return cb.a.tVg;case "Bridge":return cb.a.SWg;case "Cat":return cb.a.T1g;case "City":return cb.a.h4g;case "Constellation":return cb.a.Z8g;case "Dog":return cb.a.Xoh;case "Finance":return cb.a.lVg;case "GradCap":return cb.a.E7h;case "HumanAnatomy":return cb.a.qdi;case "LocationPointer":return cb.a.WAi;
case "Map":return cb.a.O1i;case "MedicineNeedle":return cb.a.BHi;case "Mountain":return cb.a.RIi;case "Movie":return cb.a.jJi;case "Music":return cb.a.wJi;case "OuterSpace":return cb.a.r2i;case "Planet":return cb.a.w5i;case "Satellite":return cb.a.Erj;case "WolframGeneric":return cb.a.xqj;default:return cb.a.L$g}}$di(hb){if("PowerBIRibbon"!==hb)return A.a.Kad;switch(hb){case "AnimalRibbon":return A.a.Nzh;case "AppleRibbon":return A.a.Ozh;case "AtomRibbon":return A.a.Pzh;case "BeakerRibbon":return A.a.Qzh;
case "BridgeRibbon":return A.a.Rzh;case "CenterMapRibbon":return A.a.Szh;case "CityRibbon":return A.a.Tzh;case "CurrencyRibbon":return A.a.Uzh;case "ExerciseRibbon":return A.a.Vzh;case "FinanceRibbon":return A.a.JUe;case "FirstAidRibbon":return A.a.Wzh;case "GlobeLightningRibbon":return A.a.Xzh;case "GradCapRibbon":return A.a.Yzh;case "HumanAnatomyRibbon":return A.a.Zzh;case "LeafRibbon":return A.a.$zh;case "LocationPointerRibbon":return A.a.bAh;case "MapRibbon":return A.a.HUe;case "MountainRibbon":return A.a.cAh;
case "MovieRibbon":return A.a.dAh;case "MusicRibbon":return A.a.eAh;case "NotablePeopleRibbon":return A.a.fAh;case "OuterSpaceRibbon":return A.a.gAh;case "PartlySunnyWeatherRibbon":return A.a.hAh;case "PowerBIRibbon":return A.a.IUe;case "SatelliteRibbon":return A.a.iAh;case "WolframGenericRibbon":return A.a.aAh;case "YogaRibbon":return A.a.kAh;default:return A.a.GUe}}ldf(hb){switch(hb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";
case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";
case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}PMh(hb,ib){ib=this.Va.xC("ConvertToLinkedEntitySection_"+ib,this.oqf,this.nqf);var Vb=!1;for(var wc of hb.DomainIds){const Lc=this.convertToLinkedEntityManager.iU(wc);if(!Lc||Lc.DomainBlocked||!Lc.ShowInRibbon)continue;Vb=Lc.Name;const Fc=a(772).ConvertToLinkedEntityManager.$1a(wc);
ib.Zt("Data.ConvertToLinkedEntityMenuItem_"+Fc,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Fc,this.ldf(Lc.FontLocator),void 0,void 0,this.Ofd(Lc),Vb);Vb=!0}if(!Vb)return null;wc=ib.e2b(!0);ib=this.Va.Ec();ib.title=hb.Name;hb=ib.h2b();hb.ControlList.push(wc);return hb}D_j(){this.oqf=5;this.nqf="Size112by64"}Ofd(hb){return hb.RibbonTooltipHeader?hb.RibbonTooltipHeader+"\n\n"+hb.RibbonTooltip:hb.RibbonTooltip}}Object(c.a)(La,"ConvertToLinkedEntityMenuRenderer",null,[775]);var ja=a(59),Ua=a(284),
lb=a(113),sb=a(1),V=a(145),za=a(70);class Ra{constructor(hb,ib){this.rld=this.tld=!1;this.QXi=Vb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.tld=!0;if(Ga.a.Wf(Vb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Ga.a.nc(Vb.Errors)}`);else{var wc=0,Lc=[],Fc=!1;try{if(!Vb.Result)return;const fd=Vb.Result;if(!fd){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Lc=
this.K3i(fd);if(!Lc||!Lc.length)return;wc=Lc.length;this.RHi(Lc);this.iAa.aZf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.iAa.Jbb.length}`);if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const Ta of this.iAa.Jbb)if(1===(Ta.Id&1048320)>>8){Fc=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Fc}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${wc} data types.`),
Vb=[],Vb.push(Object(ya.a)(new za.a,{name:"MruCount",int64:wc})),Vb.push(Object(ya.a)(new za.a,{name:"MruWolframAvailable",bool:Fc})),V.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Vb)}this.rld&&(this.Mng(this.iAa.Jbb),this.rld=!1)}};this.l1i=Vb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Ga.a.Wf(Vb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Ga.a.nc(Vb.Errors)}`):Vb.Result&&(Vb.Result||b.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.zHf=(Vb,wc,Lc)=>{Vb=lb.a.Pe(Vb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Lc}. Errors: ${Ga.a.nc(Vb)}.`)};this.$=hb;this.iAa=ib}e1h(){!this.tld&&this.$.ea.Xb&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Ua.w(this.$.oa.xa,0,this.QXi,this.zHf,null,null))}Mng(hb){hb&&hb.length?
this.tld?(hb=this.Svj(hb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),Ua.C(this.$.oa.xa,0,hb,this.l1i,this.zHf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.rld=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}Svj(hb){if(!hb||
!hb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var ib=[];for(const Vb of hb)hb={},hb.Id=Vb.Id,Vb.StringId&&(hb.StringId=Vb.StringId),ib.push(hb);ib="<DataTypes>"+ja.a.Dc(ib)+"</DataTypes>";return 1906<ib.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):ib}K3i(hb){if(!hb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!hb.startsWith("<DataTypes>")||!hb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;hb=hb.substring(11,hb.length-12);if(!hb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let ib=[];try{ib=ja.a.Wh(hb)}catch(Vb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Vb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${ib.length} data types.`);return ib}RHi(hb){const ib=this.iAa.Jbb,Vb=this.iAa.odj;if(ib.length!==Vb){for(let wc=0;wc<hb.length&&ib.length<Vb;++wc){const Lc=hb[wc];this.iAa.iU(Lc)&&!ib.includes(Lc)&&ib.push(Lc)}this.iAa.Jbb=ib}}}Object(c.a)(Ra,"LinkedDataTypeRoamingHandler",null,[]);var Xa=a(56),$a=a(50),ma=a(195),fa=a(37),eb=a(48),ua=a(28),xa=a(250),tb=a(22),Qb=a(100);a.d(F,"ConvertToLinkedEntityManager",function(){return pc});
class pc extends r.a{constructor(hb,ib,Vb,wc,Lc,Fc,fd){super();this.Cmf=this.gtd=this.eud=this.Xrd=this.Wrd=this.t7a=this.Zod=null;this.fFb=this.Ukd=0;this.jla=null;this.ipd=!1;this.Zdd=this.Ln=this.NOd=null;this.hs=0;this.lY=null;this.lLa=8;this.N0c=this.mqf=this.yif=this.$$a=!1;this.bza=this.N_e=this.DXe=null;this.RZc=0;this.QUg=5;this.y1b=3E4;this.Tfg=!1;this.p2=null;this.Wta=Array(5);this.yig=this.O_d=!1;this.o_f=this.Vvd=0;this.htmlSanitizationHelper=this.dee=null;this.L$f=!0;this.Rc=(Ta,Fb)=>
{Fb.Xb&&!Fb.MBb&&this.showUntrustedImageBusinessBarIfNecessary()};this.KTi=Ta=>{if(Ta.Result){var Fb=Ta.Result;if(Fb&&Fb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Fb.length} labels`);var ic=$a.GetServiceTaskFactory.Oa(this.$.da,274,275,0);fa.TaskExtensions.za(ic,()=>{ic.result.HZc(Fb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.tf=()=>{this.KVj();this.H9h(this.$.ea.Pn.LinkedEntityAsyncRefreshStateId);this.C7a?this.M$h(this.$.ea.Pn.RichDataClassificationLabelStateId):this.K6a&&this.$Zd(!0)};this.gRi=()=>{this.O_d=!0;this.Ln&&this.Ln.pej()};this.bTi=Ta=>{if(Ta&&!xa.a(Ta))try{Ta.Result.HasUntrustedImageUrl&&(this.businessBar.ih(59,null),this.yig=!0)}catch(Fb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Fb}.`)}};
this.Opf=()=>{if(!this.mqf&&this.nAb()&&!this.Xpd())if(V.a("DataTabActive"),Xa.a.pg.GQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Ta=this.A5b();if(Ta){var Fb={};Fb.InputMethod=Wb.a.zb;Fb.CalloutName=8;Fb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.Hb(Ta,Fb);this.mqf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.bQi=Ta=>{Ga.a.Wf(Ta.Errors)||(this.C7a||this.$Zd(!1),this.raiseEvent("LinkedEntityConverted"))};this.l_i=()=>{this.$.da.gb(211,Ta=>{Ta.readText(Oa.a.instance.ga(1810))})};this.dd=(Ta,Fb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Fb.iV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.PBe():this.coj(),this.O_d&&this.rPe())};this.lTi=Ta=>{this.J3b();if(Ta.Result){var Fb=Ta.Result;Ta=Fb.DomainDataArray;if(this.jla=Fb.Ribbon){var ic={};ic.Name=Oa.a.instance.ga(1800);ic.DomainIds=this.gK;this.jla.Categories.splice(pc.O8a,0,ic)}0<Fb.MaximumCellsToConvert&&(this.dee=Fb.MaximumCellsToConvert);this.hs=2;Fb=!1;if(Ta){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Ta.length} domains`);
this.LNa||(this.LNa=[]);ic=Oa.a.instance.ga(1797);const zb=Oa.a.instance.ga(1799);for(const Bb of Ta)Bb.DomainId?(this.LNa.push(Bb),Bb.DomainBlocked?(Ta=!!Bb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${Ta?Bb.DomainId.Id.toString():Bb.Name} is telemetry only, do not show in menu (Has String ID: ${Ta})`)):(this.hU.ia(pc.$1a(Bb.DomainId),Bb),Bb.Name===ic||268435456===Bb.DomainId.Id?this.DXe=Bb.DomainId.Id.toString():Bb.Name===zb||536870912===Bb.DomainId.Id?this.N_e=Bb.DomainId.Id.toString():
268435712===Bb.DomainId.Id&&Bb.ShowInRibbon&&(this.N0c=!0),Fb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Fb||(this.LNa=null);this.mjg();this.NOd.e1h();this.Tfg||(this.FVj(),this.Tfg=!0)}else this.LNa=null,this.hs=3,-1<this.lLa&&window.setTimeout(()=>{this.UHb()},100*(8-this.lLa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.pKd();this.ZHe();this.N0c&&this.Qjf&&ma.c(this.Opf,this.$.la,500);
this.K6a&&!this.C7a&&this.$Zd(!0)};this.kTi=Ta=>{Ta=lb.a.Pe(Ta.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Ga.a.nc(Ta)}].`);this.LNa=null;this.hs=3;this.$$a=!0;this.pKd()};this.onContentReady=()=>{this.hhg()&&this.gridView.jy(this.onContentReady);this.L$f&&this.$.workbookContext.Options&1048576&&(this.businessBar.kKj(),this.L$f=!1)};this.wj=()=>{this.J3b()};this.NVi=Ta=>{if(xa.a(Ta)){const Fb=$a.GetServiceTaskFactory.Oa(this.$.da,5,4,0);fa.TaskExtensions.za(Fb,
()=>{let zb=null;if(null===Ta||void 0===Ta?0:Ta.Errors)zb=Ta.Errors[0];Fb.result.p$f(zb,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ga.a.nc(Ta.Errors)}].`);const ic=Ga.a.Dz(Ta.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Sn(ic)}};this.F0c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.y1b} millisecond interval`);
this.Zff("Periodic auto-refresh check",this.qOi,this.pOi)};this.qOi=Ta=>{xa.a(Ta)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ga.a.nc(Ta.Errors)}].`),++this.RZc):this.RZc=0;e.a.Ja(this.bza);this.RZc>=this.QUg?(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
this.bza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.bza=eb.a.instance.create(this.F0c,this.y1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.pOi=Ta=>{Ta=lb.a.Pe(Ta.data);f.a.lh(Ta)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Ga.a.nc(Ta)}].`);
e.a.Ja(this.bza);this.bza=eb.a.instance.create(this.F0c,this.y1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.NWi=Ta=>{Ta=!!Ta.Result&&Ta.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Ta.toString()}`);Ta?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${ua.a.Ya.ue.m-this.Ukd} ms, retry count = ${this.fFb}`),this.UHb()):this.CAc()};this.MWi=()=>{b.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");this.CAc()};this.NSi=Ta=>{Ta.Result?(Ta=Ta.Result)?(this.CLd(),this.businessBar.p$f(null,Ta)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=hb;this.businessBar=Fc;this.svgIconProvider=Vb;this.htmlSanitizationHelper=fd;this.LNa=[];this.gK=[];this.gridView=Qa.h(this.$);this.tec=-1;this.yqi=
sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.K6a=this.$.sa(387)&&this.$.sa(259);this.C7a=this.$.sa(586);this.Qjf=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.hU=new Qb.a;this.t9a=new La(hb,ib,this);wc&&(this.Ln=new Na(hb,wc,Lc,this,this));this.$.Lk(this.dd);n.a(this.$)&&n.a(this.$).rxj(this);this.PBe();(this.K6a||this.C7a)&&this.$.ea.$t(this.tf);sb.EwaSettings.sa(123)&&sb.EwaSettings.sa(131)&&
(this.hhg()||this.gridView.Uu(this.onContentReady));this.$.bC(this.wj);this.$.ea.Jj(this.Rc);this.showUntrustedImageBusinessBarIfNecessary();this.NOd=new Ra(this.$,this)}dispose(){(this.K6a||this.C7a)&&this.$.ea.yv(this.tf);this.$.ea.ik(this.Rc);!this.p2&&sb.EwaSettings.sa(123)&&sb.EwaSettings.sa(131)&&this.gridView.jy(this.onContentReady);this.Ln&&this.Ln.dispose();this.$.xF(this.wj);this.$.pl(this.dd);this.K6a&&(this.Zod=null);e.a.Ja(this.bza)}oNg(hb){this.addHandler("LinkedEntityConverted",hb)}Wjj(hb){this.removeHandler("LinkedEntityConverted",
hb)}get odj(){return 5}get Jbb(){return this.gK}set Jbb(hb){this.gK=hb}selectEntity(hb){return this.Ln?this.Ln.selectEntity(hb):!1}searchEntity(hb,ib){this.Ln&&this.Ln.searchEntity(hb,ib)}LPd(hb,ib,Vb,wc){this.Ln&&this.Ln.searchEntity(hb,ib,!0,Vb,wc)}DEb(hb){return this.Ln?this.Ln.DEb(hb):!1}onPaneClosed(){if(this.Ln)this.Ln.onPaneClosed()}cancelSearch(){this.Ln&&this.Ln.cancelSearch()}selectDataType(hb){this.Ln&&this.Ln.selectDataType(hb)}showHelpArticle(hb){this.Ln&&this.Ln.showHelpArticle(hb)}showSurveyDialog(hb){this.Ln&&
this.Ln.showSurveyDialog(hb)}insertTable(hb,ib){this.Ln&&this.Ln.insertTable(hb,ib)}M$h(hb){this.$.isEditMode&&this.o_f!==hb&&d.AFrameworkApplication.fa.pa("SupportsPolicies")&&(this.o_f=hb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),H(this.$.oa.xa,this.KTi,null,null,null))}rPe(){this.$.userOperationManager.Jc(new Fa.a(589,0,(hb,ib,Vb)=>Z(this.$.oa.xa,Ma.b(hb,this.gRi),ib,Vb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.O_d||
this.yig||!this.$.ea.Xb||this.Xuj()}Xuj(){this.$.userOperationManager.Jc(new Fa.a(588,0,(hb,ib,Vb)=>X(this.$.oa.xa,Ma.b(hb,this.bTi),ib,Vb,null),80),null)}$Zd(hb){if(this.K6a&&null==this.Zod&&!this.C7a&&d.AFrameworkApplication.fa.pa("SupportsPolicies")&&null!=this.t7a&&this.t7a&&(!hb||this.$.workbookContext.Options&262144)){var ib=$a.GetServiceTaskFactory.Oa(this.$.da,274,275,0);fa.TaskExtensions.za(ib,()=>{this.Zod=ib.result.HTf(2)},this.$.la,3)}}get gEb(){return this.Wta.length}get wHi(){return this.dee}M$g(hb){(hb=
this.aph(hb))?this.convertToLinkedEntity(hb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(hb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${hb.Id}].`);if(this.gridView){var ib=this.gridView.ha.qa.ld,Vb=ib.De(this.gridView.cQ);this.ipd&&this.WKg(hb);if(Vb){Vb=this.gridView.wb.$wa(Vb);if(!this.Eaf(hb)&&this.Ykf(hb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(Xa.a.pg.GQ){ib=this.gfd();if(!ib){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Vb=this.A5b();if(!Vb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var wc={["InputMethod"]:Wb.a.zb,CalloutName:3};wc.Target=ib;wc.RibbonButtonLabel=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.c_f(hb):this.zCb(hb.Id.toString());wc.ExampleEntities=this.EVe(hb);this.$.Ia.Hb(Vb,
wc);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Ykf(hb.Id)&&!hb.StringId)this.launchLinkedEntityDataTypeSelectorPane(pc.$1a(hb));else{if(Vb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.rPj(hb)){ib=Yb.r(this.gridView.ha.qa.selectedRanges,this.$);this.Ln.ryi(ib,hb);return}if(Xa.a.pg.GQ){ib=this.gfd();if(!ib){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Vb=this.A5b();if(!Vb){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}wc={["InputMethod"]:Wb.a.zb,CalloutName:2};wc.Target=ib;wc.RibbonButtonLabel=this.c_f(hb);wc.ExampleEntities=this.EVe(hb);wc.BlankCellResourceId=this.TVg(hb);wc.HasBlankCellWalkthrough=
this.Aai(hb);wc.ServiceDomain=hb.Id;this.$.Ia.Hb(Vb,wc);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.G4c(hb,!1,ib)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.p2&&this.p2.VHa()}onAutoDetectUIShown(){pb.a(this.$.userOperationManager,(hb,ib,Vb)=>R(this.$.oa.xa,hb,ib,Vb,null),hb=>new Fa.a(230,0,hb,80),null)}G4c(hb,
ib,Vb){const wc=Yb.q(Vb,this.$),Lc=()=>new nc.a;pb.a(this.$.userOperationManager,(Fc,fd,Ta)=>I(this.$.oa.xa,wc,hb,ib,Ma.b(Fc,this.bQi,this.l_i,this.Ln.aQi),fd,Ta,null),Fc=>new Fa.a(115,0,Fc,void 0,Lc),null)}WKg(hb){if(this.ipd){var ib={};ib.Id=hb.Id;hb.StringId&&(ib.StringId=hb.StringId);if(!(0<this.gK.length&&this.gK[0].Id===ib.Id&&this.gK[0].StringId===ib.StringId)){hb=!1;this.gK.splice(0,0,ib);for(let Vb=1;Vb<this.gK.length;++Vb)if(this.gK[Vb].Id===ib.Id&&this.gK[Vb].StringId===ib.StringId){this.gK.splice(Vb,
1);hb=!0;break}for(;5<this.gK.length;)this.gK.splice(this.gK.length-1,1);this.jla.Categories[pc.O8a].DomainIds=this.gK;this.aZf();hb||this.NOd.Mng(this.gK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var hb=Yb.q(this.gridView.ha.qa.ld,this.$);pb.a(this.$.userOperationManager,(ib,Vb,wc)=>G(this.$.oa.xa,hb,ib,Vb,wc,null),ib=>new Fa.a(116,0,ib),null)}else b.ULS.shipAssertTag(537166879,
0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Qa.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.CLd();var hb=Yb.r(this.gridView.ha.qa.selectedRanges,this.$);pb.a(this.$.userOperationManager,(ib,Vb,wc)=>D(this.$.oa.xa,hb,ib,Vb,wc,null),
ib=>new Fa.a(248,0,ib),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}wGj(hb){hb=this.iU(hb.DomainId);if(!hb||hb.DomainBlocked||sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!hb.HasCuratedData)return!1;if(this.yqi){for(let ib of this.hU)if(ib.value.DomainId.Id===hb.DomainId.Id&&ib.value.ShowInRibbon)return!0;return!1}return hb.ShowInRibbon}fFj(hb){return 2!==this.hs||!this.Wta[hb]}launchDisambiguationPaneForSearch(){this.Ln&&this.Ln.launchDisambiguationPaneForSearch()}Mc(hb,
ib,Vb){if("PopulateConvertToLinkedEntityMenu"!==ib)return!1;this.Zdd=Vb.MenuId;if(0===this.hs||3===this.hs)return this.$5i(),!0;if(!this.jla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.hU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.lY=this.lY||this.t9a.kMh(this.jla,Vb.MenuId);Vb.MenuItems=this.lY;return this.ipd=!0}$5i(){-1===this.tec&&(this.UHb(),this.tec=window.setInterval(()=>
{this.UHb()},2E3))}UHb(){this.$.ea.Xb&&2!==this.hs&&(this.lLa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.hs=1,S(this.$.oa.xa,this.lTi,this.kTi,null,null))}Xpd(){return this.$.isEditMode&&2!==this.hs&&(0<=this.lLa||!this.$$a)}z0d(hb){d.AFrameworkApplication.rg?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):n.a(this.$)?(this.g0j(),hb&&this.$.qf()):b.ULS.sendTraceTag(537166868,
0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}coj(){this.fFb=0;this.lLa=8;this.$$a=!1;this.hs=this.tec=0;this.LNa=this.jla=null;this.J3b();for(let hb=0;hb<this.gEb;++hb)this.Wta[hb]=null;this.nAb()&&this.z0d(!0)}J3b(){this.lY=null}nAb(){const hb=x.a.IIb,ib=n.a(this.$);return!!ib&&ib.lp.Iz===hb}mjg(){if(this.jla){let Vb=0;var hb=-1,ib=-1;let wc=0,Lc=0,Fc=0,fd=0;const Ta=[null,null,null,null,null];for(const Fb of this.jla.Categories){let ic=!1;for(const zb of Fb.DomainIds){let Bb=
this.iU(zb);Bb&&!Bb.DomainBlocked&&Bb.ShowInRibbon&&(Vb<this.gEb?(this.Wta[Vb]=zb,Lc===pc.O8a&&(-1===hb&&(hb=Vb),ib=Vb,fd=ib-hb+1),++Vb):Vb===this.gEb&&wc<fd&&Lc!==pc.O8a&&(Ta[wc]=zb,++wc),ic=!0)}ic&&++Fc;++Lc}if(-1<hb&&Fc<=pc.pqf){for(;ib>=hb;--ib)this.Wta.splice(ib,1);for(hb=0;hb<fd;++hb)this.Wta.splice(Vb+hb,0,Ta[hb])}for(;Vb<this.gEb;)this.Wta[Vb]=null,++Vb}}hhg(){const hb=Qa.h(this.$).Ca,ib=this.gridView.ha.Oe;if(hb&&hb.Zkd&&1===ib&&this.gridView.ha.qa.activeCell){const Vb=$a.GetServiceTaskFactory.Oa(this.$.da,
12,477,1);sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?fa.TaskExtensions.za(Vb,()=>{this.p2=new u.a(this.$,this.svgIconProvider,Vb.result,this,this.htmlSanitizationHelper)},this.$.la,3):this.p2=new u.a(this.$,this.svgIconProvider,Vb.result,this,this.htmlSanitizationHelper);return!0}return!1}uyi(){this.Ln&&this.Ln.uvd(!0)}launchLinkedEntityDataTypeSelectorPane(hb){if(this.Ln)if(hb=this.Y8c(hb))if(hb.DomainId.StringId)b.ULS.sendTraceTag(537166855,
0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var ib=Yb.r(this.gridView.ha.qa.selectedRanges,this.$);this.Ln.launchLinkedEntityDataTypeSelectorPane(ib,hb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}c9g(hb){const ib=this.Zdi(hb),Vb=h.a.yg(this.zCb(hb));hb=h.a.yg(this.dZd(hb));return pc.OLh(ib,gb.a.qe(11),Vb,hb)}dZd(hb){try{return this.rNe(parseInt(hb,10)).Description}catch(ib){}return Oa.a.instance.ga(1794)}zCb(hb){try{return this.rNe(parseInt(hb,
10)).Name}catch(ib){}return Oa.a.instance.ga(1780)}c_f(hb){try{return this.iU(hb).Name}catch(ib){}return this.zCb(hb.Id.toString())}TVg(hb){try{return this.iU(hb).BlankCellResourceId}catch(ib){}return null}Aai(hb){try{return this.iU(hb).HasBlankCellWalkthrough}catch(ib){}return!1}Eaf(hb){try{const ib=pc.$1a(hb);if(this.hU.hb(ib))return this.hU.ma(ib).HasCuratedData}catch(ib){}return!1}rPj(hb){try{return this.iU(hb).SupportsStarterData}catch(ib){}return!1}Ykf(hb){return 268435968===hb}gfd(){return 2===
n.a(this.$).RN?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}A5b(){return new Gb.a(-847286761,Wb.a.zb,this.$.xc,0,x.a.K_)}ZHe(){if(this.nAb()&&!this.Xpd()&&!this.yif&&sb.EwaSettings.sa(387)&&this.Eaf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Xa.a.pg.GQ){const Vb=this.gfd();if(Vb){var hb=this.A5b();if(hb){var ib={["InputMethod"]:Wb.a.zb,
CalloutName:6};ib.Target=Vb;ib.ShouldCanvasTakeFocus=!0;this.$.Ia.Hb(hb,ib);this.yif=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}zdi(hb){hb=this.Y8c(hb);return hb?this.t9a.EUg(hb.SubdomainFontLocator):
(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}$gc(hb){return this.p2?this.p2.DUg(hb):!1}WOh(){return this.p2?this.p2.UPh():""}Fli(){return this.p2?this.p2.bDb:!1}QTh(hb,ib){const Vb=this.Xdf(hb);if(0>Vb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${hb}`);else if(hb=(hb=this.sNe(hb))?this.iU(hb):null)ib[m.a.GalleryButtonProps]=this.t9a.KMh(Vb,hb),
ib[m.a.Alt]=this.t9a.Ofd(hb)}aZf(){this.mjg();this.nAb()&&this.z0d(!0);this.J3b()}Zdi(hb){return hb===this.DXe?A.a.JUe:hb===this.N_e?A.a.HUe:A.a.GUe}EVe(hb){try{return this.iU(hb).ExampleEntities}catch(ib){}return Oa.a.instance.ga(1802)}pKd(){(0>this.lLa||this.$$a)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.hs||0>this.lLa||this.$$a)&&window.clearInterval(this.tec);this.Xpd()?this.Zdd&&this.$.frame.Vw(this.Zdd):this.z0d(this.nAb())}Eb(hb){return this.$.Bb+
hb}g0j(){var hb=!0;const ib=Array(this.gEb),Vb=n.a(this.$)?n.a(this.$).lp:null;if(Vb){for(let wc=0;wc<ib.length;++wc)this.fFj(wc)?ib[wc]=!0:hb=ib[wc]=!1;Vb.X5f(["ConvertToLinkedEntityGallery"],hb);if(!hb)for(hb=0;hb<ib.length;++hb)ib[hb]&&Vb.X5f([this.PTh(hb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}iU(hb){const ib=pc.$1a(hb);if(this.hU.hb(ib))return this.hU.ma(ib);b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${hb.Id} (Has String ID: ${!!hb.StringId})`);
return null}PTh(hb){return"ConvertToLinkedEntityPreview"+hb.toString()}r0d(){l.a.get_instance().Lj(10,()=>{this.ZHe();this.N0c&&this.Qjf&&ma.c(this.Opf,this.$.la,500)})}hec(hb,ib){switch(hb){case "QueryLinkedEntityGalleryButtons":if(!ib[m.a.InnerHTML]){hb=ib[Wb.a.Kc].toString();const Vb=tb.a.equals(hb,Oa.a.instance.ga(1797),!0)||tb.a.equals(hb,Oa.a.instance.ga(1798),!0),wc=tb.a.equals(hb,Oa.a.instance.ga(1799),!0);Vb||wc||this.QTh(hb,ib)}break;case "QueryLinkedEntityMenuGalleryButtons":ib[m.a.InnerHTML]||
(ib[m.a.InnerHTML]=this.c9g(ib[Wb.a.Kc]))}return ib}aph(hb){var ib=this.sNe(hb);if(ib)return ib;if(ib=this.Y8c(hb))return ib.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${hb}`);return null}rNe(hb){const ib={};ib.Id=hb;return this.iU(ib)}Y8c(hb){return this.hU.hb(hb)?this.hU.ma(hb):null}Xdf(hb){if(!hb.startsWith(pc.p9c))return-1;const ib=parseInt(hb.substr(pc.p9c.length),10);return isNaN(ib)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${hb}`),
-1):ib}sNe(hb){hb=this.Xdf(hb);return 0>hb?null:this.Wta[hb]}Zff(hb,ib,Vb){this.hU&&this.hU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${hb})`),hb=this.$.oa.xa.Wb(),this.$.ea.Xb&&da(this.$.oa.xa,Ma.b(this.NVi,ib),Vb,null,null,hb))}FVj(){this.Zff("Auto-refresh on load",null,null)}KVj(){this.hU&&this.hU.count&&(this.bza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.ea.Pn.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.bza=eb.a.instance.create(this.F0c,this.y1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}CAc(){if(this.$.ea.Xb&&
null!=this.t7a&&null!=this.Wrd&&null!=this.Xrd&&null!=this.eud&&null!=this.gtd)if(++this.fFb,12>=this.fFb){1===this.fFb&&(this.Ukd=ua.a.Ya.ue.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const hb=this.$.oa.xa.Wb();Ua.u(this.$.oa.xa,this.yzi,this.zzi(),this.NWi,this.MWi,null,hb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${ua.a.Ya.ue.m-this.Ukd} ms`),this.$$a=!0,this.pKd()}PBe(){if(this.$.isEditMode)if(null!=
this.t7a)this.CAc();else{var hb=ua.a.Ya.ue.m,ib=[];v.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Vb=>{Vb.isFeatureEnabled("ExcelPowerBiPro",!1).then(wc=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${ua.a.Ya.ue.m-hb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${wc}]`);return this.t7a=wc}).then(()=>{ib.push(Vb.isFeatureEnabled("ExcelWolframAlpha",
!1).then(wc=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${ua.a.Ya.ue.m-hb} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${wc}]`);return this.eud=wc}))}).then(()=>{ib.push(Vb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(wc=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${ua.a.Ya.ue.m-
hb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${wc}]`);let Lc;const Fc=[(Lc=new za.a,Lc.name="IsRestrictedByLicense",Lc.bool=wc,Lc)];V.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Fc);this.Cmf=wc&&sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return wc}))}).then(()=>{ib.push(Vb.isFeatureEnabled("StockHistory",!1).then(wc=>
{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${ua.a.Ya.ue.m-hb} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${wc}]`);return this.gtd=wc}))}).then(()=>{ib.push(Vb.isFeatureEnabled("ExcelPowerBiFree",!1).then(wc=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${ua.a.Ya.ue.m-hb} Millisecond.`);
b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${wc}]`);return this.Wrd=wc}))}).then(()=>{ib.push(Vb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(wc=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${ua.a.Ya.ue.m-hb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${wc}]`);
return this.Xrd=wc}))}).then(()=>{Promise.all(ib).then(()=>{this.CAc()})})})}}get yzi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}zzi(){return[this.t7a,this.eud,this.gtd,this.Wrd,this.Xrd,this.Cmf]}CLd(){this.businessBar&&this.businessBar.Eka(58)&&this.businessBar.removeEntry(58)}H9h(hb){this.Vvd!==hb&&this.businessBar&&((this.Vvd=hb)?aa(this.$.oa.xa,this.NSi,null,null,null):this.CLd())}static OLh(hb,
ib,Vb,wc){hb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',hb,ib,wc);Vb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Vb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',hb,Vb)}static $1a(hb){return hb.StringId?hb.Id.toString()+"."+hb.StringId:hb.Id.toString()}}pc.jOe="ConvertToLinkedEntityPreview";
pc.p9c="PreviewGalleryButtonIndex.";pc.O8a=0;pc.pqf=2;Object(c.a)(pc,"ConvertToLinkedEntityManager",r.a,[710,711,2,712])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/533fe708e310c389b8eb88656ccde484/EwaDSEsNext.le.js.map